changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s410.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's410',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 41 49 42 41 41 4b 43 41 51 45 41 39 63 ... > }
Handler: listening on port 22100
s410:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200004
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44724
received auth hello!
{ authId: 402, nonce: <Buffer 5b 02 02 ac 71 3f fc d6> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 38 82 f4 da d8 ae 80 30>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer db a6 34 93 d4 f6 e5 ce 09 b9 34 9b 3f c3 21 a1>,
  macKeyVal: <Buffer af b5 9a c9 ed 00 18 3e 20 3f 83 31 19 ab 22 5a b9 0e 47 a0 08 89 ce 62 00 13 9f 66 38 5d e1 d1>,
  absValidity: 2018-08-27T07:49:20.203Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 41 dc 93 d9 be 53 1e 1b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 41 dc 93 d9 be 53 1e 1b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.53:36152',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200011
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44898
received auth hello!
{ authId: 402, nonce: <Buffer 35 38 8d 98 9d 18 b0 28> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cf 7b 60 ef 0b 2d 40 af>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 63 41 88 45 96 90 58 0e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 63 41 88 45 96 90 58 0e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.53:36326',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200018
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45170
received auth hello!
{ authId: 402, nonce: <Buffer f0 98 c9 09 f5 23 3a 40> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b6 e4 c5 54 75 13 b2 a6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ac b4 29 f2 3f 92 26 29>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ac b4 29 f2 3f 92 26 29> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.53:36598',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200025
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45440
received auth hello!
{ authId: 402, nonce: <Buffer 7b bc fd d6 69 3d c1 bc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e6 30 27 e0 19 f5 a1 b9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fc aa c5 0b f7 d9 ac ef>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fc aa c5 0b f7 d9 ac ef> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.53:36868',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200032
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45710
received auth hello!
{ authId: 402, nonce: <Buffer 55 af 93 f9 5e a2 b5 92> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 16 a1 d5 d2 20 61 d8 97>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 39 5a 7d 9d fd 38 b0 b6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 39 5a 7d 9d fd 38 b0 b6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.53:37138',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200039
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45980
received auth hello!
{ authId: 402, nonce: <Buffer 5c 48 ac dc 3e a8 4b 02> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 53 b6 4e 6a 85 4e de 17>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8a 97 33 82 ba b8 91 0b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8a 97 33 82 ba b8 91 0b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.53:37408',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200046
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46250
received auth hello!
{ authId: 402, nonce: <Buffer c6 11 5c 9a 21 2f 8e b3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 60 b7 fd d6 12 89 7c bb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4c e5 7f 04 f1 65 0a cc>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 4c e5 7f 04 f1 65 0a cc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.53:37678',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200053
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46516
received auth hello!
{ authId: 402, nonce: <Buffer fb fc cb 2f 5c 48 2d a7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3d a7 21 92 ad cf 1d fd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cf 19 52 9d 02 ee 6c 2d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer cf 19 52 9d 02 ee 6c 2d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.53:37944',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300048
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300058
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 44092
received auth hello!
{ authId: 503, nonce: <Buffer 11 b5 e1 e3 67 1d 7c 85> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth503',
     commonName: '10.0.1.6' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth402',
     commonName: '10.0.0.2' },
  serial: '01657A23471C',
  notBefore: 2018-08-27T06:45:56.000Z,
  notAfter: 2018-08-28T06:47:36.000Z,
  subjectHash: '5542437f',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'CB:2C:9F:98:99:4E:1A:2B:8E:63:3C:1F:E1:0E:82:FE:36:DF:F8:7C',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'BC5D33480D8E7016713911F6B0F0A9131DC7B60A8CB9E1A10BD7543A76CF24678BCCDEF96EAE9DEBCABF978E7789E6CA0C84927254FA399F63769AE55F612D6596ED8937A047D141B0D94354445A0E25D81DE385B8957F9947FECEBCDBC6998D6544DD90F3D3ED8804119CBEF9AD775F3F63F7F6C01396688740867299DD55D2F05ED7417633969B004111F87931929D7463F27FD75E378152650127AE67180E37BB11DC459BB1B15A8A91A3EC4E9A4F409BAB5AD5C90FB833EA0A8D966FFEA0CC1054B7557DF4DC8B1152F7CC89313B4089920237B6D064F37CDE972831ADFD6643D155A4CDB156DC70EE29EC7CAE2C434B3120E75B3A239E854968A41D6A23',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.6' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 503,
  host: '10.0.1.6',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWV6I0ccMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDIxETAPBgNVBAMMCDEwLjAuMC4yMB4XDTE4MDgy\nNzA2NDU1NloXDTE4MDgyODA2NDczNlowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMzERMA8GA1UEAwwIMTAuMC4xLjYwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQC8XTNIDY5wFnE5Efaw8KkTHce2Coy54aEL11Q6ds8kZ4vM3vlu\nrp3ryr+XjneJ5soMhJJyVPo5n2N2muVfYS1llu2JN6BH0UGw2UNURFoOJdgd44W4\nlX+ZR/7OvNvGmY1lRN2Q89PtiAQRnL75rXdfP2P39sATlmiHQIZymd1V0vBe10F2\nM5abAEER+Hkxkp10Y/J/1143gVJlASeuZxgON7sR3EWbsbFaipGj7E6aT0Cbq1rV\nyQ+4M+oKjZZv/qDMEFS3VX303IsRUvfMiTE7QImSAje20GTzfN6XKDGt/WZD0VWk\nzbFW3HDuKex8rixDSzEg51s6I56FSWikHWojAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQYwDQYJKoZIhvcNAQELBQADggEBAKWo18E79zWY3nEnAgwXcHI0s33viYBb\nqun+UJWLyXjrMQCvfmINGPbR4UniF2t3b1aBl9QOZAIzVvqcxbKLNnxPWWFibMPn\nfHQmPEU1irUJ4xjjZzrq/iLX4Qw9TuMihVH/TCaPXQAAeaddGvYJZxeR2YxbJ25k\nzTIf9GDBZNENe48j+M/aYUx9zke42OBoF6LTK4567LOmYsLBsTs3w18Zd/gsSWEt\neSOFiv/FXhbB/ndB/pvd+8rmSoCuzo2SXQqQuUS6jS1yXHKA6YlYNGdTMRqp4eHc\nHIbxcUn98Tlia1I0KMK6H0v1uTSF8RgOrFZO288taqy0E5VShUyD0kA=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300068
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44310
received auth hello!
{ authId: 503, nonce: <Buffer 3f a4 5f e8 e8 37 38 56> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 47 d1 91 9d 81 45 1d 0f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 0a 5c 78 fe 81 a9 1e 9e 65 42 64 56 fd 45 35 4a>,
  macKeyVal: <Buffer a5 a1 a7 21 d4 ff 46 ca 78 a0 51 07 04 06 8c 87 e8 2c d2 31 c9 12 21 2a 8a 71 6a 94 50 ef e0 97>,
  absValidity: 2018-08-27T08:01:19.812Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 87 6a dd c1 9c b1 55 93>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 87 6a dd c1 9c b1 55 93> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.53:39040',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300078
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44534
received auth hello!
{ authId: 503, nonce: <Buffer ea 34 f4 cb 34 f4 54 b5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 34 d8 7e d4 43 6a de 75>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 73 2b ba 40 48 c1 04 ec>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 73 2b ba 40 48 c1 04 ec> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.53:39264',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300088
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44756
received auth hello!
{ authId: 503, nonce: <Buffer 3d 38 d7 d0 91 1c 37 59> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 07 32 8d d0 3b 5b a1 7e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 32 8a 44 eb f0 5b 0b ac>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 32 8a 44 eb f0 5b 0b ac> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.53:39486',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300098
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44974
received auth hello!
{ authId: 503, nonce: <Buffer 49 df a0 73 76 cc 67 ab> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5f bf 9e 72 b8 5d e7 4a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2b 89 5e 9d c6 6c b3 c6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2b 89 5e 9d c6 6c b3 c6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.53:39704',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300108
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45196
received auth hello!
{ authId: 503, nonce: <Buffer a0 90 46 1c d1 c5 21 1b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 70 65 8a 2f af 8e e2 d8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer eb 10 00 4f 48 93 b5 c6>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer eb 10 00 4f 48 93 b5 c6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.53:39926',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300118
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45418
received auth hello!
{ authId: 503, nonce: <Buffer 7c 46 b8 92 8d 38 75 4b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ba 05 1f 5a a8 9a a6 bb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 47 65 d9 6f f7 01 24 1a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 47 65 d9 6f f7 01 24 1a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.53:40148',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300128
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45640
received auth hello!
{ authId: 503, nonce: <Buffer 05 85 63 88 12 05 77 5f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5e 73 a6 c1 2f 70 ef 06>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2f 6e 94 d1 db 1a 49 6b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 2f 6e 94 d1 db 1a 49 6b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.53:40370',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300138
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45862
received auth hello!
{ authId: 503, nonce: <Buffer 1b 1c 20 fa 7d a0 2b 21> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6b d9 c2 0a f5 53 44 8d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 72 be 55 86 72 7f 69 60>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 72 be 55 86 72 7f 69 60> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.53:40592',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300148
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46084
received auth hello!
{ authId: 503, nonce: <Buffer 0d e1 60 a9 9d 4b d9 69> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 62 17 03 2d a0 86 2e 04>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c5 a8 bb 5c 80 6c 73 b2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c5 a8 bb 5c 80 6c 73 b2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.53:40814',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300158
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46306
received auth hello!
{ authId: 503, nonce: <Buffer f2 a0 a9 2a 53 00 1f 5b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0c f4 b9 de 5b 43 48 f5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d7 41 fa 12 60 35 d7 8b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d7 41 fa 12 60 35 d7 8b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.53:41036',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300168
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46528
received auth hello!
{ authId: 503, nonce: <Buffer 03 e9 5a 87 e5 7b 17 14> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 40 53 79 65 07 f9 c9 15>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 89 44 a6 c8 dc df cb 99>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 89 44 a6 c8 dc df cb 99> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.53:41258',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300178
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46750
received auth hello!
{ authId: 503, nonce: <Buffer 17 20 78 6f 47 69 54 0c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9e 64 f3 a7 f4 3e ab 02>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 41 2b 3f 07 0a 9c a9 aa>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 41 2b 3f 07 0a 9c a9 aa> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.53:41480',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300188
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46972
received auth hello!
{ authId: 503, nonce: <Buffer 62 96 96 a5 ec 11 a8 30> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cf 3e 08 1e 2a 9a 70 26>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 85 e6 d1 92 d5 04 cf b6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 85 e6 d1 92 d5 04 cf b6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.53:41702',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300198
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47194
received auth hello!
{ authId: 503, nonce: <Buffer 71 52 ee 2b 1d 6f 5b 5e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e0 cc 63 66 22 89 07 5e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a7 b0 6e 23 99 12 06 38>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a7 b0 6e 23 99 12 06 38> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.53:41924',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300208
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47420
received auth hello!
{ authId: 503, nonce: <Buffer 68 27 14 86 bd 17 5e cd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 27 a8 51 e3 03 f3 f7 bb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0d 0c d5 69 4f 34 16 9e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0d 0c d5 69 4f 34 16 9e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.53:42150',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300218
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47642
received auth hello!
{ authId: 503, nonce: <Buffer 8a 86 95 b6 2d ad 4c 39> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f9 1f 57 f1 61 45 85 87>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer af 62 db dc 92 88 8a 7d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer af 62 db dc 92 88 8a 7d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.53:42372',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
