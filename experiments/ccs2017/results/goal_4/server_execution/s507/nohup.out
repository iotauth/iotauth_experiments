changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s507.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's507',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 51 49 42 41 41 4b 43 41 51 45 41 71 32 ... > }
Handler: listening on port 22100
s507:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100007
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34398
received auth hello!
{ authId: 501, nonce: <Buffer 33 b0 99 fb f8 55 62 bc> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 8f a0 89 a7 b1 d5 3b a3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 0f d2 3e 63 d4 3d 22 ad 2d 26 94 84 98 18 54 ac>,
  macKeyVal: <Buffer 5f 29 2d 1a 7e 09 81 3a 2c 9a 54 73 b5 54 43 0c 56 fd d4 fe d2 d2 df 35 b0 7f 8d 04 b3 79 53 b9>,
  absValidity: 2018-08-27T07:50:18.755Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 44 70 11 9c d8 ed 43 e7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 44 70 11 9c d8 ed 43 e7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.71:33502',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100015
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34670
received auth hello!
{ authId: 501, nonce: <Buffer 3f 46 fc cb 6a 27 58 01> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d7 27 1c cb c9 74 b7 f4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ca b5 97 c7 c9 02 88 54>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ca b5 97 c7 c9 02 88 54> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.71:33774',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100023
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34940
received auth hello!
{ authId: 501, nonce: <Buffer b5 7f 8a 3a 55 9e b7 09> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d0 dc 20 77 52 d8 40 25>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 01 1f 92 92 fe f6 96 47>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 01 1f 92 92 fe f6 96 47> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.71:34044',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100031
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35210
received auth hello!
{ authId: 501, nonce: <Buffer 57 71 ae 53 bf d8 ed 3b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f8 1a b1 e6 33 52 7f de>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 34 a4 2e 3a c8 b6 b9 bf>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 34 a4 2e 3a c8 b6 b9 bf> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.71:34314',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100039
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35480
received auth hello!
{ authId: 501, nonce: <Buffer d6 98 bd da 8b c2 db 5a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5b 44 b3 44 67 68 b6 f7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 19 d9 1b 6a 09 39 6c 34>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 19 d9 1b 6a 09 39 6c 34> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.71:34584',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100047
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35750
received auth hello!
{ authId: 501, nonce: <Buffer c7 a6 4e 38 4c 57 e5 c4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 96 32 47 72 69 f2 a2 74>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 47 07 a2 6f f7 10 47 91>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 47 07 a2 6f f7 10 47 91> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.71:34854',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100055
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36016
received auth hello!
{ authId: 501, nonce: <Buffer 29 db 53 d1 bd e6 63 81> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 15 36 2a 59 36 5c 0d 75>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a6 38 1c 99 e2 fd 5f 0e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a6 38 1c 99 e2 fd 5f 0e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.71:35120',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200068
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200081
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 48714
received auth hello!
{ authId: 502, nonce: <Buffer f3 bd 34 13 40 d6 c1 bf> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '01657A234AEA',
  notBefore: 2018-08-27T06:45:57.000Z,
  notAfter: 2018-08-28T06:47:37.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'A7:B6:57:69:93:F1:74:B8:2F:84:21:C0:E9:FE:BB:EC:DE:C7:AC:73',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'E67D8D8DE1FDDD2C2465EAD2E2C8469468E30C862129741C44CD759698CE97A1EBFCBA21D764D410591EE7063D4A632FD29AD3449C9B0DFBC9FF499E509A0969E40EA76C3AE2863ACBBC992A983F178890D4B1E505497F0A52900EFB38BDD51ED38CC446055817F90C1C892D25C947EE3AE8A8349A59E52B167953D94E0FB0082EE1A41137CB068ACD59E4752201F98ECA9664AD60B18C32213DF2545F63BF81939F78FABD925C71CDEE8114C56A96C1A70FD25E90066AB4026471D8372D30665DAC9B54EC472D58F09A4903599BC5D9C556B25898BAB963E93DFAC900B67CF7D3E060D71817CE9CF36D42A16F7BA93CBD3440B1A754DA038A8AD0D4430E66E7',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWV6I0rqMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDgy\nNzA2NDU1N1oXDTE4MDgyODA2NDczN1owYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDmfY2N4f3dLCRl6tLiyEaUaOMMhiEpdBxEzXWWmM6Xoev8uiHX\nZNQQWR7nBj1KYy/SmtNEnJsN+8n/SZ5Qmglp5A6nbDrihjrLvJkqmD8XiJDUseUF\nSX8KUpAO+zi91R7TjMRGBVgX+QwciS0lyUfuOuioNJpZ5SsWeVPZTg+wCC7hpBE3\nywaKzVnkdSIB+Y7KlmStYLGMMiE98lRfY7+Bk594+r2SXHHN7oEUxWqWwacP0l6Q\nBmq0AmRx2DctMGZdrJtU7EctWPCaSQNZm8XZxVayWJi6uWPpPfrJALZ899PgYNcY\nF86c821CoW97qTy9NECxp1TaA4qK0NRDDmbnAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBADkNhcSp+RRg8Syi3B///rYO3Xa3x0P3\n3udQis0gykrPKfgpwJeo70xDRVpmE4VwMeb2g9XAiG5edfVR0hMhNvsMXVgMw39y\nBmbeL6rjGvfeNYmvOuX+adZ7Mbe69nwzMF18lcmywFmXR7+LD/haBZ5u0YVX+XYY\nHZ5mJ+5jgCUifecPUbDLxB4R0KQciWvMMwOrnN9Uj0TnX9rkXcQfxQjV8IhLq9IA\ntZNJ7K1iEXZFzT+3GYqF0BmoDcdiI2WX+bgmPmvkSgvDQaGMBghQEd/aZnRqLuhh\n2mGracqP+MGIHvFq7rv/DayVc5XQsb5Fp0YWMFwCmfNVHv5jGsTEbPc=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200094
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48940
received auth hello!
{ authId: 502, nonce: <Buffer be e0 57 a2 c1 b2 ff 89> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 82 af f3 16 b7 27 ba 51>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 8c 9a 14 8b 18 01 fb 38 1e 7c b5 64 dd 34 2f 98>,
  macKeyVal: <Buffer 91 bc 8c 19 84 8b 08 a6 01 ad b2 63 eb 8e 9e c3 ab 81 f3 92 af 56 c8 70 8c 13 b8 86 3e aa 51 d3>,
  absValidity: 2018-08-27T08:01:17.914Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e4 17 2c b9 c7 9b 2f 1f>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e4 17 2c b9 c7 9b 2f 1f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.71:36216',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200107
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49164
received auth hello!
{ authId: 502, nonce: <Buffer c1 44 e5 b8 0d e1 6c 82> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d6 df 18 23 24 a0 ba bd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 74 92 52 7e f0 23 61 73>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 74 92 52 7e f0 23 61 73> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.71:36440',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200120
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49386
received auth hello!
{ authId: 502, nonce: <Buffer 36 d6 e9 2a 80 a6 5c 8e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c7 0a 0b 2c 9f ab 4e 82>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 69 e3 0d 58 d7 f4 90 51>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 69 e3 0d 58 d7 f4 90 51> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.71:36662',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200133
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49604
received auth hello!
{ authId: 502, nonce: <Buffer 73 5e 6b f9 48 d1 23 21> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 03 36 be be 2e 56 45 2b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c1 dc fc 24 96 e5 6a b6>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c1 dc fc 24 96 e5 6a b6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.71:36880',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200146
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49826
received auth hello!
{ authId: 502, nonce: <Buffer 8b 58 f7 e8 4b fc e3 b0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bc ce 07 79 6a 7e 76 6a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a4 c4 f9 00 8b 44 b8 bc>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer a4 c4 f9 00 8b 44 b8 bc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.71:37102',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200159
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50048
received auth hello!
{ authId: 502, nonce: <Buffer 52 1b 0c 06 c1 6c 3b 57> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 54 28 b6 7d 66 3f b8 8e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 62 2f 11 2d 14 3d 1a ef>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 62 2f 11 2d 14 3d 1a ef> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.71:37324',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200172
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50270
received auth hello!
{ authId: 502, nonce: <Buffer e1 54 af 75 42 f0 e0 44> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 34 fe 55 88 7b f9 5d 72>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2d bb c7 3e d9 1e b7 0e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2d bb c7 3e d9 1e b7 0e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.71:37546',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200185
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50492
received auth hello!
{ authId: 502, nonce: <Buffer 21 62 ec f4 1e 9b ba 90> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4e c8 2b da 6e 4e de d6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8e 7f 8f 90 31 e3 b8 ef>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8e 7f 8f 90 31 e3 b8 ef> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.71:37768',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200198
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50714
received auth hello!
{ authId: 502, nonce: <Buffer 67 d4 bd 11 9f e8 ed b2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ce 74 13 26 c4 74 44 c8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b1 47 32 44 6e 2b 25 6d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b1 47 32 44 6e 2b 25 6d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.71:37990',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200211
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50936
received auth hello!
{ authId: 502, nonce: <Buffer 29 60 f3 4f 71 1f 4f 3e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 74 c5 3f 91 91 57 2e f8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c5 a7 cd 16 b3 61 d8 9b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c5 a7 cd 16 b3 61 d8 9b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.71:38212',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200224
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51158
received auth hello!
{ authId: 502, nonce: <Buffer cb 10 91 48 fd 8a ca c6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9f db f6 bc 08 6f 49 a6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 08 36 02 b2 4f e0 d2 0b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 08 36 02 b2 4f e0 d2 0b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.71:38434',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200237
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51380
received auth hello!
{ authId: 502, nonce: <Buffer a5 f5 20 86 d0 e2 54 c3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 41 55 18 b6 df 3d 35 a2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 57 56 08 0e f4 fd 73 37>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 57 56 08 0e f4 fd 73 37> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.71:38656',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200250
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51602
received auth hello!
{ authId: 502, nonce: <Buffer 49 84 73 87 ff 92 f8 51> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ec 68 13 08 d2 3e 4a 83>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4c ed 84 3c d0 bb 47 55>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4c ed 84 3c d0 bb 47 55> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.71:38878',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200263
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51824
received auth hello!
{ authId: 502, nonce: <Buffer c3 2a 9e 67 f4 0e 26 45> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a7 32 f4 a9 fe 4b 8e 81>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bb e1 ff c7 29 74 2d b4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bb e1 ff c7 29 74 2d b4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.71:39100',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200276
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52050
received auth hello!
{ authId: 502, nonce: <Buffer fc 9f 82 70 52 23 3c f3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b5 d4 46 44 39 77 64 69>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 68 da ae 1f db 82 55 d8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 68 da ae 1f db 82 55 d8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.71:39326',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200289
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52272
received auth hello!
{ authId: 502, nonce: <Buffer 51 03 4d b7 1b 04 5d 52> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1f b1 b9 72 ec b3 00 be>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 41 28 d1 0a 9f 5a 68 90>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 41 28 d1 0a 9f 5a 68 90> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.71:39548',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200302
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52460
received auth hello!
{ authId: 502, nonce: <Buffer 9d a7 18 e6 fe 44 6e a0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 37 09 07 9b 9b 0c 5f 77>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8b 68 b7 2f 2f 98 17 f8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8b 68 b7 2f 2f 98 17 f8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.71:39736',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200314
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52588
received auth hello!
{ authId: 502, nonce: <Buffer 7f 0d c2 b5 bb 02 68 6c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a7 a2 bb 68 71 af 55 8b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fa a1 be a2 e7 87 08 60>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer fa a1 be a2 e7 87 08 60> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 24,
  remoteAddress: '::ffff:10.0.1.71:39864',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 24 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 24 }
specified socketID: 24
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #24 closed
