changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s519.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's519',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 6f 4b ... > }
Handler: listening on port 22100
s519:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400006
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57156
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400007
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57174
received auth hello!
{ authId: 504, nonce: <Buffer 4c 9c 06 7f e9 da 47 63> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 19 4c a3 59 a9 5c 05 81>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer d6 f0 33 e7 4e 34 cb 0f 51 03 ae 32 91 b4 a4 d3>,
  macKeyVal: <Buffer c6 7b 83 5a c3 cb 50 ec 87 8d 6f 76 65 e9 dd 3a 31 3e 83 fd 18 41 14 aa ff fe b0 f6 59 ef 65 1c>,
  absValidity: 2018-08-27T07:51:14.542Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 89 85 a6 b4 18 e6 b8 ee>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 89 85 a6 b4 18 e6 b8 ee> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.86:51616',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer 20 49 16 df fa e4 ee e2> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 8e 2e f6 36 f8 8a 28 2a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer ae 21 67 39 12 8b 34 2e f3 62 ab a1 64 22 e3 c7>,
  macKeyVal: <Buffer 3f e9 0d 9f bc b2 21 50 49 ef aa 49 e6 aa 5e 42 87 d3 21 79 e4 63 42 d2 ca 2c 98 06 c5 20 11 60>,
  absValidity: 2018-08-27T07:51:16.272Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c9 7a 3f b4 dd a4 d8 88>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c9 7a 3f b4 dd a4 d8 88> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.87:41726',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400012
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57426
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400013
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57440
received auth hello!
{ authId: 504, nonce: <Buffer c3 12 73 4a 65 5c a2 da> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ae 06 ac e5 83 7e 01 e9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 65 81 3a f9 64 31 bb c9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 65 81 3a f9 64 31 bb c9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.86:51884',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer 23 d1 fb e9 3d c5 ed 73> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3d 63 83 0b af f9 1a ad>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 79 70 05 8c 9a ec 24 a4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 79 70 05 8c 9a ec 24 a4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.87:41996',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400018
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57696
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received auth hello!
{ authId: 504, nonce: <Buffer 99 40 70 88 20 b0 0c cc> }
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400019
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 84 15 11 b4 eb dc f1 bf>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f1 1f 4c 18 23 27 d2 0d>
switching to HANDSHAKE_2_SENT
disconnected from auth
connected to auth! from local port 57714
received session key handshake3!
{ replyNonce: <Buffer f1 1f 4c 18 23 27 d2 0d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.86:52156',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer a2 ef 5e f3 79 50 52 82> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d0 a9 68 22 a6 a6 91 db>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5d fc 9b c5 9d f2 1d 81>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 5d fc 9b c5 9d f2 1d 81> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.87:42268',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400024
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57966
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400025
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
received auth hello!
{ authId: 504, nonce: <Buffer c9 c1 27 7c 87 48 b8 8c> }
connected to auth! from local port 57984
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bc ec 58 74 04 36 1f 83>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0e d5 67 23 75 3e 80 ba>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0e d5 67 23 75 3e 80 ba> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.86:52424',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer 52 61 cf 23 f8 57 16 7d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d0 5c 99 de 4a 3e 55 94>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c5 e1 bb 14 c9 de 5e 65>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c5 e1 bb 14 c9 de 5e 65> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.87:42538',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400030
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58234
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400031
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58252
received auth hello!
{ authId: 504, nonce: <Buffer 26 9c 36 9f be 5b 70 9b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ab 6d 28 ca 82 46 aa 03>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 84 d1 0a 82 93 66 ec f7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 84 d1 0a 82 93 66 ec f7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.86:52694',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer 30 c0 a4 93 42 3e ad 9c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0f 14 8f d7 de 20 58 5e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 19 0b c2 1d bf 4c 19 44>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 19 0b c2 1d bf 4c 19 44> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.87:42808',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400036
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58506
received auth hello!
{ authId: 504, nonce: <Buffer eb c3 c6 e9 ed eb 8d dd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 70 51 d7 3d de 43 56 94>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b1 ca 01 df 97 ec 61 d0>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b1 ca 01 df 97 ec 61 d0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.86:52964',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100068
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100077
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100079
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in server - details: handshake2 timed out...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in server - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.4:21100
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in server - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 3
Handler: Error in server - details: Error occurred in migration request: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 4
Handler: Error in server - details: Error occurred in migration request: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100088
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100090
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 33888
connected to auth! from local port 33890
received auth hello!
{ authId: 502, nonce: <Buffer b4 cb 97 9c 96 6c 98 82> }
received auth hello!
{ authId: 502, nonce: <Buffer 02 c3 c3 02 12 3c ce 5f> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth504',
     commonName: '10.0.0.7' },
  serial: '01657A2353BC',
  notBefore: 2018-08-27T06:46:00.000Z,
  notAfter: 2018-08-28T06:47:40.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '11:F3:0E:D9:B0:6A:14:98:9C:6E:86:75:FC:55:22:B5:E2:F1:BE:84',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'E67D8D8DE1FDDD2C2465EAD2E2C8469468E30C862129741C44CD759698CE97A1EBFCBA21D764D410591EE7063D4A632FD29AD3449C9B0DFBC9FF499E509A0969E40EA76C3AE2863ACBBC992A983F178890D4B1E505497F0A52900EFB38BDD51ED38CC446055817F90C1C892D25C947EE3AE8A8349A59E52B167953D94E0FB0082EE1A41137CB068ACD59E4752201F98ECA9664AD60B18C32213DF2545F63BF81939F78FABD925C71CDEE8114C56A96C1A70FD25E90066AB4026471D8372D30665DAC9B54EC472D58F09A4903599BC5D9C556B25898BAB963E93DFAC900B67CF7D3E060D71817CE9CF36D42A16F7BA93CBD3440B1A754DA038A8AD0D4430E66E7',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWV6I1O8MA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDQxETAPBgNVBAMMCDEwLjAuMC43MB4XDTE4MDgy\nNzA2NDYwMFoXDTE4MDgyODA2NDc0MFowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDmfY2N4f3dLCRl6tLiyEaUaOMMhiEpdBxEzXWWmM6Xoev8uiHX\nZNQQWR7nBj1KYy/SmtNEnJsN+8n/SZ5Qmglp5A6nbDrihjrLvJkqmD8XiJDUseUF\nSX8KUpAO+zi91R7TjMRGBVgX+QwciS0lyUfuOuioNJpZ5SsWeVPZTg+wCC7hpBE3\nywaKzVnkdSIB+Y7KlmStYLGMMiE98lRfY7+Bk594+r2SXHHN7oEUxWqWwacP0l6Q\nBmq0AmRx2DctMGZdrJtU7EctWPCaSQNZm8XZxVayWJi6uWPpPfrJALZ899PgYNcY\nF86c821CoW97qTy9NECxp1TaA4qK0NRDDmbnAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAH8sD1z6T7fG+IybrOfEfx5ynQnv+U9C\nJZvlV5nW1kNuWFYdpJ4J15ndXpdwPi7NkHI8FYydkLtPPCYpCJcJWj3uvzOjgkkL\n4Vgtcc39JV0tIPmioTIBe55pYSGXsWLD2ZlxNWavuFnlmFYglu83V+W1unXQMZsp\n89nUOh5GOz1n4Oo9LfuL4ph37zO2rDxPXSkoxR1KmZOX2GodW/qWLPzfMSKgNbfU\ndlgmzKz1Qdj1AoqdIKr/xTjMj2fYL56C2hbFEWkJJx9VpNwHmC8QdPgxqGZhXfUT\nPoerAL97Co+KWl001r2Ejpk+olZ6zULC2k0qZXm69zT9KYZwLSO/PYE=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 1
to: 2
disconnected from auth
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth504',
     commonName: '10.0.0.7' },
  serial: '01657A2353BC',
  notBefore: 2018-08-27T06:46:00.000Z,
  notAfter: 2018-08-28T06:47:40.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '11:F3:0E:D9:B0:6A:14:98:9C:6E:86:75:FC:55:22:B5:E2:F1:BE:84',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'E67D8D8DE1FDDD2C2465EAD2E2C8469468E30C862129741C44CD759698CE97A1EBFCBA21D764D410591EE7063D4A632FD29AD3449C9B0DFBC9FF499E509A0969E40EA76C3AE2863ACBBC992A983F178890D4B1E505497F0A52900EFB38BDD51ED38CC446055817F90C1C892D25C947EE3AE8A8349A59E52B167953D94E0FB0082EE1A41137CB068ACD59E4752201F98ECA9664AD60B18C32213DF2545F63BF81939F78FABD925C71CDEE8114C56A96C1A70FD25E90066AB4026471D8372D30665DAC9B54EC472D58F09A4903599BC5D9C556B25898BAB963E93DFAC900B67CF7D3E060D71817CE9CF36D42A16F7BA93CBD3440B1A754DA038A8AD0D4430E66E7',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
disconnected from auth
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.7',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWV6I1O8MA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDQxETAPBgNVBAMMCDEwLjAuMC43MB4XDTE4MDgy\nNzA2NDYwMFoXDTE4MDgyODA2NDc0MFowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDmfY2N4f3dLCRl6tLiyEaUaOMMhiEpdBxEzXWWmM6Xoev8uiHX\nZNQQWR7nBj1KYy/SmtNEnJsN+8n/SZ5Qmglp5A6nbDrihjrLvJkqmD8XiJDUseUF\nSX8KUpAO+zi91R7TjMRGBVgX+QwciS0lyUfuOuioNJpZ5SsWeVPZTg+wCC7hpBE3\nywaKzVnkdSIB+Y7KlmStYLGMMiE98lRfY7+Bk594+r2SXHHN7oEUxWqWwacP0l6Q\nBmq0AmRx2DctMGZdrJtU7EctWPCaSQNZm8XZxVayWJi6uWPpPfrJALZ899PgYNcY\nF86c821CoW97qTy9NECxp1TaA4qK0NRDDmbnAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAH8sD1z6T7fG+IybrOfEfx5ynQnv+U9C\nJZvlV5nW1kNuWFYdpJ4J15ndXpdwPi7NkHI8FYydkLtPPCYpCJcJWj3uvzOjgkkL\n4Vgtcc39JV0tIPmioTIBe55pYSGXsWLD2ZlxNWavuFnlmFYglu83V+W1unXQMZsp\n89nUOh5GOz1n4Oo9LfuL4ph37zO2rDxPXSkoxR1KmZOX2GodW/qWLPzfMSKgNbfU\ndlgmzKz1Qdj1AoqdIKr/xTjMj2fYL56C2hbFEWkJJx9VpNwHmC8QdPgxqGZhXfUT\nPoerAL97Co+KWl001r2Ejpk+olZ6zULC2k0qZXm69zT9KYZwLSO/PYE=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 2
to: 0
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in server - details: Error occurred in migration request: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in server - details: Error occurred in migration request: Connection with Auth timed out...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100098
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100101
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 34114
received auth hello!
{ authId: 502, nonce: <Buffer 83 4e 09 24 ef 12 5f 4a> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth504',
     commonName: '10.0.0.7' },
  serial: '01657A2353BC',
  notBefore: 2018-08-27T06:46:00.000Z,
  notAfter: 2018-08-28T06:47:40.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '11:F3:0E:D9:B0:6A:14:98:9C:6E:86:75:FC:55:22:B5:E2:F1:BE:84',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'E67D8D8DE1FDDD2C2465EAD2E2C8469468E30C862129741C44CD759698CE97A1EBFCBA21D764D410591EE7063D4A632FD29AD3449C9B0DFBC9FF499E509A0969E40EA76C3AE2863ACBBC992A983F178890D4B1E505497F0A52900EFB38BDD51ED38CC446055817F90C1C892D25C947EE3AE8A8349A59E52B167953D94E0FB0082EE1A41137CB068ACD59E4752201F98ECA9664AD60B18C32213DF2545F63BF81939F78FABD925C71CDEE8114C56A96C1A70FD25E90066AB4026471D8372D30665DAC9B54EC472D58F09A4903599BC5D9C556B25898BAB963E93DFAC900B67CF7D3E060D71817CE9CF36D42A16F7BA93CBD3440B1A754DA038A8AD0D4430E66E7',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWV6I1O8MA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDQxETAPBgNVBAMMCDEwLjAuMC43MB4XDTE4MDgy\nNzA2NDYwMFoXDTE4MDgyODA2NDc0MFowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDmfY2N4f3dLCRl6tLiyEaUaOMMhiEpdBxEzXWWmM6Xoev8uiHX\nZNQQWR7nBj1KYy/SmtNEnJsN+8n/SZ5Qmglp5A6nbDrihjrLvJkqmD8XiJDUseUF\nSX8KUpAO+zi91R7TjMRGBVgX+QwciS0lyUfuOuioNJpZ5SsWeVPZTg+wCC7hpBE3\nywaKzVnkdSIB+Y7KlmStYLGMMiE98lRfY7+Bk594+r2SXHHN7oEUxWqWwacP0l6Q\nBmq0AmRx2DctMGZdrJtU7EctWPCaSQNZm8XZxVayWJi6uWPpPfrJALZ899PgYNcY\nF86c821CoW97qTy9NECxp1TaA4qK0NRDDmbnAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAH8sD1z6T7fG+IybrOfEfx5ynQnv+U9C\nJZvlV5nW1kNuWFYdpJ4J15ndXpdwPi7NkHI8FYydkLtPPCYpCJcJWj3uvzOjgkkL\n4Vgtcc39JV0tIPmioTIBe55pYSGXsWLD2ZlxNWavuFnlmFYglu83V+W1unXQMZsp\n89nUOh5GOz1n4Oo9LfuL4ph37zO2rDxPXSkoxR1KmZOX2GodW/qWLPzfMSKgNbfU\ndlgmzKz1Qdj1AoqdIKr/xTjMj2fYL56C2hbFEWkJJx9VpNwHmC8QdPgxqGZhXfUT\nPoerAL97Co+KWl001r2Ejpk+olZ6zULC2k0qZXm69zT9KYZwLSO/PYE=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 1
to: 2
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100109
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34316
received auth hello!
{ authId: 502, nonce: <Buffer fb fe f3 73 63 85 99 5d> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer e8 52 13 51 a8 e1 c4 63>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 42 2e 09 15 ca 95 eb 80 f9 24 c9 41 4b f4 96 5d>,
  macKeyVal: <Buffer 34 7a 4f e9 14 3d 7f 26 22 9f cd 8b 28 45 12 2a a8 ec 2a 10 93 84 c4 2e f7 62 90 a4 2e f5 07 71>,
  absValidity: 2018-08-27T08:03:11.508Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f6 e2 6d 98 53 a8 4c 1c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f6 e2 6d 98 53 a8 4c 1c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.86:54508',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100112
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34336
received auth hello!
{ authId: 502, nonce: <Buffer 30 16 ca 40 20 28 aa 08> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e1 3d bd 75 66 ea a1 10>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 65 dc 8c 9f f9 c6 26 34>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 65 dc 8c 9f f9 c6 26 34> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.87:44620',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100122
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34552
received auth hello!
{ authId: 502, nonce: <Buffer bb 03 98 90 90 a0 fb a2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a3 07 e3 8a d0 db 05 cf>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c6 8e 3d a3 43 d1 8f c2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c6 8e 3d a3 43 d1 8f c2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.87:44838',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100132
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34772
received auth hello!
{ authId: 502, nonce: <Buffer db fd ee f5 66 88 85 de> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 10 fb f5 b4 11 7e 8f a7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 49 ff 13 89 90 07 25 f0>
switching to HANDSHAKE_2_SENT
disconnected from auth
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
received session key handshake3!
{ replyNonce: <Buffer 49 ff 13 89 90 07 25 f0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.87:45058',
  status: 'open' }
Unidentified client connected
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100133
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34778
received auth hello!
{ authId: 502, nonce: <Buffer 70 bd f7 9f 65 77 66 05> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 13 ff 72 ad 8f 68 b5 bf>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9b 82 95 53 75 fe cf d3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9b 82 95 53 75 fe cf d3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.86:54968',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100143
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34988
received auth hello!
{ authId: 502, nonce: <Buffer 0a 93 c0 94 73 e3 61 ca> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ce b8 2b 95 a6 a5 2e 52>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ce 6e b2 c6 53 93 6b d9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ce 6e b2 c6 53 93 6b d9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.86:55178',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100144
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34998
received auth hello!
{ authId: 502, nonce: <Buffer f8 bc ae dc 1c fc 9c 3b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer de 36 23 35 52 ee fe f0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 75 98 f1 39 77 3e 54 23>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 75 98 f1 39 77 3e 54 23> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.87:45284',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100154
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35212
received auth hello!
{ authId: 502, nonce: <Buffer 8f 26 ae eb c2 25 d6 72> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer df b2 bc ed d9 03 04 a3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5b 34 40 01 46 8b a7 0b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5b 34 40 01 46 8b a7 0b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.86:55402',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100155
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35218
received auth hello!
{ authId: 502, nonce: <Buffer e5 59 a3 03 c0 b5 8b 8c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 04 28 b4 29 d2 1c c7 bb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c2 1e 2c 6c 43 88 ea d2>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c2 1e 2c 6c 43 88 ea d2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.87:45504',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100165
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35438
received auth hello!
{ authId: 502, nonce: <Buffer ff 83 df 33 03 c6 0c 28> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4a bb d4 a0 2a 1b 4a 80>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e8 3f fd 16 91 6f 62 59>
switching to HANDSHAKE_2_SENT
disconnected from auth
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
received session key handshake3!
{ replyNonce: <Buffer e8 3f fd 16 91 6f 62 59> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.87:45724',
  status: 'open' }
Unidentified client connected
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100166
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35444
received auth hello!
{ authId: 502, nonce: <Buffer 77 41 30 31 5c 9b 71 74> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4b 8f 0a 78 2b bd 22 51>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c5 c2 f3 0e 6c 14 f5 04>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c5 c2 f3 0e 6c 14 f5 04> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.86:55634',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100174
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35644
received auth hello!
{ authId: 502, nonce: <Buffer 74 80 0b 1b 4b 13 03 0c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 92 40 7c 25 6b a6 8b f2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cb 8a ee 41 b1 31 c6 a1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer cb 8a ee 41 b1 31 c6 a1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.86:55836',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100176
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35660
received auth hello!
{ authId: 502, nonce: <Buffer aa 4c 83 06 8d 93 9b 0e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ba b8 2a 81 d7 c5 48 eb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 42 4d 33 b0 53 5a 12 d2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 42 4d 33 b0 53 5a 12 d2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.87:45946',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100187
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35876
received auth hello!
{ authId: 502, nonce: <Buffer a7 b5 16 89 ee 4a 88 9f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f5 f5 e1 40 18 5d ca 65>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 92 b6 ff b1 7d d6 96 9f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 92 b6 ff b1 7d d6 96 9f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 24,
  remoteAddress: '::ffff:10.0.1.86:56068',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 24 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 24 }
specified socketID: 24
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100188
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35884
received auth hello!
{ authId: 502, nonce: <Buffer 85 a6 35 dd fb bf 87 3c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 98 03 59 23 81 ab 07 61>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2c 74 43 1f 9e 4f 83 be>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2c 74 43 1f 9e 4f 83 be> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 25,
  remoteAddress: '::ffff:10.0.1.87:46170',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 25 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 25 }
specified socketID: 25
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #24 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100198
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36102
received auth hello!
{ authId: 502, nonce: <Buffer 6f 6e 2f d1 87 1c ba 03> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1b 68 2b 1f 6f 79 c8 4c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2a 3f 39 85 39 a9 48 71>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2a 3f 39 85 39 a9 48 71> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 26,
  remoteAddress: '::ffff:10.0.1.86:56294',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 26 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 26 }
specified socketID: 26
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #25 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100199
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36108
received auth hello!
{ authId: 502, nonce: <Buffer 5e 61 67 f3 66 d6 56 9d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9b d8 36 86 b1 19 89 e8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d6 13 09 0a 71 03 56 dd>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d6 13 09 0a 71 03 56 dd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 27,
  remoteAddress: '::ffff:10.0.1.87:46394',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 27 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 27 }
specified socketID: 27
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #26 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100209
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36324
received auth hello!
{ authId: 502, nonce: <Buffer 37 56 46 f6 00 8e 0b 2b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c7 df 6b 60 2e 1d 37 f2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 26 83 ae 81 c0 10 64 04>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 26 83 ae 81 c0 10 64 04> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 28,
  remoteAddress: '::ffff:10.0.1.86:56516',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 28 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 28 }
specified socketID: 28
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #27 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100210
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36330
received auth hello!
{ authId: 502, nonce: <Buffer 86 1d 36 ef f8 b9 8d 1b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 89 84 0b cd 53 49 8f 95>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7f 8e df 8d 48 19 d6 35>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 7f 8e df 8d 48 19 d6 35> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 29,
  remoteAddress: '::ffff:10.0.1.87:46616',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 29 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 29 }
specified socketID: 29
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #28 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100220
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36544
received auth hello!
{ authId: 502, nonce: <Buffer f6 0d 2b a4 44 45 60 e2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a3 68 e3 da fc 47 6d e4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 24 47 19 fe 68 88 fe 74>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 24 47 19 fe 68 88 fe 74> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 30,
  remoteAddress: '::ffff:10.0.1.86:56734',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 30 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 30 }
specified socketID: 30
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #29 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100221
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36550
received auth hello!
{ authId: 502, nonce: <Buffer 75 1b 2a af ec 63 a8 fd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2b 49 d2 1d e5 e4 95 39>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e4 37 ba 28 47 80 4b 94>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e4 37 ba 28 47 80 4b 94> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 31,
  remoteAddress: '::ffff:10.0.1.87:46836',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 31 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 31 }
specified socketID: 31
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #30 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100231
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36768
received auth hello!
{ authId: 502, nonce: <Buffer 49 b1 6f 6e 62 ea 5e 01> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0b 50 a1 02 e8 01 87 36>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 66 6d 07 e5 80 84 f4 d5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 66 6d 07 e5 80 84 f4 d5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 32,
  remoteAddress: '::ffff:10.0.1.86:56960',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 32 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 32 }
specified socketID: 32
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #31 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100232
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36774
received auth hello!
{ authId: 502, nonce: <Buffer eb 5a 91 00 6a b4 18 8f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3c 69 15 b6 4a 4e 0b 3f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 62 18 b3 75 7f cd 82 a7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 62 18 b3 75 7f cd 82 a7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 33,
  remoteAddress: '::ffff:10.0.1.87:47060',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 33 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 33 }
specified socketID: 33
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #32 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100242
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36994
received auth hello!
{ authId: 502, nonce: <Buffer 79 49 23 73 42 4b cf b5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4b 4e f3 03 05 61 0b 36>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a6 32 9a c2 5e cc d3 1a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a6 32 9a c2 5e cc d3 1a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 34,
  remoteAddress: '::ffff:10.0.1.86:57186',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 34 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 34 }
specified socketID: 34
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #33 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100243
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37000
received auth hello!
{ authId: 502, nonce: <Buffer 56 71 af 25 21 b7 f0 34> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fd a5 31 0c db 5d 5d c5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 96 71 ad 29 b3 c1 a7 d9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 96 71 ad 29 b3 c1 a7 d9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 35,
  remoteAddress: '::ffff:10.0.1.87:47286',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 35 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 35 }
specified socketID: 35
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #34 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100253
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37214
received auth hello!
{ authId: 502, nonce: <Buffer 13 f5 eb c6 75 bb 19 c3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9e 3d 47 63 e2 da 97 ba>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ce ba 22 24 f7 82 ae a9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ce ba 22 24 f7 82 ae a9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 36,
  remoteAddress: '::ffff:10.0.1.86:57404',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 36 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 36 }
specified socketID: 36
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #35 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100254
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37222
received auth hello!
{ authId: 502, nonce: <Buffer 0f 3b d7 4c c5 b1 ac 77> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e4 e5 9d 79 2f bd f6 23>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 62 50 e2 96 92 ea 5b f7>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 62 50 e2 96 92 ea 5b f7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 37,
  remoteAddress: '::ffff:10.0.1.87:47506',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 37 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 37 }
specified socketID: 37
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #36 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100261
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37404
received auth hello!
{ authId: 502, nonce: <Buffer 3a 3f a1 3d 95 bb cd fc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer be 4a 51 f6 35 17 30 c4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d8 46 14 e6 37 4f ff cc>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d8 46 14 e6 37 4f ff cc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 38,
  remoteAddress: '::ffff:10.0.1.86:57596',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 38 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 38 }
specified socketID: 38
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #37 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100262
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37412
received auth hello!
{ authId: 502, nonce: <Buffer a8 55 2e a2 d3 2a f4 06> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a9 d5 7b b5 a7 18 4a 37>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ef 73 44 f5 27 e3 15 4a>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ef 73 44 f5 27 e3 15 4a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 39,
  remoteAddress: '::ffff:10.0.1.87:47698',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 39 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 39 }
specified socketID: 39
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #38 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100264
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37532
received auth hello!
{ authId: 502, nonce: <Buffer 4a 98 42 ac 1a c3 01 87> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 84 e3 11 c2 a1 ee 2f ff>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fa 3d 67 3f 1e d7 b8 a3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fa 3d 67 3f 1e d7 b8 a3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 40,
  remoteAddress: '::ffff:10.0.1.86:57724',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 40 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 40 }
specified socketID: 40
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #39 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100265
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37540
received auth hello!
{ authId: 502, nonce: <Buffer be 2d 34 e6 b0 17 ab ec> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e0 48 00 82 11 81 bc 5a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 82 ba dc 9a d1 a6 a2 9a>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 82 ba dc 9a d1 a6 a2 9a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 41,
  remoteAddress: '::ffff:10.0.1.87:47826',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 41 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 41 }
specified socketID: 41
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #40 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100267
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37638
received auth hello!
{ authId: 502, nonce: <Buffer c1 53 cd 9a d0 69 f2 07> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 87 96 86 cb df be e1 3f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 37 da 22 86 2b 12 2a d3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 37 da 22 86 2b 12 2a d3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 42,
  remoteAddress: '::ffff:10.0.1.86:57830',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 42 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 42 }
specified socketID: 42
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #41 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100268
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37644
received auth hello!
{ authId: 502, nonce: <Buffer ff 24 a1 4f ec 2e 74 50> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 29 2d 1f 07 c3 38 76 fe>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 90 87 1d 98 5d 1f 1b 65>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 90 87 1d 98 5d 1f 1b 65> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 43,
  remoteAddress: '::ffff:10.0.1.87:47930',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 43 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 43 }
specified socketID: 43
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #42 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100269
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37680
received auth hello!
{ authId: 502, nonce: <Buffer 98 c4 f1 bc 1c 0e 3e 40> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b2 5b e7 38 a0 2c c3 93>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4b a6 e0 73 e9 46 43 99>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4b a6 e0 73 e9 46 43 99> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 44,
  remoteAddress: '::ffff:10.0.1.86:57872',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 44 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 44 }
specified socketID: 44
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #43 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100270
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37686
received auth hello!
{ authId: 502, nonce: <Buffer 5b db 50 24 2a 4c b4 34> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c2 4e c2 96 22 66 8c a1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 09 76 57 47 27 93 f6 96>
switching to HANDSHAKE_2_SENT
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #44 closed
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 09 76 57 47 27 93 f6 96> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 45,
  remoteAddress: '::ffff:10.0.1.87:47972',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 45 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 45 }
specified socketID: 45
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #45 closed
