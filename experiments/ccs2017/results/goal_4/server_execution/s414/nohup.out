changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s414.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's414',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 70 35 ... > }
Handler: listening on port 22100
s414:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300000
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50324
received auth hello!
{ authId: 403, nonce: <Buffer cb 0e 5d 1d 53 bf ee ab> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 94 0a 3d 7f 86 da 45 58>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer f2 d1 2c c0 41 27 72 2d f2 e3 78 c3 45 30 9e 8f>,
  macKeyVal: <Buffer 31 b3 f1 b7 a4 fa 3f 6d 9c f0 63 81 25 58 11 a6 2f 88 6d fe 98 71 0e 72 66 62 08 d0 57 27 80 91>,
  absValidity: 2018-08-27T07:49:28.130Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0c 96 4c 59 8a cf 4b ee>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0c 96 4c 59 8a cf 4b ee> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.56:41680',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300006
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50516
received auth hello!
{ authId: 403, nonce: <Buffer 30 51 74 28 28 a5 d4 5e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2f 7c c9 f6 4a 9f 73 d7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cf a9 8b 25 8b 2f f2 a7>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer cf a9 8b 25 8b 2f f2 a7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.56:41872',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300012
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50788
received auth hello!
{ authId: 403, nonce: <Buffer 63 1b 76 f5 71 8e 27 1d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 53 06 27 74 ab ce 1b 66>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 73 61 ae 0c 08 dd 49 da>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 73 61 ae 0c 08 dd 49 da> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.56:42144',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300018
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51058
received auth hello!
{ authId: 403, nonce: <Buffer 54 53 86 7c ec 6d bc c2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fb 49 ac 72 ab f8 8f cb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0d 8d ac 9e a9 e3 4d cb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0d 8d ac 9e a9 e3 4d cb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.56:42414',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300024
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51328
received auth hello!
{ authId: 403, nonce: <Buffer c8 37 69 ac e5 83 58 51> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 98 32 e0 b3 63 e6 bf 50>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1f 26 a7 1c c8 84 8b d7>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 1f 26 a7 1c c8 84 8b d7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.56:42684',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300030
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51598
received auth hello!
{ authId: 403, nonce: <Buffer 77 1f d1 c3 f4 db 43 a1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bf 92 3b 05 bc 84 9f 99>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e6 ef 95 79 41 7a 17 79>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e6 ef 95 79 41 7a 17 79> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.56:42954',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300036
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51868
received auth hello!
{ authId: 403, nonce: <Buffer 79 7f 76 ae 0a 59 f6 eb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 08 d0 f2 18 ea 5f 61 17>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8e 99 c8 a9 d3 bd 91 1a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8e 99 c8 a9 d3 bd 91 1a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.56:43224',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300042
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52130
received auth hello!
{ authId: 403, nonce: <Buffer 31 db 18 d7 98 67 c8 34> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 19 e3 e4 e6 97 c4 4c 25>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a1 3c 73 2a c6 71 ed 32>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a1 3c 73 2a c6 71 ed 32> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.56:43486',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
