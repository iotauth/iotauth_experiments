changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s506.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's506',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 72 75 ... > }
Handler: listening on port 22100
s506:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100006
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34986
received auth hello!
{ authId: 501, nonce: <Buffer 3a 62 db b8 a1 2c 70 15> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 56 45 3e 66 e5 0b 41 fe>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 63 4e 07 8f af 84 8f 05 bc c7 ba 66 8d bf 64 bd>,
  macKeyVal: <Buffer a3 cb d6 9c ad b0 05 18 09 2f 0b e4 df 2a d6 ff d9 50 c3 7a 13 59 fb a3 17 9e 6e d5 a0 e6 e1 a4>,
  absValidity: 2018-08-27T07:50:14.794Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b3 7d cf 88 de 0a ad db>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b3 7d cf 88 de 0a ad db> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.70:34520',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100014
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35258
received auth hello!
{ authId: 501, nonce: <Buffer 42 b5 65 af 01 47 67 6d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2d 41 9f 6e ad 1f 45 cc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 24 0c 8d 9e 8d 57 ef 2e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 24 0c 8d 9e 8d 57 ef 2e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.70:34790',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100022
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35528
received auth hello!
{ authId: 501, nonce: <Buffer 14 d5 e0 31 51 b6 d1 b4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 37 1b 45 b2 07 e3 c8 80>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3c 2c 60 5d 51 17 28 55>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3c 2c 60 5d 51 17 28 55> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.70:35062',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100030
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35798
received auth hello!
{ authId: 501, nonce: <Buffer 61 68 3f e4 47 7b ea a6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9a 53 a8 16 d5 d3 68 63>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a4 bb 35 35 e0 7f 1a 91>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer a4 bb 35 35 e0 7f 1a 91> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.70:35330',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100038
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36068
received auth hello!
{ authId: 501, nonce: <Buffer 20 16 4c 74 8a 08 d5 57> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b9 cb 91 3c ea 0f 3b af>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ad 06 0b 56 d6 0d 24 56>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ad 06 0b 56 d6 0d 24 56> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.70:35600',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100046
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36338
received auth hello!
{ authId: 501, nonce: <Buffer cb 32 e4 6f dc 21 2c f6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 68 7b 1f b6 58 16 b1 56>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 06 10 f0 14 11 7e 74 c2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 06 10 f0 14 11 7e 74 c2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.70:35872',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100054
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36604
received auth hello!
{ authId: 501, nonce: <Buffer de 71 bc 2c 50 8d f3 d0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bd 77 9c de b9 65 91 ca>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 69 4c ef a3 cf 33 bf 30>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 69 4c ef a3 cf 33 bf 30> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.70:36138',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
