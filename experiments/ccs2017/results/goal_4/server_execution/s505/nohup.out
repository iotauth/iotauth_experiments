changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s505.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's505',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 51 49 42 41 41 4b 43 41 51 45 41 70 4c ... > }
Handler: listening on port 22100
s505:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100004
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54664
received auth hello!
{ authId: 501, nonce: <Buffer 6d 3d 70 94 e5 2c a5 ee> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer ab 13 ac fd 13 46 54 6c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 60 30 ab f3 51 a3 0a a4 5e 34 71 44 cc 61 10 f0>,
  macKeyVal: <Buffer d0 b3 76 49 6e 3b a2 06 4a 6f f1 7a f5 ca c0 d7 a4 16 5c ed b3 85 86 a4 9d 46 c3 bc 1b 34 b0 f0>,
  absValidity: 2018-08-27T07:50:07.690Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 80 8f b8 4d e4 0a e0 d5>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 80 8f b8 4d e4 0a e0 d5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.68:41264',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100005
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54676
received auth hello!
{ authId: 501, nonce: <Buffer 79 62 b0 db 3c 75 77 f5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bd a3 3e 4e 58 a1 0a e2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 80 2f 9d 9a 7e de cd cf>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 80 2f 9d 9a 7e de cd cf> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.69:49616',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100012
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54926
received auth hello!
{ authId: 501, nonce: <Buffer 18 3b f3 41 fa bb f4 b4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 60 71 46 45 6d f4 5e e1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b9 78 ec a4 b2 f5 74 95>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b9 78 ec a4 b2 f5 74 95> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.68:41526',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100013
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54944
received auth hello!
{ authId: 501, nonce: <Buffer fa 54 37 21 86 4b 4c a6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3b 18 aa e0 a0 15 33 0e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 37 4e f7 db 9d d2 a6 7f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 37 4e f7 db 9d d2 a6 7f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.69:49884',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100020
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55196
received auth hello!
{ authId: 501, nonce: <Buffer f3 eb cf e9 ba 58 9d 74> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 55 f7 6c d9 37 d5 92 c6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a6 01 d2 a3 f2 03 30 01>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a6 01 d2 a3 f2 03 30 01> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.68:41796',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100021
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55214
received auth hello!
{ authId: 501, nonce: <Buffer ca b0 4a 2d 17 07 ff 49> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 48 e5 84 c3 c5 79 43 9f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a8 91 c5 18 48 fd 6c ef>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a8 91 c5 18 48 fd 6c ef> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.69:50154',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100028
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55466
received auth hello!
{ authId: 501, nonce: <Buffer cb 1e 24 00 55 3e 52 35> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 02 96 a9 e9 f1 3d 1e 57>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 33 e0 9d 74 7c 9b b3 0f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 33 e0 9d 74 7c 9b b3 0f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.68:42066',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100029
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55484
received auth hello!
{ authId: 501, nonce: <Buffer af c2 2e ba 8d 63 86 49> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 24 74 43 1a 9a c8 b5 d1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1e 10 99 54 e2 78 e6 24>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 1e 10 99 54 e2 78 e6 24> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.69:50424',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100036
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55736
received auth hello!
{ authId: 501, nonce: <Buffer 6a 08 7b d3 df 2c 23 e2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c5 f0 b1 8a a8 f6 47 98>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cd f3 07 0a d4 bd 6a e0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer cd f3 07 0a d4 bd 6a e0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.68:42336',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100037
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55754
received auth hello!
{ authId: 501, nonce: <Buffer 95 78 fb 52 b5 b8 fc a6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fa 52 66 d8 b7 96 cc 6f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fe 8e cb 3f 26 18 9a e0>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer fe 8e cb 3f 26 18 9a e0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.69:50694',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100044
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56006
received auth hello!
{ authId: 501, nonce: <Buffer 4c 1f 13 10 74 d0 5b 17> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1f 55 18 c1 b7 b3 29 c7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 24 c7 05 7b a0 40 70 a0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 24 c7 05 7b a0 40 70 a0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.68:42606',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100045
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56024
received auth hello!
{ authId: 501, nonce: <Buffer 35 d9 cf 11 56 69 01 e8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3f 31 b1 9d 45 82 7f fe>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d2 bd 62 41 7b 2d 95 ce>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d2 bd 62 41 7b 2d 95 ce> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.69:50964',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100052
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56276
received auth hello!
{ authId: 501, nonce: <Buffer 02 f4 a9 22 31 84 e4 9f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fb 55 9c 24 c5 8b 38 59>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 82 51 09 a5 b8 00 7b 30>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 82 51 09 a5 b8 00 7b 30> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.68:42876',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100053
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56294
received auth hello!
{ authId: 501, nonce: <Buffer a6 4b cb eb a9 f2 25 77> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c1 09 dd 65 64 cb 35 91>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 23 cd 81 97 45 5c b4 01>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 23 cd 81 97 45 5c b4 01> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.69:51234',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
