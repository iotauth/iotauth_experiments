changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s416.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's416',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 76 7a ... > }
Handler: listening on port 22100
s416:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300004
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50672
received auth hello!
{ authId: 403, nonce: <Buffer a7 f2 07 48 77 56 7b b4> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 1a c7 2b e4 6a c4 4a 1c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 2c 3e e4 b0 05 c4 30 78 8a ab d8 3d b7 87 3f 63>,
  macKeyVal: <Buffer 4c dc 0b 27 32 aa 2e 39 15 72 6b 0b 97 cb 5e c2 e9 4b 75 15 68 fe f0 be bd 40 ab 9a d0 b8 3a d4>,
  absValidity: 2018-08-27T04:33:29.455Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bc 89 a1 5e b8 15 e2 18>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer bc 89 a1 5e b8 15 e2 18> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.60:56348',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300005
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50684
received auth hello!
{ authId: 403, nonce: <Buffer 37 bc 34 11 73 02 01 6b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a8 96 eb 93 99 47 b4 db>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b0 10 86 be 84 2f 6e 04>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b0 10 86 be 84 2f 6e 04> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.61:37162',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300010
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50902
received auth hello!
{ authId: 403, nonce: <Buffer 28 37 01 ac 55 98 bd 28> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a4 57 c3 25 e8 e3 9c d7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8f 62 3b 03 fc 07 53 86>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 8f 62 3b 03 fc 07 53 86> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.60:56578',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300011
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50918
received auth hello!
{ authId: 403, nonce: <Buffer 76 e0 cc a3 c8 b4 70 ef> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e9 43 38 20 34 84 0e f7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5f f8 83 d9 0b d9 dd de>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5f f8 83 d9 0b d9 dd de> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.61:37398',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300016
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51172
received auth hello!
{ authId: 403, nonce: <Buffer 9d 5d 9a 37 96 92 97 60> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 44 77 28 c2 90 46 eb 14>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer dd b2 d2 2d 77 46 60 2c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer dd b2 d2 2d 77 46 60 2c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.60:56848',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300017
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51188
received auth hello!
{ authId: 403, nonce: <Buffer df 3a 1c 80 dc c8 77 0d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 62 3c 6a 4e 1d fc 7f 45>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 57 58 e7 df 59 df 11 37>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 57 58 e7 df 59 df 11 37> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.61:37668',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300022
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51442
received auth hello!
{ authId: 403, nonce: <Buffer 30 93 bf 1c 98 3c 21 f5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1d 02 73 df 90 09 9c 3a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 21 70 6f 61 b9 3d 7f 1b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 21 70 6f 61 b9 3d 7f 1b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.60:57118',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300023
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51458
received auth hello!
{ authId: 403, nonce: <Buffer 0c b1 5a 96 eb 07 f5 a1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 00 43 53 92 3f eb a7 be>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 35 ed 15 f5 19 67 a5 76>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 35 ed 15 f5 19 67 a5 76> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.61:37938',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300028
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51712
received auth hello!
{ authId: 403, nonce: <Buffer 34 1a 59 15 4c 78 78 e0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 98 52 27 d1 ac e9 73 0b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 55 75 c4 68 1a a6 53 cf>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 55 75 c4 68 1a a6 53 cf> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.60:57388',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300029
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51728
received auth hello!
{ authId: 403, nonce: <Buffer 8a 24 8c ab e0 e5 b9 6b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4a ce 5a 00 72 b9 f1 eb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c6 2b 40 93 cb 54 3a a4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c6 2b 40 93 cb 54 3a a4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.61:38208',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300034
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51982
received auth hello!
{ authId: 403, nonce: <Buffer 15 39 73 ec f7 b7 8a 0f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1a e3 e3 32 8a 99 95 32>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer de 15 93 d3 09 02 64 51>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer de 15 93 d3 09 02 64 51> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.60:57658',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300035
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51998
received auth hello!
{ authId: 403, nonce: <Buffer 9f eb 97 3f 92 67 aa 3b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 34 ab 9e 49 9d 29 7f 68>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1c 44 70 b2 85 1a cf 91>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 1c 44 70 b2 85 1a cf 91> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.61:38478',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300040
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52252
received auth hello!
{ authId: 403, nonce: <Buffer 84 78 7f 2b ad e8 27 b3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer da 3b 51 3d 55 99 db cc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 43 5e 4f 6c e7 cf 07 60>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 43 5e 4f 6c e7 cf 07 60> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.60:57928',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300041
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52268
received auth hello!
{ authId: 403, nonce: <Buffer e9 3a ac c1 2c f5 64 6b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e8 a5 3b 2b 57 69 e8 1b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a9 d0 29 87 ab 19 4c 3b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer a9 d0 29 87 ab 19 4c 3b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.61:38748',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300046
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52518
received auth hello!
{ authId: 403, nonce: <Buffer 3d ff 61 8d be 5a 10 e2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2f 52 6d 16 98 66 ba 9f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 77 5f 33 ae 75 7c d4 d8>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 77 5f 33 ae 75 7c d4 d8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.60:58194',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300047
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52534
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
