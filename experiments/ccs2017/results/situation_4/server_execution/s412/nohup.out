changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s412.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's412',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 67 49 42 41 41 4b 43 41 51 45 41 77 2f ... > }
Handler: listening on port 22100
s412:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300001
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53214
received auth hello!
{ authId: 403, nonce: <Buffer 6d 84 14 dd f3 0a 06 01> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer eb bf bf a3 7d e4 0b 31>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 0a de ce 52 1c 30 69 0d 29 7a 19 f4 3a 51 b2 93>,
  macKeyVal: <Buffer 1e a6 55 2b 15 20 e2 3b bd 67 7d 6b 25 bf 9b 68 f3 3d 0a e6 04 39 bb bc 9d cc 33 13 28 36 5d 91>,
  absValidity: 2018-08-27T04:33:18.318Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a1 2d de 56 21 ef 7d 29>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer a1 2d de 56 21 ef 7d 29> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.57:42214',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300007
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53450
received auth hello!
{ authId: 403, nonce: <Buffer b7 e5 55 2a ea 28 8b 8d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 58 96 07 cb d7 7d a1 20>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9e c1 eb bd 9a 3f bd d3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9e c1 eb bd 9a 3f bd d3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.57:42450',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300013
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53720
received auth hello!
{ authId: 403, nonce: <Buffer 61 8c 44 86 77 5c 30 b6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 42 7c 20 0b 53 54 d3 b2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 04 65 0c 58 fe 17 bb 0c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 04 65 0c 58 fe 17 bb 0c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.57:42720',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300019
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53990
received auth hello!
{ authId: 403, nonce: <Buffer 15 e4 33 69 11 1c 4e 76> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9a 82 72 41 fe 3e ff 7a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 82 e4 66 56 e1 44 ee 6f>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 82 e4 66 56 e1 44 ee 6f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.57:42990',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300025
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54260
received auth hello!
{ authId: 403, nonce: <Buffer 09 e2 94 27 54 d3 4e df> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f7 36 8c 02 78 8e eb 8a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 59 ee 81 7c 70 7a 22 b4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 59 ee 81 7c 70 7a 22 b4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.57:43260',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300031
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54530
received auth hello!
{ authId: 403, nonce: <Buffer bf 50 56 f6 44 85 9e 50> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b6 f1 f9 eb 82 c5 1a b8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ec 3f 28 7a f9 43 ba 02>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ec 3f 28 7a f9 43 ba 02> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.57:43530',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300037
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54800
received auth hello!
{ authId: 403, nonce: <Buffer f8 ff 22 0c dd ec 4d 37> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8e 05 ae d8 86 b9 9b 69>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cb fb 8e 24 04 ef 06 1e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer cb fb 8e 24 04 ef 06 1e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.57:43798',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300043
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55066
received auth hello!
{ authId: 403, nonce: <Buffer 08 85 9f f3 c4 38 5f 60> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e0 01 b8 b9 71 bf 6b 2f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c5 c1 62 2d cb c9 f8 53>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c5 c1 62 2d cb c9 f8 53> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.57:44066',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
