changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s413.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's413',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 31 52 ... > }
Handler: listening on port 22100
s413:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300002
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51088
received auth hello!
{ authId: 403, nonce: <Buffer 74 83 f4 34 bb 6c bb 20> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 77 c2 41 d7 d5 0d 6b 07>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer f7 1d 6d 05 16 2c 35 cf a1 a0 e6 04 6d b2 60 1d>,
  macKeyVal: <Buffer f0 54 61 5d 3b e2 83 f4 88 22 4a 68 d5 c3 e5 56 18 5f 9e 5b 7d fa fb e6 28 47 ef c9 e9 15 09 24>,
  absValidity: 2018-08-27T04:33:21.525Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 36 19 1a aa 38 b8 44 80>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 36 19 1a aa 38 b8 44 80> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.58:43868',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300008
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51326
received auth hello!
{ authId: 403, nonce: <Buffer ae 80 ec fb 64 31 84 d4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3b 9f 1f 74 c4 62 b0 3e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ca 16 79 a0 c8 3a b4 94>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ca 16 79 a0 c8 3a b4 94> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.58:44104',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300014
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51596
received auth hello!
{ authId: 403, nonce: <Buffer 7a 81 70 d7 2a b7 92 9d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2c 2d c6 61 13 85 34 74>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2f 1f 75 52 68 b5 c2 d2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2f 1f 75 52 68 b5 c2 d2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.58:44374',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300020
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51866
received auth hello!
{ authId: 403, nonce: <Buffer 3f a6 c2 31 b0 d4 90 79> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 45 81 7f 74 bb 26 74 44>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e9 3e c7 ce 4b ac 8c 76>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e9 3e c7 ce 4b ac 8c 76> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.58:44644',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300026
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52136
received auth hello!
{ authId: 403, nonce: <Buffer 70 4b fe 60 64 76 7b 65> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4f 7f 0b 37 b2 5d 7f 6a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a8 41 aa b1 f7 39 21 90>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a8 41 aa b1 f7 39 21 90> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.58:44914',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300032
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52406
received auth hello!
{ authId: 403, nonce: <Buffer d8 f5 35 59 5c f7 4a 8e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b5 65 59 fc 86 a3 7f 33>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 64 7b dd 3b 4e 4c 9f f1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 64 7b dd 3b 4e 4c 9f f1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.58:45184',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300038
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52676
received auth hello!
{ authId: 403, nonce: <Buffer 98 5d 7e 44 a6 cc e8 97> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 88 4e c8 f0 21 d2 ee 7b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c7 e8 30 8e 3f 23 c4 cf>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c7 e8 30 8e 3f 23 c4 cf> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.58:45454',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300044
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52942
received auth hello!
{ authId: 403, nonce: <Buffer 56 64 17 6f 12 ce 9f 1e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1f 59 03 52 bb 73 cc d7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c1 53 07 a9 cc 39 44 37>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c1 53 07 a9 cc 39 44 37> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.58:45720',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
