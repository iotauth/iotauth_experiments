changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c411.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c411',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 51 49 42 41 41 4b 43 41 51 45 41 30 68 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1535340784754
connected to auth! from local port 38266
received auth hello!
{ authId: 402, nonce: <Buffer 2b a7 a7 ed 8c ba 3a ef> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 58 8d fe 1e 7e 0a 3a 6c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer c9 a6 50 7f 4a b3 09 38 6c fe 94 f4 c9 68 e8 1a>,
  macKeyVal: <Buffer b9 70 06 ba 59 da fd cf 9d cd 96 f1 a4 3e 0f a6 8d a8 8a bd 4a 9b b1 c6 95 db 32 c0 fc ca f0 c7>,
  absValidity: 2018-08-27T04:33:04.969Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200004,
  cipherKeyVal: <Buffer 28 97 4d 42 56 a2 7d 01 48 fa d6 cc c1 97 44 45>,
  macKeyVal: <Buffer 59 98 06 89 99 7d 04 16 fe 6b 2f 39 04 39 05 2e e2 4b b1 29 3a 80 0a 1c 71 bf 34 90 47 18 9f 71>,
  absValidity: 2018-08-28T03:33:04.968Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.17',
  serverPort: 22100,
  sessionKey: 
   { id: 40200004,
     cipherKeyVal: <Buffer 28 97 4d 42 56 a2 7d 01 48 fa d6 cc c1 97 44 45>,
     macKeyVal: <Buffer 59 98 06 89 99 7d 04 16 fe 6b 2f 39 04 39 05 2e e2 4b b1 29 3a 80 0a 1c 71 bf 34 90 47 18 9f 71>,
     absValidity: 2018-08-28T03:33:04.968Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer c9 04 6c 53 97 bb 81 7f>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 03:33:07 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1535340787420
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1535340844809
connected to auth! from local port 38478
received auth hello!
{ authId: 402, nonce: <Buffer 99 e0 a5 fa ff 10 80 76> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 26 6d 7d 93 a9 2e cd 04>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200011,
  cipherKeyVal: <Buffer 37 a9 3f 84 2d 78 a0 81 24 69 fc 4c 0f 07 bb ca>,
  macKeyVal: <Buffer 79 ba a3 d6 d1 ad b8 89 0a f2 5c a6 59 53 be e7 83 12 43 42 86 06 aa 3e 4c 80 ca 2e 3b 0e e5 e4>,
  absValidity: 2018-08-28T03:34:05.001Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.17',
  serverPort: 22100,
  sessionKey: 
   { id: 40200011,
     cipherKeyVal: <Buffer 37 a9 3f 84 2d 78 a0 81 24 69 fc 4c 0f 07 bb ca>,
     macKeyVal: <Buffer 79 ba a3 d6 d1 ad b8 89 0a f2 5c a6 59 53 be e7 83 12 43 42 86 06 aa 3e 4c 80 ca 2e 3b 0e e5 e4>,
     absValidity: 2018-08-28T03:34:05.001Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer dd d3 7c fa 8e 6b c5 d8>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 03:34:07 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1535340847360
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1535340904855
connected to auth! from local port 38748
received auth hello!
{ authId: 402, nonce: <Buffer 7e 0d eb 2e a7 94 e0 39> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d5 62 47 d9 73 ab 32 85>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200018,
  cipherKeyVal: <Buffer 56 df 8f a9 0c b5 bd d0 b4 31 2d 09 54 60 3a f5>,
  macKeyVal: <Buffer 36 eb e9 18 f1 be bb 41 86 30 ab 2e 99 30 78 90 d3 11 51 73 a1 db da 1f 74 b8 26 6f 07 53 a7 af>,
  absValidity: 2018-08-28T03:35:05.030Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.17',
  serverPort: 22100,
  sessionKey: 
   { id: 40200018,
     cipherKeyVal: <Buffer 56 df 8f a9 0c b5 bd d0 b4 31 2d 09 54 60 3a f5>,
     macKeyVal: <Buffer 36 eb e9 18 f1 be bb 41 86 30 ab 2e 99 30 78 90 d3 11 51 73 a1 db da 1f 74 b8 26 6f 07 53 a7 af>,
     absValidity: 2018-08-28T03:35:05.030Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer a9 77 33 52 73 ac c8 0c>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 03:35:07 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1535340907392
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1535340964913
connected to auth! from local port 39018
received auth hello!
{ authId: 402, nonce: <Buffer bd 9f 83 ce a7 3a ce 74> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0f 8f 62 62 fc 40 00 ff>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200025,
  cipherKeyVal: <Buffer 04 a8 09 07 56 a8 45 3e a0 eb 4c d4 ac a2 77 89>,
  macKeyVal: <Buffer 29 4c 18 64 09 9f cd a0 4f 84 ea 57 7a e9 51 0e 5d bb 00 50 0b d8 4e 95 69 e5 ac f9 26 c3 8c c2>,
  absValidity: 2018-08-28T03:36:05.028Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.17',
  serverPort: 22100,
  sessionKey: 
   { id: 40200025,
     cipherKeyVal: <Buffer 04 a8 09 07 56 a8 45 3e a0 eb 4c d4 ac a2 77 89>,
     macKeyVal: <Buffer 29 4c 18 64 09 9f cd a0 4f 84 ea 57 7a e9 51 0e 5d bb 00 50 0b d8 4e 95 69 e5 ac f9 26 c3 8c c2>,
     absValidity: 2018-08-28T03:36:05.028Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 8f c3 4c d6 de 77 59 ce>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 03:36:07 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1535340967427
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1535341024971
connected to auth! from local port 39288
received auth hello!
{ authId: 402, nonce: <Buffer 14 6a 3e a4 50 c6 8a 25> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f6 04 f7 76 99 da 21 d1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200032,
  cipherKeyVal: <Buffer 3c de 61 0a af b5 dc 53 b6 33 dc 8e 7c fb fd f5>,
  macKeyVal: <Buffer 1e 74 7d da f7 d7 af a6 28 d6 31 8a 05 4f 44 2c 5a 49 fe 06 5f a4 95 09 a2 04 2d 0c 24 39 5f e8>,
  absValidity: 2018-08-28T03:37:05.113Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.17',
  serverPort: 22100,
  sessionKey: 
   { id: 40200032,
     cipherKeyVal: <Buffer 3c de 61 0a af b5 dc 53 b6 33 dc 8e 7c fb fd f5>,
     macKeyVal: <Buffer 1e 74 7d da f7 d7 af a6 28 d6 31 8a 05 4f 44 2c 5a 49 fe 06 5f a4 95 09 a2 04 2d 0c 24 39 5f e8>,
     absValidity: 2018-08-28T03:37:05.113Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer e4 d5 c4 c5 22 1b b1 4f>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 03:37:07 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1535341027450
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1535341085028
connected to auth! from local port 39558
received auth hello!
{ authId: 402, nonce: <Buffer b5 be 07 e9 6c 80 53 80> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b1 e2 c7 4b d1 05 84 80>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200039,
  cipherKeyVal: <Buffer 61 88 a3 52 7a c3 03 96 26 04 d5 83 45 55 cc 9a>,
  macKeyVal: <Buffer 81 24 2e b4 fb 74 fa 06 6c 6a 96 92 9b 3e 80 de 48 93 a3 4b 93 47 cf 40 89 b7 3d 80 fd 1b c9 bb>,
  absValidity: 2018-08-28T03:38:05.192Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.17',
  serverPort: 22100,
  sessionKey: 
   { id: 40200039,
     cipherKeyVal: <Buffer 61 88 a3 52 7a c3 03 96 26 04 d5 83 45 55 cc 9a>,
     macKeyVal: <Buffer 81 24 2e b4 fb 74 fa 06 6c 6a 96 92 9b 3e 80 de 48 93 a3 4b 93 47 cf 40 89 b7 3d 80 fd 1b c9 bb>,
     absValidity: 2018-08-28T03:38:05.192Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer d6 62 4c 71 6a 41 10 fd>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 03:38:07 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1535341087418
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1535341145086
connected to auth! from local port 39828
received auth hello!
{ authId: 402, nonce: <Buffer ae 31 cc 68 ff 5a 8e 16> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 62 56 a5 7f b4 95 13 be>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200046,
  cipherKeyVal: <Buffer 19 db 23 66 43 a9 a0 28 4d d7 2d 7c 7c 8f d4 81>,
  macKeyVal: <Buffer ee 63 bd 1e 97 3d ce 8b 2f 30 6c ed df 97 fb 43 6b cc 1b 3f 14 f0 38 75 16 c6 44 79 43 00 7c fa>,
  absValidity: 2018-08-28T03:39:05.235Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.17',
  serverPort: 22100,
  sessionKey: 
   { id: 40200046,
     cipherKeyVal: <Buffer 19 db 23 66 43 a9 a0 28 4d d7 2d 7c 7c 8f d4 81>,
     macKeyVal: <Buffer ee 63 bd 1e 97 3d ce 8b 2f 30 6c ed df 97 fb 43 6b cc 1b 3f 14 f0 38 75 16 c6 44 79 43 00 7c fa>,
     absValidity: 2018-08-28T03:39:05.235Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 0c d1 43 10 4a 72 25 5a>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 03:39:07 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1535341147525
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1535341205144
connected to auth! from local port 40098
received auth hello!
{ authId: 402, nonce: <Buffer 7d 6b cc 5a b7 d5 b0 d2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b7 97 c9 eb ed ec b0 d2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200053,
  cipherKeyVal: <Buffer 48 3a f1 58 19 8b 78 7a ee 5f d6 95 e2 76 39 98>,
  macKeyVal: <Buffer d0 15 b2 c4 54 55 7b 27 c7 cd 13 79 9d eb 2c 1c 77 84 a0 28 a4 d2 8c 84 9c 77 e2 3c 2e b0 9a 5d>,
  absValidity: 2018-08-28T03:40:05.282Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.17',
  serverPort: 22100,
  sessionKey: 
   { id: 40200053,
     cipherKeyVal: <Buffer 48 3a f1 58 19 8b 78 7a ee 5f d6 95 e2 76 39 98>,
     macKeyVal: <Buffer d0 15 b2 c4 54 55 7b 27 c7 cd 13 79 9d eb 2c 1c 77 84 a0 28 a4 d2 8c 84 9c 77 e2 3c 2e b0 9a 5d>,
     absValidity: 2018-08-28T03:40:05.282Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 14 8a 73 de 21 a0 60 f2>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 03:40:07 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 8 1 1535341207556
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 9 0.8888888888888888 1535341265157
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 10 0.8 1535341325167
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 33762
received auth hello!
{ authId: 502, nonce: <Buffer fe 9c d2 22 ab 30 a7 d7> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 11 0.7272727272727273 1535341385177
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 33986
received auth hello!
{ authId: 502, nonce: <Buffer 99 a3 b4 1b b2 02 f4 0f> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 12 0.6666666666666666 1535341445184
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 13 0.6153846153846154 1535341505188
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 39258
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 14 0.5714285714285714 1535341565192
failure in connection with Auth : authFailureCount: 6
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 39494
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 15 0.5333333333333333 1535341625199
failure in connection with Auth : authFailureCount: 7
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 2
to: 3
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.3:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 16 0.5 1535341685206
failure in connection with Auth : authFailureCount: 8
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 3
to: 4
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 55010
received auth hello!
{ authId: 503, nonce: <Buffer 1f 3c c8 be a8 20 3e 0c> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth503',
     commonName: '10.0.1.6' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth402',
     commonName: '10.0.0.2' },
  serial: '0165796FA46B',
  notBefore: 2018-08-27T03:29:44.000Z,
  notAfter: 2018-08-28T03:31:24.000Z,
  subjectHash: '5542437f',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'B0:E4:E5:5F:9E:CB:06:62:C1:1C:04:D2:03:C0:0F:F3:08:57:F8:E6',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'B23F6093C850A1F776C6B25A211F3D5D8785C0DAD492C4DE461DA15D8F9B6101A99371495C8D7E30C245C7CC7E2E192E5B5EB588DBBBDBA927B35EDD2BAE5D8C5C65824B855A9221C4466C8784616AD037B77C8AADC6EF39D05015670368020871C42CAC357EA02550E2A7B413707218579A29BD6E3766CDC96E0C38274B71EADD932F983948893BE88DFCA5822A49F903804459FF6A6BE5F8D58602F470CF3B3720B509B13C86CB937B7103FB5BB709F3236962F0A80B162386009C70550963F281A68E509BD7FD3B899E2D99BBF01E7FAD284D2AA9766FC563E437A20FC2DB9E924A4047450953A3342A8380752168F1038EC6A4763C6E85566CE28AE879E7',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.6' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 503,
  host: '10.0.1.6',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWV5b6RrMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDIxETAPBgNVBAMMCDEwLjAuMC4yMB4XDTE4MDgy\nNzAzMjk0NFoXDTE4MDgyODAzMzEyNFowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMzERMA8GA1UEAwwIMTAuMC4xLjYwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQCyP2CTyFCh93bGslohHz1dh4XA2tSSxN5GHaFdj5thAamTcUlc\njX4wwkXHzH4uGS5bXrWI27vbqSezXt0rrl2MXGWCS4VakiHERmyHhGFq0De3fIqt\nxu850FAVZwNoAghxxCysNX6gJVDip7QTcHIYV5opvW43Zs3Jbgw4J0tx6t2TL5g5\nSIk76I38pYIqSfkDgERZ/2pr5fjVhgL0cM87NyC1CbE8hsuTe3ED+1u3CfMjaWLw\nqAsWI4YAnHBVCWPygaaOUJvX/TuJni2Zu/Aef60oTSqpdm/FY+Q3og/C256SSkBH\nRQlTozQqg4B1IWjxA47GpHY8boVWbOKK6HnnAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQYwDQYJKoZIhvcNAQELBQADggEBAHimGYeBFTk1nGO26iqikUZTSdUKpnDK\n1wAqZWF59AYw4GIh8K8hwY89yfxiEPdadTHuHhROS2TNmi5Qhmjm2T9LeoVfXDFp\nvlnxCk14MXmYJPtVM/f+auUcudUgffLF4JpR6AsA2Loke6FxQHTkZgrPFByluQHu\n6KN55vWS7t1zlXLQLx5UFjSHeulMjTdnZ9Ev+zKxzZVnbK1rIsedCi15tiqIDtqE\n7moQ/RLtqDYKe83XIvg/NsV3wK0FiOTEFo5Pd5LKrcUUxcpnGQNGti5A8XSxQ4tR\ngI9dbZudraBvrMOB1eFFyunFPks8RVIs6shkmXxXg5MkMTdGXf3VWKo=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 4
to: 5
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 17 0.47058823529411764 1535341745217
connected to auth! from local port 55258
received auth hello!
{ authId: 503, nonce: <Buffer 5c 66 0a 71 51 6b ff 9f> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 6b 84 74 96 ed 23 1b e7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 3e 21 86 30 02 e4 fb 7b b3 ee af b4 e7 d5 b3 9c>,
  macKeyVal: <Buffer 81 36 da 81 08 7a 13 3a 6a 91 c8 f2 28 2f 18 30 f9 b2 b0 f5 09 b1 0a e6 7b 50 c4 7f 34 48 03 70>,
  absValidity: 2018-08-27T04:49:05.477Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300077,
  cipherKeyVal: <Buffer f5 ce 24 2a 18 44 60 f4 32 0d d5 42 9a 66 2c a5>,
  macKeyVal: <Buffer b2 40 6c b8 a0 45 07 2f 5c aa 40 a9 ec f7 27 d6 86 f2 62 95 5b 03 cf 69 58 7c 6a d1 c2 97 a1 d4>,
  absValidity: 2018-08-28T03:49:05.477Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.17',
  serverPort: 22100,
  sessionKey: 
   { id: 50300077,
     cipherKeyVal: <Buffer f5 ce 24 2a 18 44 60 f4 32 0d d5 42 9a 66 2c a5>,
     macKeyVal: <Buffer b2 40 6c b8 a0 45 07 2f 5c aa 40 a9 ec f7 27 d6 86 f2 62 95 5b 03 cf 69 58 7c 6a d1 c2 97 a1 d4>,
     absValidity: 2018-08-28T03:49:05.477Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 7a 91 f7 ad 41 48 a9 a2>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.17:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 18 0.4444444444444444 1535341805226
connected to auth! from local port 55518
received auth hello!
{ authId: 503, nonce: <Buffer bb 06 d6 e5 99 10 b8 cb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b3 e1 e4 67 9e 71 5d bf>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300087,
  cipherKeyVal: <Buffer f7 b8 cd 60 97 e0 78 06 4b 2b 76 63 24 e9 ec 0c>,
  macKeyVal: <Buffer 9e 2c 57 6b 9f c5 6e 51 76 c7 04 67 54 ad b2 d3 1f c7 e1 b4 67 0d 20 60 ec e0 bd f1 9f 6e 8a 82>,
  absValidity: 2018-08-28T03:50:05.393Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.17',
  serverPort: 22100,
  sessionKey: 
   { id: 50300087,
     cipherKeyVal: <Buffer f7 b8 cd 60 97 e0 78 06 4b 2b 76 63 24 e9 ec 0c>,
     macKeyVal: <Buffer 9e 2c 57 6b 9f c5 6e 51 76 c7 04 67 54 ad b2 d3 1f c7 e1 b4 67 0d 20 60 ec e0 bd f1 9f 6e 8a 82>,
     absValidity: 2018-08-28T03:50:05.393Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 06 40 5f 1f c0 76 9a 0f>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.17:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 19 0.42105263157894735 1535341865236
connected to auth! from local port 55770
received auth hello!
{ authId: 503, nonce: <Buffer ae 31 9c af 09 d4 ff 5d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d9 b6 33 2c 26 8a 91 af>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300097,
  cipherKeyVal: <Buffer b2 60 ed 0f 1d e5 d1 25 7a 9f f8 80 0c b3 36 bf>,
  macKeyVal: <Buffer 7b 49 68 fc ab e5 ec 80 be 23 9a 2d 70 f7 e2 80 90 8e c3 ed 96 6a 75 1f ad 4a 3a 00 7a fb 10 24>,
  absValidity: 2018-08-28T03:51:05.376Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.17',
  serverPort: 22100,
  sessionKey: 
   { id: 50300097,
     cipherKeyVal: <Buffer b2 60 ed 0f 1d e5 d1 25 7a 9f f8 80 0c b3 36 bf>,
     macKeyVal: <Buffer 7b 49 68 fc ab e5 ec 80 be 23 9a 2d 70 f7 e2 80 90 8e c3 ed 96 6a 75 1f ad 4a 3a 00 7a fb 10 24>,
     absValidity: 2018-08-28T03:51:05.376Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 78 d5 65 c8 57 40 b3 e4>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.17:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 20 0.4 1535341925248
connected to auth! from local port 56016
received auth hello!
{ authId: 503, nonce: <Buffer b9 6d da d1 37 51 4c 7a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 31 52 44 8e 17 08 54 49>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300107,
  cipherKeyVal: <Buffer 43 fa 88 ea 4e 64 d8 75 f2 23 4c b2 c1 ac f8 01>,
  macKeyVal: <Buffer c5 f0 d5 a6 00 12 b9 d4 fa cd 4b 83 2f ec ca 09 dc 7b 61 66 f0 ef 8c f9 46 ea 5d 7b 4b 9f 20 1b>,
  absValidity: 2018-08-28T03:52:05.393Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.17',
  serverPort: 22100,
  sessionKey: 
   { id: 50300107,
     cipherKeyVal: <Buffer 43 fa 88 ea 4e 64 d8 75 f2 23 4c b2 c1 ac f8 01>,
     macKeyVal: <Buffer c5 f0 d5 a6 00 12 b9 d4 fa cd 4b 83 2f ec ca 09 dc 7b 61 66 f0 ef 8c f9 46 ea 5d 7b 4b 9f 20 1b>,
     absValidity: 2018-08-28T03:52:05.393Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 80 1c 34 34 18 6f 01 73>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.17:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 21 0.38095238095238093 1535341985256
connected to auth! from local port 56286
received auth hello!
{ authId: 503, nonce: <Buffer b7 14 c6 21 89 37 38 da> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer de bf 1b 3a 3f 78 39 c3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300117,
  cipherKeyVal: <Buffer d0 b7 bb 72 34 4a 81 dc b8 72 19 22 22 78 cc 6b>,
  macKeyVal: <Buffer 09 95 85 2d 5c 55 10 f4 fd eb f1 9b 8f 17 72 59 5c 22 56 56 42 e8 2b 83 d3 01 6c 1e c5 8e 95 9a>,
  absValidity: 2018-08-28T03:53:05.581Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.17',
  serverPort: 22100,
  sessionKey: 
   { id: 50300117,
     cipherKeyVal: <Buffer d0 b7 bb 72 34 4a 81 dc b8 72 19 22 22 78 cc 6b>,
     macKeyVal: <Buffer 09 95 85 2d 5c 55 10 f4 fd eb f1 9b 8f 17 72 59 5c 22 56 56 42 e8 2b 83 d3 01 6c 1e c5 8e 95 9a>,
     absValidity: 2018-08-28T03:53:05.581Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 3f 30 fa 8c 98 26 f9 6a>
switching to HANDSHAKE_1_SENT
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.17:undefined
/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902
            eventHandlers.onError('Error occurred in migration request: Disconnected from auth before getting migration response: ' + error);
                                                                                                                                      ^

ReferenceError: error is not defined
    at Socket.<anonymous> (/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902:135)
    at emitNone (events.js:91:20)
    at Socket.emit (events.js:188:7)
    at endReadableNT (_stream_readable.js:975:12)
    at _combinedTickCallback (internal/process/next_tick.js:80:11)
    at process._tickCallback (internal/process/next_tick.js:104:9)
