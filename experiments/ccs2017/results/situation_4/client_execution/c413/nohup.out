changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c413.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c413',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 51 49 42 41 41 4b 43 41 51 45 41 71 51 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1535340791189
connected to auth! from local port 34220
received auth hello!
{ authId: 402, nonce: <Buffer 04 09 79 cb ca 02 ae ef> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer db 2b eb 16 35 4b 2c 0c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer fa 22 fa e5 d6 0b 6f b3 f5 74 46 8e b5 b5 e7 76>,
  macKeyVal: <Buffer 8e 13 3a 13 09 21 e1 fa 6d 1a ac b1 6c 65 97 5d 50 1c 88 3f 07 2a 52 b7 1c 6c b2 93 c7 e7 67 87>,
  absValidity: 2018-08-27T04:33:12.976Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200006,
  cipherKeyVal: <Buffer f7 40 4b 5d 67 be 83 5f 1d cc 0b ff 3b 52 5f ec>,
  macKeyVal: <Buffer 87 5a 95 21 6c bf dd 60 d0 7f 36 9c 62 5b 8d 30 b7 04 c6 4d 41 a2 0a 03 31 eb 4e c4 a0 e8 22 1e>,
  absValidity: 2018-08-28T03:33:12.975Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.16',
  serverPort: 22100,
  sessionKey: 
   { id: 40200006,
     cipherKeyVal: <Buffer f7 40 4b 5d 67 be 83 5f 1d cc 0b ff 3b 52 5f ec>,
     macKeyVal: <Buffer 87 5a 95 21 6c bf dd 60 d0 7f 36 9c 62 5b 8d 30 b7 04 c6 4d 41 a2 0a 03 31 eb 4e c4 a0 e8 22 1e>,
     absValidity: 2018-08-28T03:33:12.975Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 42 59 b6 37 39 75 16 43>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 03:33:15 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1535340795678
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1535340851245
connected to auth! from local port 34442
received auth hello!
{ authId: 402, nonce: <Buffer d2 9e 35 69 38 e9 c4 69> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 93 94 fb e5 c1 8c d7 2c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200013,
  cipherKeyVal: <Buffer 16 84 f1 c5 c9 01 63 0c 9f 67 7c 27 78 ff b9 d1>,
  macKeyVal: <Buffer ae 80 e2 98 dd 01 22 5c 72 e5 f1 0f 02 8e 82 c0 37 dd 9d bd 7a 8d 48 ab 0b 95 e3 05 c0 df ea bf>,
  absValidity: 2018-08-28T03:34:12.994Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.16',
  serverPort: 22100,
  sessionKey: 
   { id: 40200013,
     cipherKeyVal: <Buffer 16 84 f1 c5 c9 01 63 0c 9f 67 7c 27 78 ff b9 d1>,
     macKeyVal: <Buffer ae 80 e2 98 dd 01 22 5c 72 e5 f1 0f 02 8e 82 c0 37 dd 9d bd 7a 8d 48 ab 0b 95 e3 05 c0 df ea bf>,
     absValidity: 2018-08-28T03:34:12.994Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 93 0f b5 7c 9d a7 b2 97>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 03:34:15 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1535340855954
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1535340911300
connected to auth! from local port 34714
received auth hello!
{ authId: 402, nonce: <Buffer 4b da c5 96 60 87 89 f2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 26 ed 5b a2 f8 8f de 81>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200020,
  cipherKeyVal: <Buffer ce a6 c7 a1 36 c7 b8 f3 6f 9b b8 cf 63 01 c9 2c>,
  macKeyVal: <Buffer 29 2f dd c5 28 fa b0 36 18 89 3f 2f 70 11 93 2e 88 ba 99 58 59 0f bf ba 6a 7f 04 4f 81 aa 92 bf>,
  absValidity: 2018-08-28T03:35:13.039Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.16',
  serverPort: 22100,
  sessionKey: 
   { id: 40200020,
     cipherKeyVal: <Buffer ce a6 c7 a1 36 c7 b8 f3 6f 9b b8 cf 63 01 c9 2c>,
     macKeyVal: <Buffer 29 2f dd c5 28 fa b0 36 18 89 3f 2f 70 11 93 2e 88 ba 99 58 59 0f bf ba 6a 7f 04 4f 81 aa 92 bf>,
     absValidity: 2018-08-28T03:35:13.039Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 49 b3 4d dd 70 8b bb a2>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 03:35:15 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1535340915668
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1535340971356
connected to auth! from local port 34982
received auth hello!
{ authId: 402, nonce: <Buffer 4e 14 61 97 f5 e8 ea 4b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 92 5e 7f ae fb a6 5b 9b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200027,
  cipherKeyVal: <Buffer 22 f0 4c 67 db e7 20 c4 ed 31 e4 8d 2a b6 af 97>,
  macKeyVal: <Buffer b7 d0 09 e1 1f 0b 60 74 19 85 3c 54 0e c7 1a 5b 6f d0 58 93 de b5 48 a5 0a f7 b5 18 fa 41 fe 78>,
  absValidity: 2018-08-28T03:36:13.050Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.16',
  serverPort: 22100,
  sessionKey: 
   { id: 40200027,
     cipherKeyVal: <Buffer 22 f0 4c 67 db e7 20 c4 ed 31 e4 8d 2a b6 af 97>,
     macKeyVal: <Buffer b7 d0 09 e1 1f 0b 60 74 19 85 3c 54 0e c7 1a 5b 6f d0 58 93 de b5 48 a5 0a f7 b5 18 fa 41 fe 78>,
     absValidity: 2018-08-28T03:36:13.050Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer c6 3e 43 1d a9 c7 10 ed>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 03:36:15 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1535340976053
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1535341031412
connected to auth! from local port 35252
received auth hello!
{ authId: 402, nonce: <Buffer 32 04 1d d9 8f dc 86 3f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 06 b0 8b 31 a6 95 e2 fe>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200034,
  cipherKeyVal: <Buffer ca 40 6c f0 ea eb fa 0a f5 76 e8 21 c6 be e5 02>,
  macKeyVal: <Buffer f4 57 e6 85 8a 92 47 06 bb b5 f1 3d eb 4b df 19 8e 0c 7f 42 7a 60 d6 8c c5 5f 6c 29 2b 39 f0 ad>,
  absValidity: 2018-08-28T03:37:13.102Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.16',
  serverPort: 22100,
  sessionKey: 
   { id: 40200034,
     cipherKeyVal: <Buffer ca 40 6c f0 ea eb fa 0a f5 76 e8 21 c6 be e5 02>,
     macKeyVal: <Buffer f4 57 e6 85 8a 92 47 06 bb b5 f1 3d eb 4b df 19 8e 0c 7f 42 7a 60 d6 8c c5 5f 6c 29 2b 39 f0 ad>,
     absValidity: 2018-08-28T03:37:13.102Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 43 67 a6 5d 4c 7f 0f 1d>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 03:37:15 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1535341035789
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1535341091444
connected to auth! from local port 35522
received auth hello!
{ authId: 402, nonce: <Buffer a3 11 06 1c 7f 4f 05 da> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e3 72 35 8b f8 93 d4 6e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200041,
  cipherKeyVal: <Buffer 6a a6 90 b6 de e8 e6 36 15 68 5d 5d 47 73 2d 5b>,
  macKeyVal: <Buffer 3e 99 23 ab 07 63 4f ea 8b 9e 25 e5 3e e6 43 00 ce e9 b1 16 6e 8b 51 16 ae 37 c2 75 d5 c7 9d 24>,
  absValidity: 2018-08-28T03:38:13.134Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.16',
  serverPort: 22100,
  sessionKey: 
   { id: 40200041,
     cipherKeyVal: <Buffer 6a a6 90 b6 de e8 e6 36 15 68 5d 5d 47 73 2d 5b>,
     macKeyVal: <Buffer 3e 99 23 ab 07 63 4f ea 8b 9e 25 e5 3e e6 43 00 ce e9 b1 16 6e 8b 51 16 ae 37 c2 75 d5 c7 9d 24>,
     absValidity: 2018-08-28T03:38:13.134Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer cf b4 58 0b 0d df 1d 55>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 03:38:15 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1535341095914
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1535341151500
connected to auth! from local port 35792
received auth hello!
{ authId: 402, nonce: <Buffer b0 33 ac b7 b7 7f b5 a8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5a 81 4e 09 d4 76 09 7a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200048,
  cipherKeyVal: <Buffer b3 86 85 95 c0 50 2e db 64 58 be 8f 15 d6 58 88>,
  macKeyVal: <Buffer 1b a9 24 08 fe 03 6c f2 a5 7d 91 c5 2e a2 4d 7b 4a 23 7f 32 5a 5b c0 9a 4c a3 f4 6d 0c 4a 54 26>,
  absValidity: 2018-08-28T03:39:13.126Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.16',
  serverPort: 22100,
  sessionKey: 
   { id: 40200048,
     cipherKeyVal: <Buffer b3 86 85 95 c0 50 2e db 64 58 be 8f 15 d6 58 88>,
     macKeyVal: <Buffer 1b a9 24 08 fe 03 6c f2 a5 7d 91 c5 2e a2 4d 7b 4a 23 7f 32 5a 5b c0 9a 4c a3 f4 6d 0c 4a 54 26>,
     absValidity: 2018-08-28T03:39:13.126Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer e1 23 a3 98 d1 17 39 7c>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 03:39:15 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1535341156080
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1535341211556
connected to auth! from local port 36062
Handler: Error in secure comm - details: Disconnected from auth before getting session key response
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 9 0.7777777777777778 1535341271566
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 10 0.7 1535341331576
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 37852
received auth hello!
{ authId: 502, nonce: <Buffer 64 c1 33 22 33 18 77 be> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 11 0.6363636363636364 1535341391586
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 38072
received auth hello!
{ authId: 502, nonce: <Buffer da 89 e8 a3 ae 59 39 5e> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 12 0.5833333333333334 1535341451589
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 13 0.5384615384615384 1535341511596
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 53764
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 14 0.5 1535341571603
failure in connection with Auth : authFailureCount: 6
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 54002
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 15 0.4666666666666667 1535341631610
failure in connection with Auth : authFailureCount: 7
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 2
to: 3
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.3:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 16 0.4375 1535341691617
failure in connection with Auth : authFailureCount: 8
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 3
to: 4
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 45614
received auth hello!
{ authId: 503, nonce: <Buffer d0 c8 be 0f 3a b7 9c d3> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth503',
     commonName: '10.0.1.6' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth402',
     commonName: '10.0.0.2' },
  serial: '0165796FA46B',
  notBefore: 2018-08-27T03:29:44.000Z,
  notAfter: 2018-08-28T03:31:24.000Z,
  subjectHash: '5542437f',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'B0:E4:E5:5F:9E:CB:06:62:C1:1C:04:D2:03:C0:0F:F3:08:57:F8:E6',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'B23F6093C850A1F776C6B25A211F3D5D8785C0DAD492C4DE461DA15D8F9B6101A99371495C8D7E30C245C7CC7E2E192E5B5EB588DBBBDBA927B35EDD2BAE5D8C5C65824B855A9221C4466C8784616AD037B77C8AADC6EF39D05015670368020871C42CAC357EA02550E2A7B413707218579A29BD6E3766CDC96E0C38274B71EADD932F983948893BE88DFCA5822A49F903804459FF6A6BE5F8D58602F470CF3B3720B509B13C86CB937B7103FB5BB709F3236962F0A80B162386009C70550963F281A68E509BD7FD3B899E2D99BBF01E7FAD284D2AA9766FC563E437A20FC2DB9E924A4047450953A3342A8380752168F1038EC6A4763C6E85566CE28AE879E7',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.6' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 503,
  host: '10.0.1.6',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWV5b6RrMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDIxETAPBgNVBAMMCDEwLjAuMC4yMB4XDTE4MDgy\nNzAzMjk0NFoXDTE4MDgyODAzMzEyNFowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMzERMA8GA1UEAwwIMTAuMC4xLjYwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQCyP2CTyFCh93bGslohHz1dh4XA2tSSxN5GHaFdj5thAamTcUlc\njX4wwkXHzH4uGS5bXrWI27vbqSezXt0rrl2MXGWCS4VakiHERmyHhGFq0De3fIqt\nxu850FAVZwNoAghxxCysNX6gJVDip7QTcHIYV5opvW43Zs3Jbgw4J0tx6t2TL5g5\nSIk76I38pYIqSfkDgERZ/2pr5fjVhgL0cM87NyC1CbE8hsuTe3ED+1u3CfMjaWLw\nqAsWI4YAnHBVCWPygaaOUJvX/TuJni2Zu/Aef60oTSqpdm/FY+Q3og/C256SSkBH\nRQlTozQqg4B1IWjxA47GpHY8boVWbOKK6HnnAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQYwDQYJKoZIhvcNAQELBQADggEBAHimGYeBFTk1nGO26iqikUZTSdUKpnDK\n1wAqZWF59AYw4GIh8K8hwY89yfxiEPdadTHuHhROS2TNmi5Qhmjm2T9LeoVfXDFp\nvlnxCk14MXmYJPtVM/f+auUcudUgffLF4JpR6AsA2Loke6FxQHTkZgrPFByluQHu\n6KN55vWS7t1zlXLQLx5UFjSHeulMjTdnZ9Ev+zKxzZVnbK1rIsedCi15tiqIDtqE\n7moQ/RLtqDYKe83XIvg/NsV3wK0FiOTEFo5Pd5LKrcUUxcpnGQNGti5A8XSxQ4tR\ngI9dbZudraBvrMOB1eFFyunFPks8RVIs6shkmXxXg5MkMTdGXf3VWKo=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 4
to: 5
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 17 0.4117647058823529 1535341751627
connected to auth! from local port 45868
received auth hello!
{ authId: 503, nonce: <Buffer a1 1f c5 c0 4a 9b 4c 0a> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 5f 13 90 ec 03 06 22 f4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 37 87 7c 0d 75 a8 30 5f 87 de 71 c9 31 dc e9 a6>,
  macKeyVal: <Buffer 7c 12 a2 b1 68 20 b1 54 93 35 9d b8 89 36 22 d9 f0 5d 29 67 54 06 e2 37 e2 86 22 b7 31 a5 7e df>,
  absValidity: 2018-08-27T04:49:11.785Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300079,
  cipherKeyVal: <Buffer bd 3b d3 24 e2 c6 6b 16 11 d8 a3 7a eb 13 01 1d>,
  macKeyVal: <Buffer ed 06 f2 02 5e 4a a7 17 e0 d8 45 6a 15 96 a0 f6 3e da 60 cc c9 74 1a d8 27 ed 48 a4 19 67 e0 c1>,
  absValidity: 2018-08-28T03:49:11.784Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.16',
  serverPort: 22100,
  sessionKey: 
   { id: 50300079,
     cipherKeyVal: <Buffer bd 3b d3 24 e2 c6 6b 16 11 d8 a3 7a eb 13 01 1d>,
     macKeyVal: <Buffer ed 06 f2 02 5e 4a a7 17 e0 d8 45 6a 15 96 a0 f6 3e da 60 cc c9 74 1a d8 27 ed 48 a4 19 67 e0 c1>,
     absValidity: 2018-08-28T03:49:11.784Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 55 73 20 ca c5 7e 30 ed>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.16:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 18 0.3888888888888889 1535341811637
connected to auth! from local port 46130
received auth hello!
{ authId: 503, nonce: <Buffer 0b 0e 3e 54 9e f1 9c db> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 22 88 22 8a 7d 08 3f 61>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300089,
  cipherKeyVal: <Buffer af 9b d4 79 7e 59 f2 75 f2 af fc 94 c8 b1 49 66>,
  macKeyVal: <Buffer a3 89 36 e9 8f 71 8b 6c d2 03 8f 5a 7e 2f ce cb ed 2d 13 ff 80 76 c8 b9 a1 4e a3 dd 9d 3f 60 39>,
  absValidity: 2018-08-28T03:50:11.767Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.16',
  serverPort: 22100,
  sessionKey: 
   { id: 50300089,
     cipherKeyVal: <Buffer af 9b d4 79 7e 59 f2 75 f2 af fc 94 c8 b1 49 66>,
     macKeyVal: <Buffer a3 89 36 e9 8f 71 8b 6c d2 03 8f 5a 7e 2f ce cb ed 2d 13 ff 80 76 c8 b9 a1 4e a3 dd 9d 3f 60 39>,
     absValidity: 2018-08-28T03:50:11.767Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 4d 69 de f0 80 0b c1 3a>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.16:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 19 0.3684210526315789 1535341871647
connected to auth! from local port 46378
received auth hello!
{ authId: 503, nonce: <Buffer e9 fc 52 bb 66 22 2e 9d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9b d2 46 2e 5a 5f 46 6f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300099,
  cipherKeyVal: <Buffer 23 69 07 43 36 11 ab 94 b1 83 73 0e 47 92 35 c4>,
  macKeyVal: <Buffer 16 d0 64 24 3f a3 34 ca c2 d8 a0 76 13 c3 da ff 28 77 9b 7a 6d 5a 82 b0 5e 40 2d 8b 87 b7 93 2d>,
  absValidity: 2018-08-28T03:51:11.789Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.16',
  serverPort: 22100,
  sessionKey: 
   { id: 50300099,
     cipherKeyVal: <Buffer 23 69 07 43 36 11 ab 94 b1 83 73 0e 47 92 35 c4>,
     macKeyVal: <Buffer 16 d0 64 24 3f a3 34 ca c2 d8 a0 76 13 c3 da ff 28 77 9b 7a 6d 5a 82 b0 5e 40 2d 8b 87 b7 93 2d>,
     absValidity: 2018-08-28T03:51:11.789Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer e0 b8 4b 92 f8 32 f6 40>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.16:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 20 0.35 1535341931657
connected to auth! from local port 46636
received auth hello!
{ authId: 503, nonce: <Buffer 33 e7 d3 2c 52 3d 24 ee> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f6 a5 e6 79 41 b6 07 22>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300109,
  cipherKeyVal: <Buffer b7 72 47 d1 df f0 a5 41 74 7a b9 5e cb d9 a5 52>,
  macKeyVal: <Buffer ee 8f 11 41 ef 0a e4 de 7e 66 ec f7 23 58 28 56 f3 c8 7a d6 64 25 ec ec b3 82 8e c4 bf 68 5f 20>,
  absValidity: 2018-08-28T03:52:11.789Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.16',
  serverPort: 22100,
  sessionKey: 
   { id: 50300109,
     cipherKeyVal: <Buffer b7 72 47 d1 df f0 a5 41 74 7a b9 5e cb d9 a5 52>,
     macKeyVal: <Buffer ee 8f 11 41 ef 0a e4 de 7e 66 ec f7 23 58 28 56 f3 c8 7a d6 64 25 ec ec b3 82 8e c4 bf 68 5f 20>,
     absValidity: 2018-08-28T03:52:11.789Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 5b c3 68 b4 e7 1d 23 7a>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.16:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 21 0.3333333333333333 1535341991667
connected to auth! from local port 46898
received auth hello!
{ authId: 503, nonce: <Buffer 1c 44 82 a3 f3 23 ad c5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c1 d9 46 e9 48 9c 59 77>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300119,
  cipherKeyVal: <Buffer 5e 68 df d2 b5 c3 f6 76 2e e4 4b 38 85 29 0c 65>,
  macKeyVal: <Buffer e6 39 1d 1f c3 43 59 8d 8b 61 56 01 3d 94 2b c6 f9 c3 1a 65 a5 5a 21 a0 87 44 bc 5c bf 76 1c f4>,
  absValidity: 2018-08-28T03:53:11.822Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.16',
  serverPort: 22100,
  sessionKey: 
   { id: 50300119,
     cipherKeyVal: <Buffer 5e 68 df d2 b5 c3 f6 76 2e e4 4b 38 85 29 0c 65>,
     macKeyVal: <Buffer e6 39 1d 1f c3 43 59 8d 8b 61 56 01 3d 94 2b c6 f9 c3 1a 65 a5 5a 21 a0 87 44 bc 5c bf 76 1c f4>,
     absValidity: 2018-08-28T03:53:11.822Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 84 3e a3 ae 2a 54 d5 a8>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.16:undefined
/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902
            eventHandlers.onError('Error occurred in migration request: Disconnected from auth before getting migration response: ' + error);
                                                                                                                                      ^

ReferenceError: error is not defined
    at Socket.<anonymous> (/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902:135)
    at emitNone (events.js:91:20)
    at Socket.emit (events.js:188:7)
    at endReadableNT (_stream_readable.js:975:12)
    at _combinedTickCallback (internal/process/next_tick.js:80:11)
    at process._tickCallback (internal/process/next_tick.js:104:9)
