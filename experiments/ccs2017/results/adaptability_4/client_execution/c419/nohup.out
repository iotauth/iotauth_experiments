changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c419.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c419',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 51 49 42 41 41 4b 43 41 51 45 41 76 50 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1535349505367
connected to auth! from local port 40458
received auth hello!
{ authId: 403, nonce: <Buffer 89 c8 66 0e 4b 32 5b 9f> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer a6 74 0e ad 74 94 34 9d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer a6 8a e5 13 1d 7c 0b 8b 34 3f 7c 54 bd e9 bf ee>,
  macKeyVal: <Buffer e6 b3 57 9d 59 fa 8f bd 94 02 91 e6 76 eb 16 c5 80 cb c9 f3 e2 70 6c 4f c7 dd e5 24 a6 13 e6 97>,
  absValidity: 2018-08-27T06:58:26.236Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300268,
  cipherKeyVal: <Buffer 40 ef 6a 27 69 7f 7e d4 9b cc 87 7b b3 92 ec 3a>,
  macKeyVal: <Buffer fe 15 56 d8 a2 ce 21 3c e4 47 fb 53 1f 01 b2 74 26 84 5e b0 6e 83 3c 15 d3 c6 9c 42 4d 3c 9c 76>,
  absValidity: 2018-08-28T05:58:26.236Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.23',
  serverPort: 22100,
  sessionKey: 
   { id: 40300268,
     cipherKeyVal: <Buffer 40 ef 6a 27 69 7f 7e d4 9b cc 87 7b b3 92 ec 3a>,
     macKeyVal: <Buffer fe 15 56 d8 a2 ce 21 3c e4 47 fb 53 1f 01 b2 74 26 84 5e b0 6e 83 3c 15 d3 c6 9c 42 4d 3c 9c 76>,
     absValidity: 2018-08-28T05:58:26.236Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 66 bc 27 bb fb 9f 05 e9>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 05:58:28 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1535349508630
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1535349565424
connected to auth! from local port 40678
received auth hello!
{ authId: 403, nonce: <Buffer 55 09 3f 31 b7 fc c6 89> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cc 62 f5 a8 7e 5e 19 db>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300274,
  cipherKeyVal: <Buffer 31 54 3d 9d d0 97 9b a4 6f e9 78 ac 83 3c 0d cd>,
  macKeyVal: <Buffer ab 6e 2b 97 8a 03 46 90 8f 2e e2 46 3f ec 94 53 e8 fe 95 cf 0a 0b d0 9a b1 73 03 34 bd fe a8 3f>,
  absValidity: 2018-08-28T05:59:26.368Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.23',
  serverPort: 22100,
  sessionKey: 
   { id: 40300274,
     cipherKeyVal: <Buffer 31 54 3d 9d d0 97 9b a4 6f e9 78 ac 83 3c 0d cd>,
     macKeyVal: <Buffer ab 6e 2b 97 8a 03 46 90 8f 2e e2 46 3f ec 94 53 e8 fe 95 cf 0a 0b d0 9a b1 73 03 34 bd fe a8 3f>,
     absValidity: 2018-08-28T05:59:26.368Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 55 ab e2 1e 49 90 48 33>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 05:59:28 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1535349568939
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1535349625480
connected to auth! from local port 40950
received auth hello!
{ authId: 403, nonce: <Buffer 91 10 d6 41 dd 06 de 28> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a6 9d 2b 76 21 fe b6 bd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300280,
  cipherKeyVal: <Buffer b4 84 ac 98 89 5b e7 4c 5f 71 13 8f d2 d5 68 4d>,
  macKeyVal: <Buffer 40 ac 7a da 75 f7 1f 30 86 64 3c 1e ed db 53 35 0c 1f c7 56 d4 86 90 7a ec 3e e0 78 45 16 f7 42>,
  absValidity: 2018-08-28T06:00:26.397Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.23',
  serverPort: 22100,
  sessionKey: 
   { id: 40300280,
     cipherKeyVal: <Buffer b4 84 ac 98 89 5b e7 4c 5f 71 13 8f d2 d5 68 4d>,
     macKeyVal: <Buffer 40 ac 7a da 75 f7 1f 30 86 64 3c 1e ed db 53 35 0c 1f c7 56 d4 86 90 7a ec 3e e0 78 45 16 f7 42>,
     absValidity: 2018-08-28T06:00:26.397Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 3d 0a a3 fb a2 5c 13 39>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 06:00:28 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1535349628953
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1535349685536
connected to auth! from local port 41220
received auth hello!
{ authId: 403, nonce: <Buffer cd d4 7d 21 12 54 eb 16> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cc 33 80 16 bf 52 75 d8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300286,
  cipherKeyVal: <Buffer a0 6a 81 1e 64 b0 42 3e c0 7b 5b 18 04 04 52 1b>,
  macKeyVal: <Buffer 6e c9 56 42 e5 6b 78 ff f6 35 be 98 f4 24 8e e9 ac 1b 38 12 c6 c9 81 d2 73 3c 82 a6 04 a4 f7 cc>,
  absValidity: 2018-08-28T06:01:26.442Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.23',
  serverPort: 22100,
  sessionKey: 
   { id: 40300286,
     cipherKeyVal: <Buffer a0 6a 81 1e 64 b0 42 3e c0 7b 5b 18 04 04 52 1b>,
     macKeyVal: <Buffer 6e c9 56 42 e5 6b 78 ff f6 35 be 98 f4 24 8e e9 ac 1b 38 12 c6 c9 81 d2 73 3c 82 a6 04 a4 f7 cc>,
     absValidity: 2018-08-28T06:01:26.442Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 59 7a 25 a8 5f e5 76 de>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 06:01:28 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1535349689016
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1535349745592
connected to auth! from local port 41490
received auth hello!
{ authId: 403, nonce: <Buffer f6 5e d7 71 d9 78 57 12> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 61 89 46 80 b4 c0 3a dd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300292,
  cipherKeyVal: <Buffer 6d 79 34 8d 44 e5 3e eb 13 e8 d9 f4 f7 ba 78 b5>,
  macKeyVal: <Buffer e2 ec 28 03 86 2c 06 08 e7 14 c2 2b 3c 0e 0b 92 82 66 a9 e9 6f fb 16 26 a4 6d f0 4e cf 8c aa 42>,
  absValidity: 2018-08-28T06:02:26.504Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.23',
  serverPort: 22100,
  sessionKey: 
   { id: 40300292,
     cipherKeyVal: <Buffer 6d 79 34 8d 44 e5 3e eb 13 e8 d9 f4 f7 ba 78 b5>,
     macKeyVal: <Buffer e2 ec 28 03 86 2c 06 08 e7 14 c2 2b 3c 0e 0b 92 82 66 a9 e9 6f fb 16 26 a4 6d f0 4e cf 8c aa 42>,
     absValidity: 2018-08-28T06:02:26.504Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 42 7d d3 28 7f 75 d9 b9>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 06:02:28 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1535349748924
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1535349805604
connected to auth! from local port 41792
received auth hello!
{ authId: 403, nonce: <Buffer 90 32 35 fd 6c 62 bd 17> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 48 1b a6 ad f0 45 2d 94>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300298,
  cipherKeyVal: <Buffer e8 7f 7e f2 0f aa ba 30 c5 21 65 a8 be d9 0e 11>,
  macKeyVal: <Buffer 46 8f fe 81 8b e2 a3 fd eb dd 93 99 01 70 b8 50 2a 3a 16 c3 09 30 4a bd a7 05 66 b9 e2 de 55 16>,
  absValidity: 2018-08-28T06:03:26.551Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.23',
  serverPort: 22100,
  sessionKey: 
   { id: 40300298,
     cipherKeyVal: <Buffer e8 7f 7e f2 0f aa ba 30 c5 21 65 a8 be d9 0e 11>,
     macKeyVal: <Buffer 46 8f fe 81 8b e2 a3 fd eb dd 93 99 01 70 b8 50 2a 3a 16 c3 09 30 4a bd a7 05 66 b9 e2 de 55 16>,
     absValidity: 2018-08-28T06:03:26.551Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer f8 43 89 5d 0d af 97 df>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 06:03:28 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1535349809068
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1535349865612
connected to auth! from local port 42064
received auth hello!
{ authId: 403, nonce: <Buffer 0c fb bf 80 ab 96 6b a4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1c fa f0 cb d5 4c 6f c8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300304,
  cipherKeyVal: <Buffer 57 5a a5 0f 6a 6c 46 26 50 79 d5 f9 b6 ea 1d b6>,
  macKeyVal: <Buffer 4e 50 de 1e 36 74 d8 c1 c7 d3 b2 a6 58 a4 76 76 6d 24 37 c3 11 76 42 4c 55 db e0 dd f5 85 ce 46>,
  absValidity: 2018-08-28T06:04:26.613Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.23',
  serverPort: 22100,
  sessionKey: 
   { id: 40300304,
     cipherKeyVal: <Buffer 57 5a a5 0f 6a 6c 46 26 50 79 d5 f9 b6 ea 1d b6>,
     macKeyVal: <Buffer 4e 50 de 1e 36 74 d8 c1 c7 d3 b2 a6 58 a4 76 76 6d 24 37 c3 11 76 42 4c 55 db e0 dd f5 85 ce 46>,
     absValidity: 2018-08-28T06:04:26.613Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 94 5c 1a fd 67 6e 44 d7>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 06:04:28 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1535349869104
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1535349925669
connected to auth! from local port 42326
received auth hello!
{ authId: 403, nonce: <Buffer 72 8a d1 cf ef 7b 85 fb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 71 6a 9e c7 1d 66 c3 04>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300310,
  cipherKeyVal: <Buffer c3 e2 b6 94 10 ca c8 1f 79 1c 94 b6 ce f1 97 5e>,
  macKeyVal: <Buffer 00 80 c2 a0 e4 24 02 7d 1a bb b2 0d 6d 2b 6f 45 cf 07 e4 ad b2 ec a2 1e fc 30 bd 78 83 37 90 52>,
  absValidity: 2018-08-28T06:05:26.623Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.23',
  serverPort: 22100,
  sessionKey: 
   { id: 40300310,
     cipherKeyVal: <Buffer c3 e2 b6 94 10 ca c8 1f 79 1c 94 b6 ce f1 97 5e>,
     macKeyVal: <Buffer 00 80 c2 a0 e4 24 02 7d 1a bb b2 0d 6d 2b 6f 45 cf 07 e4 ad b2 ec a2 1e fc 30 bd 78 83 37 90 52>,
     absValidity: 2018-08-28T06:05:26.623Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 05 7a 31 ac c2 f0 62 f9>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.23:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 9 0.7777777777777778 1535349985675
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.3:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 10 0.7 1535350045685
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.3:21100
connected to auth! from local port 42674
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 11 0.6363636363636364 1535350105693
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.3:21100
connected to auth! from local port 42918
/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902
            eventHandlers.onError('Error occurred in migration request: Disconnected from auth before getting migration response: ' + error);
                                                                                                                                      ^

ReferenceError: error is not defined
    at Socket.<anonymous> (/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902:135)
    at emitNone (events.js:91:20)
    at Socket.emit (events.js:188:7)
    at endReadableNT (_stream_readable.js:975:12)
    at _combinedTickCallback (internal/process/next_tick.js:80:11)
    at process._tickCallback (internal/process/next_tick.js:104:9)
