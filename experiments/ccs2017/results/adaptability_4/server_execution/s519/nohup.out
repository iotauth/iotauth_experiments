changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s519.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's519',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 6d 4e ... > }
Handler: listening on port 22100
s519:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400044
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50474
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400045
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50490
received auth hello!
{ authId: 504, nonce: <Buffer d6 40 8e aa 2b 3b 74 51> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 5e d3 c8 5e 0c 9b d5 37>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 80 28 78 a7 49 fe db 15 eb 9a c1 1e d2 29 38 95>,
  macKeyVal: <Buffer 6d 11 f7 0d b9 ce 97 8f 6c 0b 2a 7f 2b a8 32 84 7e 31 8c d5 d4 ba f7 ff 9f 01 ea 98 b2 9a 04 2d>,
  absValidity: 2018-08-27T06:59:56.424Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 38 b6 78 61 ac c7 7b bf>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 38 b6 78 61 ac c7 7b bf> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.86:44934',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer 3c e5 90 24 b1 bd 65 a1> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer c8 67 d7 bc 8c 31 fc 0c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer cd 38 48 c9 82 c5 48 d4 42 0d bd e3 b2 ee 22 26>,
  macKeyVal: <Buffer fe 25 6b 5a 23 7e aa ce 91 a0 0d bb 55 59 fd 42 42 74 5b 84 a6 90 85 dc 91 a9 d4 66 70 c7 60 e5>,
  absValidity: 2018-08-27T06:59:58.160Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4f f8 de 23 b3 ce 40 aa>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4f f8 de 23 b3 ce 40 aa> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.87:35044',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400050
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50744
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400051
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50758
received auth hello!
{ authId: 504, nonce: <Buffer 6d ec 30 30 d5 cf 13 31> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ef c6 b0 98 18 29 b3 be>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 66 ba cf 2b 7d e8 e7 0b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 66 ba cf 2b 7d e8 e7 0b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.86:45204',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer 68 8e 43 2e 5f 92 6f eb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0d a1 5b b8 46 f5 81 34>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6b b7 e1 cf e2 be 57 0d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6b b7 e1 cf e2 be 57 0d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.87:35312',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400056
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51014
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400057
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
received auth hello!
{ authId: 504, nonce: <Buffer e2 74 f5 c4 f8 10 86 e9> }
connected to auth! from local port 51032
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5f 82 68 7e e9 35 65 8e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 70 38 7e 33 06 35 68 98>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 70 38 7e 33 06 35 68 98> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.86:45474',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer b8 e6 90 37 78 38 27 38> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2b b3 2c 74 1f 92 88 75>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4c f0 9b 77 6a 89 7f e9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4c f0 9b 77 6a 89 7f e9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.87:35586',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400062
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51284
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received auth hello!
{ authId: 504, nonce: <Buffer bb 23 14 ff 16 71 9b 40> }
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400063
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a4 2f 32 61 4a 56 c8 eb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 19 4b fa 6c 08 3b b9 2d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 19 4b fa 6c 08 3b b9 2d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.86:45744',
  status: 'open' }
connected to auth! from local port 51302
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer 94 d3 f1 63 91 e4 17 20> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6c 1b 37 cf be 38 b5 fb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6c 8f a6 b9 b7 34 1d 04>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 6c 8f a6 b9 b7 34 1d 04> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.87:35856',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400068
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51588
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400069
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
received auth hello!
{ authId: 504, nonce: <Buffer 58 2b 14 4b aa 13 d4 b6> }
connected to auth! from local port 51606
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3a fa 97 eb 2d d7 3d 58>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6d 6c e3 3b 7d 5e ca a5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6d 6c e3 3b 7d 5e ca a5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.86:46048',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer 5f 8c e3 a6 bd dc e0 57> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f1 e1 62 d2 59 8d 35 d4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4e 43 45 8a 9e d8 e4 da>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 4e 43 45 8a 9e d8 e4 da> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.87:36160',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400074
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51858
received auth hello!
{ authId: 504, nonce: <Buffer 8d c9 9c f6 9e 0b 53 70> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 95 13 b9 6c 04 cd 6d c9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3a 9c c6 5e 97 7b f7 da>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3a 9c c6 5e 97 7b f7 da> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.86:46316',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100337
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100347
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in server - details: handshake2 timed out...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in server - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in server - details: Error occurred in migration request: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100357
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 55494
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 5d a3 e8 f4 a9 f9 4c e8> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth504',
     commonName: '10.0.0.7' },
  serial: '016579F45B3E',
  notBefore: 2018-08-27T05:54:41.000Z,
  notAfter: 2018-08-28T05:56:21.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '94:A2:A1:E3:A2:D6:ED:14:E9:D3:29:2B:68:66:23:C2:9E:76:F5:A6',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'A31E9022457B05D056C9FDEDB58BC733BB1B97C16EF02448C451D7DA8BD15C69BDB461E2FD275C96206B77B283645D6BCD71B284A7AC0F1477E8D62ECAA762A3FA674E23957AED10D73D8ED8838AC41A47FAF8FB50BCB1B3A57C246D7D1861A3880C7CCFDEEB58259C62F656BDFDD4ABE6096C88FFA9EEEF3D32230BB86D8FF4C534038264055EB8B3972DC370931A0A38091A1287BFF40D2EF7D92570D86B1837F35A2EA3F7B96EA0870826501C88C4DC0639DA69AE419D997562C46AF20F50D09554213C3EE69AE5685E2446DC62A309CD065472D9BC7AD27221D047D12C6241DBDF5C65881B877D96358D4C273A9F3D8D02DEB84D0581B7EB28209680C6AD',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWV59Fs+MA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDQxETAPBgNVBAMMCDEwLjAuMC43MB4XDTE4MDgy\nNzA1NTQ0MVoXDTE4MDgyODA1NTYyMVowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQCjHpAiRXsF0FbJ/e21i8czuxuXwW7wJEjEUdfai9Fcab20YeL9\nJ1yWIGt3soNkXWvNcbKEp6wPFHfo1i7Kp2Kj+mdOI5V67RDXPY7Yg4rEGkf6+PtQ\nvLGzpXwkbX0YYaOIDHzP3utYJZxi9la9/dSr5glsiP+p7u89MiMLuG2P9MU0A4Jk\nBV64s5ctw3CTGgo4CRoSh7/0DS732SVw2GsYN/NaLqP3uW6ghwgmUByIxNwGOdpp\nrkGdmXVixGryD1DQlVQhPD7mmuVoXiRG3GKjCc0GVHLZvHrSciHQR9EsYkHb31xl\niBuHfZY1jUwnOp89jQLeuE0FgbfrKCCWgMatAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAJ1UuI1iMARRtA6gtKi8IJjuHsdw4vMx\nvAcVrayQ++ImuMgF+cWMut+IYqD808yGgxUNWF6+YXOwnu8j22Ilu8XLu4PmsENl\nbs9rNUG8bRifwDQUEJ8yyA1h+Yvws0UzE0ejCGvpsJ8G1ZbXEz001299UrGuCMa4\nR/EaULmgOF8xycWNptQTWwbfB/AjKl3KBTxdH55sSUMqCixbCkqxj6dIcf/dBAtz\nYOGQUILnfOFr3yVKiORsMPkX2JWrKjsflSqAstKKk1WDVaNUHhFY5h3BrbTT2XkG\npbogGbfYDTyaHIcsTs8OgBFwT3MeB2/Oi4pSlfkCWYeRbZAbss/nkxo=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 1
to: 2
disconnected from auth
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100368
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55708
received auth hello!
{ authId: 502, nonce: <Buffer ff 9f 76 10 68 6f dd 1f> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 7a 66 7a 2e 0c 45 72 5a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 59 b4 7e f6 d8 13 d1 1f 8a 7f 95 35 35 df 83 b3>,
  macKeyVal: <Buffer e9 4f c4 8f 55 3c e0 df 05 ef ea b2 97 79 76 f1 79 48 f2 a5 54 bf c9 a7 12 f4 63 e4 69 45 83 e8>,
  absValidity: 2018-08-27T07:10:56.584Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a2 56 cc 0b d4 f4 c4 68>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a2 56 cc 0b d4 f4 c4 68> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.86:47668',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100380
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55914
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer db ac 7e c2 17 9d 76 35> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a4 48 d0 bd 97 ec 94 e5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3d bf d1 18 23 e1 b5 4c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3d bf d1 18 23 e1 b5 4c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.86:47874',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100392
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56130
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100403
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56338
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100404
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56348
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 22 0c 5a cd c1 d4 0f 49> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 04 61 71 eb 6c 08 90 70>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e7 3a 3b 41 54 e6 ab 5e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e7 3a 3b 41 54 e6 ab 5e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.87:38400',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 71 ac 0f ca 74 df 77 bf> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: write after end
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100415
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56554
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100416
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56564
received auth hello!
{ authId: 502, nonce: <Buffer 15 94 1e 0a 9f 6c 29 bd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ad c4 d5 cb f8 d2 b2 37>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f8 36 98 1f 7d 10 2c eb>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f8 36 98 1f 7d 10 2c eb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.86:48510',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Handler: Error in server - details: handshake2 timed out...
disconnected from auth
Handler: Error in server - details: Connection with Auth timed out...
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100427
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56764
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100428
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56780
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 20 ba 3c a4 a6 fc 79 85> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer be 41 ee 00 93 97 e4 58>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 64 11 19 2e 98 8d 9f ec>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 64 11 19 2e 98 8d 9f ec> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.87:38830',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 39 65 09 2a b8 62 4c fd> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: write after end
disconnected from auth
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100440
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56996
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100441
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57008
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: Connection with Auth timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100453
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57220
Unidentified client connected
received auth hello!
{ authId: 502, nonce: <Buffer ca f3 90 6d af dc da 79> }
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: write after end
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100454
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57234
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in server - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.7:21100
received auth hello!
{ authId: 502, nonce: <Buffer 16 be 64 05 05 36 63 85> }
Handler: Error in server - details: handshake2 timed out...
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 85 a3 e5 af 6e 3b 52 6b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 86 40 57 32 f9 9c 38 88>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 86 40 57 32 f9 9c 38 88> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.87:39284',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Handler: Error in server - details: handshake2 timed out...
disconnected from auth
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in server - details: Error occurred in migration request: Auth hello timedout ...
Handler: Error in server - details: Connection with Auth timed out...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100466
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57438
received auth hello!
{ authId: 502, nonce: <Buffer b9 dc 85 b4 6f ac 47 8e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e9 7d 29 9f fa 0d 40 d9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 79 de a0 a5 61 d0 ba 18>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 79 de a0 a5 61 d0 ba 18> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.86:49396',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100478
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57654
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer a8 5b c7 10 ca c5 b1 cd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 80 d8 71 a8 54 25 a2 01>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 92 03 68 64 cb 5a e6 f9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 92 03 68 64 cb 5a e6 f9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.86:49610',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100490
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57868
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100502
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58086
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100514
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58334
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer f3 e0 68 cc 49 50 33 64> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b8 27 08 14 69 9a 95 54>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 13 e3 31 04 5e 46 2a c3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 13 e3 31 04 5e 46 2a c3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.86:50292',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100526
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58552
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100527
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58562
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer a0 1f c0 85 5c 6e 76 7d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ee 11 5c 25 40 95 1a 1c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b5 79 35 b0 87 0f 5a 8f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b5 79 35 b0 87 0f 5a 8f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.87:40614',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100539
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58766
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100540
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58776
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 04 08 04 a5 f7 af 59 1a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d0 2b 2c b5 bf 80 b3 cb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5a 29 47 c9 64 cf b8 61>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5a 29 47 c9 64 cf b8 61> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.87:40830',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
received auth hello!
{ authId: 502, nonce: <Buffer 51 02 f3 1a 22 4b 29 ac> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fd e4 f1 e7 7e 5f 29 d5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d5 c7 cf 5e f1 3a 06 fc>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d5 c7 cf 5e f1 3a 06 fc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.86:50724',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100552
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58986
received auth hello!
{ authId: 502, nonce: <Buffer 66 6c 91 de 3e 77 00 de> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f1 0d 6f 94 1e f5 01 d2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b2 7a 28 a0 dd 62 8d 38>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b2 7a 28 a0 dd 62 8d 38> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.86:50940',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
received auth hello!
{ authId: 502, nonce: <Buffer 38 67 61 34 90 09 65 61> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: write after end
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100556
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59110
disconnected from auth
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100557
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59116
received auth hello!
{ authId: 502, nonce: <Buffer dd 56 65 91 8d 35 eb 67> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a0 b3 ba 9b 0c 0b ba 2a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d6 aa 87 90 6c 53 a0 07>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d6 aa 87 90 6c 53 a0 07> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 24,
  remoteAddress: '::ffff:10.0.1.86:51070',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 24 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 24 }
specified socketID: 24
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 01 0d 3a 1d 9c 64 42 ce> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 37 48 4d bc 84 59 d5 b6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0f 8f 09 d1 6a 2b 75 92>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0f 8f 09 d1 6a 2b 75 92> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 25,
  remoteAddress: '::ffff:10.0.1.87:41170',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 25 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 25 }
specified socketID: 25
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #24 closed
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #25 closed
received auth hello!
{ authId: 502, nonce: <Buffer 7b 36 d7 5f cc 58 ad 20> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a7 b7 24 a2 2e a8 bc 00>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 46 93 6f a8 dd 93 63 ca>
Handler: Error in server - details: Error during comm init, details: Error: This socket has been ended by the other party
switching to HANDSHAKE_2_SENT
disconnected from auth
received auth hello!
{ authId: 502, nonce: <Buffer b5 fe 6f 54 c6 dd c2 2e> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: write after end
received auth hello!
{ authId: 502, nonce: <Buffer 96 23 a6 06 21 ce 4d d2> }
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 2
to: 0
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: write after end
received auth hello!
{ authId: 502, nonce: <Buffer 8b f5 5c 14 8f 20 f6 7c> }
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: write after end
Handler: Error in server - details: Connection with Auth timed out...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in server - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.4:21100
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in server - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.4:21100
disconnected from auth
received auth hello!
{ authId: 502, nonce: <Buffer a7 03 61 6e 86 31 1f 14> }
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
Failed to migrate! host/port of current Auth is the same as host of the Auth which we migrate to
Handler: Error in server - details: Error occurred in session key request: Error: write after end
disconnected from auth
Handler: Error in server - details: Auth hello timedout ...
disconnected from auth
received auth hello!
{ authId: 502, nonce: <Buffer 49 7c d9 d7 97 93 0c 77> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 82 49 40 be b3 b7 fc ba>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b0 ca a5 72 5c 6f 53 92>
Handler: Error in server - details: Error during comm init, details: Error: This socket has been ended by the other party
switching to HANDSHAKE_2_SENT
disconnected from auth
disconnected from auth
Handler: Error in server - details: Connection with Auth timed out...
Handler: Error in server - details: Connection with Auth timed out...
Handler: Error in server - details: Connection with Auth timed out...
Handler: Error in server - details: Connection with Auth timed out...
