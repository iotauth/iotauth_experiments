changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s416.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's416',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 78 6f ... > }
Handler: listening on port 22100
s416:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300267
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42790
received auth hello!
{ authId: 403, nonce: <Buffer 28 dc c8 03 d8 68 b9 89> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer df d2 fd e4 e3 56 38 1f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 34 93 45 97 24 ce 06 86 3a 7d 7d e3 26 cd 21 08>,
  macKeyVal: <Buffer 7e 3b 2f 50 6d 5a 24 51 25 9d 53 d5 97 2f e6 13 5a bf 6e 16 fc 12 ca 76 5b 7d d4 b8 d1 43 68 29>,
  absValidity: 2018-08-27T06:58:24.231Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 12 69 e7 5c 0b ec 05 15>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 12 69 e7 5c 0b ec 05 15> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.60:48466',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300268
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42796
received auth hello!
{ authId: 403, nonce: <Buffer fc 1b 7a d6 38 0c ca b3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ae 33 cd 4e 9f f9 91 9e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fe 60 83 ca a5 50 f3 44>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fe 60 83 ca a5 50 f3 44> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.61:57508',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300273
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43002
received auth hello!
{ authId: 403, nonce: <Buffer 96 c8 0b db 73 4f d8 9e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b5 83 81 b9 ef ed ef e0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 86 8a 4e 8a 11 95 e3 74>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 86 8a 4e 8a 11 95 e3 74> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.60:48678',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300274
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43018
received auth hello!
{ authId: 403, nonce: <Buffer d4 ed 88 6b bd e3 4a cc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6e 8c 3f 3e 55 b5 a6 7a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer db c8 9d 28 95 d2 d6 63>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer db c8 9d 28 95 d2 d6 63> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.61:57730',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300279
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43274
received auth hello!
{ authId: 403, nonce: <Buffer e4 06 9e 42 8a c6 f1 fa> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 80 68 ba 75 fc 46 f6 de>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 85 1b 87 be 6c f4 73 3b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 85 1b 87 be 6c f4 73 3b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.60:48950',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300280
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43290
received auth hello!
{ authId: 403, nonce: <Buffer 6b 88 57 9b 66 f2 5c d7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 16 03 0c be 13 93 3b af>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer df 97 fe c6 39 f3 98 b3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer df 97 fe c6 39 f3 98 b3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.61:58002',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300285
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43544
received auth hello!
{ authId: 403, nonce: <Buffer d0 53 54 ba f7 9b 3b 4a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8e 1a 9a 33 ab 7d f4 e8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 35 2a de f0 18 ae 46 1e>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 35 2a de f0 18 ae 46 1e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.60:49220',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300286
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43560
received auth hello!
{ authId: 403, nonce: <Buffer 42 ca 04 6e b6 ed bd 0a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ae 13 8d 93 d9 ff 59 25>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 80 22 53 6f 94 11 dc 76>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 80 22 53 6f 94 11 dc 76> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.61:58272',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300291
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43814
received auth hello!
{ authId: 403, nonce: <Buffer 36 4e 90 eb fd 64 fe d9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0e c7 02 e2 6c 06 a7 b0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2d df 12 21 bd f3 5f e5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2d df 12 21 bd f3 5f e5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.60:49490',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300292
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43830
received auth hello!
{ authId: 403, nonce: <Buffer e8 10 ce 35 97 9f d8 3d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4c a7 72 77 49 58 71 f6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7b 57 75 5b b3 0e 98 7f>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 7b 57 75 5b b3 0e 98 7f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.61:58542',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300297
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44088
received auth hello!
{ authId: 403, nonce: <Buffer 58 ea 9f a2 d1 08 a8 75> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 06 87 f4 ab d0 f0 85 bc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b1 68 f5 af e0 3f e8 f2>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b1 68 f5 af e0 3f e8 f2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.60:49764',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300298
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44134
received auth hello!
{ authId: 403, nonce: <Buffer 90 3e be 75 8a 07 e9 e1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 53 1a 0a 83 8e 92 35 de>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d9 cf 3d 9c 39 81 0d 57>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d9 cf 3d 9c 39 81 0d 57> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.61:58846',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300303
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44388
received auth hello!
{ authId: 403, nonce: <Buffer cc ad 77 09 e4 23 fa bd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ab 77 53 8b cb e5 78 0b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 62 af f8 b8 cf 45 51 ab>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 62 af f8 b8 cf 45 51 ab> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.60:50064',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300304
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44404
received auth hello!
{ authId: 403, nonce: <Buffer 4e cb d8 fc b6 34 9f 4a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 70 7f 3a c4 dc 51 88 da>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 04 bc e2 d2 0a ca 1e fc>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 04 bc e2 d2 0a ca 1e fc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.61:59116',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300309
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44650
received auth hello!
{ authId: 403, nonce: <Buffer 46 a0 76 76 21 05 52 69> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 74 7d dd a6 5e 8a a6 04>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 56 34 9c f2 cd 84 cb 4e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 56 34 9c f2 cd 84 cb 4e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.60:50326',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300310
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44666
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
