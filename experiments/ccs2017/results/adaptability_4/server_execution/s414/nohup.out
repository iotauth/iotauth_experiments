changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s414.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's414',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 6f 4f ... > }
Handler: listening on port 22100
s414:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300263
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43640
received auth hello!
{ authId: 403, nonce: <Buffer 23 5d de 2b 09 ba 61 32> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer c1 9e c8 b0 66 3c 3f cd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 9e 10 a4 e6 df 58 5a 5b 33 5b ae 44 c6 3d d3 31>,
  macKeyVal: <Buffer 0d 71 d7 c6 af 5b c3 fd 91 c4 d1 ac 33 56 b1 8a c6 50 db 6f 2c a8 ab f2 e6 76 c3 f4 16 4e 90 a7>,
  absValidity: 2018-08-27T06:58:10.056Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 03 b2 1d 2c 08 40 38 ae>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 03 b2 1d 2c 08 40 38 ae> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.56:34996',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300269
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43832
received auth hello!
{ authId: 403, nonce: <Buffer 81 9d 3d 9b fa 85 cc 1b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 54 3d 1e 18 a4 70 0c eb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 52 63 ed e6 3f 17 d6 bb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 52 63 ed e6 3f 17 d6 bb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.56:35188',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300275
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44104
received auth hello!
{ authId: 403, nonce: <Buffer 32 dd f9 f2 32 fa 7c 7f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ac 1c bf c2 a8 55 d1 2f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 98 bd e2 a6 06 de 3f 7e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 98 bd e2 a6 06 de 3f 7e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.56:35460',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300281
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44374
received auth hello!
{ authId: 403, nonce: <Buffer b6 33 e8 9d e9 eb 6f 08> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer af 90 bf 94 3f a7 1f e1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 13 9b 45 35 0c 41 5c 3b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 13 9b 45 35 0c 41 5c 3b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.56:35730',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300287
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44644
received auth hello!
{ authId: 403, nonce: <Buffer 74 63 e4 37 12 4c 1f d9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 14 bb 57 6e eb 04 ba f5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0c 1d d1 47 10 72 da cd>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0c 1d d1 47 10 72 da cd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.56:36000',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300293
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44914
received auth hello!
{ authId: 403, nonce: <Buffer 9e 86 1e b6 ba a1 89 7e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4a 28 0c 2c 72 53 54 1b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5d 79 51 a3 de e7 6f 5c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5d 79 51 a3 de e7 6f 5c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.56:36270',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300299
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45218
received auth hello!
{ authId: 403, nonce: <Buffer dd 8a 59 fa 23 27 0c 11> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a7 7d 78 08 a1 aa da ca>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2f 0d 12 60 c5 a0 ed ca>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2f 0d 12 60 c5 a0 ed ca> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.56:36574',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300305
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45480
received auth hello!
{ authId: 403, nonce: <Buffer e0 1b 2e c5 ad 07 84 a5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5f 49 4f b2 82 08 e1 de>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6c c7 72 19 60 e4 56 ff>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6c c7 72 19 60 e4 56 ff> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.56:36836',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100340
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.3:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100350
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.3:21100
connected to auth! from local port 37234
received auth hello!
{ authId: 401, nonce: <Buffer 47 22 36 5b 1a 80 22 76> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth401',
     commonName: '10.0.1.1' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth403',
     commonName: '10.0.0.3' },
  serial: '016579F450E2',
  notBefore: 2018-08-27T05:54:39.000Z,
  notAfter: 2018-08-28T05:56:19.000Z,
  subjectHash: 'de555cae',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '4E:41:84:27:D3:7A:FB:E5:9C:1A:71:66:34:14:A9:7E:4E:BB:BB:45',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'B530B62681E49BA3C59D023490C8FA22CDFCBEFE3C82DDC2EB20C54A7635E97FA277CACAAFFA4C4DBEC0E2EA6A350C5F49F73EAEBB61D517626C1FA825652FB0A97551D2651617F0C6167998928AE18186E89F69062E5E8569B20C127B9042FA49ECA2FAB22ED2362B41A9B317571C989813E9206F9938B6C8292AF7D26C0B7C22AED2002E379FD7C162E804A6EB39BFBAA4070586BEFFCBD2C6013FFA793744F966D931AF04263D6DC1FE3581000CB938A918CB88E7B7578C43239586252B1B7EEC2CF99B24518FC88A87396CBAD7990A8942E64846F37F40959504D5D6CD39533AB9898B84BA00BDBF0D4350CB87DCACD5B4C13EFF5795D7433B531062172F',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.1' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 401,
  host: '10.0.1.1',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWV59FDiMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDMxETAPBgNVBAMMCDEwLjAuMC4zMB4XDTE4MDgy\nNzA1NTQzOVoXDTE4MDgyODA1NTYxOVowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDQwMTERMA8GA1UEAwwIMTAuMC4xLjEwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQC1MLYmgeSbo8WdAjSQyPoizfy+/jyC3cLrIMVKdjXpf6J3ysqv\n+kxNvsDi6mo1DF9J9z6uu2HVF2JsH6glZS+wqXVR0mUWF/DGFnmYkorhgYbon2kG\nLl6FabIMEnuQQvpJ7KL6si7SNitBqbMXVxyYmBPpIG+ZOLbIKSr30mwLfCKu0gAu\nN5/XwWLoBKbrOb+6pAcFhr7/y9LGAT/6eTdE+WbZMa8EJj1twf41gQAMuTipGMuI\n57dXjEMjlYYlKxt+7Cz5myRRj8iKhzlsuteZColC5khG839AlZUE1dbNOVM6uYmL\nhLoAvb8NQ1DLh9ys1bTBPv9XlddDO1MQYhcvAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQEwDQYJKoZIhvcNAQELBQADggEBAGPZEB9yxeX6ADqbNbjSkSG6wHJPzsOW\nS0ttSEzcmtnC704Kqf8Mjjdaf74cQoXA/cSyt41G/T7j2WbjRakXCNfgaJSt3JaI\nrV05UB4vHEFmyI6ZekgJtMMcZ6QA4vD0R4npcPefeX3cReKE8NStR5cLCs77jxDI\n/eAQPE0Za69Gc2VSmT+B5BNTo7ar7ga4qEVpPW2RVD8MBSt6j+9OBcVlUWtaLICY\nEeMEPNGkwwINhovpz1TgQBM9w6lUKq/yftuXm6fMBKZjb0oQOS8UA6N9I0pmE3+I\nyWbmK0ZZYR764A2yxxOphpyQ+Q9hsCkbLaVo/mHQOM6gTBkuhcOCgzM=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100360
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37458
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100371
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37670
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100383
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37884
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100395
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100407
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38310
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100419
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38518
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100431
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38738
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100444
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38962
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: Disconnected from auth before getting session key response
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100457
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39188
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100469
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39400
received auth hello!
{ authId: 401, nonce: <Buffer 26 3b f3 c4 87 f3 5a 02> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 69 ac e3 a7 02 cd 66 c3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer ac 81 48 17 ef 9f 9f 15 77 e9 39 82 27 9f af 50>,
  macKeyVal: <Buffer 3c 24 43 a3 8c 40 79 c3 65 ee eb c2 20 b1 06 9a 28 3a 3f c2 f0 3c ee b8 af f5 44 e2 9b 3f 04 a5>,
  absValidity: 2018-08-27T07:19:10.386Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f7 89 40 05 6e 3a 83 ac>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f7 89 40 05 6e 3a 83 ac> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.56:39906',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100481
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39618
received auth hello!
{ authId: 401, nonce: <Buffer 58 e7 c9 23 e5 79 c4 ae> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 38 64 98 32 1a 29 97 ff>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 08 3b 7e c3 dc a0 4d 83>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 08 3b 7e c3 dc a0 4d 83> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.56:40124',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100493
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39832
received auth hello!
{ authId: 401, nonce: <Buffer c3 7a 57 03 e4 54 ed ea> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 84 22 a6 8f c7 6c b1 ea>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ac 02 40 6a 48 ca 6b 8b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ac 02 40 6a 48 ca 6b 8b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.56:40336',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100505
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40050
received auth hello!
{ authId: 401, nonce: <Buffer ac f6 36 00 45 ab bf 70> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d5 0f 57 6d a3 28 5c 80>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 38 7d d5 c8 49 33 1d 99>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 38 7d d5 c8 49 33 1d 99> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.56:40556',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100517
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40306
received auth hello!
{ authId: 401, nonce: <Buffer 40 ff 16 80 48 95 71 81> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 24 3c 5f 06 95 1e 00 18>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0c 8b 8b d6 96 fd 77 10>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0c 8b 8b d6 96 fd 77 10> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.56:40812',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100530
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40520
received auth hello!
{ authId: 401, nonce: <Buffer ea ed 89 2c b5 78 c5 33> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c5 f2 73 e4 0c 6b 33 55>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1c 19 65 ba ec ef 21 7f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1c 19 65 ba ec ef 21 7f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.56:41026',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100543
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40734
received auth hello!
{ authId: 401, nonce: <Buffer 6e 3f 10 7c c7 b9 2d 9b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 92 b1 56 12 74 ab 70 ae>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 15 71 dc 0b b1 18 6f 09>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 15 71 dc 0b b1 18 6f 09> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.56:41240',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100554
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40942
received auth hello!
{ authId: 401, nonce: <Buffer 6b 5d 53 de d3 a4 0b 52> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c4 0b 30 9f c2 47 0c 87>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 71 9d 14 12 3c 33 60 53>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 71 9d 14 12 3c 33 60 53> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.56:41448',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
