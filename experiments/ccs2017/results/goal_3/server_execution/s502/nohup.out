changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s502.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's502',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 77 5a ... > }
Handler: listening on port 22100
s502:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100057
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40028
received auth hello!
{ authId: 501, nonce: <Buffer 01 aa 74 be c9 8b 71 f9> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer bf f1 77 a9 e6 2b 38 26>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 64 24 b2 bf 53 c6 73 31 3a 5d 06 75 8e b8 45 00>,
  macKeyVal: <Buffer ad 39 6a f0 e4 19 a4 a7 f4 81 3f 1e 8c 73 44 34 93 17 f8 59 d0 ba 9b 7d cd bd 35 6e 43 e3 48 37>,
  absValidity: 2018-08-27T08:36:02.823Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 52 fd c9 8c 47 83 69 74>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 52 fd c9 8c 47 83 69 74> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.63:38122',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100065
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40264
received auth hello!
{ authId: 501, nonce: <Buffer c9 1b 9e 10 a7 ba a5 59> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 01 6b b6 f9 a2 54 e3 8b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f0 fd 18 bc a0 2c 75 32>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f0 fd 18 bc a0 2c 75 32> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.63:38358',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100073
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40534
received auth hello!
{ authId: 501, nonce: <Buffer f6 9a 31 c7 4b c3 a0 c5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e0 cf b9 10 d7 8e 6b 5e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 20 52 c1 b5 36 9d 99 25>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 20 52 c1 b5 36 9d 99 25> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.63:38628',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100081
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40804
received auth hello!
{ authId: 501, nonce: <Buffer b0 11 49 90 02 be 2d d1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 54 e3 4e 65 bc 70 8f fc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 45 c3 d9 82 8a b4 72 bd>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 45 c3 d9 82 8a b4 72 bd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.63:38898',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100089
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41074
received auth hello!
{ authId: 501, nonce: <Buffer a7 21 0d 2c d8 ab f6 1b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 66 70 a9 af fb 97 94 43>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1a 84 00 85 cc 15 15 d6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1a 84 00 85 cc 15 15 d6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.63:39168',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100097
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41344
received auth hello!
{ authId: 501, nonce: <Buffer 60 de c8 1e 9d 84 4d cd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 72 5f ef 31 72 7a 9f 9f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f0 fa f1 a8 93 09 15 f2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f0 fa f1 a8 93 09 15 f2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.63:39438',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100105
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41614
received auth hello!
{ authId: 501, nonce: <Buffer 19 c4 86 40 d4 73 9a c9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f7 ec da 68 92 5c 48 b2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 37 29 8e 9d ef 8b d5 86>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 37 29 8e 9d ef 8b d5 86> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.63:39708',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300108
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300119
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 49612
received auth hello!
{ authId: 403, nonce: <Buffer f6 d8 50 75 6c ab 52 4f> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth403',
     commonName: '10.0.1.3' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '01657A4D94D2',
  notBefore: 2018-08-27T07:32:09.000Z,
  notAfter: 2018-08-28T07:33:49.000Z,
  subjectHash: 'f6675d02',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'CB:14:80:5C:D2:62:15:8E:E8:3E:DE:4E:36:BC:B2:2C:48:1E:1C:74',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'EFEF26346AAE5741ADEB124056A798E491B6F7B2450C6EBF522745B81E49BD02A1DF7AA4AE58436E10AA9F4D23985C66AEACFEB6030BCFF3A0C72DCCAC56F6C5E0AE27704A80B4F8BDCE397C0EEC9A07440CDD94EF23BC321CBF42C6CD25B32EB798DE6D40436227E0667853330D7F11311F7F84A32AF2BA5DA4029EFE5D0EAF0736A7A12AEB9AD3C61626E6D77C7393E0EF13C574BD5865E07C83E9DD923500CE16F7DCD607050FB3495B3A5C86A82228B13659761B9F62EDE09F010AB0A2CF51700A9397A73AFCDCAEEF706314D72FF4A1883111DB69179CE487901E9935AB12BB80FDAD7879275724DA3BBD67CB2F51382B08255FDAB105553C066A1CE3B1',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.3' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 403,
  host: '10.0.1.3',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWV6TZTSMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDgy\nNzA3MzIwOVoXDTE4MDgyODA3MzM0OVowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDQwMzERMA8GA1UEAwwIMTAuMC4xLjMwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDv7yY0aq5XQa3rEkBWp5jkkbb3skUMbr9SJ0W4Hkm9AqHfeqSu\nWENuEKqfTSOYXGaurP62AwvP86DHLcysVvbF4K4ncEqAtPi9zjl8DuyaB0QM3ZTv\nI7wyHL9Cxs0lsy63mN5tQENiJ+BmeFMzDX8RMR9/hKMq8rpdpAKe/l0Orwc2p6Eq\n65rTxhYm5td8c5Pg7xPFdL1YZeB8g+ndkjUAzhb33NYHBQ+zSVs6XIaoIiixNll2\nG59i7eCfAQqwos9RcAqTl6c6/Nyu73BjFNcv9KGIMRHbaRec5IeQHpk1qxK7gP2t\neHknVyTaO71nyy9ROCsIJV/asQVVPAZqHOOxAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQMwDQYJKoZIhvcNAQELBQADggEBADhqpxFFJp1BLJsEjn8rYDZn5BQ4llof\njA4NOhP+07R0k3q222oNM12hm+6/q/DuomWsXBGCQSSCOoSI8KOcuAyDHk+QCaAl\nL/pgxHbIaKlwKx/WAX5RBB94aS/wLL3YiWhZ02HTnxjFNCTExBF6HouxxYWs42PB\nK8WVqwqRANe0LbtXqDHthSMSlP+aUy+nk1TtBXh83dmEMqr6117UympLuihvnfP7\n0c81wCLwtyc98Gqynz4MwJHKIxd8hjTxfNUtdR/VN4FSneWvKBlyVgyx0hwvmDyw\nJ/91c7DEv1/ewTYtRgwOlySd1jkQRgEugeMnRSVKG+UofF4cnkFGaX0=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300130
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49884
received auth hello!
{ authId: 403, nonce: <Buffer 4e 13 a6 4e 78 b4 0c d0> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 0e 88 e3 83 07 f5 a6 9b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer a2 3c 4d e7 f6 46 ea 54 29 ca 05 06 95 05 09 a3>,
  macKeyVal: <Buffer 90 d7 b7 31 dd d3 43 fd 76 36 2f 04 a7 0b 68 3a e5 81 39 04 88 d6 a9 0f d2 4d aa ec 7e 44 63 62>,
  absValidity: 2018-08-27T08:47:03.623Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e3 9f 31 9e 36 c1 ca 96>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e3 9f 31 9e 36 c1 ca 96> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.63:40946',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300141
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50148
received auth hello!
{ authId: 403, nonce: <Buffer b9 46 10 23 f8 34 c8 b6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1d 22 c5 07 e4 38 38 69>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2a fe a5 b5 b8 32 c2 1a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2a fe a5 b5 b8 32 c2 1a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.63:41208',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300152
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50420
received auth hello!
{ authId: 403, nonce: <Buffer c3 0d 8d 45 63 0f 80 9a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 01 cc 90 0e 92 23 09 11>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer de 81 06 af 10 6f 1a 24>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer de 81 06 af 10 6f 1a 24> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.63:41480',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300163
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50682
received auth hello!
{ authId: 403, nonce: <Buffer 95 90 9e 15 a1 0e 5e b3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7f c1 8e ce da b2 ed 84>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3d 21 d1 5a 35 79 90 6f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3d 21 d1 5a 35 79 90 6f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.63:41744',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300174
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50952
received auth hello!
{ authId: 403, nonce: <Buffer b6 1f ad dd 74 95 85 f3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 45 ae 09 f2 27 b7 2b bf>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2a ed 94 01 62 9a 30 8a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2a ed 94 01 62 9a 30 8a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.63:42014',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300185
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51218
received auth hello!
{ authId: 403, nonce: <Buffer 1a 01 82 c0 fb eb a0 21> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ee 47 58 e6 7a 90 30 f0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4f de e3 78 be a8 1a 10>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4f de e3 78 be a8 1a 10> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.63:42278',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300196
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51480
received auth hello!
{ authId: 403, nonce: <Buffer 64 46 22 7e cf 69 24 8b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6a 6f 3b d8 fb 9e 30 d9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 85 58 a5 77 33 29 8b 1e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 85 58 a5 77 33 29 8b 1e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.63:42540',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300207
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51746
received auth hello!
{ authId: 403, nonce: <Buffer 79 78 f4 4f 78 a9 68 15> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c1 aa c3 1b 8b 71 f1 d6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 07 ec 50 bb 8a 81 17 f2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 07 ec 50 bb 8a 81 17 f2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.63:42808',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300218
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52012
received auth hello!
{ authId: 403, nonce: <Buffer 04 45 3e 8e af e4 30 3b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a0 b5 56 2f f0 c9 e9 f2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ca 01 87 39 02 72 c9 08>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ca 01 87 39 02 72 c9 08> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.63:43074',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300229
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52274
received auth hello!
{ authId: 403, nonce: <Buffer 4d 3c 92 ac d7 9a a5 08> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer df b9 b5 3f 18 99 5e e1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 62 a3 6d 11 ab 82 c8 e2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 62 a3 6d 11 ab 82 c8 e2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.63:43336',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300240
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52536
received auth hello!
{ authId: 403, nonce: <Buffer 27 0d 00 eb 1a e7 ad ed> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1c 3c de 8f e4 21 52 f9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 67 e9 a3 a0 da 13 19 45>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 67 e9 a3 a0 da 13 19 45> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.63:43596',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300251
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52802
received auth hello!
{ authId: 403, nonce: <Buffer 1f 4f da 87 99 6f 71 dc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer af d9 de e7 5e ed 1e 08>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a1 ec 26 d0 bf cf 0b 1c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a1 ec 26 d0 bf cf 0b 1c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.63:43862',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300262
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53068
received auth hello!
{ authId: 403, nonce: <Buffer 4d 63 0f ec 24 b5 d5 9e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 84 eb 35 70 6b ab 11 e9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 70 e4 04 39 62 29 f3 f6>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 70 e4 04 39 62 29 f3 f6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.63:44130',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300273
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53334
received auth hello!
{ authId: 403, nonce: <Buffer 07 c5 66 eb 23 f9 b6 7a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1f 8d 5f fc e5 51 cb 13>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer aa b6 52 c6 99 32 51 db>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer aa b6 52 c6 99 32 51 db> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.63:44394',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300284
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53600
received auth hello!
{ authId: 403, nonce: <Buffer 1d db 87 96 cd 64 37 b5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1f cc 04 07 85 d2 a5 24>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 10 8c 43 18 b5 30 84 a8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 10 8c 43 18 b5 30 84 a8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.63:44662',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300295
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53866
received auth hello!
{ authId: 403, nonce: <Buffer 6d c4 00 bf a9 a1 f5 97> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ee 60 43 9a 7c 42 4b f1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 01 b6 52 32 58 a7 3c 0e>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 01 b6 52 32 58 a7 3c 0e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.63:44928',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300306
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54120
received auth hello!
{ authId: 403, nonce: <Buffer b4 8a d0 cf fa d8 cb e1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ab 53 b0 e5 e7 9b e2 6c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 75 a2 00 3d 7d 7e 70 61>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 75 a2 00 3d 7d 7e 70 61> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.63:45182',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
