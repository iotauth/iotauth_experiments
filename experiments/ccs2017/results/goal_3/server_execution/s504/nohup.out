changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s504.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's504',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 79 6f ... > }
Handler: listening on port 22100
s504:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100059
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53196
received auth hello!
{ authId: 501, nonce: <Buffer 80 8c 1b 79 99 64 b9 a8> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 29 ad 2c 6e a6 48 c5 7d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer dd 2b 80 f2 9c 46 dc fa 82 eb 26 b6 df 8e 71 bf>,
  macKeyVal: <Buffer a5 05 77 8f 5e 6a f6 33 97 85 69 de 42 07 ce 2d ef 12 ca 37 c7 6f 2e 18 00 d4 f8 66 d8 0d 6f d3>,
  absValidity: 2018-08-27T08:36:15.860Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fd 2a 31 b7 31 14 d6 1d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fd 2a 31 b7 31 14 d6 1d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.67:57270',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100067
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53452
received auth hello!
{ authId: 501, nonce: <Buffer ca c3 ce de b2 c6 dc 8d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0a e1 28 64 53 ba 27 62>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 00 db 11 d1 ee 4a 7b f9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 00 db 11 d1 ee 4a 7b f9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.67:57526',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100075
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53722
received auth hello!
{ authId: 501, nonce: <Buffer 79 20 84 f9 cf ff d8 e1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9c 3c d4 29 21 ec 9f 02>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ae 3f e5 ef 9d d2 58 99>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ae 3f e5 ef 9d d2 58 99> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.67:57796',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100083
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53992
received auth hello!
{ authId: 501, nonce: <Buffer 35 ad d7 44 8a a2 21 e2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4a 3c da 11 05 13 1b 1a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ee c2 0b 65 c4 6a e9 eb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ee c2 0b 65 c4 6a e9 eb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.67:58066',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100091
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54262
received auth hello!
{ authId: 501, nonce: <Buffer 3d 2c 03 85 8a f0 47 2e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c2 e3 9b 73 e8 6a a3 1f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cf 17 f9 1a b8 27 c8 36>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer cf 17 f9 1a b8 27 c8 36> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.67:58336',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100099
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54532
received auth hello!
{ authId: 501, nonce: <Buffer 7d 8c 49 e6 89 8d 54 9d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b6 66 d9 a7 95 7b 5d 5e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 30 00 3f 01 10 a4 21 59>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 30 00 3f 01 10 a4 21 59> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.67:58606',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100107
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54802
received auth hello!
{ authId: 501, nonce: <Buffer 50 ab 75 4e 4e 4f e0 79> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 72 94 98 16 36 e5 fb 3f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9b 8f 46 0d 95 df 47 0b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 9b 8f 46 0d 95 df 47 0b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.67:58876',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200390
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200403
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 49630
received auth hello!
{ authId: 502, nonce: <Buffer d1 c4 7b da c2 1b e8 4c> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '01657A4D9544',
  notBefore: 2018-08-27T07:32:09.000Z,
  notAfter: 2018-08-28T07:33:49.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'B2:55:63:B2:CE:CE:BC:2B:E5:03:A0:2E:DE:CD:0F:1B:08:28:38:82',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'E67D8D8DE1FDDD2C2465EAD2E2C8469468E30C862129741C44CD759698CE97A1EBFCBA21D764D410591EE7063D4A632FD29AD3449C9B0DFBC9FF499E509A0969E40EA76C3AE2863ACBBC992A983F178890D4B1E505497F0A52900EFB38BDD51ED38CC446055817F90C1C892D25C947EE3AE8A8349A59E52B167953D94E0FB0082EE1A41137CB068ACD59E4752201F98ECA9664AD60B18C32213DF2545F63BF81939F78FABD925C71CDEE8114C56A96C1A70FD25E90066AB4026471D8372D30665DAC9B54EC472D58F09A4903599BC5D9C556B25898BAB963E93DFAC900B67CF7D3E060D71817CE9CF36D42A16F7BA93CBD3440B1A754DA038A8AD0D4430E66E7',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWV6TZVEMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDgy\nNzA3MzIwOVoXDTE4MDgyODA3MzM0OVowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDmfY2N4f3dLCRl6tLiyEaUaOMMhiEpdBxEzXWWmM6Xoev8uiHX\nZNQQWR7nBj1KYy/SmtNEnJsN+8n/SZ5Qmglp5A6nbDrihjrLvJkqmD8XiJDUseUF\nSX8KUpAO+zi91R7TjMRGBVgX+QwciS0lyUfuOuioNJpZ5SsWeVPZTg+wCC7hpBE3\nywaKzVnkdSIB+Y7KlmStYLGMMiE98lRfY7+Bk594+r2SXHHN7oEUxWqWwacP0l6Q\nBmq0AmRx2DctMGZdrJtU7EctWPCaSQNZm8XZxVayWJi6uWPpPfrJALZ899PgYNcY\nF86c821CoW97qTy9NECxp1TaA4qK0NRDDmbnAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAHbnTxSYqKT1lp2E4+P5twSR17jQjT8t\n9p7Fial6P8NhPiEIU67pO2RSLTESTiHGtYU1kIRxWxFp3KUxbrkdUeluUluYkmwL\nqHilSf3rVR8oNt0gxn8TcWSqkFag9lsj1T/1rB/m5gRrA7Jy+GxX1RTvwGlAnkIu\nlG1j9GFg1x6JB5kwB6ibzz7nA+ibA8PX08CcKHRD2BRnYbmnNJp9JX7TbQBWXGHT\nV6jPBxsO6ogkPRLjgHn9+RrqX6OS+Sz112CTa+FfyG+97tu7m46TYKmN6+1cVLpl\nhxf26RTDcnD/p1+sBSmGeeHO2IbsSkRMvdqGQpaK7NfL4uYEikMQs2w=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200416
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49898
received auth hello!
{ authId: 502, nonce: <Buffer 36 82 4f fe 75 db 9c cd> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer ba 56 11 1f 05 c0 46 80>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer c5 aa 19 2e d7 07 25 39 06 c1 8d 5f 6a 47 67 5e>,
  macKeyVal: <Buffer eb 73 39 02 81 3b a4 67 e4 c7 45 06 25 a6 31 51 e6 b8 49 6e 55 b2 6b 79 59 07 e3 9e da 0e ac e6>,
  absValidity: 2018-08-27T08:47:17.507Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fa 86 5a 04 41 88 e0 ba>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fa 86 5a 04 41 88 e0 ba> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.67:60110',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200429
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50164
received auth hello!
{ authId: 502, nonce: <Buffer 34 9a 36 4d 73 61 4b 1a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 58 e4 5c 22 de 64 12 eb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9a 73 23 47 d5 ec c4 77>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9a 73 23 47 d5 ec c4 77> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.67:60376',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200442
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50434
received auth hello!
{ authId: 502, nonce: <Buffer 08 72 4c b5 ed 71 5d ea> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 70 44 38 8b 70 9f 20 87>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9a 42 24 94 2d 02 fa 38>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9a 42 24 94 2d 02 fa 38> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.67:60646',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200455
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50700
received auth hello!
{ authId: 502, nonce: <Buffer fc 39 54 99 59 d3 81 83> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 56 8a 3e b9 80 b2 b5 07>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1c 6f 06 b1 e5 05 7f 4a>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 1c 6f 06 b1 e5 05 7f 4a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.67:60912',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200468
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50966
received auth hello!
{ authId: 502, nonce: <Buffer 54 40 33 f9 c0 f6 50 24> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 63 1c 9e 32 d1 c5 87 2d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 21 ec ff c5 e3 36 dc d4>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 21 ec ff c5 e3 36 dc d4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.67:32946',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200481
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51232
received auth hello!
{ authId: 502, nonce: <Buffer 13 50 59 89 5f 08 b1 f7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8f 63 95 96 5b de e9 a8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b7 ca b9 b4 9f c5 dc 39>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b7 ca b9 b4 9f c5 dc 39> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.67:33212',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200494
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51494
received auth hello!
{ authId: 502, nonce: <Buffer e1 16 7b 3b 67 49 41 fb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 57 61 94 2c f6 4f 6b 15>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8c 2b cf e5 c6 bc d9 9e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8c 2b cf e5 c6 bc d9 9e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.67:33474',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200507
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51760
received auth hello!
{ authId: 502, nonce: <Buffer aa 05 e7 24 18 ec 7d 11> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e8 dd 91 2a d4 2b cf 01>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f2 d5 d1 2b 1b 0c 05 15>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f2 d5 d1 2b 1b 0c 05 15> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.67:33740',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200520
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52026
received auth hello!
{ authId: 502, nonce: <Buffer 79 3b a5 d4 f7 e2 e4 67> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e2 2b a1 59 f1 4c a6 d3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9b f9 0d 33 b6 53 fa cd>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9b f9 0d 33 b6 53 fa cd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.67:34006',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200533
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52288
received auth hello!
{ authId: 502, nonce: <Buffer 0b 77 e2 14 d8 02 c6 7d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 77 75 b5 88 ff 25 1f 8b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6a d8 f7 4a a6 70 2d ee>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6a d8 f7 4a a6 70 2d ee> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.67:34268',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200546
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52550
received auth hello!
{ authId: 502, nonce: <Buffer 30 0a 36 23 93 1a f1 52> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 66 8f 62 1b a3 2a cf f1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 54 88 af 18 ae 6c a7 97>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 54 88 af 18 ae 6c a7 97> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.67:34530',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200559
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52816
received auth hello!
{ authId: 502, nonce: <Buffer 25 43 17 88 a4 13 9d 90> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 73 50 16 b8 6a 78 e4 c1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 44 69 2a 11 72 c7 e5 1e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 44 69 2a 11 72 c7 e5 1e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.67:34796',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200572
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53082
received auth hello!
{ authId: 502, nonce: <Buffer 21 ca 9b a3 ef fb 73 fe> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e4 a2 51 3f e8 ab f1 39>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ae f3 49 00 74 88 d0 b2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ae f3 49 00 74 88 d0 b2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.67:35062',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200585
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53348
received auth hello!
{ authId: 502, nonce: <Buffer ff 9f 6d 44 c8 60 91 27> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c9 c8 5f f5 ca c6 cb c5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9d dc 3e 21 b8 dd 55 37>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9d dc 3e 21 b8 dd 55 37> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.67:35328',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200598
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53614
received auth hello!
{ authId: 502, nonce: <Buffer 64 ee a3 ab 6b 30 37 30> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 60 b6 e9 d8 8f 48 ad 64>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b1 39 68 f5 a9 98 a2 78>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b1 39 68 f5 a9 98 a2 78> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.67:35594',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200611
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53880
received auth hello!
{ authId: 502, nonce: <Buffer 40 a0 25 07 7e 25 de 86> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e3 8b ec a0 9f c7 7a 26>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 33 a5 d3 3c f7 8e d7 6c>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 33 a5 d3 3c f7 8e d7 6c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.67:35860',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200624
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54118
received auth hello!
{ authId: 502, nonce: <Buffer bb b6 34 90 42 ac b6 12> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9f d4 cd 8c 54 70 05 6b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer da 51 e6 d8 ad fb 9d 6c>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer da 51 e6 d8 ad fb 9d 6c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.67:36096',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
