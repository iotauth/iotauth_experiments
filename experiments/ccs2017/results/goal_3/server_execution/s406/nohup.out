changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s406.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's406',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 73 4f ... > }
Handler: listening on port 22100
s406:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200056
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46550
received auth hello!
{ authId: 402, nonce: <Buffer ad e7 61 90 ac 61 54 66> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 36 5d 27 ba 00 b2 f6 86>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 0a e2 cb 91 1e 97 bd 4e 02 6d 94 75 07 86 3a e6>,
  macKeyVal: <Buffer 80 dd 9b 00 60 8e 10 ad dc 24 3c 8d 42 52 24 23 39 c9 76 9b de 25 5a d9 ea 6a 89 74 ed fd eb 3a>,
  absValidity: 2018-08-27T08:35:20.537Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c4 c7 c6 5c 68 c7 36 e5>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c4 c7 c6 5c 68 c7 36 e5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.50:37750',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200063
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46706
received auth hello!
{ authId: 402, nonce: <Buffer 74 30 2c c5 05 91 09 37> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6f 95 d7 cd d2 e4 8a f2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b5 75 e9 ea 6c 95 b4 11>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b5 75 e9 ea 6c 95 b4 11> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.50:37906',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200070
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46968
received auth hello!
{ authId: 402, nonce: <Buffer de 34 7b 91 be 7f 75 d8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1b 9d 16 de 70 73 d4 7d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 55 8c f3 2a c6 ce 6e 33>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 55 8c f3 2a c6 ce 6e 33> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.50:38168',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200077
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47238
received auth hello!
{ authId: 402, nonce: <Buffer f0 6d 20 33 75 b6 0e 73> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fe 57 fe 2e de 7a 12 d9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d0 4e cd 4a 51 d1 e3 72>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d0 4e cd 4a 51 d1 e3 72> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.50:38438',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200084
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47508
received auth hello!
{ authId: 402, nonce: <Buffer d3 17 48 e6 e1 68 7e 51> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a2 f6 db 00 f0 84 a9 00>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1b dd bd 49 e6 6a 7f 54>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1b dd bd 49 e6 6a 7f 54> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.50:38708',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200091
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47778
received auth hello!
{ authId: 402, nonce: <Buffer 29 d1 a6 4f 4a 3f ee 36> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c1 28 d8 91 76 82 4c a4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fb 29 a0 07 84 1c aa e0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fb 29 a0 07 84 1c aa e0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.50:38978',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200098
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48048
received auth hello!
{ authId: 402, nonce: <Buffer 21 30 e5 f4 98 12 71 93> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fa d5 a1 97 01 d1 fd 54>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 16 e4 09 3f 6b d6 d4 a6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 16 e4 09 3f 6b d6 d4 a6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.50:39248',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200105
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48318
received auth hello!
{ authId: 402, nonce: <Buffer 36 b1 51 56 92 83 1f f0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fc e0 a4 b4 ea 38 14 fa>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a3 ec 19 c8 02 19 b1 bb>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer a3 ec 19 c8 02 19 b1 bb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.50:39518',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300280
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300290
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 43582
received auth hello!
{ authId: 503, nonce: <Buffer 84 b4 2d 1f 69 97 fe 76> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth503',
     commonName: '10.0.1.6' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth402',
     commonName: '10.0.0.2' },
  serial: '01657A4D921F',
  notBefore: 2018-08-27T07:32:08.000Z,
  notAfter: 2018-08-28T07:33:48.000Z,
  subjectHash: '5542437f',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '57:A2:A5:44:F9:8B:AC:E9:1C:D3:1D:81:61:B8:C9:50:57:07:4E:2E',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'BC5D33480D8E7016713911F6B0F0A9131DC7B60A8CB9E1A10BD7543A76CF24678BCCDEF96EAE9DEBCABF978E7789E6CA0C84927254FA399F63769AE55F612D6596ED8937A047D141B0D94354445A0E25D81DE385B8957F9947FECEBCDBC6998D6544DD90F3D3ED8804119CBEF9AD775F3F63F7F6C01396688740867299DD55D2F05ED7417633969B004111F87931929D7463F27FD75E378152650127AE67180E37BB11DC459BB1B15A8A91A3EC4E9A4F409BAB5AD5C90FB833EA0A8D966FFEA0CC1054B7557DF4DC8B1152F7CC89313B4089920237B6D064F37CDE972831ADFD6643D155A4CDB156DC70EE29EC7CAE2C434B3120E75B3A239E854968A41D6A23',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.6' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 503,
  host: '10.0.1.6',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWV6TZIfMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDIxETAPBgNVBAMMCDEwLjAuMC4yMB4XDTE4MDgy\nNzA3MzIwOFoXDTE4MDgyODA3MzM0OFowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMzERMA8GA1UEAwwIMTAuMC4xLjYwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQC8XTNIDY5wFnE5Efaw8KkTHce2Coy54aEL11Q6ds8kZ4vM3vlu\nrp3ryr+XjneJ5soMhJJyVPo5n2N2muVfYS1llu2JN6BH0UGw2UNURFoOJdgd44W4\nlX+ZR/7OvNvGmY1lRN2Q89PtiAQRnL75rXdfP2P39sATlmiHQIZymd1V0vBe10F2\nM5abAEER+Hkxkp10Y/J/1143gVJlASeuZxgON7sR3EWbsbFaipGj7E6aT0Cbq1rV\nyQ+4M+oKjZZv/qDMEFS3VX303IsRUvfMiTE7QImSAje20GTzfN6XKDGt/WZD0VWk\nzbFW3HDuKex8rixDSzEg51s6I56FSWikHWojAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQYwDQYJKoZIhvcNAQELBQADggEBAI88N4Mj21NZsJLhiycfEB9jzdK844n4\nq93aLcb5pgGMbXeEJchupnYCvQ8c4TM778yZ8eXMrII1MgYjFbp45noPxZCSCM/K\n59pISG3gLy+KknKbDNABh0DgUMUXowBnpua2PbOaktLSiHeQLKFqV4kBMGrrpSd5\nEwVzGrYE9PKKnRiLy6JUyVpUZQ2dV8dev31R6c1KH18pIrVJpGV95dpoAWw4dZGD\nicL/vTa9EhjkG9jkg1ur0S3jiYR/j7N15tbi1Vxn8zy90LgQXXrjwo+hmnN0JEn/\nz/NaggrMlFlXj0O/hcqxun/9+NWpu+nctSRAhZM5e1mPrXxKGQAiyyY=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300300
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43838
received auth hello!
{ authId: 503, nonce: <Buffer 31 79 66 fa 6d 90 5e 55> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 2c 20 5a 06 b9 2d 0b 06>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 66 10 d7 05 d3 16 14 4f fc 36 1c 15 f3 52 5b 72>,
  macKeyVal: <Buffer 35 64 42 31 1f ee 80 97 73 2b c8 84 75 e9 aa 89 a6 48 24 8c 0f 03 cf d8 3c a8 19 cd fe 5f 3c 6a>,
  absValidity: 2018-08-27T08:47:20.960Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 08 e8 da 59 bd db bc a8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 08 e8 da 59 bd db bc a8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.50:40744',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300310
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44108
received auth hello!
{ authId: 503, nonce: <Buffer 93 03 af e2 c1 8e 38 d8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 01 e4 aa b8 13 df 4d 8c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8d 93 6b 65 1b 31 64 52>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8d 93 6b 65 1b 31 64 52> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.50:41014',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300320
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44378
received auth hello!
{ authId: 503, nonce: <Buffer fd a0 5e f2 d9 95 6f f8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 56 02 ed 05 14 00 30 43>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8e c1 b7 6c 0f 39 54 85>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8e c1 b7 6c 0f 39 54 85> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.50:41284',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300330
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44642
received auth hello!
{ authId: 503, nonce: <Buffer 4d 50 47 5b f9 84 47 62> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b1 0b f4 d5 0a 64 a3 b0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1c 71 99 25 ca 6e b1 93>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1c 71 99 25 ca 6e b1 93> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.50:41546',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300340
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44908
received auth hello!
{ authId: 503, nonce: <Buffer 8c ed b4 f2 69 b7 6b 00> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5f ce 6d c1 e6 de 91 06>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 23 71 43 f2 3c 4d d4 94>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 23 71 43 f2 3c 4d d4 94> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.50:41812',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300350
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45174
received auth hello!
{ authId: 503, nonce: <Buffer b3 f5 a0 c8 ca 57 0a d7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1f 03 e1 49 3c 25 06 8e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 88 7e c3 97 4c 23 89 57>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 88 7e c3 97 4c 23 89 57> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.50:42078',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300360
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45436
received auth hello!
{ authId: 503, nonce: <Buffer b5 da 93 e1 96 ef 55 86> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 83 5c 39 dd c7 de 18 90>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 25 99 e2 64 af fc ec 60>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 25 99 e2 64 af fc ec 60> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.50:42340',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300370
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45700
received auth hello!
{ authId: 503, nonce: <Buffer 05 3c f0 f9 23 60 f9 0e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 43 3d 28 65 20 ab d2 96>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 93 a2 9a f6 6f af fd 4a>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 93 a2 9a f6 6f af fd 4a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.50:42606',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300380
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45970
received auth hello!
{ authId: 503, nonce: <Buffer 28 d0 e8 f5 26 f2 39 d4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ca 2b 67 ab a3 59 cb 54>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 80 b2 d1 41 75 c0 da d0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 80 b2 d1 41 75 c0 da d0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.50:42876',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300390
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46232
received auth hello!
{ authId: 503, nonce: <Buffer e5 16 e9 8b cd 10 fb 2a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 94 7d 32 24 93 5a 01 6f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5b a3 01 bd 51 02 e5 bc>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5b a3 01 bd 51 02 e5 bc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.50:43138',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300400
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46492
received auth hello!
{ authId: 503, nonce: <Buffer b5 bd 26 1f 57 58 a4 2d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d9 56 05 c0 5a 97 fa ec>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b1 fd d9 04 69 d8 51 fe>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b1 fd d9 04 69 d8 51 fe> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.50:43396',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300410
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46760
received auth hello!
{ authId: 503, nonce: <Buffer 64 26 ec 13 ac f0 7e 51> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bb 0b 04 45 9c f3 3b f5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f0 62 50 c1 d4 3b 82 b1>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f0 62 50 c1 d4 3b 82 b1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.50:43666',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300420
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47026
received auth hello!
{ authId: 503, nonce: <Buffer ef 47 ce a0 35 5a d5 65> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f0 81 df c4 e6 a8 ff 34>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 10 33 e5 2b 02 17 83 7a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 10 33 e5 2b 02 17 83 7a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.50:43932',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300430
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47292
received auth hello!
{ authId: 503, nonce: <Buffer e6 ec 55 60 61 5c 20 1d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 08 bd 93 22 3b 39 3f 4b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a2 db a9 1a 62 9d f9 d9>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer a2 db a9 1a 62 9d f9 d9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.50:44198',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300440
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47558
received auth hello!
{ authId: 503, nonce: <Buffer c0 30 24 89 72 15 0c 05> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d3 f9 ac df 04 50 f9 39>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fa ba d7 40 fa 81 85 df>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fa ba d7 40 fa 81 85 df> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.50:44464',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300450
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47824
received auth hello!
{ authId: 503, nonce: <Buffer 7d 59 ea 2e 65 1c 2c de> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 82 17 c3 56 a4 40 bc 11>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9f f1 9d 66 65 1e 68 57>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 9f f1 9d 66 65 1e 68 57> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.50:44730',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
