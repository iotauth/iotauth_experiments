changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c412.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c412',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 75 47 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1535355332705
connected to auth! from local port 38848
received auth hello!
{ authId: 402, nonce: <Buffer 34 3c f1 44 0e cd dd a2> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 27 44 bd b9 de a8 ff 43>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer be 62 1c ba b2 3c b0 88 fa 83 c9 b7 93 f0 4c 93>,
  macKeyVal: <Buffer d7 96 bd ab 16 00 22 fc 60 ab 50 ff 09 df 66 33 a3 50 be 91 76 dd 11 7f ed dd 35 f7 30 aa d6 93>,
  absValidity: 2018-08-27T08:35:33.760Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200060,
  cipherKeyVal: <Buffer 00 26 82 aa 6a 5c 45 ea 4e 57 95 e0 af 15 53 e0>,
  macKeyVal: <Buffer 13 fd ab 08 2a a8 cb 64 25 33 ab 53 4d df 3a 81 57 b2 41 1c ae 99 bf 71 8a 4b 3c 5c c1 df c4 6a>,
  absValidity: 2018-08-28T07:35:33.759Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200060,
     cipherKeyVal: <Buffer 00 26 82 aa 6a 5c 45 ea 4e 57 95 e0 af 15 53 e0>,
     macKeyVal: <Buffer 13 fd ab 08 2a a8 cb 64 25 33 ab 53 4d df 3a 81 57 b2 41 1c ae 99 bf 71 8a 4b 3c 5c c1 df c4 6a>,
     absValidity: 2018-08-28T07:35:33.759Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer d6 f4 2c b5 f6 60 a4 d2>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 07:35:35 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1535355336144
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1535355392760
connected to auth! from local port 39028
received auth hello!
{ authId: 402, nonce: <Buffer 1a 3a f2 04 5d 32 93 b4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer de 26 a9 66 90 d2 a5 73>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200067,
  cipherKeyVal: <Buffer 13 62 d7 ba ed ee bb 35 f1 f1 b5 60 1b 40 49 8c>,
  macKeyVal: <Buffer d1 b3 9a 23 17 84 0f 73 f5 6b 64 b3 54 82 06 0d 23 20 9f 9f 26 6e 55 0e cd fa 28 db 6f e7 4a 13>,
  absValidity: 2018-08-28T07:36:33.822Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200067,
     cipherKeyVal: <Buffer 13 62 d7 ba ed ee bb 35 f1 f1 b5 60 1b 40 49 8c>,
     macKeyVal: <Buffer d1 b3 9a 23 17 84 0f 73 f5 6b 64 b3 54 82 06 0d 23 20 9f 9f 26 6e 55 0e cd fa 28 db 6f e7 4a 13>,
     absValidity: 2018-08-28T07:36:33.822Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer c8 f5 87 c6 36 f4 d6 0e>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 07:36:35 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1535355396316
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1535355452816
connected to auth! from local port 39300
received auth hello!
{ authId: 402, nonce: <Buffer 8e 74 31 a8 cc 6d 18 0b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1c ac 0e e7 12 50 84 e3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200074,
  cipherKeyVal: <Buffer c6 3d 3e 97 84 72 a6 27 50 d5 8a f3 ab cc fc c7>,
  macKeyVal: <Buffer 9e 51 a7 a6 49 e3 6b 72 46 db b3 78 9c 59 0f 1b fe 3c 75 cc 10 d3 ff 9d d5 8a 5d 39 bc 35 90 c7>,
  absValidity: 2018-08-28T07:37:33.882Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200074,
     cipherKeyVal: <Buffer c6 3d 3e 97 84 72 a6 27 50 d5 8a f3 ab cc fc c7>,
     macKeyVal: <Buffer 9e 51 a7 a6 49 e3 6b 72 46 db b3 78 9c 59 0f 1b fe 3c 75 cc 10 d3 ff 9d d5 8a 5d 39 bc 35 90 c7>,
     absValidity: 2018-08-28T07:37:33.882Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 91 11 c0 d2 24 3f 56 53>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 07:37:36 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1535355456490
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1535355512872
connected to auth! from local port 39570
received auth hello!
{ authId: 402, nonce: <Buffer a1 80 1b 26 ac 5e 51 9c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f1 db 58 3f 9d 48 3c e8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200081,
  cipherKeyVal: <Buffer ec ac c6 1c 92 70 9b af 57 07 32 c5 95 c1 1f d1>,
  macKeyVal: <Buffer 96 ca c0 6d 22 a9 eb db 5c 9e 5f e9 d6 57 ac 6b 83 d7 f5 45 f6 ef c4 98 2c 77 88 0b 5d 27 90 82>,
  absValidity: 2018-08-28T07:38:33.965Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200081,
     cipherKeyVal: <Buffer ec ac c6 1c 92 70 9b af 57 07 32 c5 95 c1 1f d1>,
     macKeyVal: <Buffer 96 ca c0 6d 22 a9 eb db 5c 9e 5f e9 d6 57 ac 6b 83 d7 f5 45 f6 ef c4 98 2c 77 88 0b 5d 27 90 82>,
     absValidity: 2018-08-28T07:38:33.965Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer a0 dc 65 39 68 bc f9 3c>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 07:38:36 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1535355516483
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1535355572928
connected to auth! from local port 39840
received auth hello!
{ authId: 402, nonce: <Buffer 37 a8 72 9a 66 1d 3d 3a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 78 f8 d2 33 ef 24 0f ae>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200088,
  cipherKeyVal: <Buffer 27 5e d4 e2 95 5c c2 fc 45 67 75 35 c0 55 40 a8>,
  macKeyVal: <Buffer d5 49 47 40 f3 e4 d0 9a 8b 01 13 81 b6 ae 02 48 7c 3c 44 2c 0f 31 b8 d3 d1 2a b0 96 cd a7 7b e7>,
  absValidity: 2018-08-28T07:39:33.916Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200088,
     cipherKeyVal: <Buffer 27 5e d4 e2 95 5c c2 fc 45 67 75 35 c0 55 40 a8>,
     macKeyVal: <Buffer d5 49 47 40 f3 e4 d0 9a 8b 01 13 81 b6 ae 02 48 7c 3c 44 2c 0f 31 b8 d3 d1 2a b0 96 cd a7 7b e7>,
     absValidity: 2018-08-28T07:39:33.916Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 53 6b 7b 0d 51 59 71 64>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 07:39:36 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1535355576378
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1535355632984
connected to auth! from local port 40110
received auth hello!
{ authId: 402, nonce: <Buffer ef ef 09 b3 8f 89 2b b4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9d 6e 6e 89 79 08 bb bc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200095,
  cipherKeyVal: <Buffer 70 1d c4 9f c9 a0 7e e0 1a 76 ec 62 0c 9c b9 e1>,
  macKeyVal: <Buffer 4f 95 88 2b 47 db b9 45 5a 61 1f a2 5b 10 6e e1 75 83 d7 51 45 35 97 8f 8a 13 0a 7f f5 68 39 ba>,
  absValidity: 2018-08-28T07:40:33.982Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200095,
     cipherKeyVal: <Buffer 70 1d c4 9f c9 a0 7e e0 1a 76 ec 62 0c 9c b9 e1>,
     macKeyVal: <Buffer 4f 95 88 2b 47 db b9 45 5a 61 1f a2 5b 10 6e e1 75 83 d7 51 45 35 97 8f 8a 13 0a 7f f5 68 39 ba>,
     absValidity: 2018-08-28T07:40:33.982Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 8c 65 6e 74 75 51 a7 6a>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 07:40:36 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1535355636509
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1535355693041
connected to auth! from local port 40380
received auth hello!
{ authId: 402, nonce: <Buffer 10 10 95 9c 5e 17 a7 a1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 72 0b f7 bd 1a f4 e3 ad>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200102,
  cipherKeyVal: <Buffer 57 3d 43 7a 33 9c d6 f3 a7 3f fb 27 47 d3 4b c5>,
  macKeyVal: <Buffer d2 6c b0 e8 93 cf 1f 2c 70 e5 57 1b 36 ab bc ea 54 ca 86 cc 23 6a e5 c7 0d 51 d2 6d f4 41 2e 07>,
  absValidity: 2018-08-28T07:41:34.049Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200102,
     cipherKeyVal: <Buffer 57 3d 43 7a 33 9c d6 f3 a7 3f fb 27 47 d3 4b c5>,
     macKeyVal: <Buffer d2 6c b0 e8 93 cf 1f 2c 70 e5 57 1b 36 ab bc ea 54 ca 86 cc 23 6a e5 c7 0d 51 d2 6d f4 41 2e 07>,
     absValidity: 2018-08-28T07:41:34.049Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 7e 31 fc 8c f5 44 2a 86>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 07:41:36 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1535355696632
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1535355753096
connected to auth! from local port 40646
received auth hello!
{ authId: 402, nonce: <Buffer 2e d6 bf 94 1d 76 1e 9b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 23 b0 2c 4b 60 73 c1 60>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200109,
  cipherKeyVal: <Buffer 44 f0 a2 c4 cf 83 dd ac 65 ea 0a ad b4 36 d7 fc>,
  macKeyVal: <Buffer 3f 6c 43 26 d6 eb e6 5d 99 38 9c c0 bb 1d 36 a0 97 60 28 d3 3d fe 42 f6 94 39 6d a9 21 38 50 eb>,
  absValidity: 2018-08-28T07:42:34.075Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200109,
     cipherKeyVal: <Buffer 44 f0 a2 c4 cf 83 dd ac 65 ea 0a ad b4 36 d7 fc>,
     macKeyVal: <Buffer 3f 6c 43 26 d6 eb e6 5d 99 38 9c c0 bb 1d 36 a0 97 60 28 d3 3d fe 42 f6 94 39 6d a9 21 38 50 eb>,
     absValidity: 2018-08-28T07:42:34.075Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer f4 82 30 f5 08 3f 46 91>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 07:42:36 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 8 1 1535355757156
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 9 0.8888888888888888 1535355813100
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 10 0.8 1535355873110
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 55608
received auth hello!
{ authId: 503, nonce: <Buffer 5b 09 b1 13 d9 be 6a df> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth503',
     commonName: '10.0.1.6' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth402',
     commonName: '10.0.0.2' },
  serial: '01657A4D921F',
  notBefore: 2018-08-27T07:32:08.000Z,
  notAfter: 2018-08-28T07:33:48.000Z,
  subjectHash: '5542437f',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '57:A2:A5:44:F9:8B:AC:E9:1C:D3:1D:81:61:B8:C9:50:57:07:4E:2E',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'BC5D33480D8E7016713911F6B0F0A9131DC7B60A8CB9E1A10BD7543A76CF24678BCCDEF96EAE9DEBCABF978E7789E6CA0C84927254FA399F63769AE55F612D6596ED8937A047D141B0D94354445A0E25D81DE385B8957F9947FECEBCDBC6998D6544DD90F3D3ED8804119CBEF9AD775F3F63F7F6C01396688740867299DD55D2F05ED7417633969B004111F87931929D7463F27FD75E378152650127AE67180E37BB11DC459BB1B15A8A91A3EC4E9A4F409BAB5AD5C90FB833EA0A8D966FFEA0CC1054B7557DF4DC8B1152F7CC89313B4089920237B6D064F37CDE972831ADFD6643D155A4CDB156DC70EE29EC7CAE2C434B3120E75B3A239E854968A41D6A23',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.6' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 503,
  host: '10.0.1.6',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWV6TZIfMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDIxETAPBgNVBAMMCDEwLjAuMC4yMB4XDTE4MDgy\nNzA3MzIwOFoXDTE4MDgyODA3MzM0OFowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMzERMA8GA1UEAwwIMTAuMC4xLjYwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQC8XTNIDY5wFnE5Efaw8KkTHce2Coy54aEL11Q6ds8kZ4vM3vlu\nrp3ryr+XjneJ5soMhJJyVPo5n2N2muVfYS1llu2JN6BH0UGw2UNURFoOJdgd44W4\nlX+ZR/7OvNvGmY1lRN2Q89PtiAQRnL75rXdfP2P39sATlmiHQIZymd1V0vBe10F2\nM5abAEER+Hkxkp10Y/J/1143gVJlASeuZxgON7sR3EWbsbFaipGj7E6aT0Cbq1rV\nyQ+4M+oKjZZv/qDMEFS3VX303IsRUvfMiTE7QImSAje20GTzfN6XKDGt/WZD0VWk\nzbFW3HDuKex8rixDSzEg51s6I56FSWikHWojAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQYwDQYJKoZIhvcNAQELBQADggEBAI88N4Mj21NZsJLhiycfEB9jzdK844n4\nq93aLcb5pgGMbXeEJchupnYCvQ8c4TM778yZ8eXMrII1MgYjFbp45noPxZCSCM/K\n59pISG3gLy+KknKbDNABh0DgUMUXowBnpua2PbOaktLSiHeQLKFqV4kBMGrrpSd5\nEwVzGrYE9PKKnRiLy6JUyVpUZQ2dV8dev31R6c1KH18pIrVJpGV95dpoAWw4dZGD\nicL/vTa9EhjkG9jkg1ur0S3jiYR/j7N15tbi1Vxn8zy90LgQXXrjwo+hmnN0JEn/\nz/NaggrMlFlXj0O/hcqxun/9+NWpu+nctSRAhZM5e1mPrXxKGQAiyyY=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 11 0.7272727272727273 1535355933120
connected to auth! from local port 55872
received auth hello!
{ authId: 503, nonce: <Buffer a0 11 f3 33 a2 5c f4 a3> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer c1 cb 37 d4 ed 42 d6 6d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer c7 42 52 14 4f e8 26 bb e2 0e c0 e6 a9 76 6e df>,
  macKeyVal: <Buffer e8 6c a8 8d 58 29 0d 1a 27 78 26 2e 93 82 9c b5 61 2d 69 79 d4 e1 a7 bc c7 a9 86 0a 3b 42 6e 44>,
  absValidity: 2018-08-27T08:45:33.297Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300284,
  cipherKeyVal: <Buffer 76 83 2f 57 95 8d f3 d1 42 af 51 20 6a 56 0d cb>,
  macKeyVal: <Buffer 98 cd 7d 1a f5 73 30 24 7a ca fd 58 f8 3e 17 74 7e 0f 97 93 a5 99 73 eb ef ba 1a dc a9 a0 1f 6b>,
  absValidity: 2018-08-28T07:45:33.297Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300284,
     cipherKeyVal: <Buffer 76 83 2f 57 95 8d f3 d1 42 af 51 20 6a 56 0d cb>,
     macKeyVal: <Buffer 98 cd 7d 1a f5 73 30 24 7a ca fd 58 f8 3e 17 74 7e 0f 97 93 a5 99 73 eb ef ba 1a dc a9 a0 1f 6b>,
     absValidity: 2018-08-28T07:45:33.297Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer a5 3b 57 95 e8 d6 40 81>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.15:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 12 0.6666666666666666 1535355993130
connected to auth! from local port 56160
received auth hello!
{ authId: 503, nonce: <Buffer 86 95 aa 59 96 59 b0 ec> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 07 e4 51 86 eb 9b e6 f3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300294,
  cipherKeyVal: <Buffer 9c 79 fc 42 a8 df 0a f7 93 b3 da eb 4f 08 38 14>,
  macKeyVal: <Buffer da f6 99 64 67 d3 72 64 ce 52 51 da fd 17 89 bc 6e d8 d1 d8 bc 79 ed 62 95 ce 23 30 ef 5d f9 70>,
  absValidity: 2018-08-28T07:46:33.427Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300294,
     cipherKeyVal: <Buffer 9c 79 fc 42 a8 df 0a f7 93 b3 da eb 4f 08 38 14>,
     macKeyVal: <Buffer da f6 99 64 67 d3 72 64 ce 52 51 da fd 17 89 bc 6e d8 d1 d8 bc 79 ed 62 95 ce 23 30 ef 5d f9 70>,
     absValidity: 2018-08-28T07:46:33.427Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 75 c6 be 35 a7 ec 5d 5e>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.15:undefined
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 13 0.6153846153846154 1535356053141
connected to auth! from local port 56424
received auth hello!
{ authId: 503, nonce: <Buffer 17 a0 2c ec bf 28 e7 26> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fb 84 0f 8f f7 5e c6 a8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300304,
  cipherKeyVal: <Buffer 02 f7 70 fa 92 06 13 b7 dd 3b a2 88 16 f1 d2 a1>,
  macKeyVal: <Buffer 73 27 ca 8d 33 4d 6d da db dc 0e c0 cc 4d 4b 8f 31 87 25 a7 9d 16 08 ca 83 70 f6 4a ea b2 fe 71>,
  absValidity: 2018-08-28T07:47:33.450Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300304,
     cipherKeyVal: <Buffer 02 f7 70 fa 92 06 13 b7 dd 3b a2 88 16 f1 d2 a1>,
     macKeyVal: <Buffer 73 27 ca 8d 33 4d 6d da db dc 0e c0 cc 4d 4b 8f 31 87 25 a7 9d 16 08 ca 83 70 f6 4a ea b2 fe 71>,
     absValidity: 2018-08-28T07:47:33.450Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 14 0.5714285714285714 1535356113200
connected to auth! from local port 56694
received auth hello!
{ authId: 503, nonce: <Buffer 29 4d ce fb 2d 85 f2 50> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 74 4c 77 0c 16 4f 9c 93>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300314,
  cipherKeyVal: <Buffer b5 12 e8 21 5a e3 17 8e 26 17 3e 45 df b9 87 a6>,
  macKeyVal: <Buffer 19 b1 80 c7 aa 43 8a 4f a7 a3 91 f1 86 45 21 2d db 13 87 02 28 bf 97 3a 41 2e 08 aa f4 78 9c 79>,
  absValidity: 2018-08-28T07:48:33.407Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300314,
     cipherKeyVal: <Buffer b5 12 e8 21 5a e3 17 8e 26 17 3e 45 df b9 87 a6>,
     macKeyVal: <Buffer 19 b1 80 c7 aa 43 8a 4f a7 a3 91 f1 86 45 21 2d db 13 87 02 28 bf 97 3a 41 2e 08 aa f4 78 9c 79>,
     absValidity: 2018-08-28T07:48:33.407Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 15 0.5333333333333333 1535356173260
connected to auth! from local port 56958
received auth hello!
{ authId: 503, nonce: <Buffer 43 b0 a6 62 70 57 6b da> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 07 8a f7 0f 8b 01 ec 7e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300324,
  cipherKeyVal: <Buffer 86 0b f5 69 34 97 ad 8d 1e 70 b5 f2 ce 57 36 bf>,
  macKeyVal: <Buffer c9 7e dd 4e 71 64 d6 2d ee b9 8c 47 12 44 a3 74 ef c8 b8 8f 27 3b e5 b8 fa 63 fa 2b 45 2c 24 58>,
  absValidity: 2018-08-28T07:49:33.533Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300324,
     cipherKeyVal: <Buffer 86 0b f5 69 34 97 ad 8d 1e 70 b5 f2 ce 57 36 bf>,
     macKeyVal: <Buffer c9 7e dd 4e 71 64 d6 2d ee b9 8c 47 12 44 a3 74 ef c8 b8 8f 27 3b e5 b8 fa 63 fa 2b 45 2c 24 58>,
     absValidity: 2018-08-28T07:49:33.533Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 16 0.5 1535356233291
connected to auth! from local port 57228
received auth hello!
{ authId: 503, nonce: <Buffer 8c 2d b3 ed 09 a6 12 16> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fe 33 3d a8 80 f3 33 ef>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300334,
  cipherKeyVal: <Buffer f5 2f 1e 5e 6f ec 2c 03 54 7a 47 70 16 29 1f 1c>,
  macKeyVal: <Buffer 58 38 41 b1 e3 77 bd 69 61 cd e0 f5 37 1a 8b 50 c7 6d 9d e5 cc 36 f4 d7 24 21 14 c8 16 ed 66 74>,
  absValidity: 2018-08-28T07:50:33.543Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300334,
     cipherKeyVal: <Buffer f5 2f 1e 5e 6f ec 2c 03 54 7a 47 70 16 29 1f 1c>,
     macKeyVal: <Buffer 58 38 41 b1 e3 77 bd 69 61 cd e0 f5 37 1a 8b 50 c7 6d 9d e5 cc 36 f4 d7 24 21 14 c8 16 ed 66 74>,
     absValidity: 2018-08-28T07:50:33.543Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 17 0.47058823529411764 1535356293320
connected to auth! from local port 57494
received auth hello!
{ authId: 503, nonce: <Buffer fa 98 d4 4c 9e 0f 1e 40> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 20 75 d7 aa d6 1c 65 06>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300344,
  cipherKeyVal: <Buffer 06 84 c9 ae 01 55 1b 31 53 ae 4d 38 53 cb 7f 02>,
  macKeyVal: <Buffer 4f 43 f3 6a 31 e7 e0 df 08 7c 40 31 ee b3 24 c5 47 97 a4 f6 77 fa 0b 28 17 7a 16 3f 3b 22 9e a8>,
  absValidity: 2018-08-28T07:51:33.546Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300344,
     cipherKeyVal: <Buffer 06 84 c9 ae 01 55 1b 31 53 ae 4d 38 53 cb 7f 02>,
     macKeyVal: <Buffer 4f 43 f3 6a 31 e7 e0 df 08 7c 40 31 ee b3 24 c5 47 97 a4 f6 77 fa 0b 28 17 7a 16 3f 3b 22 9e a8>,
     absValidity: 2018-08-28T07:51:33.546Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 18 0.4444444444444444 1535356353326
connected to auth! from local port 57756
received auth hello!
{ authId: 503, nonce: <Buffer 4d 03 c6 59 2b 94 29 2a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a8 59 f5 fb 86 6d 72 f3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300354,
  cipherKeyVal: <Buffer 90 cb 04 f0 a2 ac bf 77 0a 40 c5 3d a3 5b 29 8f>,
  macKeyVal: <Buffer 23 53 73 aa c2 3e 30 0c fd d7 04 80 5f 28 48 16 8b 9c fd 15 cc 78 0a 6c b1 96 48 c9 69 91 3b f7>,
  absValidity: 2018-08-28T07:52:33.625Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300354,
     cipherKeyVal: <Buffer 90 cb 04 f0 a2 ac bf 77 0a 40 c5 3d a3 5b 29 8f>,
     macKeyVal: <Buffer 23 53 73 aa c2 3e 30 0c fd d7 04 80 5f 28 48 16 8b 9c fd 15 cc 78 0a 6c b1 96 48 c9 69 91 3b f7>,
     absValidity: 2018-08-28T07:52:33.625Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 19 0.42105263157894735 1535356413384
connected to auth! from local port 58022
received auth hello!
{ authId: 503, nonce: <Buffer a5 96 88 7b ab 1b 22 15> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 96 9a e2 b2 2a 31 58 27>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300364,
  cipherKeyVal: <Buffer ef ef a5 5a a3 44 d9 d8 44 e3 5f 56 35 6b f6 e9>,
  macKeyVal: <Buffer c4 76 6b cb 90 1d 69 97 63 e9 b1 0e 99 8a 47 ad a5 26 3b da 3f fd f3 69 48 73 cb f4 11 87 de 7f>,
  absValidity: 2018-08-28T07:53:33.688Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300364,
     cipherKeyVal: <Buffer ef ef a5 5a a3 44 d9 d8 44 e3 5f 56 35 6b f6 e9>,
     macKeyVal: <Buffer c4 76 6b cb 90 1d 69 97 63 e9 b1 0e 99 8a 47 ad a5 26 3b da 3f fd f3 69 48 73 cb f4 11 87 de 7f>,
     absValidity: 2018-08-28T07:53:33.688Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 20 0.4 1535356473438
connected to auth! from local port 58288
received auth hello!
{ authId: 503, nonce: <Buffer 0c 1e ca 7f 26 9f 99 4d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4a 62 b2 e1 9d 41 4b 4c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300374,
  cipherKeyVal: <Buffer c1 59 60 17 91 0e 7d 43 ef 87 ff ba 98 14 3d 5b>,
  macKeyVal: <Buffer ec db 29 57 80 17 60 29 f1 fb 40 41 ab 0b 98 6f 2b 8b 32 05 8f 43 7e 13 d5 22 00 83 1a d7 86 b0>,
  absValidity: 2018-08-28T07:54:33.682Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300374,
     cipherKeyVal: <Buffer c1 59 60 17 91 0e 7d 43 ef 87 ff ba 98 14 3d 5b>,
     macKeyVal: <Buffer ec db 29 57 80 17 60 29 f1 fb 40 41 ab 0b 98 6f 2b 8b 32 05 8f 43 7e 13 d5 22 00 83 1a d7 86 b0>,
     absValidity: 2018-08-28T07:54:33.682Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 21 0.38095238095238093 1535356533496
connected to auth! from local port 58550
received auth hello!
{ authId: 503, nonce: <Buffer a1 e1 dd f4 0e ea 26 30> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1f 1b bb 97 d2 47 79 52>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300384,
  cipherKeyVal: <Buffer 35 ce 5e ae 21 7d ff 2c f4 be 5f ef bd cc d8 c4>,
  macKeyVal: <Buffer e0 22 61 fc 23 c7 e8 93 62 08 56 01 2e ec 72 d0 86 76 84 c8 c8 fb 06 47 5e c0 fa ef 25 be 60 35>,
  absValidity: 2018-08-28T07:55:33.765Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300384,
     cipherKeyVal: <Buffer 35 ce 5e ae 21 7d ff 2c f4 be 5f ef bd cc d8 c4>,
     macKeyVal: <Buffer e0 22 61 fc 23 c7 e8 93 62 08 56 01 2e ec 72 d0 86 76 84 c8 c8 fb 06 47 5e c0 fa ef 25 be 60 35>,
     absValidity: 2018-08-28T07:55:33.765Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 22 0.36363636363636365 1535356593555
connected to auth! from local port 58812
received auth hello!
{ authId: 503, nonce: <Buffer f0 b9 87 ff 66 ce f8 cc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 70 98 7a 3d e7 f8 13 81>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300394,
  cipherKeyVal: <Buffer 74 bc 8b f4 85 e5 93 f0 15 60 14 2a 3e ab ad 70>,
  macKeyVal: <Buffer 52 3e d8 bd ca ae 62 c6 3f d0 a1 28 69 40 d3 e8 ff 6a d1 71 64 75 ad db 0a f9 e4 ca b2 c9 48 61>,
  absValidity: 2018-08-28T07:56:33.774Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300394,
     cipherKeyVal: <Buffer 74 bc 8b f4 85 e5 93 f0 15 60 14 2a 3e ab ad 70>,
     macKeyVal: <Buffer 52 3e d8 bd ca ae 62 c6 3f d0 a1 28 69 40 d3 e8 ff 6a d1 71 64 75 ad db 0a f9 e4 ca b2 c9 48 61>,
     absValidity: 2018-08-28T07:56:33.774Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 23 0.34782608695652173 1535356653592
connected to auth! from local port 59074
received auth hello!
{ authId: 503, nonce: <Buffer 79 d7 c1 62 28 48 a2 50> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 80 7d 24 53 02 9f 9d e8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300404,
  cipherKeyVal: <Buffer 10 0c 4a c0 21 b5 87 3c 59 ac 02 ca d6 e5 73 2b>,
  macKeyVal: <Buffer a7 0d e3 34 22 61 92 65 ef 58 d0 f2 db 5e ba 5d 54 33 5b 8b 2a 65 2d f8 e2 da 9f 9d 3c 40 cf a7>,
  absValidity: 2018-08-28T07:57:33.828Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300404,
     cipherKeyVal: <Buffer 10 0c 4a c0 21 b5 87 3c 59 ac 02 ca d6 e5 73 2b>,
     macKeyVal: <Buffer a7 0d e3 34 22 61 92 65 ef 58 d0 f2 db 5e ba 5d 54 33 5b 8b 2a 65 2d f8 e2 da 9f 9d 3c 40 cf a7>,
     absValidity: 2018-08-28T07:57:33.828Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 24 0.3333333333333333 1535356713607
connected to auth! from local port 59344
received auth hello!
{ authId: 503, nonce: <Buffer c6 66 a2 a6 73 1d 73 fe> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 15 ad a3 fa b9 8b 6f fa>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300414,
  cipherKeyVal: <Buffer 90 5b 32 ca bd d5 84 65 e4 e8 53 19 28 74 cc 66>,
  macKeyVal: <Buffer 31 46 bd d5 04 52 37 1a bd 30 c6 52 e9 03 43 1f 3b fa 68 13 b8 2f 84 2a 01 74 8a 3a 49 5d 1d 9d>,
  absValidity: 2018-08-28T07:58:33.902Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300414,
     cipherKeyVal: <Buffer 90 5b 32 ca bd d5 84 65 e4 e8 53 19 28 74 cc 66>,
     macKeyVal: <Buffer 31 46 bd d5 04 52 37 1a bd 30 c6 52 e9 03 43 1f 3b fa 68 13 b8 2f 84 2a 01 74 8a 3a 49 5d 1d 9d>,
     absValidity: 2018-08-28T07:58:33.902Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 25 0.32 1535356773615
connected to auth! from local port 59606
received auth hello!
{ authId: 503, nonce: <Buffer b6 b4 bb 02 f0 b1 8a 1a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 81 6a f9 21 af 06 79 f3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300424,
  cipherKeyVal: <Buffer 95 88 78 91 b4 5b 30 2c c2 73 dc 2a dc 54 bd 7d>,
  macKeyVal: <Buffer e9 b3 54 6f 02 7a bb 2b 1f bb 5b 96 4e da 4f ca 60 23 75 d7 64 37 fb 15 78 f1 3f a0 de 2d 1e 81>,
  absValidity: 2018-08-28T07:59:33.954Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300424,
     cipherKeyVal: <Buffer 95 88 78 91 b4 5b 30 2c c2 73 dc 2a dc 54 bd 7d>,
     macKeyVal: <Buffer e9 b3 54 6f 02 7a bb 2b 1f bb 5b 96 4e da 4f ca 60 23 75 d7 64 37 fb 15 78 f1 3f a0 de 2d 1e 81>,
     absValidity: 2018-08-28T07:59:33.954Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 26 0.3076923076923077 1535356833641
connected to auth! from local port 59876
received auth hello!
{ authId: 503, nonce: <Buffer 4e 1b db d2 3e b1 b6 93> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1e 28 b8 0c 1b b4 e5 e8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300434,
  cipherKeyVal: <Buffer 81 49 25 63 34 bb 27 42 c3 35 ce 58 f5 67 ee 2e>,
  macKeyVal: <Buffer 1c 31 08 ed 20 34 d9 e9 6a ef 95 1b 4e fe 45 fa 10 cf ef a7 73 79 30 eb 46 f4 7e 77 20 19 2b 3c>,
  absValidity: 2018-08-28T08:00:34.046Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300434,
     cipherKeyVal: <Buffer 81 49 25 63 34 bb 27 42 c3 35 ce 58 f5 67 ee 2e>,
     macKeyVal: <Buffer 1c 31 08 ed 20 34 d9 e9 6a ef 95 1b 4e fe 45 fa 10 cf ef a7 73 79 30 eb 46 f4 7e 77 20 19 2b 3c>,
     absValidity: 2018-08-28T08:00:34.046Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 27 0.2962962962962963 1535356893700
connected to auth! from local port 60142
received auth hello!
{ authId: 503, nonce: <Buffer 76 7a e9 f2 cb 28 7d 25> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 20 2a 44 73 fc b8 50 0e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300444,
  cipherKeyVal: <Buffer fd 97 a7 cf e7 26 91 c4 52 3d ec a1 ed d9 26 fd>,
  macKeyVal: <Buffer b5 72 14 79 28 44 50 06 80 6f 9a 94 b3 13 a7 4d b7 e6 f1 59 25 c2 08 90 fd f0 42 bb be d4 d6 49>,
  absValidity: 2018-08-28T08:01:34.051Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300444,
     cipherKeyVal: <Buffer fd 97 a7 cf e7 26 91 c4 52 3d ec a1 ed d9 26 fd>,
     macKeyVal: <Buffer b5 72 14 79 28 44 50 06 80 6f 9a 94 b3 13 a7 4d b7 e6 f1 59 25 c2 08 90 fd f0 42 bb be d4 d6 49>,
     absValidity: 2018-08-28T08:01:34.051Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 28 0.2857142857142857 1535356953761
connected to auth! from local port 60408
received auth hello!
{ authId: 503, nonce: <Buffer 88 7a f2 4f e4 0b 3b 1e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 46 e4 0d 96 c0 a3 e3 6d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300454,
  cipherKeyVal: <Buffer f3 f9 1c bf fd b1 c7 4d d2 83 2e c5 39 62 d1 93>,
  macKeyVal: <Buffer f9 a5 8d 68 de 9e a6 ba 04 97 07 91 62 6c 84 11 5a 82 c0 37 eb 95 5b ba f8 7e 32 07 86 59 ea f5>,
  absValidity: 2018-08-28T08:02:34.097Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300454,
     cipherKeyVal: <Buffer f3 f9 1c bf fd b1 c7 4d d2 83 2e c5 39 62 d1 93>,
     macKeyVal: <Buffer f9 a5 8d 68 de 9e a6 ba 04 97 07 91 62 6c 84 11 5a 82 c0 37 eb 95 5b ba f8 7e 32 07 86 59 ea f5>,
     absValidity: 2018-08-28T08:02:34.097Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
