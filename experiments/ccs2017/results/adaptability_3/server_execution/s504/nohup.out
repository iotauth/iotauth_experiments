changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s504.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's504',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 67 49 42 41 41 4b 43 41 51 45 41 33 38 ... > }
Handler: listening on port 22100
s504:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100003
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60596
received auth hello!
{ authId: 501, nonce: <Buffer 8c 43 99 b1 7b d4 b5 b6> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 97 9d 14 73 7a 90 f2 b9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer c6 f9 a6 6c 91 50 f0 e0 26 4c 45 2f e6 89 9c 04>,
  macKeyVal: <Buffer 70 ec ca d8 91 44 2b 49 47 79 4f 01 71 d8 93 89 d6 11 43 8e 4c cd a9 c3 50 56 e6 9b b8 04 d4 56>,
  absValidity: 2018-08-27T06:10:50.623Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 86 16 b8 5b 22 54 01 01>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 86 16 b8 5b 22 54 01 01> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.67:36438',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100011
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60852
received auth hello!
{ authId: 501, nonce: <Buffer 2f 34 6a 60 e1 97 87 2e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b7 05 ae ef 8a 22 bc 99>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 83 65 c0 25 e7 02 d1 85>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 83 65 c0 25 e7 02 d1 85> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.67:36694',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100019
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 32890
received auth hello!
{ authId: 501, nonce: <Buffer 25 1a f9 2b d8 52 67 90> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 05 82 4c 4c d0 a8 3f 54>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 02 cd 80 10 68 22 7f a6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 02 cd 80 10 68 22 7f a6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.67:36964',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100027
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33160
received auth hello!
{ authId: 501, nonce: <Buffer 77 74 fb fd ab e0 cc 30> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2e 5c 70 8d c9 2f 53 c7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 49 fe f0 c1 bc d4 37 68>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 49 fe f0 c1 bc d4 37 68> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.67:37234',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100035
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33430
received auth hello!
{ authId: 501, nonce: <Buffer c8 60 8e 15 0c 19 69 b9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 51 75 fd 6e fc ca 36 60>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b0 a6 83 ad d1 32 3e 41>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b0 a6 83 ad d1 32 3e 41> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.67:37504',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100043
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33700
received auth hello!
{ authId: 501, nonce: <Buffer 24 b3 46 c7 82 df 05 0a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 14 97 65 5f 72 c5 29 fb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8c 9c fe ed aa 18 26 8c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8c 9c fe ed aa 18 26 8c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.67:37774',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100051
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33970
received auth hello!
{ authId: 501, nonce: <Buffer be 83 26 26 35 90 1b 72> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 38 9c a5 06 16 77 16 21>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 55 f6 c6 83 f3 52 9d 93>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 55 f6 c6 83 f3 52 9d 93> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.67:38044',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200067
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200080
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 57032
received auth hello!
{ authId: 502, nonce: <Buffer d3 50 c5 af b3 de 97 da> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '016579C872E3',
  notBefore: 2018-08-27T05:06:44.000Z,
  notAfter: 2018-08-28T05:08:24.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '1C:7A:79:10:1B:B2:9A:9F:55:B3:BD:06:30:CC:41:43:1D:7F:B5:39',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'A31E9022457B05D056C9FDEDB58BC733BB1B97C16EF02448C451D7DA8BD15C69BDB461E2FD275C96206B77B283645D6BCD71B284A7AC0F1477E8D62ECAA762A3FA674E23957AED10D73D8ED8838AC41A47FAF8FB50BCB1B3A57C246D7D1861A3880C7CCFDEEB58259C62F656BDFDD4ABE6096C88FFA9EEEF3D32230BB86D8FF4C534038264055EB8B3972DC370931A0A38091A1287BFF40D2EF7D92570D86B1837F35A2EA3F7B96EA0870826501C88C4DC0639DA69AE419D997562C46AF20F50D09554213C3EE69AE5685E2446DC62A309CD065472D9BC7AD27221D047D12C6241DBDF5C65881B877D96358D4C273A9F3D8D02DEB84D0581B7EB28209680C6AD',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWV5yHLjMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDgy\nNzA1MDY0NFoXDTE4MDgyODA1MDgyNFowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQCjHpAiRXsF0FbJ/e21i8czuxuXwW7wJEjEUdfai9Fcab20YeL9\nJ1yWIGt3soNkXWvNcbKEp6wPFHfo1i7Kp2Kj+mdOI5V67RDXPY7Yg4rEGkf6+PtQ\nvLGzpXwkbX0YYaOIDHzP3utYJZxi9la9/dSr5glsiP+p7u89MiMLuG2P9MU0A4Jk\nBV64s5ctw3CTGgo4CRoSh7/0DS732SVw2GsYN/NaLqP3uW6ghwgmUByIxNwGOdpp\nrkGdmXVixGryD1DQlVQhPD7mmuVoXiRG3GKjCc0GVHLZvHrSciHQR9EsYkHb31xl\niBuHfZY1jUwnOp89jQLeuE0FgbfrKCCWgMatAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAEFyG39pFunA47uV9CJM5TWW40ixoytS\nWElW1LNPdQkcBcGKnLFOXk8NWRK1hI57Mf21ARU9eSKIv9GffevVArWIOhJJljzw\nEeAW0gbeXdTrKVSeW25k0BwuUwUvoYcWeA1ylXMIkW2C/PfuROSBC8iDqxvB1qPj\nHy6VecpZTKuLsnwQjG2wum/QiKvhu9Jj2XKAEjKpqh7IYBss9mXYhIydM3kCjU/0\n2X7ohkKhrArndMsrJz5XH4BUOBHjB9G1sA74l/srRdpvfu4uKWN9xc4tWOS2YOLJ\n7gwfrgISr0a0lUlki4N8XxwDx9i+P9efFgqsD8wYG4u3Wp+FxRzNM04=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200093
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57300
received auth hello!
{ authId: 502, nonce: <Buffer ed a8 97 58 d4 04 66 44> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 5f 4d 13 01 9b 43 15 c1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer ff 0c 62 7e 7e 83 52 c5 81 ea 11 b1 10 9e 46 14>,
  macKeyVal: <Buffer 29 e9 94 44 f9 7e f0 3c 83 ea fd 0f 50 2c 1f c3 8a 41 46 91 a9 a8 38 e1 c2 b8 88 07 db 6b b6 fd>,
  absValidity: 2018-08-27T06:21:52.044Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c1 5c 3f 3a bd 1b d1 82>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c1 5c 3f 3a bd 1b d1 82> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.67:39280',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200106
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57568
received auth hello!
{ authId: 502, nonce: <Buffer ff 39 07 3f 4e bc fb 98> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1e 22 67 e8 48 fc d7 98>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d6 ed 58 8b 3d 7c 8e 5b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d6 ed 58 8b 3d 7c 8e 5b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.67:39548',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200119
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57830
received auth hello!
{ authId: 502, nonce: <Buffer 09 0d dd 10 47 56 2e 11> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 19 37 99 15 aa 7a 72 91>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 74 ae eb 43 57 8f c2 c0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 74 ae eb 43 57 8f c2 c0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.67:39810',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200132
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58092
received auth hello!
{ authId: 502, nonce: <Buffer 3d ab 0a 54 58 d5 9c f0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 32 8f 91 56 84 6b 4e 2e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 05 3b 40 ae 90 5f 6b ad>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 05 3b 40 ae 90 5f 6b ad> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.67:40072',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200145
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58354
received auth hello!
{ authId: 502, nonce: <Buffer f5 e4 13 d9 33 14 17 3d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 10 36 d9 11 ca 16 c7 54>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 42 25 e8 d9 f8 2d 6d 7e>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 42 25 e8 d9 f8 2d 6d 7e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.67:40334',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200158
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58616
received auth hello!
{ authId: 502, nonce: <Buffer ef 61 2e 62 fd 4c 9a 34> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c6 e2 c7 ec f2 4a a9 dd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 50 d7 4e 83 37 a5 e9 ad>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 50 d7 4e 83 37 a5 e9 ad> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.67:40596',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200171
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58878
received auth hello!
{ authId: 502, nonce: <Buffer 02 cc 5b 4a b9 c1 37 51> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 43 f6 bc 29 7d 4e 9e d7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 16 85 61 b5 29 9a a1 aa>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 16 85 61 b5 29 9a a1 aa> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.67:40858',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200184
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59140
received auth hello!
{ authId: 502, nonce: <Buffer 40 7e c5 f4 f3 af b5 12> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e0 ac d0 8f 87 61 0e f2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 55 58 8d fa 64 17 b8 0f>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 55 58 8d fa 64 17 b8 0f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.67:41120',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200197
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59402
received auth hello!
{ authId: 502, nonce: <Buffer 95 0a 01 1a 9f f4 33 26> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 73 37 3d e4 0b 1b 37 8b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b7 23 6b 49 9f 9a 8d c3>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b7 23 6b 49 9f 9a 8d c3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.67:41382',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200210
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59668
received auth hello!
{ authId: 502, nonce: <Buffer 05 95 67 48 d3 a8 b9 6c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fa a0 ad 8f 6e e3 83 dc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a9 0f f8 20 8b 34 0c 6d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a9 0f f8 20 8b 34 0c 6d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.67:41648',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200223
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59934
received auth hello!
{ authId: 502, nonce: <Buffer 06 a9 67 5f 31 e8 b7 65> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a8 ce e7 94 55 32 6a 96>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 57 e6 a3 28 44 1c 60 3b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 57 e6 a3 28 44 1c 60 3b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.67:41914',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200236
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60200
received auth hello!
{ authId: 502, nonce: <Buffer 56 5c 6a fd 8f 11 20 cb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 74 d3 78 53 b6 49 55 f7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4a a8 96 26 0e f2 0d a6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4a a8 96 26 0e f2 0d a6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.67:42180',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200249
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60466
received auth hello!
{ authId: 502, nonce: <Buffer e3 29 ec 50 3b cd 39 d8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ba ba fe 9b 5f 6e d8 70>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7f 70 02 75 b5 b0 cf 81>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 7f 70 02 75 b5 b0 cf 81> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.67:42446',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200262
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60732
received auth hello!
{ authId: 502, nonce: <Buffer 71 4d 26 e5 00 fa 04 83> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer eb 05 d2 28 d9 cf 3e 50>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 04 ef f5 00 fd 22 cc a1>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 04 ef f5 00 fd 22 cc a1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.67:42712',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200275
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60998
received auth hello!
{ authId: 502, nonce: <Buffer f7 47 93 b8 7d ec 09 b2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 27 b8 7b d6 be 78 69 c0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 05 5b 53 7b a3 81 c2 21>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 05 5b 53 7b a3 81 c2 21> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.67:42978',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200288
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33032
received auth hello!
{ authId: 502, nonce: <Buffer e8 93 3b 8a bb fe 31 81> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 88 d4 e4 d9 22 42 93 47>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e1 8d 54 59 cb 42 fb 03>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e1 8d 54 59 cb 42 fb 03> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.67:43244',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200301
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33280
received auth hello!
{ authId: 502, nonce: <Buffer 75 14 74 66 a5 b1 c9 cd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e2 f9 e0 f5 d1 a4 d1 85>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b7 5d 29 71 f8 fd a1 de>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b7 5d 29 71 f8 fd a1 de> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.67:43492',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
