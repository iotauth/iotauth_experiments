changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s501.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's501',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 78 35 ... > }
Handler: listening on port 22100
s501:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100000
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57892
received auth hello!
{ authId: 501, nonce: <Buffer 72 c9 8b ab 5b a7 b2 7b> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 06 17 0d 88 b6 cf c1 7b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 47 9b 15 bf 49 f7 56 78 da 34 e7 89 91 0b d7 4c>,
  macKeyVal: <Buffer 5d 74 c2 23 b7 fb 88 59 5c 3c cd 7c 41 14 a3 49 19 3a 0d c8 5f 74 95 5d 76 bf 5b 2b fc c8 dc ec>,
  absValidity: 2018-08-27T06:10:33.988Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 76 cf a8 79 10 50 44 d1>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 76 cf a8 79 10 50 44 d1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.62:37286',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100008
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58122
received auth hello!
{ authId: 501, nonce: <Buffer fe 2c 4f 1a 70 6c 70 f1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6f f6 89 e0 84 5d 08 36>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9e 73 a8 68 14 34 70 c4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9e 73 a8 68 14 34 70 c4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.62:37514',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100016
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58392
received auth hello!
{ authId: 501, nonce: <Buffer 93 9a 7e 14 d7 72 93 74> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0a 18 12 f9 80 7b 5f 89>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer dc 8d ca 36 cf e3 f8 39>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer dc 8d ca 36 cf e3 f8 39> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.62:37784',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100024
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58662
received auth hello!
{ authId: 501, nonce: <Buffer 84 c2 12 28 e6 67 76 60> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d2 9a 3a b4 fe e1 81 84>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d9 eb 5e 93 3c b5 3a ab>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d9 eb 5e 93 3c b5 3a ab> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.62:38054',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100032
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58932
received auth hello!
{ authId: 501, nonce: <Buffer 45 25 4a 1c 3d 7a 69 cc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ff 30 11 7f a0 e1 fc e0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 34 a7 f1 35 af a8 ea 0b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 34 a7 f1 35 af a8 ea 0b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.62:38324',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100040
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59202
received auth hello!
{ authId: 501, nonce: <Buffer 38 3d 8a d3 4c 01 48 87> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d6 54 14 e8 94 ab c7 ff>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3a 35 25 25 24 c0 0d 3e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3a 35 25 25 24 c0 0d 3e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.62:38594',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100048
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59472
received auth hello!
{ authId: 501, nonce: <Buffer 17 e4 8f 22 5f cd 94 59> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 14 57 39 6f 67 65 0f 1e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d5 c2 a4 90 0e 51 e1 b0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d5 c2 a4 90 0e 51 e1 b0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.62:38864',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200063
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200076
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 54612
received auth hello!
{ authId: 502, nonce: <Buffer f4 a7 f0 e4 05 95 be 5c> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '016579C872E3',
  notBefore: 2018-08-27T05:06:44.000Z,
  notAfter: 2018-08-28T05:08:24.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '1C:7A:79:10:1B:B2:9A:9F:55:B3:BD:06:30:CC:41:43:1D:7F:B5:39',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'A31E9022457B05D056C9FDEDB58BC733BB1B97C16EF02448C451D7DA8BD15C69BDB461E2FD275C96206B77B283645D6BCD71B284A7AC0F1477E8D62ECAA762A3FA674E23957AED10D73D8ED8838AC41A47FAF8FB50BCB1B3A57C246D7D1861A3880C7CCFDEEB58259C62F656BDFDD4ABE6096C88FFA9EEEF3D32230BB86D8FF4C534038264055EB8B3972DC370931A0A38091A1287BFF40D2EF7D92570D86B1837F35A2EA3F7B96EA0870826501C88C4DC0639DA69AE419D997562C46AF20F50D09554213C3EE69AE5685E2446DC62A309CD065472D9BC7AD27221D047D12C6241DBDF5C65881B877D96358D4C273A9F3D8D02DEB84D0581B7EB28209680C6AD',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWV5yHLjMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDgy\nNzA1MDY0NFoXDTE4MDgyODA1MDgyNFowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQCjHpAiRXsF0FbJ/e21i8czuxuXwW7wJEjEUdfai9Fcab20YeL9\nJ1yWIGt3soNkXWvNcbKEp6wPFHfo1i7Kp2Kj+mdOI5V67RDXPY7Yg4rEGkf6+PtQ\nvLGzpXwkbX0YYaOIDHzP3utYJZxi9la9/dSr5glsiP+p7u89MiMLuG2P9MU0A4Jk\nBV64s5ctw3CTGgo4CRoSh7/0DS732SVw2GsYN/NaLqP3uW6ghwgmUByIxNwGOdpp\nrkGdmXVixGryD1DQlVQhPD7mmuVoXiRG3GKjCc0GVHLZvHrSciHQR9EsYkHb31xl\niBuHfZY1jUwnOp89jQLeuE0FgbfrKCCWgMatAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAEFyG39pFunA47uV9CJM5TWW40ixoytS\nWElW1LNPdQkcBcGKnLFOXk8NWRK1hI57Mf21ARU9eSKIv9GffevVArWIOhJJljzw\nEeAW0gbeXdTrKVSeW25k0BwuUwUvoYcWeA1ylXMIkW2C/PfuROSBC8iDqxvB1qPj\nHy6VecpZTKuLsnwQjG2wum/QiKvhu9Jj2XKAEjKpqh7IYBss9mXYhIydM3kCjU/0\n2X7ohkKhrArndMsrJz5XH4BUOBHjB9G1sA74l/srRdpvfu4uKWN9xc4tWOS2YOLJ\n7gwfrgISr0a0lUlki4N8XxwDx9i+P9efFgqsD8wYG4u3Wp+FxRzNM04=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200089
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54886
received auth hello!
{ authId: 502, nonce: <Buffer 37 e1 af 2d 15 21 f9 23> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 05 0b 34 dc 18 b6 0e 92>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 53 96 16 fa 07 a5 7b c1 c4 0c 37 c2 e2 60 7a 78>,
  macKeyVal: <Buffer 93 ed 0f 4d 72 7b 21 c0 87 32 93 72 83 03 3e 0d e5 6b 9b 7a 99 02 cf c7 7e a7 1d c9 e6 b2 5e e1>,
  absValidity: 2018-08-27T06:21:38.028Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c7 ab d1 10 fb 66 8b ce>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c7 ab d1 10 fb 66 8b ce> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.62:40112',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200102
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55148
received auth hello!
{ authId: 502, nonce: <Buffer 00 46 20 ab bd 9f 76 61> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 15 66 d6 7f e4 9e d7 4b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fe 84 c5 7a d8 37 51 ee>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fe 84 c5 7a d8 37 51 ee> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.62:40374',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200115
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55410
received auth hello!
{ authId: 502, nonce: <Buffer 3c 47 7d a5 eb 7d 93 ee> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9a 84 0d 63 c4 5a 7c b4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9f d2 23 eb ba 7a 1c 8c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9f d2 23 eb ba 7a 1c 8c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.62:40636',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200128
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55672
received auth hello!
{ authId: 502, nonce: <Buffer 68 ca 2d 63 ba 7f 2a e4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4f 1d 0b ff 5c da 2e 0b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 58 65 22 82 60 42 d2 a9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 58 65 22 82 60 42 d2 a9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.62:40898',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200141
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55934
received auth hello!
{ authId: 502, nonce: <Buffer c7 4a 0e 7e 55 04 c9 4e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c3 e7 dd c9 5c 61 7c 15>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9c 68 83 00 28 b7 68 fc>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 9c 68 83 00 28 b7 68 fc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.62:41160',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200154
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56196
received auth hello!
{ authId: 502, nonce: <Buffer 7d 5f 1a 97 2d 6b 06 c6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 37 f7 dc 35 99 19 bb d4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 10 cd 84 19 ad c3 12 9b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 10 cd 84 19 ad c3 12 9b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.62:41422',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200167
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56458
received auth hello!
{ authId: 502, nonce: <Buffer a1 2d 5a 90 f1 f4 44 e6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 24 4d b2 9c f2 aa 44 c2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c6 06 f8 92 88 bf c6 51>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c6 06 f8 92 88 bf c6 51> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.62:41684',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200180
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56720
received auth hello!
{ authId: 502, nonce: <Buffer 23 f3 93 3d bf f0 e2 57> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a9 34 92 c6 82 00 80 43>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c6 f9 7c d6 5f 03 6d e2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c6 f9 7c d6 5f 03 6d e2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.62:41946',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200193
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56982
received auth hello!
{ authId: 502, nonce: <Buffer e7 41 bb f9 49 4d d5 c9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4b fa 0a 05 48 e7 e6 79>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 88 ff 7e 7e 8f 20 be 7d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 88 ff 7e 7e 8f 20 be 7d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.62:42208',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200206
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57252
received auth hello!
{ authId: 502, nonce: <Buffer 20 cd a0 b0 b4 ea 3b 32> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 26 67 b8 c4 ce 31 57 c9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3c 0d 7d 43 39 72 0d 04>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3c 0d 7d 43 39 72 0d 04> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.62:42476',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200219
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57514
received auth hello!
{ authId: 502, nonce: <Buffer 98 04 87 d0 20 97 c9 fb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c5 e2 e1 c6 71 85 47 37>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 20 d9 84 eb 86 15 dd 39>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 20 d9 84 eb 86 15 dd 39> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.62:42740',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200232
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57780
received auth hello!
{ authId: 502, nonce: <Buffer de af b3 b2 a5 c5 79 13> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 99 51 e6 eb fd 9f 28 13>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a1 3a fb 75 fc 4d 7f b0>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer a1 3a fb 75 fc 4d 7f b0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.62:43006',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200245
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58046
received auth hello!
{ authId: 502, nonce: <Buffer a6 9e 8e 75 3e 64 31 e2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 18 7c 47 02 12 ef 81 83>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bf b7 d6 14 65 99 6a a5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bf b7 d6 14 65 99 6a a5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.62:43272',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200258
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58312
received auth hello!
{ authId: 502, nonce: <Buffer a2 b3 76 19 aa 52 6d 0d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2c 89 33 1b f4 3c 78 e5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ec 72 94 a9 8b 25 b7 eb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ec 72 94 a9 8b 25 b7 eb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.62:43538',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200271
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58578
received auth hello!
{ authId: 502, nonce: <Buffer a2 92 48 89 08 92 ce 8d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a9 8c 7e 0a 0e 72 6e a0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 09 e9 9e 36 77 d0 70 28>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 09 e9 9e 36 77 d0 70 28> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.62:43804',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200284
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58844
received auth hello!
{ authId: 502, nonce: <Buffer 13 af 66 35 5f 9b ef aa> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 41 ea a8 95 57 3f b0 b2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ed fa ee 29 eb ad f9 0a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ed fa ee 29 eb ad f9 0a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.62:44070',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200297
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59100
received auth hello!
{ authId: 502, nonce: <Buffer 7f 33 d0 33 59 4f 14 67> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer de 3e 4f b3 1e 95 3c 7f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8c bb 28 1e de ca d1 80>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 8c bb 28 1e de ca d1 80> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.62:44326',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
