changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s404.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's404',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 71 49 ... > }
Handler: listening on port 22100
s404:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100005
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43542
received auth hello!
{ authId: 401, nonce: <Buffer 91 7a 58 87 82 2a 86 76> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 51 7e bd e2 da 4c b5 33>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 2f 5d 6a a3 14 00 39 a4 96 e6 85 61 a7 13 51 ec>,
  macKeyVal: <Buffer 7b db 0a e9 da a7 c1 46 84 a9 87 2c 1f 0d 9b c2 4d 25 ff 66 8d cc 1e a6 99 52 a9 39 84 89 6f 3d>,
  absValidity: 2018-08-27T06:09:48.819Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3b 24 51 bf 1e bf 82 1d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3b 24 51 bf 1e bf 82 1d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.48:40698',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100011
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43686
received auth hello!
{ authId: 401, nonce: <Buffer 6d 88 31 50 ba fe 42 25> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ff 03 44 21 64 51 cf 2c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7d a1 fa 1b db 7d 68 10>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 7d a1 fa 1b db 7d 68 10> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.48:40842',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100017
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43940
received auth hello!
{ authId: 401, nonce: <Buffer 0c 1f 52 7d 77 d5 56 1b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5a 94 e5 46 ec 98 73 59>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 51 12 5e f6 f5 8e 38 e0>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 51 12 5e f6 f5 8e 38 e0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.48:41096',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100023
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44210
received auth hello!
{ authId: 401, nonce: <Buffer d6 fe 28 dc 73 41 29 de> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 56 c3 4c 67 21 bf d4 a5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 02 fa 3e 56 ef 17 1d 52>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 02 fa 3e 56 ef 17 1d 52> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.48:41366',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100029
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44480
received auth hello!
{ authId: 401, nonce: <Buffer b4 c2 6c c0 f1 05 90 56> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 76 0e 92 e7 02 cf a1 00>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 32 af 87 28 79 51 e5 b7>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 32 af 87 28 79 51 e5 b7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.48:41636',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100035
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44750
received auth hello!
{ authId: 401, nonce: <Buffer 52 f5 21 d4 73 89 24 99> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 39 62 d0 7f 8a 4f c8 b8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 44 c6 87 0f c3 f8 59 82>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 44 c6 87 0f c3 f8 59 82> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.48:41906',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100041
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45020
received auth hello!
{ authId: 401, nonce: <Buffer 18 dc 1f e4 ff 76 5b f4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c6 12 7c 41 02 4e 4c 67>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 69 33 f5 ee bb c4 48 02>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 69 33 f5 ee bb c4 48 02> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.48:42176',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100047
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45290
received auth hello!
{ authId: 401, nonce: <Buffer 11 1c 45 52 ee b2 1d a4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a1 ef a1 71 23 01 70 7c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer df e0 d0 83 c1 2f 0e 02>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer df e0 d0 83 c1 2f 0e 02> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.48:42446',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100053
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45532
received auth hello!
{ authId: 401, nonce: <Buffer 43 71 dc e6 a7 ea b0 2d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 69 0c 1a 3b e9 f5 6c 9f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 31 67 c8 fe 51 ef bd 0e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 31 67 c8 fe 51 ef bd 0e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.48:42688',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100059
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45726
received auth hello!
{ authId: 401, nonce: <Buffer 12 d4 29 3e 2c 3b 97 d3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2d 69 48 9c 35 b8 bc e6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 71 5d 75 d7 35 d6 b1 a4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 71 5d 75 d7 35 d6 b1 a4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.48:42882',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100065
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45972
received auth hello!
{ authId: 401, nonce: <Buffer 5e d1 9b 6f 2b fb 57 e4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b5 6c 71 aa 20 12 a5 30>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5d 56 5c 92 95 2e e2 71>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5d 56 5c 92 95 2e e2 71> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.48:43128',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100075
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46258
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: Disconnected from auth before getting session key response
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100088
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46582
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100096
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46808
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100107
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47070
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100119
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47350
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100130
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47612
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100143
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47896
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100152
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48136
received auth hello!
{ authId: 401, nonce: <Buffer e1 06 ef 8e 9a 81 7c c7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 25 b5 26 67 e4 59 f4 b4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2c 4e c0 5e f1 1a 63 bc>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 2c 4e c0 5e f1 1a 63 bc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.48:45292',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100174
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48662
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100186
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48930
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100197
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49174
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100209
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49440
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100221
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49706
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100233
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49972
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100245
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50238
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
