changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c407.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c407',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 51 49 42 41 41 4b 43 41 51 45 41 34 33 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1535344138713
connected to auth! from local port 39504
received auth hello!
{ authId: 402, nonce: <Buffer e6 dc f0 23 92 92 e9 cf> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer ed 60 a9 7c b0 ce f1 77>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 96 fc 85 24 a5 7f 9d b2 f7 da a9 d5 6f 2c 84 c9>,
  macKeyVal: <Buffer 89 af d2 3d 68 9d 2e 6e 53 7b e2 c5 be b6 1e 30 09 fe d9 39 20 0c e7 f1 82 4a ae 12 66 6c 98 5f>,
  absValidity: 2018-08-27T05:28:58.882Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200055,
  cipherKeyVal: <Buffer 8c bf 98 a0 0a 0b 07 ce 98 7e 1e 0a 25 63 19 a1>,
  macKeyVal: <Buffer 6b 90 e9 57 3a d4 fb cb 04 9f b9 3f 71 72 dc 9d 53 62 d6 00 c3 94 af 60 c9 8e 31 d1 bc aa e2 5e>,
  absValidity: 2018-08-28T04:28:58.880Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200055,
     cipherKeyVal: <Buffer 8c bf 98 a0 0a 0b 07 ce 98 7e 1e 0a 25 63 19 a1>,
     macKeyVal: <Buffer 6b 90 e9 57 3a d4 fb cb 04 9f b9 3f 71 72 dc 9d 53 62 d6 00 c3 94 af 60 c9 8e 31 d1 bc aa e2 5e>,
     absValidity: 2018-08-28T04:28:58.880Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer f1 25 89 86 68 f3 5a c6>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 04:28:59 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1535344139861
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1535344198773
connected to auth! from local port 39654
received auth hello!
{ authId: 402, nonce: <Buffer ce 2e 2b 5a a9 07 11 b8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 78 77 75 66 9f b1 31 65>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200062,
  cipherKeyVal: <Buffer 21 eb fc 31 e6 16 bd 62 aa d0 fa 93 c0 ed 43 cb>,
  macKeyVal: <Buffer 5c 87 a0 3b f2 74 42 a1 97 da 5b 08 8f cd 30 5a 53 4b 67 b4 e5 05 95 22 36 59 0f 31 24 0b de b5>,
  absValidity: 2018-08-28T04:29:58.938Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200062,
     cipherKeyVal: <Buffer 21 eb fc 31 e6 16 bd 62 aa d0 fa 93 c0 ed 43 cb>,
     macKeyVal: <Buffer 5c 87 a0 3b f2 74 42 a1 97 da 5b 08 8f cd 30 5a 53 4b 67 b4 e5 05 95 22 36 59 0f 31 24 0b de b5>,
     absValidity: 2018-08-28T04:29:58.938Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 5d bf c3 63 02 5c 7d e6>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 04:29:59 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1535344199873
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1535344258832
connected to auth! from local port 39908
received auth hello!
{ authId: 402, nonce: <Buffer dc fb c0 73 bc f7 f4 39> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b4 8c bf 2b 44 73 b6 86>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200069,
  cipherKeyVal: <Buffer 09 1e f2 77 e1 92 8a 4a f9 16 f3 a7 bf d4 7e 28>,
  macKeyVal: <Buffer 7f 8b 75 72 ad 0a e2 40 02 6a 64 b3 a3 28 97 0b 39 73 48 d0 cc 3c 02 ca ac 52 06 37 49 d5 5c 12>,
  absValidity: 2018-08-28T04:30:59.075Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200069,
     cipherKeyVal: <Buffer 09 1e f2 77 e1 92 8a 4a f9 16 f3 a7 bf d4 7e 28>,
     macKeyVal: <Buffer 7f 8b 75 72 ad 0a e2 40 02 6a 64 b3 a3 28 97 0b 39 73 48 d0 cc 3c 02 ca ac 52 06 37 49 d5 5c 12>,
     absValidity: 2018-08-28T04:30:59.075Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer db aa 72 95 31 f2 4e 7b>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 04:30:59 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1535344260160
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1535344318891
connected to auth! from local port 40178
received auth hello!
{ authId: 402, nonce: <Buffer 01 c2 41 b6 4c 62 c7 32> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ff 21 72 14 b4 cf 34 66>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200076,
  cipherKeyVal: <Buffer 1a 03 c4 44 5c 4a df 8c cd 72 2c 30 99 a5 b5 28>,
  macKeyVal: <Buffer 63 63 c6 55 1a db 55 69 ac 8b 93 ec ff 13 eb b5 85 58 a3 71 29 ff 6e bd 2c b5 ac b4 1e c6 10 b5>,
  absValidity: 2018-08-28T04:31:59.140Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200076,
     cipherKeyVal: <Buffer 1a 03 c4 44 5c 4a df 8c cd 72 2c 30 99 a5 b5 28>,
     macKeyVal: <Buffer 63 63 c6 55 1a db 55 69 ac 8b 93 ec ff 13 eb b5 85 58 a3 71 29 ff 6e bd 2c b5 ac b4 1e c6 10 b5>,
     absValidity: 2018-08-28T04:31:59.140Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 48 bd 10 42 54 2d 81 b1>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 04:31:59 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1535344320166
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1535344378950
connected to auth! from local port 40448
received auth hello!
{ authId: 402, nonce: <Buffer 00 0c 22 e6 9e 23 e6 80> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 82 60 ee f1 4c 50 01 b5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200083,
  cipherKeyVal: <Buffer 34 7d f1 b9 29 2e 15 4c d4 bc b0 bc 91 be b0 d8>,
  macKeyVal: <Buffer 72 d4 cf 9e c9 32 2a 78 e7 68 4f 0b b9 db e9 6e 4b 31 7c 12 8d cd 1b 1e bb b6 82 ea 36 98 ba 51>,
  absValidity: 2018-08-28T04:32:59.147Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200083,
     cipherKeyVal: <Buffer 34 7d f1 b9 29 2e 15 4c d4 bc b0 bc 91 be b0 d8>,
     macKeyVal: <Buffer 72 d4 cf 9e c9 32 2a 78 e7 68 4f 0b b9 db e9 6e 4b 31 7c 12 8d cd 1b 1e bb b6 82 ea 36 98 ba 51>,
     absValidity: 2018-08-28T04:32:59.147Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer bb d5 3b 9e d7 c2 46 4e>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 04:32:59 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1535344380176
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1535344439008
connected to auth! from local port 40718
received auth hello!
{ authId: 402, nonce: <Buffer f3 d4 95 d0 25 1b 1d 94> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6b 08 c4 61 a5 29 2b 21>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200090,
  cipherKeyVal: <Buffer 40 c6 dd 31 e7 86 6f fc b7 a9 d2 3b cf 47 4c f9>,
  macKeyVal: <Buffer 2e 41 d5 d0 7c 8b 6a 03 0f 0a 59 5b 9b 78 c6 f2 c6 62 2c 12 d4 78 48 80 67 76 b4 1f da 23 be 12>,
  absValidity: 2018-08-28T04:33:59.220Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200090,
     cipherKeyVal: <Buffer 40 c6 dd 31 e7 86 6f fc b7 a9 d2 3b cf 47 4c f9>,
     macKeyVal: <Buffer 2e 41 d5 d0 7c 8b 6a 03 0f 0a 59 5b 9b 78 c6 f2 c6 62 2c 12 d4 78 48 80 67 76 b4 1f da 23 be 12>,
     absValidity: 2018-08-28T04:33:59.220Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 05 00 0f 10 13 60 7a 00>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 04:33:59 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1535344440438
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1535344499064
connected to auth! from local port 40988
received auth hello!
{ authId: 402, nonce: <Buffer 13 65 f5 3b 4b 63 99 57> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 12 28 fe cd f7 f7 78 d0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200097,
  cipherKeyVal: <Buffer cf 72 3b 7d 47 0b 9e a6 31 b6 2a c1 3a 4a 0a f0>,
  macKeyVal: <Buffer 3d c0 25 02 78 e8 8f ed ad 73 62 b5 b7 92 c9 3d 67 73 40 d2 f3 97 1b f3 f9 57 3f c5 06 d8 9a 2f>,
  absValidity: 2018-08-28T04:34:59.305Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200097,
     cipherKeyVal: <Buffer cf 72 3b 7d 47 0b 9e a6 31 b6 2a c1 3a 4a 0a f0>,
     macKeyVal: <Buffer 3d c0 25 02 78 e8 8f ed ad 73 62 b5 b7 92 c9 3d 67 73 40 d2 f3 97 1b f3 f9 57 3f c5 06 d8 9a 2f>,
     absValidity: 2018-08-28T04:34:59.305Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer b7 0d 71 90 3e 56 8b 42>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 04:34:59 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1535344500315
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1535344559077
connected to auth! from local port 41258
received auth hello!
{ authId: 402, nonce: <Buffer 08 6e 77 ac 83 58 62 99> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 24 af 3a 26 48 78 e0 73>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200104,
  cipherKeyVal: <Buffer ce 8b b7 f9 bf c4 f5 9b df 5e 18 42 27 a5 62 02>,
  macKeyVal: <Buffer 57 0f bc f6 22 67 1f 95 0f 70 a4 d1 b5 b4 68 0c ae 79 0e 1f 1c d9 8c 6f b0 93 ae 38 e3 25 07 aa>,
  absValidity: 2018-08-28T04:35:59.277Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200104,
     cipherKeyVal: <Buffer ce 8b b7 f9 bf c4 f5 9b df 5e 18 42 27 a5 62 02>,
     macKeyVal: <Buffer 57 0f bc f6 22 67 1f 95 0f 70 a4 d1 b5 b4 68 0c ae 79 0e 1f 1c d9 8c 6f b0 93 ae 38 e3 25 07 aa>,
     absValidity: 2018-08-28T04:35:59.277Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 9e 65 74 e9 c8 ae d3 c4>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 04:36:00 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 8 1 1535344560450
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 9 0.8888888888888888 1535344619136
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 10 0.8 1535344679144
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 40910
received auth hello!
{ authId: 502, nonce: <Buffer e1 1c 1c 45 d1 b2 82 f5> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 11 0.7272727272727273 1535344739154
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 41138
received auth hello!
{ authId: 502, nonce: <Buffer 74 d0 ec 8c fb c6 2e f9> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 12 0.6666666666666666 1535344799164
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 13 0.6153846153846154 1535344859169
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 57376
received auth hello!
{ authId: 401, nonce: <Buffer 11 f1 61 17 68 ce e0 3c> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth401',
     commonName: '10.0.1.1' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth402',
     commonName: '10.0.0.2' },
  serial: '016579A30508',
  notBefore: 2018-08-27T04:25:51.000Z,
  notAfter: 2018-08-28T04:27:31.000Z,
  subjectHash: 'de555cae',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '79:D7:F0:36:F5:63:C9:5F:2F:6C:10:F7:B5:4C:7F:0A:36:A9:97:CE',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'AF23BC17C526A7AFDABD10E11B69948936F06BDEC216730D0926F4729C3F53806C2812687248D00BE365D1DB11907B8C3441F9A9A7F0B913065F79BBEFB9605DD128C9B144B177076B7E46B92A3FA31511995B3D57F9BFA275EBEDA464AF403971A8925028BF43CC548AC9052D7E35AD851586AC0C4EA1FC7C755E22CB819A087D35C0E9C0DF733E9757F060E6AF797111A2B852A6191E6341A7CF678D8604077227A06289ADD8492928D5EECC3787C220575D0F755645359EFE007ECCC7BBCE9132761D1346C2B4F372E3F9A44DF760E0EDCCAC935454D03E6F2A22C1BFC15A4ABCAA38B7AB27FC12DF6127B9A5258B4BD00B1E6D28F03EEDEDAE39ABC5924F',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.1' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 401,
  host: '10.0.1.1',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWV5owUIMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDIxETAPBgNVBAMMCDEwLjAuMC4yMB4XDTE4MDgy\nNzA0MjU1MVoXDTE4MDgyODA0MjczMVowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDQwMTERMA8GA1UEAwwIMTAuMC4xLjEwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQCvI7wXxSanr9q9EOEbaZSJNvBr3sIWcw0JJvRynD9TgGwoEmhy\nSNAL42XR2xGQe4w0Qfmpp/C5EwZfebvvuWBd0SjJsUSxdwdrfka5Kj+jFRGZWz1X\n+b+idevtpGSvQDlxqJJQKL9DzFSKyQUtfjWthRWGrAxOofx8dV4iy4GaCH01wOnA\n33M+l1fwYOaveXERorhSphkeY0Gnz2eNhgQHciegYomt2EkpKNXuzDeHwiBXXQ91\nVkU1nv4AfszHu86RMnYdE0bCtPNy4/mkTfdg4O3MrJNUVNA+byoiwb/BWkq8qji3\nqyf8Et9hJ7mlJYtL0AsebSjwPu3trjmrxZJPAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQEwDQYJKoZIhvcNAQELBQADggEBAD1utwYa5+xnllujS5dNOdoosfgaJAEl\nlQNGOFbYHbYFwyjppfapHpodKI5w+ThXBhVDDp9ZfzMzSptRpO7i+b7t1fmocUdT\nTbBXZ+QdPnEFUVnDK3Nqko/Bitsroyfrh83XfNGni4hsWihfR1LTbasb6Z+oEpKT\n+SVOCbrulTjuzGTWwLh6gcomgh9RYgy3/6qh3sRadHEn9nhWqgBo+i64otcKtozN\nzFswSGMIe2L76I+gi2JSLAR5DQ1sIGTsh46EnbiViYCjcWCpNc2vpyC1uHBgwIBF\ns+8FN/dpf9fOzPqIS1BXjV2w/BSYhWnMpKEIjglpASpBjWVarQoxIes=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 2
to: 3
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 14 0.5714285714285714 1535344919179
connected to auth! from local port 57608
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 15 0.5333333333333333 1535344979189
connected to auth! from local port 57866
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 16 0.5 1535345039199
connected to auth! from local port 58116
received auth hello!
{ authId: 401, nonce: <Buffer a7 ae 6b c9 f2 3d 9b 16> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer a3 26 61 23 f9 70 b3 97>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 10 a3 43 e3 21 b1 b0 80 8c 2a 99 14 61 f5 87 7c>,
  macKeyVal: <Buffer ea 55 a1 57 60 f8 04 6f 82 91 65 1d 90 97 17 46 66 a6 34 23 54 ec 6e 7a 5d f5 68 22 9f ec d3 b4>,
  absValidity: 2018-08-27T05:44:08.771Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100400,
  cipherKeyVal: <Buffer d3 2d 0d a4 5f 1e 42 56 57 2b 6a 71 62 a3 a2 a4>,
  macKeyVal: <Buffer 80 ac b3 5a 39 14 9f 27 48 71 60 b4 6d 8d b6 94 88 97 3d 65 71 a5 b0 7e 6d 14 4e d1 19 3d b9 89>,
  absValidity: 2018-08-28T04:44:08.771Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40100400,
     cipherKeyVal: <Buffer d3 2d 0d a4 5f 1e 42 56 57 2b 6a 71 62 a3 a2 a4>,
     macKeyVal: <Buffer 80 ac b3 5a 39 14 9f 27 48 71 60 b4 6d 8d b6 94 88 97 3d 65 71 a5 b0 7e 6d 14 4e d1 19 3d b9 89>,
     absValidity: 2018-08-28T04:44:08.771Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 89 38 31 38 05 68 4f d8>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 17 0.47058823529411764 1535345099199
connected to auth! from local port 58384
received auth hello!
{ authId: 401, nonce: <Buffer 6b d7 ad 82 bc 30 30 45> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 77 14 9d 7d 2d 1a e6 13>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100408,
  cipherKeyVal: <Buffer a9 8b 3d 20 b6 11 d5 98 21 7e 8b 91 49 64 89 23>,
  macKeyVal: <Buffer 03 1d 8f eb 53 7e 7c 99 3f d4 78 61 23 34 fa 82 f0 4f bb c1 ad bc 81 cd b9 c4 28 aa 2a b7 bd f1>,
  absValidity: 2018-08-28T04:45:03.031Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40100408,
     cipherKeyVal: <Buffer a9 8b 3d 20 b6 11 d5 98 21 7e 8b 91 49 64 89 23>,
     macKeyVal: <Buffer 03 1d 8f eb 53 7e 7c 99 3f d4 78 61 23 34 fa 82 f0 4f bb c1 ad bc 81 cd b9 c4 28 aa 2a b7 bd f1>,
     absValidity: 2018-08-28T04:45:03.031Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer aa 74 65 10 48 98 7b 5f>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 18 0.4444444444444444 1535345159205
connected to auth! from local port 58654
Handler: Error in secure comm - details: Disconnected from auth before getting session key response
Handler: Error in secure comm - details: Disconnected from auth before getting session key response
received auth hello!
{ authId: 401, nonce: <Buffer d4 1b df 74 08 ad 19 58> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6e 39 b4 59 ea a4 67 d2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100424,
  cipherKeyVal: <Buffer 21 00 e5 bd b8 45 23 4e f4 7a e0 0c 2b 2a c2 b9>,
  macKeyVal: <Buffer 86 89 39 bd 98 9a 94 1a 5e 54 9f 5e df 6d dd af b2 7a bc 86 5b 25 09 3e 75 6f 0f 5e 3b 98 4c d6>,
  absValidity: 2018-08-28T04:46:08.668Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40100424,
     cipherKeyVal: <Buffer 21 00 e5 bd b8 45 23 4e f4 7a e0 0c 2b 2a c2 b9>,
     macKeyVal: <Buffer 86 89 39 bd 98 9a 94 1a 5e 54 9f 5e df 6d dd af b2 7a bc 86 5b 25 09 3e 75 6f 0f 5e 3b 98 4c d6>,
     absValidity: 2018-08-28T04:46:08.668Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 91 5b b2 34 46 1f 5a 07>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 19 0.42105263157894735 1535345219206
connected to auth! from local port 58890
received auth hello!
{ authId: 401, nonce: <Buffer bb 3a c0 82 6c 8b 7c 62> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1a 7c 29 39 4a fc bc b7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100434,
  cipherKeyVal: <Buffer ce ba 80 e7 6b eb a9 44 e9 77 b7 df 89 cd b9 7e>,
  macKeyVal: <Buffer 24 e5 ed 54 52 af b4 51 24 46 dd f0 77 dc 9a e7 18 c9 1d ee a1 15 9a 1c e1 72 91 cf 62 be b3 dc>,
  absValidity: 2018-08-28T04:47:02.851Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40100434,
     cipherKeyVal: <Buffer ce ba 80 e7 6b eb a9 44 e9 77 b7 df 89 cd b9 7e>,
     macKeyVal: <Buffer 24 e5 ed 54 52 af b4 51 24 46 dd f0 77 dc 9a e7 18 c9 1d ee a1 15 9a 1c e1 72 91 cf 62 be b3 dc>,
     absValidity: 2018-08-28T04:47:02.851Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer f0 b1 97 4c f7 7a 08 e9>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 20 0.4 1535345279212
connected to auth! from local port 59092
received auth hello!
{ authId: 401, nonce: <Buffer ce 2a ee a9 82 8f e6 f2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d4 df 41 84 e3 40 cd a5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100445,
  cipherKeyVal: <Buffer bc be be 8c 32 16 8f 89 38 57 27 ef e1 29 ce 6f>,
  macKeyVal: <Buffer 46 4a 02 93 2c fb 93 72 c9 fd d8 02 bd 3a 1e f9 ba c1 4a 21 dc 8c fd f3 9e b5 2e 6b 80 96 b7 72>,
  absValidity: 2018-08-28T04:48:02.907Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40100445,
     cipherKeyVal: <Buffer bc be be 8c 32 16 8f 89 38 57 27 ef e1 29 ce 6f>,
     macKeyVal: <Buffer 46 4a 02 93 2c fb 93 72 c9 fd d8 02 bd 3a 1e f9 ba c1 4a 21 dc 8c fd f3 9e b5 2e 6b 80 96 b7 72>,
     absValidity: 2018-08-28T04:48:02.907Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 01 d0 01 bd 2d 5b 03 dd>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 21 0.38095238095238093 1535345339220
connected to auth! from local port 59296
received auth hello!
{ authId: 401, nonce: <Buffer 76 d2 62 e7 8e c7 ee c3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 39 8b 96 bf e2 6b 46 38>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100456,
  cipherKeyVal: <Buffer 8a e6 b3 69 ea ec 46 68 a5 1f 53 b7 4e c6 41 f8>,
  macKeyVal: <Buffer 19 27 b6 4c d7 7e 2b bc 9a 40 cd a7 f8 11 35 cc c9 e8 bc 93 92 3b 4d 55 66 f4 89 38 fc 3f e4 cb>,
  absValidity: 2018-08-28T04:49:03.960Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40100456,
     cipherKeyVal: <Buffer 8a e6 b3 69 ea ec 46 68 a5 1f 53 b7 4e c6 41 f8>,
     macKeyVal: <Buffer 19 27 b6 4c d7 7e 2b bc 9a 40 cd a7 f8 11 35 cc c9 e8 bc 93 92 3b 4d 55 66 f4 89 38 fc 3f e4 cb>,
     absValidity: 2018-08-28T04:49:03.960Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 3a bf e0 fe bc 85 2f 13>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 22 0.36363636363636365 1535345399225
connected to auth! from local port 59500
received auth hello!
{ authId: 401, nonce: <Buffer a5 63 a8 87 6d d3 aa e5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c1 88 34 60 3e 1f 9b 90>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100467,
  cipherKeyVal: <Buffer e6 c9 02 2f 98 b7 e2 f6 34 19 44 a1 1b ef ae ee>,
  macKeyVal: <Buffer 70 54 92 94 81 13 f7 56 51 02 a9 23 9a 94 64 45 5e 76 ea 6c f2 3e 2c e0 b4 80 ba 6e dc 5a 3a c2>,
  absValidity: 2018-08-28T04:50:03.050Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40100467,
     cipherKeyVal: <Buffer e6 c9 02 2f 98 b7 e2 f6 34 19 44 a1 1b ef ae ee>,
     macKeyVal: <Buffer 70 54 92 94 81 13 f7 56 51 02 a9 23 9a 94 64 45 5e 76 ea 6c f2 3e 2c e0 b4 80 ba 6e dc 5a 3a c2>,
     absValidity: 2018-08-28T04:50:03.050Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.12:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 23 0.34782608695652173 1535345459261
connected to auth! from local port 59700
received auth hello!
{ authId: 401, nonce: <Buffer df fd 7a e3 9d 8e 8e eb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 25 0f c8 ee 2b 6f c9 44>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100478,
  cipherKeyVal: <Buffer 15 b9 91 59 77 be bf 91 c5 0e da 7c b9 ee 43 a1>,
  macKeyVal: <Buffer 97 fe 38 88 73 54 ff 80 a8 dc e7 ff 20 9e 8e 2a a5 9c fb f9 ed 3e 7a 22 c2 6e 17 04 ff 3e 94 f4>,
  absValidity: 2018-08-28T04:51:03.073Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40100478,
     cipherKeyVal: <Buffer 15 b9 91 59 77 be bf 91 c5 0e da 7c b9 ee 43 a1>,
     macKeyVal: <Buffer 97 fe 38 88 73 54 ff 80 a8 dc e7 ff 20 9e 8e 2a a5 9c fb f9 ed 3e 7a 22 c2 6e 17 04 ff 3e 94 f4>,
     absValidity: 2018-08-28T04:51:03.073Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.12:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 24 0.3333333333333333 1535345519317
connected to auth! from local port 59900
received auth hello!
{ authId: 401, nonce: <Buffer e9 4a 57 18 36 ed cd 28> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b9 fe 17 c1 f5 0e d0 80>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100489,
  cipherKeyVal: <Buffer 23 bc 7b d0 61 de 91 6c 48 32 78 2e 18 d8 61 86>,
  macKeyVal: <Buffer 32 dd ba 10 51 58 a4 f4 e6 83 13 7d 6d 0c 87 dd 4a 1c e8 d2 b9 fc 9c 70 c8 57 2f eb f9 1c ce 5f>,
  absValidity: 2018-08-28T04:52:04.113Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40100489,
     cipherKeyVal: <Buffer 23 bc 7b d0 61 de 91 6c 48 32 78 2e 18 d8 61 86>,
     macKeyVal: <Buffer 32 dd ba 10 51 58 a4 f4 e6 83 13 7d 6d 0c 87 dd 4a 1c e8 d2 b9 fc 9c 70 c8 57 2f eb f9 1c ce 5f>,
     absValidity: 2018-08-28T04:52:04.113Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.12:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 25 0.32 1535345579373
connected to auth! from local port 60100
received auth hello!
{ authId: 401, nonce: <Buffer 9d 07 bb a0 26 79 4c 25> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e7 41 a4 fa c8 31 9a 3f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100500,
  cipherKeyVal: <Buffer 3d 15 c2 14 5a af 4f 3f b5 8a d7 2c 4e a1 4e 7d>,
  macKeyVal: <Buffer 0b a0 29 c3 3b 5c 26 2b 1a b6 48 4b 82 6e 39 c7 68 47 84 a3 4a bc 89 93 89 bb ea 48 c8 e1 fb dc>,
  absValidity: 2018-08-28T04:53:03.129Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40100500,
     cipherKeyVal: <Buffer 3d 15 c2 14 5a af 4f 3f b5 8a d7 2c 4e a1 4e 7d>,
     macKeyVal: <Buffer 0b a0 29 c3 3b 5c 26 2b 1a b6 48 4b 82 6e 39 c7 68 47 84 a3 4a bc 89 93 89 bb ea 48 c8 e1 fb dc>,
     absValidity: 2018-08-28T04:53:03.129Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.12:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 26 0.3076923076923077 1535345639429
connected to auth! from local port 60300
received auth hello!
{ authId: 401, nonce: <Buffer 89 a2 56 bc cb 78 8b 84> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0c 4e c6 6b 14 b2 5d 32>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100511,
  cipherKeyVal: <Buffer aa e8 7e fd c4 47 73 e7 7d 0a e7 2f be 95 82 64>,
  macKeyVal: <Buffer 26 45 36 ae 2c 0c 3a 61 9f c9 da 77 1e 69 22 28 64 c2 61 e3 b8 ff 3b 8e f6 d3 8c 85 7d fc 0a 37>,
  absValidity: 2018-08-28T04:54:03.214Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40100511,
     cipherKeyVal: <Buffer aa e8 7e fd c4 47 73 e7 7d 0a e7 2f be 95 82 64>,
     macKeyVal: <Buffer 26 45 36 ae 2c 0c 3a 61 9f c9 da 77 1e 69 22 28 64 c2 61 e3 b8 ff 3b 8e f6 d3 8c 85 7d fc 0a 37>,
     absValidity: 2018-08-28T04:54:03.214Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.12:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 27 0.2962962962962963 1535345699486
connected to auth! from local port 60502
received auth hello!
{ authId: 401, nonce: <Buffer 80 1c 9f e3 41 26 e8 5e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a6 d5 b0 97 c7 63 21 ec>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100522,
  cipherKeyVal: <Buffer d6 83 00 c2 64 5a 1f 7f 72 1f ed 61 21 e1 95 c5>,
  macKeyVal: <Buffer 8f 57 f0 fa 65 e0 b7 08 9b 79 22 e8 6d 75 27 b4 73 c9 1d 30 42 fb 1e a7 08 2d 5c f6 71 9a ac d0>,
  absValidity: 2018-08-28T04:55:02.773Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40100522,
     cipherKeyVal: <Buffer d6 83 00 c2 64 5a 1f 7f 72 1f ed 61 21 e1 95 c5>,
     macKeyVal: <Buffer 8f 57 f0 fa 65 e0 b7 08 9b 79 22 e8 6d 75 27 b4 73 c9 1d 30 42 fb 1e a7 08 2d 5c f6 71 9a ac d0>,
     absValidity: 2018-08-28T04:55:02.773Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.12:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 28 0.2857142857142857 1535345759543
connected to auth! from local port 60702
received auth hello!
{ authId: 401, nonce: <Buffer 3d 4d ae f6 2c 62 3d 1c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2c c8 31 08 2f bf 68 6b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100533,
  cipherKeyVal: <Buffer 9d b9 b4 27 81 b4 00 0f 10 0e 2b 73 32 23 be 6f>,
  macKeyVal: <Buffer 1e 36 9b 88 14 7b a3 76 61 a1 de eb 1f bc 7c ff 14 98 9f b3 cb 31 27 6e 38 de 3c 2d 2a 4f 23 aa>,
  absValidity: 2018-08-28T04:56:04.207Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40100533,
     cipherKeyVal: <Buffer 9d b9 b4 27 81 b4 00 0f 10 0e 2b 73 32 23 be 6f>,
     macKeyVal: <Buffer 1e 36 9b 88 14 7b a3 76 61 a1 de eb 1f bc 7c ff 14 98 9f b3 cb 31 27 6e 38 de 3c 2d 2a 4f 23 aa>,
     absValidity: 2018-08-28T04:56:04.207Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.12:22100
disconnected from auth
