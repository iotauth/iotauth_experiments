changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c508.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c508',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 71 41 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1535344204248
connected to auth! from local port 59766
received auth hello!
{ authId: 501, nonce: <Buffer 8a 35 86 f1 50 f9 4e 33> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer f2 4f 4c d7 9d 83 eb 72>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer ce 28 b7 59 b6 6d 1d 4c 0a 99 87 39 e6 bc 28 4b>,
  macKeyVal: <Buffer 73 eb 31 2d 2b 63 0a f4 c5 9c 34 03 43 43 cf 0c 70 e1 6e d3 cb d1 7a 2c 4f 21 75 05 e8 ae cd 1e>,
  absValidity: 2018-08-27T05:30:04.422Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100061,
  cipherKeyVal: <Buffer 7f b1 d3 b7 85 59 46 21 05 89 29 cc 13 0e 95 30>,
  macKeyVal: <Buffer f6 0d 33 d6 a4 27 c8 c3 05 0a 0e b6 7b 8d f3 c6 a2 db 2f 10 6b 5b 1a 02 5e 3d a7 28 ba ff 71 d2>,
  absValidity: 2018-08-28T04:30:04.421Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100061,
     cipherKeyVal: <Buffer 7f b1 d3 b7 85 59 46 21 05 89 29 cc 13 0e 95 30>,
     macKeyVal: <Buffer f6 0d 33 d6 a4 27 c8 c3 05 0a 0e b6 7b 8d f3 c6 a2 db 2f 10 6b 5b 1a 02 5e 3d a7 28 ba ff 71 d2>,
     absValidity: 2018-08-28T04:30:04.421Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 4c 46 af ef 71 4a 66 94>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 04:30:05 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1535344205374
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1535344264304
connected to auth! from local port 60030
received auth hello!
{ authId: 501, nonce: <Buffer f8 ba 8a bc ee dd e0 0c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6a 24 65 f2 71 10 66 37>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100069,
  cipherKeyVal: <Buffer b2 9e 26 f5 97 32 23 c4 a4 26 93 f2 3c 26 34 34>,
  macKeyVal: <Buffer 79 97 39 09 f6 e8 ea 9f da 0f 87 f0 e3 50 fc f4 88 dd 95 58 f3 16 d7 1a 69 11 cb ee 9f fa 02 a2>,
  absValidity: 2018-08-28T04:31:04.516Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100069,
     cipherKeyVal: <Buffer b2 9e 26 f5 97 32 23 c4 a4 26 93 f2 3c 26 34 34>,
     macKeyVal: <Buffer 79 97 39 09 f6 e8 ea 9f da 0f 87 f0 e3 50 fc f4 88 dd 95 58 f3 16 d7 1a 69 11 cb ee 9f fa 02 a2>,
     absValidity: 2018-08-28T04:31:04.516Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 82 a2 35 70 d3 d2 66 36>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 04:31:05 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1535344265756
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1535344324364
connected to auth! from local port 60300
received auth hello!
{ authId: 501, nonce: <Buffer 3a 8b 84 8b 62 fc 06 55> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9c b7 25 ea 5f bd 25 02>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100077,
  cipherKeyVal: <Buffer fb 18 fc 03 ed 05 d7 d0 fe 62 7a 40 0a 20 38 ed>,
  macKeyVal: <Buffer 80 60 78 b7 a8 e9 80 84 61 27 78 8c e8 1f 30 ba 0f 61 0c 76 42 d5 53 45 29 1d f2 35 fc e8 15 11>,
  absValidity: 2018-08-28T04:32:04.596Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100077,
     cipherKeyVal: <Buffer fb 18 fc 03 ed 05 d7 d0 fe 62 7a 40 0a 20 38 ed>,
     macKeyVal: <Buffer 80 60 78 b7 a8 e9 80 84 61 27 78 8c e8 1f 30 ba 0f 61 0c 76 42 d5 53 45 29 1d f2 35 fc e8 15 11>,
     absValidity: 2018-08-28T04:32:04.596Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 89 30 d7 f6 24 f2 64 dc>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 04:32:05 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1535344325827
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1535344384423
connected to auth! from local port 60570
received auth hello!
{ authId: 501, nonce: <Buffer ef 9f c4 33 6c 5d 25 89> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 56 33 1e 91 29 1a 58 ef>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100085,
  cipherKeyVal: <Buffer f5 1f 28 e2 db 47 64 f3 ba 3a 84 9d 85 aa 7f 8d>,
  macKeyVal: <Buffer 2b 77 0b 32 d4 4c 21 f5 99 38 3e 5d b8 71 a8 95 43 df 48 8d 8d 8e 58 c1 99 57 72 4b 5a 54 f5 d9>,
  absValidity: 2018-08-28T04:33:04.670Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100085,
     cipherKeyVal: <Buffer f5 1f 28 e2 db 47 64 f3 ba 3a 84 9d 85 aa 7f 8d>,
     macKeyVal: <Buffer 2b 77 0b 32 d4 4c 21 f5 99 38 3e 5d b8 71 a8 95 43 df 48 8d 8d 8e 58 c1 99 57 72 4b 5a 54 f5 d9>,
     absValidity: 2018-08-28T04:33:04.670Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer d1 46 16 63 b9 bf 64 14>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 04:33:05 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1535344385738
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1535344444480
connected to auth! from local port 60840
received auth hello!
{ authId: 501, nonce: <Buffer 3e 71 02 bd 65 80 75 ff> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer be 88 a3 b3 20 b6 17 36>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100093,
  cipherKeyVal: <Buffer 8b a1 c4 87 b7 2d 60 7f 8c 8c 1b 70 38 73 95 fb>,
  macKeyVal: <Buffer d5 ab 4d c5 15 9f 21 a3 47 a2 45 95 68 95 54 62 fe f7 bc 1f ca db 80 5c 05 f4 59 f9 95 87 05 ab>,
  absValidity: 2018-08-28T04:34:04.731Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100093,
     cipherKeyVal: <Buffer 8b a1 c4 87 b7 2d 60 7f 8c 8c 1b 70 38 73 95 fb>,
     macKeyVal: <Buffer d5 ab 4d c5 15 9f 21 a3 47 a2 45 95 68 95 54 62 fe f7 bc 1f ca db 80 5c 05 f4 59 f9 95 87 05 ab>,
     absValidity: 2018-08-28T04:34:04.731Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 3e fa 88 97 c5 d6 23 67>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 04:34:05 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1535344445811
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1535344504536
connected to auth! from local port 32880
received auth hello!
{ authId: 501, nonce: <Buffer fd c8 d8 ed 5e a5 5c 65> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 54 4d 05 63 76 8c 94 97>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100101,
  cipherKeyVal: <Buffer 27 6f 55 1d b2 cf 52 4c 1c 3e 2a 1c 3d df 85 7a>,
  macKeyVal: <Buffer 89 3a 15 d9 3b 99 54 02 9e 0d bf ab a2 29 c0 ae b7 54 70 d8 f4 04 0d 82 d5 eb d3 6c a4 d5 45 f7>,
  absValidity: 2018-08-28T04:35:04.755Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100101,
     cipherKeyVal: <Buffer 27 6f 55 1d b2 cf 52 4c 1c 3e 2a 1c 3d df 85 7a>,
     macKeyVal: <Buffer 89 3a 15 d9 3b 99 54 02 9e 0d bf ab a2 29 c0 ae b7 54 70 d8 f4 04 0d 82 d5 eb d3 6c a4 d5 45 f7>,
     absValidity: 2018-08-28T04:35:04.755Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer ae af fd c8 74 13 ef 0e>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 04:35:05 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1535344505859
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1535344564595
connected to auth! from local port 33148
received auth hello!
{ authId: 501, nonce: <Buffer 94 a7 cb 2d 3d f1 35 1a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fb 62 0f 68 e8 7a 1b 7e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100109,
  cipherKeyVal: <Buffer 8e a2 b0 48 2c 1b 0a 10 1c c5 70 d1 b6 cd 96 8b>,
  macKeyVal: <Buffer 0d e2 aa 7c 45 0a 0e 8b 0d 72 1b 08 7d 2e f1 b8 a4 67 b2 cd be 30 06 9f 1a 46 85 f5 21 51 cc bf>,
  absValidity: 2018-08-28T04:36:04.851Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100109,
     cipherKeyVal: <Buffer 8e a2 b0 48 2c 1b 0a 10 1c c5 70 d1 b6 cd 96 8b>,
     macKeyVal: <Buffer 0d e2 aa 7c 45 0a 0e 8b 0d 72 1b 08 7d 2e f1 b8 a4 67 b2 cd be 30 06 9f 1a 46 85 f5 21 51 cc bf>,
     absValidity: 2018-08-28T04:36:04.851Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer a2 74 cb 47 b1 1b 06 be>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 04:36:05 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1535344566066
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1535344624599
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 9 0.7777777777777778 1535344684609
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 50474
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 10 0.7 1535344744616
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 50702
received auth hello!
{ authId: 401, nonce: <Buffer 71 71 f9 bc 3a 6b 96 1f> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 11 0.6363636363636364 1535344804626
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 12 0.5833333333333334 1535344864627
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 51728
received auth hello!
{ authId: 502, nonce: <Buffer 3a 30 01 2a 15 b7 fc 3b> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '016579A30A2F',
  notBefore: 2018-08-27T04:25:52.000Z,
  notAfter: 2018-08-28T04:27:32.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '33:51:DA:47:DD:99:6A:B3:5B:22:4E:07:B8:2F:40:3E:8A:A1:DF:0E',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'B138D36BE53FEF7A4EAFB969AC06E51234F04819636E9BD1C18A274EF509C20F60425ECB70D73DBE38728E4C8AE5C9A51F6B212017E83DB7265ADE4EB91743FF00E6384C91216C08E24F877D4756852A1A006533657C2AD970B6694EAA6074DD788860A9BBCCF0D830F5A7FED589C63785576A172E75E8EA5C2AFC1B8563D3B27BB7450A9659E288F607AA1643255BB6082A7AF57221C9DB5DDE2AFA6C5D86E13162450B4905BD4511BE1D82F1A3D32974AE25E6317777B2B45BA251A2511FFC8EF6FAE19E1CFC5BEEC19ADFE72E99C553F36401DCCA304F5C309892EE68C67986CBBFB67CEC5666ADDA8CD6487848CF2EDC5C68B7924C91D54BBEC322B2C309',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWV5owovMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDgy\nNzA0MjU1MloXDTE4MDgyODA0MjczMlowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQCxONNr5T/vek6vuWmsBuUSNPBIGWNum9HBiidO9QnCD2BCXstw\n1z2+OHKOTIrlyaUfayEgF+g9tyZa3k65F0P/AOY4TJEhbAjiT4d9R1aFKhoAZTNl\nfCrZcLZpTqpgdN14iGCpu8zw2DD1p/7VicY3hVdqFy516OpcKvwbhWPTsnu3RQqW\nWeKI9geqFkMlW7YIKnr1ciHJ213eKvpsXYbhMWJFC0kFvUURvh2C8aPTKXSuJeYx\nd3eytFuiUaJRH/yO9vrhnhz8W+7Bmt/nLpnFU/NkAdzKME9cMJiS7mjGeYbLv7Z8\n7FZmrdqM1kh4SM8u3Fxot5JMkdVLvsMissMJAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAG/nd26Nl8Rqyu/kvPaeeYPxmlno08ZD\nTxk0bODd0lbipQ79XMiN30hKPS3S0tP3KIIGxk7s4TSsYpskvSKU1RPCNgs7f0X/\nCSd0zcLiFlepnnaEEoNCSPhK1CyfRLu4fGxxx7+PLSLiuZkts65JOJRp9fgcdZ4Y\nwr5q7I/RDBHTlYPOdl2BCoDpe4tYwHg6FP6yzy06yf31WsTQXOJTP1rEccTBNjB2\nJI8MC1+Oy7+xxggC3lFV7M0/ESgJI+6L1bVacW7yToijbB9Gk8YTi3xnTQTYZBAo\nj0Zxc/94PXCTDu8aChhb5ZtyWwffMjbSSbU24BefKgeDneU5ZS1CuyY=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 2
to: 3
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 13 0.5384615384615384 1535344924637
connected to auth! from local port 51968
received auth hello!
{ authId: 502, nonce: <Buffer c1 01 43 e1 9c 8d 38 d0> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer e6 8d 06 2e cc 44 2e 57>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 01 c5 cb b8 4f 83 9b 71 9a b6 3b a0 e6 67 53 0f>,
  macKeyVal: <Buffer 15 07 b1 59 52 8c d2 38 27 01 15 f8 9a e5 bf b3 41 fe be d0 43 eb 15 e7 c6 76 69 a8 66 35 10 ca>,
  absValidity: 2018-08-27T05:42:04.789Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200411,
  cipherKeyVal: <Buffer 50 e8 9b 1f 45 60 61 cb 2d 5a 5f ac 82 00 dc fe>,
  macKeyVal: <Buffer e3 0f 71 c0 bc 63 72 5a f0 d5 f8 bd 82 3c bc 07 bc 91 e6 1f 5c f5 40 cb 58 29 51 f5 e9 85 95 22>,
  absValidity: 2018-08-28T04:42:04.789Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200411,
     cipherKeyVal: <Buffer 50 e8 9b 1f 45 60 61 cb 2d 5a 5f ac 82 00 dc fe>,
     macKeyVal: <Buffer e3 0f 71 c0 bc 63 72 5a f0 d5 f8 bd 82 3c bc 07 bc 91 e6 1f 5c f5 40 cb 58 29 51 f5 e9 85 95 22>,
     absValidity: 2018-08-28T04:42:04.789Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 26 b3 b0 e6 1b f2 80 3e>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.28:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 14 0.5 1535344984647
connected to auth! from local port 52228
received auth hello!
{ authId: 502, nonce: <Buffer 55 57 c2 af 0c 4f 07 6e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 16 7a 75 27 2e 6d c9 41>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200426,
  cipherKeyVal: <Buffer 49 0a e2 b3 7c 78 84 a9 6c 18 ff 23 4d 21 38 44>,
  macKeyVal: <Buffer ff eb f8 3f 7c 21 1e 40 2f 0d 87 47 b9 88 3b 30 a0 2f 0e 5b be c3 a0 b0 70 99 63 1e 46 0b a0 44>,
  absValidity: 2018-08-28T04:43:04.801Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200426,
     cipherKeyVal: <Buffer 49 0a e2 b3 7c 78 84 a9 6c 18 ff 23 4d 21 38 44>,
     macKeyVal: <Buffer ff eb f8 3f 7c 21 1e 40 2f 0d 87 47 b9 88 3b 30 a0 2f 0e 5b be c3 a0 b0 70 99 63 1e 46 0b a0 44>,
     absValidity: 2018-08-28T04:43:04.801Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 5f 98 55 b6 8e f8 5a 00>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.28:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 15 0.4666666666666667 1535345044657
connected to auth! from local port 52478
received auth hello!
{ authId: 502, nonce: <Buffer a3 31 10 15 cf 94 15 5a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 67 68 e1 31 ce eb d0 1b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200441,
  cipherKeyVal: <Buffer 84 86 8e 09 94 97 ba d5 29 f8 f6 41 c4 ce a7 90>,
  macKeyVal: <Buffer 79 f9 6e 0f 30 f8 b4 3e cf c2 c9 85 9c 60 dd d4 ae 99 de d2 c6 43 4e c0 e9 d7 ac 68 f5 bb ca d7>,
  absValidity: 2018-08-28T04:44:04.780Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200441,
     cipherKeyVal: <Buffer 84 86 8e 09 94 97 ba d5 29 f8 f6 41 c4 ce a7 90>,
     macKeyVal: <Buffer 79 f9 6e 0f 30 f8 b4 3e cf c2 c9 85 9c 60 dd d4 ae 99 de d2 c6 43 4e c0 e9 d7 ac 68 f5 bb ca d7>,
     absValidity: 2018-08-28T04:44:04.780Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 1f e5 f8 26 0e 98 d1 f3>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.28:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 16 0.4375 1535345104667
connected to auth! from local port 52748
received auth hello!
{ authId: 502, nonce: <Buffer b3 3a 88 a3 52 4a 99 a4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1b c7 33 12 16 b6 f2 11>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200456,
  cipherKeyVal: <Buffer 3e 15 55 60 44 44 a1 c9 e7 3b ef 12 97 f8 b3 61>,
  macKeyVal: <Buffer db b7 f2 6d ff aa 8a df 28 64 79 67 2a 0c 41 8c 1b bb ac 46 eb dc 00 4a 1c 61 d2 f2 2a 37 80 5f>,
  absValidity: 2018-08-28T04:45:04.833Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200456,
     cipherKeyVal: <Buffer 3e 15 55 60 44 44 a1 c9 e7 3b ef 12 97 f8 b3 61>,
     macKeyVal: <Buffer db b7 f2 6d ff aa 8a df 28 64 79 67 2a 0c 41 8c 1b bb ac 46 eb dc 00 4a 1c 61 d2 f2 2a 37 80 5f>,
     absValidity: 2018-08-28T04:45:04.833Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 45 7b 9d 9f 1d 77 cf 40>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.28:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 17 0.4117647058823529 1535345164677
connected to auth! from local port 53020
/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902
            eventHandlers.onError('Error occurred in migration request: Disconnected from auth before getting migration response: ' + error);
                                                                                                                                      ^

ReferenceError: error is not defined
    at Socket.<anonymous> (/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902:135)
    at emitNone (events.js:91:20)
    at Socket.emit (events.js:188:7)
    at endReadableNT (_stream_readable.js:975:12)
    at _combinedTickCallback (internal/process/next_tick.js:80:11)
    at process._tickCallback (internal/process/next_tick.js:104:9)
