changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s408.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's408',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 75 54 ... > }
Handler: listening on port 22100
s408:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200058
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34736
received auth hello!
{ authId: 402, nonce: <Buffer c5 e8 70 9e 85 30 91 56> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 42 c9 0c f1 89 5f 56 54>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 33 6b 77 b8 c4 1e e4 59 f2 a2 3e 4a 17 91 5b 7b>,
  macKeyVal: <Buffer 21 08 b7 4a 2a c9 dc 07 fa 99 bc ed 55 e9 06 ca 9d 28 c1 92 55 33 0a 6e c4 3e 5b 9b fa d3 4a b0>,
  absValidity: 2018-08-27T05:29:09.833Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1b a4 cc 4d 12 bf a0 1f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1b a4 cc 4d 12 bf a0 1f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.52:51872',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200060
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34748
received auth hello!
{ authId: 402, nonce: <Buffer d1 25 ff 07 9f 19 22 8e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer db 7a 2b 75 7b 6e 0f 01>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 81 74 73 8a 8c 5d e0 cd>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 81 74 73 8a 8c 5d e0 cd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.54:56704',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200065
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34904
received auth hello!
{ authId: 402, nonce: <Buffer e0 eb da 4d 94 32 fe ad> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 10 e7 0b f2 77 95 60 fd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 29 06 be 72 1b d8 46 7d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 29 06 be 72 1b d8 46 7d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.52:52040',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200067
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34928
received auth hello!
{ authId: 402, nonce: <Buffer fd 2a 67 3e 06 49 32 43> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 11 e0 32 cc e7 4b 26 76>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d0 67 15 40 20 b1 a0 ea>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer d0 67 15 40 20 b1 a0 ea> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.54:56884',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200072
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35174
received auth hello!
{ authId: 402, nonce: <Buffer 18 58 1f 40 68 da 39 fa> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5b 49 6a 48 03 36 d3 db>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 94 2f 64 7e 57 5b 0a 62>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 94 2f 64 7e 57 5b 0a 62> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.52:52310',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200074
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35198
received auth hello!
{ authId: 402, nonce: <Buffer 76 c2 59 88 02 d5 cb a8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9b 5b fb 5d de 03 30 a5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 53 a9 9d 41 1d a3 d2 9d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 53 a9 9d 41 1d a3 d2 9d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.54:57154',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200079
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35444
received auth hello!
{ authId: 402, nonce: <Buffer 09 84 04 ed 44 56 6f 39> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a7 ea 3c 3e 9c 4e 2c fc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c9 29 3a 1d b2 eb 0d 72>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c9 29 3a 1d b2 eb 0d 72> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.52:52580',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200081
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35468
received auth hello!
{ authId: 402, nonce: <Buffer 4c 4c a5 74 c7 bc 8b 5b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ce 6b 7a 47 e4 96 50 20>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3b 95 76 19 0d 20 d4 e2>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 3b 95 76 19 0d 20 d4 e2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.54:57424',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200086
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35714
received auth hello!
{ authId: 402, nonce: <Buffer 34 14 f5 c0 e2 8d 81 32> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fa cf 9f 65 95 66 aa e9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 22 d5 7d 1b af a2 50 44>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 22 d5 7d 1b af a2 50 44> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.52:52850',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200088
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35738
received auth hello!
{ authId: 402, nonce: <Buffer 6a 5a 61 0f af 2b d2 77> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 78 03 64 ed be 57 76 13>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 78 53 0b b2 75 99 e6 b9>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 78 53 0b b2 75 99 e6 b9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.54:57694',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200093
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35984
received auth hello!
{ authId: 402, nonce: <Buffer 66 60 b8 b2 84 9d 14 e4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 38 05 a5 63 59 d3 e9 d0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c8 7a e1 4f 2b 0a 79 16>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c8 7a e1 4f 2b 0a 79 16> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.52:53120',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200095
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36008
received auth hello!
{ authId: 402, nonce: <Buffer cf b9 51 d5 6a b9 80 35> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ad cc 6f c5 65 c2 3f 07>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8a 36 8e ab 46 fa cc 3d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 8a 36 8e ab 46 fa cc 3d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.54:57964',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200100
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36254
received auth hello!
{ authId: 402, nonce: <Buffer ae 39 1e 24 8a 51 13 c4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 01 6b 14 43 33 a3 1c c3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 87 de 26 bf 7b a8 82 fa>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 87 de 26 bf 7b a8 82 fa> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.52:53390',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200102
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36278
received auth hello!
{ authId: 402, nonce: <Buffer 86 9f 95 62 fb 6f 34 e2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 22 5d aa f2 44 32 1d cc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8e 37 62 05 d2 84 96 31>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8e 37 62 05 d2 84 96 31> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.54:58234',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200107
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36520
received auth hello!
{ authId: 402, nonce: <Buffer 4f ba d7 72 03 be 60 4e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9f 7d d3 16 72 6d eb e5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 34 af 8f 3b 38 c1 10 40>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 34 af 8f 3b 38 c1 10 40> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.52:53656',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200109
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36544
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
