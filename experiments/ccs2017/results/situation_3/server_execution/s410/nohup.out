changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s410.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's410',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 67 49 42 41 41 4b 43 41 51 45 41 38 4e ... > }
Handler: listening on port 22100
s410:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200059
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52416
received auth hello!
{ authId: 402, nonce: <Buffer ba f0 02 9a 30 04 ed e5> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 78 3e 57 e9 7a 0d 9e 65>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 42 f6 74 4a 4e 59 0c 3d b8 77 c6 3d c3 39 3b ce>,
  macKeyVal: <Buffer 69 ef 2e 24 60 e3 39 b6 ce 9b 2e a4 8e d9 45 1f 8d 42 1c e9 a8 85 e9 71 29 a2 e6 1a 10 cb 32 98>,
  absValidity: 2018-08-27T05:29:13.834Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8a 16 74 41 2c 0b 60 a4>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 8a 16 74 41 2c 0b 60 a4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.53:43844',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200066
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52590
received auth hello!
{ authId: 402, nonce: <Buffer f8 2a d9 42 08 7b de 7a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1d 3d ff ae f4 11 a0 71>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c9 35 ff 8a a4 46 a0 94>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c9 35 ff 8a a4 46 a0 94> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.53:44018',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200073
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52860
received auth hello!
{ authId: 402, nonce: <Buffer f1 8e 43 c4 9e b2 b2 4c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 85 0a 0c 02 d7 0a c0 8a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a1 34 76 5a 53 32 dd 90>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer a1 34 76 5a 53 32 dd 90> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.53:44288',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200080
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53130
received auth hello!
{ authId: 402, nonce: <Buffer a9 26 1d b9 d5 60 43 32> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 52 a7 1e f3 8e 3c 0b 61>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1a 30 11 96 60 74 08 7b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 1a 30 11 96 60 74 08 7b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.53:44558',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200087
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53400
received auth hello!
{ authId: 402, nonce: <Buffer d6 0f 7b 20 74 0c 76 7c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 36 5d c3 4f 03 50 06 1e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1a e8 e3 f5 63 72 e3 ed>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1a e8 e3 f5 63 72 e3 ed> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.53:44828',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200094
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53670
received auth hello!
{ authId: 402, nonce: <Buffer 35 77 6e b1 57 be 19 e0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 10 d4 d1 3a b9 75 4c 3d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e9 ed 96 c1 b9 e4 9d 8f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e9 ed 96 c1 b9 e4 9d 8f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.53:45098',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200101
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53940
received auth hello!
{ authId: 402, nonce: <Buffer b6 8c ad a6 48 68 58 23> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a0 73 95 1a 19 11 65 16>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ae be 8a 78 00 f1 0a db>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ae be 8a 78 00 f1 0a db> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.53:45368',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200108
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54206
received auth hello!
{ authId: 402, nonce: <Buffer ef a9 4d 98 63 8f 64 9b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2f ae d6 50 28 a3 1e 97>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 31 56 5a 40 05 20 bd a1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 31 56 5a 40 05 20 bd a1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.53:45634',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
