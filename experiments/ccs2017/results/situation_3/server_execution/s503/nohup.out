changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s503.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's503',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 51 49 42 41 41 4b 43 41 51 45 41 73 32 ... > }
Handler: listening on port 22100
s503:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100058
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39458
received auth hello!
{ authId: 504, nonce: <Buffer 9e 8a d1 11 99 1c 09 d3> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer f1 02 4e ee 23 b5 b1 4d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 22 7c 73 3b e4 70 0a 61 97 e0 fc 9b 66 d9 0d 1b>,
  macKeyVal: <Buffer aa 58 d7 fa bc c2 8d c7 da 12 6e 54 49 80 6d 03 cc 41 b8 f7 2e 9c dd a8 c6 c2 5d 9c 12 93 75 50>,
  absValidity: 2018-08-27T05:29:48.244Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 34 0a aa 04 76 03 dc 2b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 34 0a aa 04 76 03 dc 2b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.64:41406',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400038
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39470
received auth hello!
{ authId: 504, nonce: <Buffer 54 6e 2d 72 99 52 ac 99> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d3 db 81 76 89 59 05 6c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 12 61 a0 ef 89 81 25 dd>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 12 61 a0 ef 89 81 25 dd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.65:51364',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400039
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39482
received auth hello!
{ authId: 504, nonce: <Buffer 96 fb af 21 8d 03 00 89> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7f 21 2f b8 3a 6d ec e7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a6 f6 ac ee fd bd 83 75>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a6 f6 ac ee fd bd 83 75> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.66:36332',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100066
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39698
received auth hello!
{ authId: 504, nonce: <Buffer 0d db 31 40 41 85 0e 77> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1b ef 14 0b 56 46 fd dd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 09 87 1d 46 e0 69 3f f1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 09 87 1d 46 e0 69 3f f1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.64:41644',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400040
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39716
received auth hello!
{ authId: 504, nonce: <Buffer 36 ed 44 73 32 67 56 36> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ea c4 64 0b 83 d0 0e 0b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer da 4e 42 fb 23 b5 e2 bc>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer da 4e 42 fb 23 b5 e2 bc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.65:51608',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400042
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39734
received auth hello!
{ authId: 504, nonce: <Buffer e5 59 ac de 85 3a 96 ac> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a4 76 1a 13 c5 2a bd fe>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 20 14 3b ce 49 ea a2 c0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 20 14 3b ce 49 ea a2 c0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.66:36582',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100074
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39968
received auth hello!
{ authId: 504, nonce: <Buffer 41 71 50 e9 d5 fb 38 25> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f1 ce 52 19 e2 e5 62 d8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 13 52 23 72 dc ea 76 8f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 13 52 23 72 dc ea 76 8f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.64:41914',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400046
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39986
received auth hello!
{ authId: 504, nonce: <Buffer 18 43 85 9a d4 61 33 20> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3c a1 ae 6f 3c ee b3 6f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 37 b3 c0 80 b7 69 66 93>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 37 b3 c0 80 b7 69 66 93> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.65:51878',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400048
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40004
received auth hello!
{ authId: 504, nonce: <Buffer 4a a7 55 50 b6 c1 b5 41> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d8 02 e1 c4 8e 8c a3 47>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e1 1d 1f 6c cb dc 59 b2>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e1 1d 1f 6c cb dc 59 b2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.66:36854',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100082
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40238
received auth hello!
{ authId: 504, nonce: <Buffer ba 45 00 94 22 47 13 6a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d9 66 dd 68 80 34 66 7f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 72 d5 d3 1c 9f 39 8c dc>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 72 d5 d3 1c 9f 39 8c dc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.64:42184',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400052
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40256
received auth hello!
{ authId: 504, nonce: <Buffer 1d c9 d9 a8 eb 5a 27 3f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f5 25 68 5d 41 29 31 d1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer da 8e 62 a9 6f 5e bd 78>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer da 8e 62 a9 6f 5e bd 78> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.65:52150',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400054
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40274
received auth hello!
{ authId: 504, nonce: <Buffer c7 2b bc e8 ec f5 23 18> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 96 33 a4 dc 8f cb 4a 07>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 17 7c 30 9e 33 42 96 20>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 17 7c 30 9e 33 42 96 20> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.66:37122',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100090
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40508
received auth hello!
{ authId: 504, nonce: <Buffer 0f e5 77 48 b7 bb 01 38> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9d 58 22 78 78 3f da 9e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 75 47 19 63 3e a8 d8 d4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 75 47 19 63 3e a8 d8 d4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.64:42454',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400058
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40526
received auth hello!
{ authId: 504, nonce: <Buffer a8 d0 e8 de 0e 03 a5 46> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 05 83 88 c1 13 d0 9d 94>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 42 a7 d1 5b 9b 7c 99 56>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 42 a7 d1 5b 9b 7c 99 56> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.65:52420',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400060
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40544
received auth hello!
{ authId: 504, nonce: <Buffer 16 bd e4 d9 f8 f0 8b 28> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f6 bf ed 8e 22 dd 88 1b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8e 0e 9c de 08 50 dc 82>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8e 0e 9c de 08 50 dc 82> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.66:37394',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100098
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40778
received auth hello!
{ authId: 504, nonce: <Buffer 2b 84 31 d7 fd 9c 63 10> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c1 61 a5 6c 83 42 13 a2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 44 ed 43 7e 02 9e 3e f0>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 44 ed 43 7e 02 9e 3e f0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.64:42724',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400064
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40796
received auth hello!
{ authId: 504, nonce: <Buffer 9e 78 49 c1 be 7d e8 f7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 55 30 8c f5 97 f4 e4 a1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 78 dc a7 e1 03 47 5f 30>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 78 dc a7 e1 03 47 5f 30> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.65:52688',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400066
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40814
received auth hello!
{ authId: 504, nonce: <Buffer 8a 88 8b 4a ca ca 35 43> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 67 8d 3e e0 a0 52 c5 51>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cd 63 d1 75 88 a6 a1 12>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer cd 63 d1 75 88 a6 a1 12> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.66:37664',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100106
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41048
received auth hello!
{ authId: 504, nonce: <Buffer 5c 56 54 4c d5 00 b7 bb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 40 97 6e 26 15 8c 44 8b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ea 77 07 b6 e1 a7 8c a8>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ea 77 07 b6 e1 a7 8c a8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.64:42994',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400070
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41066
received auth hello!
{ authId: 504, nonce: <Buffer 09 91 79 8f 65 30 52 32> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 52 44 67 dc 5b 15 4f f9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 72 f9 8e 58 8a 44 e8 03>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 72 f9 8e 58 8a 44 e8 03> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.65:52960',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400072
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41084
received auth hello!
{ authId: 504, nonce: <Buffer ac 7e 3f 98 91 13 b1 33> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 11 fa 9e ae ca ca ff 0a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d7 49 66 31 f3 56 8b b1>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer d7 49 66 31 f3 56 8b b1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.66:37932',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100355
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100356
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
Handler: Error in server - details: handshake2 timed out...
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 44258
Handler: Error in server - details: handshake2 timed out...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100361
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 44432
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 401, nonce: <Buffer 6b a2 88 e9 89 ec fe f4> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth401',
     commonName: '10.0.1.1' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth504',
     commonName: '10.0.0.7' },
  serial: '016579A30E8D',
  notBefore: 2018-08-27T04:25:53.000Z,
  notAfter: 2018-08-28T04:27:33.000Z,
  subjectHash: 'de555cae',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '95:9F:B8:B1:71:C6:F1:7D:30:83:CD:20:64:5F:4E:DF:FC:DF:4D:A7',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'AF23BC17C526A7AFDABD10E11B69948936F06BDEC216730D0926F4729C3F53806C2812687248D00BE365D1DB11907B8C3441F9A9A7F0B913065F79BBEFB9605DD128C9B144B177076B7E46B92A3FA31511995B3D57F9BFA275EBEDA464AF403971A8925028BF43CC548AC9052D7E35AD851586AC0C4EA1FC7C755E22CB819A087D35C0E9C0DF733E9757F060E6AF797111A2B852A6191E6341A7CF678D8604077227A06289ADD8492928D5EECC3787C220575D0F755645359EFE007ECCC7BBCE9132761D1346C2B4F372E3F9A44DF760E0EDCCAC935454D03E6F2A22C1BFC15A4ABCAA38B7AB27FC12DF6127B9A5258B4BD00B1E6D28F03EEDEDAE39ABC5924F',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.1' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 401,
  host: '10.0.1.1',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWV5ow6NMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDQxETAPBgNVBAMMCDEwLjAuMC43MB4XDTE4MDgy\nNzA0MjU1M1oXDTE4MDgyODA0MjczM1owYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDQwMTERMA8GA1UEAwwIMTAuMC4xLjEwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQCvI7wXxSanr9q9EOEbaZSJNvBr3sIWcw0JJvRynD9TgGwoEmhy\nSNAL42XR2xGQe4w0Qfmpp/C5EwZfebvvuWBd0SjJsUSxdwdrfka5Kj+jFRGZWz1X\n+b+idevtpGSvQDlxqJJQKL9DzFSKyQUtfjWthRWGrAxOofx8dV4iy4GaCH01wOnA\n33M+l1fwYOaveXERorhSphkeY0Gnz2eNhgQHciegYomt2EkpKNXuzDeHwiBXXQ91\nVkU1nv4AfszHu86RMnYdE0bCtPNy4/mkTfdg4O3MrJNUVNA+byoiwb/BWkq8qji3\nqyf8Et9hJ7mlJYtL0AsebSjwPu3trjmrxZJPAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQEwDQYJKoZIhvcNAQELBQADggEBAD7NuP53E379MJE3u//hNNLGLLJjVCgN\ngdaWbyKpGFDdjJczm9dS78SU9aFjeBKxYXAaqv5talDV5abaHoG6ICBcGLP5TzUF\niBaiNjON769Z3bic55YLPeAT1RvkI4Ok5V8AY0npl8r2717NVOJgHtNQTZrJkYcU\njHgHSwt/58nGOzjx3e5EQPziDb6i+xCExGje6pASoST7rrk0Qmh2+1pxfM6efNAI\nIPU2NXuPD7MeLRopB0ycw2lixC9Ova2UoGxKRjbg9QjR17/ICjbToF89Vd25r2Wa\nA85C6/XjE2BHViwL3XW9vEaoyLoRZZr+5eO9jBE/yFkFQgasYb5atp0=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100364
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44458
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in server - details: Error occurred in migration request: Auth hello timedout ...
received auth hello!
{ authId: 401, nonce: <Buffer ae be c7 f8 0a f5 c2 2e> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 2c 7f 8e cd 5f d8 0f d3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 48 96 30 55 bb cc 80 36 ed d2 29 cb 04 ed 45 6f>,
  macKeyVal: <Buffer a5 f9 62 d5 7f b3 fe ce 82 46 71 57 49 c0 dd cd e9 71 99 88 07 aa 70 52 b7 56 91 cd 3d e2 2a 88>,
  absValidity: 2018-08-27T05:40:04.904Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b2 b8 c4 bc 1f d7 6f 71>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b2 b8 c4 bc 1f d7 6f 71> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.66:38858',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100369
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44658
received auth hello!
{ authId: 401, nonce: <Buffer 8c ba 96 e5 d2 96 70 5d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b4 c4 9d 9e 90 56 96 6d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d8 4b 44 80 80 ec 87 44>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d8 4b 44 80 80 ec 87 44> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.65:54100',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100372
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44694
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 401, nonce: <Buffer 38 49 55 2d 20 f7 68 b6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a3 66 a1 36 58 00 0b c9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c5 1d da b6 8a 92 ff 18>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c5 1d da b6 8a 92 ff 18> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.66:39094',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200408
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44886
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100377
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44904
received auth hello!
{ authId: 401, nonce: <Buffer cc d8 ea 13 0a b7 23 bf> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b3 cd cf d4 59 db 60 23>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 42 a1 a2 67 ff ce 1e a9>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 42 a1 a2 67 ff ce 1e a9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 24,
  remoteAddress: '::ffff:10.0.1.65:54346',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 24 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 24 }
specified socketID: 24
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100380
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44946
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 401, nonce: <Buffer 93 ee 25 1b 0c 6e 1b e5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b8 69 af 90 c8 74 a6 53>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c6 d2 5c 0c d9 23 b6 c5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c6 d2 5c 0c d9 23 b6 c5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 25,
  remoteAddress: '::ffff:10.0.1.66:39342',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 25 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 25 }
specified socketID: 25
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200423
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45144
received auth hello!
{ authId: 401, nonce: <Buffer 0f 33 e3 b3 9c 5f a9 9d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6c d0 86 b8 19 4d 26 5f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5b bb e9 42 12 36 65 4a>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 5b bb e9 42 12 36 65 4a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 26,
  remoteAddress: '::ffff:10.0.1.64:44642',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 26 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 26 }
specified socketID: 26
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #24 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100386
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45162
received auth hello!
{ authId: 401, nonce: <Buffer f7 7a 52 f4 dd 46 e3 85> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5b 6b e7 bd ec 37 c7 9c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 06 04 b6 c0 17 60 9a ae>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 06 04 b6 c0 17 60 9a ae> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 27,
  remoteAddress: '::ffff:10.0.1.65:54604',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 27 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 27 }
specified socketID: 27
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #25 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100389
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45208
received auth hello!
{ authId: 401, nonce: <Buffer a1 97 46 bf e5 ca a3 96> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1d 92 ff 97 75 21 2d 70>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0d f6 42 ad c6 d7 b1 11>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0d f6 42 ad c6 d7 b1 11> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 28,
  remoteAddress: '::ffff:10.0.1.66:39606',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 28 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 28 }
specified socketID: 28
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #26 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200438
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45398
received auth hello!
{ authId: 401, nonce: <Buffer 5e 63 3f d4 c4 0a fd 0e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 68 8c ba e6 ab 71 d6 52>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 60 76 cb be b0 9e ab f7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 60 76 cb be b0 9e ab f7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 29,
  remoteAddress: '::ffff:10.0.1.64:44896',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 29 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 29 }
specified socketID: 29
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #27 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100394
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45412
received auth hello!
{ authId: 401, nonce: <Buffer 9c aa 3f dd ef 38 5a 6f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a7 b0 c7 4c 4e a9 0c ae>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ed 65 69 06 ab f1 63 4c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ed 65 69 06 ab f1 63 4c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 30,
  remoteAddress: '::ffff:10.0.1.65:54856',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 30 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 30 }
specified socketID: 30
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #28 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100397
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45456
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 401, nonce: <Buffer f6 e1 8a 89 93 b1 95 7b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 37 39 fb fa 36 d1 fb 50>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9d 3e 46 e4 6b d0 6c fc>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9d 3e 46 e4 6b d0 6c fc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 31,
  remoteAddress: '::ffff:10.0.1.66:39856',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 31 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 31 }
specified socketID: 31
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #29 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200453
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45672
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #30 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100406
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45680
received auth hello!
{ authId: 401, nonce: <Buffer 5e 1c d2 be f7 08 03 69> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0e 54 58 18 64 b7 16 1f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4d e6 63 f9 d4 af 8f 9a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4d e6 63 f9 d4 af 8f 9a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 32,
  remoteAddress: '::ffff:10.0.1.64:45166',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 32 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 32 }
specified socketID: 32
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 401, nonce: <Buffer a1 95 3e be 14 1b 68 71> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f0 2e c7 29 d4 85 e2 c6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer df af 18 c4 82 ff 7e 61>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer df af 18 c4 82 ff 7e 61> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 33,
  remoteAddress: '::ffff:10.0.1.65:55120',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 33 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 33 }
specified socketID: 33
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #31 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100413
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45782
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #33 closed
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #32 closed
Unidentified client connected
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200467
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100418
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45944
connected to auth! from local port 45946
received auth hello!
{ authId: 401, nonce: <Buffer 99 75 77 0a f2 67 bf be> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f7 45 42 2a b3 a0 a1 25>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6a 44 84 8b fc 23 8a 16>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6a 44 84 8b fc 23 8a 16> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 34,
  remoteAddress: '::ffff:10.0.1.64:45440',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 34 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 34 }
specified socketID: 34
Handler: Error in server - details: handshake2 timed out...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100421
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45994
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: Disconnected from auth before getting session key response
/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902
            eventHandlers.onError('Error occurred in migration request: Disconnected from auth before getting migration response: ' + error);
                                                                                                                                      ^

ReferenceError: error is not defined
    at Socket.<anonymous> (/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902:135)
    at emitNone (events.js:91:20)
    at Socket.emit (events.js:188:7)
    at endReadableNT (_stream_readable.js:975:12)
    at _combinedTickCallback (internal/process/next_tick.js:80:11)
    at process._tickCallback (internal/process/next_tick.js:104:9)
