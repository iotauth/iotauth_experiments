changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s507.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's507',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 6d 66 ... > }
Handler: listening on port 22100
s507:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101265
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44858
received auth hello!
{ authId: 501, nonce: <Buffer df 75 48 69 a2 db 7d 1e> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 89 3b 5a 58 7f 36 a9 93>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer b0 44 39 69 6f 8c f5 c2 5c bf 34 aa ea fc f7 76>,
  macKeyVal: <Buffer 74 78 ab 69 b0 8f 32 87 27 3e 49 b4 16 2b 21 5d 8e e1 2d d2 c9 5b 01 e7 ca b5 7b 22 cf 64 86 80>,
  absValidity: 2018-03-22T01:08:55.380Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 01 9d 49 9a 66 f8 f9 3d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 01 9d 49 9a 66 f8 f9 3d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.71:58528',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101273
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45130
received auth hello!
{ authId: 501, nonce: <Buffer fb f6 1f 96 40 48 3c 32> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1a c0 af ef 18 ff 02 cc>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7e 28 a9 74 2c e4 84 22>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 7e 28 a9 74 2c e4 84 22> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.71:58800',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101281
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45400
received auth hello!
{ authId: 501, nonce: <Buffer 40 70 ea 09 a8 ae 17 42> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a7 21 f0 80 ac 90 35 e8>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ea 8d 26 11 82 35 78 3c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ea 8d 26 11 82 35 78 3c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.71:59070',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101289
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45670
received auth hello!
{ authId: 501, nonce: <Buffer 65 8e b1 f9 2d 5a c6 bc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer de 38 04 39 1e 02 10 aa>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8e 0e d2 4c 14 47 2e 8f>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 8e 0e d2 4c 14 47 2e 8f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.71:59340',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101297
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45940
received auth hello!
{ authId: 501, nonce: <Buffer 45 3e b1 37 b2 34 0d 1f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b5 59 7a e7 57 30 a0 f1>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 79 c5 8b a5 21 bd bc d1>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 79 c5 8b a5 21 bd bc d1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.71:59610',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101305
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46210
received auth hello!
{ authId: 501, nonce: <Buffer bf 2a 2c f9 79 f7 c6 82> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d3 49 a2 17 6e c3 34 56>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 97 e9 7e 2b 4e 46 9f 28>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 97 e9 7e 2b 4e 46 9f 28> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.71:59880',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101313
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46480
received auth hello!
{ authId: 501, nonce: <Buffer b8 be e5 30 7e 0a de 9b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b1 56 53 06 66 42 0d 6a>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f3 00 e1 1a 60 f6 56 25>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f3 00 e1 1a 60 f6 56 25> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.71:60150',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
