changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s518.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's518',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 67 49 42 41 41 4b 43 41 51 45 41 33 62 ... > }
Handler: listening on port 22100
s518:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400378
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49514
received auth hello!
{ authId: 504, nonce: <Buffer 5e 26 1f fa d7 66 40 67> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 1f 7a fc e0 30 0c dc ae>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 7e 78 47 14 da a4 9f 85 70 f4 62 38 f6 ef 66 ea>,
  macKeyVal: <Buffer 46 f2 92 26 2b d8 97 6c da b7 e1 9f 57 31 ed 34 41 16 c6 93 c1 93 ea 7f a6 20 0c 59 b7 dc 7f dc>,
  absValidity: 2018-03-22T01:09:37.090Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 46 c9 ef 1d e5 33 b1 75>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 46 c9 ef 1d e5 33 b1 75> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.84:58856',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400380
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49546
received auth hello!
{ authId: 504, nonce: <Buffer 6a 04 7e c2 9c 22 71 52> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c5 4b c0 e6 4d f9 b6 7d>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2e 52 fc 83 22 8c ad 97>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2e 52 fc 83 22 8c ad 97> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.85:46110',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400384
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49784
received auth hello!
{ authId: 504, nonce: <Buffer f6 a1 8c 57 5b e8 14 ff> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 32 5e d7 eb 8c d4 2b 6d>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5f 9f 10 f0 01 b8 97 cc>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5f 9f 10 f0 01 b8 97 cc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.84:59126',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400386
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49816
received auth hello!
{ authId: 504, nonce: <Buffer 7c 28 3d ed 13 3a 32 46> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 93 7f fb 31 a6 bc 66 8d>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f2 a1 9d f3 85 57 02 80>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f2 a1 9d f3 85 57 02 80> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.85:46380',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400390
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50054
received auth hello!
{ authId: 504, nonce: <Buffer 2c 52 c4 ea 0c 43 7c 12> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a3 64 84 e4 f6 43 96 14>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4f 17 23 df 01 bc c2 f3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4f 17 23 df 01 bc c2 f3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.84:59396',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400392
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50086
received auth hello!
{ authId: 504, nonce: <Buffer 01 88 ea c4 b2 09 5e 80> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer be 07 ef 25 bb 1d 5b b0>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 96 71 bb 9f 41 90 be f6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 96 71 bb 9f 41 90 be f6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.85:46650',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400396
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50324
received auth hello!
{ authId: 504, nonce: <Buffer 19 27 dc 38 10 69 5a b4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ab 72 38 1e 50 14 16 f6>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1d 15 69 74 ec 34 5b ec>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1d 15 69 74 ec 34 5b ec> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.84:59666',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400398
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50356
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer 1b 22 12 0d 6b 54 cd 48> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a3 6b 95 8e 4b 72 d7 86>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 00 56 4e 5a 9e 34 74 af>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 00 56 4e 5a 9e 34 74 af> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.85:46920',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400402
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50594
received auth hello!
{ authId: 504, nonce: <Buffer d8 ae d5 84 1d 78 52 1f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 47 3b 76 d8 ed 3e 86 ef>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6b 7a 4e 4e 61 92 d5 76>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6b 7a 4e 4e 61 92 d5 76> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.84:59936',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400404
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50626
received auth hello!
{ authId: 504, nonce: <Buffer eb 53 d5 a6 8b f8 10 89> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4d dc 09 e0 c4 3f 7a 09>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ad 0e 77 37 44 49 38 58>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ad 0e 77 37 44 49 38 58> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.85:47190',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400408
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50864
received auth hello!
{ authId: 504, nonce: <Buffer d7 ee e8 73 76 0f 6e 4c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 49 25 8d af 38 9a 34 ed>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 28 ae cf e1 d0 ef 27 34>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 28 ae cf e1 d0 ef 27 34> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.84:60206',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400410
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50896
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer fa a0 43 ba 91 e2 34 83> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3b 9e e2 8a 80 6f df cd>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 93 52 17 ac 92 48 64 15>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 93 52 17 ac 92 48 64 15> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.85:47460',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
