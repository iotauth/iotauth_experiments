changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s408.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's408',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 70 6f ... > }
Handler: listening on port 22100
s408:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200835
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42980
received auth hello!
{ authId: 402, nonce: <Buffer 9e ac 39 3d 06 18 ea a9> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 0b 76 5f 54 97 87 50 6d>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer d7 29 13 98 22 4c 1c e2 5c 62 2a c8 9f 78 e9 3d>,
  macKeyVal: <Buffer 67 18 78 b6 f6 81 f4 a5 6c 52 94 5a ed 19 af d4 f4 25 ad 69 59 b8 b6 36 ac a4 c9 23 44 1b 39 09>,
  absValidity: 2018-03-22T01:07:52.749Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 60 28 dc 0a 3c 04 09 7c>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 60 28 dc 0a 3c 04 09 7c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.52:37004',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200837
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42992
received auth hello!
{ authId: 402, nonce: <Buffer 09 68 49 17 a8 57 8c 94> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c7 20 31 33 f8 e3 b5 61>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 86 49 99 c6 07 ff b3 41>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 86 49 99 c6 07 ff b3 41> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.54:40760',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200842
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43148
received auth hello!
{ authId: 402, nonce: <Buffer 6f 05 43 d1 5b 90 1a 0f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 89 8d 16 6a 2f 3d 2c 2e>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 89 93 6e e3 48 e7 a9 91>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 89 93 6e e3 48 e7 a9 91> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.52:37172',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200844
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43172
received auth hello!
{ authId: 402, nonce: <Buffer 99 46 00 66 6e 56 98 fd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 77 85 9b 27 2a 92 96 91>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 32 c0 dd f8 1f 81 51 4a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 32 c0 dd f8 1f 81 51 4a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.54:40940',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200849
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43420
received auth hello!
{ authId: 402, nonce: <Buffer 02 bb d3 2f b2 ab 26 33> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 59 d6 be 47 7b 95 50 50>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0b bf f6 9d 9f bd 14 bd>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0b bf f6 9d 9f bd 14 bd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.52:37444',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200851
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43444
received auth hello!
{ authId: 402, nonce: <Buffer b0 e5 6e 4c 8c d6 dc 06> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 65 8f 6f ef a5 fe 4c cf>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d2 02 dd 83 d9 c1 22 1d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d2 02 dd 83 d9 c1 22 1d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.54:41212',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200856
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43690
received auth hello!
{ authId: 402, nonce: <Buffer 86 3e 00 08 16 d2 86 8b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1c bb 4c bf 05 d2 7b 6e>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9f 4f 67 81 9b 65 e1 c4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9f 4f 67 81 9b 65 e1 c4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.52:37714',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200858
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43714
received auth hello!
{ authId: 402, nonce: <Buffer 9f 33 8b 5f b8 2e b0 e0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 33 16 8f 20 7e 46 9e 7e>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 15 16 45 c2 70 c9 be 36>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 15 16 45 c2 70 c9 be 36> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.54:41482',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200863
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43960
received auth hello!
{ authId: 402, nonce: <Buffer e1 68 3a ef 4f de 77 1b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 93 0a 5f 6e 83 df c8 ec>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6f 0d 81 e2 22 c8 c9 e7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6f 0d 81 e2 22 c8 c9 e7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.52:37984',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200865
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43984
received auth hello!
{ authId: 402, nonce: <Buffer d5 c1 c8 ee 2f 38 b4 3e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9d e7 55 84 1e 2d 51 bf>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer da b5 3a f4 4d 10 bb 8b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer da b5 3a f4 4d 10 bb 8b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.54:41752',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200870
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44230
received auth hello!
{ authId: 402, nonce: <Buffer ae 0c e7 bf 33 ee be 6f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f1 fa 1a 5b bc c3 e5 a0>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6c 70 6c 4b 13 f9 7e 81>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 6c 70 6c 4b 13 f9 7e 81> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.52:38254',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200872
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44254
received auth hello!
{ authId: 402, nonce: <Buffer 3f 72 89 e0 5c db 9c 79> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 15 e2 0a ed 4d 12 59 3e>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b7 c9 20 4b 49 bd 4d fe>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b7 c9 20 4b 49 bd 4d fe> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.54:42022',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200877
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44500
received auth hello!
{ authId: 402, nonce: <Buffer d8 b8 71 f5 10 b7 49 b0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 49 46 f4 eb 8a b5 ee c7>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f5 c7 5d f9 4e c8 ee bf>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f5 c7 5d f9 4e c8 ee bf> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.52:38524',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200879
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44524
received auth hello!
{ authId: 402, nonce: <Buffer 48 a8 5c 57 8f 70 d9 af> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f9 8f 2c 96 50 46 cf e8>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d4 13 70 2a d1 60 d7 cd>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d4 13 70 2a d1 60 d7 cd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.54:42292',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200884
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44770
received auth hello!
{ authId: 402, nonce: <Buffer 22 ac 3b 19 04 a8 0d ea> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1f 1c 38 ac 56 e3 27 37>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 86 ea 14 b1 f7 a9 8c ba>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 86 ea 14 b1 f7 a9 8c ba> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.52:38794',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200886
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44794
received auth hello!
{ authId: 402, nonce: <Buffer 96 a0 98 6e e9 f6 a1 9e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 93 a0 69 e5 c4 b3 90 94>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4b 74 42 fb ec 20 7e ca>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 4b 74 42 fb ec 20 7e ca> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.54:42562',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
