changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s412.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's412',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 34 74 ... > }
Handler: listening on port 22100
s412:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301290
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58966
received auth hello!
{ authId: 403, nonce: <Buffer 77 b2 20 b3 fc 6f 0c f2> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 12 51 36 31 6e 62 8f 0a>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 05 a7 29 2a a6 a8 b4 ea f0 5a 63 23 50 36 de 6d>,
  macKeyVal: <Buffer 4c 40 d5 d7 02 95 80 c9 71 53 0c d7 81 92 1e 60 4b 58 10 22 2f 08 e8 fa 0e d5 50 61 d9 53 e6 61>,
  absValidity: 2018-03-22T01:08:08.290Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a3 86 d8 e6 db ae 6d 5f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a3 86 d8 e6 db ae 6d 5f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.57:39804',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301296
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59164
received auth hello!
{ authId: 403, nonce: <Buffer ba 2f aa 88 0c b5 3d 0f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 03 34 69 85 5f bc 79 47>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8c ad a5 4d a4 0e 02 78>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8c ad a5 4d a4 0e 02 78> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.57:40002',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301302
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59436
received auth hello!
{ authId: 403, nonce: <Buffer 1f e3 d0 3b 3c 32 2f cd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 50 d2 4c 7d a5 05 7a 2d>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fb ce 06 01 9e 06 59 c8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fb ce 06 01 9e 06 59 c8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.57:40274',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301308
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59706
received auth hello!
{ authId: 403, nonce: <Buffer 75 a9 c8 40 a3 28 c0 fd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 57 ea 8d 0f cb c0 72 11>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 45 59 75 47 11 3b 89 90>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 45 59 75 47 11 3b 89 90> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.57:40544',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301314
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59976
received auth hello!
{ authId: 403, nonce: <Buffer 94 42 f2 9a 20 76 ad f8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 48 a2 11 d2 ce b0 cd c1>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6f 2c 26 8a ab 8f c7 9d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 6f 2c 26 8a ab 8f c7 9d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.57:40814',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301320
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60246
received auth hello!
{ authId: 403, nonce: <Buffer 66 94 fb 73 18 b2 7d c4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c1 7f db 9b f9 7a 81 10>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0f 45 a5 bf 9c 78 cb e2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0f 45 a5 bf 9c 78 cb e2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.57:41084',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301326
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60516
received auth hello!
{ authId: 403, nonce: <Buffer ec ec 3c f9 e2 68 3c 5c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cf 4a d6 eb 54 58 0a 00>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9e 40 85 b8 d7 a8 72 5a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9e 40 85 b8 d7 a8 72 5a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.57:41354',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301332
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60782
received auth hello!
{ authId: 403, nonce: <Buffer 55 5b 2f 57 e3 72 d1 49> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6c f5 68 4c d5 48 0e 21>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 45 05 fa 79 ca 39 98 58>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 45 05 fa 79 ca 39 98 58> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.57:41620',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
