changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s414.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's414',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 67 49 42 41 41 4b 43 41 51 45 41 6e 45 ... > }
Handler: listening on port 22100
s414:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301289
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33852
received auth hello!
{ authId: 403, nonce: <Buffer c6 6d dd 5a e2 29 4e 0e> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer a3 6e d3 2f 35 8d 17 6c>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 7a 00 4b 9e 9b 34 ed e9 7d 54 28 5d b6 7a 34 13>,
  macKeyVal: <Buffer e8 ca 62 34 4d 1b 7f 3b 50 02 e8 04 39 05 96 a3 d3 bf 15 e6 78 a1 11 c9 0e d5 59 3e bb 80 5c 8e>,
  absValidity: 2018-03-22T01:08:05.222Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 54 03 9b bb 8e f6 f6 62>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 54 03 9b bb 8e f6 f6 62> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.56:34658',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301295
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34044
received auth hello!
{ authId: 403, nonce: <Buffer 78 39 44 a4 8a bf f1 0b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d3 e6 8e e8 f0 0f 11 f0>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 21 f6 b0 b6 44 0f 6a 22>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 21 f6 b0 b6 44 0f 6a 22> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.56:34850',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301301
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34316
received auth hello!
{ authId: 403, nonce: <Buffer 53 64 f2 23 28 54 52 3a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 07 07 70 55 a0 eb 50 64>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5a 9e 12 c6 37 f0 3a 54>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5a 9e 12 c6 37 f0 3a 54> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.56:35122',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301307
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34586
received auth hello!
{ authId: 403, nonce: <Buffer 0a 11 fc 2b 5c 39 e1 7a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 66 48 45 fd d6 ba 15 9d>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8c e1 0f 73 57 c7 b0 fe>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8c e1 0f 73 57 c7 b0 fe> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.56:35392',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301313
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34856
received auth hello!
{ authId: 403, nonce: <Buffer e8 eb 8a ed e2 6a 41 73> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3f 44 10 42 6a fd 02 8b>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a2 48 e9 0b 8f 22 15 64>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a2 48 e9 0b 8f 22 15 64> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.56:35662',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301319
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35126
received auth hello!
{ authId: 403, nonce: <Buffer 35 65 a4 64 40 42 81 f2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2a d5 db 50 30 1c d1 90>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 43 d8 8f cc 74 96 4f de>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 43 d8 8f cc 74 96 4f de> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.56:35932',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301325
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35396
received auth hello!
{ authId: 403, nonce: <Buffer b6 05 a5 06 73 2c 47 60> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a6 1c c0 12 ef e7 d2 39>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ab 14 85 00 3c f6 d4 fc>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ab 14 85 00 3c f6 d4 fc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.56:36202',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301331
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35662
received auth hello!
{ authId: 403, nonce: <Buffer 78 32 6f c1 6f d9 73 f1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1d c4 19 f6 74 85 9d 22>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ff 51 de 3a ea a0 42 d4>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ff 51 de 3a ea a0 42 d4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.56:36468',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
