changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s514.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's514',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 51 49 42 41 41 4b 43 41 51 45 41 77 53 ... > }
Handler: listening on port 22100
s514:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301478
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50836
received auth hello!
{ authId: 503, nonce: <Buffer 9b 8b 54 47 ce be 73 b0> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer c0 db 99 04 e4 c3 6f a6>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 7c e7 a6 5a 98 ed ec 5d e2 03 cb 13 a1 44 2c 92>,
  macKeyVal: <Buffer cc e9 d5 3f 6e 68 12 09 de aa 3e 85 ef e4 36 cb 28 be 6a 26 67 a7 d6 be e2 3c b4 ef fa cd 1b 0c>,
  absValidity: 2018-03-22T01:09:24.140Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 33 02 1d 86 bf 65 09 96>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 33 02 1d 86 bf 65 09 96> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.80:54048',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301483
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51106
received auth hello!
{ authId: 503, nonce: <Buffer 39 1a 7d 6c a6 17 b9 86> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f9 73 d8 7b 8a 94 83 8f>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 01 5b 0d 55 ae 6a d4 d1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 01 5b 0d 55 ae 6a d4 d1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.80:54318',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301488
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51376
received auth hello!
{ authId: 503, nonce: <Buffer 4d a8 be 2c 11 0f aa 91> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bf 6d 38 c5 4d f6 3e a1>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 18 73 61 f0 db e9 ae 75>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 18 73 61 f0 db e9 ae 75> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.80:54588',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301493
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51646
received auth hello!
{ authId: 503, nonce: <Buffer 21 c9 28 c5 87 7c 5d fd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f4 a0 7f e8 56 e4 b1 b9>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer aa 90 97 16 0b 77 3d 76>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer aa 90 97 16 0b 77 3d 76> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.80:54858',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301498
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51916
received auth hello!
{ authId: 503, nonce: <Buffer e8 85 87 8d 2a 0a ea 3e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 88 ea 06 83 77 d3 bc 6b>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 73 1e ba 45 e2 b7 ee 17>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 73 1e ba 45 e2 b7 ee 17> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.80:55128',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301503
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52186
received auth hello!
{ authId: 503, nonce: <Buffer f0 0c f4 8f 92 fa 5a f0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 11 5c 9e 6e 6e 2e 9c c7>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7f b9 9b f8 3f 67 96 d6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 7f b9 9b f8 3f 67 96 d6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.80:55398',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301508
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52452
received auth hello!
{ authId: 503, nonce: <Buffer 16 38 15 ea 4f 74 5b 14> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer dd 37 13 cf 02 79 f1 ee>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 66 55 b5 23 d1 87 41 b6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 66 55 b5 23 d1 87 41 b6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.80:55664',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
