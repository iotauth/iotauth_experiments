changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s505.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's505',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 71 79 ... > }
Handler: listening on port 22100
s505:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101262
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55714
received auth hello!
{ authId: 501, nonce: <Buffer 34 9e 65 75 e0 c8 d1 62> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 4c 79 cb 25 65 7b a4 b4>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 5e a7 97 14 01 17 49 20 01 2b 36 09 74 57 ad 57>,
  macKeyVal: <Buffer 60 6a c9 3c 0b c3 05 ca b1 a1 dc 9a ea 6a 14 05 d3 17 4f a9 e7 c8 54 70 08 66 bd e3 f7 7b 40 2b>,
  absValidity: 2018-03-22T01:08:44.209Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer da 31 41 11 90 6e 2d 81>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer da 31 41 11 90 6e 2d 81> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.68:55000',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101263
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55726
received auth hello!
{ authId: 501, nonce: <Buffer 32 3a 03 d5 b6 43 97 d2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ee e0 b2 47 3f 90 66 1d>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 60 05 67 2f b8 2e 05 2a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 60 05 67 2f b8 2e 05 2a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.69:43672',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101270
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55976
received auth hello!
{ authId: 501, nonce: <Buffer 5d 0c 72 0b 16 88 df a0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d8 9b 99 dd 59 81 85 63>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 66 df 5d 68 03 29 cc 92>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 66 df 5d 68 03 29 cc 92> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.68:55262',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101271
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55992
received auth hello!
{ authId: 501, nonce: <Buffer dd f5 bf b2 58 4c 4d 9f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d8 3a 25 ad fc 1c 31 f9>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7d 6b 05 49 42 d3 94 c3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 7d 6b 05 49 42 d3 94 c3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.69:43936',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101278
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56246
received auth hello!
{ authId: 501, nonce: <Buffer e5 a9 f2 aa b3 fc b9 bc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5c 40 80 e6 2d fa b6 3a>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0d 34 34 76 45 d8 e5 94>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 0d 34 34 76 45 d8 e5 94> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.68:55532',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101279
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56264
received auth hello!
{ authId: 501, nonce: <Buffer c2 e9 09 88 50 85 e0 60> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 53 3e 3a a5 70 28 88 54>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 27 9e ed 83 3e fb ed 86>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 27 9e ed 83 3e fb ed 86> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.69:44210',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101286
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56516
received auth hello!
{ authId: 501, nonce: <Buffer 2c 5c b7 62 09 a5 e2 0d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b8 c0 90 80 c1 eb 30 13>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 82 c9 3e be 77 3b ba eb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 82 c9 3e be 77 3b ba eb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.68:55802',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101287
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56534
received auth hello!
{ authId: 501, nonce: <Buffer ee cc cf 06 f8 b2 45 40> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6d f2 80 51 39 0c 73 e3>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b1 cd 3c 3e 47 59 fc 37>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b1 cd 3c 3e 47 59 fc 37> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.69:44480',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101294
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56786
received auth hello!
{ authId: 501, nonce: <Buffer d1 d4 87 38 49 f4 1e 4f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer df e6 a6 5e 7a 0c c8 20>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 43 e5 a0 4a 67 1e c7 9d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 43 e5 a0 4a 67 1e c7 9d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.68:56072',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101295
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56804
received auth hello!
{ authId: 501, nonce: <Buffer 63 76 80 b1 2f 86 07 cb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6f 3c 62 81 2a 0f 93 e0>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6a 10 a5 a8 79 db 09 a2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6a 10 a5 a8 79 db 09 a2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.69:44750',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101302
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57056
received auth hello!
{ authId: 501, nonce: <Buffer 96 39 7e 53 2d b9 cc 1d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 54 ce 71 1e f6 82 54 da>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b5 62 95 49 43 ca 90 d5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b5 62 95 49 43 ca 90 d5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.68:56342',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101303
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57074
received auth hello!
{ authId: 501, nonce: <Buffer aa bf 43 78 24 65 94 8d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a2 39 e3 9a c4 6c f2 e5>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer aa 1e dd dd 83 e1 e3 5d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer aa 1e dd dd 83 e1 e3 5d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.69:45020',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101310
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57326
received auth hello!
{ authId: 501, nonce: <Buffer 57 f4 5a 20 f0 58 3d e3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 20 a0 57 d8 b3 b1 9a 31>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 73 af 00 2d a4 f8 2a c4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 73 af 00 2d a4 f8 2a c4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.68:56612',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101311
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57344
received auth hello!
{ authId: 501, nonce: <Buffer b8 97 9f 4a 21 2d 6f 08> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6d 84 ec 2f a1 3d b1 64>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 53 e6 f3 2f 20 25 30 a3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 53 e6 f3 2f 20 25 30 a3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.69:45290',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
