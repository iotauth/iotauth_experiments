changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s519.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's519',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 67 49 42 41 41 4b 43 41 51 45 41 70 4b ... > }
Handler: listening on port 22100
s519:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400381
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35160
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400382
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35174
received auth hello!
{ authId: 504, nonce: <Buffer e3 5b 14 75 09 7c f4 0c> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer cc d1 c3 b7 03 9d 8d 73>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer b8 28 a9 72 9d fd e7 8f a8 ca f0 cb fc 43 d4 9b>,
  macKeyVal: <Buffer f5 3c 51 a9 31 32 9e 33 df ed 16 32 fd 48 14 d8 de 13 40 01 5c f0 e3 ea 03 86 a3 02 57 9b f9 91>,
  absValidity: 2018-03-22T01:09:51.130Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 79 29 69 e6 03 7d c3 89>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 79 29 69 e6 03 7d c3 89> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.86:43684',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer 39 2a 01 67 75 e8 d7 ca> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 38 c6 1e 47 2b 98 59 da>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 3d 8a f5 5a 2c 22 8f 35 c9 f3 68 16 d3 cf 52 07>,
  macKeyVal: <Buffer 92 40 2b 7f 06 e5 9a 5b 24 3d a9 b9 3c 51 31 85 39 60 17 0e 6d 2d 31 6d d7 8c 57 0f 1d 6e 6f 1f>,
  absValidity: 2018-03-22T01:09:52.925Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 46 48 71 4e 4a f6 16 6d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 46 48 71 4e 4a f6 16 6d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.87:44964',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400387
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35424
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400388
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
received auth hello!
{ authId: 504, nonce: <Buffer 92 ff ae e6 a1 6f 90 27> }
connected to auth! from local port 35446
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2f 45 6b dd 9c 09 86 31>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ff 50 23 91 b5 47 01 2e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ff 50 23 91 b5 47 01 2e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.86:43950',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer 8d f7 4f 67 c6 23 83 f9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer da 30 b4 17 57 56 6f 65>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 36 95 04 84 4c ac a5 ec>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 36 95 04 84 4c ac a5 ec> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.87:45236',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400393
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35694
received auth hello!
{ authId: 504, nonce: <Buffer a3 e5 b3 e3 21 3e b9 0d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e8 12 a4 8e 56 30 70 1b>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6f c4 02 f4 70 bc 29 82>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6f c4 02 f4 70 bc 29 82> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.86:44220',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400394
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35716
received auth hello!
{ authId: 504, nonce: <Buffer bb ba 0c 1d 46 ed 67 48> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bc 70 eb 69 da 2b 9a da>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f3 6a b0 f5 c4 48 cf 8f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f3 6a b0 f5 c4 48 cf 8f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.87:45508',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400399
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35964
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
received auth hello!
{ authId: 504, nonce: <Buffer d1 ff e8 aa a5 4f 56 2a> }
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400400
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1b fa 00 2d 25 e5 72 6f>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4f 05 e1 e5 4c 15 d3 3f>
switching to HANDSHAKE_2_SENT
disconnected from auth
connected to auth! from local port 35984
received session key handshake3!
{ replyNonce: <Buffer 4f 05 e1 e5 4c 15 d3 3f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.86:44490',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer c3 c9 ae 88 0c b7 73 81> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b8 f1 ca d4 51 0c 2c 2f>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d1 ba 72 85 ee 5e d4 d5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d1 ba 72 85 ee 5e d4 d5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.87:45774',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400405
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36234
received auth hello!
{ authId: 504, nonce: <Buffer 32 a2 f8 fb bd d8 4d 3e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 10 86 b5 1c 70 ca 96 85>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d6 ce ae f5 ed 7b 81 38>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer d6 ce ae f5 ed 7b 81 38> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.86:44760',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400406
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36256
received auth hello!
{ authId: 504, nonce: <Buffer c9 f5 b2 37 13 6b b3 2b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 40 0a e5 ba bd eb 1a 2c>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f6 90 27 b4 61 5d 27 a6>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f6 90 27 b4 61 5d 27 a6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.87:46048',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400411
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36504
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400412
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36524
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer 0f f6 97 12 44 8b a4 ac> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7e 0d 6f f3 7f 59 8c cc>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3f a2 15 b9 8c 62 59 2c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3f a2 15 b9 8c 62 59 2c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.86:45030',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
