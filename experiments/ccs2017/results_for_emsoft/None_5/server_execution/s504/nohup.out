changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s504.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's504',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 32 2b ... > }
Handler: listening on port 22100
s504:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101261
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44062
received auth hello!
{ authId: 501, nonce: <Buffer 20 82 96 e0 20 ab 05 a4> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 8a 4f d9 09 2e 64 2c 0a>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 34 10 db 67 51 93 e9 09 8d 4d 84 a8 aa fb b0 b3>,
  macKeyVal: <Buffer 49 b1 2f af 8a 53 26 5a 96 d3 39 30 88 34 9e ac 10 05 04 c7 4f dd c4 8b 7a c2 3b ce 51 00 d1 c4>,
  absValidity: 2018-03-22T01:08:40.952Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 50 62 0a d8 1a 35 fd f0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 50 62 0a d8 1a 35 fd f0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.67:36712',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101269
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44318
received auth hello!
{ authId: 501, nonce: <Buffer 1b 7c f4 ea 9a 99 6e f4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e2 ee 70 f3 33 a0 8f 97>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f7 ad ca 88 c3 44 37 a8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f7 ad ca 88 c3 44 37 a8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.67:36968',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101277
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44588
received auth hello!
{ authId: 501, nonce: <Buffer 75 a7 88 0f a7 7d ed 33> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7d 57 b0 05 e5 ac 93 a9>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 64 9d fe 6a 32 1f 0f ee>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 64 9d fe 6a 32 1f 0f ee> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.67:37238',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101285
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44858
received auth hello!
{ authId: 501, nonce: <Buffer 40 6b ba eb 9f 51 09 88> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c4 95 43 ff 60 4e 4d 39>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c1 ac df 41 98 4f f4 37>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c1 ac df 41 98 4f f4 37> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.67:37508',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101293
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45128
received auth hello!
{ authId: 501, nonce: <Buffer 46 92 d4 27 f8 01 8b 5c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 25 a8 6d fa ed f1 f3 cb>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer eb e9 4d 50 29 65 fb 57>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer eb e9 4d 50 29 65 fb 57> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.67:37778',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101301
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45398
received auth hello!
{ authId: 501, nonce: <Buffer 50 f0 66 62 3f f9 03 0e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d6 24 b7 33 b1 81 3b 7a>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f4 56 1b f4 a0 57 21 f2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f4 56 1b f4 a0 57 21 f2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.67:38048',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101309
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45668
received auth hello!
{ authId: 501, nonce: <Buffer a8 b5 1a 9f d9 ba 80 b5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 44 8a 02 30 a5 e3 de 5b>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 06 7d 9a 4e e1 a9 25 f5>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 06 7d 9a 4e e1 a9 25 f5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.67:38318',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
