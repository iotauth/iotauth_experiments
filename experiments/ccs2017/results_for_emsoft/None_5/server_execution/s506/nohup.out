changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s506.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's506',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 37 56 ... > }
Handler: listening on port 22100
s506:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101264
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41466
received auth hello!
{ authId: 501, nonce: <Buffer 12 b7 23 9c 7e 84 a2 0d> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 9d 4c 94 ac fe b6 c6 76>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer a4 ed d6 f9 9d b3 d6 b8 e0 cf 89 f9 5b 18 66 9e>,
  macKeyVal: <Buffer da a4 68 be 67 bc ab ea 22 01 e5 35 db 49 46 d0 ca 04 b4 cd 7d 40 4b 7b 19 c1 46 26 12 d7 9d 7a>,
  absValidity: 2018-03-22T01:08:51.365Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a7 4a 8e 08 fa 77 81 07>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a7 4a 8e 08 fa 77 81 07> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.70:51596',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101272
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41738
received auth hello!
{ authId: 501, nonce: <Buffer 7e 9d f1 a9 06 e1 ee 4c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fc 20 a4 fa 1a 01 e7 fa>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8a f4 7c 03 70 b8 03 96>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8a f4 7c 03 70 b8 03 96> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.70:51866',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101280
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42006
received auth hello!
{ authId: 501, nonce: <Buffer ad 21 62 4d 9a 2b 26 ed> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d0 5a 4b a4 d0 09 36 8f>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 85 cb 34 72 97 a0 74 83>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 85 cb 34 72 97 a0 74 83> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.70:52134',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101288
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42274
received auth hello!
{ authId: 501, nonce: <Buffer 0f 15 57 a6 cd 67 30 7d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bc dd 38 7d 39 2d e2 77>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1c f1 a9 b2 52 ec 8f c5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1c f1 a9 b2 52 ec 8f c5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.70:52404',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101296
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42548
received auth hello!
{ authId: 501, nonce: <Buffer ee d0 25 11 24 c6 02 ff> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 84 f3 84 67 cc 26 72 0c>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 83 e5 6b d9 92 95 27 e9>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 83 e5 6b d9 92 95 27 e9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.70:52676',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101304
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42814
received auth hello!
{ authId: 501, nonce: <Buffer f9 10 22 35 cf ff 55 5f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 02 72 27 06 a0 e7 4c ae>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 01 0c 9a 04 73 a7 fa ce>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 01 0c 9a 04 73 a7 fa ce> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.70:52944',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101312
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43088
received auth hello!
{ authId: 501, nonce: <Buffer 3e 99 53 20 cd 07 c0 7a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 16 2b 28 d1 cb 28 a0 4e>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c9 82 3f e2 c5 14 ab 66>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c9 82 3f e2 c5 14 ab 66> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.70:53216',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
