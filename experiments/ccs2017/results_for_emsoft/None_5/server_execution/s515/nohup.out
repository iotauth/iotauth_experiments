changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s515.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's515',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 76 72 ... > }
Handler: listening on port 22100
s515:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301479
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55578
received auth hello!
{ authId: 503, nonce: <Buffer ae b4 f7 6c db e0 61 33> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer d9 a4 3f 51 4a d6 91 d2>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer db 8d 1c a3 32 c2 42 81 e1 a8 22 05 1e 4b d6 3a>,
  macKeyVal: <Buffer 94 9e bd 97 c5 ab ca 80 86 ac 30 06 69 9b 54 07 4b ff d5 26 ca ad 94 91 b5 a4 b6 02 e7 89 20 35>,
  absValidity: 2018-03-22T01:09:27.252Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 18 23 ea 82 54 8c 77 b6>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 18 23 ea 82 54 8c 77 b6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.81:36550',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301484
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55848
received auth hello!
{ authId: 503, nonce: <Buffer 08 93 8a 57 a0 bf 71 4e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 56 a3 aa 28 ed 6a 31 d8>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a4 70 f2 fd af b3 7d 4d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a4 70 f2 fd af b3 7d 4d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.81:36820',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301489
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56118
received auth hello!
{ authId: 503, nonce: <Buffer 84 8f d3 10 df c4 28 e7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 56 e5 82 aa 09 11 2d d8>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1c a4 2f bb e6 b6 f7 ed>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1c a4 2f bb e6 b6 f7 ed> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.81:37090',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301494
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56388
received auth hello!
{ authId: 503, nonce: <Buffer d4 4b 79 fd 86 c9 21 40> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ad 4e cb 60 3a 9e e8 5a>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ce 81 4c d5 d7 1d eb 42>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ce 81 4c d5 d7 1d eb 42> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.81:37360',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301499
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56658
received auth hello!
{ authId: 503, nonce: <Buffer 72 48 a4 93 23 bc 1b d3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 84 0b 1a c7 3f e0 22 8c>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1c 39 42 7c fc 83 6a bd>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1c 39 42 7c fc 83 6a bd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.81:37630',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301504
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56928
received auth hello!
{ authId: 503, nonce: <Buffer 69 90 24 4b 73 89 f6 8d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 54 fe 1d 94 e1 28 2d 48>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d3 bc 37 08 e7 1d f7 11>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d3 bc 37 08 e7 1d f7 11> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.81:37900',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301509
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57190
received auth hello!
{ authId: 503, nonce: <Buffer ac 20 df f7 f0 d9 2d 03> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d1 85 9f a3 44 02 44 ec>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 11 4a bf b5 0f d5 df 0b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 11 4a bf b5 0f d5 df 0b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.81:38162',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
