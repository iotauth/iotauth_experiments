changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s415.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's415',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 74 46 ... > }
Handler: listening on port 22100
s415:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301292
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46862
received auth hello!
{ authId: 403, nonce: <Buffer 45 37 7e 46 3b 9e 98 a7> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer c7 72 a4 33 d1 af e4 00>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 02 8f 88 a1 a3 10 81 e6 16 bd d7 3f 0e 3e 94 85>,
  macKeyVal: <Buffer 07 42 49 2a 9a 14 37 e5 d8 a9 59 9a 9a eb 44 c5 fc b5 38 1f 16 5b 26 d9 86 35 2d 8e 52 80 67 48>,
  absValidity: 2018-03-22T01:08:15.440Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bb 76 6e 81 77 6d d2 3e>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer bb 76 6e 81 77 6d d2 3e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.59:39604',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301298
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47072
received auth hello!
{ authId: 403, nonce: <Buffer 67 60 fe 96 28 b1 17 2f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f3 b9 b4 d0 9a 32 ea 1b>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 98 4d c9 b9 9d 8d f4 c8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 98 4d c9 b9 9d 8d f4 c8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.59:39814',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301304
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47344
received auth hello!
{ authId: 403, nonce: <Buffer 33 75 aa 33 70 83 b8 4f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 94 7b cc 1e cf 06 3f 99>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 58 2b 62 9b 57 db 06 cd>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 58 2b 62 9b 57 db 06 cd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.59:40086',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301310
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47614
received auth hello!
{ authId: 403, nonce: <Buffer 47 4f fc e4 7d b7 a4 43> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ff 2a a9 1e 6c aa d4 e4>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f3 5c bb e2 81 9d d1 e6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f3 5c bb e2 81 9d d1 e6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.59:40356',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301316
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47884
received auth hello!
{ authId: 403, nonce: <Buffer aa 2f 12 41 89 79 62 65> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1d 22 ea 3c 1c 3c 5c 0b>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 92 78 7a cc d6 e5 f4 bd>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 92 78 7a cc d6 e5 f4 bd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.59:40626',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301322
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48154
received auth hello!
{ authId: 403, nonce: <Buffer de 01 bd cd 42 09 36 e1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 27 e5 47 d7 7c 8d 09 18>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e1 08 a0 e9 01 1a 7e c2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e1 08 a0 e9 01 1a 7e c2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.59:40896',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301328
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48424
received auth hello!
{ authId: 403, nonce: <Buffer 08 8a fb d5 d1 e1 1a e2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0c 33 5b 79 61 1d 8a ef>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c3 72 8f 74 0a e5 f0 be>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c3 72 8f 74 0a e5 f0 be> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.59:41166',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301334
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48690
received auth hello!
{ authId: 403, nonce: <Buffer a4 fb a4 ed a0 65 da 00> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 95 f8 9a d9 10 5d e8 74>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9a 64 5e 43 58 73 50 4f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9a 64 5e 43 58 73 50 4f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.59:41432',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
