changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s507.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's507',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 6d 66 ... > }
Handler: listening on port 22100
s507:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101209
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39372
received auth hello!
{ authId: 501, nonce: <Buffer 9c f3 11 c5 39 bd 8d 1c> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 7b 7c 83 22 97 6b a1 32>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 28 a6 1d 5d b2 af 57 66 ff 1b 86 b0 bc cf 13 b7>,
  macKeyVal: <Buffer 54 63 e0 01 16 91 69 92 01 cb d1 54 59 68 bf 87 3a 9e f6 7c bb 9e 95 16 a3 8a 8a e8 4e 16 80 39>,
  absValidity: 2018-03-22T00:20:16.504Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fc 9d f3 99 4e 6a 9e 78>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fc 9d f3 99 4e 6a 9e 78> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.71:53042',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101217
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39644
received auth hello!
{ authId: 501, nonce: <Buffer c1 c9 2d 39 7d 88 53 c6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ef 87 d0 f0 e4 da d0 8d>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d6 81 a5 eb 5a 38 fd 36>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d6 81 a5 eb 5a 38 fd 36> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.71:53314',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101225
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39914
received auth hello!
{ authId: 501, nonce: <Buffer d4 0a 0c 00 fb 2a 1b 89> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 35 cb 6f cc 3c bf 47 17>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c9 6c b7 20 2a 72 6f 67>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c9 6c b7 20 2a 72 6f 67> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.71:53584',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101233
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40184
received auth hello!
{ authId: 501, nonce: <Buffer f8 8e b8 0b ef 7e 0d 10> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a4 0b e7 e1 4a e5 ea 3c>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f7 04 e2 db 96 8b 52 7f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f7 04 e2 db 96 8b 52 7f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.71:53854',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101241
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40454
received auth hello!
{ authId: 501, nonce: <Buffer 49 95 03 1a 3f 8a 02 4a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f9 53 31 06 58 7c 67 46>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 67 47 18 27 dd 2f 81 b2>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 67 47 18 27 dd 2f 81 b2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.71:54124',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101249
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40724
received auth hello!
{ authId: 501, nonce: <Buffer 69 f7 21 62 5a 44 ee 66> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 46 33 c3 04 1c 06 dc 80>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fd a5 bc d9 cc 3a db 97>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer fd a5 bc d9 cc 3a db 97> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.71:54394',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101257
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40990
received auth hello!
{ authId: 501, nonce: <Buffer 02 a1 bb 29 cd 89 f6 95> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 67 19 26 49 f1 66 f8 4e>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 28 f1 b7 fd 6e d5 fa a1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 28 f1 b7 fd 6e d5 fa a1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.71:54660',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
