changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s519.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's519',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 67 49 42 41 41 4b 43 41 51 45 41 70 4b ... > }
Handler: listening on port 22100
s519:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400344
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57904
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400345
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57918
received auth hello!
{ authId: 504, nonce: <Buffer 67 13 50 a2 25 02 41 8e> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 0c 0a ec 98 a5 51 f6 43>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 20 c6 bf da 10 86 ff de 58 90 e7 fd 3e 7e 67 bb>,
  macKeyVal: <Buffer c5 e5 12 e3 11 b8 97 cd 0a ed ae 48 22 52 8b 22 85 28 a7 55 98 58 60 f8 c6 9e 44 e5 95 79 14 ae>,
  absValidity: 2018-03-22T00:21:12.291Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e2 c4 70 59 0d 3a e2 2f>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e2 c4 70 59 0d 3a e2 2f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.86:38198',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer 49 9e e4 08 ac 41 78 df> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 1e 81 d6 c8 18 ec 4d e2>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 34 74 57 ae 5a 78 0b b1 66 db 8d e0 d9 11 de 43>,
  macKeyVal: <Buffer be aa a4 4e 6b 33 9b c9 1c 92 36 fd 82 29 24 0e e9 22 0a 75 2c 81 20 1e bb 41 df b3 34 bb 7d 50>,
  absValidity: 2018-03-22T00:21:14.014Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 95 3c c6 4f 26 74 d8 1e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 95 3c c6 4f 26 74 d8 1e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.87:39476',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400350
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58170
received auth hello!
{ authId: 504, nonce: <Buffer 61 34 1f 7c 37 28 9f 83> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 20 8b 5b 08 e8 3b 09 9a>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 78 4e 8d 30 70 a8 27 60>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 78 4e 8d 30 70 a8 27 60> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.86:38462',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400351
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58194
received auth hello!
{ authId: 504, nonce: <Buffer 70 c3 84 81 d3 c9 0b b8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2b c7 59 cc 37 df 0d 94>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 08 8d cb 6e 66 b5 5b 03>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 08 8d cb 6e 66 b5 5b 03> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.87:39752',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400356
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58440
received auth hello!
{ authId: 504, nonce: <Buffer b1 08 c4 71 a6 5e 20 d7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 88 36 8b 47 e7 00 d9 a3>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b9 de b8 da e7 9c 7d 9f>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b9 de b8 da e7 9c 7d 9f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.86:38732',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400357
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58466
received auth hello!
{ authId: 504, nonce: <Buffer 33 3e 06 79 31 ea 5d f2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 43 ef 66 06 a0 c7 2e 4a>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d4 22 08 28 18 9a 94 e5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d4 22 08 28 18 9a 94 e5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.87:40024',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400362
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58716
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400363
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58726
received auth hello!
{ authId: 504, nonce: <Buffer 5b 13 7f 26 af 2e 48 52> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 86 bb bc 37 fa 29 6c 1a>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b3 22 e6 84 6e 39 a1 9a>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b3 22 e6 84 6e 39 a1 9a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.86:39008',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer 97 1f 2f ee 0d 91 9f 1a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6d 77 db 15 3a 1d 6b 47>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a3 bf 76 3d a5 17 90 07>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer a3 bf 76 3d a5 17 90 07> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.87:40286',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400368
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58980
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400369
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
received auth hello!
{ authId: 504, nonce: <Buffer 41 7b 7f 38 bb 4e db bf> }
connected to auth! from local port 58998
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 01 ea 00 0f d8 8c 6c ec>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4b 35 89 9a c6 c6 30 63>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4b 35 89 9a c6 c6 30 63> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.86:39272',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer 0b 64 30 ab 07 ca db 97> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d9 b1 e6 95 4a c8 c7 4e>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bf aa 26 d8 f9 26 e6 ec>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer bf aa 26 d8 f9 26 e6 ec> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.87:40556',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400374
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59256
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
