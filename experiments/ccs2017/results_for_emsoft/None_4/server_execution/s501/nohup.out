changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s501.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's501',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 78 42 ... > }
Handler: listening on port 22100
s501:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101202
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35226
received auth hello!
{ authId: 501, nonce: <Buffer c9 39 96 72 5d 1a 2c 79> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 28 d6 82 f3 da 03 64 36>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer aa 80 ba ad 53 57 e5 ad 5e 60 ba 99 7f 54 2c db>,
  macKeyVal: <Buffer 9c ea 09 0b 14 10 35 11 85 fe 34 44 ad 90 ae f7 d3 2c 46 1e 34 ff 12 31 2e e1 de d9 ae 56 bc aa>,
  absValidity: 2018-03-22T00:19:45.478Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b0 3e e2 a5 72 29 d5 2c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b0 3e e2 a5 72 29 d5 2c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.62:45532',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101210
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35456
received auth hello!
{ authId: 501, nonce: <Buffer 19 25 82 a3 f2 c2 83 a8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9b 4a a9 51 5b 6e 2b d0>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a5 10 2c 22 98 bd 46 a1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a5 10 2c 22 98 bd 46 a1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.62:45762',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101218
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35726
received auth hello!
{ authId: 501, nonce: <Buffer 6d 53 94 ac e8 dc 24 1e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7b 9d 82 83 8e bf 4e 9a>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 99 6c a8 c3 05 f9 c7 e7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 99 6c a8 c3 05 f9 c7 e7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.62:46032',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101226
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35996
received auth hello!
{ authId: 501, nonce: <Buffer d0 32 11 1f da cc ab 30> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f0 79 e6 6b 39 77 b1 ca>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7d 2c 46 b8 30 66 fe 8e>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 7d 2c 46 b8 30 66 fe 8e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.62:46302',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101234
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36266
received auth hello!
{ authId: 501, nonce: <Buffer 49 ce 06 b1 09 7a e4 61> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d1 54 bc c2 93 ee ec 18>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a3 0b 0d 57 5b 97 72 fc>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a3 0b 0d 57 5b 97 72 fc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.62:46572',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101242
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36536
received auth hello!
{ authId: 501, nonce: <Buffer a3 53 50 de 65 f1 f2 f6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b8 a9 38 e8 13 b5 5e 21>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer dc 1c 82 92 5d ef 7b 24>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer dc 1c 82 92 5d ef 7b 24> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.62:46842',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101250
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36806
received auth hello!
{ authId: 501, nonce: <Buffer 83 6e 22 56 75 15 9c 0f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 85 ab c2 5e 17 e7 d8 6f>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer aa ce 37 61 62 6a ad 41>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer aa ce 37 61 62 6a ad 41> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.62:47112',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
