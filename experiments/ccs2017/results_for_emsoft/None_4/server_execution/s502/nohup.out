changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s502.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's502',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 70 71 ... > }
Handler: listening on port 22100
s502:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101203
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44614
received auth hello!
{ authId: 501, nonce: <Buffer cf fd 69 5c 8b 08 a9 a4> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer e9 28 49 c1 23 04 cc 05>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 4d 57 59 da 69 4c df 06 d8 13 0f 8d b1 a9 01 40>,
  macKeyVal: <Buffer 2f 61 9d 90 c8 2a 42 04 62 ab 82 e8 f6 c1 0b 6c b0 4c 8d be 33 94 c0 6a a9 c7 3f 72 8b d8 e2 e6>,
  absValidity: 2018-03-22T00:19:48.816Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bd 5b 76 44 ba 7a 4a 4b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bd 5b 76 44 ba 7a 4a 4b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.63:58950',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101211
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44850
received auth hello!
{ authId: 501, nonce: <Buffer 3e cc c0 df d5 28 cc 38> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6f 8c 87 83 f8 dd b8 25>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f8 48 4d 2c 0f bd 3a 04>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f8 48 4d 2c 0f bd 3a 04> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.63:59186',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101219
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45120
received auth hello!
{ authId: 501, nonce: <Buffer e2 4a 81 1c 3b ec b2 5e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 31 fa 61 f0 ad 44 8c 86>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer dd ce 37 63 01 7e f8 a4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer dd ce 37 63 01 7e f8 a4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.63:59456',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101227
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45390
received auth hello!
{ authId: 501, nonce: <Buffer 55 bd 05 fc 41 f3 0f 83> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 08 50 57 32 ad 79 9c 4a>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cb 56 f3 ac 68 7a 85 4e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer cb 56 f3 ac 68 7a 85 4e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.63:59726',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101235
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45660
received auth hello!
{ authId: 501, nonce: <Buffer 41 52 8c 53 03 98 71 2b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer be 9f b8 14 6b e3 a7 13>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8d 00 b2 59 fc 1a 6f e3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8d 00 b2 59 fc 1a 6f e3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.63:59996',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101243
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45930
received auth hello!
{ authId: 501, nonce: <Buffer f0 74 02 fa f1 e6 b8 74> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9c c3 57 e9 b2 2b ec bd>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ba 5f 3b 2b 75 69 76 52>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ba 5f 3b 2b 75 69 76 52> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.63:60266',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101251
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46200
received auth hello!
{ authId: 501, nonce: <Buffer 9b df 40 8b 1a 13 30 4f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer da 31 d0 19 7f a2 b6 33>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 46 23 0c 4e 05 0f ba d1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 46 23 0c 4e 05 0f ba d1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.63:60536',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
