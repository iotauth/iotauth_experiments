changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s408.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's408',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 70 6f ... > }
Handler: listening on port 22100
s408:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200780
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37494
received auth hello!
{ authId: 402, nonce: <Buffer 0f 02 eb cb a2 db 0b 7e> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 3c 42 eb 5c f7 84 86 12>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer e5 3c 5a 0f a9 83 4b 9a 21 fb 11 60 58 e3 2c ba>,
  macKeyVal: <Buffer 55 6b 00 85 a4 cb 28 e6 0b 23 3a fc b5 d0 98 de 95 d1 10 58 94 58 0a c0 ae b0 ed 89 46 8f ad 20>,
  absValidity: 2018-03-22T00:19:13.431Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 98 97 e5 e4 38 91 1d 8a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 98 97 e5 e4 38 91 1d 8a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.52:59750',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200782
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37506
received auth hello!
{ authId: 402, nonce: <Buffer 41 72 4a f7 54 82 46 fe> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 18 dc a6 e1 16 4b 0f 8d>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 79 00 80 b3 e5 b9 72 00>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 79 00 80 b3 e5 b9 72 00> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.54:35274',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200787
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37662
received auth hello!
{ authId: 402, nonce: <Buffer 3c 1e b7 0e df 7f 76 50> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f1 37 bc 9b 44 fe 58 2d>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 57 d8 53 a4 c4 f7 62 61>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 57 d8 53 a4 c4 f7 62 61> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.52:59918',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200789
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37686
received auth hello!
{ authId: 402, nonce: <Buffer 4a 4b bd 33 4a 8d 6b 4c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 52 56 21 c5 14 99 9d fc>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 20 fb 45 e2 98 30 a9 41>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 20 fb 45 e2 98 30 a9 41> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.54:35454',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200794
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37934
received auth hello!
{ authId: 402, nonce: <Buffer 16 4a 5c 37 75 a3 f3 3f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0e 8d 41 23 b6 60 40 b7>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7e c0 94 cd 28 41 19 ec>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 7e c0 94 cd 28 41 19 ec> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.52:60190',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200796
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37958
received auth hello!
{ authId: 402, nonce: <Buffer e1 ea b8 87 1d a8 6d 02> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b0 9e 4f 37 f5 ed dc de>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3d 9b e4 aa f5 e0 14 93>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3d 9b e4 aa f5 e0 14 93> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.54:35726',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200801
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38204
received auth hello!
{ authId: 402, nonce: <Buffer 4d d8 6b d0 fd 63 84 5f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 46 47 c2 33 61 e8 ed c1>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4e fb c4 49 03 09 2d 6b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 4e fb c4 49 03 09 2d 6b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.52:60460',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200803
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38228
received auth hello!
{ authId: 402, nonce: <Buffer d7 19 92 d3 fe 96 4e ea> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3e c4 9a c7 6a d9 a5 92>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b2 70 8d 65 71 4d f6 3c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b2 70 8d 65 71 4d f6 3c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.54:35996',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200808
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38474
received auth hello!
{ authId: 402, nonce: <Buffer 16 7a c8 43 51 86 99 7c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9a f1 23 79 1a a9 9a 06>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ff d5 dd 72 45 4e d2 01>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ff d5 dd 72 45 4e d2 01> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.52:60728',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200810
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38498
received auth hello!
{ authId: 402, nonce: <Buffer 14 40 89 0a b2 5c 56 f2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e6 8e a5 3e 66 0a cc 9b>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1d 40 a5 03 19 ab e8 d8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1d 40 a5 03 19 ab e8 d8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.54:36266',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200815
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38744
received auth hello!
{ authId: 402, nonce: <Buffer 68 84 28 fc f5 ec 5f b5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 71 b2 6c 14 92 13 e5 8e>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 80 a3 c2 bf 91 40 3b 6c>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 80 a3 c2 bf 91 40 3b 6c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.52:32768',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200817
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38768
received auth hello!
{ authId: 402, nonce: <Buffer 51 89 47 5a e5 15 e9 f7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b3 fe 28 4e 65 68 68 64>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 43 56 f8 3c 17 4c 54 42>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 43 56 f8 3c 17 4c 54 42> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.54:36536',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200822
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39014
received auth hello!
{ authId: 402, nonce: <Buffer d1 29 07 4e 6b 0e fc 25> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f0 a9 53 9a cf 8d 43 ee>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 80 c6 28 a3 98 63 79 84>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 80 c6 28 a3 98 63 79 84> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.52:33038',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200824
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39038
received auth hello!
{ authId: 402, nonce: <Buffer 04 a6 f6 89 63 8e 31 d4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 05 ad 13 f9 67 4b 1e da>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 76 a9 c7 67 97 63 6a 3e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 76 a9 c7 67 97 63 6a 3e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.54:36806',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200829
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39280
received auth hello!
{ authId: 402, nonce: <Buffer dc 48 11 fa f6 2e 52 2f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 01 fd 80 0f ec 9d c2 06>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d0 fc 2f fc 78 c9 ad 77>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d0 fc 2f fc 78 c9 ad 77> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.52:33304',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200831
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39304
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
