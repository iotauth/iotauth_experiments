changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s415.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's415',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 74 46 ... > }
Handler: listening on port 22100
s415:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301244
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41376
received auth hello!
{ authId: 403, nonce: <Buffer 7b da 27 87 70 4a dc 6c> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 54 f6 47 de d4 93 74 38>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer aa 3f 10 1c f1 ba fd a1 77 5a 53 0f d6 31 ce 83>,
  macKeyVal: <Buffer af 95 58 90 49 d9 96 1b 9e 34 1c c8 31 ae d5 48 ec 6d 30 69 be 22 68 8c 3b cc af 7a fc c6 e2 54>,
  absValidity: 2018-03-22T00:19:36.405Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ed 90 e2 95 c9 ad 89 45>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ed 90 e2 95 c9 ad 89 45> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.59:34118',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301250
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41586
received auth hello!
{ authId: 403, nonce: <Buffer 85 3c dc 0a 15 13 f7 ed> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 14 d4 e3 5b ff 8f 75 ac>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c7 14 cf e5 c8 0f 3d 38>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c7 14 cf e5 c8 0f 3d 38> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.59:34326',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301256
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41858
received auth hello!
{ authId: 403, nonce: <Buffer eb 1d 22 8d 49 44 54 f8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3d e2 ea 9c 2e 6a ea b8>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 62 a3 83 fa c4 95 f8 29>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 62 a3 83 fa c4 95 f8 29> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.59:34598',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301262
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42128
received auth hello!
{ authId: 403, nonce: <Buffer 49 4c 5f 94 01 15 79 2e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 36 76 03 84 f2 bb 73 b4>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ab 6e 88 0b 6e da 73 30>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ab 6e 88 0b 6e da 73 30> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.59:34868',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301268
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42398
received auth hello!
{ authId: 403, nonce: <Buffer f8 53 e5 52 1c 65 65 bf> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 62 84 a6 2e 78 7d 5e d4>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4e 96 e3 fc 40 c8 eb 31>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4e 96 e3 fc 40 c8 eb 31> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.59:35138',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301274
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42668
received auth hello!
{ authId: 403, nonce: <Buffer 39 c0 2c e5 ab 14 6c a3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e2 55 14 2f 35 91 28 1a>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f1 0d e0 4f 05 f9 40 04>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f1 0d e0 4f 05 f9 40 04> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.59:35408',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301280
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42938
received auth hello!
{ authId: 403, nonce: <Buffer 3d ee a2 58 46 38 e8 62> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e5 de 0d 9d 98 ed 94 1d>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 17 c9 81 29 ca 2d bf 25>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 17 c9 81 29 ca 2d bf 25> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.59:35678',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301286
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43200
received auth hello!
{ authId: 403, nonce: <Buffer 52 4d d0 b8 4c 0f 77 9f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ee 5d 0c 46 fd f1 d5 b2>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 67 71 ed fc cf 0f 0b c3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 67 71 ed fc cf 0f 0b c3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.59:35940',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
