changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s412.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's412',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 34 74 ... > }
Handler: listening on port 22100
s412:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301242
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53480
received auth hello!
{ authId: 403, nonce: <Buffer 7b 9a bc 42 67 74 b0 3e> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 66 af fb 76 d6 5d 2f 88>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer c0 6b 3e 45 94 e3 72 93 88 61 cf 96 27 e9 2d 5c>,
  macKeyVal: <Buffer ad 25 9f b3 4e 19 cf 05 83 c9 e8 65 ff 97 70 11 1e 53 5b e4 d4 f3 5a 43 c0 b0 98 90 53 4c 88 c5>,
  absValidity: 2018-03-22T00:19:29.224Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9e aa 28 b1 9d 24 56 c4>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 9e aa 28 b1 9d 24 56 c4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.57:34318',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301248
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53678
received auth hello!
{ authId: 403, nonce: <Buffer a9 c5 50 c3 b4 ef 93 cb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 65 2a 3d 87 d2 58 49 53>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer db 2b ca 7d 30 d0 30 1e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer db 2b ca 7d 30 d0 30 1e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.57:34516',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301254
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53950
received auth hello!
{ authId: 403, nonce: <Buffer d8 b8 b2 b9 df fb c3 e3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1a 62 2f be a3 a6 66 fb>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 05 77 d9 26 c7 94 68 57>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 05 77 d9 26 c7 94 68 57> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.57:34788',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301260
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54220
received auth hello!
{ authId: 403, nonce: <Buffer cc c4 50 e9 2c d8 0d c9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 68 14 9d 1b 77 b7 2b cd>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0c 68 c0 d9 67 34 3e d2>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 0c 68 c0 d9 67 34 3e d2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.57:35058',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301266
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54490
received auth hello!
{ authId: 403, nonce: <Buffer ec d5 a1 0d 6f de 37 ca> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 01 e6 3f 26 8c cf 2f 83>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 93 4d fa 34 cd 96 03 f8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 93 4d fa 34 cd 96 03 f8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.57:35328',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301272
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54760
received auth hello!
{ authId: 403, nonce: <Buffer e7 2e a4 2b 5f 4f 1a bb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5d 07 de b6 b1 34 ea b0>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 70 17 07 35 01 42 80 b8>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 70 17 07 35 01 42 80 b8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.57:35598',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301278
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55030
received auth hello!
{ authId: 403, nonce: <Buffer d1 ea 8e 1e b6 e5 fb e1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c0 de 93 78 ce 14 92 57>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bd d8 1d fe 5c 55 a7 e6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bd d8 1d fe 5c 55 a7 e6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.57:35868',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301284
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55292
received auth hello!
{ authId: 403, nonce: <Buffer 7a fe 44 cb 3f f3 9c 97> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 83 c0 4f 32 13 8e 49 9f>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 24 91 bb 04 6f a0 15 5e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 24 91 bb 04 6f a0 15 5e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.57:36130',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
