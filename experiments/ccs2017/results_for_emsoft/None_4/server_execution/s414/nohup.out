changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s414.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's414',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 67 49 42 41 41 4b 43 41 51 45 41 6e 45 ... > }
Handler: listening on port 22100
s414:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301241
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56598
received auth hello!
{ authId: 403, nonce: <Buffer c0 0f 33 75 d5 db c3 3a> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer c2 d5 9f 1a 26 40 2c b1>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 4b 85 3d 58 ae d2 b1 a0 b8 87 e0 36 26 09 f1 7b>,
  macKeyVal: <Buffer 76 88 42 f5 78 7d 69 da 9c 4b cd df 42 59 d8 33 49 0f 10 ac c2 0a 84 96 18 2c 2c f1 de f2 df e8>,
  absValidity: 2018-03-22T00:19:26.277Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a0 5a 28 c1 59 b4 53 fe>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer a0 5a 28 c1 59 b4 53 fe> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.56:57404',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301247
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56790
received auth hello!
{ authId: 403, nonce: <Buffer 60 34 07 84 54 ee cb 19> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fd 7d 5f 17 f4 e7 1d 79>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer dd 92 65 85 e3 84 c1 db>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer dd 92 65 85 e3 84 c1 db> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.56:57596',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301253
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57062
received auth hello!
{ authId: 403, nonce: <Buffer 23 36 92 5c 3f 94 38 49> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5c e5 78 8e 0d 68 89 29>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e2 70 c3 5d 78 19 db 5a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e2 70 c3 5d 78 19 db 5a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.56:57868',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301259
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57332
received auth hello!
{ authId: 403, nonce: <Buffer 2e 3f 8d c8 63 fc bc 10> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0a 87 09 a9 e4 69 ae 21>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 23 86 6c 09 c6 e7 0c 83>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 23 86 6c 09 c6 e7 0c 83> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.56:58138',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301265
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57602
received auth hello!
{ authId: 403, nonce: <Buffer c1 88 f0 5e ce 56 a4 83> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4b 11 50 a9 64 b2 6e 39>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer db 90 cf 92 84 cb 67 a7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer db 90 cf 92 84 cb 67 a7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.56:58408',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301271
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57872
received auth hello!
{ authId: 403, nonce: <Buffer 32 a8 7d ee 90 db a1 61> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3f b4 eb 1d 3b b5 f1 c7>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 38 80 68 d8 67 e3 a8 3d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 38 80 68 d8 67 e3 a8 3d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.56:58678',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301277
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58142
received auth hello!
{ authId: 403, nonce: <Buffer bb 50 f4 5f 37 a4 78 13> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 62 46 bd 8e 6d 24 58 03>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a3 8e 6b a4 a6 90 1f a9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a3 8e 6b a4 a6 90 1f a9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.56:58948',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301283
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58404
received auth hello!
{ authId: 403, nonce: <Buffer 4d 32 30 83 de b7 68 0c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9e 7e ff 97 2f 73 65 73>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 14 5d b8 cd c6 83 57 56>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 14 5d b8 cd c6 83 57 56> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.56:59210',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
