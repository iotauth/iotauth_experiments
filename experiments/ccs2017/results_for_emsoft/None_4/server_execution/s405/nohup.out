changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s405.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's405',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 74 59 ... > }
Handler: listening on port 22100
s405:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200777
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45970
received auth hello!
{ authId: 402, nonce: <Buffer 46 16 22 cf 9e 21 13 68> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 38 30 0d 07 ca c7 ba 5e>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 97 b5 2c e5 c8 80 dc ae de 7a 6f eb 58 9d ad bb>,
  macKeyVal: <Buffer 64 30 46 b3 2f c8 41 0b 15 04 55 5e ad b7 7c 69 66 3d f0 4c a5 c1 c8 cf 6f 1e 42 7e 80 00 03 28>,
  absValidity: 2018-03-22T00:19:03.010Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3d ed fb 02 99 3b eb 01>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3d ed fb 02 99 3b eb 01> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.49:56696',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200784
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46120
received auth hello!
{ authId: 402, nonce: <Buffer dd 5b bb b3 3e 82 f1 5b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7b 5b 00 1e d2 49 4d a0>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 01 ce 58 92 85 a5 25 b9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 01 ce 58 92 85 a5 25 b9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.49:56846',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200791
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46376
received auth hello!
{ authId: 402, nonce: <Buffer 5c 7d 4f 63 f6 82 df c6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 97 46 3a 3f b0 74 22 d7>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 95 38 49 04 1f de a1 ca>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 95 38 49 04 1f de a1 ca> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.49:57102',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200798
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46646
received auth hello!
{ authId: 402, nonce: <Buffer d7 f3 74 d2 3e e0 3b b2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fa 77 e4 b5 56 81 96 f4>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b7 9b b2 3a 8a 81 20 99>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b7 9b b2 3a 8a 81 20 99> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.49:57372',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200805
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46916
received auth hello!
{ authId: 402, nonce: <Buffer 5b 32 c9 68 24 0f bc 13> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c5 59 c8 7d fa e0 83 cd>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 62 01 62 51 59 99 a9 dc>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 62 01 62 51 59 99 a9 dc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.49:57642',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200812
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47186
received auth hello!
{ authId: 402, nonce: <Buffer 01 54 d4 07 55 8a d9 a7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7f 2b 93 ed ae 6e 72 25>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d9 cc 5e 1d 28 c2 e1 60>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer d9 cc 5e 1d 28 c2 e1 60> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.49:57912',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200819
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47456
received auth hello!
{ authId: 402, nonce: <Buffer ea e8 27 13 55 0c a5 88> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 16 19 94 fc 8a 69 07 5c>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 60 b1 0e 00 f6 d8 1b 14>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 60 b1 0e 00 f6 d8 1b 14> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.49:58182',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200826
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47726
received auth hello!
{ authId: 402, nonce: <Buffer 15 cc f9 49 c3 79 e9 f6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 62 4c 22 29 ec b8 7a f5>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 46 50 e3 ce cb b3 72 40>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 46 50 e3 ce cb b3 72 40> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.49:58452',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
