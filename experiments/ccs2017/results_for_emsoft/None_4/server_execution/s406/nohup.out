changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s406.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's406',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 33 6c ... > }
Handler: listening on port 22100
s406:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200778
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50150
received auth hello!
{ authId: 402, nonce: <Buffer 95 3d 16 82 57 41 30 67> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer b6 39 c2 59 88 da 46 26>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 31 34 c7 17 db 33 0b 2c cf 07 3f 35 b1 9f ce a5>,
  macKeyVal: <Buffer c7 7f 9f 58 27 eb 0d c4 25 68 0a f1 7b 57 53 8f 33 76 de cb e6 41 f8 ae 3a 38 ef ef 63 f9 4f ec>,
  absValidity: 2018-03-22T00:19:06.312Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b8 53 dc 19 d7 f5 f2 bc>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b8 53 dc 19 d7 f5 f2 bc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.50:36766',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200785
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50306
received auth hello!
{ authId: 402, nonce: <Buffer 2c 43 ec 6c 6c c3 45 51> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e0 90 7e 7b fb a8 dd c5>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8a 15 a8 db 21 ca e6 57>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8a 15 a8 db 21 ca e6 57> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.50:36922',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200792
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50568
received auth hello!
{ authId: 402, nonce: <Buffer 4d ec 8b 02 6d 97 b1 b4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a8 f9 58 1e 1c 5d 74 48>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4f b1 31 ec c8 dd 6f 9f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4f b1 31 ec c8 dd 6f 9f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.50:37184',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200799
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50838
received auth hello!
{ authId: 402, nonce: <Buffer ea 2d 0d f7 47 59 18 9f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6b 86 43 5a 9e 14 86 3e>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer aa a2 cf 73 66 e9 8f f1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer aa a2 cf 73 66 e9 8f f1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.50:37454',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200806
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51108
received auth hello!
{ authId: 402, nonce: <Buffer cd 96 8d 07 c6 42 5d 15> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 99 26 0b a5 02 70 0f 5d>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ac 5f df d2 05 ee 72 32>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ac 5f df d2 05 ee 72 32> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.50:37724',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200813
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51378
received auth hello!
{ authId: 402, nonce: <Buffer 9f ac b6 ad f6 f3 75 be> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 79 2a 91 f8 cb aa f9 97>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1b d6 04 73 66 4b be 0c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1b d6 04 73 66 4b be 0c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.50:37994',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200820
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51648
received auth hello!
{ authId: 402, nonce: <Buffer 1f f4 2f 5f c0 19 fd de> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f0 8f 3b 69 91 12 3a 3c>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5b eb f0 77 68 2a ff e9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5b eb f0 77 68 2a ff e9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.50:38264',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200827
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51918
received auth hello!
{ authId: 402, nonce: <Buffer 86 e0 15 cd a7 3a fc 2d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2b 4f c1 75 1a cb 1d cb>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 48 f0 fb 8f df e0 8d dc>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 48 f0 fb 8f df e0 8d dc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.50:38534',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
