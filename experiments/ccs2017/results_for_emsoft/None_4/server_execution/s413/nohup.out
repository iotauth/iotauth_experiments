changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s413.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's413',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 76 77 ... > }
Handler: listening on port 22100
s413:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301243
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39398
received auth hello!
{ authId: 403, nonce: <Buffer dd 79 56 13 ee 78 ba a6> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 5e 7b a7 6c f2 88 52 ee>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 82 e7 4c cf 41 3c 6c 41 c9 01 ce 99 aa 14 27 31>,
  macKeyVal: <Buffer cb 71 6f d2 b2 a7 d2 29 b1 91 9d a2 31 c5 99 30 05 79 87 3b bd 07 66 00 35 f4 ef cf c5 5f ad f4>,
  absValidity: 2018-03-22T00:19:32.436Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a8 90 b3 20 23 3d db 83>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a8 90 b3 20 23 3d db 83> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.58:46258',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301249
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39602
received auth hello!
{ authId: 403, nonce: <Buffer 43 62 62 65 8e 6a a3 28> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f8 d4 fa 39 ff ee ca 06>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ec 48 04 f3 f6 70 03 5c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ec 48 04 f3 f6 70 03 5c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.58:46462',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301255
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39874
received auth hello!
{ authId: 403, nonce: <Buffer bc 77 e8 f9 1a bd 2f 12> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 06 14 56 75 07 73 bc ad>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 32 11 e5 14 06 0e 36 b9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 32 11 e5 14 06 0e 36 b9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.58:46734',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301261
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40144
received auth hello!
{ authId: 403, nonce: <Buffer e2 cb 7e 8f a4 5a 22 b5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cc f3 6e 3f 20 2f 00 bf>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2a 51 08 a6 db 02 f2 eb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2a 51 08 a6 db 02 f2 eb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.58:47004',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301267
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40414
received auth hello!
{ authId: 403, nonce: <Buffer 0a ca 63 c6 2b 95 74 0a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d7 85 76 0f 68 8c 3b b1>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3e 27 21 3b 3e 1e bf 99>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3e 27 21 3b 3e 1e bf 99> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.58:47274',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301273
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40684
received auth hello!
{ authId: 403, nonce: <Buffer 0a 1b 9d cc 5a be 35 7b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 25 5d 50 64 2a ed 2f c7>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fe ff d9 43 13 5f c1 e3>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer fe ff d9 43 13 5f c1 e3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.58:47544',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301279
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40954
received auth hello!
{ authId: 403, nonce: <Buffer 0d 4e b1 3c cf 53 d5 6b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5a 6e 68 fd 96 30 f4 ba>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 69 43 bf 53 4a 4a 6b 40>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 69 43 bf 53 4a 4a 6b 40> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.58:47814',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301285
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41216
received auth hello!
{ authId: 403, nonce: <Buffer 30 c8 0b 53 04 29 40 8e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9e 40 9c e9 47 80 ac 0c>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5e 10 30 6d 16 0e 26 0d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 5e 10 30 6d 16 0e 26 0d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.58:48076',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
