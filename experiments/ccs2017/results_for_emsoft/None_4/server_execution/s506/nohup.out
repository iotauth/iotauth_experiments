changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s506.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's506',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 37 56 ... > }
Handler: listening on port 22100
s506:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101208
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35980
received auth hello!
{ authId: 501, nonce: <Buffer 61 b5 a8 54 9d a5 93 77> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 9b 90 a0 91 16 32 ab 24>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer bf 2c 94 fb d3 82 69 37 6f fc ff c9 c9 6b 36 7c>,
  macKeyVal: <Buffer eb c5 c0 70 28 1c 81 c7 7a 49 95 8c 7d aa ee 72 78 6e 34 66 b6 23 ee 99 e0 2f 31 72 8e b5 6c 37>,
  absValidity: 2018-03-22T00:20:12.519Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d9 be f8 6b d9 68 e3 b7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d9 be f8 6b d9 68 e3 b7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.70:46110',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101216
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36252
received auth hello!
{ authId: 501, nonce: <Buffer 0e 33 c6 2e 6e 79 64 54> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3b 1f 43 11 93 97 83 b3>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 04 0a 0f 16 84 9a 67 32>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 04 0a 0f 16 84 9a 67 32> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.70:46382',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101224
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36518
received auth hello!
{ authId: 501, nonce: <Buffer 64 be e9 4d e2 ac 10 81> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c9 7d 0c f2 d7 88 1c cb>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d0 be 40 b2 e9 26 79 5d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d0 be 40 b2 e9 26 79 5d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.70:46648',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101232
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36788
received auth hello!
{ authId: 501, nonce: <Buffer 8f 1d 2c d8 40 f2 3d e3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bf 02 90 4b f1 05 f7 7b>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 54 2a da ce b1 4d 1b 56>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 54 2a da ce b1 4d 1b 56> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.70:46918',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101240
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37062
received auth hello!
{ authId: 501, nonce: <Buffer 47 b5 a5 9a 8c 93 17 bc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9f 2b 5a 31 f4 b8 ae 44>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f2 4c 52 8c b7 24 af 4b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f2 4c 52 8c b7 24 af 4b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.70:47192',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101248
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37332
received auth hello!
{ authId: 501, nonce: <Buffer 43 04 46 e2 24 85 d3 1a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b7 9f f5 d4 37 48 64 30>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 76 87 99 d7 d2 0d 79 7b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 76 87 99 d7 d2 0d 79 7b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.70:47462',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101256
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37598
received auth hello!
{ authId: 501, nonce: <Buffer 7a e0 2f e6 28 5e e6 88> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d3 71 1b 71 6b 95 7a 81>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4a db b6 29 72 6e 76 17>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4a db b6 29 72 6e 76 17> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.70:47728',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
