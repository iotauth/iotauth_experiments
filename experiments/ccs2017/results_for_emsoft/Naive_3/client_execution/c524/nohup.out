changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c524.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c524',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 71 67 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521572530878
connected to auth! from local port 47036
received auth hello!
{ authId: 504, nonce: <Buffer 50 a5 20 bb 43 f1 72 da> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 2a 5c a9 19 46 07 3b 8b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 3c 52 fe 25 3b 3c 05 45 12 83 c8 f5 2f 63 37 73>,
  macKeyVal: <Buffer 91 02 35 ee 01 20 99 89 73 11 60 a3 17 75 4d 01 94 aa 2b 9e 6a 63 88 42 bb a4 89 e5 88 d5 15 71>,
  absValidity: 2018-03-20T20:02:14.438Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400079,
  cipherKeyVal: <Buffer 79 d3 c1 bc 9d 47 44 0c b2 83 d4 40 8f 69 d9 e1>,
  macKeyVal: <Buffer ea 91 e6 f0 51 ad 90 06 71 a6 ad cd 80 8d e2 60 ce 39 41 53 5b 8c 33 cc b7 1b 5c 48 35 39 d0 45>,
  absValidity: 2018-03-21T19:02:14.438Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50400079,
     cipherKeyVal: <Buffer 79 d3 c1 bc 9d 47 44 0c b2 83 d4 40 8f 69 d9 e1>,
     macKeyVal: <Buffer ea 91 e6 f0 51 ad 90 06 71 a6 ad cd 80 8d e2 60 ce 39 41 53 5b 8c 33 cc b7 1b 5c 48 35 39 d0 45>,
     absValidity: 2018-03-21T19:02:14.438Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 7b 48 0e ce b9 a6 06 a0>
switching to HANDSHAKE_1_SENT
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:02:18 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521572539351
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521572590926
connected to auth! from local port 47306
received auth hello!
{ authId: 504, nonce: <Buffer 87 63 ee bb 77 7d 43 a3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f8 19 37 43 d8 ee ee ac>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400085,
  cipherKeyVal: <Buffer d7 f3 88 fd 20 24 92 b5 65 ba 51 f8 7f 4e 3b a5>,
  macKeyVal: <Buffer a6 4e 85 e2 45 04 88 c5 fa 50 4d fa b5 ad 11 5d 1e e9 5e 86 f5 4e e8 79 1b e7 f9 71 e8 f2 04 ef>,
  absValidity: 2018-03-21T19:03:14.523Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50400085,
     cipherKeyVal: <Buffer d7 f3 88 fd 20 24 92 b5 65 ba 51 f8 7f 4e 3b a5>,
     macKeyVal: <Buffer a6 4e 85 e2 45 04 88 c5 fa 50 4d fa b5 ad 11 5d 1e e9 5e 86 f5 4e e8 79 1b e7 f9 71 e8 f2 04 ef>,
     absValidity: 2018-03-21T19:03:14.523Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer a2 39 11 74 b3 c4 5f b1>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:03:18 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521572599472
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521572650979
connected to auth! from local port 47578
received auth hello!
{ authId: 504, nonce: <Buffer ab a5 f2 c2 07 53 41 0b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer dc ba 52 1a 05 22 ad 20>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400091,
  cipherKeyVal: <Buffer 80 97 4f 16 4b d7 f5 95 45 00 ea 1e 36 af 37 e5>,
  macKeyVal: <Buffer 3a 19 2b 15 7e 74 eb 86 7c 49 64 94 e8 9b ea cd e9 47 4d e6 e3 3e c8 23 4f 3d 89 c0 0d 30 91 b1>,
  absValidity: 2018-03-21T19:04:13.970Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50400091,
     cipherKeyVal: <Buffer 80 97 4f 16 4b d7 f5 95 45 00 ea 1e 36 af 37 e5>,
     macKeyVal: <Buffer 3a 19 2b 15 7e 74 eb 86 7c 49 64 94 e8 9b ea cd e9 47 4d e6 e3 3e c8 23 4f 3d 89 c0 0d 30 91 b1>,
     absValidity: 2018-03-21T19:04:13.970Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 6a d1 07 3f 36 08 70 e5>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:04:18 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521572658947
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521572711031
connected to auth! from local port 47846
received auth hello!
{ authId: 504, nonce: <Buffer 79 73 7c 13 9a dd 3e 9d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6d 83 d6 7b 9e 50 86 b5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400097,
  cipherKeyVal: <Buffer 37 d1 f3 38 59 da ff 4a d9 70 10 13 a0 0d 52 60>,
  macKeyVal: <Buffer a6 e1 4b 8f 36 8f 28 b5 85 bd a0 c5 18 5f 07 07 15 fb 46 ca 3d c7 c3 1f 70 2e 45 c1 72 5b 92 59>,
  absValidity: 2018-03-21T19:05:14.543Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50400097,
     cipherKeyVal: <Buffer 37 d1 f3 38 59 da ff 4a d9 70 10 13 a0 0d 52 60>,
     macKeyVal: <Buffer a6 e1 4b 8f 36 8f 28 b5 85 bd a0 c5 18 5f 07 07 15 fb 46 ca 3d c7 c3 1f 70 2e 45 c1 72 5b 92 59>,
     absValidity: 2018-03-21T19:05:14.543Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer a6 74 71 3e 0f ac 92 fb>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:05:18 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521572719519
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521572771055
connected to auth! from local port 48118
received auth hello!
{ authId: 504, nonce: <Buffer 65 80 52 62 93 3e f6 6e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 54 c9 a7 e9 fb 55 9c 43>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400103,
  cipherKeyVal: <Buffer 18 cf 91 cb e5 0c 73 5b 36 ed bc 37 cf ad fe d5>,
  macKeyVal: <Buffer 4d 12 83 75 75 91 e2 f0 8f f6 b8 80 cf fb a0 5c f7 58 9c 10 e5 ca a9 36 d0 f4 60 05 f8 fb da 4f>,
  absValidity: 2018-03-21T19:06:14.700Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50400103,
     cipherKeyVal: <Buffer 18 cf 91 cb e5 0c 73 5b 36 ed bc 37 cf ad fe d5>,
     macKeyVal: <Buffer 4d 12 83 75 75 91 e2 f0 8f f6 b8 80 cf fb a0 5c f7 58 9c 10 e5 ca a9 36 d0 f4 60 05 f8 fb da 4f>,
     absValidity: 2018-03-21T19:06:14.700Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 82 b3 c1 31 fb 35 3c 9b>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:06:19 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521572779737
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521572831065
connected to auth! from local port 48388
received auth hello!
{ authId: 504, nonce: <Buffer 16 e4 16 69 57 78 78 4a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fc 17 56 16 de d3 6e 37>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400109,
  cipherKeyVal: <Buffer 5d bf 32 57 c6 c2 3b a4 d3 6d ca aa 93 93 22 ad>,
  macKeyVal: <Buffer 28 4c a6 22 71 3b 38 7c dd 8b 31 b7 b5 fa 0e 27 ed 69 c6 4c 06 8b 67 78 c0 58 03 44 7f 60 18 23>,
  absValidity: 2018-03-21T19:07:14.744Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50400109,
     cipherKeyVal: <Buffer 5d bf 32 57 c6 c2 3b a4 d3 6d ca aa 93 93 22 ad>,
     macKeyVal: <Buffer 28 4c a6 22 71 3b 38 7c dd 8b 31 b7 b5 fa 0e 27 ed 69 c6 4c 06 8b 67 78 c0 58 03 44 7f 60 18 23>,
     absValidity: 2018-03-21T19:07:14.744Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 61 b1 3d 76 9e 14 db 2c>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:07:22 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521572843326
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521572891101
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 8 0.75 1521572951109
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 35388
received auth hello!
{ authId: 503, nonce: <Buffer 7a 0e a0 ed 55 31 df fd> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 9 0.6666666666666666 1521573011120
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 35612
received auth hello!
{ authId: 503, nonce: <Buffer 16 27 98 e3 a1 8d 0e 0d> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 10 0.6 1521573071130
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 43230
received auth hello!
{ authId: 403, nonce: <Buffer 11 bb e4 d4 c1 ef 00 70> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 11 0.5454545454545454 1521573131137
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 43474
received auth hello!
{ authId: 403, nonce: <Buffer 05 a2 31 51 53 0c 81 ce> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 12 0.5 1521573191140
failure in connection with Auth : authFailureCount: 6
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 60024
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 13 0.46153846153846156 1521573251148
failure in connection with Auth : authFailureCount: 7
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 60294
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 14 0.42857142857142855 1521573311155
failure in connection with Auth : authFailureCount: 8
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 2
to: 3
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 15 0.4 1521573371162
failure in connection with Auth : authFailureCount: 9
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 3
to: 4
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.2:21100
/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902
            eventHandlers.onError('Error occurred in migration request: Disconnected from auth before getting migration response: ' + error);
                                                                                                                                      ^

ReferenceError: error is not defined
    at Socket.<anonymous> (/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902:135)
    at emitNone (events.js:91:20)
    at Socket.emit (events.js:188:7)
    at endReadableNT (_stream_readable.js:975:12)
    at _combinedTickCallback (internal/process/next_tick.js:80:11)
    at process._tickCallback (internal/process/next_tick.js:104:9)
