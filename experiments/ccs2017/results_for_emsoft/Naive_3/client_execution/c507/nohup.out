changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c507.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c507',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 6e 39 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521572475006
connected to auth! from local port 52140
received auth hello!
{ authId: 501, nonce: <Buffer 88 62 a8 8a b2 33 8d 16> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 04 f8 ca fa c2 e4 b4 99>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer d9 fa 61 b0 3c 90 02 d0 f6 fb 98 5c ce 54 30 d7>,
  macKeyVal: <Buffer 23 26 5d ee cf fc 8b b4 6c 8b 68 40 b2 1d 87 0f af bc 90 c8 88 c2 29 b4 ed 4b b8 d0 f9 e4 bb e6>,
  absValidity: 2018-03-20T20:01:15.186Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100446,
  cipherKeyVal: <Buffer ce 05 3e d7 73 f5 9b f1 b6 37 a3 b0 42 6f 56 d8>,
  macKeyVal: <Buffer b4 89 ca fa 1a bf 6d 27 27 06 7c 9d 8b 6f c1 87 17 f3 03 c9 51 85 d5 f1 82 13 26 13 fb fb e0 19>,
  absValidity: 2018-03-21T19:01:15.186Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100446,
     cipherKeyVal: <Buffer ce 05 3e d7 73 f5 9b f1 b6 37 a3 b0 42 6f 56 d8>,
     macKeyVal: <Buffer b4 89 ca fa 1a bf 6d 27 27 06 7c 9d 8b 6f c1 87 17 f3 03 c9 51 85 d5 f1 82 13 26 13 fb fb e0 19>,
     absValidity: 2018-03-21T19:01:15.186Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer ff 81 50 16 e4 a1 8d 3e>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:01:15 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521572476023
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521572535062
connected to auth! from local port 52400
received auth hello!
{ authId: 501, nonce: <Buffer 51 5b 08 f9 75 d8 6e 87> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 47 22 e7 26 c6 bc a3 2e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100454,
  cipherKeyVal: <Buffer f5 82 b2 7b fd 13 b2 26 6a e6 da c9 5f 26 01 fc>,
  macKeyVal: <Buffer 84 b7 e4 c8 55 c7 7b b4 9e 08 60 fd 11 df 57 09 4e 8a 3d e0 77 8e 86 a6 ef 5a 6a 74 23 f7 e9 05>,
  absValidity: 2018-03-21T19:02:15.195Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100454,
     cipherKeyVal: <Buffer f5 82 b2 7b fd 13 b2 26 6a e6 da c9 5f 26 01 fc>,
     macKeyVal: <Buffer 84 b7 e4 c8 55 c7 7b b4 9e 08 60 fd 11 df 57 09 4e 8a 3d e0 77 8e 86 a6 ef 5a 6a 74 23 f7 e9 05>,
     absValidity: 2018-03-21T19:02:15.195Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer c8 1d 78 b2 ed c6 f8 a4>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:02:15 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521572535993
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521572595117
connected to auth! from local port 52670
received auth hello!
{ authId: 501, nonce: <Buffer a9 6b fa f2 5d 5b 69 e8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 77 1b 63 5e 59 94 00 ec>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100462,
  cipherKeyVal: <Buffer cd a8 2f af be 3b ee a5 ad 65 d3 11 b1 d2 ae ba>,
  macKeyVal: <Buffer 1d 2b d2 0a 5d 2a 18 dc 4c 2c 33 e5 23 8e 6e ce a0 49 f4 67 fb 3d 1d f7 da 61 e1 d2 37 4a a0 53>,
  absValidity: 2018-03-21T19:03:15.349Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100462,
     cipherKeyVal: <Buffer cd a8 2f af be 3b ee a5 ad 65 d3 11 b1 d2 ae ba>,
     macKeyVal: <Buffer 1d 2b d2 0a 5d 2a 18 dc 4c 2c 33 e5 23 8e 6e ce a0 49 f4 67 fb 3d 1d f7 da 61 e1 d2 37 4a a0 53>,
     absValidity: 2018-03-21T19:03:15.349Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 73 71 46 77 c6 13 fb 82>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:03:16 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521572596343
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521572655173
connected to auth! from local port 52940
received auth hello!
{ authId: 501, nonce: <Buffer d6 bb 6e 64 cf b8 e5 04> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 18 b8 64 ae 16 fc 4e 7f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100470,
  cipherKeyVal: <Buffer c2 16 9e f0 68 f5 e5 71 c9 61 8d 90 28 92 9c 59>,
  macKeyVal: <Buffer 02 92 10 3a bf 60 29 85 79 84 bd 16 11 fc 79 0c 29 c4 dc 42 52 b7 7f 85 33 9b aa 6a d2 cc fa 55>,
  absValidity: 2018-03-21T19:04:15.364Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100470,
     cipherKeyVal: <Buffer c2 16 9e f0 68 f5 e5 71 c9 61 8d 90 28 92 9c 59>,
     macKeyVal: <Buffer 02 92 10 3a bf 60 29 85 79 84 bd 16 11 fc 79 0c 29 c4 dc 42 52 b7 7f 85 33 9b aa 6a d2 cc fa 55>,
     absValidity: 2018-03-21T19:04:15.364Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer ee 93 6c ed f5 85 2d aa>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:04:15 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521572656260
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521572715229
connected to auth! from local port 53210
received auth hello!
{ authId: 501, nonce: <Buffer 7e 88 a3 3c 48 f8 5e 40> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer af 05 52 bc f3 04 f9 09>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100478,
  cipherKeyVal: <Buffer f3 ed 78 66 68 de 63 2b 38 05 b0 58 76 b0 32 b0>,
  macKeyVal: <Buffer 71 3e 67 ed 21 a9 f6 bf 09 ad e8 8e 9a f8 f9 a0 85 c5 32 9d e0 10 11 3a 3a b0 53 ce 1f 8c 8c 72>,
  absValidity: 2018-03-21T19:05:15.390Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100478,
     cipherKeyVal: <Buffer f3 ed 78 66 68 de 63 2b 38 05 b0 58 76 b0 32 b0>,
     macKeyVal: <Buffer 71 3e 67 ed 21 a9 f6 bf 09 ad e8 8e 9a f8 f9 a0 85 c5 32 9d e0 10 11 3a 3a b0 53 ce 1f 8c 8c 72>,
     absValidity: 2018-03-21T19:05:15.390Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer dc 86 02 97 f3 59 e4 21>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:05:15 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521572716263
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521572775285
connected to auth! from local port 53480
received auth hello!
{ authId: 501, nonce: <Buffer 6e 13 33 7f 8a 49 27 30> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 25 16 8d 8c 51 68 a9 5e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100486,
  cipherKeyVal: <Buffer 43 9f 5f a0 90 18 a5 c8 33 f7 9a 6d 19 6c e9 80>,
  macKeyVal: <Buffer be 18 38 bd cd fb e3 03 11 54 2b 27 31 09 18 44 64 31 92 7d 16 67 6a bd f8 97 d7 48 90 8c d8 32>,
  absValidity: 2018-03-21T19:06:15.479Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100486,
     cipherKeyVal: <Buffer 43 9f 5f a0 90 18 a5 c8 33 f7 9a 6d 19 6c e9 80>,
     macKeyVal: <Buffer be 18 38 bd cd fb e3 03 11 54 2b 27 31 09 18 44 64 31 92 7d 16 67 6a bd f8 97 d7 48 90 8c d8 32>,
     absValidity: 2018-03-21T19:06:15.479Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 7e 7d 46 9d 7d 05 fd 3f>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:06:16 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521572776337
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521572835334
connected to auth! from local port 53750
received auth hello!
{ authId: 501, nonce: <Buffer ec 37 e2 cf 20 01 59 7a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ee 83 96 21 f5 c1 bc 6e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100494,
  cipherKeyVal: <Buffer e3 8a db 36 a2 75 e0 9f 92 8e 45 9e 49 5a aa c5>,
  macKeyVal: <Buffer 7e da 58 18 d9 79 ad 87 f5 a8 b9 c3 48 7b 87 4e 7e 99 b4 45 05 a1 fd 39 4f 1e 01 89 46 c8 29 aa>,
  absValidity: 2018-03-21T19:07:15.466Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100494,
     cipherKeyVal: <Buffer e3 8a db 36 a2 75 e0 9f 92 8e 45 9e 49 5a aa c5>,
     macKeyVal: <Buffer 7e da 58 18 d9 79 ad 87 f5 a8 b9 c3 48 7b 87 4e 7e 99 b4 45 05 a1 fd 39 4f 1e 01 89 46 c8 29 aa>,
     absValidity: 2018-03-21T19:07:15.466Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 2d 7d 39 fa 98 5d 48 1c>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:07:16 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521572836468
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521572895394
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 9 0.7777777777777778 1521572955404
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 46914
received auth hello!
{ authId: 401, nonce: <Buffer d8 52 71 70 16 4b 38 3d> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 10 0.7 1521573015413
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 47146
received auth hello!
{ authId: 401, nonce: <Buffer 95 de 57 30 81 91 cc f0> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 11 0.6363636363636364 1521573075421
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 12 0.5833333333333334 1521573135429
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 37146
received auth hello!
{ authId: 502, nonce: <Buffer 16 e5 95 62 33 8e f8 7f> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '016244C731B0',
  notBefore: 2018-03-20T18:57:07.000Z,
  notAfter: 2018-03-21T18:58:47.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '93:7A:A1:94:F3:58:54:82:C2:CB:99:F0:13:9C:F6:6B:66:B8:99:CC',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'E40B9EF20959AA49D02016EC2E9896074EE0818689EAD7319ECC8ED8C9557412ED46C95E67464598F6233ECEB8BF25A876F0D30B65CED2B1FED8D1F07CF9042FD7F86E3B637BE17FBFD7C9F0DB5850835170B354A52C175B769A37BA578F965436FF29BCFD54C5D4E939E02214503C8A69FFBBF0EC06657DF9498BE98DEB26B62E1453817F6DFAE9B50EE21C5A643FF0292539838A682562303CB77FC6028B22B30B78957E4F78E539103F991928681EBF3100D31960F43F8ECFC6C2F3063B353E92BFFEF77A49BBCBF417864AE8169AA061F590E5FB3393A4592EFA1100FC186B95B83724CA0B11D8BC02BC9BD4F9E08552DE2D1EB0EE0E866E41A520730E6F',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJExzGwMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDMy\nMDE4NTcwN1oXDTE4MDMyMTE4NTg0N1owYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDkC57yCVmqSdAgFuwumJYHTuCBhonq1zGezI7YyVV0Eu1GyV5n\nRkWY9iM+zri/Jah28NMLZc7Ssf7Y0fB8+QQv1/huO2N74X+/18nw21hQg1Fws1Sl\nLBdbdpo3ulePllQ2/ym8/VTF1Ok54CIUUDyKaf+78OwGZX35SYvpjesmti4UU4F/\nbfrptQ7iHFpkP/ApJTmDimglYjA8t3/GAosiswt4lX5PeOU5ED+ZGShoHr8xANMZ\nYPQ/js/GwvMGOzU+kr/+93pJu8v0F4ZK6BaaoGH1kOX7M5OkWS76EQD8GGuVuDck\nygsR2LwCvJvU+eCFUt4tHrDuDoZuQaUgcw5vAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAIpAd3VKIQtsOp7Gd/n+U5dQGb1TbSuD\nNQk/HKl8/HzsGeRYEr03C8HMvU65HMRGtBcvzOn2KwcEgiT/9coa+YDtK1xJybhH\nPIloSWRq7NaoE4bYMp+gpRLUhZsV1RmMwFkEgfdjdkzZhQvtC11azkYH1d9yofSK\nAMxR5ZIFMXeAjAqYWVVQZUbCBD+RI7C4tf9TN22n7l8a+LemH6KutXlo2GAcWQVL\ng0GYJeMdzdZd09xIAX5ufxOwpz3QVVJ7nADmjQyVvdhsMoWseoRVmIEVNZ4KF2ow\n+L8v+Z191H3ur6zYAo38yWRpih+c8FR93Izsktw3ACeFXHA5Oyh9k+o=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 2
to: 3
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 13 0.5384615384615384 1521573195439
connected to auth! from local port 37378
received auth hello!
{ authId: 502, nonce: <Buffer 95 37 73 a1 e1 75 c6 02> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer a8 64 c5 29 a9 37 68 d8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 69 0d f6 23 25 42 5e 89 a3 2a 04 52 77 f7 83 61>,
  macKeyVal: <Buffer ff 85 05 35 77 03 fd 8c 29 86 08 13 8c 97 c5 fa ae d3 d0 2a 8d 00 89 67 83 1d e0 60 2f d6 60 54>,
  absValidity: 2018-03-20T20:13:15.611Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200481,
  cipherKeyVal: <Buffer 2e ab d5 62 43 9a ac 29 6e c1 69 6c 0c 77 63 fc>,
  macKeyVal: <Buffer b9 ca 75 22 dd e3 78 2e 53 9d 69 b3 93 da 45 4c 38 db a4 2b 7a 93 2f b3 e9 e5 60 40 cc 0c 98 6c>,
  absValidity: 2018-03-21T19:13:15.611Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200481,
     cipherKeyVal: <Buffer 2e ab d5 62 43 9a ac 29 6e c1 69 6c 0c 77 63 fc>,
     macKeyVal: <Buffer b9 ca 75 22 dd e3 78 2e 53 9d 69 b3 93 da 45 4c 38 db a4 2b 7a 93 2f b3 e9 e5 60 40 cc 0c 98 6c>,
     absValidity: 2018-03-21T19:13:15.611Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 2e f3 6b e2 3d f0 ca 02>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.28:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 14 0.5 1521573255450
connected to auth! from local port 37648
received auth hello!
{ authId: 502, nonce: <Buffer 52 0a 78 7f 48 4a b6 41> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6d 56 d6 1a db b0 36 0e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200496,
  cipherKeyVal: <Buffer 66 95 b5 3e 0c 04 c5 09 de a4 bc 98 8d 6b 45 fb>,
  macKeyVal: <Buffer e1 c1 6f 47 52 2d 20 08 5e 55 99 72 2a 86 3a d4 ef a9 f3 37 d3 dc 02 99 df 9d 0d d5 4a 2d 82 a8>,
  absValidity: 2018-03-21T19:14:15.595Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200496,
     cipherKeyVal: <Buffer 66 95 b5 3e 0c 04 c5 09 de a4 bc 98 8d 6b 45 fb>,
     macKeyVal: <Buffer e1 c1 6f 47 52 2d 20 08 5e 55 99 72 2a 86 3a d4 ef a9 f3 37 d3 dc 02 99 df 9d 0d d5 4a 2d 82 a8>,
     absValidity: 2018-03-21T19:14:15.595Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 71 b8 b8 b3 89 17 68 32>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.28:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 15 0.4666666666666667 1521573315459
connected to auth! from local port 37922
received auth hello!
{ authId: 502, nonce: <Buffer 4c e9 21 ec 6c 18 52 da> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 45 03 84 09 55 0d 4b 13>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200511,
  cipherKeyVal: <Buffer c1 48 b0 da 12 17 7d cf e8 6a 33 05 77 fe ee bf>,
  macKeyVal: <Buffer 17 40 25 9b 22 c2 0d 78 cf df 6b 87 13 18 14 71 2d 35 36 a9 83 c6 1b 31 ff 8a c3 4e 90 1c 66 aa>,
  absValidity: 2018-03-21T19:15:15.644Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200511,
     cipherKeyVal: <Buffer c1 48 b0 da 12 17 7d cf e8 6a 33 05 77 fe ee bf>,
     macKeyVal: <Buffer 17 40 25 9b 22 c2 0d 78 cf df 6b 87 13 18 14 71 2d 35 36 a9 83 c6 1b 31 ff 8a c3 4e 90 1c 66 aa>,
     absValidity: 2018-03-21T19:15:15.644Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 4b f8 92 d5 ae bf 01 11>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.28:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 16 0.4375 1521573375470
connected to auth! from local port 38190
received auth hello!
{ authId: 502, nonce: <Buffer 06 27 3d b2 07 2d 95 60> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 24 83 ca 26 41 7d be 8a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200526,
  cipherKeyVal: <Buffer ab 31 bb 74 4b 84 a8 1a 80 dd e2 47 fb 32 7e 11>,
  macKeyVal: <Buffer e3 2a 07 bd 0c ad ab 88 45 ca b9 4f e6 d1 6f 04 54 d4 43 03 01 2a e1 6e 7e 70 ce 9e c5 7b b3 9c>,
  absValidity: 2018-03-21T19:16:15.636Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200526,
     cipherKeyVal: <Buffer ab 31 bb 74 4b 84 a8 1a 80 dd e2 47 fb 32 7e 11>,
     macKeyVal: <Buffer e3 2a 07 bd 0c ad ab 88 45 ca b9 4f e6 d1 6f 04 54 d4 43 03 01 2a e1 6e 7e 70 ce 9e c5 7b b3 9c>,
     absValidity: 2018-03-21T19:16:15.636Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 67 55 ba 53 8b a7 2d c5>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.28:undefined
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 17 0.4117647058823529 1521573435479
connected to auth! from local port 38448
received auth hello!
{ authId: 502, nonce: <Buffer fd 97 60 44 fb 03 c4 30> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ef 1b df ef 54 ac 94 dd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200541,
  cipherKeyVal: <Buffer 3b 68 dc 2c 65 6f 9c b4 3f 6a 6a 1f 17 70 2f 5e>,
  macKeyVal: <Buffer 9d 08 76 ed af 3a 14 56 fe 86 27 27 16 2a 32 cd e0 ae e0 96 ef 07 45 06 66 d3 24 3c ec 2c d6 26>,
  absValidity: 2018-03-21T19:17:15.621Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200541,
     cipherKeyVal: <Buffer 3b 68 dc 2c 65 6f 9c b4 3f 6a 6a 1f 17 70 2f 5e>,
     macKeyVal: <Buffer 9d 08 76 ed af 3a 14 56 fe 86 27 27 16 2a 32 cd e0 ae e0 96 ef 07 45 06 66 d3 24 3c ec 2c d6 26>,
     absValidity: 2018-03-21T19:17:15.621Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 18 0.3888888888888889 1521573495540
connected to auth! from local port 38684
received auth hello!
{ authId: 502, nonce: <Buffer b3 90 e9 c6 9c 52 a5 79> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fe 92 11 6c 1c 7e 9d 10>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200556,
  cipherKeyVal: <Buffer 77 b4 e6 53 9d a7 38 f6 f6 a1 50 8b 94 6a 25 a9>,
  macKeyVal: <Buffer 14 9a c3 39 35 33 b7 8d d8 48 3e bb 45 b2 e7 3e 7c d4 0f 88 c3 33 d0 33 e4 13 d1 1a c7 b2 66 76>,
  absValidity: 2018-03-21T19:18:15.701Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200556,
     cipherKeyVal: <Buffer 77 b4 e6 53 9d a7 38 f6 f6 a1 50 8b 94 6a 25 a9>,
     macKeyVal: <Buffer 14 9a c3 39 35 33 b7 8d d8 48 3e bb 45 b2 e7 3e 7c d4 0f 88 c3 33 d0 33 e4 13 d1 1a c7 b2 66 76>,
     absValidity: 2018-03-21T19:18:15.701Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 19 0.3684210526315789 1521573555597
connected to auth! from local port 38914
received auth hello!
{ authId: 502, nonce: <Buffer f0 21 03 3c 77 27 45 25> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b6 47 75 15 ad 8b 1a e1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200571,
  cipherKeyVal: <Buffer 14 c0 64 20 17 2a 87 56 06 26 50 3c f9 93 5f 2e>,
  macKeyVal: <Buffer 1f fe 87 28 d3 bf 5f 38 df 2e bb a6 3b 8e ac 42 06 35 ad c6 a9 17 5c c8 14 1a 45 88 db 4f a3 26>,
  absValidity: 2018-03-21T19:19:15.760Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200571,
     cipherKeyVal: <Buffer 14 c0 64 20 17 2a 87 56 06 26 50 3c f9 93 5f 2e>,
     macKeyVal: <Buffer 1f fe 87 28 d3 bf 5f 38 df 2e bb a6 3b 8e ac 42 06 35 ad c6 a9 17 5c c8 14 1a 45 88 db 4f a3 26>,
     absValidity: 2018-03-21T19:19:15.760Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 20 0.35 1521573615658
connected to auth! from local port 39138
received auth hello!
{ authId: 502, nonce: <Buffer 1f e7 d9 ac 51 06 f7 12> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e7 da 48 a9 10 5f 28 75>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200586,
  cipherKeyVal: <Buffer b7 88 b3 d7 1c e2 89 d9 16 b7 ab a8 d5 48 a2 1b>,
  macKeyVal: <Buffer 82 9f 0c a0 84 0e b7 56 c8 4a c8 f3 5e e0 b0 5c f6 86 2e de 83 1b cd aa 86 28 dc db ec fe 0a c3>,
  absValidity: 2018-03-21T19:20:15.855Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200586,
     cipherKeyVal: <Buffer b7 88 b3 d7 1c e2 89 d9 16 b7 ab a8 d5 48 a2 1b>,
     macKeyVal: <Buffer 82 9f 0c a0 84 0e b7 56 c8 4a c8 f3 5e e0 b0 5c f6 86 2e de 83 1b cd aa 86 28 dc db ec fe 0a c3>,
     absValidity: 2018-03-21T19:20:15.855Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 21 0.3333333333333333 1521573675663
connected to auth! from local port 39362
received auth hello!
{ authId: 502, nonce: <Buffer 4a 4e ff b5 0e 11 f1 5b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c2 c6 e2 61 7b df 62 08>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200601,
  cipherKeyVal: <Buffer 69 ae dd 44 0f a3 b8 47 7b b0 bf 62 76 9b 8d 45>,
  macKeyVal: <Buffer 88 ef ac c9 a2 3d ea 7c eb 31 3b c6 56 61 f4 be f0 74 7e 1c b3 b6 ff 18 3f 63 00 34 23 ae 70 8f>,
  absValidity: 2018-03-21T19:21:15.839Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200601,
     cipherKeyVal: <Buffer 69 ae dd 44 0f a3 b8 47 7b b0 bf 62 76 9b 8d 45>,
     macKeyVal: <Buffer 88 ef ac c9 a2 3d ea 7c eb 31 3b c6 56 61 f4 be f0 74 7e 1c b3 b6 ff 18 3f 63 00 34 23 ae 70 8f>,
     absValidity: 2018-03-21T19:21:15.839Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 22 0.3181818181818182 1521573735709
connected to auth! from local port 39588
received auth hello!
{ authId: 502, nonce: <Buffer 8e f7 c7 66 d8 b9 27 16> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 17 3b 71 08 a1 40 2f d5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200616,
  cipherKeyVal: <Buffer 28 1b ab 35 ce 40 a1 26 08 4b 32 ce de 0c 73 1b>,
  macKeyVal: <Buffer aa 2d ae 25 11 2d 70 8a 81 7b 22 42 68 e6 e4 cc bf 7b 78 d3 d6 79 77 69 02 31 7d d5 8c 59 0b 87>,
  absValidity: 2018-03-21T19:22:15.848Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200616,
     cipherKeyVal: <Buffer 28 1b ab 35 ce 40 a1 26 08 4b 32 ce de 0c 73 1b>,
     macKeyVal: <Buffer aa 2d ae 25 11 2d 70 8a 81 7b 22 42 68 e6 e4 cc bf 7b 78 d3 d6 79 77 69 02 31 7d d5 8c 59 0b 87>,
     absValidity: 2018-03-21T19:22:15.848Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 23 0.30434782608695654 1521573795710
connected to auth! from local port 39824
received auth hello!
{ authId: 502, nonce: <Buffer 23 eb a8 80 73 00 38 51> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 75 6d 16 ae 6b 2f 5c 46>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200631,
  cipherKeyVal: <Buffer 49 32 68 46 fe 24 42 e6 fd fb 37 6e 14 bf 76 4f>,
  macKeyVal: <Buffer 3d 45 a7 90 0a 27 76 b8 3f bc ac 38 7d 32 9b ab 2d 3e 89 6d 59 98 c9 d5 80 a0 7c 3f 35 40 6b 36>,
  absValidity: 2018-03-21T19:23:15.885Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200631,
     cipherKeyVal: <Buffer 49 32 68 46 fe 24 42 e6 fd fb 37 6e 14 bf 76 4f>,
     macKeyVal: <Buffer 3d 45 a7 90 0a 27 76 b8 3f bc ac 38 7d 32 9b ab 2d 3e 89 6d 59 98 c9 d5 80 a0 7c 3f 35 40 6b 36>,
     absValidity: 2018-03-21T19:23:15.885Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 24 0.2916666666666667 1521573855759
connected to auth! from local port 40060
received auth hello!
{ authId: 502, nonce: <Buffer 1b 83 a9 86 58 9e d7 d3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5b 77 a0 86 63 ea 6f 09>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200646,
  cipherKeyVal: <Buffer 91 09 34 11 28 cd 45 bc 2b ab b7 27 8f 43 e6 14>,
  macKeyVal: <Buffer 79 69 6e 52 24 ae a8 fc 62 a6 78 31 de e5 7b 0c 5d 6b f0 bf e8 3b a7 e5 01 1e 58 d3 00 ea 6e 4e>,
  absValidity: 2018-03-21T19:24:15.914Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200646,
     cipherKeyVal: <Buffer 91 09 34 11 28 cd 45 bc 2b ab b7 27 8f 43 e6 14>,
     macKeyVal: <Buffer 79 69 6e 52 24 ae a8 fc 62 a6 78 31 de e5 7b 0c 5d 6b f0 bf e8 3b a7 e5 01 1e 58 d3 00 ea 6e 4e>,
     absValidity: 2018-03-21T19:24:15.914Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 25 0.28 1521573915819
connected to auth! from local port 40298
received auth hello!
{ authId: 502, nonce: <Buffer 83 6f 65 e8 e1 d6 64 ed> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b1 8c e0 c4 c8 f0 33 6d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200661,
  cipherKeyVal: <Buffer c6 a7 06 8c 46 fd 7f e7 26 1a 20 06 59 23 fe 90>,
  macKeyVal: <Buffer b3 3b f3 77 52 6e cb 9e 5b 59 a3 f6 71 5a a5 d5 d4 34 67 7d ea 02 04 70 75 7b c7 32 5d c5 3b 13>,
  absValidity: 2018-03-21T19:25:16.070Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200661,
     cipherKeyVal: <Buffer c6 a7 06 8c 46 fd 7f e7 26 1a 20 06 59 23 fe 90>,
     macKeyVal: <Buffer b3 3b f3 77 52 6e cb 9e 5b 59 a3 f6 71 5a a5 d5 d4 34 67 7d ea 02 04 70 75 7b c7 32 5d c5 3b 13>,
     absValidity: 2018-03-21T19:25:16.070Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 26 0.2692307692307692 1521573975879
connected to auth! from local port 40524
received auth hello!
{ authId: 502, nonce: <Buffer 9c 3f f3 96 13 7e d0 7c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer dc aa cf ed c3 a4 ad be>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200676,
  cipherKeyVal: <Buffer 90 43 11 b9 03 97 0b f0 e8 7f 7f ef 4f 4a 0e ce>,
  macKeyVal: <Buffer 01 6e 4b ae f6 15 6a 41 07 07 e0 fb da ec 3d b9 98 cc b2 2f 85 fe ed 5f 6d e5 48 47 c6 e4 c2 81>,
  absValidity: 2018-03-21T19:26:16.057Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200676,
     cipherKeyVal: <Buffer 90 43 11 b9 03 97 0b f0 e8 7f 7f ef 4f 4a 0e ce>,
     macKeyVal: <Buffer 01 6e 4b ae f6 15 6a 41 07 07 e0 fb da ec 3d b9 98 cc b2 2f 85 fe ed 5f 6d e5 48 47 c6 e4 c2 81>,
     absValidity: 2018-03-21T19:26:16.057Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 27 0.25925925925925924 1521574035939
connected to auth! from local port 40750
received auth hello!
{ authId: 502, nonce: <Buffer af 74 59 17 e1 68 fe 44> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 39 c1 96 56 dd 04 0d b7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200691,
  cipherKeyVal: <Buffer ed 19 c4 f5 d7 40 f2 34 eb 66 6b 28 c5 af 50 80>,
  macKeyVal: <Buffer bd b2 91 fe 91 67 f6 9a bc 88 1d 58 ad 5e 89 33 e2 47 63 80 2b ea 05 42 c6 7a b3 02 0c 62 18 56>,
  absValidity: 2018-03-21T19:27:16.088Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200691,
     cipherKeyVal: <Buffer ed 19 c4 f5 d7 40 f2 34 eb 66 6b 28 c5 af 50 80>,
     macKeyVal: <Buffer bd b2 91 fe 91 67 f6 9a bc 88 1d 58 ad 5e 89 33 e2 47 63 80 2b ea 05 42 c6 7a b3 02 0c 62 18 56>,
     absValidity: 2018-03-21T19:27:16.088Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
