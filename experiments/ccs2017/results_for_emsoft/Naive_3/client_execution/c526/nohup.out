changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c526.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c526',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 34 6c ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521572537432
connected to auth! from local port 54930
received auth hello!
{ authId: 504, nonce: <Buffer 63 04 fe b3 fb 3a 33 42> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer b7 fd 5c 51 6a cd 4f 1f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer ea 1d 3f e9 02 e1 1d c0 b8 5f c8 eb da 08 12 cc>,
  macKeyVal: <Buffer 75 f1 60 de 58 c8 a6 d1 d4 d7 2e f2 be d9 7c 5d 81 e7 e3 1a 69 0d a4 c7 dd 44 11 36 17 37 67 be>,
  absValidity: 2018-03-20T20:02:20.849Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400081,
  cipherKeyVal: <Buffer 63 18 9e 21 0d da 0a b7 95 11 ba a6 64 7f 45 c2>,
  macKeyVal: <Buffer bf 52 20 a6 1c d5 d9 da 23 6f 35 cf 85 dd a9 36 33 87 0e 24 02 f2 7b 76 9e e5 a0 22 77 00 b9 1b>,
  absValidity: 2018-03-21T19:02:20.848Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50400081,
     cipherKeyVal: <Buffer 63 18 9e 21 0d da 0a b7 95 11 ba a6 64 7f 45 c2>,
     macKeyVal: <Buffer bf 52 20 a6 1c d5 d9 da 23 6f 35 cf 85 dd a9 36 33 87 0e 24 02 f2 7b 76 9e e5 a0 22 77 00 b9 1b>,
     absValidity: 2018-03-21T19:02:20.848Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 50 92 21 f2 62 e4 11 1e>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:02:24 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521572544980
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521572597482
connected to auth! from local port 55200
received auth hello!
{ authId: 504, nonce: <Buffer f2 23 bd 39 32 10 70 03> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 84 18 a9 2f 92 af 3c 6c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400087,
  cipherKeyVal: <Buffer e5 68 75 87 3a 12 2d 31 01 b0 94 3a a4 3d 65 40>,
  macKeyVal: <Buffer 66 9f 89 c8 a6 df 68 e0 d7 e8 f2 b0 aa cd 2b c0 c4 88 0b 15 8b 7a 70 9d 1f c9 d0 d4 9a d3 be 2f>,
  absValidity: 2018-03-21T19:03:20.842Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50400087,
     cipherKeyVal: <Buffer e5 68 75 87 3a 12 2d 31 01 b0 94 3a a4 3d 65 40>,
     macKeyVal: <Buffer 66 9f 89 c8 a6 df 68 e0 d7 e8 f2 b0 aa cd 2b c0 c4 88 0b 15 8b 7a 70 9d 1f c9 d0 d4 9a d3 be 2f>,
     absValidity: 2018-03-21T19:03:20.842Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer cc 67 13 a0 c9 9b 46 b9>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:03:24 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521572604791
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521572657533
connected to auth! from local port 55470
received auth hello!
{ authId: 504, nonce: <Buffer 08 64 fc c4 14 cb f2 f0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bb 4a a2 19 60 5d 3d 6c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400093,
  cipherKeyVal: <Buffer d0 66 7d a0 ae 77 e4 84 69 2c 9f 9c 2d 49 a0 c8>,
  macKeyVal: <Buffer 0a 0e 10 05 5d 1a 0d 85 e6 f7 db 55 10 fe 9b 05 80 2e 18 6e 54 c7 e2 30 7c eb e3 6a e2 91 4e 26>,
  absValidity: 2018-03-21T19:04:20.971Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50400093,
     cipherKeyVal: <Buffer d0 66 7d a0 ae 77 e4 84 69 2c 9f 9c 2d 49 a0 c8>,
     macKeyVal: <Buffer 0a 0e 10 05 5d 1a 0d 85 e6 f7 db 55 10 fe 9b 05 80 2e 18 6e 54 c7 e2 30 7c eb e3 6a e2 91 4e 26>,
     absValidity: 2018-03-21T19:04:20.971Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 1d 58 7c ec 7a 0c 2d 50>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:04:24 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521572664989
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521572717585
connected to auth! from local port 55740
received auth hello!
{ authId: 504, nonce: <Buffer 75 4a 75 44 a8 08 eb 96> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 76 ef 83 9e cc 75 3a 81>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400099,
  cipherKeyVal: <Buffer 96 95 ae b0 a0 91 40 f2 02 3c 60 12 eb 32 2c 52>,
  macKeyVal: <Buffer e5 3c f8 b6 c7 10 0a 0e 73 3e 5b 8b 82 30 24 51 af 97 e7 89 78 55 2d 29 2d dd db d9 ba ac ef 8d>,
  absValidity: 2018-03-21T19:05:20.977Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50400099,
     cipherKeyVal: <Buffer 96 95 ae b0 a0 91 40 f2 02 3c 60 12 eb 32 2c 52>,
     macKeyVal: <Buffer e5 3c f8 b6 c7 10 0a 0e 73 3e 5b 8b 82 30 24 51 af 97 e7 89 78 55 2d 29 2d dd db d9 ba ac ef 8d>,
     absValidity: 2018-03-21T19:05:20.977Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 3d b2 f8 69 85 9c 93 09>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:05:24 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521572724747
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521572777585
connected to auth! from local port 56010
received auth hello!
{ authId: 504, nonce: <Buffer f5 ca 23 83 3c e7 5a 8b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 65 6e 4e 08 55 a3 76 53>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400105,
  cipherKeyVal: <Buffer 35 4d f3 55 4e f6 af b7 8c b7 71 c8 4b f7 8b de>,
  macKeyVal: <Buffer c5 e8 62 37 75 a8 c6 a1 6c 55 4f 99 11 cd 6c 3d 24 27 65 d6 be a3 d7 ae 30 83 74 33 82 61 b8 e4>,
  absValidity: 2018-03-21T19:06:21.019Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50400105,
     cipherKeyVal: <Buffer 35 4d f3 55 4e f6 af b7 8c b7 71 c8 4b f7 8b de>,
     macKeyVal: <Buffer c5 e8 62 37 75 a8 c6 a1 6c 55 4f 99 11 cd 6c 3d 24 27 65 d6 be a3 d7 ae 30 83 74 33 82 61 b8 e4>,
     absValidity: 2018-03-21T19:06:21.019Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer ad 68 53 2d 69 c2 5f 69>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:06:24 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521572785081
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521572837637
connected to auth! from local port 56280
received auth hello!
{ authId: 504, nonce: <Buffer 39 0f e8 3d 9b 06 51 ec> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1a 72 5f 44 80 a6 23 4b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400111,
  cipherKeyVal: <Buffer 71 03 54 4c b5 d1 e0 63 69 71 43 4f 4e 80 59 5b>,
  macKeyVal: <Buffer a1 14 ee 53 8d c3 6a e7 2e d9 0e e6 b4 da 26 c0 19 dc fc cd 65 52 57 8e e5 57 ca 76 50 3c e8 72>,
  absValidity: 2018-03-21T19:07:21.362Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50400111,
     cipherKeyVal: <Buffer 71 03 54 4c b5 d1 e0 63 69 71 43 4f 4e 80 59 5b>,
     macKeyVal: <Buffer a1 14 ee 53 8d c3 6a e7 2e d9 0e e6 b4 da 26 c0 19 dc fc cd 65 52 57 8e e5 57 ca 76 50 3c e8 72>,
     absValidity: 2018-03-21T19:07:21.362Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 6d dc 28 ad 30 13 b9 89>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.42:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 7 0.7142857142857143 1521572897643
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 8 0.625 1521572957653
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 45450
received auth hello!
{ authId: 503, nonce: <Buffer f4 d1 8d 7d ec f4 de 5c> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 9 0.5555555555555556 1521573017661
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 45682
received auth hello!
{ authId: 503, nonce: <Buffer b1 a1 ee ce b7 ca 8e 8e> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 10 0.5 1521573077671
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 33820
received auth hello!
{ authId: 403, nonce: <Buffer de 96 9c 2f e5 d9 a4 37> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 11 0.45454545454545453 1521573137682
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 34058
received auth hello!
{ authId: 403, nonce: <Buffer ba 5b d2 37 e5 32 78 93> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 12 0.4166666666666667 1521573197689
failure in connection with Auth : authFailureCount: 6
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 37222
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 13 0.38461538461538464 1521573257699
failure in connection with Auth : authFailureCount: 7
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 37488
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 14 0.35714285714285715 1521573317704
failure in connection with Auth : authFailureCount: 8
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 2
to: 3
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 15 0.3333333333333333 1521573377711
failure in connection with Auth : authFailureCount: 9
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 3
to: 4
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.2:21100
/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902
            eventHandlers.onError('Error occurred in migration request: Disconnected from auth before getting migration response: ' + error);
                                                                                                                                      ^

ReferenceError: error is not defined
    at Socket.<anonymous> (/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902:135)
    at emitNone (events.js:91:20)
    at Socket.emit (events.js:188:7)
    at endReadableNT (_stream_readable.js:975:12)
    at _combinedTickCallback (internal/process/next_tick.js:80:11)
    at process._tickCallback (internal/process/next_tick.js:104:9)
