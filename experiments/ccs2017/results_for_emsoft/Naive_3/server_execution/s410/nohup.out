changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s410.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's410',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 67 49 42 41 41 4b 43 41 51 45 41 77 4c ... > }
Handler: listening on port 22100
s410:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200255
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44000
received auth hello!
{ authId: 402, nonce: <Buffer 24 8f e8 0a 80 8a 18 73> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 8b 8b 72 9d 1d cc 5a f6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 18 0c 9a 92 13 5a a7 d7 39 38 c4 85 49 d0 94 de>,
  macKeyVal: <Buffer 78 47 b7 75 4f 56 0f 66 44 ef 71 88 d6 5a 66 68 b4 7f c6 38 bf a4 9d db 27 f6 ec e1 89 11 82 5f>,
  absValidity: 2018-03-20T20:00:28.495Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 57 3e c7 61 1a 27 53 8a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 57 3e c7 61 1a 27 53 8a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.53:46664',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200262
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44174
received auth hello!
{ authId: 402, nonce: <Buffer cf b7 0b dc 2c 3e d5 a4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 07 4a 40 fb 98 02 a5 6c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9b e7 af 7c 2a df 3a 3d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9b e7 af 7c 2a df 3a 3d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.53:46838',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200269
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44444
received auth hello!
{ authId: 402, nonce: <Buffer 19 da 32 ef 47 ee 7b 1f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b4 b0 0a 34 80 00 aa 60>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 80 58 ef 9a b5 64 d3 65>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 80 58 ef 9a b5 64 d3 65> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.53:47108',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200276
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44714
received auth hello!
{ authId: 402, nonce: <Buffer 1a 4c 81 1b cd 80 ee 8c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1f e1 9f fa 0f 62 63 0a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bd d1 e0 8b 57 42 6f a7>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer bd d1 e0 8b 57 42 6f a7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.53:47378',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200283
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44984
received auth hello!
{ authId: 402, nonce: <Buffer fc 27 a3 18 40 e1 11 2d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 94 65 bb 6d 4a b0 88 43>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b1 f7 c7 46 10 4a a8 92>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b1 f7 c7 46 10 4a a8 92> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.53:47648',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200290
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45254
received auth hello!
{ authId: 402, nonce: <Buffer c2 3c 00 6c 1d 0a dc 76> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f6 1a 4d 36 3d 48 3b a4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1d f6 4d 0e 85 32 a0 d3>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 1d f6 4d 0e 85 32 a0 d3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.53:47918',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200297
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45524
received auth hello!
{ authId: 402, nonce: <Buffer 72 5a 0c fa 86 d0 ed 4a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d9 84 52 0f 55 88 ce 13>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 76 de f1 2b f4 f2 87 10>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 76 de f1 2b f4 f2 87 10> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.53:48188',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200304
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45794
received auth hello!
{ authId: 402, nonce: <Buffer c9 4d e9 3d 64 bd 4b 63> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6a 0d 3d 64 ca 99 a1 f2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 49 b0 6d e5 30 20 e9 58>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 49 b0 6d e5 30 20 e9 58> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.53:48458',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
