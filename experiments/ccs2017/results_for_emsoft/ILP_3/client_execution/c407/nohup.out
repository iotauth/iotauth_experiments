changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c407.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c407',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 75 4b ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521595266712
connected to auth! from local port 60548
received auth hello!
{ authId: 402, nonce: <Buffer 15 d1 4a d4 2a ee 37 ce> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 9d 8a f6 0c 62 ca d8 fe>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 57 1c 13 5c 6b 38 a8 ad ac 30 df 32 d1 fd 76 10>,
  macKeyVal: <Buffer 29 2c 7a 32 8f eb 3f 7c 0d de 1d 5b c8 7d 9a f3 35 60 db b2 9e 90 e7 54 ee dc 07 0f b9 48 6b bc>,
  absValidity: 2018-03-21T02:21:06.889Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200251,
  cipherKeyVal: <Buffer df ce 4e ce c2 af 5f 77 4e 93 70 17 06 3a 53 ce>,
  macKeyVal: <Buffer f8 a2 81 db 4a 8f a0 b1 e7 62 a1 9a 3f 21 6d f0 a8 82 01 2a 5c 11 25 d5 54 45 8c 8a a6 68 93 f1>,
  absValidity: 2018-03-22T01:21:06.884Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200251,
     cipherKeyVal: <Buffer df ce 4e ce c2 af 5f 77 4e 93 70 17 06 3a 53 ce>,
     macKeyVal: <Buffer f8 a2 81 db 4a 8f a0 b1 e7 62 a1 9a 3f 21 6d f0 a8 82 01 2a 5c 11 25 d5 54 45 8c 8a a6 68 93 f1>,
     absValidity: 2018-03-22T01:21:06.884Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer aa b0 1b d2 69 69 95 df>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 01:21:07 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521595267796
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521595326766
connected to auth! from local port 60698
received auth hello!
{ authId: 402, nonce: <Buffer c4 78 31 03 3c 9b 60 1d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 77 34 8f 8c 42 b1 bd 5f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200258,
  cipherKeyVal: <Buffer f4 2b e0 85 e5 ea e1 a8 69 22 5d da f5 72 91 1a>,
  macKeyVal: <Buffer 7f 23 f2 13 98 dc 69 41 a3 ca 74 d5 74 4a 27 19 42 3d 49 72 8c 57 e6 41 3e f7 61 8e f0 e5 72 fb>,
  absValidity: 2018-03-22T01:22:06.926Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200258,
     cipherKeyVal: <Buffer f4 2b e0 85 e5 ea e1 a8 69 22 5d da f5 72 91 1a>,
     macKeyVal: <Buffer 7f 23 f2 13 98 dc 69 41 a3 ca 74 d5 74 4a 27 19 42 3d 49 72 8c 57 e6 41 3e f7 61 8e f0 e5 72 fb>,
     absValidity: 2018-03-22T01:22:06.926Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer b2 a5 55 a8 8c fc 59 84>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 01:22:07 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521595327861
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521595386796
connected to auth! from local port 60954
received auth hello!
{ authId: 402, nonce: <Buffer f2 86 a6 cc 0a 96 d7 4a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 53 d2 81 5b ed bc 5b 7f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200265,
  cipherKeyVal: <Buffer 82 5d 39 c3 e1 11 47 08 b4 9f 90 86 3c 48 c8 9c>,
  macKeyVal: <Buffer b9 90 73 8a 3f 37 93 54 5c 01 0d b8 a1 6a da e9 7d b3 c0 bf 8c b1 57 6b 76 32 99 83 88 84 6a 1c>,
  absValidity: 2018-03-22T01:23:06.945Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200265,
     cipherKeyVal: <Buffer 82 5d 39 c3 e1 11 47 08 b4 9f 90 86 3c 48 c8 9c>,
     macKeyVal: <Buffer b9 90 73 8a 3f 37 93 54 5c 01 0d b8 a1 6a da e9 7d b3 c0 bf 8c b1 57 6b 76 32 99 83 88 84 6a 1c>,
     absValidity: 2018-03-22T01:23:06.945Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 56 8e 30 a0 2c 3a 6d 5a>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 01:23:07 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521595388240
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521595446853
connected to auth! from local port 32992
received auth hello!
{ authId: 402, nonce: <Buffer c2 9c 0b b2 75 0f fa 39> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 83 b8 d7 ea c0 ae 6f b8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200272,
  cipherKeyVal: <Buffer 2d c1 56 e9 72 13 b6 d4 7e f9 10 8f 5d e6 ae 10>,
  macKeyVal: <Buffer 69 06 f8 74 ec c5 9e f0 13 d4 3c 8b 41 50 d5 19 37 20 37 e3 df 76 bd 90 d2 b0 6b 92 3d f5 ef c9>,
  absValidity: 2018-03-22T01:24:06.968Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200272,
     cipherKeyVal: <Buffer 2d c1 56 e9 72 13 b6 d4 7e f9 10 8f 5d e6 ae 10>,
     macKeyVal: <Buffer 69 06 f8 74 ec c5 9e f0 13 d4 3c 8b 41 50 d5 19 37 20 37 e3 df 76 bd 90 d2 b0 6b 92 3d f5 ef c9>,
     absValidity: 2018-03-22T01:24:06.968Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 95 49 10 42 8c 39 1a 27>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 01:24:07 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521595447969
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521595506913
connected to auth! from local port 33262
received auth hello!
{ authId: 402, nonce: <Buffer 68 61 a9 ab bc 06 64 7d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 87 6f a9 c2 8d eb 9d 99>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200279,
  cipherKeyVal: <Buffer 2c ba e9 0a 7b ab d0 09 51 45 1b 7d 48 a7 e3 41>,
  macKeyVal: <Buffer c9 d8 d1 6c 15 b1 55 11 d5 af 4a e9 69 5e 8f a1 c2 01 51 3c be 76 99 dc 9f 2d 49 e9 37 74 19 f7>,
  absValidity: 2018-03-22T01:25:07.040Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200279,
     cipherKeyVal: <Buffer 2c ba e9 0a 7b ab d0 09 51 45 1b 7d 48 a7 e3 41>,
     macKeyVal: <Buffer c9 d8 d1 6c 15 b1 55 11 d5 af 4a e9 69 5e 8f a1 c2 01 51 3c be 76 99 dc 9f 2d 49 e9 37 74 19 f7>,
     absValidity: 2018-03-22T01:25:07.040Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 85 d1 2e 25 bf 6c bf 1b>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 01:25:07 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521595508096
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521595566973
connected to auth! from local port 33532
received auth hello!
{ authId: 402, nonce: <Buffer 5e 6b da 3e bc d0 b6 0f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e1 25 cc 22 91 be 3e 5c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200286,
  cipherKeyVal: <Buffer 00 ad aa 4d ec c4 30 57 fb f7 ef 6a 4c 77 2b a3>,
  macKeyVal: <Buffer 02 1f 9b 51 6e 88 fe 5c 5b 83 65 55 ee 40 9a 43 18 99 7c 57 89 90 71 c3 c0 5a 20 9a 64 a6 ac e1>,
  absValidity: 2018-03-22T01:26:07.110Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200286,
     cipherKeyVal: <Buffer 00 ad aa 4d ec c4 30 57 fb f7 ef 6a 4c 77 2b a3>,
     macKeyVal: <Buffer 02 1f 9b 51 6e 88 fe 5c 5b 83 65 55 ee 40 9a 43 18 99 7c 57 89 90 71 c3 c0 5a 20 9a 64 a6 ac e1>,
     absValidity: 2018-03-22T01:26:07.110Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 0a e7 e8 b0 2b 91 7d 04>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 01:26:07 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521595568358
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521595627031
connected to auth! from local port 33802
received auth hello!
{ authId: 402, nonce: <Buffer e8 b7 39 03 b6 f4 a6 f6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5b 23 a2 1f db 51 ba 9d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200293,
  cipherKeyVal: <Buffer 2c eb 8b 71 7e c2 97 97 ef 41 77 99 a0 cb 93 fd>,
  macKeyVal: <Buffer b5 dc 04 72 f8 53 47 f1 19 e2 a3 5a c1 7e c7 c4 6f 6b f0 f0 18 80 2e be 49 b7 b6 1b cc b1 bf c4>,
  absValidity: 2018-03-22T01:27:07.151Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200293,
     cipherKeyVal: <Buffer 2c eb 8b 71 7e c2 97 97 ef 41 77 99 a0 cb 93 fd>,
     macKeyVal: <Buffer b5 dc 04 72 f8 53 47 f1 19 e2 a3 5a c1 7e c7 c4 6f 6b f0 f0 18 80 2e be 49 b7 b6 1b cc b1 bf c4>,
     absValidity: 2018-03-22T01:27:07.151Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 41 58 9b 2e ae cf 99 82>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 01:27:08 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521595628461
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521595687089
connected to auth! from local port 34072
received auth hello!
{ authId: 402, nonce: <Buffer 91 9a 48 d2 5d 36 07 39> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 27 fb ae 46 2c 1b 7d 62>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200300,
  cipherKeyVal: <Buffer ec 73 6d 32 11 4e 75 99 7d 95 4a 48 a6 fa cb 25>,
  macKeyVal: <Buffer 2d e1 87 74 78 49 37 48 ed 38 42 92 b2 64 be 50 05 d5 d4 e3 4a b7 a8 fb 26 be 63 e8 6c dc 00 e2>,
  absValidity: 2018-03-22T01:28:07.249Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200300,
     cipherKeyVal: <Buffer ec 73 6d 32 11 4e 75 99 7d 95 4a 48 a6 fa cb 25>,
     macKeyVal: <Buffer 2d e1 87 74 78 49 37 48 ed 38 42 92 b2 64 be 50 05 d5 d4 e3 4a b7 a8 fb 26 be 63 e8 6c dc 00 e2>,
     absValidity: 2018-03-22T01:28:07.249Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer e1 26 83 cf 6c d3 78 b3>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 01:28:08 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 8 1 1521595688587
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 9 0.8888888888888888 1521595747124
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 10 0.8 1521595807135
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 38250
received auth hello!
{ authId: 403, nonce: <Buffer 6d d4 78 05 1d b5 4b 4e> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 11 0.7272727272727273 1521595867145
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 38478
received auth hello!
{ authId: 403, nonce: <Buffer 52 73 d7 a7 17 03 13 04> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 12 0.6666666666666666 1521595927153
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 54902
received auth hello!
{ authId: 502, nonce: <Buffer ac bd 5c d5 ee 29 0c e1> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 13 0.6153846153846154 1521595987161
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 55162
received auth hello!
{ authId: 502, nonce: <Buffer b2 d6 51 da 46 a4 be 9b> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 14 0.5714285714285714 1521596047171
failure in connection with Auth : authFailureCount: 6
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 44136
received auth hello!
{ authId: 503, nonce: <Buffer eb 6c dd 9f 4d bf b6 fb> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth503',
     commonName: '10.0.1.6' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth402',
     commonName: '10.0.0.2' },
  serial: '01624623E359',
  notBefore: 2018-03-21T01:17:59.000Z,
  notAfter: 2018-03-22T01:19:39.000Z,
  subjectHash: '5542437f',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '59:5C:FE:91:C4:4C:08:93:10:E8:46:74:89:30:1D:42:E9:B7:31:FA',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'BEF8F49475DE2A7247021F450606CD5891A65AED3D5B5352F639856656DABAB71FBB39B48DC0B2D02F476ECDDA817725D9247F8343EFA59CE3C8A1478669A0BBC7331BFA8CA47D0D8AF82267CED06E82D935EE41A36521595DE2E9C9282C6C4EE18E9EF871EB69AFA64DAF8AF9C918FF6EBDCE83735918F691FBA5D857D30199CC98C65973C1020FC538746EF90A2737A41391E8FFB49EFEDDB1B9899BB362DE128DF9797D19395ABA6F755427F4D2533E459F827BEFAB7F66A40D2E20A5261297BEA33E1532F5BC6F4F7AB69CBFFC885108509A63CB8EBD0F0FB315C71A59CD5995A1BE71E5570E2D3AA54A128F129827DA7DE4AAB6B1B12275D61933AA6811',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.6' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 503,
  host: '10.0.1.6',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJGI+NZMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDIxETAPBgNVBAMMCDEwLjAuMC4yMB4XDTE4MDMy\nMTAxMTc1OVoXDTE4MDMyMjAxMTkzOVowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMzERMA8GA1UEAwwIMTAuMC4xLjYwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQC++PSUdd4qckcCH0UGBs1YkaZa7T1bU1L2OYVmVtq6tx+7ObSN\nwLLQL0duzdqBdyXZJH+DQ++lnOPIoUeGaaC7xzMb+oykfQ2K+CJnztBugtk17kGj\nZSFZXeLpySgsbE7hjp74cetpr6ZNr4r5yRj/br3Og3NZGPaR+6XYV9MBmcyYxllz\nwQIPxTh0bvkKJzekE5Ho/7Se/t2xuYmbs2LeEo35eX0ZOVq6b3VUJ/TSUz5Fn4J7\n76t/ZqQNLiClJhKXvqM+FTL1vG9Peracv/yIUQhQmmPLjr0PD7MVxxpZzVmVob5x\n5VcOLTqlShKPEpgn2n3kqraxsSJ11hkzqmgRAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQYwDQYJKoZIhvcNAQELBQADggEBAFPBNEebg0e2ueTMGLbCNKtbx6GXJTX1\nVTXyvjfD5AwdII5d9rvLneji/+jKSsSBZaZbyQAomNNPn0wGj/QQU5rs8kct3Jh8\n2gW2bV3elXwGkJOFNU0naMjCr621PF/ECitGCujV1hFBvLvWR8Jr1TRAEO26LgbT\nREyFNdmkx/4yE7tRSTsN0vSNUV1Nexn4TWWKkhX0bLvO+rfgH0h+EeWQDRSvbVSv\n+xDNPQYe4zxCTtcj0S5Hkm6fyE9lqRbau457ztEsPqA3fwn+9kDXnoKME+S1vlJv\nh3sKWW2xyZlx3kVgMfnUUlziR46SEm+IfReiYiepFktp80lXF/zZRMM=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 2
to: 3
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 15 0.5333333333333333 1521596107182
connected to auth! from local port 44374
received auth hello!
{ authId: 503, nonce: <Buffer 02 04 e4 2b db 8f 30 67> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer be 4d 02 84 73 e2 73 2d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 99 d2 3e 10 af 14 68 e4 f3 25 a7 60 65 d4 77 36>,
  macKeyVal: <Buffer 6d f7 a9 db 14 14 62 54 71 7f 7d 2d fd 7f 71 a4 a3 06 c2 a1 47 94 79 6a c3 28 9a f6 d1 f7 b7 da>,
  absValidity: 2018-03-21T02:35:07.393Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300395,
  cipherKeyVal: <Buffer 36 93 34 e1 7d 8a 18 42 40 e6 03 c9 73 a8 ff 5b>,
  macKeyVal: <Buffer 2e e9 64 c4 77 cb 39 d1 04 8f 60 97 07 dc 83 97 62 62 6f 22 14 4f 5a 68 34 e1 09 9a b5 91 47 06>,
  absValidity: 2018-03-22T01:35:07.392Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 50300395,
     cipherKeyVal: <Buffer 36 93 34 e1 7d 8a 18 42 40 e6 03 c9 73 a8 ff 5b>,
     macKeyVal: <Buffer 2e e9 64 c4 77 cb 39 d1 04 8f 60 97 07 dc 83 97 62 62 6f 22 14 4f 5a 68 34 e1 09 9a b5 91 47 06>,
     absValidity: 2018-03-22T01:35:07.392Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 0d 8e df 5d 2f 1f 65 d9>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 16 0.5 1521596167191
connected to auth! from local port 44626
received auth hello!
{ authId: 503, nonce: <Buffer 99 c1 f8 f7 81 33 29 dc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bf a3 88 b3 98 f1 95 90>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300403,
  cipherKeyVal: <Buffer 4d 2c 93 1a b2 97 21 9c 0d 24 88 21 af 4b 03 42>,
  macKeyVal: <Buffer 29 31 c0 2d 6e 4f 38 4d ee f4 9c 86 6d e1 67 44 5e a5 9e 3b d5 52 14 52 8b 8d 0c 77 ab 98 ec 84>,
  absValidity: 2018-03-22T01:36:07.357Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 50300403,
     cipherKeyVal: <Buffer 4d 2c 93 1a b2 97 21 9c 0d 24 88 21 af 4b 03 42>,
     macKeyVal: <Buffer 29 31 c0 2d 6e 4f 38 4d ee f4 9c 86 6d e1 67 44 5e a5 9e 3b d5 52 14 52 8b 8d 0c 77 ab 98 ec 84>,
     absValidity: 2018-03-22T01:36:07.357Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 32 62 8a 55 ba 44 92 52>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 17 0.47058823529411764 1521596227201
connected to auth! from local port 44880
received auth hello!
{ authId: 503, nonce: <Buffer 96 d0 19 f7 2a 8b 38 48> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 99 2e 31 8a 77 54 b6 5f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300411,
  cipherKeyVal: <Buffer 0e d5 e8 73 c0 4c 1e 8e f1 99 66 8a bf 60 91 89>,
  macKeyVal: <Buffer 49 9e 5a 71 75 6c 83 ce 5b 8e 21 87 cc 12 a2 99 db 18 9e b5 54 97 c5 26 94 27 de f5 ea 92 eb b0>,
  absValidity: 2018-03-22T01:37:07.536Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 50300411,
     cipherKeyVal: <Buffer 0e d5 e8 73 c0 4c 1e 8e f1 99 66 8a bf 60 91 89>,
     macKeyVal: <Buffer 49 9e 5a 71 75 6c 83 ce 5b 8e 21 87 cc 12 a2 99 db 18 9e b5 54 97 c5 26 94 27 de f5 ea 92 eb b0>,
     absValidity: 2018-03-22T01:37:07.536Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 2a d0 63 a3 aa 28 ba c9>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 18 0.4444444444444444 1521596287211
connected to auth! from local port 45124
received auth hello!
{ authId: 503, nonce: <Buffer 96 9b 49 3a 27 06 2b e4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0f f4 82 5c 48 40 57 1b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300419,
  cipherKeyVal: <Buffer 24 48 8f f5 a9 f4 f7 20 ff 96 ab 28 e0 97 c3 eb>,
  macKeyVal: <Buffer ec 19 9c d4 c4 74 e8 bf ad df b8 f1 71 a9 e3 65 39 29 03 bc 8c c6 5b e2 30 0d 5e 79 bd 47 9f a6>,
  absValidity: 2018-03-22T01:38:07.384Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 50300419,
     cipherKeyVal: <Buffer 24 48 8f f5 a9 f4 f7 20 ff 96 ab 28 e0 97 c3 eb>,
     macKeyVal: <Buffer ec 19 9c d4 c4 74 e8 bf ad df b8 f1 71 a9 e3 65 39 29 03 bc 8c c6 5b e2 30 0d 5e 79 bd 47 9f a6>,
     absValidity: 2018-03-22T01:38:07.384Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 4f fb 18 4d 30 b5 b3 78>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 19 0.42105263157894735 1521596347222
connected to auth! from local port 45372
received auth hello!
{ authId: 503, nonce: <Buffer 35 d6 0c cf ce a2 ec 93> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b8 11 99 03 b0 6b 8b 5c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300427,
  cipherKeyVal: <Buffer 27 fa 3a 10 fc 72 1e a7 2b 25 7c ab ff a1 10 35>,
  macKeyVal: <Buffer c1 2a 6e 10 3b 41 e4 90 20 63 d7 77 fa 9b cc 77 a0 04 0f 9c 00 eb 46 6a 9b b0 e3 68 30 9c a9 e1>,
  absValidity: 2018-03-22T01:39:07.494Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 50300427,
     cipherKeyVal: <Buffer 27 fa 3a 10 fc 72 1e a7 2b 25 7c ab ff a1 10 35>,
     macKeyVal: <Buffer c1 2a 6e 10 3b 41 e4 90 20 63 d7 77 fa 9b cc 77 a0 04 0f 9c 00 eb 46 6a 9b b0 e3 68 30 9c a9 e1>,
     absValidity: 2018-03-22T01:39:07.494Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 41 ee a5 4c a3 37 a5 aa>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 20 0.4 1521596407232
connected to auth! from local port 45618
received auth hello!
{ authId: 503, nonce: <Buffer 2b 43 4c cf d0 1b b1 70> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5b 6a 27 fa d7 1d 49 1d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300435,
  cipherKeyVal: <Buffer 82 6b 69 0c 8d 7a b7 69 9b d4 f7 aa 7a 17 a7 3b>,
  macKeyVal: <Buffer b8 93 c6 40 c6 74 6a 3d 36 02 5e 5a e6 94 e6 df 16 dc ef 95 51 3c 90 68 8a 71 94 39 0c 76 a0 b0>,
  absValidity: 2018-03-22T01:40:07.449Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 50300435,
     cipherKeyVal: <Buffer 82 6b 69 0c 8d 7a b7 69 9b d4 f7 aa 7a 17 a7 3b>,
     macKeyVal: <Buffer b8 93 c6 40 c6 74 6a 3d 36 02 5e 5a e6 94 e6 df 16 dc ef 95 51 3c 90 68 8a 71 94 39 0c 76 a0 b0>,
     absValidity: 2018-03-22T01:40:07.449Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer c3 b3 f1 a6 ba 8d 37 fb>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 21 0.38095238095238093 1521596467242
connected to auth! from local port 45866
received auth hello!
{ authId: 503, nonce: <Buffer 46 6f 0d 44 35 ad a4 d3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 88 e0 c6 c7 c9 63 bf 78>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300443,
  cipherKeyVal: <Buffer aa ce 30 ce 19 98 bb b6 d5 82 e0 66 ed a1 3c d8>,
  macKeyVal: <Buffer f2 cd 90 fe 25 5a 44 a5 f8 68 4c 9c 1a 2a 26 d6 e5 9e 28 d2 0f 28 8b 8e ff 6f fe 50 ba 76 52 3f>,
  absValidity: 2018-03-22T01:41:07.537Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 50300443,
     cipherKeyVal: <Buffer aa ce 30 ce 19 98 bb b6 d5 82 e0 66 ed a1 3c d8>,
     macKeyVal: <Buffer f2 cd 90 fe 25 5a 44 a5 f8 68 4c 9c 1a 2a 26 d6 e5 9e 28 d2 0f 28 8b 8e ff 6f fe 50 ba 76 52 3f>,
     absValidity: 2018-03-22T01:41:07.537Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 0c 36 98 05 9b a4 12 13>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 22 0.36363636363636365 1521596527253
connected to auth! from local port 46112
received auth hello!
{ authId: 503, nonce: <Buffer 7c 9d 8d bc a8 29 f5 34> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 46 8d 00 40 26 ea 58 23>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300451,
  cipherKeyVal: <Buffer f4 72 9b 33 c4 a0 d3 2b c0 dd 7e d1 bf 4c d5 59>,
  macKeyVal: <Buffer 26 c7 ca 18 33 fc 55 ac 2c 59 79 a0 fb ba 33 69 59 48 3b 6f ff 8e e1 e0 f0 5a e4 df 65 59 ab ec>,
  absValidity: 2018-03-22T01:42:07.442Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 50300451,
     cipherKeyVal: <Buffer f4 72 9b 33 c4 a0 d3 2b c0 dd 7e d1 bf 4c d5 59>,
     macKeyVal: <Buffer 26 c7 ca 18 33 fc 55 ac 2c 59 79 a0 fb ba 33 69 59 48 3b 6f ff 8e e1 e0 f0 5a e4 df 65 59 ab ec>,
     absValidity: 2018-03-22T01:42:07.442Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 91 b5 36 9b 8a b5 29 41>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 23 0.34782608695652173 1521596587258
connected to auth! from local port 46350
received auth hello!
{ authId: 503, nonce: <Buffer 2c f4 1b 58 cc c3 c5 35> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 08 3d f6 5d 56 3d 8a 35>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300459,
  cipherKeyVal: <Buffer e2 8f 96 9b 45 8e a4 ab 6a 5b 3a 72 b4 7d 7e 02>,
  macKeyVal: <Buffer 90 84 06 97 88 da 85 7e ae d8 4d 04 14 a0 35 50 d5 d7 1a e5 f2 8d 27 e7 21 be eb 52 39 6a 02 eb>,
  absValidity: 2018-03-22T01:43:07.412Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 50300459,
     cipherKeyVal: <Buffer e2 8f 96 9b 45 8e a4 ab 6a 5b 3a 72 b4 7d 7e 02>,
     macKeyVal: <Buffer 90 84 06 97 88 da 85 7e ae d8 4d 04 14 a0 35 50 d5 d7 1a e5 f2 8d 27 e7 21 be eb 52 39 6a 02 eb>,
     absValidity: 2018-03-22T01:43:07.412Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 00 e3 e0 14 54 86 b3 45>
switching to HANDSHAKE_1_SENT
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 24 0.3333333333333333 1521596647268
connected to auth! from local port 46588
received auth hello!
{ authId: 503, nonce: <Buffer 8c b5 a6 9f be 8b e5 96> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b5 70 f7 25 5e 6c 0e e8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300467,
  cipherKeyVal: <Buffer 23 b9 10 60 3c c9 7e 89 d5 f2 fb 0c 1d 6e a3 f6>,
  macKeyVal: <Buffer be aa d3 d3 92 b8 b4 a3 64 c6 e8 06 8b f6 24 5c 74 70 87 8e fd 63 74 e2 05 93 12 14 7e e3 4b d2>,
  absValidity: 2018-03-22T01:44:07.419Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 50300467,
     cipherKeyVal: <Buffer 23 b9 10 60 3c c9 7e 89 d5 f2 fb 0c 1d 6e a3 f6>,
     macKeyVal: <Buffer be aa d3 d3 92 b8 b4 a3 64 c6 e8 06 8b f6 24 5c 74 70 87 8e fd 63 74 e2 05 93 12 14 7e e3 4b d2>,
     absValidity: 2018-03-22T01:44:07.419Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 2d 9b 1d a5 6d 81 f9 1c>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 25 0.32 1521596707271
connected to auth! from local port 46826
received auth hello!
{ authId: 503, nonce: <Buffer 94 0e 68 87 56 06 ef d6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0f a3 6a 64 78 d5 20 23>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300475,
  cipherKeyVal: <Buffer ee aa 2b 20 2d 9c e6 cc 4d 74 17 72 82 6b a7 42>,
  macKeyVal: <Buffer 89 61 3c 9d 0e 3f da 61 d1 2d 01 d9 f6 13 9b d5 cf e9 8e f9 12 65 c4 58 49 a3 26 ab 42 79 8f 1c>,
  absValidity: 2018-03-22T01:45:07.437Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 50300475,
     cipherKeyVal: <Buffer ee aa 2b 20 2d 9c e6 cc 4d 74 17 72 82 6b a7 42>,
     macKeyVal: <Buffer 89 61 3c 9d 0e 3f da 61 d1 2d 01 d9 f6 13 9b d5 cf e9 8e f9 12 65 c4 58 49 a3 26 ab 42 79 8f 1c>,
     absValidity: 2018-03-22T01:45:07.437Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 9d 90 a3 55 ad 41 38 5a>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 26 0.3076923076923077 1521596767281
connected to auth! from local port 47068
received auth hello!
{ authId: 503, nonce: <Buffer db 5c 53 72 7b 68 0a 5a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3c 16 b4 f3 48 e4 f0 96>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300483,
  cipherKeyVal: <Buffer 52 92 52 11 73 d5 a2 f9 5e 75 a2 b0 77 18 b6 b3>,
  macKeyVal: <Buffer 3b 39 bd 5d 61 50 19 58 53 1f fe 8c 0b d4 5a c7 6d 90 de a0 bf 3b 0d 08 a7 03 48 b7 fc 8f c8 4f>,
  absValidity: 2018-03-22T01:46:07.534Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 50300483,
     cipherKeyVal: <Buffer 52 92 52 11 73 d5 a2 f9 5e 75 a2 b0 77 18 b6 b3>,
     macKeyVal: <Buffer 3b 39 bd 5d 61 50 19 58 53 1f fe 8c 0b d4 5a c7 6d 90 de a0 bf 3b 0d 08 a7 03 48 b7 fc 8f c8 4f>,
     absValidity: 2018-03-22T01:46:07.534Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 9e 5a 75 4e 26 c9 21 0f>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 27 0.2962962962962963 1521596827291
connected to auth! from local port 47296
received auth hello!
{ authId: 503, nonce: <Buffer 49 e2 ff af 1a 93 6d 38> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a6 fd 71 b3 62 ed 66 00>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300491,
  cipherKeyVal: <Buffer 30 77 db 08 fa ef 6e bd 7e 61 9d b3 63 4f 84 ab>,
  macKeyVal: <Buffer 4c 3d 7b cd fc 0d cb 52 b8 8a da 87 d9 75 0c ec dc cb 77 1f 0c a8 0c a0 b6 a0 ef 04 39 e8 1c 6b>,
  absValidity: 2018-03-22T01:47:07.538Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 50300491,
     cipherKeyVal: <Buffer 30 77 db 08 fa ef 6e bd 7e 61 9d b3 63 4f 84 ab>,
     macKeyVal: <Buffer 4c 3d 7b cd fc 0d cb 52 b8 8a da 87 d9 75 0c ec dc cb 77 1f 0c a8 0c a0 b6 a0 ef 04 39 e8 1c 6b>,
     absValidity: 2018-03-22T01:47:07.538Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 44 11 80 5f eb 99 91 81>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 28 0.2857142857142857 1521596887301
connected to auth! from local port 47534
received auth hello!
{ authId: 503, nonce: <Buffer ac 0b 90 6e 9e b5 53 fa> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fc 71 a4 b6 30 f6 19 0d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300499,
  cipherKeyVal: <Buffer 3b ab 13 d7 01 de 3c 2f 4b 24 fa b1 e9 99 0b c9>,
  macKeyVal: <Buffer 6b f9 1d 85 e9 67 58 a3 ec e8 ec 7c bf 9b 1b b3 6b 85 0e d3 92 91 d0 08 41 b6 64 a3 2e 6a ca 50>,
  absValidity: 2018-03-22T01:48:07.442Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 50300499,
     cipherKeyVal: <Buffer 3b ab 13 d7 01 de 3c 2f 4b 24 fa b1 e9 99 0b c9>,
     macKeyVal: <Buffer 6b f9 1d 85 e9 67 58 a3 ec e8 ec 7c bf 9b 1b b3 6b 85 0e d3 92 91 d0 08 41 b6 64 a3 2e 6a ca 50>,
     absValidity: 2018-03-22T01:48:07.442Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 60 6d cd d3 1d 0e 13 7f>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
