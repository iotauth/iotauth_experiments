changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s518.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's518',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 51 49 42 41 41 4b 43 41 51 45 41 76 77 ... > }
Handler: listening on port 22100
s518:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400078
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44592
received auth hello!
{ authId: 504, nonce: <Buffer d0 07 e7 43 a6 2f e9 3e> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 07 dc c9 19 c4 fa d7 41>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 3c a3 ae f4 da bc 18 0f c8 d1 69 bb 44 ac 38 c4>,
  macKeyVal: <Buffer 57 f9 3b 29 29 26 fa 53 92 e0 b4 58 b1 85 ca 83 f3 fe 0e 96 45 43 de d4 b3 3b b2 ac 86 4b 17 51>,
  absValidity: 2018-03-21T02:23:02.202Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 89 43 64 5f 62 75 b0 21>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 89 43 64 5f 62 75 b0 21> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.84:53934',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400080
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44624
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer 03 bb 60 32 64 f9 c2 ec> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8f e0 d4 70 0a de f7 91>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0f 04 72 76 0d 45 c1 b7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0f 04 72 76 0d 45 c1 b7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.85:41190',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400084
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44862
received auth hello!
{ authId: 504, nonce: <Buffer 38 76 03 d1 f9 2e 43 ab> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 68 75 e6 2b 39 88 c4 1a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3c 4d 8d e1 76 a1 ee d6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3c 4d 8d e1 76 a1 ee d6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.84:54204',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400086
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44894
received auth hello!
{ authId: 504, nonce: <Buffer 04 2d 6d 22 44 04 fc a5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0d 04 a8 65 04 dc 7a a5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b0 08 92 9a 7d ae 1a 4a>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b0 08 92 9a 7d ae 1a 4a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.85:41460',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400090
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45132
received auth hello!
{ authId: 504, nonce: <Buffer 13 cd 9c b3 7e 4f ab e1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 93 b3 ec 25 85 73 e2 8d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8f e8 62 b6 e7 2b 0b 64>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8f e8 62 b6 e7 2b 0b 64> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.84:54474',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400092
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45164
received auth hello!
{ authId: 504, nonce: <Buffer f3 c0 b4 a4 27 88 66 e2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fd 18 d3 5d 35 25 5a 1c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ba 5b 3b a7 c7 97 6b 70>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ba 5b 3b a7 c7 97 6b 70> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.85:41730',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400096
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45402
received auth hello!
{ authId: 504, nonce: <Buffer c6 6b c3 ba da 39 28 13> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2d a6 1c 06 13 9d c9 4e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ac 41 39 3b 04 8b 79 ec>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ac 41 39 3b 04 8b 79 ec> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.84:54744',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400098
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45434
received auth hello!
{ authId: 504, nonce: <Buffer b8 56 23 c9 8c 7d 22 61> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8b 3b d4 a6 63 2b 58 3e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b5 78 b9 fe 74 8d 61 21>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b5 78 b9 fe 74 8d 61 21> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.85:42000',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400102
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45672
received auth hello!
{ authId: 504, nonce: <Buffer 60 20 1d b8 0c ea ba 5c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 27 2c ef d0 ed 36 b0 28>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7c 51 57 a2 1c 1b 03 84>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 7c 51 57 a2 1c 1b 03 84> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.84:55014',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400104
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45704
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer 02 f7 22 8b f0 2d 4e 13> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 19 8c 53 5a 97 9d ad a1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f4 fe c8 ce 19 a5 11 78>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f4 fe c8 ce 19 a5 11 78> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.85:42270',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400108
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45942
received auth hello!
{ authId: 504, nonce: <Buffer 47 8e 12 dc 4f dd 58 81> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5e 14 b8 7c 78 8c b2 d2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a3 b1 b4 fe 10 7f a4 0f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a3 b1 b4 fe 10 7f a4 0f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.84:55284',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400110
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45974
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer c9 e0 36 7d aa a7 3a cf> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cb 68 ac 10 f1 74 50 86>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 33 df 59 8c eb ba 6f cb>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 33 df 59 8c eb ba 6f cb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.85:42540',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100625
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100635
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 42696
received auth hello!
{ authId: 502, nonce: <Buffer 91 c5 73 4c 6e 93 a1 99> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth504',
     commonName: '10.0.0.7' },
  serial: '01624623EB9F',
  notBefore: 2018-03-21T01:18:01.000Z,
  notAfter: 2018-03-22T01:19:41.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'C6:32:A0:24:4C:29:3D:1D:8B:39:46:E3:FE:D0:75:F3:FC:77:1A:B0',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'FF6CB5202497CC77AF28EFDE774858E4FEF04355E5228E378962DF4235BE3683DAF9E38A7E22621D66B3B50166D897E97BF911F9E8FC09D686961AA39679014E5DDD27EA0F02DE853A41537DB5E37F33395E249F355C0D074419572E9856D1D598CAB2CD6951013DDCB0A163B943DFCD2694BE18B9B3892695B3052EBD9115D447293C83AF24A008794B842E4F0A6C2A8D0189612A600AA40A592603E43713C0ECCA681024E5EC429FAD09484B824919DF59C8BD488E0D372D2A3D8B99B6068E24BBBDA8F0BCDDBA806010E4A7181736DF08D4D1CFC16E26507C360EDCBFF1B5F4288CE304DE62E9696665C5108489AD7232658356998FF47C4F7E8A04225423',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJGI+ufMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDQxETAPBgNVBAMMCDEwLjAuMC43MB4XDTE4MDMy\nMTAxMTgwMVoXDTE4MDMyMjAxMTk0MVowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQD/bLUgJJfMd68o7953SFjk/vBDVeUijjeJYt9CNb42g9r544p+\nImIdZrO1AWbYl+l7+RH56PwJ1oaWGqOWeQFOXd0n6g8C3oU6QVN9teN/MzleJJ81\nXA0HRBlXLphW0dWYyrLNaVEBPdywoWO5Q9/NJpS+GLmziSaVswUuvZEV1EcpPIOv\nJKAIeUuELk8KbCqNAYlhKmAKpApZJgPkNxPA7MpoECTl7EKfrQlIS4JJGd9ZyL1I\njg03LSo9i5m2Bo4ku72o8LzduoBgEOSnGBc23wjU0c/BbiZQfDYO3L/xtfQojOME\n3mLpaWZlxRCEia1yMmWDVpmP9HxPfooEIlQjAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAK3yuDW7US+1TTqbZ9IzcRsugyKjW3eF\nZ+ICuR46YrXW5VzHNWodZbDFCiNV0Bo1ZzL+dXDEmJVn71jKThgUDz7ENFbf3mS5\ngkrY38lRykAzitvOTlk828IcC8B0qxGqAV2sB8YAzMwdGgCAKJXwH4dPI7AUTXx9\njqYF1HGLtRqs21mUbjY66163HCXkgjSud7hIvGV/etIvWIGypyuGrNObT8Cegd9K\nrJtqzjTtWMuoUSbZwNmr9jS9fGLD1cWb8lgnjfdFkjtKNG0PUu9iL6rsptye3iXm\n4rd3P8mgoFauizjDlzaDA48yqr6bcs6KyQrnKl+9jgAQvgvJDgCETKg=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100646
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42946
received auth hello!
{ authId: 502, nonce: <Buffer 2c af c9 3d ed d8 1d 3f> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 89 67 66 c5 d9 79 f8 db>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 18 1f e0 67 a9 1c 1d a9 d2 9d 12 a5 c5 e2 cd 28>,
  macKeyVal: <Buffer 01 af 88 a8 e1 7a bc 75 37 c5 2e 90 1c f0 9a 59 3f 9a 9c 43 46 90 8e 5a 01 2c fb 2c bc f1 fd 66>,
  absValidity: 2018-03-21T02:33:11.153Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 24 e4 f7 bb 92 4f 8d d6>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 24 e4 f7 bb 92 4f 8d d6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.85:43716',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100655
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43172
received auth hello!
{ authId: 502, nonce: <Buffer 0e 4a 23 fd 86 67 83 ff> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4e 99 73 68 5c 69 db 0c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fc 20 95 2e cc 4b e2 cb>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer fc 20 95 2e cc 4b e2 cb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.84:56716',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100656
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43186
received auth hello!
{ authId: 502, nonce: <Buffer 4b bf dd 7a 9b 1e f1 7c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6a c2 85 1a 71 3d 8e 46>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 85 0a 09 6f eb cb 3d c2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 85 0a 09 6f eb cb 3d c2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.85:43954',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100667
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43426
received auth hello!
{ authId: 502, nonce: <Buffer 16 3a 40 c0 4d 54 4c 9a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 90 33 65 da 68 1e 47 26>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f7 85 fa 6b 51 18 9c f6>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f7 85 fa 6b 51 18 9c f6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.84:56970',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100668
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43444
received auth hello!
{ authId: 502, nonce: <Buffer f6 f5 2b a1 b1 3a e9 f2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7e f2 2e 94 37 d4 0b 0d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7e 1a 16 b5 df 75 04 29>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 7e 1a 16 b5 df 75 04 29> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.85:44212',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100678
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43680
received auth hello!
{ authId: 502, nonce: <Buffer 1e 59 60 d6 11 80 d2 bf> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3b 9f 16 e6 e3 82 c2 48>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 76 b3 16 7a 63 6a ca a5>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 76 b3 16 7a 63 6a ca a5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.84:57222',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100679
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43696
received auth hello!
{ authId: 502, nonce: <Buffer 65 b9 b8 bf 7a 97 71 fe> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7f 71 dd 34 ca 60 16 dd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c5 2a fa 07 e4 8f 0f bd>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c5 2a fa 07 e4 8f 0f bd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.85:44464',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100690
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43932
received auth hello!
{ authId: 502, nonce: <Buffer 24 c5 87 ad 69 56 56 a6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a0 ec 3c d0 07 a8 34 b6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0c 83 a8 96 b6 ac 82 a5>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 0c 83 a8 96 b6 ac 82 a5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.84:57476',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100691
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43948
received auth hello!
{ authId: 502, nonce: <Buffer 6c e1 f5 74 5e 41 f9 65> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 42 fd 8a da 36 10 5d 15>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 13 cb f0 3a 41 66 2a 12>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 13 cb f0 3a 41 66 2a 12> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.85:44718',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100703
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44200
received auth hello!
{ authId: 502, nonce: <Buffer 51 76 5f f5 ba f4 2a 48> }
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f0 7d ca 17 ad 90 71 15>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fc 50 39 63 25 41 0a 29>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fc 50 39 63 25 41 0a 29> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.85:44966',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100704
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44210
received auth hello!
{ authId: 502, nonce: <Buffer 87 3f f3 b4 0f a8 a4 86> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fb 4c 57 01 99 85 92 70>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5a 7c 69 55 7b 11 51 5a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5a 7c 69 55 7b 11 51 5a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.84:57750',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100713
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44424
received auth hello!
{ authId: 502, nonce: <Buffer 1a ac 08 f6 23 c8 67 7e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7b 27 0d 1f fa f0 d7 3b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9a 2f 55 9c 15 01 79 f3>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 9a 2f 55 9c 15 01 79 f3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.84:57968',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100717
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44480
received auth hello!
{ authId: 502, nonce: <Buffer 2a 1b 00 41 8c d9 76 fe> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4f 5c 07 db 06 fa fe d7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9b 21 ee 69 8b f0 db 5f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9b 21 ee 69 8b f0 db 5f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 24,
  remoteAddress: '::ffff:10.0.1.85:45250',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 24 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 24 }
specified socketID: 24
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100725
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44670
received auth hello!
{ authId: 502, nonce: <Buffer 21 66 35 44 cf 64 ce 70> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 21 d5 28 27 ed 8d ea b4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c0 2c 0f fe f1 b6 6a 68>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c0 2c 0f fe f1 b6 6a 68> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 25,
  remoteAddress: '::ffff:10.0.1.84:58214',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 25 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 25 }
specified socketID: 25
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #24 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100727
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44700
received auth hello!
{ authId: 502, nonce: <Buffer 49 8d ab 3f 1b b9 ae 3c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8c e9 b7 71 d0 df 0d 2b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 27 fb c9 1e ca f3 11 d3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 27 fb c9 1e ca f3 11 d3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 26,
  remoteAddress: '::ffff:10.0.1.85:45470',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 26 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 26 }
specified socketID: 26
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #25 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100738
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44920
received auth hello!
{ authId: 502, nonce: <Buffer c5 9c 6c 68 49 f7 94 ff> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0e e4 55 43 a6 8e 12 ce>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5a ff e4 6c c9 13 7b 18>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5a ff e4 6c c9 13 7b 18> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 27,
  remoteAddress: '::ffff:10.0.1.84:58462',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 27 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 27 }
specified socketID: 27
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #26 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100740
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44948
received auth hello!
{ authId: 502, nonce: <Buffer ff 5b f8 50 f5 b3 38 1f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ba 88 e4 ca fe b8 ef 47>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3c 54 1e d5 21 24 81 15>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3c 54 1e d5 21 24 81 15> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 28,
  remoteAddress: '::ffff:10.0.1.85:45718',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 28 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 28 }
specified socketID: 28
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #28 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100751
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45182
received auth hello!
{ authId: 502, nonce: <Buffer 8b 86 63 c4 8b 09 c5 28> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 60 56 7d f8 49 b9 f0 15>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 64 8e bc 2b 5b e9 0d 4f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 64 8e bc 2b 5b e9 0d 4f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 29,
  remoteAddress: '::ffff:10.0.1.85:45950',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 29 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 29 }
specified socketID: 29
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #27 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100752
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45194
received auth hello!
{ authId: 502, nonce: <Buffer 13 7c 8c 26 4d 38 30 68> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f3 4d a6 7c f0 2b 7b 97>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 41 fb 10 b9 9f 24 e1 28>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 41 fb 10 b9 9f 24 e1 28> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 30,
  remoteAddress: '::ffff:10.0.1.84:58738',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 30 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 30 }
specified socketID: 30
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #29 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100763
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45420
received auth hello!
{ authId: 502, nonce: <Buffer fe 26 d7 b9 0c 3f f5 71> }
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #30 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100764
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7c 51 89 46 b4 41 5d 29>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3d 04 90 1f 5b 7b e3 ec>
switching to HANDSHAKE_2_SENT
disconnected from auth
connected to auth! from local port 45428
received session key handshake3!
{ replyNonce: <Buffer 3d 04 90 1f 5b 7b e3 ec> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 31,
  remoteAddress: '::ffff:10.0.1.85:46188',
  status: 'open' }
received auth hello!
{ authId: 502, nonce: <Buffer 09 6e 94 5d 3e fa d9 6d> }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 31 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 31 }
specified socketID: 31
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 83 42 ad 6d b4 87 70 e1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cf 31 a9 b9 ef eb 6c 04>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer cf 31 a9 b9 ef eb 6c 04> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 32,
  remoteAddress: '::ffff:10.0.1.84:58972',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 32 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 32 }
specified socketID: 32
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #31 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100775
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45658
received auth hello!
{ authId: 502, nonce: <Buffer b1 ad 34 3b 8f aa 6a 75> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 60 70 67 d7 42 3d f8 3b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b7 76 73 8f 22 4e 33 1d>
switching to HANDSHAKE_2_SENT
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #32 closed
received session key handshake3!
{ replyNonce: <Buffer b7 76 73 8f 22 4e 33 1d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 33,
  remoteAddress: '::ffff:10.0.1.85:46426',
  status: 'open' }
disconnected from auth
Unidentified client connected
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 33 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 33 }
specified socketID: 33
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100776
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45668
received auth hello!
{ authId: 502, nonce: <Buffer 56 ee 9b 10 77 fd ec 25> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 21 f4 9a 9e 8f 3d 8c 71>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 74 5f 85 05 32 a4 71 4a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 74 5f 85 05 32 a4 71 4a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 34,
  remoteAddress: '::ffff:10.0.1.84:59210',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 34 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 34 }
specified socketID: 34
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #34 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100789
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45916
received auth hello!
{ authId: 502, nonce: <Buffer c1 4f 74 e3 ba 58 e3 12> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e3 ea 31 1b b6 80 d0 d7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 40 47 63 73 31 9c 7d 85>
switching to HANDSHAKE_2_SENT
disconnected from auth
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #33 closed
received session key handshake3!
{ replyNonce: <Buffer 40 47 63 73 31 9c 7d 85> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 35,
  remoteAddress: '::ffff:10.0.1.84:59462',
  status: 'open' }
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100790
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 35 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 35 }
specified socketID: 35
connected to auth! from local port 45922
received auth hello!
{ authId: 502, nonce: <Buffer c9 aa 6f 70 b2 24 7c 94> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f7 2a f6 a2 14 5a c6 12>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a7 9e e0 56 db c9 17 e7>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer a7 9e e0 56 db c9 17 e7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 36,
  remoteAddress: '::ffff:10.0.1.85:46692',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 36 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 36 }
specified socketID: 36
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #35 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100799
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46124
received auth hello!
{ authId: 502, nonce: <Buffer bf 90 08 5a d6 e8 01 0c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4c ea 8f 34 4a 71 aa 59>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 44 e3 a2 bb 7d f9 3d ee>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 44 e3 a2 bb 7d f9 3d ee> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 37,
  remoteAddress: '::ffff:10.0.1.84:59670',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 37 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 37 }
specified socketID: 37
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #36 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100802
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46160
received auth hello!
{ authId: 502, nonce: <Buffer 15 aa 05 8e 03 18 f0 c4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1d c1 fa d0 6e c7 f3 45>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 26 4f b1 b8 ce b0 ed c2>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 26 4f b1 b8 ce b0 ed c2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 38,
  remoteAddress: '::ffff:10.0.1.85:46930',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 38 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 38 }
specified socketID: 38
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #38 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100811
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46370
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #37 closed
received auth hello!
{ authId: 502, nonce: <Buffer 0f 5a bb 0e 99 a8 8d 71> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8a e6 48 d0 ca 16 2f 75>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0c 1b 72 1a 33 06 e8 21>
switching to HANDSHAKE_2_SENT
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100812
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0c 1b 72 1a 33 06 e8 21> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 39,
  remoteAddress: '::ffff:10.0.1.85:47138',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 39 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 39 }
specified socketID: 39
connected to auth! from local port 46378
received auth hello!
{ authId: 502, nonce: <Buffer ff d6 11 6f fc d5 ba 5b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 09 82 3e e2 6f e2 75 82>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8c 76 2c bc be b1 bc e5>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 8c 76 2c bc be b1 bc e5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 40,
  remoteAddress: '::ffff:10.0.1.84:59922',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 40 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 40 }
specified socketID: 40
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #40 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100824
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46626
received auth hello!
{ authId: 502, nonce: <Buffer 23 a6 e6 f0 25 ce 24 9b> }
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #39 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100825
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4d ed 58 de 04 c5 15 c3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4e 2a 96 b2 a2 df 1c 7d>
switching to HANDSHAKE_2_SENT
disconnected from auth
connected to auth! from local port 46630
received session key handshake3!
{ replyNonce: <Buffer 4e 2a 96 b2 a2 df 1c 7d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 41,
  remoteAddress: '::ffff:10.0.1.84:60170',
  status: 'open' }
received auth hello!
{ authId: 502, nonce: <Buffer 15 e4 57 ab 0d 25 70 5a> }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 41 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 41 }
specified socketID: 41
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7c 87 65 ef 3f e5 e6 87>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c1 71 49 e3 22 e2 7f 5e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c1 71 49 e3 22 e2 7f 5e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 42,
  remoteAddress: '::ffff:10.0.1.85:47400',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 42 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 42 }
specified socketID: 42
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #41 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100829
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46786
received auth hello!
{ authId: 502, nonce: <Buffer 80 80 9f e4 2f 4a 32 8d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a0 96 89 46 af 56 0f 64>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7b 83 a0 3b 5d fb f3 b6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 7b 83 a0 3b 5d fb f3 b6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 43,
  remoteAddress: '::ffff:10.0.1.84:60332',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 43 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 43 }
specified socketID: 43
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #42 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100830
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46796
received auth hello!
{ authId: 502, nonce: <Buffer d4 5b e8 0e cf 8e 6d be> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ab 71 1c 05 02 ec a3 89>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ed a9 f9 35 dd 99 b2 5b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ed a9 f9 35 dd 99 b2 5b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 44,
  remoteAddress: '::ffff:10.0.1.85:47566',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 44 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 44 }
specified socketID: 44
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #43 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100833
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46856
received auth hello!
{ authId: 502, nonce: <Buffer 3e 43 3d 98 00 c4 b6 4e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 63 e4 b5 7f 68 f3 03 18>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7f 5d ac 78 6c fa d6 59>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 7f 5d ac 78 6c fa d6 59> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 45,
  remoteAddress: '::ffff:10.0.1.84:60402',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 45 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 45 }
specified socketID: 45
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #45 closed
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #44 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100834
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46862
received auth hello!
{ authId: 502, nonce: <Buffer 3d 97 51 a3 d8 b7 0d 1b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c5 c8 5c da 0e c2 32 3a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c6 c6 a6 ae 32 36 48 2d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c6 c6 a6 ae 32 36 48 2d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 46,
  remoteAddress: '::ffff:10.0.1.85:47632',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 46 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 46 }
specified socketID: 46
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #46 closed
