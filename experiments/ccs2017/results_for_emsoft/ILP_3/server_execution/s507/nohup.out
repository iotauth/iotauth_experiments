changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s507.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's507',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 51 49 42 41 41 4b 43 41 51 45 41 71 58 ... > }
Handler: listening on port 22100
s507:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100482
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39936
received auth hello!
{ authId: 501, nonce: <Buffer 47 66 cf 31 94 d6 9f 3c> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer cc 21 aa 50 e7 75 4a b8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer ab 03 24 af 0c 87 72 e1 52 84 c6 7a c9 82 91 f6>,
  macKeyVal: <Buffer 36 6d e3 cf d7 9f 01 4e f2 9f 61 18 50 b7 01 87 f3 3a 3b 8d a1 dc 1d a5 db 2e 20 54 93 9a c5 91>,
  absValidity: 2018-03-21T02:22:20.521Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 64 c9 b5 60 10 ae 09 b1>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 64 c9 b5 60 10 ae 09 b1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.71:53606',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100490
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40208
received auth hello!
{ authId: 501, nonce: <Buffer 06 f1 a7 1c 62 ad fa be> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 66 f2 17 c2 56 f2 01 a6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a2 28 5b 79 11 b6 ab df>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer a2 28 5b 79 11 b6 ab df> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.71:53878',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100498
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40478
received auth hello!
{ authId: 501, nonce: <Buffer 2e bc 63 d7 15 b3 05 a5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer df 7a 05 00 c7 ab ed 5c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer af 7a 84 73 d8 47 a5 93>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer af 7a 84 73 d8 47 a5 93> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.71:54148',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100506
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40748
received auth hello!
{ authId: 501, nonce: <Buffer aa c8 5a c7 41 af 0c 1a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 47 07 15 c4 50 19 8e 44>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 73 f7 ce f4 f0 8a 29 ac>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 73 f7 ce f4 f0 8a 29 ac> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.71:54418',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100514
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41018
received auth hello!
{ authId: 501, nonce: <Buffer e7 54 77 8e 41 35 5e aa> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 98 42 57 62 b4 69 4a 83>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 04 5a 57 31 61 35 59 fd>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 04 5a 57 31 61 35 59 fd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.71:54688',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100522
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41288
received auth hello!
{ authId: 501, nonce: <Buffer d4 50 1b 06 65 3b 50 45> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 40 5e 92 68 44 46 89 63>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 12 2a 7f 20 f3 30 fb a8>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 12 2a 7f 20 f3 30 fb a8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.71:54958',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100530
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41558
received auth hello!
{ authId: 501, nonce: <Buffer 9e 58 c0 28 1f 48 be e1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 84 5d ce cd 32 30 08 a8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8c 5d 4c 63 34 79 c4 0d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8c 5d 4c 63 34 79 c4 0d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.71:55228',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300396
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300403
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 44272
received auth hello!
{ authId: 403, nonce: <Buffer 0c d7 c8 3d ee 1a 8c ec> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth403',
     commonName: '10.0.1.3' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '01624623E58D',
  notBefore: 2018-03-21T01:18:00.000Z,
  notAfter: 2018-03-22T01:19:40.000Z,
  subjectHash: 'f6675d02',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '56:5D:AC:25:70:82:DD:65:23:0A:A7:4C:BD:7E:D6:03:5F:C0:D4:71',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'DA5E4B2957DB930964D6A6BC73B4C5B0573233EDAB8FA699AFCE0B6FD4139C8AF167CC4E348BE663C4497A7DA04150BB82DAB74CA33BEB6FEA6CF1D44D9FD7A552F9D07D184D49FBEE0F3F39DE1146769BAC715DC1896EF06B18523F3B401ABBFD13226B40966C673DEA5E4AD7DE42F1996628F72E480DCE5015CCE37D7076E64852E17482D4C7C490663301D5E9C4C717F6407934723A89CCDD89D06DA86F81924F100026AA93E7D9F02EE5B56D46B147E4F357B2964174C697245B089C9B38E50CEFCF6C8056D23494C5C1D07E0E67B7F10D157DDD4DE333C914B19EFC3BD3D3E39F67DE804BD47921F99CA14A0CF26DBF219CA00136801BF3CB89F57A9F49',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.3' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 403,
  host: '10.0.1.3',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJGI+WNMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDMy\nMTAxMTgwMFoXDTE4MDMyMjAxMTk0MFowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDQwMzERMA8GA1UEAwwIMTAuMC4xLjMwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDaXkspV9uTCWTWprxztMWwVzIz7auPppmvzgtv1BOcivFnzE40\ni+ZjxEl6faBBULuC2rdMozvrb+ps8dRNn9elUvnQfRhNSfvuDz853hFGdpuscV3B\niW7waxhSPztAGrv9EyJrQJZsZz3qXkrX3kLxmWYo9y5IDc5QFczjfXB25khS4XSC\n1MfEkGYzAdXpxMcX9kB5NHI6iczdidBtqG+Bkk8QACaqk+fZ8C7ltW1GsUfk81ey\nlkF0xpckWwicmzjlDO/PbIBW0jSUxcHQfg5nt/ENFX3dTeMzyRSxnvw709Pjn2fe\ngEvUeSH5nKFKDPJtvyGcoAE2gBvzy4n1ep9JAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQMwDQYJKoZIhvcNAQELBQADggEBAJ6yOPnEmfcMG2xHUlMuSd0j1VJ7wdLk\nTqbncmyGUk4W1POLZHrO/wrSDDWrEd/U/skk9gcUWzfbONiDRHZtBHHIAar8mcfi\n/19e0CS5bCPt0aZb467tSOMsa/duFrMZb+923vwEmsCrCDGNfSpNkLpJodgF8GNs\nvPJP1FhXfilhJtjnOUUXmOmblUXB40EDspAdv8Q4hc0M7/x5RBLYngfp6rKqU+H1\nRIZTnQhpBzws9SsmZwxWBsPg38HLkduj8Ygpnyr9aO7eSi5O/Zhi3bsEI/SIYlmA\n2KjbZyP5bbwugCPkVKr0anXeIKXTQz55706Q7hSGV+gG1ekfNaXpmgQ=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300410
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44526
received auth hello!
{ authId: 403, nonce: <Buffer e2 03 c4 a3 d2 bc 90 3b> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer e0 b8 77 c8 e1 0c 4e f5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 6b 75 88 7e d7 2c ca 30 9c aa 55 3e c2 0c bb 60>,
  macKeyVal: <Buffer 9f 0f f2 63 ab 73 0f ae 8e ff 69 51 28 17 80 aa 91 34 24 8e 19 53 1f 63 f8 d6 07 4a 7a 38 78 4d>,
  absValidity: 2018-03-21T02:33:19.455Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 28 d0 74 51 65 6d 6a 7d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 28 d0 74 51 65 6d 6a 7d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.71:56396',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300417
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44776
received auth hello!
{ authId: 403, nonce: <Buffer 7a 06 f2 90 15 28 54 15> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 24 d4 55 d8 07 94 20 84>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1c 38 23 db 77 1a 61 3b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1c 38 23 db 77 1a 61 3b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.71:56644',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300424
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45028
received auth hello!
{ authId: 403, nonce: <Buffer 88 56 fa 85 8a 12 1a c0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5d 85 50 a5 d2 d5 71 f6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3c 6e 21 d8 57 dc 22 d8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3c 6e 21 d8 57 dc 22 d8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.71:56896',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300431
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45286
received auth hello!
{ authId: 403, nonce: <Buffer 88 a7 04 36 ba 69 2b 16> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5e 52 fb 58 21 b9 ee 1b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7f 34 8e 33 db a4 8e b7>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 7f 34 8e 33 db a4 8e b7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.71:57156',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300438
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45536
received auth hello!
{ authId: 403, nonce: <Buffer e5 d1 9d 1a 2e cf 91 6f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6a e6 aa 85 7d 77 22 0e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 29 0c ac e3 9a c6 7e 88>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 29 0c ac e3 9a c6 7e 88> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.71:57406',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300445
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45780
received auth hello!
{ authId: 403, nonce: <Buffer 19 13 46 29 35 93 92 5a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 37 5a 0b f2 57 96 ae f0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0a 84 3b bb e9 b2 d9 c4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0a 84 3b bb e9 b2 d9 c4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.71:57650',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300452
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46026
received auth hello!
{ authId: 403, nonce: <Buffer ff 58 5d 0e 31 cf 74 bf> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 46 f4 52 e3 b6 53 80 f9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a8 ad dc 68 7e b2 22 ab>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a8 ad dc 68 7e b2 22 ab> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.71:57896',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300459
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46274
received auth hello!
{ authId: 403, nonce: <Buffer e9 0f c9 56 48 c3 c4 d7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7b 39 eb 31 05 79 3f ab>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 95 09 f0 2e 24 a7 79 5c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 95 09 f0 2e 24 a7 79 5c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.71:58142',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300466
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46522
received auth hello!
{ authId: 403, nonce: <Buffer a9 8f b2 9f c6 cc e6 48> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer af 34 6d 25 ec 88 60 5b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4d 96 75 3c b7 55 a0 db>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4d 96 75 3c b7 55 a0 db> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.71:58390',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300473
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46764
received auth hello!
{ authId: 403, nonce: <Buffer fa 7d 24 a9 0c ed 69 40> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d0 87 4d 84 ec 13 0b 7e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 46 f9 fd 68 e7 42 a9 e8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 46 f9 fd 68 e7 42 a9 e8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.71:58634',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300480
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47002
received auth hello!
{ authId: 403, nonce: <Buffer da 30 81 0a 86 18 c8 de> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c6 6b 78 d9 7d 29 b2 6e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c3 ae 93 52 ef ad 91 a8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c3 ae 93 52 ef ad 91 a8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.71:58872',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300487
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47240
received auth hello!
{ authId: 403, nonce: <Buffer eb e0 a8 c3 74 50 dd ed> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 95 dd 14 52 d6 88 99 18>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 47 d3 19 f2 29 ed 03 0c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 47 d3 19 f2 29 ed 03 0c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.71:59110',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300494
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47478
received auth hello!
{ authId: 403, nonce: <Buffer b8 4c a8 ee 7a 0a 94 45> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5f 87 55 42 f5 fa 90 40>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d2 47 84 57 88 39 54 d0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d2 47 84 57 88 39 54 d0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.71:59348',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300501
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47710
received auth hello!
{ authId: 403, nonce: <Buffer 4c f3 32 09 32 70 74 53> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1c c0 da 88 f2 7b 13 c2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 44 61 27 ec 2f 22 55 81>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 44 61 27 ec 2f 22 55 81> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.71:59580',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300508
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47948
received auth hello!
{ authId: 403, nonce: <Buffer 86 7c 55 f1 fa 99 ec 84> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 46 df 91 d1 63 8f 74 3e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 69 da 88 e7 29 4c d5 f1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 69 da 88 e7 29 4c d5 f1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.71:59818',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300515
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48184
received auth hello!
{ authId: 403, nonce: <Buffer 5d 93 38 ab 1d 77 f2 f3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer af 38 e6 00 03 da 72 31>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 22 2e b9 0f fd 53 e5 27>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 22 2e b9 0f fd 53 e5 27> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.71:60054',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
