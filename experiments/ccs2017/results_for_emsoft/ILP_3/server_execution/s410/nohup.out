changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s410.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's410',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 76 6a ... > }
Handler: listening on port 22100
s410:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200255
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54974
received auth hello!
{ authId: 402, nonce: <Buffer 7f f6 4d a4 ac 7a f2 e9> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 6a 33 50 94 1d 89 05 18>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 81 53 64 2a c6 a4 c3 06 53 d4 83 51 19 c5 97 f1>,
  macKeyVal: <Buffer b9 de e0 fe 81 97 f2 47 26 d1 c1 55 0e 2a 98 23 65 df ed 07 34 4e c1 92 28 a8 22 ad 35 dd 51 fb>,
  absValidity: 2018-03-21T02:21:21.838Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d7 0f a7 70 9f eb 0a 93>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d7 0f a7 70 9f eb 0a 93> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.53:57638',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200262
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55148
received auth hello!
{ authId: 402, nonce: <Buffer af 21 53 c9 eb af 73 82> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1c 0e e6 54 20 a9 2a f3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer da 22 b6 93 05 91 45 d1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer da 22 b6 93 05 91 45 d1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.53:57812',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200269
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55420
received auth hello!
{ authId: 402, nonce: <Buffer 12 4d 73 d3 1d b0 ed be> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8d be 68 bc d1 03 f2 c7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9a d6 a3 d4 a8 76 24 b0>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 9a d6 a3 d4 a8 76 24 b0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.53:58084',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200276
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55690
received auth hello!
{ authId: 402, nonce: <Buffer 8e d0 c7 dc b9 72 bb 23> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cd 47 49 af be 8e ff ef>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8d d2 f0 88 cb 97 54 16>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8d d2 f0 88 cb 97 54 16> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.53:58354',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200283
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55960
received auth hello!
{ authId: 402, nonce: <Buffer 5c 9a 1b e1 0e 41 6c ad> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ff e8 08 e3 4d 8e 36 19>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f9 d1 07 fd d3 9c e5 c4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f9 d1 07 fd d3 9c e5 c4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.53:58624',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200290
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56230
received auth hello!
{ authId: 402, nonce: <Buffer c4 8e 07 37 b3 29 aa 80> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a5 20 66 de f0 b9 3c 08>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer de 1c c3 19 f0 02 fd 31>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer de 1c c3 19 f0 02 fd 31> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.53:58894',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200297
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56500
received auth hello!
{ authId: 402, nonce: <Buffer f6 60 da db 61 c9 7f 59> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 77 8a 84 d2 80 de ba 56>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 63 06 0e b5 bc 9b 35 46>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 63 06 0e b5 bc 9b 35 46> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.53:59164',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200304
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56770
received auth hello!
{ authId: 402, nonce: <Buffer e3 b1 9a 40 0c 2b f9 a7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 85 42 97 14 1d 6a 83 79>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3e 84 30 3f c8 04 2b e3>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 3e 84 30 3f c8 04 2b e3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.53:59434',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
