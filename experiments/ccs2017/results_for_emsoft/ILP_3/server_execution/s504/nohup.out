changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s504.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's504',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 37 44 ... > }
Handler: listening on port 22100
s504:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100478
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39140
received auth hello!
{ authId: 501, nonce: <Buffer 65 2e 94 58 7f 29 8a 91> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer ec 3d 8e 80 81 21 86 06>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 2c 22 01 d8 5f ca c4 71 4b 91 0a 08 fe d2 8d e0>,
  macKeyVal: <Buffer e7 00 32 98 38 b1 c1 b5 8c e2 64 47 7d 65 2f 6b 17 a1 f4 d7 80 1b 4e 78 bb ec 20 64 a9 aa ce 28>,
  absValidity: 2018-03-21T02:22:06.121Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f3 1a b6 85 a8 3d ee bb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f3 1a b6 85 a8 3d ee bb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.67:60022',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100486
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39396
received auth hello!
{ authId: 501, nonce: <Buffer da 19 ed 82 b7 2b 28 6e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 51 50 7a d0 68 83 17 e4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f1 5a 0c 90 5d 38 a5 d5>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f1 5a 0c 90 5d 38 a5 d5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.67:60278',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100494
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39666
received auth hello!
{ authId: 501, nonce: <Buffer e8 b4 85 c9 bd 97 78 0b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1a ec ef 70 fc 3b 3b 88>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 35 77 e7 1e 75 45 db e3>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 35 77 e7 1e 75 45 db e3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.67:60548',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100502
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39936
received auth hello!
{ authId: 501, nonce: <Buffer 36 d3 29 0b b4 8d b7 b6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 76 7e df 01 d5 86 d0 11>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4f 1e 2c 99 fe 1d 82 ce>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4f 1e 2c 99 fe 1d 82 ce> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.67:60818',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100510
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40206
received auth hello!
{ authId: 501, nonce: <Buffer 90 2b 88 95 78 a4 61 ee> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 93 f9 3f e3 4b ae 6e 26>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 67 03 47 c8 ef 73 25 21>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 67 03 47 c8 ef 73 25 21> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.67:32856',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100518
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40476
received auth hello!
{ authId: 501, nonce: <Buffer ee 4d b3 d9 8c 0f e9 6e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9d b8 33 dd 40 07 bf ca>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 42 11 dd 37 f9 35 38 19>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 42 11 dd 37 f9 35 38 19> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.67:33126',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100526
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40746
received auth hello!
{ authId: 501, nonce: <Buffer 3b c4 76 0a de 40 71 4b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f7 ca 5f 4a 62 2a fc 10>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 10 30 6c b0 91 ce 40 a6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 10 30 6c b0 91 ce 40 a6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.67:33396',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200467
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200481
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 35196
received auth hello!
{ authId: 503, nonce: <Buffer c0 e5 4d ca 39 f5 45 1a> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in server - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200496
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 35454
received auth hello!
{ authId: 503, nonce: <Buffer ee 6b 02 1f fa e4 8d 8f> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in server - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200511
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 32900
received auth hello!
{ authId: 502, nonce: <Buffer 3c 47 de 2c fa 72 20 fd> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '01624623E601',
  notBefore: 2018-03-21T01:18:00.000Z,
  notAfter: 2018-03-22T01:19:40.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'D6:19:40:AB:3E:00:B6:23:CE:36:36:45:7E:4D:2F:62:1F:9D:05:08',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'FF6CB5202497CC77AF28EFDE774858E4FEF04355E5228E378962DF4235BE3683DAF9E38A7E22621D66B3B50166D897E97BF911F9E8FC09D686961AA39679014E5DDD27EA0F02DE853A41537DB5E37F33395E249F355C0D074419572E9856D1D598CAB2CD6951013DDCB0A163B943DFCD2694BE18B9B3892695B3052EBD9115D447293C83AF24A008794B842E4F0A6C2A8D0189612A600AA40A592603E43713C0ECCA681024E5EC429FAD09484B824919DF59C8BD488E0D372D2A3D8B99B6068E24BBBDA8F0BCDDBA806010E4A7181736DF08D4D1CFC16E26507C360EDCBFF1B5F4288CE304DE62E9696665C5108489AD7232658356998FF47C4F7E8A04225423',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJGI+YBMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDMy\nMTAxMTgwMFoXDTE4MDMyMjAxMTk0MFowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQD/bLUgJJfMd68o7953SFjk/vBDVeUijjeJYt9CNb42g9r544p+\nImIdZrO1AWbYl+l7+RH56PwJ1oaWGqOWeQFOXd0n6g8C3oU6QVN9teN/MzleJJ81\nXA0HRBlXLphW0dWYyrLNaVEBPdywoWO5Q9/NJpS+GLmziSaVswUuvZEV1EcpPIOv\nJKAIeUuELk8KbCqNAYlhKmAKpApZJgPkNxPA7MpoECTl7EKfrQlIS4JJGd9ZyL1I\njg03LSo9i5m2Bo4ku72o8LzduoBgEOSnGBc23wjU0c/BbiZQfDYO3L/xtfQojOME\n3mLpaWZlxRCEia1yMmWDVpmP9HxPfooEIlQjAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBACYAxx/1Plb2s1TKvTv9hQ1ZUaSaDEMr\nAKRqeJ3b5eFj96Z4Pw1N90OPnPwVN3MRQ86jnT9ogyArLPAfsy6+rZ4hBjuaAFBv\n1ZaaSylRiY6OZty9VXfBbBDXRDYbgT2neLYqBzlKyydStphAkSeaBBm+bcA6+Alr\n06bGwFmPzaYXCfzo6TZC1F38lvhHp4cPw+7VThcDfx5c3QJpC+KmF7C8wMr5uW5R\n/kEXER4og0NE5F15Pc6EM/4qeMnBPQuXO4NHRcsdAyHZUMpb0Rl8lZHZ7ZJ0cdiO\ns9Gmyq1Ae6EM7au/hlF2MnyfoaPzZsBOkujJD07p4aY8Elc/gbsUtGQ=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 1
to: 2
Handler: Error in server - details: handshake2 timed out...
disconnected from auth
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200526
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33138
received auth hello!
{ authId: 502, nonce: <Buffer 71 39 1f c1 39 c5 a1 93> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 99 39 c7 1e f7 f7 c0 62>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer b9 cb 85 6c 72 ec bd d7 12 63 ba 8a 90 04 d4 00>,
  macKeyVal: <Buffer 8f d3 30 52 1c fa a7 ab fc 61 20 0e 09 af 3d 50 d7 77 c5 ca 2c 92 c4 39 84 34 f8 9b fa cb 66 1f>,
  absValidity: 2018-03-21T02:37:07.275Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 42 3e bc a1 af de 59 e1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 42 3e bc a1 af de 59 e1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.67:35574',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200541
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33382
received auth hello!
{ authId: 502, nonce: <Buffer ed 46 51 68 f5 d1 6a 9f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ed 6b ba ea e0 15 27 d3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4f 45 71 ba 73 d0 ef be>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4f 45 71 ba 73 d0 ef be> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.67:35818',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200556
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33630
received auth hello!
{ authId: 502, nonce: <Buffer 21 63 41 f2 f5 d4 80 3e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c9 18 3e 31 e9 a0 94 8e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 07 81 2e 62 36 2f f0 2e>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 07 81 2e 62 36 2f f0 2e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.67:36066',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200571
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33876
received auth hello!
{ authId: 502, nonce: <Buffer 5f 52 ee 61 02 04 c7 f9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 56 ad 66 3e bf cb 63 41>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0d cb 81 41 13 c8 20 2b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0d cb 81 41 13 c8 20 2b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.67:36312',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200586
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34124
received auth hello!
{ authId: 502, nonce: <Buffer 73 40 77 38 07 83 64 7d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6d 24 ec ec ab da 62 54>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0e 5b 0e c4 57 59 1b 80>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 0e 5b 0e c4 57 59 1b 80> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.67:36558',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200601
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34370
received auth hello!
{ authId: 502, nonce: <Buffer 27 35 e2 6c 71 fa ce 6b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 98 81 00 9a 96 35 a1 3d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 70 c5 88 f7 ad a0 c7 fc>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 70 c5 88 f7 ad a0 c7 fc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.67:36806',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200616
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34608
received auth hello!
{ authId: 502, nonce: <Buffer 48 f2 1c f6 84 dc 76 d5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f3 1b 49 bd 81 50 b4 bc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 64 31 40 a8 b0 67 e3 b2>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 64 31 40 a8 b0 67 e3 b2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.67:37044',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200631
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34846
received auth hello!
{ authId: 502, nonce: <Buffer 10 ba 73 6b c6 9b fb c0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 46 7c 76 ae 7e b6 84 4b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ab 4f 0f bc ba e2 fd 87>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ab 4f 0f bc ba e2 fd 87> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.67:37282',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200646
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35084
received auth hello!
{ authId: 502, nonce: <Buffer 38 64 6f eb 9c 7a c8 66> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fa 24 c1 16 59 55 2d bf>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 51 4e 61 15 31 85 22 b4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 51 4e 61 15 31 85 22 b4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.67:37520',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200661
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35322
received auth hello!
{ authId: 502, nonce: <Buffer 16 d0 5b c1 77 61 c0 89> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f7 16 63 ae c6 66 0c 09>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d4 91 a1 c3 1a 01 52 3f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d4 91 a1 c3 1a 01 52 3f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.67:37758',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200676
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35554
received auth hello!
{ authId: 502, nonce: <Buffer fb d0 e9 de 66 8d 98 de> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 36 d2 37 3d c3 a9 19 18>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d1 d9 c8 27 bd 62 6a b4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d1 d9 c8 27 bd 62 6a b4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.67:37990',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200691
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35792
received auth hello!
{ authId: 502, nonce: <Buffer 9b 69 ac 90 79 91 6d 23> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9f ee 54 47 ca 6c 2a 70>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0a 1d 04 b4 a7 16 03 f7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0a 1d 04 b4 a7 16 03 f7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.67:38228',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200706
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36004
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
received auth hello!
{ authId: 502, nonce: <Buffer f3 9a 4f fe 2d 37 2a 51> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d1 78 4e ba ed 2d 4d 6a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5c 6c 70 95 b7 50 30 a0>
Handler: Error in server - details: Error during comm init, details: Error: This socket has been ended by the other party
switching to HANDSHAKE_2_SENT
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
