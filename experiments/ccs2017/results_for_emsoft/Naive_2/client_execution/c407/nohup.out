changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c407.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c407',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 67 49 42 41 41 4b 43 41 51 45 41 31 44 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521569539679
connected to auth! from local port 42692
received auth hello!
{ authId: 402, nonce: <Buffer 94 12 4d 03 61 2f d1 84> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer e9 78 25 76 52 4d e5 12>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 0b 0f ff c2 bb f0 b0 2d 81 35 70 71 0f ec d7 e3>,
  macKeyVal: <Buffer 24 29 07 ca 3e fe bf df 9f e5 dd 08 2b 42 cf 30 3d d4 b4 86 14 55 fb 77 6d 85 ee d4 51 b8 d3 e1>,
  absValidity: 2018-03-20T19:12:19.851Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200196,
  cipherKeyVal: <Buffer e7 77 c6 9f f2 ac f6 d5 03 59 9f 51 25 3e 79 4c>,
  macKeyVal: <Buffer ec e5 65 a4 ce fd 90 df ad 17 b9 6a 62 3b f8 b1 f5 46 9b 28 20 06 39 c9 43 91 7a e5 9c dd cb d0>,
  absValidity: 2018-03-21T18:12:19.848Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200196,
     cipherKeyVal: <Buffer e7 77 c6 9f f2 ac f6 d5 03 59 9f 51 25 3e 79 4c>,
     macKeyVal: <Buffer ec e5 65 a4 ce fd 90 df ad 17 b9 6a 62 3b f8 b1 f5 46 9b 28 20 06 39 c9 43 91 7a e5 9c dd cb d0>,
     absValidity: 2018-03-21T18:12:19.848Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 4d 0a b7 5b 7e b1 40 02>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 18:12:20 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521569540796
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521569599738
connected to auth! from local port 42842
received auth hello!
{ authId: 402, nonce: <Buffer ef 27 56 9e 7a 82 f3 bd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6e c7 12 bc c6 2a 2e b4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200203,
  cipherKeyVal: <Buffer 97 dc b8 1a fb f2 a4 bf 55 25 81 39 62 b9 96 6e>,
  macKeyVal: <Buffer 6b af ed 4c f1 e4 da 76 de f7 b3 1a 66 25 b8 fd 5e c4 66 e5 7b be 3f 1e b8 0e 42 40 4d 6e 33 54>,
  absValidity: 2018-03-21T18:13:19.904Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200203,
     cipherKeyVal: <Buffer 97 dc b8 1a fb f2 a4 bf 55 25 81 39 62 b9 96 6e>,
     macKeyVal: <Buffer 6b af ed 4c f1 e4 da 76 de f7 b3 1a 66 25 b8 fd 5e c4 66 e5 7b be 3f 1e b8 0e 42 40 4d 6e 33 54>,
     absValidity: 2018-03-21T18:13:19.904Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer fe ee 24 59 24 55 ca 21>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 18:13:20 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521569600751
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521569659796
connected to auth! from local port 43096
received auth hello!
{ authId: 402, nonce: <Buffer c0 50 27 c7 ea e2 70 9b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 91 df 8b 62 fc e6 42 05>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200210,
  cipherKeyVal: <Buffer ad 9c 68 45 46 88 a1 60 e0 65 46 19 d9 ae 0f e8>,
  macKeyVal: <Buffer 08 7c e5 42 9d 54 71 e4 8f 2b b7 ba d0 73 c7 cd 48 19 ca 14 76 9d d8 ae 81 ca 3a 52 12 f1 71 2c>,
  absValidity: 2018-03-21T18:14:19.969Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200210,
     cipherKeyVal: <Buffer ad 9c 68 45 46 88 a1 60 e0 65 46 19 d9 ae 0f e8>,
     macKeyVal: <Buffer 08 7c e5 42 9d 54 71 e4 8f 2b b7 ba d0 73 c7 cd 48 19 ca 14 76 9d d8 ae 81 ca 3a 52 12 f1 71 2c>,
     absValidity: 2018-03-21T18:14:19.969Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 48 f9 b3 92 4d f2 8a 9d>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 18:14:20 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521569661104
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521569719853
connected to auth! from local port 43366
received auth hello!
{ authId: 402, nonce: <Buffer 7b 0a 92 d6 c4 df 3f 0c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d4 d4 50 b7 c5 5d 31 15>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200217,
  cipherKeyVal: <Buffer 08 cb 0f 40 10 59 c7 4f f7 84 2c 73 21 1f ac 73>,
  macKeyVal: <Buffer 1a a7 d7 0a 95 f7 50 ed 8c 34 28 dc 86 15 40 b7 bd f0 1d 80 c2 1d 07 f2 0a 20 d7 c2 37 f5 11 e9>,
  absValidity: 2018-03-21T18:15:20.055Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200217,
     cipherKeyVal: <Buffer 08 cb 0f 40 10 59 c7 4f f7 84 2c 73 21 1f ac 73>,
     macKeyVal: <Buffer 1a a7 d7 0a 95 f7 50 ed 8c 34 28 dc 86 15 40 b7 bd f0 1d 80 c2 1d 07 f2 0a 20 d7 c2 37 f5 11 e9>,
     absValidity: 2018-03-21T18:15:20.055Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 73 84 fa a6 a7 b3 cd c2>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 18:15:20 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521569721112
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521569779909
connected to auth! from local port 43636
received auth hello!
{ authId: 402, nonce: <Buffer 98 1a 98 32 f0 0f 79 df> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 26 7d 66 ec 63 4e 1b 07>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200224,
  cipherKeyVal: <Buffer 6c 65 d9 e5 08 0b f1 04 98 8f 1c 15 8e 2e 47 08>,
  macKeyVal: <Buffer 8a 05 74 a8 16 69 e7 03 f1 12 fe 4e 21 f3 1f b4 5f 57 bd 0a 50 30 c7 20 e8 57 8c 69 09 b1 98 89>,
  absValidity: 2018-03-21T18:16:20.083Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200224,
     cipherKeyVal: <Buffer 6c 65 d9 e5 08 0b f1 04 98 8f 1c 15 8e 2e 47 08>,
     macKeyVal: <Buffer 8a 05 74 a8 16 69 e7 03 f1 12 fe 4e 21 f3 1f b4 5f 57 bd 0a 50 30 c7 20 e8 57 8c 69 09 b1 98 89>,
     absValidity: 2018-03-21T18:16:20.083Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 6d 8d 35 83 04 15 f8 0e>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 18:16:20 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521569781219
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521569839965
connected to auth! from local port 43906
received auth hello!
{ authId: 402, nonce: <Buffer b4 32 d8 b1 f3 ac 6d 62> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 76 24 e5 7a 0c 28 91 f7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200231,
  cipherKeyVal: <Buffer d8 de cd d3 e2 d7 bf 7b 48 f1 77 8b 1e 6b 27 48>,
  macKeyVal: <Buffer 72 29 0a 43 b4 55 64 7d b0 a1 8a d7 ee 6f 39 77 8d 56 5f 85 a4 59 5d 21 bc d4 c1 19 7b 3d 58 e4>,
  absValidity: 2018-03-21T18:17:20.140Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200231,
     cipherKeyVal: <Buffer d8 de cd d3 e2 d7 bf 7b 48 f1 77 8b 1e 6b 27 48>,
     macKeyVal: <Buffer 72 29 0a 43 b4 55 64 7d b0 a1 8a d7 ee 6f 39 77 8d 56 5f 85 a4 59 5d 21 bc d4 c1 19 7b 3d 58 e4>,
     absValidity: 2018-03-21T18:17:20.140Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 96 95 cb 93 ab 27 8f bc>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 18:17:20 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521569841142
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521569900021
connected to auth! from local port 44176
received auth hello!
{ authId: 402, nonce: <Buffer 3c 81 83 6a 0c 86 f2 cf> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 01 f0 4d 8c 90 e9 33 ee>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200238,
  cipherKeyVal: <Buffer e5 63 6e e6 95 8b 39 43 51 bb 99 d7 22 2c 70 df>,
  macKeyVal: <Buffer 05 63 46 25 9e 88 62 59 ee 1a 52 2e 83 a1 66 ca cf 6b b0 68 a0 68 34 6c 4a 80 d3 66 ef fe 5c 22>,
  absValidity: 2018-03-21T18:18:20.279Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200238,
     cipherKeyVal: <Buffer e5 63 6e e6 95 8b 39 43 51 bb 99 d7 22 2c 70 df>,
     macKeyVal: <Buffer 05 63 46 25 9e 88 62 59 ee 1a 52 2e 83 a1 66 ca cf 6b b0 68 a0 68 34 6c 4a 80 d3 66 ef fe 5c 22>,
     absValidity: 2018-03-21T18:18:20.279Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 25 1d 36 40 06 cc a7 ea>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 18:18:20 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521569901358
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521569960081
connected to auth! from local port 44446
received auth hello!
{ authId: 402, nonce: <Buffer 93 61 40 7b f3 3b 65 2b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fa 18 5d fc b6 35 56 d6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200245,
  cipherKeyVal: <Buffer d2 f1 47 a3 72 33 2c ed 99 c5 67 6e 5c 4f 76 c3>,
  macKeyVal: <Buffer a8 f4 81 f5 ba 77 ea d0 89 0a 65 2c 61 9f a4 a5 26 ab be 17 f8 f2 57 a0 16 2e 99 12 42 1b 81 84>,
  absValidity: 2018-03-21T18:19:20.255Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200245,
     cipherKeyVal: <Buffer d2 f1 47 a3 72 33 2c ed 99 c5 67 6e 5c 4f 76 c3>,
     macKeyVal: <Buffer a8 f4 81 f5 ba 77 ea d0 89 0a 65 2c 61 9f a4 a5 26 ab be 17 f8 f2 57 a0 16 2e 99 12 42 1b 81 84>,
     absValidity: 2018-03-21T18:19:20.255Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 80 25 ea af 71 a4 ac 20>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 18:19:20 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 8 1 1521569961221
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 9 0.8888888888888888 1521570020139
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 10 0.8 1521570080145
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 36614
received auth hello!
{ authId: 502, nonce: <Buffer 72 80 78 5f 6f a0 4c 67> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 11 0.7272727272727273 1521570140156
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 36854
received auth hello!
{ authId: 502, nonce: <Buffer df 47 27 95 2f 98 99 c0> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 12 0.6666666666666666 1521570200165
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 55944
received auth hello!
{ authId: 501, nonce: <Buffer ea 0b d2 dc 4a 8b 81 07> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 13 0.6153846153846154 1521570260176
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 56194
received auth hello!
{ authId: 501, nonce: <Buffer 25 43 b3 28 f1 d0 d9 af> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 14 0.5714285714285714 1521570320186
failure in connection with Auth : authFailureCount: 6
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 47100
received auth hello!
{ authId: 401, nonce: <Buffer eb c8 df c4 a2 a3 6c 89> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth401',
     commonName: '10.0.1.1' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth402',
     commonName: '10.0.0.2' },
  serial: '0162449B5462',
  notBefore: 2018-03-20T18:09:13.000Z,
  notAfter: 2018-03-21T18:10:53.000Z,
  subjectHash: 'de555cae',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'D3:59:C4:D2:F2:AF:F7:25:CB:0A:1D:CB:ED:9A:B6:56:2B:80:AE:58',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'B95EF3029A4C4FAE066EFDE0A6119C37979EDB5A64C834CFDC68175183A2CCB6F817A6CEE1A9EF3E562CF75048E8894B6036030296F313DEBF7C1069E42825C46A5F1F6D69FFE10EE6D73B7805503AA7E6A4C2FF62C2E4D5BF7079FBED00C4B24480D5BC43B7B3B042025990D06DEE0A0388CF2AE7F4B313EF564F2EB3931C44FD1DBD6DFA6DA12843C6DBAAE1EFBC5E7EEDA9407AE6D78B6211169F194056CA6F9CD9F20F33FE469D35BCC944D43D2ECB947F73AF95BB5530BFF2A9B92CA16EB949D06EB8218BBBEC8EA009AC9F6C53C626A2796484448AEDAAB3D19834BA2A19D35D0E105AD47B9A6B3E1589517039E098E992676ED418010E608FA312B251',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.1' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 401,
  host: '10.0.1.1',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJEm1RiMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDIxETAPBgNVBAMMCDEwLjAuMC4yMB4XDTE4MDMy\nMDE4MDkxM1oXDTE4MDMyMTE4MTA1M1owYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDQwMTERMA8GA1UEAwwIMTAuMC4xLjEwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQC5XvMCmkxPrgZu/eCmEZw3l57bWmTINM/caBdRg6LMtvgXps7h\nqe8+Viz3UEjoiUtgNgMClvMT3r98EGnkKCXEal8fbWn/4Q7m1zt4BVA6p+akwv9i\nwuTVv3B5++0AxLJEgNW8Q7ezsEICWZDQbe4KA4jPKuf0sxPvVk8us5McRP0dvW36\nbaEoQ8bbquHvvF5+7alAeubXi2IRFp8ZQFbKb5zZ8g8z/kadNbzJRNQ9LsuUf3Ov\nlbtVML/yqbksoW65SdBuuCGLu+yOoAmsn2xTxiaieWSERIrtqrPRmDS6KhnTXQ4Q\nWtR7mms+FYlRcDngmOmSZ27UGAEOYI+jErJRAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQEwDQYJKoZIhvcNAQELBQADggEBAAgzBEdXO2Ybuvpnh4piiH9rkp81AnKp\nCwpjcQC7SxOFFGWpTL+kJd3ox2FUVoHVtOWMNk//3jW2AAK4ABYdTqqrmQozl2xF\nNFQKC2lFKbSThFOkmYQLICdSgx7RofBF2F6OivSJt2Th4UAbajBP6LXghSZbzaiE\nVbvZTLr1wSNZpsEkPkHNV41kC4it75h8Ca7CGs+UlENmSWusHL3FoES+9C6Y1V+B\nmAd0W8uadyOOjWyQ6YtihM5lipOA7fTCSfNiQufr4BYIFpLpM0j3tNqLTvnC2O0a\nOGJCbExQRqSwO2naZ3XonclAjN23tRF7oK9tORDnxbFjD8c/p6PAo0Y=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 2
to: 3
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 15 0.5333333333333333 1521570380193
connected to auth! from local port 47332
received auth hello!
{ authId: 401, nonce: <Buffer 1e 7c 8f 47 27 f8 df 5f> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 60 37 4e 50 5b 1f e8 5e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 44 79 a8 a7 cb 80 70 0d 8b 41 96 22 23 8d 78 f0>,
  macKeyVal: <Buffer 06 23 01 00 ea 82 f6 b8 82 d7 82 81 8e 75 e0 3e 02 4f d1 c7 5d 09 09 40 55 1d 51 e5 e4 bc 8a 9d>,
  absValidity: 2018-03-20T19:26:23.882Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100347,
  cipherKeyVal: <Buffer e4 b8 69 90 45 5e 93 5e 9d f9 d7 df cd 28 a8 77>,
  macKeyVal: <Buffer e3 0e f0 78 56 6a bd 52 18 df 2d 92 5e 02 df 00 b6 06 64 a9 3b 54 78 74 bd 20 c9 00 e1 88 19 30>,
  absValidity: 2018-03-21T18:26:23.882Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40100347,
     cipherKeyVal: <Buffer e4 b8 69 90 45 5e 93 5e 9d f9 d7 df cd 28 a8 77>,
     macKeyVal: <Buffer e3 0e f0 78 56 6a bd 52 18 df 2d 92 5e 02 df 00 b6 06 64 a9 3b 54 78 74 bd 20 c9 00 e1 88 19 30>,
     absValidity: 2018-03-21T18:26:23.882Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 07 d6 dc 59 38 ad 50 85>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 16 0.5 1521570440200
connected to auth! from local port 47584
received auth hello!
{ authId: 401, nonce: <Buffer c9 0a 14 16 a8 03 94 11> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5d bd 55 df a5 88 60 b1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100356,
  cipherKeyVal: <Buffer 9e 2a 39 cf f8 fa 76 3d 3b 4c f7 2b 44 79 47 68>,
  macKeyVal: <Buffer 80 ec cf 8a 1b 46 1d 82 0c e8 c1 63 fd b2 79 8e ff 0e 08 74 f4 e2 3c 8b 25 f3 3c 69 0a 9f eb a6>,
  absValidity: 2018-03-21T18:27:23.936Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40100356,
     cipherKeyVal: <Buffer 9e 2a 39 cf f8 fa 76 3d 3b 4c f7 2b 44 79 47 68>,
     macKeyVal: <Buffer 80 ec cf 8a 1b 46 1d 82 0c e8 c1 63 fd b2 79 8e ff 0e 08 74 f4 e2 3c 8b 25 f3 3c 69 0a 9f eb a6>,
     absValidity: 2018-03-21T18:27:23.936Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 55 cb 51 b0 4e 9f 89 27>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 17 0.47058823529411764 1521570500207
connected to auth! from local port 47828
received auth hello!
{ authId: 401, nonce: <Buffer f9 1b 84 d3 bd a2 b8 07> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 88 fd a7 1d f1 e2 e6 e0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100366,
  cipherKeyVal: <Buffer 39 a2 52 96 39 c0 4a b0 67 d9 6a 08 c0 55 ee 22>,
  macKeyVal: <Buffer 58 81 90 c3 19 17 c3 38 ba 27 55 1f 81 fc 8d 54 dc 5b 17 a2 b7 69 77 a9 72 a8 e2 3c ef 52 5d 07>,
  absValidity: 2018-03-21T18:28:23.976Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40100366,
     cipherKeyVal: <Buffer 39 a2 52 96 39 c0 4a b0 67 d9 6a 08 c0 55 ee 22>,
     macKeyVal: <Buffer 58 81 90 c3 19 17 c3 38 ba 27 55 1f 81 fc 8d 54 dc 5b 17 a2 b7 69 77 a9 72 a8 e2 3c ef 52 5d 07>,
     absValidity: 2018-03-21T18:28:23.976Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 5b 6c 97 b8 f9 9e b7 77>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 18 0.4444444444444444 1521570560213
connected to auth! from local port 48092
received auth hello!
{ authId: 401, nonce: <Buffer 4f 7e 0d 56 13 30 48 b5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a9 56 1b da 20 78 94 ab>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100378,
  cipherKeyVal: <Buffer b0 71 38 e5 82 3c 55 97 1f 57 15 d6 ff a0 cf 4d>,
  macKeyVal: <Buffer e0 25 f6 35 26 65 cd a8 64 07 ea 1b d3 55 85 52 82 c1 a3 cd ab f0 1f 19 7c f5 9a b1 b8 18 ea 3c>,
  absValidity: 2018-03-21T18:29:24.007Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40100378,
     cipherKeyVal: <Buffer b0 71 38 e5 82 3c 55 97 1f 57 15 d6 ff a0 cf 4d>,
     macKeyVal: <Buffer e0 25 f6 35 26 65 cd a8 64 07 ea 1b d3 55 85 52 82 c1 a3 cd ab f0 1f 19 7c f5 9a b1 b8 18 ea 3c>,
     absValidity: 2018-03-21T18:29:24.007Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer f2 fd 5e 45 cd 4f e3 da>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 19 0.42105263157894735 1521570620218
connected to auth! from local port 48356
received auth hello!
{ authId: 401, nonce: <Buffer 88 fa d1 a1 3b d8 35 06> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 58 b3 49 51 96 99 b0 71>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100391,
  cipherKeyVal: <Buffer 36 b4 ca 56 be 45 02 0e 33 72 45 f9 24 0d ea 38>,
  macKeyVal: <Buffer a0 28 2a 19 89 cf e4 f2 c7 1c 1b 5d c2 1e b1 e1 cc 33 24 0d 18 9a 7f 4d b4 58 61 32 c2 fc 29 de>,
  absValidity: 2018-03-21T18:30:24.001Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40100391,
     cipherKeyVal: <Buffer 36 b4 ca 56 be 45 02 0e 33 72 45 f9 24 0d ea 38>,
     macKeyVal: <Buffer a0 28 2a 19 89 cf e4 f2 c7 1c 1b 5d c2 1e b1 e1 cc 33 24 0d 18 9a 7f 4d b4 58 61 32 c2 fc 29 de>,
     absValidity: 2018-03-21T18:30:24.001Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 12 f3 07 b3 36 ff ae e8>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 20 0.4 1521570680226
connected to auth! from local port 48576
received auth hello!
{ authId: 401, nonce: <Buffer ba 3e d4 7f 6a 40 33 85> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 17 52 55 52 ed 7c 01 b4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100403,
  cipherKeyVal: <Buffer 56 f6 92 0f 39 5c 4f 51 8a 8b 04 8f 24 bc c1 b8>,
  macKeyVal: <Buffer 4e 62 8a b0 6d 96 a8 50 87 8e 9c 0f dd 14 c8 eb cc da e1 52 f6 49 32 77 f0 c1 8e fa ba c0 40 ac>,
  absValidity: 2018-03-21T18:31:23.863Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40100403,
     cipherKeyVal: <Buffer 56 f6 92 0f 39 5c 4f 51 8a 8b 04 8f 24 bc c1 b8>,
     macKeyVal: <Buffer 4e 62 8a b0 6d 96 a8 50 87 8e 9c 0f dd 14 c8 eb cc da e1 52 f6 49 32 77 f0 c1 8e fa ba c0 40 ac>,
     absValidity: 2018-03-21T18:31:23.863Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 45 5c 43 6d 40 e8 18 1d>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 21 0.38095238095238093 1521570740232
connected to auth! from local port 48796
received auth hello!
{ authId: 401, nonce: <Buffer 0d c9 28 a0 3e 89 f3 26> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b2 e2 65 25 ca 4c a8 90>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100414,
  cipherKeyVal: <Buffer a0 2f 51 7e cc 8e 33 f6 03 97 f9 b2 93 fd 88 28>,
  macKeyVal: <Buffer 66 1b 89 ff 7b 5d 1b 81 b1 95 0f 9b a8 f7 3b 7b 1f 0b 48 d8 b1 25 b9 10 1c 28 e7 7e 5a a2 1b 42>,
  absValidity: 2018-03-21T18:32:23.920Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40100414,
     cipherKeyVal: <Buffer a0 2f 51 7e cc 8e 33 f6 03 97 f9 b2 93 fd 88 28>,
     macKeyVal: <Buffer 66 1b 89 ff 7b 5d 1b 81 b1 95 0f 9b a8 f7 3b 7b 1f 0b 48 d8 b1 25 b9 10 1c 28 e7 7e 5a a2 1b 42>,
     absValidity: 2018-03-21T18:32:23.920Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer c3 1d c6 c0 74 c7 ec 84>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 22 0.36363636363636365 1521570800238
connected to auth! from local port 49016
received auth hello!
{ authId: 401, nonce: <Buffer dc 35 40 39 d8 ee 03 92> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1e 96 53 d0 35 cf bd 5e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100425,
  cipherKeyVal: <Buffer e4 ab 14 6b 3d e8 de 50 46 dc c1 67 2f 77 04 8e>,
  macKeyVal: <Buffer 51 c1 90 84 35 3f c1 b8 c7 ca 84 67 08 b2 96 34 4a 7e 54 1d 79 34 f2 a3 20 95 f5 d2 66 3d 22 52>,
  absValidity: 2018-03-21T18:33:23.955Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40100425,
     cipherKeyVal: <Buffer e4 ab 14 6b 3d e8 de 50 46 dc c1 67 2f 77 04 8e>,
     macKeyVal: <Buffer 51 c1 90 84 35 3f c1 b8 c7 ca 84 67 08 b2 96 34 4a 7e 54 1d 79 34 f2 a3 20 95 f5 d2 66 3d 22 52>,
     absValidity: 2018-03-21T18:33:23.955Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer ce f0 be 08 42 bf 20 b0>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 23 0.34782608695652173 1521570860241
connected to auth! from local port 49234
received auth hello!
{ authId: 401, nonce: <Buffer e0 f4 95 2e 1c 1a 13 f8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 75 82 2c 52 e2 d7 92 6b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100436,
  cipherKeyVal: <Buffer 19 3a 0c e1 af 30 94 c1 ed d3 d1 01 8a a2 af f3>,
  macKeyVal: <Buffer 66 a4 cb de 8f 5e e8 37 b5 a2 1a 2d aa 6b d9 4c df ae 6b 94 dd 03 15 da 98 0b 3b 2c 43 3f 49 5e>,
  absValidity: 2018-03-21T18:34:24.028Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40100436,
     cipherKeyVal: <Buffer 19 3a 0c e1 af 30 94 c1 ed d3 d1 01 8a a2 af f3>,
     macKeyVal: <Buffer 66 a4 cb de 8f 5e e8 37 b5 a2 1a 2d aa 6b d9 4c df ae 6b 94 dd 03 15 da 98 0b 3b 2c 43 3f 49 5e>,
     absValidity: 2018-03-21T18:34:24.028Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 9a ba fe ba c1 f9 ee a6>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 24 0.3333333333333333 1521570920245
connected to auth! from local port 49456
received auth hello!
{ authId: 401, nonce: <Buffer f6 a2 2c ad c8 26 f3 64> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1a 34 df 63 c7 3f 0b c3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100447,
  cipherKeyVal: <Buffer da 2c 3b 97 57 0d 0d 07 78 c3 28 af b8 77 1b d6>,
  macKeyVal: <Buffer 7a c3 cd a5 d3 5f a6 8b 24 0b 62 87 53 34 67 74 cc a4 93 57 bb 16 0d 14 37 04 7b 01 69 33 4a cc>,
  absValidity: 2018-03-21T18:35:24.086Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40100447,
     cipherKeyVal: <Buffer da 2c 3b 97 57 0d 0d 07 78 c3 28 af b8 77 1b d6>,
     macKeyVal: <Buffer 7a c3 cd a5 d3 5f a6 8b 24 0b 62 87 53 34 67 74 cc a4 93 57 bb 16 0d 14 37 04 7b 01 69 33 4a cc>,
     absValidity: 2018-03-21T18:35:24.086Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer af bb 44 a3 44 b0 17 54>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 25 0.32 1521570980251
connected to auth! from local port 49674
received auth hello!
{ authId: 401, nonce: <Buffer 58 e5 a5 94 d2 3a c9 19> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 05 7f 19 51 2d 82 87 e7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100458,
  cipherKeyVal: <Buffer 31 7d 97 79 b2 99 a9 26 aa 09 48 4d f1 52 71 35>,
  macKeyVal: <Buffer 64 97 15 1d b3 9f 3f 9f 7b 13 d5 d5 ef 39 dc e4 b5 e1 a0 20 8d 0a 85 88 a2 71 65 0e 2c b6 0f dd>,
  absValidity: 2018-03-21T18:36:24.130Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40100458,
     cipherKeyVal: <Buffer 31 7d 97 79 b2 99 a9 26 aa 09 48 4d f1 52 71 35>,
     macKeyVal: <Buffer 64 97 15 1d b3 9f 3f 9f 7b 13 d5 d5 ef 39 dc e4 b5 e1 a0 20 8d 0a 85 88 a2 71 65 0e 2c b6 0f dd>,
     absValidity: 2018-03-21T18:36:24.130Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 55 eb 2f 3a b3 98 91 ac>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 26 0.3076923076923077 1521571040257
connected to auth! from local port 49892
received auth hello!
{ authId: 401, nonce: <Buffer ec 5d 81 7f e9 19 bc 1b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b5 ce ef d3 00 4b 8f a3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100468,
  cipherKeyVal: <Buffer 66 38 cb 65 42 44 97 b2 6d cd e0 3a 69 c0 5b 8a>,
  macKeyVal: <Buffer fa b2 88 c9 15 b2 91 06 80 3e 7c 8d 10 68 5a 8d ea 55 0c 78 43 c1 92 ac 7f 2c 5a 02 4c 8e 80 6f>,
  absValidity: 2018-03-21T18:37:24.014Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40100468,
     cipherKeyVal: <Buffer 66 38 cb 65 42 44 97 b2 6d cd e0 3a 69 c0 5b 8a>,
     macKeyVal: <Buffer fa b2 88 c9 15 b2 91 06 80 3e 7c 8d 10 68 5a 8d ea 55 0c 78 43 c1 92 ac 7f 2c 5a 02 4c 8e 80 6f>,
     absValidity: 2018-03-21T18:37:24.014Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 18 92 9a db a1 49 be 36>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 27 0.2962962962962963 1521571100261
connected to auth! from local port 50110
received auth hello!
{ authId: 401, nonce: <Buffer e0 27 ff 15 56 df 75 6d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 58 c8 88 24 14 bc a2 4d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100480,
  cipherKeyVal: <Buffer 75 bc 3b fa f5 bb ff c0 5b 9c 17 7b fa e0 97 cc>,
  macKeyVal: <Buffer 47 b4 e2 b0 1e 72 1e c2 91 21 c7 e1 42 f4 6a 68 d9 1f 08 ba 21 69 18 07 66 6a c7 0a f9 53 17 eb>,
  absValidity: 2018-03-21T18:38:24.005Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40100480,
     cipherKeyVal: <Buffer 75 bc 3b fa f5 bb ff c0 5b 9c 17 7b fa e0 97 cc>,
     macKeyVal: <Buffer 47 b4 e2 b0 1e 72 1e c2 91 21 c7 e1 42 f4 6a 68 d9 1f 08 ba 21 69 18 07 66 6a c7 0a f9 53 17 eb>,
     absValidity: 2018-03-21T18:38:24.005Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 13 e0 42 32 06 22 9a 37>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 28 0.2857142857142857 1521571160265
connected to auth! from local port 50328
received auth hello!
{ authId: 401, nonce: <Buffer e9 1c 41 a3 48 36 61 09> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 94 e4 27 0d 88 f5 88 1a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100491,
  cipherKeyVal: <Buffer f3 77 aa 56 2a a2 bb 78 76 23 85 24 9e 88 6d 07>,
  macKeyVal: <Buffer 4f d8 17 ab 6c ad 8f 08 9a 12 5f 05 6c 24 bf cf 0f 6f 1b 3a fe a9 92 af 0d e1 e8 13 3d 9a 10 39>,
  absValidity: 2018-03-21T18:39:24.110Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40100491,
     cipherKeyVal: <Buffer f3 77 aa 56 2a a2 bb 78 76 23 85 24 9e 88 6d 07>,
     macKeyVal: <Buffer 4f d8 17 ab 6c ad 8f 08 9a 12 5f 05 6c 24 bf cf 0f 6f 1b 3a fe a9 92 af 0d e1 e8 13 3d 9a 10 39>,
     absValidity: 2018-03-21T18:39:24.110Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 86 ef 27 1f 92 29 18 9e>
switching to HANDSHAKE_1_SENT
disconnected from auth
