changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s408.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's408',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 51 49 42 41 41 4b 43 41 51 45 41 76 61 ... > }
Handler: listening on port 22100
s408:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200199
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48434
received auth hello!
{ authId: 402, nonce: <Buffer 16 4e 0f 26 f2 f8 e8 f8> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer a1 cc 52 2d fc ac 9c 52>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 8a aa b2 cd 5c ba c9 99 b5 70 0a ef 3b 08 61 84>,
  macKeyVal: <Buffer 54 c5 12 08 eb 9a 78 d4 04 47 f2 12 ab 3a 3e 63 7f 37 0e 15 7e 4d b8 fe b8 0c b7 ae d4 19 13 6e>,
  absValidity: 2018-03-20T19:12:30.802Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ae 9b 6b 57 3c 61 f7 1d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ae 9b 6b 57 3c 61 f7 1d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.52:42458',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200201
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48446
received auth hello!
{ authId: 402, nonce: <Buffer d5 9a 41 0d 6d 17 56 19> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 68 45 33 75 b2 9a 12 5d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ba 0e 81 5a 08 24 73 b0>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ba 0e 81 5a 08 24 73 b0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.54:46214',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200206
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48602
received auth hello!
{ authId: 402, nonce: <Buffer 5f dc 1a bb d5 7e 35 a5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 87 42 f8 4b 37 14 4a 5f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 50 0b 4f fe 90 6c 38 b3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 50 0b 4f fe 90 6c 38 b3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.52:42626',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200208
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48626
received auth hello!
{ authId: 402, nonce: <Buffer ce 17 1c a8 84 d0 39 94> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ee d0 16 dd ca f8 0f a5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 16 53 09 b5 11 44 8f 7d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 16 53 09 b5 11 44 8f 7d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.54:46394',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200213
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48872
received auth hello!
{ authId: 402, nonce: <Buffer 67 6a e5 54 3a ac fc 6c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 56 fd dc a3 ff b0 bc 42>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 05 62 7e 92 df 0e 78 45>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 05 62 7e 92 df 0e 78 45> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.52:42896',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200215
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48896
received auth hello!
{ authId: 402, nonce: <Buffer f0 bd 13 e3 bf ee 45 37> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ec cc 60 f6 81 42 df ef>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7f 49 c2 58 a8 e8 25 34>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 7f 49 c2 58 a8 e8 25 34> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.54:46664',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200220
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49142
received auth hello!
{ authId: 402, nonce: <Buffer 63 ed 2a 4d 4b f8 cd 4e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f2 f3 4c 7a bc f0 ba d4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7c 99 d8 d4 e5 f0 e0 d7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 7c 99 d8 d4 e5 f0 e0 d7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.52:43166',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200222
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49166
received auth hello!
{ authId: 402, nonce: <Buffer ae 00 c4 cb 53 89 a5 ec> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1a 81 c4 dc 6a b1 1c c9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer df fc 3c af 7c ac ae b5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer df fc 3c af 7c ac ae b5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.54:46934',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200227
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49412
received auth hello!
{ authId: 402, nonce: <Buffer 96 77 92 6a a8 43 04 82> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 62 2e 00 b2 54 57 64 ea>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 33 cd e9 d7 f4 7a 4b 0e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 33 cd e9 d7 f4 7a 4b 0e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.52:43436',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200229
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49436
received auth hello!
{ authId: 402, nonce: <Buffer 45 8e 23 3c aa 79 82 58> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e5 76 36 33 67 5c 8b 43>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 65 d7 44 6a 86 b9 af 9c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 65 d7 44 6a 86 b9 af 9c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.54:47204',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200234
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49682
received auth hello!
{ authId: 402, nonce: <Buffer d2 ee e8 8e bb e4 69 d6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 40 e5 ab 2f f6 40 69 cb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bc cc 9a af 3e 46 ec ab>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer bc cc 9a af 3e 46 ec ab> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.52:43706',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200236
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49706
received auth hello!
{ authId: 402, nonce: <Buffer ce 46 08 32 73 d3 c1 73> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d1 b6 47 e2 1f 29 7f 0c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e2 29 31 fd 37 35 b2 00>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e2 29 31 fd 37 35 b2 00> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.54:47474',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200241
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49952
received auth hello!
{ authId: 402, nonce: <Buffer 37 e6 90 04 f6 62 0b 2f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9a 41 93 a3 4e 50 40 72>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 10 a4 0f 0c 14 32 83 da>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 10 a4 0f 0c 14 32 83 da> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.52:43976',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200243
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49976
received auth hello!
{ authId: 402, nonce: <Buffer 67 46 6d 29 09 5c ae 53> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 30 9d a9 cc bb 39 fd e0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bb 44 09 43 3b d3 3e e2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bb 44 09 43 3b d3 3e e2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.54:47744',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200248
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50218
received auth hello!
{ authId: 402, nonce: <Buffer 52 f8 57 59 ab d9 86 90> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer de 38 2e d9 24 88 a6 ea>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 32 52 e5 89 cd f6 7f 1c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 32 52 e5 89 cd f6 7f 1c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.52:44242',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200250
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50242
received auth hello!
{ authId: 402, nonce: <Buffer 53 b6 90 9f 36 5b ec 0a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 04 17 e1 ee 5c aa 86 e8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e3 6b 79 02 ad b8 8a c0>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e3 6b 79 02 ad b8 8a c0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.54:48010',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
