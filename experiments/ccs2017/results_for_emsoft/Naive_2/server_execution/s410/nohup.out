changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s410.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's410',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 67 49 42 41 41 4b 43 41 51 45 41 77 4c ... > }
Handler: listening on port 22100
s410:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200200
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37118
received auth hello!
{ authId: 402, nonce: <Buffer 38 30 dc cf a8 ae df 74> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer d9 72 d0 c1 54 de 1b ca>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer c7 5a 44 55 b4 7a c3 42 e9 67 3a 51 80 d3 7c 08>,
  macKeyVal: <Buffer b0 44 39 34 b5 f0 d6 44 b5 1f 14 da bc 1a a3 90 00 0a e3 b6 ce 6c 0e 37 b2 c5 ea b1 ec 67 51 ee>,
  absValidity: 2018-03-20T19:12:34.815Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9b 8a 40 3b 8f ab fb ff>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9b 8a 40 3b 8f ab fb ff> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.53:39782',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200207
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37292
received auth hello!
{ authId: 402, nonce: <Buffer 2d 6a d8 ec 2f da fe 86> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d2 67 9f 0a 64 da e4 3a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 40 b7 21 e8 46 b1 7b 77>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 40 b7 21 e8 46 b1 7b 77> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.53:39956',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200214
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37562
received auth hello!
{ authId: 402, nonce: <Buffer 24 b2 a2 c4 90 25 76 96> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d7 39 eb e4 f3 c8 03 46>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer da f2 88 c3 eb a3 77 bb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer da f2 88 c3 eb a3 77 bb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.53:40226',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200221
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37832
received auth hello!
{ authId: 402, nonce: <Buffer 64 99 89 f8 ba 7a 2a c9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 95 ad 58 e7 13 3c 41 f7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 91 fa 09 b6 d0 b3 55 69>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 91 fa 09 b6 d0 b3 55 69> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.53:40496',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200228
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38102
received auth hello!
{ authId: 402, nonce: <Buffer 38 a9 7b a1 d9 d9 95 fd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 31 6e da 36 0f 8f 0a ce>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 41 57 9d dd 1b 04 32 1f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 41 57 9d dd 1b 04 32 1f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.53:40766',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200235
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38372
received auth hello!
{ authId: 402, nonce: <Buffer 85 6c c2 78 45 e7 01 34> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 50 a4 d3 c1 2a e9 6f 6a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6f 2b ce 2a e4 1f d4 53>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6f 2b ce 2a e4 1f d4 53> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.53:41036',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200242
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38642
received auth hello!
{ authId: 402, nonce: <Buffer 3c 7b ae c1 a1 dc 07 b8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d4 d9 18 4f a6 4b 64 ba>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f3 8b bd dd a1 cb d3 b1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f3 8b bd dd a1 cb d3 b1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.53:41306',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200249
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38908
received auth hello!
{ authId: 402, nonce: <Buffer 73 b1 73 df f4 89 04 3b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 02 95 96 27 cd 1d e8 7b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 53 31 7b 9d 89 c0 cc a4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 53 31 7b 9d 89 c0 cc a4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.53:41572',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
