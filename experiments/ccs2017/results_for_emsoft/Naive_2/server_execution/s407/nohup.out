changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s407.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's407',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 31 77 ... > }
Handler: listening on port 22100
s407:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200198
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49246
received auth hello!
{ authId: 402, nonce: <Buffer 4d ef 1a 07 fe 16 be 3b> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer dc 2c 29 72 8f 39 26 8a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 6a d0 07 bc 5f 73 d2 c8 0b c1 7a f9 ba c0 2d 36>,
  macKeyVal: <Buffer b2 f6 be 0b a9 8b a9 46 3f 2f 33 8e d5 af da 74 8b d3 27 02 52 a7 76 16 34 5e 2f 98 ba 25 fc 6a>,
  absValidity: 2018-03-20T19:12:26.818Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 38 0c fa 9b c7 2a a9 69>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 38 0c fa 9b c7 2a a9 69> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.51:49642',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200205
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49408
received auth hello!
{ authId: 402, nonce: <Buffer 59 46 65 98 c4 7f cf 6b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4c 59 96 44 93 e2 f5 36>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a4 bc 4d 9e a2 22 72 61>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer a4 bc 4d 9e a2 22 72 61> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.51:49804',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200212
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49674
received auth hello!
{ authId: 402, nonce: <Buffer 8c 99 7d a8 47 b0 c2 f7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 35 f5 a7 e4 9c 5a f4 3c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 76 5c 5a d3 7d 23 5e d0>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 76 5c 5a d3 7d 23 5e d0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.51:50070',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200219
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49944
received auth hello!
{ authId: 402, nonce: <Buffer a5 68 23 d1 e6 c5 2b 89> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e4 4f 42 3a 30 a4 d2 26>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e9 7f 84 50 0a 8c 0f a7>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e9 7f 84 50 0a 8c 0f a7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.51:50340',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200226
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50214
received auth hello!
{ authId: 402, nonce: <Buffer 20 e4 ce f8 80 d1 38 a2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 53 07 5a d4 d3 15 20 82>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b2 8c 9d 1d c2 81 11 74>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b2 8c 9d 1d c2 81 11 74> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.51:50610',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200233
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50484
received auth hello!
{ authId: 402, nonce: <Buffer 2c 09 c2 ff ab 08 04 ba> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3f f3 2f 4c bf 11 67 10>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5e 28 84 21 f9 6d d9 e6>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 5e 28 84 21 f9 6d d9 e6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.51:50880',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200240
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50754
received auth hello!
{ authId: 402, nonce: <Buffer 97 3a 54 98 bf 29 c3 4d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 65 52 70 aa 3d 69 a8 71>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6a 31 81 b7 e9 f5 09 18>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6a 31 81 b7 e9 f5 09 18> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.51:51150',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200247
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51024
received auth hello!
{ authId: 402, nonce: <Buffer e0 e9 6b c8 72 70 85 9b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 54 e7 a7 ca 1d 13 88 c2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 00 ed 9b 18 39 69 db 91>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 00 ed 9b 18 39 69 db 91> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.51:51420',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
