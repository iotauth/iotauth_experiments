changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s410.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's410',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 35 5a ... > }
Handler: listening on port 22100
s410:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200671
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42092
received auth hello!
{ authId: 402, nonce: <Buffer 29 2c 22 97 1e 08 d7 bb> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 2d 16 4e 42 4f ff ad 9a>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer fe bc f1 13 7d cc 31 9e 93 66 f1 0f bb 72 06 c6>,
  macKeyVal: <Buffer 3a 78 2c 87 43 34 14 01 a9 0d f3 9c b9 9a 49 bb 90 1f a3 fd 10 14 49 8b 16 e4 4f 7f 23 91 7b 50>,
  absValidity: 2018-03-21T17:56:41.753Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ad 27 d3 3d 57 03 bd 8c>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ad 27 d3 3d 57 03 bd 8c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.53:44756',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200678
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42266
received auth hello!
{ authId: 402, nonce: <Buffer 6a ac 4c 1c 04 59 6b d4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 51 b4 39 24 81 31 89 72>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 06 09 78 b9 c8 b2 71 98>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 06 09 78 b9 c8 b2 71 98> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.53:44930',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200685
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42538
received auth hello!
{ authId: 402, nonce: <Buffer f1 45 f0 19 26 7a 32 8a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 62 37 2c 5c 51 fc 9c 43>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0b 47 38 c9 76 6d 22 64>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0b 47 38 c9 76 6d 22 64> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.53:45202',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200692
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42808
received auth hello!
{ authId: 402, nonce: <Buffer 34 e7 10 d1 ee 05 07 89> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9f 62 ed e2 ff 09 9e 14>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer dd 88 22 a7 f3 ac 79 cb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer dd 88 22 a7 f3 ac 79 cb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.53:45472',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200699
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43078
received auth hello!
{ authId: 402, nonce: <Buffer f9 da c2 c0 ff 12 1e 62> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ae af 5a eb 28 de 15 cf>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5f 4a 77 5d 6f 50 7c eb>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 5f 4a 77 5d 6f 50 7c eb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.53:45742',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200706
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43348
received auth hello!
{ authId: 402, nonce: <Buffer 6e 7d 07 29 1a 24 13 38> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0e 51 ae 9c 7a 25 b7 6c>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ea c5 49 f8 f6 94 e9 2e>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ea c5 49 f8 f6 94 e9 2e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.53:46012',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200713
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43618
received auth hello!
{ authId: 402, nonce: <Buffer 1f ee 04 97 1c 3a ec 6c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 58 e9 24 7f 5f 68 89 c6>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7f 88 6d d3 1b 81 54 17>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 7f 88 6d d3 1b 81 54 17> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.53:46282',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200720
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43884
received auth hello!
{ authId: 402, nonce: <Buffer b0 67 b5 0e f3 9d 15 e7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ab 33 04 da 32 ba 4c 34>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9b ae 40 bf 86 1b a4 79>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9b ae 40 bf 86 1b a4 79> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.53:46548',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
