changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s405.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's405',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 74 59 ... > }
Handler: listening on port 22100
s405:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200667
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33652
received auth hello!
{ authId: 402, nonce: <Buffer 88 d1 68 67 d0 c1 94 a0> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer b6 87 8f ef 20 46 fa 5f>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 60 ce 99 0f 6b a3 37 a6 15 9b 78 59 30 ee 89 bb>,
  macKeyVal: <Buffer ac 02 e5 3d 46 35 99 fc 61 2d 24 78 53 d5 a3 2c 9b 38 2c df 25 00 b7 01 c8 33 7e da 97 08 24 e9>,
  absValidity: 2018-03-21T17:56:27.320Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e4 d5 31 d8 e0 8d 85 45>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e4 d5 31 d8 e0 8d 85 45> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.49:44378',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200674
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33802
received auth hello!
{ authId: 402, nonce: <Buffer 8a 48 17 c4 72 87 c9 88> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e4 c3 07 84 0a 2f 7b 46>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 24 bd c4 9d 78 b8 68 21>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 24 bd c4 9d 78 b8 68 21> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.49:44528',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200681
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34058
received auth hello!
{ authId: 402, nonce: <Buffer 83 d7 21 32 ce d9 8a 20> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5d d3 ab 85 d3 ad a7 28>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b3 9d 6b 70 7a 09 9f 66>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b3 9d 6b 70 7a 09 9f 66> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.49:44784',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200688
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34328
received auth hello!
{ authId: 402, nonce: <Buffer 6c 07 e2 b5 2a aa d0 d0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c1 ba bc 23 b0 39 d8 15>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3c 20 cf 57 03 e9 20 0e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3c 20 cf 57 03 e9 20 0e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.49:45054',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200695
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34598
received auth hello!
{ authId: 402, nonce: <Buffer fb 61 ab 19 94 c1 6b 4e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 23 23 9d a8 c8 8c 2f 0d>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 57 5b 15 16 09 18 36 f8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 57 5b 15 16 09 18 36 f8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.49:45324',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200702
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34868
received auth hello!
{ authId: 402, nonce: <Buffer 7f ec 97 c2 a2 64 02 8f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 34 20 a4 f6 2e 40 ca 89>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 60 31 1e 01 a2 b1 83 62>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 60 31 1e 01 a2 b1 83 62> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.49:45594',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200709
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35138
received auth hello!
{ authId: 402, nonce: <Buffer 80 ef cd c5 ff 32 b1 64> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 92 e9 ac a5 0a 05 d0 c4>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2c 4d e9 0b db db c8 ce>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 2c 4d e9 0b db db c8 ce> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.49:45864',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200716
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35408
received auth hello!
{ authId: 402, nonce: <Buffer 19 e5 6e 10 0e 14 c3 0d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 52 e3 d4 d9 07 05 85 63>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3c 6e f0 05 14 44 68 1b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3c 6e f0 05 14 44 68 1b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.49:46134',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
