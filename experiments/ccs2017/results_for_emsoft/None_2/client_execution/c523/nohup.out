changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c523.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c523',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 51 49 42 41 41 4b 43 41 51 45 41 70 75 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521651501484
connected to auth! from local port 47782
received auth hello!
{ authId: 504, nonce: <Buffer 19 65 09 a7 a2 c9 ad 32> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer da fa ce c4 8a 97 a7 1b>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 2d 76 06 87 7d ec 78 0f 28 bc 3c 95 16 5f 10 a7>,
  macKeyVal: <Buffer 9c 24 dd 45 a1 68 ab 2d 2b 60 13 fd 26 9a ea c8 2f 0f f2 dc 5f 1a db df 09 f0 30 66 80 d2 62 a2>,
  absValidity: 2018-03-21T17:58:21.667Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400267,
  cipherKeyVal: <Buffer 7d c8 cd 17 9a 2d b8 60 48 e0 79 60 fa 56 58 6e>,
  macKeyVal: <Buffer 79 ae d7 79 78 52 27 e2 45 d7 b6 89 3f a3 78 24 be 86 ce fc aa 60 4a dc 87 ec c0 9d 00 73 a4 e6>,
  absValidity: 2018-03-22T16:58:21.666Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50400267,
     cipherKeyVal: <Buffer 7d c8 cd 17 9a 2d b8 60 48 e0 79 60 fa 56 58 6e>,
     macKeyVal: <Buffer 79 ae d7 79 78 52 27 e2 45 d7 b6 89 3f a3 78 24 be 86 ce fc aa 60 4a dc 87 ec c0 9d 00 73 a4 e6>,
     absValidity: 2018-03-22T16:58:21.666Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 84 84 1c c2 7d 6c 4c 25>
switching to HANDSHAKE_1_SENT
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 16:58:22 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521651502712
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521651561542
connected to auth! from local port 48052
received auth hello!
{ authId: 504, nonce: <Buffer 14 94 03 51 ce 97 5d 9a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer df b1 4d fc e0 17 5a 79>
auth nonce verified
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400273,
  cipherKeyVal: <Buffer ac 03 70 87 35 82 9a 57 3d ff be 00 55 38 3e 71>,
  macKeyVal: <Buffer bd c5 0f 76 26 f4 d3 d3 67 00 47 09 63 14 39 35 db d1 a8 74 02 5d a5 ee 23 78 33 84 0c 34 49 bd>,
  absValidity: 2018-03-22T16:59:21.672Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50400273,
     cipherKeyVal: <Buffer ac 03 70 87 35 82 9a 57 3d ff be 00 55 38 3e 71>,
     macKeyVal: <Buffer bd c5 0f 76 26 f4 d3 d3 67 00 47 09 63 14 39 35 db d1 a8 74 02 5d a5 ee 23 78 33 84 0c 34 49 bd>,
     absValidity: 2018-03-22T16:59:21.672Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 88 8c ad fa 10 5c ee 28>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 16:59:22 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521651562685
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521651621597
connected to auth! from local port 48322
received auth hello!
{ authId: 504, nonce: <Buffer aa a8 e1 ec bf 4b 5d 2a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8a fc e9 09 b9 f0 22 7f>
auth nonce verified
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400279,
  cipherKeyVal: <Buffer a0 33 b7 7c 8e 00 37 5d d1 f7 3d 5a 6f 90 9c 7d>,
  macKeyVal: <Buffer d0 b7 47 17 44 4b 53 42 88 26 ea 9c 99 29 3a 21 40 71 30 39 c1 18 52 eb 76 70 8a 1d 8a 36 08 db>,
  absValidity: 2018-03-22T17:00:21.753Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50400279,
     cipherKeyVal: <Buffer a0 33 b7 7c 8e 00 37 5d d1 f7 3d 5a 6f 90 9c 7d>,
     macKeyVal: <Buffer d0 b7 47 17 44 4b 53 42 88 26 ea 9c 99 29 3a 21 40 71 30 39 c1 18 52 eb 76 70 8a 1d 8a 36 08 db>,
     absValidity: 2018-03-22T17:00:21.753Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 1e c9 64 48 c5 b3 d3 96>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 17:00:22 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521651622683
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521651681656
connected to auth! from local port 48592
received auth hello!
{ authId: 504, nonce: <Buffer 41 48 d1 fc 94 64 25 e7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 25 01 ed 74 38 bf 7e e7>
auth nonce verified
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400285,
  cipherKeyVal: <Buffer 47 df b3 a4 54 fb 61 20 3f 7f 71 15 67 43 ee 09>,
  macKeyVal: <Buffer 2f ee f1 fb 0c fd 52 d8 9c 4f ad e0 19 49 df ff 5a 0c f7 09 1f 87 b0 ae 67 60 33 bc 23 01 20 0d>,
  absValidity: 2018-03-22T17:01:21.811Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50400285,
     cipherKeyVal: <Buffer 47 df b3 a4 54 fb 61 20 3f 7f 71 15 67 43 ee 09>,
     macKeyVal: <Buffer 2f ee f1 fb 0c fd 52 d8 9c 4f ad e0 19 49 df ff 5a 0c f7 09 1f 87 b0 ae 67 60 33 bc 23 01 20 0d>,
     absValidity: 2018-03-22T17:01:21.811Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 05 d3 f1 25 1b 32 25 15>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 17:01:22 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521651682722
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521651741695
connected to auth! from local port 48862
received auth hello!
{ authId: 504, nonce: <Buffer 9d 39 46 21 ce 37 6a fa> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bf ac b5 d2 bc b9 2f b5>
auth nonce verified
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400291,
  cipherKeyVal: <Buffer 76 32 51 06 15 36 db 52 10 82 38 be 64 08 51 e5>,
  macKeyVal: <Buffer 19 2b 0e 48 31 09 a1 7d 76 c4 b8 be 4a 0d ac b7 c5 d4 7b f2 d4 39 35 24 b9 1e 06 0a 9a ab bc 50>,
  absValidity: 2018-03-22T17:02:21.830Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50400291,
     cipherKeyVal: <Buffer 76 32 51 06 15 36 db 52 10 82 38 be 64 08 51 e5>,
     macKeyVal: <Buffer 19 2b 0e 48 31 09 a1 7d 76 c4 b8 be 4a 0d ac b7 c5 d4 7b f2 d4 39 35 24 b9 1e 06 0a 9a ab bc 50>,
     absValidity: 2018-03-22T17:02:21.830Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer e4 a6 b1 ad e5 72 fd db>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 17:02:22 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521651742769
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521651801753
connected to auth! from local port 49132
received auth hello!
{ authId: 504, nonce: <Buffer 60 fa db 80 dc 41 8a f3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7d 53 48 19 d0 27 6f cc>
auth nonce verified
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400297,
  cipherKeyVal: <Buffer 3d 84 6d e2 89 a9 1c b1 51 18 e1 4c 87 6d 6e 4a>,
  macKeyVal: <Buffer 23 a9 c9 40 76 93 06 b8 1f 85 84 74 37 bf ad 39 22 e5 ae 22 33 60 10 2c 9d f0 e4 8a 08 e1 db f7>,
  absValidity: 2018-03-22T17:03:21.894Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50400297,
     cipherKeyVal: <Buffer 3d 84 6d e2 89 a9 1c b1 51 18 e1 4c 87 6d 6e 4a>,
     macKeyVal: <Buffer 23 a9 c9 40 76 93 06 b8 1f 85 84 74 37 bf ad 39 22 e5 ae 22 33 60 10 2c 9d f0 e4 8a 08 e1 db f7>,
     absValidity: 2018-03-22T17:03:21.894Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 73 3b af 7f a5 34 94 3e>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 17:03:22 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521651802846
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521651861809
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 8 0.75 1521651921820
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 9 0.6666666666666666 1521651981831
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 10 0.6 1521652041839
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 11 0.5454545454545454 1521652101849
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 12 0.5 1521652161859
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 13 0.46153846153846156 1521652221870
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 14 0.42857142857142855 1521652281880
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 15 0.4 1521652341890
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 16 0.375 1521652401900
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 17 0.35294117647058826 1521652461911
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 18 0.3333333333333333 1521652521917
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 19 0.3157894736842105 1521652581927
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 20 0.3 1521652641938
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 21 0.2857142857142857 1521652701948
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 22 0.2727272727272727 1521652761958
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 23 0.2608695652173913 1521652821969
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 24 0.25 1521652881981
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 25 0.24 1521652941990
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 26 0.23076923076923078 1521653001997
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 27 0.2222222222222222 1521653062007
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 28 0.21428571428571427 1521653122018
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 29 0.20689655172413793 1521653182028
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
