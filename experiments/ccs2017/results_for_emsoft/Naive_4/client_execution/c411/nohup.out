changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c411.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c411',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 67 49 42 41 41 4b 43 41 51 45 41 77 62 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521576942418
connected to auth! from local port 41124
received auth hello!
{ authId: 402, nonce: <Buffer 15 5c 99 d1 92 47 bb e8> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 95 9c 0a 24 3c 0c 02 57>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 46 f5 ea 86 54 b3 df df 98 68 e2 d4 f6 6e 1c d8>,
  macKeyVal: <Buffer 86 a4 24 e4 52 e8 0b 88 0a 09 d8 d9 c5 a4 48 c6 10 ee 68 82 fd c7 7b 1c 2b 3c f8 90 95 72 d4 c6>,
  absValidity: 2018-03-20T21:15:42.588Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200310,
  cipherKeyVal: <Buffer d1 78 e6 a3 d5 cd 53 e9 eb cf 2a ca 89 8e 9e 16>,
  macKeyVal: <Buffer 43 54 d3 b7 02 d3 72 93 f0 5c 20 84 d3 f3 aa e3 9d fc 20 16 40 cf ce 75 b0 c7 4f 4c a2 80 05 88>,
  absValidity: 2018-03-21T20:15:42.588Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.17',
  serverPort: 22100,
  sessionKey: 
   { id: 40200310,
     cipherKeyVal: <Buffer d1 78 e6 a3 d5 cd 53 e9 eb cf 2a ca 89 8e 9e 16>,
     macKeyVal: <Buffer 43 54 d3 b7 02 d3 72 93 f0 5c 20 84 d3 f3 aa e3 9d fc 20 16 40 cf ce 75 b0 c7 4f 4c a2 80 05 88>,
     absValidity: 2018-03-21T20:15:42.588Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 9a cb 72 0f 85 24 f9 78>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:15:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521576944990
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521577002474
connected to auth! from local port 41298
received auth hello!
{ authId: 402, nonce: <Buffer 3d 8a 47 70 a1 42 e5 49> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 72 61 1c fa 12 9c 69 5e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200317,
  cipherKeyVal: <Buffer 5d d4 05 80 56 83 09 1c 82 17 fd 41 6c 2c c7 52>,
  macKeyVal: <Buffer 5e 07 b5 2a d0 8b c8 cc 98 30 99 62 f5 f6 5c 7e e1 c6 e6 f4 06 85 fc 10 b4 e1 a8 3b ba a0 67 d0>,
  absValidity: 2018-03-21T20:16:42.626Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.17',
  serverPort: 22100,
  sessionKey: 
   { id: 40200317,
     cipherKeyVal: <Buffer 5d d4 05 80 56 83 09 1c 82 17 fd 41 6c 2c c7 52>,
     macKeyVal: <Buffer 5e 07 b5 2a d0 8b c8 cc 98 30 99 62 f5 f6 5c 7e e1 c6 e6 f4 06 85 fc 10 b4 e1 a8 3b ba a0 67 d0>,
     absValidity: 2018-03-21T20:16:42.626Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 5d 07 27 e6 b0 e3 f8 d7>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:16:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521577005276
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521577062524
connected to auth! from local port 41568
received auth hello!
{ authId: 402, nonce: <Buffer 4e 3b 25 11 fe 30 06 ec> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7e c3 6d 3c 88 b7 a0 19>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200324,
  cipherKeyVal: <Buffer 0a b3 d5 67 f9 d0 05 5e 6e 3d 59 9e 33 e6 21 fc>,
  macKeyVal: <Buffer 47 48 61 ff 8a 3f 14 25 4d 8c d6 ac 01 8c be 78 ab 6d d7 93 8e 22 b6 c9 e3 3c b6 8b c2 15 2c b1>,
  absValidity: 2018-03-21T20:17:42.690Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.17',
  serverPort: 22100,
  sessionKey: 
   { id: 40200324,
     cipherKeyVal: <Buffer 0a b3 d5 67 f9 d0 05 5e 6e 3d 59 9e 33 e6 21 fc>,
     macKeyVal: <Buffer 47 48 61 ff 8a 3f 14 25 4d 8c d6 ac 01 8c be 78 ab 6d d7 93 8e 22 b6 c9 e3 3c b6 8b c2 15 2c b1>,
     absValidity: 2018-03-21T20:17:42.690Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 4d 78 7f 9c bc 57 08 78>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:17:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521577065189
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521577122582
connected to auth! from local port 41838
received auth hello!
{ authId: 402, nonce: <Buffer 99 21 c0 cf ee 6c dd 57> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4d 56 81 20 6a b7 e8 cb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200331,
  cipherKeyVal: <Buffer 7b 21 0d d3 63 26 ea 5a cf 35 ad 5c c7 f0 ee 2c>,
  macKeyVal: <Buffer dc 57 66 f6 0a fd 10 67 05 98 cc 91 79 2d 80 da a9 74 29 09 cc 00 fc c8 ae 28 a0 9c c9 4c db c2>,
  absValidity: 2018-03-21T20:18:42.771Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.17',
  serverPort: 22100,
  sessionKey: 
   { id: 40200331,
     cipherKeyVal: <Buffer 7b 21 0d d3 63 26 ea 5a cf 35 ad 5c c7 f0 ee 2c>,
     macKeyVal: <Buffer dc 57 66 f6 0a fd 10 67 05 98 cc 91 79 2d 80 da a9 74 29 09 cc 00 fc c8 ae 28 a0 9c c9 4c db c2>,
     absValidity: 2018-03-21T20:18:42.771Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 1d a0 ea 37 ee 88 cf 0f>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:18:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521577125192
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521577182637
connected to auth! from local port 42108
received auth hello!
{ authId: 402, nonce: <Buffer a7 20 36 57 5c 82 39 3e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0a 3b 3d 4e 7d 06 af d7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200338,
  cipherKeyVal: <Buffer 7f 05 cc 49 10 fa 21 fb 1c b9 c2 a1 d8 bc b2 a9>,
  macKeyVal: <Buffer 1b d0 af 7c 41 88 ff 25 d9 35 d0 1a 73 4e b2 9a c1 c3 d8 84 93 3a db 4f 75 aa bd 89 fb e2 89 5f>,
  absValidity: 2018-03-21T20:19:42.801Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.17',
  serverPort: 22100,
  sessionKey: 
   { id: 40200338,
     cipherKeyVal: <Buffer 7f 05 cc 49 10 fa 21 fb 1c b9 c2 a1 d8 bc b2 a9>,
     macKeyVal: <Buffer 1b d0 af 7c 41 88 ff 25 d9 35 d0 1a 73 4e b2 9a c1 c3 d8 84 93 3a db 4f 75 aa bd 89 fb e2 89 5f>,
     absValidity: 2018-03-21T20:19:42.801Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer b5 81 52 fc 4e f7 d1 4a>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:19:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521577185342
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521577242693
connected to auth! from local port 42378
received auth hello!
{ authId: 402, nonce: <Buffer 39 1c ab 3b 1b 6b 20 84> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 53 a7 eb 92 0d 35 ac 96>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200345,
  cipherKeyVal: <Buffer 7b 18 ea 94 8d 65 bb 5b a6 38 c9 fb 90 19 49 b7>,
  macKeyVal: <Buffer 11 18 26 84 2e 54 a3 a5 15 e4 ed c7 0f 74 f7 fb 19 06 af 94 25 be 0f 93 40 5c 49 d8 ad 36 d4 10>,
  absValidity: 2018-03-21T20:20:42.856Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.17',
  serverPort: 22100,
  sessionKey: 
   { id: 40200345,
     cipherKeyVal: <Buffer 7b 18 ea 94 8d 65 bb 5b a6 38 c9 fb 90 19 49 b7>,
     macKeyVal: <Buffer 11 18 26 84 2e 54 a3 a5 15 e4 ed c7 0f 74 f7 fb 19 06 af 94 25 be 0f 93 40 5c 49 d8 ad 36 d4 10>,
     absValidity: 2018-03-21T20:20:42.856Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 58 cd 3a 27 31 0e 5f ca>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:20:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521577245383
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521577302737
connected to auth! from local port 42648
received auth hello!
{ authId: 402, nonce: <Buffer 58 99 07 87 ae 94 6e cb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b0 12 3a 18 34 31 ed a6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200352,
  cipherKeyVal: <Buffer 9b 65 42 c5 c7 af 68 ae 50 53 83 8f 57 ea 51 e6>,
  macKeyVal: <Buffer 2b c2 c9 1c 2b 83 db 82 5f 08 4a 91 e1 35 ee 3a 4d de c3 f4 2e 1d f3 48 71 44 95 08 eb 43 9f ff>,
  absValidity: 2018-03-21T20:21:42.889Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.17',
  serverPort: 22100,
  sessionKey: 
   { id: 40200352,
     cipherKeyVal: <Buffer 9b 65 42 c5 c7 af 68 ae 50 53 83 8f 57 ea 51 e6>,
     macKeyVal: <Buffer 2b c2 c9 1c 2b 83 db 82 5f 08 4a 91 e1 35 ee 3a 4d de c3 f4 2e 1d f3 48 71 44 95 08 eb 43 9f ff>,
     absValidity: 2018-03-21T20:21:42.889Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 23 41 b5 c9 91 d9 ae cd>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:21:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521577305441
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521577362783
connected to auth! from local port 42914
received auth hello!
{ authId: 402, nonce: <Buffer 1c 8e 47 b6 ed c5 a3 06> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 66 81 e5 99 92 73 10 fe>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200359,
  cipherKeyVal: <Buffer ef 4d 8d ac d4 05 79 09 2c 72 27 17 5f 10 6b a4>,
  macKeyVal: <Buffer 7b 0e 56 71 cb 45 5c 56 7e 8b 20 c0 22 27 39 74 81 0d 8f a6 f7 4f 95 60 f6 cf c7 a3 0b f8 66 48>,
  absValidity: 2018-03-21T20:22:42.943Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.17',
  serverPort: 22100,
  sessionKey: 
   { id: 40200359,
     cipherKeyVal: <Buffer ef 4d 8d ac d4 05 79 09 2c 72 27 17 5f 10 6b a4>,
     macKeyVal: <Buffer 7b 0e 56 71 cb 45 5c 56 7e 8b 20 c0 22 27 39 74 81 0d 8f a6 f7 4f 95 60 f6 cf c7 a3 0b f8 66 48>,
     absValidity: 2018-03-21T20:22:42.943Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 40 2e 59 a7 4b c9 5a 1c>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:22:45 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 8 1 1521577365473
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 9 0.8888888888888888 1521577422842
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 10 0.8 1521577482851
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 33052
received auth hello!
{ authId: 502, nonce: <Buffer f1 6d d5 c8 06 ac ac 29> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 11 0.7272727272727273 1521577542861
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 33276
received auth hello!
{ authId: 502, nonce: <Buffer 22 01 6f 3b b7 f1 ef fc> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 12 0.6666666666666666 1521577602872
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 13 0.6153846153846154 1521577662878
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 44956
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 14 0.5714285714285714 1521577722885
failure in connection with Auth : authFailureCount: 6
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 45198
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 15 0.5333333333333333 1521577782893
failure in connection with Auth : authFailureCount: 7
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 2
to: 3
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.3:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 16 0.5 1521577842893
failure in connection with Auth : authFailureCount: 8
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 3
to: 4
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 39796
received auth hello!
{ authId: 503, nonce: <Buffer f5 80 a7 a3 20 21 ae db> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth503',
     commonName: '10.0.1.6' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth402',
     commonName: '10.0.0.2' },
  serial: '0162450C1623',
  notBefore: 2018-03-20T20:12:22.000Z,
  notAfter: 2018-03-21T20:14:02.000Z,
  subjectHash: '5542437f',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'FD:DE:86:1D:CD:10:FF:4C:1A:2A:4C:36:C9:64:AE:76:27:C2:90:7F',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'DE5B30AA46CAB50E9EB99610D7CD6F5A13A506E423E0B2FA7E5B5516308134D5EBA5029E1E86687304DE74F1EDC282AFF2BDBD5A1EEA4AB5A9C11B58BE559B6581427760281F7D05FB35B0241357C06845115CC2742374425A859E0CF161E9E28FB5DADEF2AD5312533F095CB0709A99F829AD0B3B1B19C8FB4E17DFB5D85CE6E65EA745001E8C0CC8AC5A752E195090E212D1563BE34185B3211F90F9135C8AD962B139057D6E600CF5797302C942DB7EEA5A0963E1105D1B46C227E6B60D0B1D7EF08EA4E9BE1220E5269AD51AB8E328F18D2AC5A2F47D0508AD6101DC087A6295158FC3BEDA4B4CD32EC8D3E6E2F67DC2962059753EE1281A41E463966327',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.6' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 503,
  host: '10.0.1.6',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJFDBYjMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDIxETAPBgNVBAMMCDEwLjAuMC4yMB4XDTE4MDMy\nMDIwMTIyMloXDTE4MDMyMTIwMTQwMlowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMzERMA8GA1UEAwwIMTAuMC4xLjYwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDeWzCqRsq1Dp65lhDXzW9aE6UG5CPgsvp+W1UWMIE01eulAp4e\nhmhzBN508e3Cgq/yvb1aHupKtanBG1i+VZtlgUJ3YCgffQX7NbAkE1fAaEURXMJ0\nI3RCWoWeDPFh6eKPtdre8q1TElM/CVywcJqZ+CmtCzsbGcj7Thfftdhc5uZep0UA\nHowMyKxadS4ZUJDiEtFWO+NBhbMhH5D5E1yK2WKxOQV9bmAM9XlzAslC237qWglj\n4RBdG0bCJ+a2DQsdfvCOpOm+EiDlJprVGrjjKPGNKsWi9H0FCK1hAdwIemKVFY/D\nvtpLTNMuyNPm4vZ9wpYgWXU+4SgaQeRjlmMnAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQYwDQYJKoZIhvcNAQELBQADggEBACPpMhVWWktxwKlsKB5iW5lBEreAjiml\n78+24Ra3Sph3TUfZ/ZN18FBiW+UcLlAGVGwgFkZhNP/z9utFBkmrYgzbv/UEkTDS\ngIBSUaYQ9MggXjpI27Xf8Ql2kXDsFcTVOr+XK47/vhqrjXU89JRBGaIG1IeiRxf5\nQeqd8HHSsmgHe+lW8Qi4JRq5+eJ8vh3eqfzqJFgDuyDZxmYi17M9i9yskfSq75wf\ndnt3b3393kLkudPe3utS4SFBrsGraiC0Ccb/Opq5MX0v2HJ9NSAH6mnswgslL1oB\nmKG8TFkVERdW3AxO4nz+EdndY/klAB4Ai2cvvdQhZeT1Ikd3gD4sah0=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 4
to: 5
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 17 0.47058823529411764 1521577902903
connected to auth! from local port 40040
received auth hello!
{ authId: 503, nonce: <Buffer 67 5e f1 02 63 13 25 a6> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 0e 2d c3 b3 6d ed 7e 78>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer ea 49 09 3a 10 56 d2 fb 8e f2 e8 82 06 6f c6 c7>,
  macKeyVal: <Buffer 26 8d 7b 46 3c 1d d5 26 c5 53 1c 59 9f 45 ef d6 c6 02 1f ed 2f cd c1 1e 10 32 aa 4b 41 6c 72 23>,
  absValidity: 2018-03-20T21:31:43.063Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300493,
  cipherKeyVal: <Buffer 8b 45 b9 8b f6 63 05 97 d7 61 30 80 42 98 be 9c>,
  macKeyVal: <Buffer e6 78 9e 28 c0 b6 67 84 9d 8b a4 98 f0 2b d0 f2 72 ac 69 7c 3e 5b cf 67 f9 9f 07 00 61 b4 b1 24>,
  absValidity: 2018-03-21T20:31:43.063Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.17',
  serverPort: 22100,
  sessionKey: 
   { id: 50300493,
     cipherKeyVal: <Buffer 8b 45 b9 8b f6 63 05 97 d7 61 30 80 42 98 be 9c>,
     macKeyVal: <Buffer e6 78 9e 28 c0 b6 67 84 9d 8b a4 98 f0 2b d0 f2 72 ac 69 7c 3e 5b cf 67 f9 9f 07 00 61 b4 b1 24>,
     absValidity: 2018-03-21T20:31:43.063Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer b4 02 13 a3 c2 50 f6 d3>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.17:undefined
/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902
            eventHandlers.onError('Error occurred in migration request: Disconnected from auth before getting migration response: ' + error);
                                                                                                                                      ^

ReferenceError: error is not defined
    at Socket.<anonymous> (/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902:135)
    at emitNone (events.js:91:20)
    at Socket.emit (events.js:188:7)
    at endReadableNT (_stream_readable.js:975:12)
    at _combinedTickCallback (internal/process/next_tick.js:80:11)
    at process._tickCallback (internal/process/next_tick.js:104:9)
