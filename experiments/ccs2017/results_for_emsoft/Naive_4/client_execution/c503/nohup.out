changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c503.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c503',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 41 49 42 41 41 4b 43 41 51 45 41 6d 6a ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521576978255
connected to auth! from local port 59256
received auth hello!
{ authId: 501, nonce: <Buffer 46 e9 01 32 1a 43 e4 39> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 11 56 3e e1 a9 48 46 1b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 2d e9 77 06 a2 84 62 27 9a f1 45 23 8d d6 0d ce>,
  macKeyVal: <Buffer 58 94 28 49 d1 30 70 e6 bf 77 4a 9a 4c 0f 18 9b 56 4e 61 70 82 82 94 7d 1d 89 be e5 96 17 f5 f2>,
  absValidity: 2018-03-20T21:16:18.440Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100500,
  cipherKeyVal: <Buffer 15 6b f4 cb 26 21 91 6e 88 92 44 b8 21 c5 43 3e>,
  macKeyVal: <Buffer 1e 46 2a c5 db a8 10 d7 1b e4 b4 a7 33 e3 ec f1 26 5a 7d 8c 2d 55 7c 47 57 40 52 8e d4 67 1d 6c>,
  absValidity: 2018-03-21T20:16:18.440Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50100500,
     cipherKeyVal: <Buffer 15 6b f4 cb 26 21 91 6e 88 92 44 b8 21 c5 43 3e>,
     macKeyVal: <Buffer 1e 46 2a c5 db a8 10 d7 1b e4 b4 a7 33 e3 ec f1 26 5a 7d 8c 2d 55 7c 47 57 40 52 8e d4 67 1d 6c>,
     absValidity: 2018-03-21T20:16:18.440Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 71 78 03 c8 72 82 80 ef>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:16:19 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521576979384
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521577038314
connected to auth! from local port 59494
received auth hello!
{ authId: 501, nonce: <Buffer 42 0f 4f e7 66 eb e9 1b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8a 93 6a 81 f3 f3 b3 26>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100508,
  cipherKeyVal: <Buffer 56 91 98 08 02 7e 52 b9 f4 9e b9 5d 63 4c 2a 79>,
  macKeyVal: <Buffer 8b 91 16 8f f5 3c 40 b9 1f 17 06 18 2d 21 0f 63 3c ba ee 6f 1b ae 4c 40 28 98 b6 df 20 82 25 6c>,
  absValidity: 2018-03-21T20:17:18.520Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50100508,
     cipherKeyVal: <Buffer 56 91 98 08 02 7e 52 b9 f4 9e b9 5d 63 4c 2a 79>,
     macKeyVal: <Buffer 8b 91 16 8f f5 3c 40 b9 1f 17 06 18 2d 21 0f 63 3c ba ee 6f 1b ae 4c 40 28 98 b6 df 20 82 25 6c>,
     absValidity: 2018-03-21T20:17:18.520Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 5c 91 17 e6 2b b0 9b fd>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:17:19 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521577039888
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521577098335
connected to auth! from local port 59764
received auth hello!
{ authId: 501, nonce: <Buffer a7 82 25 07 9f 3c 68 f5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4d 8e e6 45 9a 1b 50 ad>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100516,
  cipherKeyVal: <Buffer 0b d2 2d f2 9f bd cc d2 3b 92 be c7 61 06 d4 2d>,
  macKeyVal: <Buffer 5f b7 25 1b 2d 6e 0c 2d 17 bb c7 88 69 e9 0b 9f 19 f8 98 57 44 68 f6 c9 e0 0c 46 73 20 a3 46 48>,
  absValidity: 2018-03-21T20:18:18.563Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50100516,
     cipherKeyVal: <Buffer 0b d2 2d f2 9f bd cc d2 3b 92 be c7 61 06 d4 2d>,
     macKeyVal: <Buffer 5f b7 25 1b 2d 6e 0c 2d 17 bb c7 88 69 e9 0b 9f 19 f8 98 57 44 68 f6 c9 e0 0c 46 73 20 a3 46 48>,
     absValidity: 2018-03-21T20:18:18.563Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 91 f1 81 be 88 d1 5b bf>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:18:19 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521577099740
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521577158393
connected to auth! from local port 60034
received auth hello!
{ authId: 501, nonce: <Buffer bd 72 10 4a 3f e3 a8 d4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4c 8d 4f 02 73 95 78 e0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100524,
  cipherKeyVal: <Buffer 89 eb fc f6 81 4d 09 c4 0b f4 b5 ba a3 ed 5f 42>,
  macKeyVal: <Buffer ee 7c 93 2a 1c 43 60 00 b3 9d a3 b4 c8 34 76 e0 3f d0 1e a0 d2 cb 61 3c bf 2d d1 b6 72 9a 59 e5>,
  absValidity: 2018-03-21T20:19:18.577Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50100524,
     cipherKeyVal: <Buffer 89 eb fc f6 81 4d 09 c4 0b f4 b5 ba a3 ed 5f 42>,
     macKeyVal: <Buffer ee 7c 93 2a 1c 43 60 00 b3 9d a3 b4 c8 34 76 e0 3f d0 1e a0 d2 cb 61 3c bf 2d d1 b6 72 9a 59 e5>,
     absValidity: 2018-03-21T20:19:18.577Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer a7 e2 42 57 8d ce 78 d6>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:19:19 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521577159798
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521577218453
connected to auth! from local port 60304
received auth hello!
{ authId: 501, nonce: <Buffer 65 e4 9b 06 15 e5 72 13> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 89 91 1f 0c 98 50 cc 54>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100532,
  cipherKeyVal: <Buffer 10 81 cc 7f c0 db 5b 6d e4 fc 8d d1 91 58 a2 9f>,
  macKeyVal: <Buffer 49 d3 31 d9 84 8e de 69 fa 8a 58 ea 6a cc a1 5c ee 3b b4 d6 3f c9 c2 5d 45 29 db 1f 5c 5f d2 8b>,
  absValidity: 2018-03-21T20:20:18.657Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50100532,
     cipherKeyVal: <Buffer 10 81 cc 7f c0 db 5b 6d e4 fc 8d d1 91 58 a2 9f>,
     macKeyVal: <Buffer 49 d3 31 d9 84 8e de 69 fa 8a 58 ea 6a cc a1 5c ee 3b b4 d6 3f c9 c2 5d 45 29 db 1f 5c 5f d2 8b>,
     absValidity: 2018-03-21T20:20:18.657Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 5e 15 de ae fa be f6 84>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:20:19 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521577219920
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521577278509
connected to auth! from local port 60574
received auth hello!
{ authId: 501, nonce: <Buffer 12 03 61 87 af 8d ce cd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 44 9b d1 dc dd 83 86 5d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100540,
  cipherKeyVal: <Buffer 37 ad a5 e2 86 91 fb af 95 36 42 c8 a2 a0 3c 36>,
  macKeyVal: <Buffer fe a4 7a c0 7f 5c 5c 6b f8 be 82 90 9e 6a eb 62 0d b8 f5 33 90 62 1a dc 89 3a 2b 29 d6 a4 b2 aa>,
  absValidity: 2018-03-21T20:21:18.649Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50100540,
     cipherKeyVal: <Buffer 37 ad a5 e2 86 91 fb af 95 36 42 c8 a2 a0 3c 36>,
     macKeyVal: <Buffer fe a4 7a c0 7f 5c 5c 6b f8 be 82 90 9e 6a eb 62 0d b8 f5 33 90 62 1a dc 89 3a 2b 29 d6 a4 b2 aa>,
     absValidity: 2018-03-21T20:21:18.649Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 70 93 81 1b f0 86 35 5f>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:21:19 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521577279904
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521577338555
connected to auth! from local port 60844
received auth hello!
{ authId: 501, nonce: <Buffer 75 00 d3 68 92 47 85 c1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 15 1c 03 23 36 32 0b 45>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100548,
  cipherKeyVal: <Buffer d7 5d b4 36 b7 99 d3 c8 43 51 f8 10 ec 03 8b 1d>,
  macKeyVal: <Buffer 6d bb 96 26 cb fd a3 1d b5 1f 13 3e ff f3 71 11 97 27 63 97 44 d6 41 83 8b 07 0c be 65 7e 73 dd>,
  absValidity: 2018-03-21T20:22:18.757Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50100548,
     cipherKeyVal: <Buffer d7 5d b4 36 b7 99 d3 c8 43 51 f8 10 ec 03 8b 1d>,
     macKeyVal: <Buffer 6d bb 96 26 cb fd a3 1d b5 1f 13 3e ff f3 71 11 97 27 63 97 44 d6 41 83 8b 07 0c be 65 7e 73 dd>,
     absValidity: 2018-03-21T20:22:18.757Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer a7 85 e3 26 80 53 95 b2>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:22:19 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521577340080
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521577398614
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 9 0.7777777777777778 1521577458614
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 39382
received auth hello!
{ authId: 401, nonce: <Buffer 4f df ee fe d1 aa fa 29> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 10 0.7 1521577518621
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 39600
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 11 0.6363636363636364 1521577578625
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 12 0.5833333333333334 1521577638632
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 39790
received auth hello!
{ authId: 502, nonce: <Buffer e2 ad f0 21 72 66 29 3f> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '0162450C19DA',
  notBefore: 2018-03-20T20:12:23.000Z,
  notAfter: 2018-03-21T20:14:03.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '16:73:A5:AB:6C:D0:49:35:45:A8:B1:C3:92:BD:80:6F:ED:A8:64:8A',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'E40B9EF20959AA49D02016EC2E9896074EE0818689EAD7319ECC8ED8C9557412ED46C95E67464598F6233ECEB8BF25A876F0D30B65CED2B1FED8D1F07CF9042FD7F86E3B637BE17FBFD7C9F0DB5850835170B354A52C175B769A37BA578F965436FF29BCFD54C5D4E939E02214503C8A69FFBBF0EC06657DF9498BE98DEB26B62E1453817F6DFAE9B50EE21C5A643FF0292539838A682562303CB77FC6028B22B30B78957E4F78E539103F991928681EBF3100D31960F43F8ECFC6C2F3063B353E92BFFEF77A49BBCBF417864AE8169AA061F590E5FB3393A4592EFA1100FC186B95B83724CA0B11D8BC02BC9BD4F9E08552DE2D1EB0EE0E866E41A520730E6F',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJFDBnaMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDMy\nMDIwMTIyM1oXDTE4MDMyMTIwMTQwM1owYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDkC57yCVmqSdAgFuwumJYHTuCBhonq1zGezI7YyVV0Eu1GyV5n\nRkWY9iM+zri/Jah28NMLZc7Ssf7Y0fB8+QQv1/huO2N74X+/18nw21hQg1Fws1Sl\nLBdbdpo3ulePllQ2/ym8/VTF1Ok54CIUUDyKaf+78OwGZX35SYvpjesmti4UU4F/\nbfrptQ7iHFpkP/ApJTmDimglYjA8t3/GAosiswt4lX5PeOU5ED+ZGShoHr8xANMZ\nYPQ/js/GwvMGOzU+kr/+93pJu8v0F4ZK6BaaoGH1kOX7M5OkWS76EQD8GGuVuDck\nygsR2LwCvJvU+eCFUt4tHrDuDoZuQaUgcw5vAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAH7QXjZr3ZWfkEcMAV5SQeM5Vb8jvTQ2\n9cIWOeloMIbjyXr8urt3LDOWrtnhBeY9fkBLGez/6MOBEG1Aguff+31mDI0XkvrC\nfb8bRwp6/LgKnr0OejctWMMMyqD4qWRZPfVNZOPl/bBjh6pESzRmwIHuUBpvWvcg\nNxPmLFvlpDWwPIOCMqzi3CYO70l+zjZQHClS99FSbZuA86wvNG8yWbbCNd0mNaCM\nZuOJZRlryLzjn6bRBiVfIYO5BE2mVw+AXEl4uqMS6BYpKF/IXsUU1Dnt650z7GXR\nb80JcN1iMzytwHHj7v+hahg4M2h6gbRRP/SAAHA+RF6itLNO0N+InFQ=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 2
to: 3
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 13 0.5384615384615384 1521577698637
connected to auth! from local port 40008
received auth hello!
{ authId: 502, nonce: <Buffer 13 f4 8d 6d 73 a2 62 ca> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer ab 39 52 c2 d2 7b 17 74>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 04 f9 6b e2 be e4 39 76 ef e3 6f d1 ed 91 26 d7>,
  macKeyVal: <Buffer 17 7c 7c c9 4f a5 12 6d aa ea 2b 1f 1c 19 54 c1 26 b1 76 43 ec 7b 8c 28 36 8c bb 8d 1b b0 e5 79>,
  absValidity: 2018-03-20T21:28:18.814Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200804,
  cipherKeyVal: <Buffer 72 db 19 ff 1d 0a e9 91 1d ca cb 59 8b 5f e9 0d>,
  macKeyVal: <Buffer 61 ee c3 f0 7e 2c cb cf 76 e5 53 17 97 62 46 16 20 ba 2f 7a 76 ff 11 64 4c cd c3 fd 19 a7 97 d3>,
  absValidity: 2018-03-21T20:28:18.814Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50200804,
     cipherKeyVal: <Buffer 72 db 19 ff 1d 0a e9 91 1d ca cb 59 8b 5f e9 0d>,
     macKeyVal: <Buffer 61 ee c3 f0 7e 2c cb cf 76 e5 53 17 97 62 46 16 20 ba 2f 7a 76 ff 11 64 4c cd c3 fd 19 a7 97 d3>,
     absValidity: 2018-03-21T20:28:18.814Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 23 72 4e 9f 48 df 40 11>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.26:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 14 0.5 1521577758646
connected to auth! from local port 40242
received auth hello!
{ authId: 502, nonce: <Buffer 39 0d e6 ef b9 5b a8 72> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c0 e6 8f 32 dc 64 50 90>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200819,
  cipherKeyVal: <Buffer a7 ac 4b d7 94 5f e4 f1 9b 64 81 a7 82 67 33 8e>,
  macKeyVal: <Buffer e0 00 cc 63 91 af 6b d2 15 c5 bf 4f 44 d7 48 72 66 22 1c c0 8a 70 98 c6 c5 a7 a7 eb ba fa ed 73>,
  absValidity: 2018-03-21T20:29:22.428Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50200819,
     cipherKeyVal: <Buffer a7 ac 4b d7 94 5f e4 f1 9b 64 81 a7 82 67 33 8e>,
     macKeyVal: <Buffer e0 00 cc 63 91 af 6b d2 15 c5 bf 4f 44 d7 48 72 66 22 1c c0 8a 70 98 c6 c5 a7 a7 eb ba fa ed 73>,
     absValidity: 2018-03-21T20:29:22.428Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 8d 1b 50 97 cf 30 bd 16>
switching to HANDSHAKE_1_SENT
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:29:33 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 14 0.5714285714285714 1521577774239
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 15 0.5333333333333333 1521577818683
connected to auth! from local port 40490
received auth hello!
{ authId: 502, nonce: <Buffer 02 d6 77 24 fc a7 60 26> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9e c0 04 ed f3 18 50 5c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200834,
  cipherKeyVal: <Buffer 74 cb 90 29 64 e0 37 6b 26 64 ec 78 e9 ed 5c 7e>,
  macKeyVal: <Buffer f0 7f 11 ed 18 de b9 68 79 42 2e 8a 87 d6 94 42 54 b5 7a a5 c3 66 6d 11 9b f7 e2 c0 03 37 c4 bc>,
  absValidity: 2018-03-21T20:30:22.427Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50200834,
     cipherKeyVal: <Buffer 74 cb 90 29 64 e0 37 6b 26 64 ec 78 e9 ed 5c 7e>,
     macKeyVal: <Buffer f0 7f 11 ed 18 de b9 68 79 42 2e 8a 87 d6 94 42 54 b5 7a a5 c3 66 6d 11 9b f7 e2 c0 03 37 c4 bc>,
     absValidity: 2018-03-21T20:30:22.427Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 8c f6 41 7c 24 49 b6 b7>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.26:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 16 0.5 1521577878689
connected to auth! from local port 40746
received auth hello!
{ authId: 502, nonce: <Buffer ab 94 07 ee 6d 49 25 2f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 85 fa 0c d2 ab 8f 1c 42>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200849,
  cipherKeyVal: <Buffer 9c 12 2c bb a9 3e 4f 2e 8d f5 4a 43 0e 7e 9f ab>,
  macKeyVal: <Buffer cd 67 75 09 09 5a 34 a9 bd 7a 37 1a 54 54 3a 74 1e bd 8e 07 1a ad 1c 00 ca fd ba 75 ff 5a e6 b2>,
  absValidity: 2018-03-21T20:31:19.667Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50200849,
     cipherKeyVal: <Buffer 9c 12 2c bb a9 3e 4f 2e 8d f5 4a 43 0e 7e 9f ab>,
     macKeyVal: <Buffer cd 67 75 09 09 5a 34 a9 bd 7a 37 1a 54 54 3a 74 1e bd 8e 07 1a ad 1c 00 ca fd ba 75 ff 5a e6 b2>,
     absValidity: 2018-03-21T20:31:19.667Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 75 c6 19 7c 27 9f 8e 1b>
switching to HANDSHAKE_1_SENT
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:31:20 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 9 16 0.5625 1521577880615
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 17 0.5294117647058824 1521577938746
connected to auth! from local port 40994
received auth hello!
{ authId: 502, nonce: <Buffer 12 ed 2d d1 28 70 29 e1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 43 02 27 e1 d9 d6 2d 68>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200861,
  cipherKeyVal: <Buffer 5f eb cf 4d 43 e1 7e fe 2d 59 ef f4 d1 11 73 aa>,
  macKeyVal: <Buffer 52 24 ed ba 80 fe 97 76 1a eb b2 cd 09 85 df 66 07 6e 77 40 96 f5 8f b5 26 70 bf 42 b2 58 6a ba>,
  absValidity: 2018-03-21T20:32:22.411Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50200861,
     cipherKeyVal: <Buffer 5f eb cf 4d 43 e1 7e fe 2d 59 ef f4 d1 11 73 aa>,
     macKeyVal: <Buffer 52 24 ed ba 80 fe 97 76 1a eb b2 cd 09 85 df 66 07 6e 77 40 96 f5 8f b5 26 70 bf 42 b2 58 6a ba>,
     absValidity: 2018-03-21T20:32:22.411Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 99 2a cd 8f 58 ab cc 5f>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902
            eventHandlers.onError('Error occurred in migration request: Disconnected from auth before getting migration response: ' + error);
                                                                                                                                      ^

ReferenceError: error is not defined
    at Socket.<anonymous> (/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902:135)
    at emitNone (events.js:91:20)
    at Socket.emit (events.js:188:7)
    at endReadableNT (_stream_readable.js:975:12)
    at _combinedTickCallback (internal/process/next_tick.js:80:11)
    at process._tickCallback (internal/process/next_tick.js:104:9)
