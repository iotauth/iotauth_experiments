changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c501.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c501',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 76 4e ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521576971546
connected to auth! from local port 34556
received auth hello!
{ authId: 501, nonce: <Buffer d9 30 e8 a1 a7 82 80 fa> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 2c 76 c5 7d d3 13 8b 73>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer f9 5a fe 81 57 7c c6 ac f1 ed 61 9e 7f fb 47 93>,
  macKeyVal: <Buffer 93 b8 53 5f af 61 56 b3 5e 33 b4 f5 c5 7b 80 76 89 b0 e7 c8 5a 4d 99 c3 ac 1d eb 76 e3 a7 20 91>,
  absValidity: 2018-03-20T21:16:11.747Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100498,
  cipherKeyVal: <Buffer 64 6e 80 5c b5 f3 c7 3a ed 2c 9d 1b a7 9b e3 36>,
  macKeyVal: <Buffer fe ce 96 b3 93 25 e3 fe a6 15 10 a8 6a 6a 34 ce 7d ae ae 2d 35 12 bf c8 30 b9 43 03 12 6c c4 25>,
  absValidity: 2018-03-21T20:16:11.744Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50100498,
     cipherKeyVal: <Buffer 64 6e 80 5c b5 f3 c7 3a ed 2c 9d 1b a7 9b e3 36>,
     macKeyVal: <Buffer fe ce 96 b3 93 25 e3 fe a6 15 10 a8 6a 6a 34 ce 7d ae ae 2d 35 12 bf c8 30 b9 43 03 12 6c c4 25>,
     absValidity: 2018-03-21T20:16:11.744Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer cd f2 cb 03 f7 1c ee de>
switching to HANDSHAKE_1_SENT
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:16:12 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521576972678
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521577031586
connected to auth! from local port 34782
received auth hello!
{ authId: 501, nonce: <Buffer 25 4d b5 52 e4 1c be 16> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 84 ec 32 f0 55 17 7b c1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100506,
  cipherKeyVal: <Buffer c4 d9 84 4e b4 45 e9 ea b1 66 ae 0e 43 80 b6 d4>,
  macKeyVal: <Buffer 58 27 1c d7 fd 0b 9e 4e 06 b7 ea 66 3a 01 33 4e 58 bd 22 29 84 72 e8 1b d1 04 df 2c 85 fb a4 cd>,
  absValidity: 2018-03-21T20:17:11.904Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50100506,
     cipherKeyVal: <Buffer c4 d9 84 4e b4 45 e9 ea b1 66 ae 0e 43 80 b6 d4>,
     macKeyVal: <Buffer 58 27 1c d7 fd 0b 9e 4e 06 b7 ea 66 3a 01 33 4e 58 bd 22 29 84 72 e8 1b d1 04 df 2c 85 fb a4 cd>,
     absValidity: 2018-03-21T20:17:11.904Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer ba a4 52 f5 cd 38 f6 a7>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:17:13 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521577033304
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521577091641
connected to auth! from local port 35052
received auth hello!
{ authId: 501, nonce: <Buffer ac 91 37 2a 1b 1e ae b1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ba b5 f2 52 fb 70 a6 6f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100514,
  cipherKeyVal: <Buffer 53 0a 93 2b e2 24 cf b1 86 45 d8 bc 61 9e 27 4b>,
  macKeyVal: <Buffer c4 d7 ae d9 9f 23 f9 c8 c9 66 6f bb cc e3 58 dd 38 c0 7e 6a b7 ec d9 39 66 1d fa 60 bd 5b 37 f1>,
  absValidity: 2018-03-21T20:18:11.929Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50100514,
     cipherKeyVal: <Buffer 53 0a 93 2b e2 24 cf b1 86 45 d8 bc 61 9e 27 4b>,
     macKeyVal: <Buffer c4 d7 ae d9 9f 23 f9 c8 c9 66 6f bb cc e3 58 dd 38 c0 7e 6a b7 ec d9 39 66 1d fa 60 bd 5b 37 f1>,
     absValidity: 2018-03-21T20:18:11.929Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 49 e7 6b d1 15 c1 46 e2>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:18:13 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521577093311
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521577151697
connected to auth! from local port 35322
received auth hello!
{ authId: 501, nonce: <Buffer 4e d3 6e e5 7b 00 8a 5a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 80 ad d0 68 b4 01 bb 0f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100522,
  cipherKeyVal: <Buffer a2 c8 54 07 b0 f4 8a 13 24 16 94 1b b1 fd 0b be>,
  macKeyVal: <Buffer d3 b3 a6 6d f8 e9 1a 25 da 91 c5 b2 bc e9 37 29 5b c3 46 6d 13 e8 bb 26 cd 6c b2 e6 72 65 13 e4>,
  absValidity: 2018-03-21T20:19:11.877Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50100522,
     cipherKeyVal: <Buffer a2 c8 54 07 b0 f4 8a 13 24 16 94 1b b1 fd 0b be>,
     macKeyVal: <Buffer d3 b3 a6 6d f8 e9 1a 25 da 91 c5 b2 bc e9 37 29 5b c3 46 6d 13 e8 bb 26 cd 6c b2 e6 72 65 13 e4>,
     absValidity: 2018-03-21T20:19:11.877Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 51 2a 36 fc ed 75 a5 59>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:19:12 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521577153194
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521577211756
connected to auth! from local port 35592
received auth hello!
{ authId: 501, nonce: <Buffer 84 50 cb f6 fa a7 82 87> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3e 09 09 13 77 12 28 61>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100530,
  cipherKeyVal: <Buffer 54 e8 31 5a e6 77 e0 a1 56 38 56 42 83 04 14 dc>,
  macKeyVal: <Buffer df 97 e5 1f 3f 7e 6d 71 2f ee ef dd 75 9f ce d5 f9 45 8a b5 b0 02 51 73 96 ce c8 50 a9 df ef 31>,
  absValidity: 2018-03-21T20:20:11.986Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50100530,
     cipherKeyVal: <Buffer 54 e8 31 5a e6 77 e0 a1 56 38 56 42 83 04 14 dc>,
     macKeyVal: <Buffer df 97 e5 1f 3f 7e 6d 71 2f ee ef dd 75 9f ce d5 f9 45 8a b5 b0 02 51 73 96 ce c8 50 a9 df ef 31>,
     absValidity: 2018-03-21T20:20:11.986Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 16 0a 5a cf 64 a8 56 72>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:20:12 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521577213235
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521577271815
connected to auth! from local port 35862
received auth hello!
{ authId: 501, nonce: <Buffer 0c 6e 9f ec 67 d7 14 0d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 14 9e 37 77 9f ee 4b 12>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100538,
  cipherKeyVal: <Buffer 12 39 8a 79 2d 60 06 8f 42 bd 0a 9a 36 82 46 4c>,
  macKeyVal: <Buffer 6f 2a 80 d0 e9 e4 38 87 93 9e 25 e0 24 f8 0d 5d 4d d4 6b c6 51 3e 2c 6a 25 8b b3 fb 24 d0 40 a9>,
  absValidity: 2018-03-21T20:21:12.081Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50100538,
     cipherKeyVal: <Buffer 12 39 8a 79 2d 60 06 8f 42 bd 0a 9a 36 82 46 4c>,
     macKeyVal: <Buffer 6f 2a 80 d0 e9 e4 38 87 93 9e 25 e0 24 f8 0d 5d 4d d4 6b c6 51 3e 2c 6a 25 8b b3 fb 24 d0 40 a9>,
     absValidity: 2018-03-21T20:21:12.081Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 5c f5 9c e0 42 60 8a 67>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:21:12 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521577273342
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521577331873
connected to auth! from local port 36132
received auth hello!
{ authId: 501, nonce: <Buffer ce a9 f0 30 07 26 ce 05> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b0 64 02 cb 92 bd 95 59>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100546,
  cipherKeyVal: <Buffer 64 c3 04 24 a9 93 4d 87 4b ea bb e0 f8 c3 c2 56>,
  macKeyVal: <Buffer 71 91 3a b5 89 15 81 bf a9 40 e6 20 03 77 1d 66 60 29 72 bb e0 cc 28 5b fc f9 9e a9 4d bb 4c d3>,
  absValidity: 2018-03-21T20:22:12.146Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50100546,
     cipherKeyVal: <Buffer 64 c3 04 24 a9 93 4d 87 4b ea bb e0 f8 c3 c2 56>,
     macKeyVal: <Buffer 71 91 3a b5 89 15 81 bf a9 40 e6 20 03 77 1d 66 60 29 72 bb e0 cc 28 5b fc f9 9e a9 4d bb 4c d3>,
     absValidity: 2018-03-21T20:22:12.146Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 45 a9 5f a9 af a3 90 35>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:22:13 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521577333366
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521577391928
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 9 0.7777777777777778 1521577451937
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 48360
received auth hello!
{ authId: 401, nonce: <Buffer 6d cb 5b ad 67 31 a0 ae> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 10 0.7 1521577511947
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 48578
received auth hello!
{ authId: 401, nonce: <Buffer 44 71 dc 58 96 3b 82 5a> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 11 0.6363636363636364 1521577571957
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 12 0.5833333333333334 1521577631965
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 45114
received auth hello!
{ authId: 502, nonce: <Buffer 32 1d a1 5c ad fb e1 0b> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '0162450C19DA',
  notBefore: 2018-03-20T20:12:23.000Z,
  notAfter: 2018-03-21T20:14:03.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '16:73:A5:AB:6C:D0:49:35:45:A8:B1:C3:92:BD:80:6F:ED:A8:64:8A',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'E40B9EF20959AA49D02016EC2E9896074EE0818689EAD7319ECC8ED8C9557412ED46C95E67464598F6233ECEB8BF25A876F0D30B65CED2B1FED8D1F07CF9042FD7F86E3B637BE17FBFD7C9F0DB5850835170B354A52C175B769A37BA578F965436FF29BCFD54C5D4E939E02214503C8A69FFBBF0EC06657DF9498BE98DEB26B62E1453817F6DFAE9B50EE21C5A643FF0292539838A682562303CB77FC6028B22B30B78957E4F78E539103F991928681EBF3100D31960F43F8ECFC6C2F3063B353E92BFFEF77A49BBCBF417864AE8169AA061F590E5FB3393A4592EFA1100FC186B95B83724CA0B11D8BC02BC9BD4F9E08552DE2D1EB0EE0E866E41A520730E6F',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJFDBnaMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDMy\nMDIwMTIyM1oXDTE4MDMyMTIwMTQwM1owYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDkC57yCVmqSdAgFuwumJYHTuCBhonq1zGezI7YyVV0Eu1GyV5n\nRkWY9iM+zri/Jah28NMLZc7Ssf7Y0fB8+QQv1/huO2N74X+/18nw21hQg1Fws1Sl\nLBdbdpo3ulePllQ2/ym8/VTF1Ok54CIUUDyKaf+78OwGZX35SYvpjesmti4UU4F/\nbfrptQ7iHFpkP/ApJTmDimglYjA8t3/GAosiswt4lX5PeOU5ED+ZGShoHr8xANMZ\nYPQ/js/GwvMGOzU+kr/+93pJu8v0F4ZK6BaaoGH1kOX7M5OkWS76EQD8GGuVuDck\nygsR2LwCvJvU+eCFUt4tHrDuDoZuQaUgcw5vAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAH7QXjZr3ZWfkEcMAV5SQeM5Vb8jvTQ2\n9cIWOeloMIbjyXr8urt3LDOWrtnhBeY9fkBLGez/6MOBEG1Aguff+31mDI0XkvrC\nfb8bRwp6/LgKnr0OejctWMMMyqD4qWRZPfVNZOPl/bBjh6pESzRmwIHuUBpvWvcg\nNxPmLFvlpDWwPIOCMqzi3CYO70l+zjZQHClS99FSbZuA86wvNG8yWbbCNd0mNaCM\nZuOJZRlryLzjn6bRBiVfIYO5BE2mVw+AXEl4uqMS6BYpKF/IXsUU1Dnt650z7GXR\nb80JcN1iMzytwHHj7v+hahg4M2h6gbRRP/SAAHA+RF6itLNO0N+InFQ=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 2
to: 3
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 13 0.5384615384615384 1521577691970
connected to auth! from local port 45330
received auth hello!
{ authId: 502, nonce: <Buffer db 92 62 53 7b 11 3f c2> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer f0 94 ac a9 2b ca 4c b2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 30 2c 6f 06 0b ef 74 f7 40 11 55 5f 4d f3 a3 3e>,
  macKeyVal: <Buffer fd 3e df 96 70 a5 13 17 8a 37 ca 83 32 fc 67 3a 9e e4 d6 11 99 97 b2 53 a2 72 02 b4 26 91 fa ef>,
  absValidity: 2018-03-20T21:28:12.338Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200802,
  cipherKeyVal: <Buffer 45 e5 74 6d 1c b6 d8 27 81 41 2f 11 2e c7 f1 10>,
  macKeyVal: <Buffer 46 15 e9 96 b4 5d 26 4c a6 d2 10 3c 49 6e 64 91 44 48 5c b0 e7 eb f4 0c 95 27 89 cd fb ea dd 41>,
  absValidity: 2018-03-21T20:28:12.338Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50200802,
     cipherKeyVal: <Buffer 45 e5 74 6d 1c b6 d8 27 81 41 2f 11 2e c7 f1 10>,
     macKeyVal: <Buffer 46 15 e9 96 b4 5d 26 4c a6 d2 10 3c 49 6e 64 91 44 48 5c b0 e7 eb f4 0c 95 27 89 cd fb ea dd 41>,
     absValidity: 2018-03-21T20:28:12.338Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 05 a2 bc 65 f8 67 48 b7>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.24:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 14 0.5 1521577751977
connected to auth! from local port 45572
received auth hello!
{ authId: 502, nonce: <Buffer 1c 1c 75 b7 60 47 11 3f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 08 f3 87 e9 14 53 0b 8d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200818,
  cipherKeyVal: <Buffer ff 99 e3 8b fe f4 de 29 ea d3 16 80 02 c4 9c 8b>,
  macKeyVal: <Buffer 45 8f cc 28 e8 8e 8e 63 01 e4 7a 22 3e 97 82 ab ee 18 3e a5 d2 e7 3f 52 ab 45 67 3d b7 88 0b ef>,
  absValidity: 2018-03-21T20:29:19.676Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50200818,
     cipherKeyVal: <Buffer ff 99 e3 8b fe f4 de 29 ea d3 16 80 02 c4 9c 8b>,
     macKeyVal: <Buffer 45 8f cc 28 e8 8e 8e 63 01 e4 7a 22 3e 97 82 ab ee 18 3e a5 d2 e7 3f 52 ab 45 67 3d b7 88 0b ef>,
     absValidity: 2018-03-21T20:29:19.676Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 17 3d 2b 1b f4 b3 53 45>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.24:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 15 0.4666666666666667 1521577811980
connected to auth! from local port 45818
received auth hello!
{ authId: 502, nonce: <Buffer 02 11 1c 1f a6 2c cf d3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 54 2a 78 66 5a 08 5a 8c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200833,
  cipherKeyVal: <Buffer 55 26 d1 91 d1 60 78 47 ea da 90 19 69 1a 01 a0>,
  macKeyVal: <Buffer a5 fe b0 c1 ab 4c 7b 91 08 2f 70 39 d6 7d 08 55 8a 38 1e a4 70 92 04 0c 84 17 8e 35 b5 3f d8 34>,
  absValidity: 2018-03-21T20:30:19.719Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50200833,
     cipherKeyVal: <Buffer 55 26 d1 91 d1 60 78 47 ea da 90 19 69 1a 01 a0>,
     macKeyVal: <Buffer a5 fe b0 c1 ab 4c 7b 91 08 2f 70 39 d6 7d 08 55 8a 38 1e a4 70 92 04 0c 84 17 8e 35 b5 3f d8 34>,
     absValidity: 2018-03-21T20:30:19.719Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer b1 56 0d f7 d9 93 5e 0e>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.24:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 16 0.4375 1521577871982
connected to auth! from local port 46068
received auth hello!
{ authId: 502, nonce: <Buffer f0 c9 8b 7b 09 5c 63 fa> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ac 74 d6 40 99 88 70 79>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200847,
  cipherKeyVal: <Buffer 82 7a 47 d2 91 84 2d 09 5d 7e 94 89 2e 60 b9 24>,
  macKeyVal: <Buffer cf a3 34 14 d7 9e 7a 6e 86 44 0f 85 04 f0 fa 1e 57 dc b6 31 53 ec 9d 74 e9 70 23 95 1e eb 05 ab>,
  absValidity: 2018-03-21T20:31:15.891Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50200847,
     cipherKeyVal: <Buffer 82 7a 47 d2 91 84 2d 09 5d 7e 94 89 2e 60 b9 24>,
     macKeyVal: <Buffer cf a3 34 14 d7 9e 7a 6e 86 44 0f 85 04 f0 fa 1e 57 dc b6 31 53 ec 9d 74 e9 70 23 95 1e eb 05 ab>,
     absValidity: 2018-03-21T20:31:15.891Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 88 45 90 6e 8e f1 00 c6>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.24:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 17 0.4117647058823529 1521577931985
connected to auth! from local port 46314
received auth hello!
{ authId: 502, nonce: <Buffer 4e 4c 2e 67 29 5b 80 42> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f3 24 28 10 c7 7b c8 a3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200859,
  cipherKeyVal: <Buffer 0a 96 1b 61 f9 c4 22 7a 1a 55 35 f8 2a 35 10 a6>,
  macKeyVal: <Buffer 26 c2 2d 6e e7 d4 d0 1c a1 2d bf 51 c7 b1 5a a0 39 7a e1 60 96 a4 6b 03 ee cb ec c2 87 f7 a8 c0>,
  absValidity: 2018-03-21T20:32:15.897Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50200859,
     cipherKeyVal: <Buffer 0a 96 1b 61 f9 c4 22 7a 1a 55 35 f8 2a 35 10 a6>,
     macKeyVal: <Buffer 26 c2 2d 6e e7 d4 d0 1c a1 2d bf 51 c7 b1 5a a0 39 7a e1 60 96 a4 6b 03 ee cb ec c2 87 f7 a8 c0>,
     absValidity: 2018-03-21T20:32:15.897Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer b3 cb 0f 2c b0 4c 2d b0>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.24:undefined
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 18 0.3888888888888889 1521577991991
connected to auth! from local port 46508
received auth hello!
{ authId: 502, nonce: <Buffer ee 98 91 ac 8a 3c 02 00> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer df 99 29 31 81 97 b7 9e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200875,
  cipherKeyVal: <Buffer dc 59 ec df 8d 3e e9 dc e0 61 5c 85 ea 0f 36 61>,
  macKeyVal: <Buffer 74 35 89 5c 3d d2 17 82 b2 c8 24 75 0d 24 95 69 1a 36 b1 a9 b5 a9 fb dc 67 71 19 ab 52 ac 0e 0d>,
  absValidity: 2018-03-21T20:33:15.837Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50200875,
     cipherKeyVal: <Buffer dc 59 ec df 8d 3e e9 dc e0 61 5c 85 ea 0f 36 61>,
     macKeyVal: <Buffer 74 35 89 5c 3d d2 17 82 b2 c8 24 75 0d 24 95 69 1a 36 b1 a9 b5 a9 fb dc 67 71 19 ab 52 ac 0e 0d>,
     absValidity: 2018-03-21T20:33:15.837Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.24:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 19 0.3684210526315789 1521578052047
connected to auth! from local port 46672
received auth hello!
{ authId: 502, nonce: <Buffer bb 26 57 ad 85 ac 09 41> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 98 50 75 fd 3f 80 be c0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200887,
  cipherKeyVal: <Buffer f2 d0 ea 24 28 ba bf 80 37 57 31 39 13 da 47 6c>,
  macKeyVal: <Buffer f0 8f 73 e4 68 76 6d d5 34 a2 0b 98 c7 01 d0 0c 4f 9e 50 0e f4 26 9a 97 c0 6e d0 e2 3c 12 fe c3>,
  absValidity: 2018-03-21T20:34:13.808Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50200887,
     cipherKeyVal: <Buffer f2 d0 ea 24 28 ba bf 80 37 57 31 39 13 da 47 6c>,
     macKeyVal: <Buffer f0 8f 73 e4 68 76 6d d5 34 a2 0b 98 c7 01 d0 0c 4f 9e 50 0e f4 26 9a 97 c0 6e d0 e2 3c 12 fe c3>,
     absValidity: 2018-03-21T20:34:13.808Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.24:22100
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 20 0.35 1521578112101
connected to auth! from local port 46838
received auth hello!
{ authId: 502, nonce: <Buffer 21 cc 67 2f 4a e7 f7 1b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 59 62 1d d4 1d 4c df 78>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200899,
  cipherKeyVal: <Buffer c3 82 65 0c 20 0e 2c e0 35 86 2d 23 ce 97 9b 58>,
  macKeyVal: <Buffer 30 ff ee 4d 6e 2a ba 3c 7c f2 f8 b4 5e b7 2f 78 3a 36 55 20 0c 24 05 75 59 69 17 6d ae ac 64 7d>,
  absValidity: 2018-03-21T20:35:14.105Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50200899,
     cipherKeyVal: <Buffer c3 82 65 0c 20 0e 2c e0 35 86 2d 23 ce 97 9b 58>,
     macKeyVal: <Buffer 30 ff ee 4d 6e 2a ba 3c 7c f2 f8 b4 5e b7 2f 78 3a 36 55 20 0c 24 05 75 59 69 17 6d ae ac 64 7d>,
     absValidity: 2018-03-21T20:35:14.105Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.24:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 21 0.3333333333333333 1521578172142
connected to auth! from local port 47004
received auth hello!
{ authId: 502, nonce: <Buffer 54 1c 96 22 42 e3 91 fc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ba a3 bb e9 1f 0c 1e 1b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200911,
  cipherKeyVal: <Buffer 4d 6b 93 5c f9 37 54 f2 30 28 b5 2e c8 b7 a0 86>,
  macKeyVal: <Buffer 31 b1 ab 35 1a fe 17 5c b1 08 53 2d 14 0e db a9 13 12 18 da 65 c5 11 42 29 99 eb 5c d9 c8 62 3a>,
  absValidity: 2018-03-21T20:36:14.181Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50200911,
     cipherKeyVal: <Buffer 4d 6b 93 5c f9 37 54 f2 30 28 b5 2e c8 b7 a0 86>,
     macKeyVal: <Buffer 31 b1 ab 35 1a fe 17 5c b1 08 53 2d 14 0e db a9 13 12 18 da 65 c5 11 42 29 99 eb 5c d9 c8 62 3a>,
     absValidity: 2018-03-21T20:36:14.181Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.24:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 22 0.3181818181818182 1521578232188
connected to auth! from local port 47170
received auth hello!
{ authId: 502, nonce: <Buffer 3c 79 0c b9 4e fd f3 6f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 03 81 c5 b5 17 05 6a 99>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200923,
  cipherKeyVal: <Buffer e8 01 ca b6 b5 ea f9 8f ee e0 e0 e1 94 7d c4 05>,
  macKeyVal: <Buffer 75 20 6d 88 be f0 39 20 80 45 08 38 08 43 38 06 be c4 6b b4 88 44 0e 64 97 ef 1b 55 c0 bc 42 c5>,
  absValidity: 2018-03-21T20:37:13.962Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50200923,
     cipherKeyVal: <Buffer e8 01 ca b6 b5 ea f9 8f ee e0 e0 e1 94 7d c4 05>,
     macKeyVal: <Buffer 75 20 6d 88 be f0 39 20 80 45 08 38 08 43 38 06 be c4 6b b4 88 44 0e 64 97 ef 1b 55 c0 bc 42 c5>,
     absValidity: 2018-03-21T20:37:13.962Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.24:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 23 0.30434782608695654 1521578292246
connected to auth! from local port 47330
received auth hello!
{ authId: 502, nonce: <Buffer a6 f0 42 1f 65 f1 83 f5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer da 54 d1 4f 18 42 45 da>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200935,
  cipherKeyVal: <Buffer 82 3d 00 1e 9d 29 87 98 34 b7 6a ee 25 5e cd 43>,
  macKeyVal: <Buffer ea 20 98 68 af 78 8f 2e ee 17 1c 84 93 00 a9 bf ce 45 bb f9 88 aa ad b0 46 9a 66 ff ca 26 e6 22>,
  absValidity: 2018-03-21T20:38:14.010Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50200935,
     cipherKeyVal: <Buffer 82 3d 00 1e 9d 29 87 98 34 b7 6a ee 25 5e cd 43>,
     macKeyVal: <Buffer ea 20 98 68 af 78 8f 2e ee 17 1c 84 93 00 a9 bf ce 45 bb f9 88 aa ad b0 46 9a 66 ff ca 26 e6 22>,
     absValidity: 2018-03-21T20:38:14.010Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.24:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 24 0.2916666666666667 1521578352301
connected to auth! from local port 47496
received auth hello!
{ authId: 502, nonce: <Buffer 76 f0 97 26 48 df e8 20> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 18 fc 04 0d b1 df ca a7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200947,
  cipherKeyVal: <Buffer 04 5f a9 67 31 99 6f 8f 12 c1 a2 e8 3a da 4d 71>,
  macKeyVal: <Buffer e0 ca 0c 42 89 74 f4 fd 75 2e a5 38 7a 6a ee 81 73 a1 44 eb 05 fa 94 6a 3b f6 03 ed fd 5e 86 5f>,
  absValidity: 2018-03-21T20:39:14.028Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50200947,
     cipherKeyVal: <Buffer 04 5f a9 67 31 99 6f 8f 12 c1 a2 e8 3a da 4d 71>,
     macKeyVal: <Buffer e0 ca 0c 42 89 74 f4 fd 75 2e a5 38 7a 6a ee 81 73 a1 44 eb 05 fa 94 6a 3b f6 03 ed fd 5e 86 5f>,
     absValidity: 2018-03-21T20:39:14.028Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.24:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 25 0.28 1521578412360
connected to auth! from local port 47662
received auth hello!
{ authId: 502, nonce: <Buffer 2b 58 e6 70 3f 31 d0 b0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 03 50 38 46 14 0d a6 1b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200959,
  cipherKeyVal: <Buffer 4b 4e 81 d6 ff 42 0d 5e 31 ae 94 f8 9c 5e d0 47>,
  macKeyVal: <Buffer 8a 16 82 2b 84 fd 54 4b d9 9d 4b 50 2b f3 3c c0 00 c9 84 7c d1 24 97 65 2c 4f f3 60 d2 af e0 b0>,
  absValidity: 2018-03-21T20:40:14.089Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50200959,
     cipherKeyVal: <Buffer 4b 4e 81 d6 ff 42 0d 5e 31 ae 94 f8 9c 5e d0 47>,
     macKeyVal: <Buffer 8a 16 82 2b 84 fd 54 4b d9 9d 4b 50 2b f3 3c c0 00 c9 84 7c d1 24 97 65 2c 4f f3 60 d2 af e0 b0>,
     absValidity: 2018-03-21T20:40:14.089Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.24:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 26 0.2692307692307692 1521578472385
connected to auth! from local port 47828
received auth hello!
{ authId: 502, nonce: <Buffer b3 25 c1 ac d3 f8 c1 39> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 46 96 20 ee 51 fd dd af>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200971,
  cipherKeyVal: <Buffer 46 f0 bc 2f a9 30 6c 95 82 2d 7f d8 0d d8 7f c0>,
  macKeyVal: <Buffer c4 6f 26 56 7c e8 0b 70 73 56 5f d0 ed 47 2c 8a 0d b6 e9 ad 8f 26 cc e6 1a 73 cd 0a 16 28 8e e6>,
  absValidity: 2018-03-21T20:41:14.133Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50200971,
     cipherKeyVal: <Buffer 46 f0 bc 2f a9 30 6c 95 82 2d 7f d8 0d d8 7f c0>,
     macKeyVal: <Buffer c4 6f 26 56 7c e8 0b 70 73 56 5f d0 ed 47 2c 8a 0d b6 e9 ad 8f 26 cc e6 1a 73 cd 0a 16 28 8e e6>,
     absValidity: 2018-03-21T20:41:14.133Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.24:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 27 0.25925925925925924 1521578532441
connected to auth! from local port 47994
received auth hello!
{ authId: 502, nonce: <Buffer 16 66 52 17 dc 27 b7 74> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e1 2d 34 b9 8f f3 9b 5d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200983,
  cipherKeyVal: <Buffer 03 9e dd ec 04 5e 18 d6 22 c7 f1 55 fd fd da 00>,
  macKeyVal: <Buffer 22 1d eb 21 38 c7 08 87 25 e5 4d 21 e7 26 12 a6 bb b8 fa af be 1c ec 1b 5a cc a3 06 88 de 4a 1e>,
  absValidity: 2018-03-21T20:42:14.187Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50200983,
     cipherKeyVal: <Buffer 03 9e dd ec 04 5e 18 d6 22 c7 f1 55 fd fd da 00>,
     macKeyVal: <Buffer 22 1d eb 21 38 c7 08 87 25 e5 4d 21 e7 26 12 a6 bb b8 fa af be 1c ec 1b 5a cc a3 06 88 de 4a 1e>,
     absValidity: 2018-03-21T20:42:14.187Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.24:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 28 0.25 1521578592450
connected to auth! from local port 48158
received auth hello!
{ authId: 502, nonce: <Buffer 89 48 b7 22 8a 2b 31 45> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3c 2a 22 48 6c 8e 24 2e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200995,
  cipherKeyVal: <Buffer eb 84 f8 c0 da 58 a0 9e 65 eb fb 15 dd 0d bd 49>,
  macKeyVal: <Buffer be f3 8c d1 b3 5b f2 92 b0 91 e5 cb fd d7 93 78 ee b2 c2 ae 31 3b 14 24 e9 21 6e 8d ee 36 1e 14>,
  absValidity: 2018-03-21T20:43:14.229Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50200995,
     cipherKeyVal: <Buffer eb 84 f8 c0 da 58 a0 9e 65 eb fb 15 dd 0d bd 49>,
     macKeyVal: <Buffer be f3 8c d1 b3 5b f2 92 b0 91 e5 cb fd d7 93 78 ee b2 c2 ae 31 3b 14 24 e9 21 6e 8d ee 36 1e 14>,
     absValidity: 2018-03-21T20:43:14.229Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.24:22100
disconnected from auth
