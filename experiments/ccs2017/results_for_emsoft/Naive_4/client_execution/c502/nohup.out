changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c502.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c502',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 7a 61 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521576974910
connected to auth! from local port 40128
received auth hello!
{ authId: 501, nonce: <Buffer 71 cc 92 84 37 24 a4 74> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 1a 2b f6 d7 24 98 be 04>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 0b 41 c8 fd 46 5e c3 a6 f9 ac 55 0b 4c a2 8d a8>,
  macKeyVal: <Buffer fb 43 99 d4 1e 86 69 af 40 40 6b 87 c4 c0 53 32 01 3c 79 91 8e 05 92 e3 2e 7a 91 d9 36 90 b7 c6>,
  absValidity: 2018-03-20T21:16:15.085Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100499,
  cipherKeyVal: <Buffer f5 dd b2 ad 9b ac 88 c0 95 ec 18 32 e8 bf 55 10>,
  macKeyVal: <Buffer ac 94 f1 57 f4 67 cb 3d 1c 5c 21 92 da 58 42 f7 05 f8 60 17 6d 1a fe 1e ec 6d 71 77 a1 16 4b 00>,
  absValidity: 2018-03-21T20:16:15.085Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.25',
  serverPort: 22100,
  sessionKey: 
   { id: 50100499,
     cipherKeyVal: <Buffer f5 dd b2 ad 9b ac 88 c0 95 ec 18 32 e8 bf 55 10>,
     macKeyVal: <Buffer ac 94 f1 57 f4 67 cb 3d 1c 5c 21 92 da 58 42 f7 05 f8 60 17 6d 1a fe 1e ec 6d 71 77 a1 16 4b 00>,
     absValidity: 2018-03-21T20:16:15.085Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 03 fe ea c8 da 69 b8 f7>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:16:15 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521576975998
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521577034964
connected to auth! from local port 40360
received auth hello!
{ authId: 501, nonce: <Buffer ee 57 a2 3a ec 78 68 f6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9a fe 28 40 44 6f 00 d2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100507,
  cipherKeyVal: <Buffer 4f ff 37 56 3f 35 fc 8c eb dd 46 e2 86 3f 1c e8>,
  macKeyVal: <Buffer 39 23 88 4b 1e 7d 50 be 04 74 75 0e dd 7f 28 ec eb 63 5f fe 04 a7 6a 29 a7 11 c8 90 84 fa ed b6>,
  absValidity: 2018-03-21T20:17:15.160Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.25',
  serverPort: 22100,
  sessionKey: 
   { id: 50100507,
     cipherKeyVal: <Buffer 4f ff 37 56 3f 35 fc 8c eb dd 46 e2 86 3f 1c e8>,
     macKeyVal: <Buffer 39 23 88 4b 1e 7d 50 be 04 74 75 0e dd 7f 28 ec eb 63 5f fe 04 a7 6a 29 a7 11 c8 90 84 fa ed b6>,
     absValidity: 2018-03-21T20:17:15.160Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 67 94 e7 b7 27 9b 9a bd>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:17:16 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521577036372
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521577095020
connected to auth! from local port 40632
received auth hello!
{ authId: 501, nonce: <Buffer b9 3e 12 52 0d 00 40 1e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 34 72 29 36 89 0b ef 00>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100515,
  cipherKeyVal: <Buffer 72 4d 04 8b ea 3b e3 77 43 8b e2 9c 69 5f 02 ef>,
  macKeyVal: <Buffer f5 25 9c 68 42 bd f0 5c 53 7f 09 98 5d b0 10 6f 81 4c 67 6c d4 ea c7 60 8e a3 2e 60 ed 4c 3c a7>,
  absValidity: 2018-03-21T20:18:15.185Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.25',
  serverPort: 22100,
  sessionKey: 
   { id: 50100515,
     cipherKeyVal: <Buffer 72 4d 04 8b ea 3b e3 77 43 8b e2 9c 69 5f 02 ef>,
     macKeyVal: <Buffer f5 25 9c 68 42 bd f0 5c 53 7f 09 98 5d b0 10 6f 81 4c 67 6c d4 ea c7 60 8e a3 2e 60 ed 4c 3c a7>,
     absValidity: 2018-03-21T20:18:15.185Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 93 fd 0f 55 13 af 3c 69>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:18:16 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521577096435
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521577155077
connected to auth! from local port 40902
received auth hello!
{ authId: 501, nonce: <Buffer 3d c7 b3 79 ae 41 f7 6e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c9 46 29 3e c3 dd ae 02>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100523,
  cipherKeyVal: <Buffer 93 d0 93 1b c0 6b af b1 2d 83 7b 61 21 8f 8b 51>,
  macKeyVal: <Buffer 5b ab 3a 5e 97 b4 1a ab f5 f7 b4 76 db 19 88 25 6e fa 9c b4 56 13 b6 d1 cd 99 06 0c 43 fb 6b 9e>,
  absValidity: 2018-03-21T20:19:15.301Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.25',
  serverPort: 22100,
  sessionKey: 
   { id: 50100523,
     cipherKeyVal: <Buffer 93 d0 93 1b c0 6b af b1 2d 83 7b 61 21 8f 8b 51>,
     macKeyVal: <Buffer 5b ab 3a 5e 97 b4 1a ab f5 f7 b4 76 db 19 88 25 6e fa 9c b4 56 13 b6 d1 cd 99 06 0c 43 fb 6b 9e>,
     absValidity: 2018-03-21T20:19:15.301Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 01 3d 6d 96 85 ba 36 b8>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:19:16 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521577156416
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521577215085
connected to auth! from local port 41170
received auth hello!
{ authId: 501, nonce: <Buffer 56 29 61 09 4d 11 d2 09> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ed 38 ec 1b e0 cb fd 51>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100531,
  cipherKeyVal: <Buffer cb 95 b2 43 f0 35 8b 3e e5 6a 72 69 fb 5d 97 67>,
  macKeyVal: <Buffer 9a 76 e2 ef bb 12 1c 50 c4 b2 9b 26 50 5a ca fc 5a f2 aa 0c 17 49 08 58 d2 de e9 e7 d3 d7 1b 45>,
  absValidity: 2018-03-21T20:20:15.297Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.25',
  serverPort: 22100,
  sessionKey: 
   { id: 50100531,
     cipherKeyVal: <Buffer cb 95 b2 43 f0 35 8b 3e e5 6a 72 69 fb 5d 97 67>,
     macKeyVal: <Buffer 9a 76 e2 ef bb 12 1c 50 c4 b2 9b 26 50 5a ca fc 5a f2 aa 0c 17 49 08 58 d2 de e9 e7 d3 d7 1b 45>,
     absValidity: 2018-03-21T20:20:15.297Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 89 98 e2 85 52 80 c7 f9>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:20:16 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521577216688
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521577275141
connected to auth! from local port 41440
received auth hello!
{ authId: 501, nonce: <Buffer 23 67 95 9e 38 30 c8 38> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d0 ae 32 0c 44 18 b3 29>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100539,
  cipherKeyVal: <Buffer 0e 2c c5 84 45 41 03 1b 4c 90 23 d2 36 6c e3 29>,
  macKeyVal: <Buffer 62 00 44 f1 da de 27 35 35 a0 9b 3f 6d fa 04 9e a3 e2 1f 02 28 c6 e5 a1 5a 5c 07 43 60 cf f0 42>,
  absValidity: 2018-03-21T20:21:15.378Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.25',
  serverPort: 22100,
  sessionKey: 
   { id: 50100539,
     cipherKeyVal: <Buffer 0e 2c c5 84 45 41 03 1b 4c 90 23 d2 36 6c e3 29>,
     macKeyVal: <Buffer 62 00 44 f1 da de 27 35 35 a0 9b 3f 6d fa 04 9e a3 e2 1f 02 28 c6 e5 a1 5a 5c 07 43 60 cf f0 42>,
     absValidity: 2018-03-21T20:21:15.378Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 36 a2 b6 75 30 0b ac 9f>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:21:16 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521577276624
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521577335159
connected to auth! from local port 41712
received auth hello!
{ authId: 501, nonce: <Buffer 3e fe 14 80 ed a2 21 32> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 48 e2 ef 7e 35 a3 62 4c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100547,
  cipherKeyVal: <Buffer 00 ce d4 fb ea a0 ea 50 f5 5d 3f de f3 38 59 fd>,
  macKeyVal: <Buffer 4b eb 11 80 60 0e 76 f4 8f 6f 16 bf 2c 25 da c7 c9 c5 cc a9 d1 5d 71 53 8a 70 57 9a 6e c9 4c 1e>,
  absValidity: 2018-03-21T20:22:15.376Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.25',
  serverPort: 22100,
  sessionKey: 
   { id: 50100547,
     cipherKeyVal: <Buffer 00 ce d4 fb ea a0 ea 50 f5 5d 3f de f3 38 59 fd>,
     macKeyVal: <Buffer 4b eb 11 80 60 0e 76 f4 8f 6f 16 bf 2c 25 da c7 c9 c5 cc a9 d1 5d 71 53 8a 70 57 9a 6e c9 4c 1e>,
     absValidity: 2018-03-21T20:22:15.376Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 1c 3d 9d aa 9d d3 f0 26>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:22:16 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521577336499
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521577395218
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 9 0.7777777777777778 1521577455228
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 43354
received auth hello!
{ authId: 401, nonce: <Buffer c0 e7 40 90 d1 9e 7b 95> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 10 0.7 1521577515237
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 43572
received auth hello!
{ authId: 401, nonce: <Buffer 6e 86 14 28 ce 09 dc 58> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 11 0.6363636363636364 1521577575245
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 12 0.5833333333333334 1521577635248
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 36052
received auth hello!
{ authId: 502, nonce: <Buffer 0a f7 af ad 9b aa b9 be> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '0162450C19DA',
  notBefore: 2018-03-20T20:12:23.000Z,
  notAfter: 2018-03-21T20:14:03.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '16:73:A5:AB:6C:D0:49:35:45:A8:B1:C3:92:BD:80:6F:ED:A8:64:8A',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'E40B9EF20959AA49D02016EC2E9896074EE0818689EAD7319ECC8ED8C9557412ED46C95E67464598F6233ECEB8BF25A876F0D30B65CED2B1FED8D1F07CF9042FD7F86E3B637BE17FBFD7C9F0DB5850835170B354A52C175B769A37BA578F965436FF29BCFD54C5D4E939E02214503C8A69FFBBF0EC06657DF9498BE98DEB26B62E1453817F6DFAE9B50EE21C5A643FF0292539838A682562303CB77FC6028B22B30B78957E4F78E539103F991928681EBF3100D31960F43F8ECFC6C2F3063B353E92BFFEF77A49BBCBF417864AE8169AA061F590E5FB3393A4592EFA1100FC186B95B83724CA0B11D8BC02BC9BD4F9E08552DE2D1EB0EE0E866E41A520730E6F',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJFDBnaMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDMy\nMDIwMTIyM1oXDTE4MDMyMTIwMTQwM1owYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDkC57yCVmqSdAgFuwumJYHTuCBhonq1zGezI7YyVV0Eu1GyV5n\nRkWY9iM+zri/Jah28NMLZc7Ssf7Y0fB8+QQv1/huO2N74X+/18nw21hQg1Fws1Sl\nLBdbdpo3ulePllQ2/ym8/VTF1Ok54CIUUDyKaf+78OwGZX35SYvpjesmti4UU4F/\nbfrptQ7iHFpkP/ApJTmDimglYjA8t3/GAosiswt4lX5PeOU5ED+ZGShoHr8xANMZ\nYPQ/js/GwvMGOzU+kr/+93pJu8v0F4ZK6BaaoGH1kOX7M5OkWS76EQD8GGuVuDck\nygsR2LwCvJvU+eCFUt4tHrDuDoZuQaUgcw5vAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAH7QXjZr3ZWfkEcMAV5SQeM5Vb8jvTQ2\n9cIWOeloMIbjyXr8urt3LDOWrtnhBeY9fkBLGez/6MOBEG1Aguff+31mDI0XkvrC\nfb8bRwp6/LgKnr0OejctWMMMyqD4qWRZPfVNZOPl/bBjh6pESzRmwIHuUBpvWvcg\nNxPmLFvlpDWwPIOCMqzi3CYO70l+zjZQHClS99FSbZuA86wvNG8yWbbCNd0mNaCM\nZuOJZRlryLzjn6bRBiVfIYO5BE2mVw+AXEl4uqMS6BYpKF/IXsUU1Dnt650z7GXR\nb80JcN1iMzytwHHj7v+hahg4M2h6gbRRP/SAAHA+RF6itLNO0N+InFQ=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 2
to: 3
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 13 0.5384615384615384 1521577695258
connected to auth! from local port 36272
received auth hello!
{ authId: 502, nonce: <Buffer 1b 73 16 8f 67 93 04 a7> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 4c c2 36 b9 60 95 3b 1c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 75 a7 1c 04 c9 00 d5 a9 2f c4 1b f0 9f ff 64 94>,
  macKeyVal: <Buffer 2b 8e 8b 57 aa 26 fd 07 8c d2 0d 16 b1 fd 9b d0 46 75 a2 49 e5 b8 24 c7 2f ce 85 3d 28 c4 94 66>,
  absValidity: 2018-03-20T21:28:15.466Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200803,
  cipherKeyVal: <Buffer d0 cd 2a a8 49 88 cf 7f c7 44 35 b7 4c 53 3b e9>,
  macKeyVal: <Buffer 72 35 4e df 9a 9d 6e f9 c5 dc 41 9a 93 59 92 b7 dc 1c 6d 7c b6 28 a6 91 1d 71 4f 59 a2 08 4c 0a>,
  absValidity: 2018-03-21T20:28:15.466Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.25',
  serverPort: 22100,
  sessionKey: 
   { id: 50200803,
     cipherKeyVal: <Buffer d0 cd 2a a8 49 88 cf 7f c7 44 35 b7 4c 53 3b e9>,
     macKeyVal: <Buffer 72 35 4e df 9a 9d 6e f9 c5 dc 41 9a 93 59 92 b7 dc 1c 6d 7c b6 28 a6 91 1d 71 4f 59 a2 08 4c 0a>,
     absValidity: 2018-03-21T20:28:15.466Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 88 25 e9 ec dc 31 4d 9a>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.25:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 14 0.5 1521577755265
connected to auth! from local port 36508
received auth hello!
{ authId: 502, nonce: <Buffer ca 3c d3 0a 5e 85 5f b6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 01 5a 6e 8b 1b a9 da e6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200817,
  cipherKeyVal: <Buffer e1 d0 72 cc 82 f1 63 b3 05 e7 1a b0 83 99 03 85>,
  macKeyVal: <Buffer e0 2b b6 8b 8e 42 95 45 00 07 d7 48 a9 d7 98 d2 79 68 97 24 5e 04 3e c7 fd 57 3b 51 10 2e 36 25>,
  absValidity: 2018-03-21T20:29:19.176Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.25',
  serverPort: 22100,
  sessionKey: 
   { id: 50200817,
     cipherKeyVal: <Buffer e1 d0 72 cc 82 f1 63 b3 05 e7 1a b0 83 99 03 85>,
     macKeyVal: <Buffer e0 2b b6 8b 8e 42 95 45 00 07 d7 48 a9 d7 98 d2 79 68 97 24 5e 04 3e c7 fd 57 3b 51 10 2e 36 25>,
     absValidity: 2018-03-21T20:29:19.176Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 9b dc 8e b5 37 3f 1a 9e>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.25:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 15 0.4666666666666667 1521577815271
connected to auth! from local port 36756
received auth hello!
{ authId: 502, nonce: <Buffer d6 fb 88 96 a9 81 d4 e5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fb 5e e5 c1 15 90 09 78>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200832,
  cipherKeyVal: <Buffer 5b 22 b6 72 43 d5 21 3e 37 eb a3 93 88 02 13 85>,
  macKeyVal: <Buffer 47 b7 d9 29 e8 8e 6c 8b 33 c2 ce 09 19 20 5b 11 81 8f 95 ac f3 81 70 4a 9c 08 3a 5b f0 93 31 f8>,
  absValidity: 2018-03-21T20:30:19.185Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.25',
  serverPort: 22100,
  sessionKey: 
   { id: 50200832,
     cipherKeyVal: <Buffer 5b 22 b6 72 43 d5 21 3e 37 eb a3 93 88 02 13 85>,
     macKeyVal: <Buffer 47 b7 d9 29 e8 8e 6c 8b 33 c2 ce 09 19 20 5b 11 81 8f 95 ac f3 81 70 4a 9c 08 3a 5b f0 93 31 f8>,
     absValidity: 2018-03-21T20:30:19.185Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 97 c4 1a 18 32 5d fd b3>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.25:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 16 0.4375 1521577875277
connected to auth! from local port 37006
received auth hello!
{ authId: 502, nonce: <Buffer e4 4d 3d 49 65 b0 94 e1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ca 07 c7 fc a5 e8 53 50>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200848,
  cipherKeyVal: <Buffer b2 b9 5d cd 8d 8c c3 52 fe 16 e7 78 45 ba 00 40>,
  macKeyVal: <Buffer db da dc 1f 7f 86 e9 38 b0 69 bd 97 df 0e 1a b6 0a 57 92 80 69 5b a8 e8 e1 ce 96 73 b3 10 e9 00>,
  absValidity: 2018-03-21T20:31:17.638Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.25',
  serverPort: 22100,
  sessionKey: 
   { id: 50200848,
     cipherKeyVal: <Buffer b2 b9 5d cd 8d 8c c3 52 fe 16 e7 78 45 ba 00 40>,
     macKeyVal: <Buffer db da dc 1f 7f 86 e9 38 b0 69 bd 97 df 0e 1a b6 0a 57 92 80 69 5b a8 e8 e1 ce 96 73 b3 10 e9 00>,
     absValidity: 2018-03-21T20:31:17.638Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 72 aa 16 7c 3f a3 03 43>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.25:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 17 0.4117647058823529 1521577935285
connected to auth! from local port 37256
received auth hello!
{ authId: 502, nonce: <Buffer 91 51 82 aa 35 55 b7 d1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6a 40 5e be 45 76 74 f3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200863,
  cipherKeyVal: <Buffer 06 69 ca 26 8b d6 a5 85 1a b5 0e 39 de a7 ee 57>,
  macKeyVal: <Buffer 4f 01 53 10 4b 48 7f 59 a1 00 70 75 b1 82 8d 87 f5 3a bc a4 ab b0 28 7a 4f 41 68 b9 42 4f d1 b2>,
  absValidity: 2018-03-21T20:32:27.138Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.25',
  serverPort: 22100,
  sessionKey: 
   { id: 50200863,
     cipherKeyVal: <Buffer 06 69 ca 26 8b d6 a5 85 1a b5 0e 39 de a7 ee 57>,
     macKeyVal: <Buffer 4f 01 53 10 4b 48 7f 59 a1 00 70 75 b1 82 8d 87 f5 3a bc a4 ab b0 28 7a 4f 41 68 b9 42 4f d1 b2>,
     absValidity: 2018-03-21T20:32:27.138Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer c7 5e cc f1 6a 13 cc 88>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.25:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 18 0.3888888888888889 1521577995325
connected to auth! from local port 37446
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
received auth hello!
{ authId: 502, nonce: <Buffer 47 6b 57 c8 df fd 9f 51> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 24 73 ca 62 e9 48 70 ef>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200876,
  cipherKeyVal: <Buffer f2 58 8c 24 ce cb bd 65 e2 cf 6f 49 27 52 cb 4e>,
  macKeyVal: <Buffer a4 af 19 65 13 39 8e 87 cf 51 15 ac 54 cd f0 e1 9b c4 cf 67 30 56 05 ef 13 10 c2 b4 ae 36 92 18>,
  absValidity: 2018-03-21T20:33:19.138Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.25',
  serverPort: 22100,
  sessionKey: 
   { id: 50200876,
     cipherKeyVal: <Buffer f2 58 8c 24 ce cb bd 65 e2 cf 6f 49 27 52 cb 4e>,
     macKeyVal: <Buffer a4 af 19 65 13 39 8e 87 cf 51 15 ac 54 cd f0 e1 9b c4 cf 67 30 56 05 ef 13 10 c2 b4 ae 36 92 18>,
     absValidity: 2018-03-21T20:33:19.138Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.25:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 19 0.3684210526315789 1521578055381
connected to auth! from local port 37612
received auth hello!
{ authId: 502, nonce: <Buffer 7e 43 6c 43 19 21 ef 4a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 77 63 81 fc 0e 2e 50 1d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200888,
  cipherKeyVal: <Buffer 69 60 0e 73 1b 6e 14 10 e6 a3 fc 53 a5 89 9a 93>,
  macKeyVal: <Buffer 03 b8 63 7a c3 c2 bc 86 8a 49 42 3c 49 98 5a 19 b0 27 a4 6e a8 ae 91 b8 50 b6 ca 2e 00 57 47 c7>,
  absValidity: 2018-03-21T20:34:15.855Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.25',
  serverPort: 22100,
  sessionKey: 
   { id: 50200888,
     cipherKeyVal: <Buffer 69 60 0e 73 1b 6e 14 10 e6 a3 fc 53 a5 89 9a 93>,
     macKeyVal: <Buffer 03 b8 63 7a c3 c2 bc 86 8a 49 42 3c 49 98 5a 19 b0 27 a4 6e a8 ae 91 b8 50 b6 ca 2e 00 57 47 c7>,
     absValidity: 2018-03-21T20:34:15.855Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.25:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 20 0.35 1521578115408
connected to auth! from local port 37778
received auth hello!
{ authId: 502, nonce: <Buffer 23 a8 0a 98 97 0f d8 47> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 91 60 c3 ac e2 40 e4 b1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200900,
  cipherKeyVal: <Buffer ce e3 6b 65 6c 4b 9f 1c d0 40 6b 2c 18 33 72 c4>,
  macKeyVal: <Buffer 0c 3d 9c 13 93 9b 33 56 5c 7f e2 a3 a1 d6 b2 cc cb c4 33 94 ac 6e 4f da 91 6b 42 bf fd 47 3e 87>,
  absValidity: 2018-03-21T20:35:16.143Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.25',
  serverPort: 22100,
  sessionKey: 
   { id: 50200900,
     cipherKeyVal: <Buffer ce e3 6b 65 6c 4b 9f 1c d0 40 6b 2c 18 33 72 c4>,
     macKeyVal: <Buffer 0c 3d 9c 13 93 9b 33 56 5c 7f e2 a3 a1 d6 b2 cc cb c4 33 94 ac 6e 4f da 91 6b 42 bf fd 47 3e 87>,
     absValidity: 2018-03-21T20:35:16.143Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.25:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 21 0.3333333333333333 1521578175468
connected to auth! from local port 37944
received auth hello!
{ authId: 502, nonce: <Buffer 17 e7 81 5a 2b a0 bc 1e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 44 88 1d 33 40 ce c2 28>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200912,
  cipherKeyVal: <Buffer b1 55 26 29 d3 b7 64 2a 65 67 43 10 59 ba 0f 42>,
  macKeyVal: <Buffer f2 8b 60 c7 96 f1 1a ca 5d e7 bb 6e e0 fa 86 96 e5 41 71 54 59 83 ab ef 1f da 66 fa 19 b3 5f a2>,
  absValidity: 2018-03-21T20:36:16.238Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.25',
  serverPort: 22100,
  sessionKey: 
   { id: 50200912,
     cipherKeyVal: <Buffer b1 55 26 29 d3 b7 64 2a 65 67 43 10 59 ba 0f 42>,
     macKeyVal: <Buffer f2 8b 60 c7 96 f1 1a ca 5d e7 bb 6e e0 fa 86 96 e5 41 71 54 59 83 ab ef 1f da 66 fa 19 b3 5f a2>,
     absValidity: 2018-03-21T20:36:16.238Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.25:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 22 0.3181818181818182 1521578235524
connected to auth! from local port 38110
received auth hello!
{ authId: 502, nonce: <Buffer 74 ea 2e 8d 2c 42 5f c9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9c d1 92 73 6e 30 60 c0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200924,
  cipherKeyVal: <Buffer 2f 1c 0f dd b1 3d ac 7a 98 02 3f 93 13 46 db 03>,
  macKeyVal: <Buffer 44 e4 3e ba 67 9d 05 b1 88 c7 df b8 11 2a eb 38 4f 02 27 e9 30 11 af 88 01 d6 c8 9b e2 46 3c aa>,
  absValidity: 2018-03-21T20:37:15.966Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.25',
  serverPort: 22100,
  sessionKey: 
   { id: 50200924,
     cipherKeyVal: <Buffer 2f 1c 0f dd b1 3d ac 7a 98 02 3f 93 13 46 db 03>,
     macKeyVal: <Buffer 44 e4 3e ba 67 9d 05 b1 88 c7 df b8 11 2a eb 38 4f 02 27 e9 30 11 af 88 01 d6 c8 9b e2 46 3c aa>,
     absValidity: 2018-03-21T20:37:15.966Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.25:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 23 0.30434782608695654 1521578295572
connected to auth! from local port 38270
received auth hello!
{ authId: 502, nonce: <Buffer 98 79 7c 91 a1 47 9b 09> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ad 37 a1 dd f8 8f c8 4d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200936,
  cipherKeyVal: <Buffer f8 53 15 b5 e0 da 49 ca 58 47 bb 6a a4 b4 36 d0>,
  macKeyVal: <Buffer 3d a9 bb f7 12 53 20 2d d4 05 f0 87 24 07 c7 83 a1 4e a5 83 fc 06 6f 77 51 3d 0e 55 a1 ee c4 dc>,
  absValidity: 2018-03-21T20:38:16.022Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.25',
  serverPort: 22100,
  sessionKey: 
   { id: 50200936,
     cipherKeyVal: <Buffer f8 53 15 b5 e0 da 49 ca 58 47 bb 6a a4 b4 36 d0>,
     macKeyVal: <Buffer 3d a9 bb f7 12 53 20 2d d4 05 f0 87 24 07 c7 83 a1 4e a5 83 fc 06 6f 77 51 3d 0e 55 a1 ee c4 dc>,
     absValidity: 2018-03-21T20:38:16.022Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.25:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 24 0.2916666666666667 1521578355601
connected to auth! from local port 38436
received auth hello!
{ authId: 502, nonce: <Buffer 53 ff e2 42 25 75 f1 c2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a8 a8 33 51 18 c4 24 b6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200948,
  cipherKeyVal: <Buffer 5f d6 3b 40 9f 87 7f fc 3e b2 51 04 bd 6d de c8>,
  macKeyVal: <Buffer 98 cb 23 be 01 25 fe 56 95 61 bd c8 84 c9 1b 62 d4 95 f1 cf e3 b8 3e f5 c9 da b3 e0 0f 52 b3 5c>,
  absValidity: 2018-03-21T20:39:16.066Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.25',
  serverPort: 22100,
  sessionKey: 
   { id: 50200948,
     cipherKeyVal: <Buffer 5f d6 3b 40 9f 87 7f fc 3e b2 51 04 bd 6d de c8>,
     macKeyVal: <Buffer 98 cb 23 be 01 25 fe 56 95 61 bd c8 84 c9 1b 62 d4 95 f1 cf e3 b8 3e f5 c9 da b3 e0 0f 52 b3 5c>,
     absValidity: 2018-03-21T20:39:16.066Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.25:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 25 0.28 1521578415637
connected to auth! from local port 38602
received auth hello!
{ authId: 502, nonce: <Buffer 26 ef 26 a3 64 0b 76 3c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7a 13 b8 65 c6 f7 8a 43>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200960,
  cipherKeyVal: <Buffer 21 14 0e 1b ce 95 bb 45 00 bf 81 9e d3 57 50 be>,
  macKeyVal: <Buffer ed 55 b3 67 b5 33 7e 9b f0 e6 e5 68 57 5d 8d ee 73 30 e9 1e cc 57 5d 16 14 65 82 7e 71 fc de c8>,
  absValidity: 2018-03-21T20:40:16.100Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.25',
  serverPort: 22100,
  sessionKey: 
   { id: 50200960,
     cipherKeyVal: <Buffer 21 14 0e 1b ce 95 bb 45 00 bf 81 9e d3 57 50 be>,
     macKeyVal: <Buffer ed 55 b3 67 b5 33 7e 9b f0 e6 e5 68 57 5d 8d ee 73 30 e9 1e cc 57 5d 16 14 65 82 7e 71 fc de c8>,
     absValidity: 2018-03-21T20:40:16.100Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.25:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 26 0.2692307692307692 1521578475671
connected to auth! from local port 38766
received auth hello!
{ authId: 502, nonce: <Buffer 9e b7 74 97 2d ad 94 2e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ff 00 c8 2b 7f 5f 80 41>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200972,
  cipherKeyVal: <Buffer aa df db 86 30 65 ba 73 cb 32 4f d2 98 96 e2 38>,
  macKeyVal: <Buffer ba 8b 76 35 8f 18 5e fa 40 32 68 08 76 5d 4a 17 9e 86 a3 97 cf 63 fd d7 5c f7 d1 04 10 30 5d 02>,
  absValidity: 2018-03-21T20:41:16.171Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.25',
  serverPort: 22100,
  sessionKey: 
   { id: 50200972,
     cipherKeyVal: <Buffer aa df db 86 30 65 ba 73 cb 32 4f d2 98 96 e2 38>,
     macKeyVal: <Buffer ba 8b 76 35 8f 18 5e fa 40 32 68 08 76 5d 4a 17 9e 86 a3 97 cf 63 fd d7 5c f7 d1 04 10 30 5d 02>,
     absValidity: 2018-03-21T20:41:16.171Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.25:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 27 0.25925925925925924 1521578535710
connected to auth! from local port 38932
received auth hello!
{ authId: 502, nonce: <Buffer 4f 7a 55 04 d9 cb 7c 86> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e6 62 ed 10 b1 53 59 8b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200984,
  cipherKeyVal: <Buffer 7c be ac 93 92 d6 96 00 aa 0d 4f e5 74 20 d1 ad>,
  macKeyVal: <Buffer eb f6 31 9c 7d 3c dc 2c 5e 77 d1 19 cc 09 ee c1 04 65 7d bf a6 cf 5b e9 ca 21 60 d6 a9 ce 99 88>,
  absValidity: 2018-03-21T20:42:16.198Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.25',
  serverPort: 22100,
  sessionKey: 
   { id: 50200984,
     cipherKeyVal: <Buffer 7c be ac 93 92 d6 96 00 aa 0d 4f e5 74 20 d1 ad>,
     macKeyVal: <Buffer eb f6 31 9c 7d 3c dc 2c 5e 77 d1 19 cc 09 ee c1 04 65 7d bf a6 cf 5b e9 ca 21 60 d6 a9 ce 99 88>,
     absValidity: 2018-03-21T20:42:16.198Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.25:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 28 0.25 1521578595738
connected to auth! from local port 39096
received auth hello!
{ authId: 502, nonce: <Buffer 02 68 9f c3 b0 1e 81 4a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 34 5c 5f 77 0a 34 09 22>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200996,
  cipherKeyVal: <Buffer 40 2f 63 fb 25 7c 59 22 ed 93 91 03 cd e2 e3 78>,
  macKeyVal: <Buffer 6c 6a 72 b1 6f d4 3f 1d 12 99 cb bc 6e f9 3c 64 02 7d 5a d0 b5 2a 24 15 32 8f 2e 74 a7 c3 01 2f>,
  absValidity: 2018-03-21T20:43:16.258Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.25',
  serverPort: 22100,
  sessionKey: 
   { id: 50200996,
     cipherKeyVal: <Buffer 40 2f 63 fb 25 7c 59 22 ed 93 91 03 cd e2 e3 78>,
     macKeyVal: <Buffer 6c 6a 72 b1 6f d4 3f 1d 12 99 cb bc 6e f9 3c 64 02 7d 5a d0 b5 2a 24 15 32 8f 2e 74 a7 c3 01 2f>,
     absValidity: 2018-03-21T20:43:16.258Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.25:22100
disconnected from auth
