changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c506.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c506',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 79 53 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521576988151
connected to auth! from local port 51404
received auth hello!
{ authId: 501, nonce: <Buffer 2c 44 52 61 55 c3 09 bc> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 8c 7b 79 f2 dc f5 88 b0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer b4 4a 1c da 69 83 a2 c9 08 ac 7f 55 e8 e0 9b eb>,
  macKeyVal: <Buffer 23 6a c1 82 17 ee 17 0b 41 eb cf 2e a6 4c b5 c0 f4 43 a8 c3 6d 01 31 2a 9a 78 a0 2c 10 a6 96 cf>,
  absValidity: 2018-03-20T21:16:28.309Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100501,
  cipherKeyVal: <Buffer ab d3 24 af 61 8d df 83 fb 0c 01 d6 62 3e 07 dd>,
  macKeyVal: <Buffer 8a 8a 55 27 3a a6 dc a4 25 ef 77 ae 28 c9 bf 3f 11 3c 71 b1 30 70 32 8d db c5 93 8a e4 fc 45 39>,
  absValidity: 2018-03-21T20:16:28.308Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.27',
  serverPort: 22100,
  sessionKey: 
   { id: 50100501,
     cipherKeyVal: <Buffer ab d3 24 af 61 8d df 83 fb 0c 01 d6 62 3e 07 dd>,
     macKeyVal: <Buffer 8a 8a 55 27 3a a6 dc a4 25 ef 77 ae 28 c9 bf 3f 11 3c 71 b1 30 70 32 8d db c5 93 8a e4 fc 45 39>,
     absValidity: 2018-03-21T20:16:28.308Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 19 d5 03 50 c5 0d f6 3f>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:16:29 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521576989392
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521577048187
connected to auth! from local port 51658
received auth hello!
{ authId: 501, nonce: <Buffer 96 22 9c a6 63 9f c4 11> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0e 63 ae b6 39 2d 3d 00>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100509,
  cipherKeyVal: <Buffer ac 4c 1c 8e f3 5d da bf d7 71 91 cc ce bd 4c 04>,
  macKeyVal: <Buffer 90 98 cc 5d eb 8f e5 f8 f9 dd c5 14 2e 5d 51 68 8d cf 90 01 a2 2c 34 32 5d c1 d7 73 0c 37 97 bc>,
  absValidity: 2018-03-21T20:17:28.351Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.27',
  serverPort: 22100,
  sessionKey: 
   { id: 50100509,
     cipherKeyVal: <Buffer ac 4c 1c 8e f3 5d da bf d7 71 91 cc ce bd 4c 04>,
     macKeyVal: <Buffer 90 98 cc 5d eb 8f e5 f8 f9 dd c5 14 2e 5d 51 68 8d cf 90 01 a2 2c 34 32 5d c1 d7 73 0c 37 97 bc>,
     absValidity: 2018-03-21T20:17:28.351Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 74 23 4c 57 d2 fb c3 7c>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:17:29 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521577049325
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521577108245
connected to auth! from local port 51928
received auth hello!
{ authId: 501, nonce: <Buffer 62 66 a1 47 a6 52 c9 64> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0a 5b 04 18 6f 6c 32 a1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100517,
  cipherKeyVal: <Buffer 9b 70 f1 c4 78 b0 34 45 87 2f b4 a5 c9 59 a3 ce>,
  macKeyVal: <Buffer 24 ff fb fe 3d 7e 65 ac c6 b8 a5 de 8e b3 fc 14 ea b2 19 2f d2 01 f6 e7 43 a7 6d 0e 8f 67 08 b4>,
  absValidity: 2018-03-21T20:18:28.430Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.27',
  serverPort: 22100,
  sessionKey: 
   { id: 50100517,
     cipherKeyVal: <Buffer 9b 70 f1 c4 78 b0 34 45 87 2f b4 a5 c9 59 a3 ce>,
     macKeyVal: <Buffer 24 ff fb fe 3d 7e 65 ac c6 b8 a5 de 8e b3 fc 14 ea b2 19 2f d2 01 f6 e7 43 a7 6d 0e 8f 67 08 b4>,
     absValidity: 2018-03-21T20:18:28.430Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer f4 78 48 72 ad bb 3a 07>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:18:29 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521577109474
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521577168305
connected to auth! from local port 52198
received auth hello!
{ authId: 501, nonce: <Buffer 0b fa 80 5d bf 2e 04 a4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cf 13 f9 33 2f e7 61 51>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100525,
  cipherKeyVal: <Buffer c1 b9 39 02 b3 d5 a7 a2 e7 3f 25 b7 03 f8 d7 fc>,
  macKeyVal: <Buffer 19 77 26 0d b2 d1 cf 77 c1 7a a0 40 2d a8 80 cc 0f 50 a2 64 6e 2c a7 2c c7 eb d4 c4 73 69 a7 15>,
  absValidity: 2018-03-21T20:19:28.432Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.27',
  serverPort: 22100,
  sessionKey: 
   { id: 50100525,
     cipherKeyVal: <Buffer c1 b9 39 02 b3 d5 a7 a2 e7 3f 25 b7 03 f8 d7 fc>,
     macKeyVal: <Buffer 19 77 26 0d b2 d1 cf 77 c1 7a a0 40 2d a8 80 cc 0f 50 a2 64 6e 2c a7 2c c7 eb d4 c4 73 69 a7 15>,
     absValidity: 2018-03-21T20:19:28.432Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer f2 e7 5e b8 d6 b4 41 91>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:19:29 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521577169384
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521577228361
connected to auth! from local port 52468
received auth hello!
{ authId: 501, nonce: <Buffer ba a9 53 76 af 68 e5 f0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7a 6c 73 e7 df 64 46 10>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100533,
  cipherKeyVal: <Buffer 49 9c 08 b1 af a7 e1 e4 05 30 71 54 1f db 1b ac>,
  macKeyVal: <Buffer bf c9 0e ad 1e 3a 27 64 00 6b ab bd 6c 85 79 75 e5 6e 5b b9 80 a0 a4 15 e9 3f 27 7a f6 55 ca 45>,
  absValidity: 2018-03-21T20:20:28.533Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.27',
  serverPort: 22100,
  sessionKey: 
   { id: 50100533,
     cipherKeyVal: <Buffer 49 9c 08 b1 af a7 e1 e4 05 30 71 54 1f db 1b ac>,
     macKeyVal: <Buffer bf c9 0e ad 1e 3a 27 64 00 6b ab bd 6c 85 79 75 e5 6e 5b b9 80 a0 a4 15 e9 3f 27 7a f6 55 ca 45>,
     absValidity: 2018-03-21T20:20:28.533Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer f4 80 67 7b e5 61 6f b2>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:20:29 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521577229479
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521577288417
connected to auth! from local port 52738
received auth hello!
{ authId: 501, nonce: <Buffer b1 91 4c ce 46 32 68 4b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fb f8 ae 17 6f 90 07 bb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100541,
  cipherKeyVal: <Buffer f2 5f 92 35 30 e4 9c 50 37 c9 07 dc 0e ad 0d f6>,
  macKeyVal: <Buffer ed 1e c1 17 02 6d d7 b3 72 74 43 2d 96 3e 40 9a 8d 57 74 21 52 87 50 d1 ca 63 e9 3e 72 84 79 25>,
  absValidity: 2018-03-21T20:21:28.614Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.27',
  serverPort: 22100,
  sessionKey: 
   { id: 50100541,
     cipherKeyVal: <Buffer f2 5f 92 35 30 e4 9c 50 37 c9 07 dc 0e ad 0d f6>,
     macKeyVal: <Buffer ed 1e c1 17 02 6d d7 b3 72 74 43 2d 96 3e 40 9a 8d 57 74 21 52 87 50 d1 ca 63 e9 3e 72 84 79 25>,
     absValidity: 2018-03-21T20:21:28.614Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer c0 b9 83 e3 46 de bb bd>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:21:29 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521577289432
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521577348477
connected to auth! from local port 53008
received auth hello!
{ authId: 501, nonce: <Buffer fc 25 ee 03 bd 8a a5 4a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 27 a9 56 67 5d 09 5b 83>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100549,
  cipherKeyVal: <Buffer ed 5e 24 04 ac fd 6c 45 6d 43 f1 ea e0 2e 12 5d>,
  macKeyVal: <Buffer 3e 59 b5 83 d0 7e 93 d3 e1 05 35 0c 81 82 98 fa 00 00 62 f8 1a 72 fd 01 39 16 1c ab b8 a3 52 49>,
  absValidity: 2018-03-21T20:22:28.654Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.27',
  serverPort: 22100,
  sessionKey: 
   { id: 50100549,
     cipherKeyVal: <Buffer ed 5e 24 04 ac fd 6c 45 6d 43 f1 ea e0 2e 12 5d>,
     macKeyVal: <Buffer 3e 59 b5 83 d0 7e 93 d3 e1 05 35 0c 81 82 98 fa 00 00 62 f8 1a 72 fd 01 39 16 1c ab b8 a3 52 49>,
     absValidity: 2018-03-21T20:22:28.654Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer a0 0f d2 a0 a8 8b 64 6b>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:22:29 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521577349638
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521577408536
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 9 0.7777777777777778 1521577468547
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 48028
received auth hello!
{ authId: 401, nonce: <Buffer 2a 39 ae ab 16 5c 81 13> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 10 0.7 1521577528558
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 48246
received auth hello!
{ authId: 401, nonce: <Buffer 6f b7 66 3d 36 3d af dc> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 11 0.6363636363636364 1521577588568
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 12 0.5833333333333334 1521577648575
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 49940
received auth hello!
{ authId: 502, nonce: <Buffer 4d de af 80 46 8e a3 38> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '0162450C19DA',
  notBefore: 2018-03-20T20:12:23.000Z,
  notAfter: 2018-03-21T20:14:03.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '16:73:A5:AB:6C:D0:49:35:45:A8:B1:C3:92:BD:80:6F:ED:A8:64:8A',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'E40B9EF20959AA49D02016EC2E9896074EE0818689EAD7319ECC8ED8C9557412ED46C95E67464598F6233ECEB8BF25A876F0D30B65CED2B1FED8D1F07CF9042FD7F86E3B637BE17FBFD7C9F0DB5850835170B354A52C175B769A37BA578F965436FF29BCFD54C5D4E939E02214503C8A69FFBBF0EC06657DF9498BE98DEB26B62E1453817F6DFAE9B50EE21C5A643FF0292539838A682562303CB77FC6028B22B30B78957E4F78E539103F991928681EBF3100D31960F43F8ECFC6C2F3063B353E92BFFEF77A49BBCBF417864AE8169AA061F590E5FB3393A4592EFA1100FC186B95B83724CA0B11D8BC02BC9BD4F9E08552DE2D1EB0EE0E866E41A520730E6F',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJFDBnaMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDMy\nMDIwMTIyM1oXDTE4MDMyMTIwMTQwM1owYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDkC57yCVmqSdAgFuwumJYHTuCBhonq1zGezI7YyVV0Eu1GyV5n\nRkWY9iM+zri/Jah28NMLZc7Ssf7Y0fB8+QQv1/huO2N74X+/18nw21hQg1Fws1Sl\nLBdbdpo3ulePllQ2/ym8/VTF1Ok54CIUUDyKaf+78OwGZX35SYvpjesmti4UU4F/\nbfrptQ7iHFpkP/ApJTmDimglYjA8t3/GAosiswt4lX5PeOU5ED+ZGShoHr8xANMZ\nYPQ/js/GwvMGOzU+kr/+93pJu8v0F4ZK6BaaoGH1kOX7M5OkWS76EQD8GGuVuDck\nygsR2LwCvJvU+eCFUt4tHrDuDoZuQaUgcw5vAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAH7QXjZr3ZWfkEcMAV5SQeM5Vb8jvTQ2\n9cIWOeloMIbjyXr8urt3LDOWrtnhBeY9fkBLGez/6MOBEG1Aguff+31mDI0XkvrC\nfb8bRwp6/LgKnr0OejctWMMMyqD4qWRZPfVNZOPl/bBjh6pESzRmwIHuUBpvWvcg\nNxPmLFvlpDWwPIOCMqzi3CYO70l+zjZQHClS99FSbZuA86wvNG8yWbbCNd0mNaCM\nZuOJZRlryLzjn6bRBiVfIYO5BE2mVw+AXEl4uqMS6BYpKF/IXsUU1Dnt650z7GXR\nb80JcN1iMzytwHHj7v+hahg4M2h6gbRRP/SAAHA+RF6itLNO0N+InFQ=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 2
to: 3
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 13 0.5384615384615384 1521577708586
connected to auth! from local port 50164
received auth hello!
{ authId: 502, nonce: <Buffer 10 3e 8c f6 bb 36 b0 c7> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 85 d5 a5 5c 93 5c 71 45>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer ba e6 82 01 f6 8c ff e4 75 27 6f f2 5e 9b 0b 4e>,
  macKeyVal: <Buffer 53 b4 35 4a ac f2 9c 10 6e aa d9 be f8 18 57 df 2e b0 da 27 6f 77 bf 4c 4b 2a bd dd df b5 aa dc>,
  absValidity: 2018-03-20T21:28:28.750Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200805,
  cipherKeyVal: <Buffer ff d2 3b e3 15 e6 96 8a d4 b8 c8 c7 82 16 8e 56>,
  macKeyVal: <Buffer 4f a4 cd 0c c5 6c 49 1a 17 93 36 18 a1 01 f0 90 0a ee 10 67 10 0c 91 e4 ba 83 e8 54 f1 f5 f7 63>,
  absValidity: 2018-03-21T20:28:28.750Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.27',
  serverPort: 22100,
  sessionKey: 
   { id: 50200805,
     cipherKeyVal: <Buffer ff d2 3b e3 15 e6 96 8a d4 b8 c8 c7 82 16 8e 56>,
     macKeyVal: <Buffer 4f a4 cd 0c c5 6c 49 1a 17 93 36 18 a1 01 f0 90 0a ee 10 67 10 0c 91 e4 ba 83 e8 54 f1 f5 f7 63>,
     absValidity: 2018-03-21T20:28:28.750Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 76 2d 84 96 fb 76 dd b9>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.27:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 14 0.5 1521577768596
connected to auth! from local port 50406
received auth hello!
{ authId: 502, nonce: <Buffer 5a 83 2d 4b 6e 75 5a b7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d1 0f 44 5e 33 79 32 5c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200820,
  cipherKeyVal: <Buffer bb c9 31 2e 30 d8 d0 e4 c3 a4 5e 13 88 c8 13 5b>,
  macKeyVal: <Buffer 79 70 94 0e c4 d7 67 e9 21 6e 15 c6 9c 7b c3 4d 4d 06 bc 29 74 13 94 05 63 a0 6c 6a 8b d8 a8 ef>,
  absValidity: 2018-03-21T20:29:28.889Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.27',
  serverPort: 22100,
  sessionKey: 
   { id: 50200820,
     cipherKeyVal: <Buffer bb c9 31 2e 30 d8 d0 e4 c3 a4 5e 13 88 c8 13 5b>,
     macKeyVal: <Buffer 79 70 94 0e c4 d7 67 e9 21 6e 15 c6 9c 7b c3 4d 4d 06 bc 29 74 13 94 05 63 a0 6c 6a 8b d8 a8 ef>,
     absValidity: 2018-03-21T20:29:28.889Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 75 80 44 e5 d2 7f 81 7a>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.27:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 15 0.4666666666666667 1521577828606
connected to auth! from local port 50654
received auth hello!
{ authId: 502, nonce: <Buffer 21 3f 0f 6b 34 54 e7 42> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d4 03 98 62 00 14 63 65>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200835,
  cipherKeyVal: <Buffer 75 22 53 cd a2 8e 44 c6 35 a2 14 c1 2c 9f 48 2a>,
  macKeyVal: <Buffer 61 98 90 b7 4e cc 1c 34 b7 dd 67 d0 b1 96 fe d8 b7 00 d9 9e 47 3e 03 27 df 3d 24 9c 38 b3 a5 f4>,
  absValidity: 2018-03-21T20:30:28.808Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.27',
  serverPort: 22100,
  sessionKey: 
   { id: 50200835,
     cipherKeyVal: <Buffer 75 22 53 cd a2 8e 44 c6 35 a2 14 c1 2c 9f 48 2a>,
     macKeyVal: <Buffer 61 98 90 b7 4e cc 1c 34 b7 dd 67 d0 b1 96 fe d8 b7 00 d9 9e 47 3e 03 27 df 3d 24 9c 38 b3 a5 f4>,
     absValidity: 2018-03-21T20:30:28.808Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 1a ac 75 62 7c f9 55 d4>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.27:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 16 0.4375 1521577888613
connected to auth! from local port 50904
received auth hello!
{ authId: 502, nonce: <Buffer 5a cb 26 53 86 f7 1f 2f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f5 82 75 0d e6 19 21 80>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200850,
  cipherKeyVal: <Buffer 0b 70 13 04 18 b5 23 d2 4b d0 ea ad 48 cf 03 6c>,
  macKeyVal: <Buffer 2b 97 bc e7 08 39 f7 53 97 2f df 13 56 07 87 6b e0 d3 f6 a7 6c 8a 25 58 46 1f 96 f1 b4 cb 98 10>,
  absValidity: 2018-03-21T20:31:28.733Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.27',
  serverPort: 22100,
  sessionKey: 
   { id: 50200850,
     cipherKeyVal: <Buffer 0b 70 13 04 18 b5 23 d2 4b d0 ea ad 48 cf 03 6c>,
     macKeyVal: <Buffer 2b 97 bc e7 08 39 f7 53 97 2f df 13 56 07 87 6b e0 d3 f6 a7 6c 8a 25 58 46 1f 96 f1 b4 cb 98 10>,
     absValidity: 2018-03-21T20:31:28.733Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer fc 90 a6 e3 9b 2e 43 42>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.27:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 17 0.4117647058823529 1521577948617
connected to auth! from local port 51160
received auth hello!
{ authId: 502, nonce: <Buffer 7d a5 8b 2f d1 99 a6 a1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7f 73 69 fc 2a 17 db b9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200865,
  cipherKeyVal: <Buffer bb 58 44 26 c2 b4 90 55 f9 2d 19 ef 88 94 58 38>,
  macKeyVal: <Buffer 1c 2e 31 b6 ab 14 a8 80 36 b0 02 be cd 65 ac 18 20 a8 dc 75 e3 89 5d f4 33 93 66 b8 6a 41 ac 9e>,
  absValidity: 2018-03-21T20:32:36.346Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.27',
  serverPort: 22100,
  sessionKey: 
   { id: 50200865,
     cipherKeyVal: <Buffer bb 58 44 26 c2 b4 90 55 f9 2d 19 ef 88 94 58 38>,
     macKeyVal: <Buffer 1c 2e 31 b6 ab 14 a8 80 36 b0 02 be cd 65 ac 18 20 a8 dc 75 e3 89 5d f4 33 93 66 b8 6a 41 ac 9e>,
     absValidity: 2018-03-21T20:32:36.346Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.27:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 18 0.3888888888888889 1521578008621
connected to auth! from local port 51330
received auth hello!
{ authId: 502, nonce: <Buffer 57 b3 7e 4b af e6 b0 4c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f9 4f 6e 24 76 78 14 98>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200877,
  cipherKeyVal: <Buffer 97 f0 d2 2a 87 b5 46 d4 42 52 87 04 1a 22 df 59>,
  macKeyVal: <Buffer 64 e8 ea 5d 2d 7b fd 60 23 dc cb 8e 72 33 a8 3f fb 5a 9e 3a a3 53 97 a4 95 40 08 2b 60 54 28 2e>,
  absValidity: 2018-03-21T20:33:28.762Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.27',
  serverPort: 22100,
  sessionKey: 
   { id: 50200877,
     cipherKeyVal: <Buffer 97 f0 d2 2a 87 b5 46 d4 42 52 87 04 1a 22 df 59>,
     macKeyVal: <Buffer 64 e8 ea 5d 2d 7b fd 60 23 dc cb 8e 72 33 a8 3f fb 5a 9e 3a a3 53 97 a4 95 40 08 2b 60 54 28 2e>,
     absValidity: 2018-03-21T20:33:28.762Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.27:22100
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 19 0.3684210526315789 1521578068681
connected to auth! from local port 51494
received auth hello!
{ authId: 502, nonce: <Buffer 99 1d 61 4e dc 29 de 14> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7f 1c 3e da 3c f9 c0 97>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200889,
  cipherKeyVal: <Buffer 75 60 62 28 b8 81 de 02 58 56 9c f3 71 b2 68 ed>,
  macKeyVal: <Buffer 7f 38 ca 0f 51 6d 9c 50 35 43 5b e9 c0 bb ca 8d 4b 4f 8f 38 1f 26 31 2f 3d cd 05 5e d0 3d 80 36>,
  absValidity: 2018-03-21T20:34:28.812Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.27',
  serverPort: 22100,
  sessionKey: 
   { id: 50200889,
     cipherKeyVal: <Buffer 75 60 62 28 b8 81 de 02 58 56 9c f3 71 b2 68 ed>,
     macKeyVal: <Buffer 7f 38 ca 0f 51 6d 9c 50 35 43 5b e9 c0 bb ca 8d 4b 4f 8f 38 1f 26 31 2f 3d cd 05 5e d0 3d 80 36>,
     absValidity: 2018-03-21T20:34:28.812Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.27:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 20 0.35 1521578128742
connected to auth! from local port 51660
received auth hello!
{ authId: 502, nonce: <Buffer b0 45 6d cb be a1 21 7f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer dc c3 a9 6f c6 e1 35 5f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200901,
  cipherKeyVal: <Buffer a7 a9 03 27 6c 95 2d 03 66 e3 eb bb 30 df 02 b9>,
  macKeyVal: <Buffer 8f 70 1c bc 50 61 ac 59 e9 6b 40 8f b1 0c 34 62 b3 06 df 70 fd 8b 6b c5 1d a0 7c d7 96 6c 0a 01>,
  absValidity: 2018-03-21T20:35:28.952Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.27',
  serverPort: 22100,
  sessionKey: 
   { id: 50200901,
     cipherKeyVal: <Buffer a7 a9 03 27 6c 95 2d 03 66 e3 eb bb 30 df 02 b9>,
     macKeyVal: <Buffer 8f 70 1c bc 50 61 ac 59 e9 6b 40 8f b1 0c 34 62 b3 06 df 70 fd 8b 6b c5 1d a0 7c d7 96 6c 0a 01>,
     absValidity: 2018-03-21T20:35:28.952Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.27:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 21 0.3333333333333333 1521578188802
connected to auth! from local port 51826
received auth hello!
{ authId: 502, nonce: <Buffer e0 dd 11 9d 19 fa e5 96> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 95 8e 37 b8 1a 35 c8 fd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200913,
  cipherKeyVal: <Buffer 54 ee be 82 f1 c9 be 7c 40 dd d9 ec c0 6f 55 ca>,
  macKeyVal: <Buffer 11 13 05 93 fa 9b 4b 4b 66 bc 9e 69 ef 52 38 25 f1 ee 58 e8 3e b9 29 21 e8 37 9c 39 ca c0 04 54>,
  absValidity: 2018-03-21T20:36:28.943Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.27',
  serverPort: 22100,
  sessionKey: 
   { id: 50200913,
     cipherKeyVal: <Buffer 54 ee be 82 f1 c9 be 7c 40 dd d9 ec c0 6f 55 ca>,
     macKeyVal: <Buffer 11 13 05 93 fa 9b 4b 4b 66 bc 9e 69 ef 52 38 25 f1 ee 58 e8 3e b9 29 21 e8 37 9c 39 ca c0 04 54>,
     absValidity: 2018-03-21T20:36:28.943Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.27:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 22 0.3181818181818182 1521578248838
connected to auth! from local port 51992
received auth hello!
{ authId: 502, nonce: <Buffer 7d 7c a0 cb a9 3f 34 0b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ef bf 75 62 bb 8d a5 41>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200925,
  cipherKeyVal: <Buffer e4 83 ca 08 f9 34 f4 8e c2 3f 9d 25 a9 df 6e b6>,
  macKeyVal: <Buffer 18 ad fb a4 06 1e f5 f0 8f cc 4a 3f c4 13 f1 cd 12 72 ce a4 bd 96 b1 4e ba 75 b8 b2 f1 83 af 69>,
  absValidity: 2018-03-21T20:37:28.986Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.27',
  serverPort: 22100,
  sessionKey: 
   { id: 50200925,
     cipherKeyVal: <Buffer e4 83 ca 08 f9 34 f4 8e c2 3f 9d 25 a9 df 6e b6>,
     macKeyVal: <Buffer 18 ad fb a4 06 1e f5 f0 8f cc 4a 3f c4 13 f1 cd 12 72 ce a4 bd 96 b1 4e ba 75 b8 b2 f1 83 af 69>,
     absValidity: 2018-03-21T20:37:28.986Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.27:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 23 0.30434782608695654 1521578308898
connected to auth! from local port 52152
received auth hello!
{ authId: 502, nonce: <Buffer 28 b4 b9 27 7a 1a 80 42> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ae 1f 91 95 03 9a 18 31>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200937,
  cipherKeyVal: <Buffer d1 ec ec 14 7d 99 9a 26 b2 7d 56 3c fa 03 4e 28>,
  macKeyVal: <Buffer 7e 51 1d 16 2d 69 8d d7 2f 56 d9 d3 19 43 a9 e1 ff e6 30 12 43 68 20 c5 98 1d 36 e4 48 76 dc 1b>,
  absValidity: 2018-03-21T20:38:29.013Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.27',
  serverPort: 22100,
  sessionKey: 
   { id: 50200937,
     cipherKeyVal: <Buffer d1 ec ec 14 7d 99 9a 26 b2 7d 56 3c fa 03 4e 28>,
     macKeyVal: <Buffer 7e 51 1d 16 2d 69 8d d7 2f 56 d9 d3 19 43 a9 e1 ff e6 30 12 43 68 20 c5 98 1d 36 e4 48 76 dc 1b>,
     absValidity: 2018-03-21T20:38:29.013Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.27:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 24 0.2916666666666667 1521578368958
connected to auth! from local port 52318
received auth hello!
{ authId: 502, nonce: <Buffer f4 7b f2 a8 2c 5a 65 28> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 80 df b7 68 c4 e8 45 fe>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200949,
  cipherKeyVal: <Buffer 70 6e c8 ba 2e 37 ca bc e6 2d 07 15 97 09 a6 98>,
  macKeyVal: <Buffer 77 12 c1 79 6c f9 65 8e ec 6d 72 72 3d 1b 27 34 64 95 af f8 69 94 b0 42 eb 2e 89 3f aa f4 c2 9c>,
  absValidity: 2018-03-21T20:39:29.131Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.27',
  serverPort: 22100,
  sessionKey: 
   { id: 50200949,
     cipherKeyVal: <Buffer 70 6e c8 ba 2e 37 ca bc e6 2d 07 15 97 09 a6 98>,
     macKeyVal: <Buffer 77 12 c1 79 6c f9 65 8e ec 6d 72 72 3d 1b 27 34 64 95 af f8 69 94 b0 42 eb 2e 89 3f aa f4 c2 9c>,
     absValidity: 2018-03-21T20:39:29.131Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.27:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 25 0.28 1521578429019
connected to auth! from local port 52484
received auth hello!
{ authId: 502, nonce: <Buffer 81 3d 65 59 c5 16 c2 a2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b8 e1 1d 4f 8e 07 95 fb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200961,
  cipherKeyVal: <Buffer 4a c8 b0 11 24 d4 3c 40 f2 13 12 6f 55 e5 1c 5e>,
  macKeyVal: <Buffer 93 d1 0c 42 b1 2f 58 cd 9b 5c 42 11 ea 37 20 3c f8 d7 e1 55 88 30 31 d8 21 73 24 04 5a 78 49 06>,
  absValidity: 2018-03-21T20:40:29.175Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.27',
  serverPort: 22100,
  sessionKey: 
   { id: 50200961,
     cipherKeyVal: <Buffer 4a c8 b0 11 24 d4 3c 40 f2 13 12 6f 55 e5 1c 5e>,
     macKeyVal: <Buffer 93 d1 0c 42 b1 2f 58 cd 9b 5c 42 11 ea 37 20 3c f8 d7 e1 55 88 30 31 d8 21 73 24 04 5a 78 49 06>,
     absValidity: 2018-03-21T20:40:29.175Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.27:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 26 0.2692307692307692 1521578489079
connected to auth! from local port 52650
received auth hello!
{ authId: 502, nonce: <Buffer 6d d1 24 37 5d b8 a1 c8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0c d2 b5 61 33 5c e0 a5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200973,
  cipherKeyVal: <Buffer 46 a4 a4 44 f6 e7 19 72 53 1e c7 1b 3b 92 55 6b>,
  macKeyVal: <Buffer 00 c4 12 77 7d 40 87 4f 7f 44 63 02 1e 63 3e 00 e8 86 df 5c 04 54 f9 7e 2a 5b 13 29 c7 74 e4 08>,
  absValidity: 2018-03-21T20:41:29.242Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.27',
  serverPort: 22100,
  sessionKey: 
   { id: 50200973,
     cipherKeyVal: <Buffer 46 a4 a4 44 f6 e7 19 72 53 1e c7 1b 3b 92 55 6b>,
     macKeyVal: <Buffer 00 c4 12 77 7d 40 87 4f 7f 44 63 02 1e 63 3e 00 e8 86 df 5c 04 54 f9 7e 2a 5b 13 29 c7 74 e4 08>,
     absValidity: 2018-03-21T20:41:29.242Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.27:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 27 0.25925925925925924 1521578549139
connected to auth! from local port 52816
received auth hello!
{ authId: 502, nonce: <Buffer be 07 e5 13 7b 60 76 7a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e2 21 24 97 a8 3e b0 17>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200985,
  cipherKeyVal: <Buffer fe c7 98 6c 5a ee 34 96 57 35 ad d5 00 d8 70 9e>,
  macKeyVal: <Buffer f6 85 8b 43 57 0f a4 6b 64 2d 80 53 17 a7 a4 9f 0b 92 30 0f 7f 89 f7 16 44 64 92 f2 31 2d fa 51>,
  absValidity: 2018-03-21T20:42:29.295Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.27',
  serverPort: 22100,
  sessionKey: 
   { id: 50200985,
     cipherKeyVal: <Buffer fe c7 98 6c 5a ee 34 96 57 35 ad d5 00 d8 70 9e>,
     macKeyVal: <Buffer f6 85 8b 43 57 0f a4 6b 64 2d 80 53 17 a7 a4 9f 0b 92 30 0f 7f 89 f7 16 44 64 92 f2 31 2d fa 51>,
     absValidity: 2018-03-21T20:42:29.295Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.27:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 28 0.25 1521578609198
connected to auth! from local port 52978
received auth hello!
{ authId: 502, nonce: <Buffer 1e 70 f2 b6 c7 86 cb 23> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e3 8a 8f 57 aa c8 fb 0a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200997,
  cipherKeyVal: <Buffer 24 82 e6 f0 67 13 a7 2c 2c dd 55 3a 9e 79 21 96>,
  macKeyVal: <Buffer 27 59 87 f9 43 3a 3e f4 2f 14 66 b5 76 fa 62 d8 20 1c 50 96 58 a8 39 85 cb 1f f0 95 ba 28 2e 09>,
  absValidity: 2018-03-21T20:43:29.365Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.27',
  serverPort: 22100,
  sessionKey: 
   { id: 50200997,
     cipherKeyVal: <Buffer 24 82 e6 f0 67 13 a7 2c 2c dd 55 3a 9e 79 21 96>,
     macKeyVal: <Buffer 27 59 87 f9 43 3a 3e f4 2f 14 66 b5 76 fa 62 d8 20 1c 50 96 58 a8 39 85 cb 1f f0 95 ba 28 2e 09>,
     absValidity: 2018-03-21T20:43:29.365Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.27:22100
disconnected from auth
