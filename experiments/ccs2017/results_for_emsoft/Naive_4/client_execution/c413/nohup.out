changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c413.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c413',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 77 34 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521576948841
connected to auth! from local port 50634
received auth hello!
{ authId: 402, nonce: <Buffer e9 dc 4f 43 74 09 15 df> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 2c db e4 07 0c 31 ad 11>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 4c 38 22 a1 a5 88 cf 4d ab a2 6d 14 f9 e7 f8 3b>,
  macKeyVal: <Buffer 88 0c 19 99 94 4c 0d 74 d6 f9 e6 ed ed f0 c7 de d8 a6 c9 49 2d 28 af 27 10 88 79 f7 a4 82 74 ed>,
  absValidity: 2018-03-20T21:15:50.567Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200312,
  cipherKeyVal: <Buffer 2e f3 55 40 e8 4b 81 b9 fd e8 36 a7 6e 45 ef 74>,
  macKeyVal: <Buffer 5c 64 1d 42 66 b3 3a 3b 40 a6 1b da 1a 7f 57 8d 04 f1 68 d2 e2 06 a3 0b ae 4f 53 a2 9c a5 0f bf>,
  absValidity: 2018-03-21T20:15:50.567Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.16',
  serverPort: 22100,
  sessionKey: 
   { id: 40200312,
     cipherKeyVal: <Buffer 2e f3 55 40 e8 4b 81 b9 fd e8 36 a7 6e 45 ef 74>,
     macKeyVal: <Buffer 5c 64 1d 42 66 b3 3a 3b 40 a6 1b da 1a 7f 57 8d 04 f1 68 d2 e2 06 a3 0b ae 4f 53 a2 9c a5 0f bf>,
     absValidity: 2018-03-21T20:15:50.567Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 7b 5f 5c 8a be 81 24 04>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:15:52 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521576953191
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521577008894
connected to auth! from local port 50820
received auth hello!
{ authId: 402, nonce: <Buffer 24 6d 9a cf 8b 26 4b 2b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cd 18 bc 0e 7c ba af c8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200319,
  cipherKeyVal: <Buffer 3c d5 0e 6e 21 e7 2f 24 e2 91 57 66 a3 ae bd 57>,
  macKeyVal: <Buffer 5f ac cf ed d7 01 97 dd 65 93 55 25 da 2e 19 4e 47 fb 27 f0 21 af 98 c9 80 5e a1 ef b2 01 d4 4b>,
  absValidity: 2018-03-21T20:16:50.632Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.16',
  serverPort: 22100,
  sessionKey: 
   { id: 40200319,
     cipherKeyVal: <Buffer 3c d5 0e 6e 21 e7 2f 24 e2 91 57 66 a3 ae bd 57>,
     macKeyVal: <Buffer 5f ac cf ed d7 01 97 dd 65 93 55 25 da 2e 19 4e 47 fb 27 f0 21 af 98 c9 80 5e a1 ef b2 01 d4 4b>,
     absValidity: 2018-03-21T20:16:50.632Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 6d 2a cc ae ce 9c 0f 1f>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:16:52 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521577013201
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521577068906
connected to auth! from local port 51090
received auth hello!
{ authId: 402, nonce: <Buffer fb 70 25 20 15 24 44 25> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b5 6f 12 13 74 76 f3 0b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200326,
  cipherKeyVal: <Buffer 21 66 9a c7 b1 46 6d 01 e1 ea 08 6e 7c 80 ea 0f>,
  macKeyVal: <Buffer fe 38 0c cf 7d 37 ed 6c d2 c0 7d bd 3e 90 db 8a 66 89 cc d8 5f 92 4f c9 b7 6a 7d da 07 14 d0 60>,
  absValidity: 2018-03-21T20:17:50.700Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.16',
  serverPort: 22100,
  sessionKey: 
   { id: 40200326,
     cipherKeyVal: <Buffer 21 66 9a c7 b1 46 6d 01 e1 ea 08 6e 7c 80 ea 0f>,
     macKeyVal: <Buffer fe 38 0c cf 7d 37 ed 6c d2 c0 7d bd 3e 90 db 8a 66 89 cc d8 5f 92 4f c9 b7 6a 7d da 07 14 d0 60>,
     absValidity: 2018-03-21T20:17:50.700Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 0d 03 9a e6 14 41 a3 47>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:17:52 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521577073232
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521577128960
connected to auth! from local port 51360
received auth hello!
{ authId: 402, nonce: <Buffer a4 32 64 78 63 75 4b 0c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f1 a5 af 91 7d d1 59 6d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200333,
  cipherKeyVal: <Buffer 2e 56 83 16 cf f3 24 91 74 b4 1b bd d1 75 74 c8>,
  macKeyVal: <Buffer f8 b4 bf 4c 72 df 3e 0e 68 6a 2c ff 8c ec a2 67 9c ec 39 45 a0 e4 0d cd 3f f9 6a 00 ad 28 83 4d>,
  absValidity: 2018-03-21T20:18:50.773Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.16',
  serverPort: 22100,
  sessionKey: 
   { id: 40200333,
     cipherKeyVal: <Buffer 2e 56 83 16 cf f3 24 91 74 b4 1b bd d1 75 74 c8>,
     macKeyVal: <Buffer f8 b4 bf 4c 72 df 3e 0e 68 6a 2c ff 8c ec a2 67 9c ec 39 45 a0 e4 0d cd 3f f9 6a 00 ad 28 83 4d>,
     absValidity: 2018-03-21T20:18:50.773Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 9e c7 43 9f ea 63 84 a7>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:18:52 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521577133437
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521577189013
connected to auth! from local port 51630
received auth hello!
{ authId: 402, nonce: <Buffer f8 fa d5 7a b8 6e 63 2e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e9 c9 07 0c 7a b8 85 f1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200340,
  cipherKeyVal: <Buffer 3d 76 80 66 bf 38 3a 56 53 31 a9 76 79 ef 85 03>,
  macKeyVal: <Buffer 98 ef 1a eb 13 2b bf 38 0f be e7 c8 0d 4b a6 b6 fa f5 ad 9d f0 bd ad 69 e7 00 4b 02 11 e9 91 c4>,
  absValidity: 2018-03-21T20:19:50.799Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.16',
  serverPort: 22100,
  sessionKey: 
   { id: 40200340,
     cipherKeyVal: <Buffer 3d 76 80 66 bf 38 3a 56 53 31 a9 76 79 ef 85 03>,
     macKeyVal: <Buffer 98 ef 1a eb 13 2b bf 38 0f be e7 c8 0d 4b a6 b6 fa f5 ad 9d f0 bd ad 69 e7 00 4b 02 11 e9 91 c4>,
     absValidity: 2018-03-21T20:19:50.799Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 3b 4d c0 33 8c 99 5e 22>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:19:52 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521577193416
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521577249065
connected to auth! from local port 51900
received auth hello!
{ authId: 402, nonce: <Buffer 4b 35 f9 69 b8 2e 55 3e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1b 63 d3 3f 24 d8 ae 86>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200347,
  cipherKeyVal: <Buffer a5 38 38 d0 09 87 eb 55 f3 db 75 9a 0e e0 c9 de>,
  macKeyVal: <Buffer 5e 51 b9 d9 46 e7 a0 ec cd 4e aa 4e a9 52 fc 7e 43 f4 2e e5 ec e1 e1 ff 2f bf ed 0b 62 d9 4d 01>,
  absValidity: 2018-03-21T20:20:50.846Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.16',
  serverPort: 22100,
  sessionKey: 
   { id: 40200347,
     cipherKeyVal: <Buffer a5 38 38 d0 09 87 eb 55 f3 db 75 9a 0e e0 c9 de>,
     macKeyVal: <Buffer 5e 51 b9 d9 46 e7 a0 ec cd 4e aa 4e a9 52 fc 7e 43 f4 2e e5 ec e1 e1 ff 2f bf ed 0b 62 d9 4d 01>,
     absValidity: 2018-03-21T20:20:50.846Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 1d 9a 34 f6 e2 61 94 c3>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:20:52 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521577253467
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521577309117
connected to auth! from local port 52170
received auth hello!
{ authId: 402, nonce: <Buffer 38 31 af 8f d6 48 ca 1f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e3 ed ef 5b 96 2d 7e 2d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200354,
  cipherKeyVal: <Buffer 27 dc c0 12 ce eb 91 33 52 4b 0a d0 89 b7 a1 67>,
  macKeyVal: <Buffer 9c 49 46 0d 32 72 cd 3b b4 64 09 e0 c5 d6 4e 7e fb 99 90 34 2e 21 f7 da 30 0c d2 34 f6 d3 36 f6>,
  absValidity: 2018-03-21T20:21:50.890Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.16',
  serverPort: 22100,
  sessionKey: 
   { id: 40200354,
     cipherKeyVal: <Buffer 27 dc c0 12 ce eb 91 33 52 4b 0a d0 89 b7 a1 67>,
     macKeyVal: <Buffer 9c 49 46 0d 32 72 cd 3b b4 64 09 e0 c5 d6 4e 7e fb 99 90 34 2e 21 f7 da 30 0c d2 34 f6 d3 36 f6>,
     absValidity: 2018-03-21T20:21:50.890Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 4a 5b 5f 95 4c 3b 34 47>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:21:53 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521577313507
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521577369174
connected to auth! from local port 52436
Handler: Error in secure comm - details: Disconnected from auth before getting session key response
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 9 0.7777777777777778 1521577429176
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 10 0.7 1521577489185
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 34856
received auth hello!
{ authId: 502, nonce: <Buffer 8e 09 5a 5a 12 d4 e0 07> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 11 0.6363636363636364 1521577549195
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 35078
received auth hello!
{ authId: 502, nonce: <Buffer a9 8a 33 f0 ca fb e5 09> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 12 0.5833333333333334 1521577609206
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 13 0.5384615384615384 1521577669214
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 60496
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 14 0.5 1521577729220
failure in connection with Auth : authFailureCount: 6
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 60736
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 15 0.4666666666666667 1521577789228
failure in connection with Auth : authFailureCount: 7
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 2
to: 3
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.3:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 16 0.4375 1521577849235
failure in connection with Auth : authFailureCount: 8
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 3
to: 4
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 52228
received auth hello!
{ authId: 503, nonce: <Buffer 7c 9e 66 2b 7f 39 b8 7a> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth503',
     commonName: '10.0.1.6' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth402',
     commonName: '10.0.0.2' },
  serial: '0162450C1623',
  notBefore: 2018-03-20T20:12:22.000Z,
  notAfter: 2018-03-21T20:14:02.000Z,
  subjectHash: '5542437f',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'FD:DE:86:1D:CD:10:FF:4C:1A:2A:4C:36:C9:64:AE:76:27:C2:90:7F',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'DE5B30AA46CAB50E9EB99610D7CD6F5A13A506E423E0B2FA7E5B5516308134D5EBA5029E1E86687304DE74F1EDC282AFF2BDBD5A1EEA4AB5A9C11B58BE559B6581427760281F7D05FB35B0241357C06845115CC2742374425A859E0CF161E9E28FB5DADEF2AD5312533F095CB0709A99F829AD0B3B1B19C8FB4E17DFB5D85CE6E65EA745001E8C0CC8AC5A752E195090E212D1563BE34185B3211F90F9135C8AD962B139057D6E600CF5797302C942DB7EEA5A0963E1105D1B46C227E6B60D0B1D7EF08EA4E9BE1220E5269AD51AB8E328F18D2AC5A2F47D0508AD6101DC087A6295158FC3BEDA4B4CD32EC8D3E6E2F67DC2962059753EE1281A41E463966327',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.6' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 503,
  host: '10.0.1.6',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJFDBYjMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDIxETAPBgNVBAMMCDEwLjAuMC4yMB4XDTE4MDMy\nMDIwMTIyMloXDTE4MDMyMTIwMTQwMlowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMzERMA8GA1UEAwwIMTAuMC4xLjYwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDeWzCqRsq1Dp65lhDXzW9aE6UG5CPgsvp+W1UWMIE01eulAp4e\nhmhzBN508e3Cgq/yvb1aHupKtanBG1i+VZtlgUJ3YCgffQX7NbAkE1fAaEURXMJ0\nI3RCWoWeDPFh6eKPtdre8q1TElM/CVywcJqZ+CmtCzsbGcj7Thfftdhc5uZep0UA\nHowMyKxadS4ZUJDiEtFWO+NBhbMhH5D5E1yK2WKxOQV9bmAM9XlzAslC237qWglj\n4RBdG0bCJ+a2DQsdfvCOpOm+EiDlJprVGrjjKPGNKsWi9H0FCK1hAdwIemKVFY/D\nvtpLTNMuyNPm4vZ9wpYgWXU+4SgaQeRjlmMnAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQYwDQYJKoZIhvcNAQELBQADggEBACPpMhVWWktxwKlsKB5iW5lBEreAjiml\n78+24Ra3Sph3TUfZ/ZN18FBiW+UcLlAGVGwgFkZhNP/z9utFBkmrYgzbv/UEkTDS\ngIBSUaYQ9MggXjpI27Xf8Ql2kXDsFcTVOr+XK47/vhqrjXU89JRBGaIG1IeiRxf5\nQeqd8HHSsmgHe+lW8Qi4JRq5+eJ8vh3eqfzqJFgDuyDZxmYi17M9i9yskfSq75wf\ndnt3b3393kLkudPe3utS4SFBrsGraiC0Ccb/Opq5MX0v2HJ9NSAH6mnswgslL1oB\nmKG8TFkVERdW3AxO4nz+EdndY/klAB4Ai2cvvdQhZeT1Ikd3gD4sah0=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 4
to: 5
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 17 0.4117647058823529 1521577909246
connected to auth! from local port 52478
received auth hello!
{ authId: 503, nonce: <Buffer a7 15 77 69 27 c3 60 a4> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 27 ab 3f eb e4 4f 15 bc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer b5 89 24 8a a2 3f ad b1 6b 8a fd 2d 06 2f 2c 97>,
  macKeyVal: <Buffer 31 0b cd 2b 93 e8 6b 28 a6 84 24 4a fd a3 e6 f3 66 ce cb 8a a1 c2 93 1e dd e3 c1 b8 c8 53 f2 2f>,
  absValidity: 2018-03-20T21:31:49.388Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300495,
  cipherKeyVal: <Buffer bd 8f d0 2d 3d c4 17 34 1f fa a1 77 1f 00 15 16>,
  macKeyVal: <Buffer 0f 91 3b 18 2a d2 85 93 1c b3 ae e7 e8 e7 99 b0 8d c0 e7 e7 4b 54 20 16 c3 47 76 bc ff 80 b2 22>,
  absValidity: 2018-03-21T20:31:49.388Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.16',
  serverPort: 22100,
  sessionKey: 
   { id: 50300495,
     cipherKeyVal: <Buffer bd 8f d0 2d 3d c4 17 34 1f fa a1 77 1f 00 15 16>,
     macKeyVal: <Buffer 0f 91 3b 18 2a d2 85 93 1c b3 ae e7 e8 e7 99 b0 8d c0 e7 e7 4b 54 20 16 c3 47 76 bc ff 80 b2 22>,
     absValidity: 2018-03-21T20:31:49.388Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 8d 54 92 1c f7 5b cc d1>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902
            eventHandlers.onError('Error occurred in migration request: Disconnected from auth before getting migration response: ' + error);
                                                                                                                                      ^

ReferenceError: error is not defined
    at Socket.<anonymous> (/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902:135)
    at emitNone (events.js:91:20)
    at Socket.emit (events.js:188:7)
    at endReadableNT (_stream_readable.js:975:12)
    at _combinedTickCallback (internal/process/next_tick.js:80:11)
    at process._tickCallback (internal/process/next_tick.js:104:9)
