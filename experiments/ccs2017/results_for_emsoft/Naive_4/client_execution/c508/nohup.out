changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c508.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c508',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 76 6a ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521576994818
connected to auth! from local port 34112
received auth hello!
{ authId: 501, nonce: <Buffer b4 15 37 31 51 12 ea d4> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer d4 e1 97 6d 7f 03 16 c1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 13 63 5f 58 23 07 37 6d 03 d4 aa 5b 1a 96 ab 66>,
  macKeyVal: <Buffer 99 29 12 95 ae ef 42 99 3c d8 47 a0 91 60 60 07 29 0e c9 3b a1 5e e3 38 8d 36 23 15 b6 7a 8e b0>,
  absValidity: 2018-03-20T21:16:34.992Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100503,
  cipherKeyVal: <Buffer 53 f3 a1 02 d6 9c 13 de 2e e2 0f e1 8e 40 a8 26>,
  macKeyVal: <Buffer 35 df 90 a4 7c 0f 29 de 14 b2 49 7a ec 0a 94 a8 9d 9e b4 59 4f 05 78 07 18 6b 3d 1c 1a 03 bb c7>,
  absValidity: 2018-03-21T20:16:34.992Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100503,
     cipherKeyVal: <Buffer 53 f3 a1 02 d6 9c 13 de 2e e2 0f e1 8e 40 a8 26>,
     macKeyVal: <Buffer 35 df 90 a4 7c 0f 29 de 14 b2 49 7a ec 0a 94 a8 9d 9e b4 59 4f 05 78 07 18 6b 3d 1c 1a 03 bb c7>,
     absValidity: 2018-03-21T20:16:34.992Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 06 2a 5a 64 e0 dd 84 85>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:16:35 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521576995946
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521577054874
connected to auth! from local port 34376
received auth hello!
{ authId: 501, nonce: <Buffer 4e 87 9f 47 ed 1b 96 0d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f5 80 40 f0 38 0a 75 cd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100511,
  cipherKeyVal: <Buffer 07 17 8d ad 4d 79 17 bc 9f 0c 29 24 0f 15 7e 12>,
  macKeyVal: <Buffer 1e ae 40 0a c9 17 89 a5 48 2f 99 3d 1a 6e 49 dd 71 0a 34 70 2f 6b 51 cd ed c1 a1 c8 b2 53 9d 65>,
  absValidity: 2018-03-21T20:17:35.104Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100511,
     cipherKeyVal: <Buffer 07 17 8d ad 4d 79 17 bc 9f 0c 29 24 0f 15 7e 12>,
     macKeyVal: <Buffer 1e ae 40 0a c9 17 89 a5 48 2f 99 3d 1a 6e 49 dd 71 0a 34 70 2f 6b 51 cd ed c1 a1 c8 b2 53 9d 65>,
     absValidity: 2018-03-21T20:17:35.104Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 0f 33 13 7e 45 d4 0c f3>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:17:35 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521577056211
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521577114934
connected to auth! from local port 34646
received auth hello!
{ authId: 501, nonce: <Buffer 2c 17 d4 f8 f8 24 b5 6a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 32 1c 7a b7 b3 9d 3c c2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100519,
  cipherKeyVal: <Buffer b3 03 c5 a9 47 c0 4a 85 f4 b6 95 8c 04 da ed 95>,
  macKeyVal: <Buffer e1 fe 1b ff b5 a1 55 94 5c b1 f2 eb 29 24 51 43 5c 7d f4 b5 85 6f f2 f3 95 b1 d6 0f ca dc 01 d9>,
  absValidity: 2018-03-21T20:18:35.164Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100519,
     cipherKeyVal: <Buffer b3 03 c5 a9 47 c0 4a 85 f4 b6 95 8c 04 da ed 95>,
     macKeyVal: <Buffer e1 fe 1b ff b5 a1 55 94 5c b1 f2 eb 29 24 51 43 5c 7d f4 b5 85 6f f2 f3 95 b1 d6 0f ca dc 01 d9>,
     absValidity: 2018-03-21T20:18:35.164Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer e3 38 23 f1 bf 60 10 44>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:18:35 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521577116445
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521577174989
connected to auth! from local port 34916
received auth hello!
{ authId: 501, nonce: <Buffer ce 96 68 b3 8d 2f 16 48> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c1 2c a7 94 de 99 8c f1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100527,
  cipherKeyVal: <Buffer ca 94 73 36 36 24 86 f5 3a 65 34 a5 57 84 64 84>,
  macKeyVal: <Buffer ad 2e 1a 03 d3 e4 3a 61 a8 6a e0 c7 44 35 f9 5c de 65 1d d2 12 b4 fd 61 6a c1 47 43 b9 d0 f5 75>,
  absValidity: 2018-03-21T20:19:35.254Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100527,
     cipherKeyVal: <Buffer ca 94 73 36 36 24 86 f5 3a 65 34 a5 57 84 64 84>,
     macKeyVal: <Buffer ad 2e 1a 03 d3 e4 3a 61 a8 6a e0 c7 44 35 f9 5c de 65 1d d2 12 b4 fd 61 6a c1 47 43 b9 d0 f5 75>,
     absValidity: 2018-03-21T20:19:35.254Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 84 92 b4 57 c8 88 25 d3>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:19:35 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521577176308
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521577235033
connected to auth! from local port 35186
received auth hello!
{ authId: 501, nonce: <Buffer 29 3c e3 28 db ed ae 82> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 19 69 63 a7 24 d6 aa 1b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100535,
  cipherKeyVal: <Buffer 12 7d 25 12 4b 4f 12 fa 13 97 c1 4e 7d c8 5d 60>,
  macKeyVal: <Buffer c1 b2 fe 10 c1 03 81 49 40 39 e8 ae c3 5a fb 8b 6f 73 5b 8e 87 6f 1f 4c d7 ba ce 60 bc 5b 55 07>,
  absValidity: 2018-03-21T20:20:35.302Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100535,
     cipherKeyVal: <Buffer 12 7d 25 12 4b 4f 12 fa 13 97 c1 4e 7d c8 5d 60>,
     macKeyVal: <Buffer c1 b2 fe 10 c1 03 81 49 40 39 e8 ae c3 5a fb 8b 6f 73 5b 8e 87 6f 1f 4c d7 ba ce 60 bc 5b 55 07>,
     absValidity: 2018-03-21T20:20:35.302Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 4d a9 5a 00 d1 9b 63 a0>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:20:36 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521577236425
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521577295089
connected to auth! from local port 35456
received auth hello!
{ authId: 501, nonce: <Buffer 9b 72 2c 63 96 79 79 c3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 44 2a 54 87 a9 ac e3 2e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100543,
  cipherKeyVal: <Buffer e2 45 9b f8 35 51 09 0f c2 ce 27 2f 1a c5 d0 3f>,
  macKeyVal: <Buffer fe 2e c0 67 1a 2f 94 b2 eb 81 e0 a6 4f 71 d2 d7 c7 83 08 08 4d 1b 2d 87 58 fd 3f 35 76 48 6b 88>,
  absValidity: 2018-03-21T20:21:35.293Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100543,
     cipherKeyVal: <Buffer e2 45 9b f8 35 51 09 0f c2 ce 27 2f 1a c5 d0 3f>,
     macKeyVal: <Buffer fe 2e c0 67 1a 2f 94 b2 eb 81 e0 a6 4f 71 d2 d7 c7 83 08 08 4d 1b 2d 87 58 fd 3f 35 76 48 6b 88>,
     absValidity: 2018-03-21T20:21:35.293Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 3f 13 fe 61 2c 86 74 c2>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:21:36 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521577296565
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521577355123
connected to auth! from local port 35726
received auth hello!
{ authId: 501, nonce: <Buffer 56 0d 48 62 d2 41 ab fd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6c 0f bb 0d 05 af 18 51>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100551,
  cipherKeyVal: <Buffer af 4e 5c 2b b3 f1 5e ea cd b1 2f cb f6 52 bc 41>,
  macKeyVal: <Buffer 53 bf b4 d0 cc 24 44 1e 59 87 db 83 cb 5a 0e 77 f0 8e 4f 0e 29 f0 c5 55 3d b7 dc 1b 84 ac fe 60>,
  absValidity: 2018-03-21T20:22:35.386Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100551,
     cipherKeyVal: <Buffer af 4e 5c 2b b3 f1 5e ea cd b1 2f cb f6 52 bc 41>,
     macKeyVal: <Buffer 53 bf b4 d0 cc 24 44 1e 59 87 db 83 cb 5a 0e 77 f0 8e 4f 0e 29 f0 c5 55 3d b7 dc 1b 84 ac fe 60>,
     absValidity: 2018-03-21T20:22:35.386Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 98 34 ad 1b 3a 30 92 9b>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:22:36 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521577356449
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521577415182
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 9 0.7777777777777778 1521577475189
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 37942
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 10 0.7 1521577535197
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 38166
received auth hello!
{ authId: 401, nonce: <Buffer 01 50 b0 03 3e 4d 36 95> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 11 0.6363636363636364 1521577595206
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 12 0.5833333333333334 1521577655214
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 41446
received auth hello!
{ authId: 502, nonce: <Buffer 27 1b 9f 6c cf 16 16 4a> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '0162450C19DA',
  notBefore: 2018-03-20T20:12:23.000Z,
  notAfter: 2018-03-21T20:14:03.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '16:73:A5:AB:6C:D0:49:35:45:A8:B1:C3:92:BD:80:6F:ED:A8:64:8A',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'E40B9EF20959AA49D02016EC2E9896074EE0818689EAD7319ECC8ED8C9557412ED46C95E67464598F6233ECEB8BF25A876F0D30B65CED2B1FED8D1F07CF9042FD7F86E3B637BE17FBFD7C9F0DB5850835170B354A52C175B769A37BA578F965436FF29BCFD54C5D4E939E02214503C8A69FFBBF0EC06657DF9498BE98DEB26B62E1453817F6DFAE9B50EE21C5A643FF0292539838A682562303CB77FC6028B22B30B78957E4F78E539103F991928681EBF3100D31960F43F8ECFC6C2F3063B353E92BFFEF77A49BBCBF417864AE8169AA061F590E5FB3393A4592EFA1100FC186B95B83724CA0B11D8BC02BC9BD4F9E08552DE2D1EB0EE0E866E41A520730E6F',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJFDBnaMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDMy\nMDIwMTIyM1oXDTE4MDMyMTIwMTQwM1owYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDkC57yCVmqSdAgFuwumJYHTuCBhonq1zGezI7YyVV0Eu1GyV5n\nRkWY9iM+zri/Jah28NMLZc7Ssf7Y0fB8+QQv1/huO2N74X+/18nw21hQg1Fws1Sl\nLBdbdpo3ulePllQ2/ym8/VTF1Ok54CIUUDyKaf+78OwGZX35SYvpjesmti4UU4F/\nbfrptQ7iHFpkP/ApJTmDimglYjA8t3/GAosiswt4lX5PeOU5ED+ZGShoHr8xANMZ\nYPQ/js/GwvMGOzU+kr/+93pJu8v0F4ZK6BaaoGH1kOX7M5OkWS76EQD8GGuVuDck\nygsR2LwCvJvU+eCFUt4tHrDuDoZuQaUgcw5vAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAH7QXjZr3ZWfkEcMAV5SQeM5Vb8jvTQ2\n9cIWOeloMIbjyXr8urt3LDOWrtnhBeY9fkBLGez/6MOBEG1Aguff+31mDI0XkvrC\nfb8bRwp6/LgKnr0OejctWMMMyqD4qWRZPfVNZOPl/bBjh6pESzRmwIHuUBpvWvcg\nNxPmLFvlpDWwPIOCMqzi3CYO70l+zjZQHClS99FSbZuA86wvNG8yWbbCNd0mNaCM\nZuOJZRlryLzjn6bRBiVfIYO5BE2mVw+AXEl4uqMS6BYpKF/IXsUU1Dnt650z7GXR\nb80JcN1iMzytwHHj7v+hahg4M2h6gbRRP/SAAHA+RF6itLNO0N+InFQ=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 2
to: 3
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 13 0.5384615384615384 1521577715224
connected to auth! from local port 41678
received auth hello!
{ authId: 502, nonce: <Buffer 80 a2 8e 10 a2 df d9 7f> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 7c ee 82 52 3a 00 88 7d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 85 0b 67 de 52 4e 0b 2d 24 d7 04 0d dc d7 4f d7>,
  macKeyVal: <Buffer 48 ce 0b 79 2c a8 62 6f ed ec 54 7e ec a4 a4 b9 c4 0d 85 14 d7 eb 05 29 97 19 18 09 93 c2 a5 63>,
  absValidity: 2018-03-20T21:28:35.353Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200807,
  cipherKeyVal: <Buffer 27 c0 35 15 8b fe 2c e1 be 85 42 0b b1 e0 1c 02>,
  macKeyVal: <Buffer 6c 1a 30 18 46 6c 91 34 c2 ab 64 f3 54 53 18 2f 00 cd 50 19 f1 46 f6 1e 1b 27 f4 0c 90 4d 95 f2>,
  absValidity: 2018-03-21T20:28:35.353Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200807,
     cipherKeyVal: <Buffer 27 c0 35 15 8b fe 2c e1 be 85 42 0b b1 e0 1c 02>,
     macKeyVal: <Buffer 6c 1a 30 18 46 6c 91 34 c2 ab 64 f3 54 53 18 2f 00 cd 50 19 f1 46 f6 1e 1b 27 f4 0c 90 4d 95 f2>,
     absValidity: 2018-03-21T20:28:35.353Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer c4 46 1f 93 36 9d e6 0b>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.28:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 14 0.5 1521577775235
connected to auth! from local port 41930
received auth hello!
{ authId: 502, nonce: <Buffer 59 9f d0 9f a2 3f b6 9c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d9 e9 24 7f 96 21 5c ad>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200822,
  cipherKeyVal: <Buffer 70 54 c9 2d 9d 3d b4 31 52 4f 8a c0 47 b1 a8 ae>,
  macKeyVal: <Buffer 4e f3 27 9f 86 3c e8 3e 68 0d ae e2 e6 fd 30 0d f1 c9 3d 82 53 4c d5 5d d0 83 a5 e0 b5 27 f5 7b>,
  absValidity: 2018-03-21T20:29:35.394Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200822,
     cipherKeyVal: <Buffer 70 54 c9 2d 9d 3d b4 31 52 4f 8a c0 47 b1 a8 ae>,
     macKeyVal: <Buffer 4e f3 27 9f 86 3c e8 3e 68 0d ae e2 e6 fd 30 0d f1 c9 3d 82 53 4c d5 5d d0 83 a5 e0 b5 27 f5 7b>,
     absValidity: 2018-03-21T20:29:35.394Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 5f 6a 93 8f dd d4 4d 4a>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.28:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 15 0.4666666666666667 1521577835236
connected to auth! from local port 42180
received auth hello!
{ authId: 502, nonce: <Buffer ac d6 dd 45 20 b8 21 34> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ad ad e1 5a b5 e9 ba 35>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200837,
  cipherKeyVal: <Buffer 0c 33 e2 37 2f cb 2a 27 41 a3 23 f1 db e0 37 97>,
  macKeyVal: <Buffer 77 7a ce 20 fa b9 43 08 b1 7f 6e b7 13 40 ff 68 c5 d1 fb ce fc bf 2e ae 30 5b bf 63 6e a8 86 49>,
  absValidity: 2018-03-21T20:30:35.361Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200837,
     cipherKeyVal: <Buffer 0c 33 e2 37 2f cb 2a 27 41 a3 23 f1 db e0 37 97>,
     macKeyVal: <Buffer 77 7a ce 20 fa b9 43 08 b1 7f 6e b7 13 40 ff 68 c5 d1 fb ce fc bf 2e ae 30 5b bf 63 6e a8 86 49>,
     absValidity: 2018-03-21T20:30:35.361Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 0b df fd c2 27 7c b3 6e>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.28:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 16 0.4375 1521577895245
connected to auth! from local port 42418
received auth hello!
{ authId: 502, nonce: <Buffer 2a a9 0f c8 56 b6 e3 b2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 66 b6 ec bb 96 57 4c 46>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200852,
  cipherKeyVal: <Buffer 2d 28 9c 9f f4 b3 3c 4a b4 26 bb 79 5a 61 63 a5>,
  macKeyVal: <Buffer 36 16 40 6e b5 ca b3 38 c6 9f 3a 05 64 d4 4f ca 9c 1d 8a 5b f7 2d 6e 3e 2e ac 4c 18 be 74 2d 32>,
  absValidity: 2018-03-21T20:31:35.408Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200852,
     cipherKeyVal: <Buffer 2d 28 9c 9f f4 b3 3c 4a b4 26 bb 79 5a 61 63 a5>,
     macKeyVal: <Buffer 36 16 40 6e b5 ca b3 38 c6 9f 3a 05 64 d4 4f ca 9c 1d 8a 5b f7 2d 6e 3e 2e ac 4c 18 be 74 2d 32>,
     absValidity: 2018-03-21T20:31:35.408Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer fd 89 7e b5 ff da 0c d2>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.28:undefined
/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902
            eventHandlers.onError('Error occurred in migration request: Disconnected from auth before getting migration response: ' + error);
                                                                                                                                      ^

ReferenceError: error is not defined
    at Socket.<anonymous> (/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902:135)
    at emitNone (events.js:91:20)
    at Socket.emit (events.js:188:7)
    at endReadableNT (_stream_readable.js:975:12)
    at _combinedTickCallback (internal/process/next_tick.js:80:11)
    at process._tickCallback (internal/process/next_tick.js:104:9)
