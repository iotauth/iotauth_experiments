changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c409.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c409',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 73 4d ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521576935934
connected to auth! from local port 38178
received auth hello!
{ authId: 402, nonce: <Buffer 20 52 2c b5 7c 91 08 b0> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 3a 9f 48 09 3e a6 ad 42>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer d4 a0 bf 36 2f 75 32 62 a1 7b 0e a2 89 19 28 f0>,
  macKeyVal: <Buffer 55 e3 aa d7 7b b8 4e 9b 37 c3 9d 3c f2 5f f0 93 db 1b 67 32 3a 0d 51 a7 86 e2 ef 97 22 25 cc 29>,
  absValidity: 2018-03-20T21:15:36.114Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200308,
  cipherKeyVal: <Buffer ae c9 11 af bd 87 e4 69 0b 88 c7 72 be 53 e5 fd>,
  macKeyVal: <Buffer 9d d3 85 5e 71 55 97 9a 13 77 8b ca ed 25 21 fc 5b 10 4c e0 3f f9 8b f0 f8 f6 28 99 05 64 2c b1>,
  absValidity: 2018-03-21T20:15:36.113Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40200308,
     cipherKeyVal: <Buffer ae c9 11 af bd 87 e4 69 0b 88 c7 72 be 53 e5 fd>,
     macKeyVal: <Buffer 9d d3 85 5e 71 55 97 9a 13 77 8b ca ed 25 21 fc 5b 10 4c e0 3f f9 8b f0 f8 f6 28 99 05 64 2c b1>,
     absValidity: 2018-03-21T20:15:36.113Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 28 03 e0 fb 7e c6 7c 6d>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:15:36 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521576937021
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521576995990
connected to auth! from local port 38340
received auth hello!
{ authId: 402, nonce: <Buffer b6 76 a5 b8 13 fb 2f 97> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cc de 14 5b 7b f5 e6 dc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200315,
  cipherKeyVal: <Buffer 50 c0 81 4b 0f 77 2f d0 68 8a 09 19 66 ca 9a d1>,
  macKeyVal: <Buffer 7d c7 67 47 62 1c 65 07 be bf f6 b9 12 7e 8e 18 46 86 5d aa c9 88 93 a1 7a cc 12 5c d9 6e 85 ec>,
  absValidity: 2018-03-21T20:16:36.119Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40200315,
     cipherKeyVal: <Buffer 50 c0 81 4b 0f 77 2f d0 68 8a 09 19 66 ca 9a d1>,
     macKeyVal: <Buffer 7d c7 67 47 62 1c 65 07 be bf f6 b9 12 7e 8e 18 46 86 5d aa c9 88 93 a1 7a cc 12 5c d9 6e 85 ec>,
     absValidity: 2018-03-21T20:16:36.119Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 73 2f 51 c9 64 58 11 0e>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:16:36 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521576997014
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521577055991
connected to auth! from local port 38606
received auth hello!
{ authId: 402, nonce: <Buffer 81 4c 41 86 59 3f 50 a0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 82 e6 58 5b ae ba 23 cf>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200322,
  cipherKeyVal: <Buffer ad 0e 9d 2c 78 3e 27 59 c5 ab 9f 1a ad 8d 66 ed>,
  macKeyVal: <Buffer ca 70 65 c3 13 b9 0f 06 6c ec 62 32 30 41 3a b5 30 be 0f e1 2a 37 3c f1 75 89 aa 0b b1 85 c7 a5>,
  absValidity: 2018-03-21T20:17:36.197Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40200322,
     cipherKeyVal: <Buffer ad 0e 9d 2c 78 3e 27 59 c5 ab 9f 1a ad 8d 66 ed>,
     macKeyVal: <Buffer ca 70 65 c3 13 b9 0f 06 6c ec 62 32 30 41 3a b5 30 be 0f e1 2a 37 3c f1 75 89 aa 0b b1 85 c7 a5>,
     absValidity: 2018-03-21T20:17:36.197Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 66 77 1f 49 70 ea a6 eb>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:17:36 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521577057181
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521577116049
connected to auth! from local port 38876
received auth hello!
{ authId: 402, nonce: <Buffer e6 23 01 fd 48 19 2e 7c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 19 74 e5 82 d2 ac 70 2d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200329,
  cipherKeyVal: <Buffer 99 9e 61 8c c5 46 8a 65 da 4d 25 4a 40 ce 47 de>,
  macKeyVal: <Buffer df 16 55 69 18 b7 ac ac 70 b2 cf 87 4a 5c 60 36 43 9e ab fe b0 a1 9f f5 0b 31 44 71 36 39 6c 54>,
  absValidity: 2018-03-21T20:18:36.245Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40200329,
     cipherKeyVal: <Buffer 99 9e 61 8c c5 46 8a 65 da 4d 25 4a 40 ce 47 de>,
     macKeyVal: <Buffer df 16 55 69 18 b7 ac ac 70 b2 cf 87 4a 5c 60 36 43 9e ab fe b0 a1 9f f5 0b 31 44 71 36 39 6c 54>,
     absValidity: 2018-03-21T20:18:36.245Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer e7 ab 95 6c 9a bf f4 ea>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:18:36 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521577117279
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521577176105
connected to auth! from local port 39146
received auth hello!
{ authId: 402, nonce: <Buffer 9e 07 af 09 b5 eb aa 27> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a9 0c 34 7c bd 75 a1 6d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200336,
  cipherKeyVal: <Buffer db 16 07 99 25 af c6 8b 12 61 51 8a 3d 25 7c a2>,
  macKeyVal: <Buffer c9 44 51 0b 0d 59 1a 81 83 bf 51 9e 04 df a2 fc 74 84 9a 39 4d 22 78 c0 ea af ce af cf b3 6c 67>,
  absValidity: 2018-03-21T20:19:36.272Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40200336,
     cipherKeyVal: <Buffer db 16 07 99 25 af c6 8b 12 61 51 8a 3d 25 7c a2>,
     macKeyVal: <Buffer c9 44 51 0b 0d 59 1a 81 83 bf 51 9e 04 df a2 fc 74 84 9a 39 4d 22 78 c0 ea af ce af cf b3 6c 67>,
     absValidity: 2018-03-21T20:19:36.272Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer d2 63 16 d9 38 b5 1c c9>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:19:36 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521577177180
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521577236161
connected to auth! from local port 39416
received auth hello!
{ authId: 402, nonce: <Buffer 2c fa 3e 7f 2d 06 0c b3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5f 81 90 ec c0 13 dc 41>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200343,
  cipherKeyVal: <Buffer 54 cd 4f bf b2 7d d2 b3 ff 30 d4 82 7c b7 94 31>,
  macKeyVal: <Buffer c0 11 4f e6 75 78 43 7f 27 25 c6 e3 b2 9a 37 ad 60 74 d8 9e 17 44 e2 96 a0 2b 2b 8b 56 e8 1e c5>,
  absValidity: 2018-03-21T20:20:36.350Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40200343,
     cipherKeyVal: <Buffer 54 cd 4f bf b2 7d d2 b3 ff 30 d4 82 7c b7 94 31>,
     macKeyVal: <Buffer c0 11 4f e6 75 78 43 7f 27 25 c6 e3 b2 9a 37 ad 60 74 d8 9e 17 44 e2 96 a0 2b 2b 8b 56 e8 1e c5>,
     absValidity: 2018-03-21T20:20:36.350Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 44 13 61 60 42 4a 22 49>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:20:36 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521577237223
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521577296221
connected to auth! from local port 39686
received auth hello!
{ authId: 402, nonce: <Buffer 72 91 aa 5a c4 ea 48 d4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0e 6c 87 21 db 48 3e 50>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200350,
  cipherKeyVal: <Buffer d8 f3 65 55 1d 33 0d b5 b8 7f e7 75 3d bc 45 c4>,
  macKeyVal: <Buffer d4 be 72 a2 7e ed ea e2 53 ea 2a d7 f8 d7 23 37 b7 44 a4 43 dc b2 88 12 ce a9 6c 67 bf 00 0d 11>,
  absValidity: 2018-03-21T20:21:36.433Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40200350,
     cipherKeyVal: <Buffer d8 f3 65 55 1d 33 0d b5 b8 7f e7 75 3d bc 45 c4>,
     macKeyVal: <Buffer d4 be 72 a2 7e ed ea e2 53 ea 2a d7 f8 d7 23 37 b7 44 a4 43 dc b2 88 12 ce a9 6c 67 bf 00 0d 11>,
     absValidity: 2018-03-21T20:21:36.433Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 00 ae 74 7a 6f 4f 47 91>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:21:37 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521577297365
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521577356280
connected to auth! from local port 39956
received auth hello!
{ authId: 402, nonce: <Buffer 5f 18 68 e6 94 1c 91 d6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 39 b4 a9 58 cd 09 06 c5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200357,
  cipherKeyVal: <Buffer bf 38 15 96 52 50 bb de 63 61 fe d6 fb a7 a8 6e>,
  macKeyVal: <Buffer 53 99 4a 14 bb 62 bd 95 41 f6 ea 7c 54 aa 84 21 d6 7a d6 eb 3c 78 5d 96 23 a2 ec 2d 6e 94 67 2c>,
  absValidity: 2018-03-21T20:22:36.467Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40200357,
     cipherKeyVal: <Buffer bf 38 15 96 52 50 bb de 63 61 fe d6 fb a7 a8 6e>,
     macKeyVal: <Buffer 53 99 4a 14 bb 62 bd 95 41 f6 ea 7c 54 aa 84 21 d6 7a d6 eb 3c 78 5d 96 23 a2 ec 2d 6e 94 67 2c>,
     absValidity: 2018-03-21T20:22:36.467Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 1b 18 64 c6 91 3c b6 da>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:22:37 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 8 1 1521577357388
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 9 0.8888888888888888 1521577416337
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 10 0.8 1521577476345
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 52528
received auth hello!
{ authId: 502, nonce: <Buffer 64 21 7a 19 30 86 a3 61> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 11 0.7272727272727273 1521577536355
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 52752
received auth hello!
{ authId: 502, nonce: <Buffer 08 15 ee da 09 4d ba 61> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 12 0.6666666666666666 1521577596365
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 13 0.6153846153846154 1521577656373
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 60622
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 14 0.5714285714285714 1521577716379
failure in connection with Auth : authFailureCount: 6
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 60874
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 15 0.5333333333333333 1521577776387
failure in connection with Auth : authFailureCount: 7
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 2
to: 3
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.3:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 16 0.5 1521577836387
failure in connection with Auth : authFailureCount: 8
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 3
to: 4
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 57262
received auth hello!
{ authId: 503, nonce: <Buffer 3f 3b 39 01 10 db f7 0c> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth503',
     commonName: '10.0.1.6' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth402',
     commonName: '10.0.0.2' },
  serial: '0162450C1623',
  notBefore: 2018-03-20T20:12:22.000Z,
  notAfter: 2018-03-21T20:14:02.000Z,
  subjectHash: '5542437f',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'FD:DE:86:1D:CD:10:FF:4C:1A:2A:4C:36:C9:64:AE:76:27:C2:90:7F',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'DE5B30AA46CAB50E9EB99610D7CD6F5A13A506E423E0B2FA7E5B5516308134D5EBA5029E1E86687304DE74F1EDC282AFF2BDBD5A1EEA4AB5A9C11B58BE559B6581427760281F7D05FB35B0241357C06845115CC2742374425A859E0CF161E9E28FB5DADEF2AD5312533F095CB0709A99F829AD0B3B1B19C8FB4E17DFB5D85CE6E65EA745001E8C0CC8AC5A752E195090E212D1563BE34185B3211F90F9135C8AD962B139057D6E600CF5797302C942DB7EEA5A0963E1105D1B46C227E6B60D0B1D7EF08EA4E9BE1220E5269AD51AB8E328F18D2AC5A2F47D0508AD6101DC087A6295158FC3BEDA4B4CD32EC8D3E6E2F67DC2962059753EE1281A41E463966327',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.6' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 503,
  host: '10.0.1.6',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJFDBYjMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDIxETAPBgNVBAMMCDEwLjAuMC4yMB4XDTE4MDMy\nMDIwMTIyMloXDTE4MDMyMTIwMTQwMlowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMzERMA8GA1UEAwwIMTAuMC4xLjYwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDeWzCqRsq1Dp65lhDXzW9aE6UG5CPgsvp+W1UWMIE01eulAp4e\nhmhzBN508e3Cgq/yvb1aHupKtanBG1i+VZtlgUJ3YCgffQX7NbAkE1fAaEURXMJ0\nI3RCWoWeDPFh6eKPtdre8q1TElM/CVywcJqZ+CmtCzsbGcj7Thfftdhc5uZep0UA\nHowMyKxadS4ZUJDiEtFWO+NBhbMhH5D5E1yK2WKxOQV9bmAM9XlzAslC237qWglj\n4RBdG0bCJ+a2DQsdfvCOpOm+EiDlJprVGrjjKPGNKsWi9H0FCK1hAdwIemKVFY/D\nvtpLTNMuyNPm4vZ9wpYgWXU+4SgaQeRjlmMnAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQYwDQYJKoZIhvcNAQELBQADggEBACPpMhVWWktxwKlsKB5iW5lBEreAjiml\n78+24Ra3Sph3TUfZ/ZN18FBiW+UcLlAGVGwgFkZhNP/z9utFBkmrYgzbv/UEkTDS\ngIBSUaYQ9MggXjpI27Xf8Ql2kXDsFcTVOr+XK47/vhqrjXU89JRBGaIG1IeiRxf5\nQeqd8HHSsmgHe+lW8Qi4JRq5+eJ8vh3eqfzqJFgDuyDZxmYi17M9i9yskfSq75wf\ndnt3b3393kLkudPe3utS4SFBrsGraiC0Ccb/Opq5MX0v2HJ9NSAH6mnswgslL1oB\nmKG8TFkVERdW3AxO4nz+EdndY/klAB4Ai2cvvdQhZeT1Ikd3gD4sah0=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 4
to: 5
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 17 0.47058823529411764 1521577896398
connected to auth! from local port 57486
received auth hello!
{ authId: 503, nonce: <Buffer 68 a3 27 84 ee 9d cb 4e> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 36 2f bd 6b e8 c3 b5 18>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer b2 e6 b1 2f f1 63 e2 16 7c ad 3f e6 d8 76 df d1>,
  macKeyVal: <Buffer 8b 00 e4 c6 bf 4c 0c 1f 14 75 78 fc d5 44 88 c6 e9 92 5d af 9e b4 2b 63 98 d2 1e 6f be ac 8c 4d>,
  absValidity: 2018-03-20T21:31:36.596Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300491,
  cipherKeyVal: <Buffer 69 b6 ca 11 cf 77 fa b3 51 fc 52 2c 99 08 c4 db>,
  macKeyVal: <Buffer 91 20 b7 3e 0b 8c 5e d6 7b 84 c7 8d 90 b0 0b 20 6a 68 56 28 86 56 83 0b 88 8e 04 9a 40 04 a1 1f>,
  absValidity: 2018-03-21T20:31:36.596Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 50300491,
     cipherKeyVal: <Buffer 69 b6 ca 11 cf 77 fa b3 51 fc 52 2c 99 08 c4 db>,
     macKeyVal: <Buffer 91 20 b7 3e 0b 8c 5e d6 7b 84 c7 8d 90 b0 0b 20 6a 68 56 28 86 56 83 0b 88 8e 04 9a 40 04 a1 1f>,
     absValidity: 2018-03-21T20:31:36.596Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 1e 11 08 bc d1 81 da f0>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.14:undefined
/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902
            eventHandlers.onError('Error occurred in migration request: Disconnected from auth before getting migration response: ' + error);
                                                                                                                                      ^

ReferenceError: error is not defined
    at Socket.<anonymous> (/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902:135)
    at emitNone (events.js:91:20)
    at Socket.emit (events.js:188:7)
    at endReadableNT (_stream_readable.js:975:12)
    at _combinedTickCallback (internal/process/next_tick.js:80:11)
    at process._tickCallback (internal/process/next_tick.js:104:9)
