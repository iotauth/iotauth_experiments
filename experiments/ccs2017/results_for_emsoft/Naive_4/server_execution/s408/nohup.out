changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s408.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's408',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 51 49 42 41 41 4b 43 41 51 45 41 76 61 ... > }
Handler: listening on port 22100
s408:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200309
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33944
received auth hello!
{ authId: 402, nonce: <Buffer fe 58 e7 8c 29 d8 0b a9> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 4c 59 3c e1 90 2c 09 92>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer ee c6 4d 60 9d 18 d9 71 0d b5 6d 0f 20 5e ad 49>,
  macKeyVal: <Buffer 38 a1 12 73 f9 a8 a6 5c 14 5a 70 71 66 41 6d 6a a6 4f 44 b0 de 26 09 2e 50 20 16 a0 8e e8 4e b4>,
  absValidity: 2018-03-20T21:15:40.564Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5d d0 3e bc b9 2a 8c bd>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 5d d0 3e bc b9 2a 8c bd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.52:56200',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200311
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33956
received auth hello!
{ authId: 402, nonce: <Buffer 30 2c 1b cc 8a e4 78 df> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 30 81 39 4d 02 df 28 f9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c7 47 a1 54 38 88 60 a2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c7 47 a1 54 38 88 60 a2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.54:59956',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200316
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34112
received auth hello!
{ authId: 402, nonce: <Buffer 39 8c 06 33 d2 86 14 1b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 81 9c c3 95 c1 8c a1 ba>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c5 c8 ca 2f f8 7b 67 84>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c5 c8 ca 2f f8 7b 67 84> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.52:56368',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200318
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34136
received auth hello!
{ authId: 402, nonce: <Buffer 9b 3a eb 17 35 e5 b2 4c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7e 1e 9a 04 79 cf 2b b6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8a 4c e6 d8 05 a8 fd e4>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 8a 4c e6 d8 05 a8 fd e4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.54:60136',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200323
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34382
received auth hello!
{ authId: 402, nonce: <Buffer bc cc 81 53 9b 0f 63 10> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 87 b5 83 0e 57 27 c2 d9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 96 1d 22 ab b3 9d 11 51>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 96 1d 22 ab b3 9d 11 51> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.52:56638',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200325
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34406
received auth hello!
{ authId: 402, nonce: <Buffer 69 d7 e8 86 13 cb 08 95> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 45 2c ed 05 5d 01 c9 3b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 21 81 e9 92 dd 4c 1e 1b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 21 81 e9 92 dd 4c 1e 1b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.54:60406',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200330
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34652
received auth hello!
{ authId: 402, nonce: <Buffer 02 7d 93 a3 f4 49 06 32> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d9 91 f5 15 06 c9 e4 98>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e1 31 ad 64 47 8c 44 13>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e1 31 ad 64 47 8c 44 13> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.52:56908',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200332
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34676
received auth hello!
{ authId: 402, nonce: <Buffer 03 11 2d 77 da a2 d0 25> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 51 52 8a 37 7c ab db b5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8d 66 ed 31 4a 0a f2 1a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8d 66 ed 31 4a 0a f2 1a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.54:60676',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200337
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34922
received auth hello!
{ authId: 402, nonce: <Buffer 59 db 9b ee 32 e1 25 96> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 95 d8 db c4 73 b3 6c b2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 54 0d b5 c8 f2 a1 5a 58>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 54 0d b5 c8 f2 a1 5a 58> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.52:57178',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200339
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34946
received auth hello!
{ authId: 402, nonce: <Buffer 3b f3 5c 2c c2 29 3f 99> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8b 8e 27 ec de c3 88 7c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f2 70 3d 91 8e 44 db 4b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f2 70 3d 91 8e 44 db 4b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.54:60946',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200344
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35192
received auth hello!
{ authId: 402, nonce: <Buffer 28 f3 8e 76 ad a8 46 12> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fe ac 6b fa 13 15 33 64>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 22 d8 5d 4e 61 6d 84 55>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 22 d8 5d 4e 61 6d 84 55> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.52:57448',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200346
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35216
received auth hello!
{ authId: 402, nonce: <Buffer 44 70 cc 20 ab 4c 01 a5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a5 eb c4 2e 1c 58 2a b7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 39 84 3c cf 23 d9 73 90>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 39 84 3c cf 23 d9 73 90> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.54:32984',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200351
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35462
received auth hello!
{ authId: 402, nonce: <Buffer 86 f7 3e b8 82 a6 a9 13> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9c 02 2b 70 29 ea f7 0f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 61 06 64 ee 91 c1 3e 5e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 61 06 64 ee 91 c1 3e 5e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.52:57718',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200353
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35486
received auth hello!
{ authId: 402, nonce: <Buffer 9d 98 fb 1a 54 fb d0 57> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e3 a9 2d b9 65 91 f7 0b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a4 48 b8 0e 4b 6c 9c 51>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer a4 48 b8 0e 4b 6c 9c 51> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.54:33254',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200358
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35728
received auth hello!
{ authId: 402, nonce: <Buffer ff d7 ab ac cb 6e 33 a5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ce 74 88 e6 91 ac 6f fa>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1b 45 16 e8 e1 e6 a8 c2>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 1b 45 16 e8 e1 e6 a8 c2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.52:57984',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200360
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35752
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300492
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300494
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 44562
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
received auth hello!
{ authId: 502, nonce: <Buffer 7b 69 50 cc 38 f5 3d 16> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in server - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
