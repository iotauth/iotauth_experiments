changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s416.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's416',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 30 6c ... > }
Handler: listening on port 22100
s416:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300508
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45532
received auth hello!
{ authId: 403, nonce: <Buffer 66 66 83 5d 2b 26 7e 22> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer de 49 d9 00 fb 2a 4e 92>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer cf 35 00 74 08 ed c3 d4 e8 8e 4c 87 f9 d2 5d e2>,
  macKeyVal: <Buffer aa 35 91 1e e4 31 34 61 e3 e3 7a b2 2b f8 73 c5 1b d2 87 90 60 98 cc 20 ac 25 04 79 8d b3 45 01>,
  absValidity: 2018-03-20T21:16:07.138Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 15 6e 31 3a b2 e4 4a bc>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 15 6e 31 3a b2 e4 4a bc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.60:49264',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300509
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45538
received auth hello!
{ authId: 403, nonce: <Buffer 8f 92 e1 cb e4 33 b7 b7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a4 1d 25 46 d0 a3 f8 29>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8a bd d0 74 2a d7 99 ad>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8a bd d0 74 2a d7 99 ad> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.61:43594',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300514
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45744
received auth hello!
{ authId: 403, nonce: <Buffer 90 e9 97 4d be a2 47 48> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c7 53 f6 34 a5 5a 9c 2a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 73 12 0f f8 74 b6 0a 09>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 73 12 0f f8 74 b6 0a 09> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.60:49476',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300515
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45760
received auth hello!
{ authId: 403, nonce: <Buffer 67 45 13 b4 2b 03 b4 f3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7a 58 14 cc 5b fe da 55>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 26 61 82 13 1f 1a 37 c6>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 26 61 82 13 1f 1a 37 c6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.61:43816',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300520
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46014
received auth hello!
{ authId: 403, nonce: <Buffer 85 b4 b5 93 04 ac 60 41> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer dc 11 95 b1 51 fb a9 86>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 64 13 1f 99 ed 37 6b c7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 64 13 1f 99 ed 37 6b c7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.60:49746',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300521
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46030
received auth hello!
{ authId: 403, nonce: <Buffer 56 81 b1 82 b6 7a e1 0a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 80 d7 d6 d3 d6 a0 c1 6c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f9 1e 4e a0 94 ea f7 44>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f9 1e 4e a0 94 ea f7 44> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.61:44086',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300526
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46284
received auth hello!
{ authId: 403, nonce: <Buffer 9a 7d 46 c4 02 6a bc 90> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 91 bb 99 f4 62 32 39 9b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 15 61 3d 35 49 12 b6 fc>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 15 61 3d 35 49 12 b6 fc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.60:50016',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300527
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46300
received auth hello!
{ authId: 403, nonce: <Buffer 35 d0 3a 05 5b ee 57 b2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cb 1c 4c a8 14 66 5f 42>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 17 5e 15 d3 f0 2d a0 69>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 17 5e 15 d3 f0 2d a0 69> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.61:44356',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300532
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46554
received auth hello!
{ authId: 403, nonce: <Buffer 80 77 d0 3f 63 cb 91 1c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bf ae 79 93 7d 3c 0c 0a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b9 1b e3 fc ae 30 fd 0a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b9 1b e3 fc ae 30 fd 0a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.60:50286',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300533
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46570
received auth hello!
{ authId: 403, nonce: <Buffer c7 e3 84 24 77 2e a9 ae> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 10 f7 09 54 8d 1a 71 9c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 67 fe d6 be 0c b3 62 40>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 67 fe d6 be 0c b3 62 40> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.61:44626',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300538
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46824
received auth hello!
{ authId: 403, nonce: <Buffer 78 ab 09 06 56 6c 01 de> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 51 d8 fb f5 24 eb 90 4c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 83 95 95 40 cf 3e cd 96>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 83 95 95 40 cf 3e cd 96> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.60:50556',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300539
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46840
received auth hello!
{ authId: 403, nonce: <Buffer 27 65 52 1d a9 e6 e9 d4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 00 0a 1b 7f 5b 2a d7 b9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5d ca a0 9b f3 7d 67 1a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5d ca a0 9b f3 7d 67 1a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.61:44896',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300544
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47094
received auth hello!
{ authId: 403, nonce: <Buffer 3b 33 35 ba e3 ab 56 d8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f9 24 80 d0 ba ea b3 f4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3c 5e 1e f5 30 bd 07 ea>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3c 5e 1e f5 30 bd 07 ea> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.60:50826',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300545
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47110
received auth hello!
{ authId: 403, nonce: <Buffer 47 85 bb ca 46 c7 6b 03> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6f de ac bb 28 dd 01 02>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b9 bf 6b 16 9e 6a e3 5f>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b9 bf 6b 16 9e 6a e3 5f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.61:45166',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300550
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47356
received auth hello!
{ authId: 403, nonce: <Buffer 62 5c 97 db 12 0b e1 04> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 68 82 6f df ee 26 15 49>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7f 85 24 7e e7 28 53 a3>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 7f 85 24 7e e7 28 53 a3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.60:51088',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300551
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47372
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
