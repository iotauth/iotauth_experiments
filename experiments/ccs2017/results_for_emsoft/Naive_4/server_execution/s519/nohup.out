changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s519.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's519',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 76 31 ... > }
Handler: listening on port 22100
s519:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400118
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54350
Unidentified client connected
received auth hello!
{ authId: 504, nonce: <Buffer ea 0b fb 49 d0 de a7 6d> }
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400119
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 12 de bf 4e 90 be 77 fa>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer a7 00 33 ec c6 f8 de 77 8f b2 81 8c 9d 6f 1e 24>,
  macKeyVal: <Buffer 2c fc e0 ee 7c 63 d9 a6 c0 7c 92 7f 61 5f 4e da 8f c1 a8 a8 85 f1 95 75 e4 9b 05 55 38 61 93 4d>,
  absValidity: 2018-03-20T21:17:38.751Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b4 d5 89 93 2c e0 ee 92>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b4 d5 89 93 2c e0 ee 92> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.86:34642',
  status: 'open' }
connected to auth! from local port 54368
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer 0e 6b dc 9e 85 f4 77 b6> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 8e 04 8e ea 05 d1 bb 0a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 06 ee 48 6b b0 ab e8 0f 8a ea f3 c2 18 a5 8f 73>,
  macKeyVal: <Buffer fc 99 79 73 f4 9e 1e fe ad 85 e1 9d 1a c9 34 e2 db 52 aa 9f 87 86 fc d4 0e d7 c8 dd cd 24 4b f4>,
  absValidity: 2018-03-20T21:17:40.716Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 01 6b 09 50 df 7d 3b f7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 01 6b 09 50 df 7d 3b f7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.87:35926',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400124
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54620
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400125
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54636
received auth hello!
{ authId: 504, nonce: <Buffer 8f ff 00 7a 3a a6 2b 2f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 51 99 e2 66 a2 00 6e 3f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cc a3 ee 53 fd 7c 87 8c>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer cc a3 ee 53 fd 7c 87 8c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.86:34912',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer 3e 81 3d c2 5a 3d 5f 1c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8b 6f b2 2d 92 1a d5 86>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1c 7d 29 c4 0d 18 a9 b6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1c 7d 29 c4 0d 18 a9 b6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.87:36194',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400130
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54890
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400131
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
received auth hello!
{ authId: 504, nonce: <Buffer 78 da f2 4e 8a 56 94 95> }
connected to auth! from local port 54908
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 71 01 86 bd a1 98 80 21>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9c 96 bf 42 b9 31 f4 bd>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9c 96 bf 42 b9 31 f4 bd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.86:35182',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer dd 4f ce af 6d c0 42 d7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c0 4f 87 55 79 2d 5b 07>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 47 1e 44 0c 27 93 c4 93>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 47 1e 44 0c 27 93 c4 93> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.87:36466',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400136
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55160
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400137
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
received auth hello!
{ authId: 504, nonce: <Buffer 36 8e 46 06 b9 a2 2f 4d> }
connected to auth! from local port 55178
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ad 7f fb c4 0b 18 13 25>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 91 78 13 15 9f a9 c7 67>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 91 78 13 15 9f a9 c7 67> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.86:35452',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer 70 76 fb e6 35 2e 8b b5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2c a5 14 40 06 f3 39 d9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 07 4c fe 21 ce e0 56 59>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 07 4c fe 21 ce e0 56 59> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.87:36736',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400142
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55430
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400143
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
received auth hello!
{ authId: 504, nonce: <Buffer 34 66 6f 95 84 ac 44 c3> }
connected to auth! from local port 55448
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer af 96 52 54 7c 65 ed 16>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b7 ad 9e 43 82 ea 6e 7a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b7 ad 9e 43 82 ea 6e 7a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.86:35722',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer 2d b9 fb dd aa 8d 75 4c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer dc 60 66 83 2f a2 ad ec>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2e 09 2e 2b f8 a3 35 b4>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 2e 09 2e 2b f8 a3 35 b4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.87:37006',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400148
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55700
received auth hello!
{ authId: 504, nonce: <Buffer eb b7 29 bd 0e 41 21 f6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 88 08 2a d1 7a e3 e9 a2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer df f2 4d d0 d0 d1 d4 30>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer df f2 4d d0 d0 d1 d4 30> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.86:35992',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
