changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s413.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's413',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 51 49 42 41 41 4b 43 41 51 45 41 76 38 ... > }
Handler: listening on port 22100
s413:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300506
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35848
received auth hello!
{ authId: 403, nonce: <Buffer e5 c4 75 70 78 3b 97 e2> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 27 35 e2 93 61 57 ff e0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer a7 15 69 6f df 74 5a 57 44 4c 71 08 a5 5c cb 0a>,
  macKeyVal: <Buffer 11 e2 b3 fc 1a 59 0e 8f b7 07 f7 e7 48 e5 2d ad f7 6a 11 44 16 8a 1f ba ff 51 11 08 d7 17 fd 09>,
  absValidity: 2018-03-20T21:15:59.278Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 58 11 0d 99 73 89 03 c2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 58 11 0d 99 73 89 03 c2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.58:42708',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300512
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36052
received auth hello!
{ authId: 403, nonce: <Buffer 10 cf 3b bd 12 ad d6 b1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 27 c2 17 87 64 23 54 25>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a7 3b d5 0d 6f aa a0 eb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a7 3b d5 0d 6f aa a0 eb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.58:42912',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300518
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36322
received auth hello!
{ authId: 403, nonce: <Buffer d4 44 ac 19 ed b4 3c 6b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b0 99 d1 30 88 8f 49 3e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 55 bd 4f b3 1b 7b c9 51>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 55 bd 4f b3 1b 7b c9 51> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.58:43182',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300524
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36592
received auth hello!
{ authId: 403, nonce: <Buffer 97 40 c1 da d9 35 11 3c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer dc 02 0b 7c 8c 11 de fe>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b7 38 b2 1a c3 4a 11 be>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b7 38 b2 1a c3 4a 11 be> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.58:43452',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300530
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36862
received auth hello!
{ authId: 403, nonce: <Buffer 60 b6 e4 8c bb 28 bc 08> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 44 4c 8f 6e 75 d0 1c 6c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7d da 28 90 cb 0a 18 d8>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 7d da 28 90 cb 0a 18 d8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.58:43722',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300536
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37132
received auth hello!
{ authId: 403, nonce: <Buffer 5e f3 35 48 80 53 f5 2d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bc 35 46 13 7d 84 9c d9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 61 bc 42 2a 53 99 ac 2d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 61 bc 42 2a 53 99 ac 2d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.58:43992',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300542
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37402
received auth hello!
{ authId: 403, nonce: <Buffer e5 38 27 85 d8 0c d9 93> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3f e8 6f f3 f1 b5 d1 25>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 64 e8 a3 d2 5b 44 77 00>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 64 e8 a3 d2 5b 44 77 00> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.58:44262',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300548
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37664
received auth hello!
{ authId: 403, nonce: <Buffer b7 47 e6 42 68 15 dd 7b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1a cc ab f9 30 5c b3 86>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 64 e2 6f 3c 80 a6 26 9b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 64 e2 6f 3c 80 a6 26 9b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.58:44524',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
