changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s414.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's414',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 6e 70 ... > }
Handler: listening on port 22100
s414:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300504
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53048
received auth hello!
{ authId: 403, nonce: <Buffer dc ae 7f 8c 53 ea e5 35> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer ea 00 ae fc 24 4e 4f a0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 48 61 e2 97 1f 06 8a f2 7e 5a 10 d7 40 f6 75 35>,
  macKeyVal: <Buffer 23 b8 bf 2f 9c 29 53 59 49 de 30 fb 70 39 81 97 e0 29 79 a7 33 96 4a 99 f5 48 13 22 ff d8 f7 5d>,
  absValidity: 2018-03-20T21:15:52.905Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fe 6b 80 55 ee c1 bf 57>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fe 6b 80 55 ee c1 bf 57> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.56:53854',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300510
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53240
received auth hello!
{ authId: 403, nonce: <Buffer b6 d7 18 af 75 47 c5 fe> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f8 db 42 10 a9 b7 8f de>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2e 77 c8 4e ba 3a 8b 4c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2e 77 c8 4e ba 3a 8b 4c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.56:54046',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300516
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53510
received auth hello!
{ authId: 403, nonce: <Buffer 25 79 7e c7 7f 9d 9c 96> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2e 5e 37 02 81 48 29 06>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 73 22 0c 6a eb ac 72 bd>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 73 22 0c 6a eb ac 72 bd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.56:54316',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300522
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53780
received auth hello!
{ authId: 403, nonce: <Buffer 76 72 e9 48 ce 26 f2 42> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d8 88 4d 3f e4 d9 de fa>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ce b8 b0 c9 2a b5 c1 b2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ce b8 b0 c9 2a b5 c1 b2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.56:54586',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300528
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54050
received auth hello!
{ authId: 403, nonce: <Buffer ce 31 75 15 ba 99 49 60> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d5 67 2d c5 57 3c 23 d8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 05 d5 cc 2a 7b aa 9a c6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 05 d5 cc 2a 7b aa 9a c6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.56:54856',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300534
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54320
received auth hello!
{ authId: 403, nonce: <Buffer 72 85 e3 6d 9f 39 13 f5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b3 a7 6e 03 ab 1d 4f e3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 57 d8 4c 25 f8 28 71 48>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 57 d8 4c 25 f8 28 71 48> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.56:55126',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300540
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54590
received auth hello!
{ authId: 403, nonce: <Buffer d1 b4 8f 6e 88 0e 13 77> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 17 c9 c9 ed 50 70 59 6a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f2 17 b0 ce 9a 1b 73 6c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f2 17 b0 ce 9a 1b 73 6c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.56:55396',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300546
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54852
received auth hello!
{ authId: 403, nonce: <Buffer 25 1a ce a8 b6 13 aa f2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 43 69 ca 28 e2 0a 1f 9f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 26 43 04 10 63 f9 82 5b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 26 43 04 10 63 f9 82 5b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.56:55658',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
