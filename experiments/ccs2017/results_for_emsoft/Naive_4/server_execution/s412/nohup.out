changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s412.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's412',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 67 49 42 41 41 4b 43 41 51 45 41 77 76 ... > }
Handler: listening on port 22100
s412:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300505
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49930
received auth hello!
{ authId: 403, nonce: <Buffer 02 72 b7 df 0f d6 6d 80> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer c4 60 05 53 ed 74 db 50>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 1a f0 06 4f 54 d3 8d 76 63 3d 00 68 21 48 c3 ac>,
  macKeyVal: <Buffer 8e c3 d3 8e c7 e0 cc ea e7 4a be 4a a1 ef 64 05 db ba 93 7b 55 30 e7 02 b0 09 59 45 ff 3e 32 1a>,
  absValidity: 2018-03-20T21:15:56.051Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4c 30 70 b8 11 75 05 0e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4c 30 70 b8 11 75 05 0e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.57:59000',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300511
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50128
received auth hello!
{ authId: 403, nonce: <Buffer a1 40 72 3c 21 a3 2e c6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 15 24 48 e8 4a 9d 2d bb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 82 60 f5 8b ed 64 c1 c5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 82 60 f5 8b ed 64 c1 c5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.57:59198',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300517
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50398
received auth hello!
{ authId: 403, nonce: <Buffer fc 2c 95 0f e2 c8 93 61> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6f e8 df 23 c9 eb 72 a6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4c 86 45 00 bb 6a fb 42>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4c 86 45 00 bb 6a fb 42> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.57:59468',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300523
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50668
received auth hello!
{ authId: 403, nonce: <Buffer 32 ac f2 9b 25 4f 2f 10> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5e b1 a4 aa fb bb c2 4f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7b c7 6b 9a f2 0c b8 64>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 7b c7 6b 9a f2 0c b8 64> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.57:59738',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300529
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50938
received auth hello!
{ authId: 403, nonce: <Buffer b5 45 83 fd eb 6e 42 8c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 86 3e 8f fa fe c8 65 94>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e8 52 c1 99 9a 30 53 15>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e8 52 c1 99 9a 30 53 15> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.57:60008',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300535
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51208
received auth hello!
{ authId: 403, nonce: <Buffer 38 96 39 88 99 84 33 a2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b5 d0 5a 70 66 1f 62 f9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a8 7c 6e ed 0d c1 fd 53>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a8 7c 6e ed 0d c1 fd 53> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.57:60278',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300541
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51478
received auth hello!
{ authId: 403, nonce: <Buffer f0 23 63 b4 13 50 85 2f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1d 0b 51 60 66 77 6e f2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fd 51 bc 32 ac 20 2d 06>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fd 51 bc 32 ac 20 2d 06> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.57:60548',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300547
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51740
received auth hello!
{ authId: 403, nonce: <Buffer e4 5b 88 d5 b6 42 20 a4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 10 fe 1c 10 c0 bb 42 d6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f3 09 b7 7a c1 de 8d 3c>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f3 09 b7 7a c1 de 8d 3c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.57:60810',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
