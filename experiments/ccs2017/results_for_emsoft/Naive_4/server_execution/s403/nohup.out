changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s403.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's403',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 33 74 ... > }
Handler: listening on port 22100
s403:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100784
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48738
received auth hello!
{ authId: 401, nonce: <Buffer 06 c5 a8 64 9b 6f 9b e2> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 51 ee eb 7d b0 86 4b e7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 51 76 4a 06 c4 09 05 15 6c c8 9d 55 e3 2e 0e db>,
  macKeyVal: <Buffer 50 07 f8 00 2a ae 15 3b f4 73 25 bc 87 43 1c da ca 18 46 0d 69 cf 66 27 78 8c ed 9f c3 8a 8e 3b>,
  absValidity: 2018-03-20T21:15:23.744Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ad 81 71 12 71 6f 4d 97>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ad 81 71 12 71 6f 4d 97> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.47:36202',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100790
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48876
received auth hello!
{ authId: 401, nonce: <Buffer cf bf 85 f7 f9 2e b1 eb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5e 80 0c 07 f6 52 0d 5a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c1 61 64 89 a9 6f 2a c6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c1 61 64 89 a9 6f 2a c6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.47:36340',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100796
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49122
received auth hello!
{ authId: 401, nonce: <Buffer 71 6b f7 78 17 87 7b 37> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4c fa 37 da 6b 85 82 83>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0c 5a 8d 34 a2 d4 96 45>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 0c 5a 8d 34 a2 d4 96 45> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.47:36586',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100802
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49392
received auth hello!
{ authId: 401, nonce: <Buffer 7f 2f 19 47 15 d8 d3 79> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 11 51 6c d9 5c 63 c2 52>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 72 46 46 2b 0c df 35 df>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 72 46 46 2b 0c df 35 df> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.47:36856',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100808
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49662
received auth hello!
{ authId: 401, nonce: <Buffer 76 37 5a 66 37 86 80 04> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 66 93 cb a6 ba 93 23 4e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ae 66 c4 c6 93 f6 72 32>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ae 66 c4 c6 93 f6 72 32> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.47:37126',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100814
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49932
received auth hello!
{ authId: 401, nonce: <Buffer 42 5f 75 6c 5e 08 2c 7c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d4 3b 4d f6 cc 65 65 84>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5a b1 5e 48 ec 68 81 0d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5a b1 5e 48 ec 68 81 0d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.47:37396',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100820
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50202
received auth hello!
{ authId: 401, nonce: <Buffer 36 ef e3 e3 50 69 98 83> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2e 88 03 14 95 fe 4b 39>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c9 9f da 0a aa de de 4c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c9 9f da 0a aa de de 4c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.47:37666',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100826
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50472
received auth hello!
{ authId: 401, nonce: <Buffer 9d 15 6b 4e f7 09 61 85> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 42 9c 84 42 81 71 28 f1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fc ef f1 bf e1 ee f2 08>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fc ef f1 bf e1 ee f2 08> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.47:37936',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100832
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50718
received auth hello!
{ authId: 401, nonce: <Buffer 91 04 c6 07 1e 5f 06 db> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f0 d7 e7 ef 6c ba 5b 8e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 43 ee 95 c3 b2 74 da f4>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 43 ee 95 c3 b2 74 da f4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.47:38182',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100838
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50906
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 401, nonce: <Buffer d8 f5 76 cd 3a ce a4 c0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1d 36 ed 25 72 29 d1 72>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ff e4 18 74 3c 75 30 61>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ff e4 18 74 3c 75 30 61> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.47:38370',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100847
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51154
received auth hello!
{ authId: 401, nonce: <Buffer 12 a1 c4 8d 68 65 d3 aa> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 11 b9 7b 52 d5 d8 ec 2a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer db 1f 4f ff 11 a0 46 46>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer db 1f 4f ff 11 a0 46 46> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.47:38618',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100853
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51338
received auth hello!
{ authId: 401, nonce: <Buffer d8 49 01 36 51 2b 5b 7c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 80 be 22 14 0e 76 aa a9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 88 c8 6b 7c 8f 8b 2f 03>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 88 c8 6b 7c 8f 8b 2f 03> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.47:38802',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100863
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51618
Handler: Error in server - details: handshake2 timed out...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100869
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51796
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100897
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52536
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 401, nonce: <Buffer 1f 5a 5e b6 1e 22 2f dc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 91 cf 0c 83 23 89 1e b5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 88 fa 2a 1e cb f0 46 4b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 88 fa 2a 1e cb f0 46 4b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.47:40000',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100908
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52792
received auth hello!
{ authId: 401, nonce: <Buffer 97 d9 b7 46 a4 a2 bb 02> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cc e7 86 28 df d3 20 a0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cb c1 64 65 5b 55 3f b4>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer cb c1 64 65 5b 55 3f b4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.47:40256',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: Disconnected from auth before getting session key response
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100923
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52992
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100934
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53156
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100945
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53322
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100956
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53494
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100966
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53650
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100976
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53814
received auth hello!
{ authId: 401, nonce: <Buffer 0d ca d8 29 dd 70 53 f4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2d ac 60 0d a0 66 3e 26>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 20 5b 41 1a 26 a6 67 a3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 20 5b 41 1a 26 a6 67 a3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.47:41276',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100987
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53980
received auth hello!
{ authId: 401, nonce: <Buffer ff 64 5f 1d 60 bf 7a 02> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f6 a8 6e 00 fa 78 a0 27>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8a ff e8 2b de 37 b8 b2>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 8a ff e8 2b de 37 b8 b2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.47:41442',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100998
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54144
received auth hello!
{ authId: 401, nonce: <Buffer e5 aa bd 1c c5 0f 3b 57> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f1 1b c4 fc 57 18 01 ae>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 05 07 97 4c 34 3d f7 a1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 05 07 97 4c 34 3d f7 a1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.47:41606',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101011
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54324
received auth hello!
{ authId: 401, nonce: <Buffer 04 22 41 60 33 aa ad 51> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 78 09 2d b2 d9 d6 7b 14>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b0 f7 79 70 f7 82 f4 9d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b0 f7 79 70 f7 82 f4 9d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.47:41788',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101021
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54484
received auth hello!
{ authId: 401, nonce: <Buffer d4 8d fa 3b b6 e4 37 36> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 85 64 16 f2 1a f5 6e e6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b6 5b 59 5a 30 57 1b 1c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b6 5b 59 5a 30 57 1b 1c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.47:41948',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: Disconnected from auth before getting session key response
