changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s506.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's506',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 36 62 ... > }
Handler: listening on port 22100
s506:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100504
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60662
received auth hello!
{ authId: 501, nonce: <Buffer 1f 06 fd eb 2d c1 d6 22> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer dc 3e 16 1a 53 3b 4f 1d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 2a 05 48 57 ba 1b c6 ab b8 40 26 d6 c0 16 e1 c3>,
  macKeyVal: <Buffer 07 ce ea b1 9e ea 7e b7 0e 99 8f 05 b2 12 f5 60 0b f0 df da 1b cc 93 de 71 99 cd d4 d9 52 3d 0f>,
  absValidity: 2018-03-20T21:16:39.315Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a7 31 7a 27 0b c8 24 dd>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a7 31 7a 27 0b c8 24 dd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.70:42560',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100512
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60932
received auth hello!
{ authId: 501, nonce: <Buffer b4 70 ae cc c1 99 84 01> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d3 31 0b 7f 05 95 6c 4a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 97 5c 86 91 6e f9 86 73>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 97 5c 86 91 6e f9 86 73> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.70:42828',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100520
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 32970
received auth hello!
{ authId: 501, nonce: <Buffer cc 30 42 9b 65 9f 1a f2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b4 90 f2 0b 00 c6 31 ae>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1b 84 cb e1 d4 19 0d 03>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 1b 84 cb e1 d4 19 0d 03> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.70:43100',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100528
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33240
received auth hello!
{ authId: 501, nonce: <Buffer c3 b8 ef 9c d3 c2 7e ed> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f6 91 ce 69 9b 37 b3 08>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0c c6 4a 28 3e a2 df 72>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0c c6 4a 28 3e a2 df 72> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.70:43368',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100536
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33510
received auth hello!
{ authId: 501, nonce: <Buffer 0f 8e 6f 3c 02 fc 60 75> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 22 1c 7d 53 ec 34 68 31>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a1 59 92 6d d4 0b fe b9>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer a1 59 92 6d d4 0b fe b9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.70:43638',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100544
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33780
received auth hello!
{ authId: 501, nonce: <Buffer 8c 31 c6 13 c5 b3 6a 1d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 82 19 47 bd d2 4a b6 57>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5e 6c 8c cf fe 32 a8 9c>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 5e 6c 8c cf fe 32 a8 9c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.70:43908',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100552
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34046
received auth hello!
{ authId: 501, nonce: <Buffer 1c d5 69 f6 e7 c0 3b 98> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 10 2a ca 34 75 60 a1 e8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 27 48 d7 90 98 cb 78 a9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 27 48 d7 90 98 cb 78 a9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.70:44176',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200784
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200793
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in server - details: handshake2 timed out...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in server - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in server - details: Error occurred in migration request: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200808
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 50208
received auth hello!
{ authId: 502, nonce: <Buffer 71 09 30 24 2e 62 a8 68> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '0162450C19DA',
  notBefore: 2018-03-20T20:12:23.000Z,
  notAfter: 2018-03-21T20:14:03.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '16:73:A5:AB:6C:D0:49:35:45:A8:B1:C3:92:BD:80:6F:ED:A8:64:8A',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'E40B9EF20959AA49D02016EC2E9896074EE0818689EAD7319ECC8ED8C9557412ED46C95E67464598F6233ECEB8BF25A876F0D30B65CED2B1FED8D1F07CF9042FD7F86E3B637BE17FBFD7C9F0DB5850835170B354A52C175B769A37BA578F965436FF29BCFD54C5D4E939E02214503C8A69FFBBF0EC06657DF9498BE98DEB26B62E1453817F6DFAE9B50EE21C5A643FF0292539838A682562303CB77FC6028B22B30B78957E4F78E539103F991928681EBF3100D31960F43F8ECFC6C2F3063B353E92BFFEF77A49BBCBF417864AE8169AA061F590E5FB3393A4592EFA1100FC186B95B83724CA0B11D8BC02BC9BD4F9E08552DE2D1EB0EE0E866E41A520730E6F',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJFDBnaMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDMy\nMDIwMTIyM1oXDTE4MDMyMTIwMTQwM1owYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDkC57yCVmqSdAgFuwumJYHTuCBhonq1zGezI7YyVV0Eu1GyV5n\nRkWY9iM+zri/Jah28NMLZc7Ssf7Y0fB8+QQv1/huO2N74X+/18nw21hQg1Fws1Sl\nLBdbdpo3ulePllQ2/ym8/VTF1Ok54CIUUDyKaf+78OwGZX35SYvpjesmti4UU4F/\nbfrptQ7iHFpkP/ApJTmDimglYjA8t3/GAosiswt4lX5PeOU5ED+ZGShoHr8xANMZ\nYPQ/js/GwvMGOzU+kr/+93pJu8v0F4ZK6BaaoGH1kOX7M5OkWS76EQD8GGuVuDck\nygsR2LwCvJvU+eCFUt4tHrDuDoZuQaUgcw5vAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAH7QXjZr3ZWfkEcMAV5SQeM5Vb8jvTQ2\n9cIWOeloMIbjyXr8urt3LDOWrtnhBeY9fkBLGez/6MOBEG1Aguff+31mDI0XkvrC\nfb8bRwp6/LgKnr0OejctWMMMyqD4qWRZPfVNZOPl/bBjh6pESzRmwIHuUBpvWvcg\nNxPmLFvlpDWwPIOCMqzi3CYO70l+zjZQHClS99FSbZuA86wvNG8yWbbCNd0mNaCM\nZuOJZRlryLzjn6bRBiVfIYO5BE2mVw+AXEl4uqMS6BYpKF/IXsUU1Dnt650z7GXR\nb80JcN1iMzytwHHj7v+hahg4M2h6gbRRP/SAAHA+RF6itLNO0N+InFQ=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 1
to: 2
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200823
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50446
received auth hello!
{ authId: 502, nonce: <Buffer 27 a0 cf 1c 39 e8 bb 36> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 54 dc e7 16 3b 2c ca 8b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 81 77 2f 29 94 89 f1 f1 8e 87 1c 01 c6 ef 66 fc>,
  macKeyVal: <Buffer 32 af 0e 6f 38 f7 21 d9 09 bf cf ce 28 f7 44 85 06 c1 d7 56 a6 98 f7 49 50 47 e1 df ec ce 16 c6>,
  absValidity: 2018-03-20T21:29:39.334Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 78 56 74 43 91 99 4f 8e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 78 56 74 43 91 99 4f 8e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.70:45730',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200838
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50700
received auth hello!
{ authId: 502, nonce: <Buffer 47 00 9e 85 08 e8 d7 8d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 56 82 d4 ec 5e 25 6a 62>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0b ad 5d 0d 12 77 74 78>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0b ad 5d 0d 12 77 74 78> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.70:45984',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200853
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50942
received auth hello!
{ authId: 502, nonce: <Buffer dd b4 80 ce 48 56 8a 37> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ef bd 4e 8f 47 04 e3 91>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fa 3e d9 a7 96 fe a5 a7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fa 3e d9 a7 96 fe a5 a7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.70:46224',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200866
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51176
received auth hello!
{ authId: 502, nonce: <Buffer 2a 88 bb 71 40 2b 91 47> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e7 6e f2 fb 9e f5 39 88>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cc ab 69 6c 8d 1b 68 b1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer cc ab 69 6c 8d 1b 68 b1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.70:46460',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200878
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51344
received auth hello!
{ authId: 502, nonce: <Buffer 2b e3 ec dd 39 c8 b2 bb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f7 d9 27 5d 90 4b 71 06>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 88 69 14 35 ac 5d 2b 19>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 88 69 14 35 ac 5d 2b 19> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.70:46628',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200890
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51510
received auth hello!
{ authId: 502, nonce: <Buffer 73 5a ac 40 7f d7 30 b9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cc 9a 92 d5 7a 5f 45 40>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer da 7c a1 ff 93 00 c7 42>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer da 7c a1 ff 93 00 c7 42> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.70:46794',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200902
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51676
received auth hello!
{ authId: 502, nonce: <Buffer 58 c0 9c 7f e6 2b f1 ab> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer eb 1e 63 73 9a ef 40 c2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer dc dd 5f 43 0f 0b 6f ae>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer dc dd 5f 43 0f 0b 6f ae> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.70:46960',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200914
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51842
received auth hello!
{ authId: 502, nonce: <Buffer 5d bd 3c 9a a6 4e cb dc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f5 f1 12 85 e1 f3 ef 27>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cc 93 81 f2 a1 df dd ef>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer cc 93 81 f2 a1 df dd ef> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.70:47124',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200926
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52006
received auth hello!
{ authId: 502, nonce: <Buffer 4d bc 1a ed 94 ed 87 33> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 15 08 bd 97 5f 6e 17 eb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9f b6 43 36 13 af 70 4a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9f b6 43 36 13 af 70 4a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.70:47290',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200938
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52162
received auth hello!
{ authId: 502, nonce: <Buffer 38 1e 16 fe e0 15 b4 aa> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d7 c8 46 db 4f af a3 03>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2d 63 f6 7d 30 a6 5e a1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2d 63 f6 7d 30 a6 5e a1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.70:47444',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200950
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52328
received auth hello!
{ authId: 502, nonce: <Buffer 62 9e 31 cc 3f 9b 17 a7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer de b3 52 9d f2 ca d6 7a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 52 9c 4b 18 2f 54 a2 e6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 52 9c 4b 18 2f 54 a2 e6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.70:47610',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200962
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52494
received auth hello!
{ authId: 502, nonce: <Buffer 92 2d 17 57 35 e8 6f 6e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d5 7a 08 29 ae 1f 5e 5c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 72 71 5d d1 30 6e 0d 6b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 72 71 5d d1 30 6e 0d 6b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.70:47778',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200974
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52666
received auth hello!
{ authId: 502, nonce: <Buffer 0e 57 77 26 2a 69 f0 37> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4e 91 2e 72 57 95 7d 32>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cc e5 4d 70 c0 74 ac dd>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer cc e5 4d 70 c0 74 ac dd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.70:47950',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200986
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52826
received auth hello!
{ authId: 502, nonce: <Buffer bd 89 77 23 1c 70 87 09> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5d c8 77 45 20 64 de dc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 02 df 9b da 5a b0 ee b5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 02 df 9b da 5a b0 ee b5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.70:48110',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200998
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52980
received auth hello!
{ authId: 502, nonce: <Buffer fc 2b 6d 8e 05 8f 91 d1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3b 19 85 ae bf 5b 9d 18>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8b 60 27 dc c5 f2 27 27>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8b 60 27 dc c5 f2 27 27> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.70:48264',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
