changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c526.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c526',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 34 6c ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521565683592
connected to auth! from local port 40724
received auth hello!
{ authId: 504, nonce: <Buffer 8d 52 a9 6d 95 cb 37 76> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer be c3 d6 dc dc 92 b4 89>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 09 70 94 7f 85 76 79 96 54 86 bc f1 d7 46 62 c3>,
  macKeyVal: <Buffer f3 48 d3 be aa b6 71 4f d7 d7 08 df 59 d5 52 8b 9b 7f a0 54 8a de 35 bf 6f 45 86 60 2a 01 83 48>,
  absValidity: 2018-03-20T18:08:07.344Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400007,
  cipherKeyVal: <Buffer f1 7c b1 ba 05 c5 81 6d a9 70 ef 5d 97 20 06 e2>,
  macKeyVal: <Buffer 88 e8 b2 66 a4 2a 52 7a 16 f1 d5 08 4a b0 ea 4a 45 f3 c7 4e 2e 9c 72 29 7b c7 47 18 71 1b 9c 5b>,
  absValidity: 2018-03-21T17:08:07.343Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50400007,
     cipherKeyVal: <Buffer f1 7c b1 ba 05 c5 81 6d a9 70 ef 5d 97 20 06 e2>,
     macKeyVal: <Buffer 88 e8 b2 66 a4 2a 52 7a 16 f1 d5 08 4a b0 ea 4a 45 f3 c7 4e 2e 9c 72 29 7b c7 47 18 71 1b 9c 5b>,
     absValidity: 2018-03-21T17:08:07.343Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer df 16 e5 3b fe 32 ea 09>
switching to HANDSHAKE_1_SENT
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 17:08:10 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521565690450
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521565743642
connected to auth! from local port 40992
received auth hello!
{ authId: 504, nonce: <Buffer 93 3d 5c 2b 3a 34 a4 33> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5f 54 8a 8e 66 d3 e1 63>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400013,
  cipherKeyVal: <Buffer 7b 83 46 72 0a 6d f7 68 96 7e e1 b5 06 0c 90 ea>,
  macKeyVal: <Buffer e5 70 92 1c 01 5b f6 6e dd b9 18 10 28 ea 35 d4 26 f2 60 93 4c 2b 26 2e 08 34 b7 b7 91 2c 88 06>,
  absValidity: 2018-03-21T17:09:07.297Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50400013,
     cipherKeyVal: <Buffer 7b 83 46 72 0a 6d f7 68 96 7e e1 b5 06 0c 90 ea>,
     macKeyVal: <Buffer e5 70 92 1c 01 5b f6 6e dd b9 18 10 28 ea 35 d4 26 f2 60 93 4c 2b 26 2e 08 34 b7 b7 91 2c 88 06>,
     absValidity: 2018-03-21T17:09:07.297Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 7e fc 00 2d 13 52 11 fe>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 17:09:09 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521565750281
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521565803694
connected to auth! from local port 41262
received auth hello!
{ authId: 504, nonce: <Buffer bc 51 eb 7e d1 0c 19 e8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 93 1b f4 09 b0 ce 57 4f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400019,
  cipherKeyVal: <Buffer e7 dc b0 7e a6 ad 5d b5 d5 e2 5b cb 67 19 22 2e>,
  macKeyVal: <Buffer a9 47 07 92 b1 6e 3e bf 68 75 28 15 d7 8f 31 47 21 e6 51 97 30 15 a9 7d 6d 20 49 44 ce 0c b4 aa>,
  absValidity: 2018-03-21T17:10:07.108Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50400019,
     cipherKeyVal: <Buffer e7 dc b0 7e a6 ad 5d b5 d5 e2 5b cb 67 19 22 2e>,
     macKeyVal: <Buffer a9 47 07 92 b1 6e 3e bf 68 75 28 15 d7 8f 31 47 21 e6 51 97 30 15 a9 7d 6d 20 49 44 ce 0c b4 aa>,
     absValidity: 2018-03-21T17:10:07.108Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer a1 a8 9b 70 ef 20 24 8a>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 17:10:09 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521565810437
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521565863728
connected to auth! from local port 41532
received auth hello!
{ authId: 504, nonce: <Buffer 4c 5c 96 9b 56 fc 28 c5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ab 70 54 f0 4b 59 21 95>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400025,
  cipherKeyVal: <Buffer c4 5b 53 cd 9d 66 43 0d e1 cf 73 83 6b 80 51 c1>,
  macKeyVal: <Buffer 90 0c e1 49 d6 14 45 34 dc b9 a8 b1 cf ed 42 69 0d 95 c4 63 79 5d f5 de 9e af 14 10 0a be 9a ac>,
  absValidity: 2018-03-21T17:11:07.112Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50400025,
     cipherKeyVal: <Buffer c4 5b 53 cd 9d 66 43 0d e1 cf 73 83 6b 80 51 c1>,
     macKeyVal: <Buffer 90 0c e1 49 d6 14 45 34 dc b9 a8 b1 cf ed 42 69 0d 95 c4 63 79 5d f5 de 9e af 14 10 0a be 9a ac>,
     absValidity: 2018-03-21T17:11:07.112Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 1f aa c3 34 4b 7e cb 17>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 17:11:10 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521565870481
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521565923782
connected to auth! from local port 41802
received auth hello!
{ authId: 504, nonce: <Buffer 04 f9 5a e6 c4 85 2e 14> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6f 51 12 fe 18 f2 ed 6a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400031,
  cipherKeyVal: <Buffer f2 35 f7 08 1c 78 c4 95 94 8c ea ee f3 44 05 fc>,
  macKeyVal: <Buffer d9 61 76 48 ae 3a 6b f7 16 57 92 96 0c 27 4f a3 f3 52 24 ce ba 62 7e 32 41 34 e8 52 7b a0 9c aa>,
  absValidity: 2018-03-21T17:12:07.196Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50400031,
     cipherKeyVal: <Buffer f2 35 f7 08 1c 78 c4 95 94 8c ea ee f3 44 05 fc>,
     macKeyVal: <Buffer d9 61 76 48 ae 3a 6b f7 16 57 92 96 0c 27 4f a3 f3 52 24 ce ba 62 7e 32 41 34 e8 52 7b a0 9c aa>,
     absValidity: 2018-03-21T17:12:07.196Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer ff d5 2e f8 94 5e e0 1a>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 17:12:10 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521565930457
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521565983833
connected to auth! from local port 42072
Handler: Error in secure comm - details: Disconnected from auth before getting session key response
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 7 0.7142857142857143 1521566043843
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 8 0.625 1521566103854
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 59560
received auth hello!
{ authId: 503, nonce: <Buffer 98 42 bc 66 52 dc eb 74> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 9 0.5555555555555556 1521566163861
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 59822
received auth hello!
{ authId: 503, nonce: <Buffer 75 3a ae 2e fc 02 ff d2> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 10 0.5 1521566223868
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 47986
received auth hello!
{ authId: 403, nonce: <Buffer 51 ad 63 ef d7 45 bf 01> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 11 0.45454545454545453 1521566283879
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 48248
received auth hello!
{ authId: 403, nonce: <Buffer 46 8d 24 ef b2 fb e2 02> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 12 0.4166666666666667 1521566343889
failure in connection with Auth : authFailureCount: 6
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 51414
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 13 0.38461538461538464 1521566403897
failure in connection with Auth : authFailureCount: 7
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 51674
received auth hello!
{ authId: 401, nonce: <Buffer 7d 11 7b 72 4d 67 82 66> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth401',
     commonName: '10.0.1.1' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth504',
     commonName: '10.0.0.7' },
  serial: '0162445E9C0E',
  notBefore: 2018-03-20T17:02:53.000Z,
  notAfter: 2018-03-21T17:04:33.000Z,
  subjectHash: 'de555cae',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '33:21:79:99:70:CF:BF:0E:C4:BC:9B:F5:73:30:A9:A0:FB:1B:6C:F5',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'B95EF3029A4C4FAE066EFDE0A6119C37979EDB5A64C834CFDC68175183A2CCB6F817A6CEE1A9EF3E562CF75048E8894B6036030296F313DEBF7C1069E42825C46A5F1F6D69FFE10EE6D73B7805503AA7E6A4C2FF62C2E4D5BF7079FBED00C4B24480D5BC43B7B3B042025990D06DEE0A0388CF2AE7F4B313EF564F2EB3931C44FD1DBD6DFA6DA12843C6DBAAE1EFBC5E7EEDA9407AE6D78B6211169F194056CA6F9CD9F20F33FE469D35BCC944D43D2ECB947F73AF95BB5530BFF2A9B92CA16EB949D06EB8218BBBEC8EA009AC9F6C53C626A2796484448AEDAAB3D19834BA2A19D35D0E105AD47B9A6B3E1589517039E098E992676ED418010E608FA312B251',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.1' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 401,
  host: '10.0.1.1',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJEXpwOMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDQxETAPBgNVBAMMCDEwLjAuMC43MB4XDTE4MDMy\nMDE3MDI1M1oXDTE4MDMyMTE3MDQzM1owYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDQwMTERMA8GA1UEAwwIMTAuMC4xLjEwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQC5XvMCmkxPrgZu/eCmEZw3l57bWmTINM/caBdRg6LMtvgXps7h\nqe8+Viz3UEjoiUtgNgMClvMT3r98EGnkKCXEal8fbWn/4Q7m1zt4BVA6p+akwv9i\nwuTVv3B5++0AxLJEgNW8Q7ezsEICWZDQbe4KA4jPKuf0sxPvVk8us5McRP0dvW36\nbaEoQ8bbquHvvF5+7alAeubXi2IRFp8ZQFbKb5zZ8g8z/kadNbzJRNQ9LsuUf3Ov\nlbtVML/yqbksoW65SdBuuCGLu+yOoAmsn2xTxiaieWSERIrtqrPRmDS6KhnTXQ4Q\nWtR7mms+FYlRcDngmOmSZ27UGAEOYI+jErJRAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQEwDQYJKoZIhvcNAQELBQADggEBAEEqHdfK5YM6xPxQcROhYbAjIinNmfxg\ny+7DCOX3CjEht0kjlTfEk2LgwflDOFwua7S1eD3rrt8kkVql9CHXq+wyhImDPtYd\nsrcJApZfdhNcoXxjuRTSZsWApY6vGJtEpM+2AmcxkqeLenSfFsk8Us/8vqI2HUQ+\nn+Ya162jqnkCTYl1w0zR+76eDUhEj8ugvErC3WzAydKxK4AxEB/a3FRwiNT76HpV\nRfnXtrwEwlbTYTvG59NwpRXvQnwKrsOiJXPTv473yFJ4xbO3yLN+jarpMrAce2Rl\nbUxqQ8NVqr6EbjXkmVP7m7UIFUTq8f9Sz8lnYN0pwTJaYJGik1Z6/AU=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 2
to: 3
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 14 0.35714285714285715 1521566463906
connected to auth! from local port 51922
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 15 0.3333333333333333 1521566523916
connected to auth! from local port 52190
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 16 0.3125 1521566583926
connected to auth! from local port 52462
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 17 0.29411764705882354 1521566643936
connected to auth! from local port 52734
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 18 0.2777777777777778 1521566703946
connected to auth! from local port 52996
received auth hello!
{ authId: 401, nonce: <Buffer a6 b8 16 0a ac b0 40 20> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 5b 52 15 f3 65 01 23 dc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 78 be 63 d9 ce 78 85 76 7b ea 0a e7 e1 b9 b1 47>,
  macKeyVal: <Buffer bc fe 23 cf 2c 64 dd 24 9f 1b 39 ce 68 62 86 16 cd d2 33 9a d9 22 2b 9d d1 06 ff 20 dc b7 9b b7>,
  absValidity: 2018-03-20T18:25:07.735Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100154,
  cipherKeyVal: <Buffer e4 f8 ee 07 ba c6 93 c3 fe 52 6c ac af 0e 11 1d>,
  macKeyVal: <Buffer 93 42 82 65 aa 54 ff 7f 83 93 b8 2c 90 ec 74 3f a4 d8 0d 2b c5 93 c0 b8 11 26 7e 35 04 cb 09 3f>,
  absValidity: 2018-03-21T17:25:07.735Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 40100154,
     cipherKeyVal: <Buffer e4 f8 ee 07 ba c6 93 c3 fe 52 6c ac af 0e 11 1d>,
     macKeyVal: <Buffer 93 42 82 65 aa 54 ff 7f 83 93 b8 2c 90 ec 74 3f a4 d8 0d 2b c5 93 c0 b8 11 26 7e 35 04 cb 09 3f>,
     absValidity: 2018-03-21T17:25:07.735Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 83 fa d0 76 b1 3c a7 7e>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.42:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 19 0.2631578947368421 1521566763949
connected to auth! from local port 53274
received auth hello!
{ authId: 401, nonce: <Buffer e4 a0 67 53 66 70 46 2a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 43 c9 82 7f 37 9f 10 69>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100168,
  cipherKeyVal: <Buffer 50 ec 2c 95 bb bc 38 fe 9b 77 13 36 f9 7f ca 35>,
  macKeyVal: <Buffer 44 eb df ff 07 51 22 f9 b5 4f 7d 71 64 28 e9 2d 46 42 b7 9c d4 20 a3 70 b4 7f ba bf 26 66 b0 6e>,
  absValidity: 2018-03-21T17:26:11.332Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 40100168,
     cipherKeyVal: <Buffer 50 ec 2c 95 bb bc 38 fe 9b 77 13 36 f9 7f ca 35>,
     macKeyVal: <Buffer 44 eb df ff 07 51 22 f9 b5 4f 7d 71 64 28 e9 2d 46 42 b7 9c d4 20 a3 70 b4 7f ba bf 26 66 b0 6e>,
     absValidity: 2018-03-21T17:26:11.332Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer e5 c4 7e 33 2d 6b 97 c8>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.42:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 20 0.25 1521566823952
connected to auth! from local port 53548
received auth hello!
{ authId: 401, nonce: <Buffer fa a2 c3 8f 7c 71 76 99> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b9 0e 83 13 ff 41 4c 89>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100180,
  cipherKeyVal: <Buffer 4d 1e 0b c5 7a 4e f2 ba 69 73 9b c1 73 2f 3c bb>,
  macKeyVal: <Buffer e3 1a bd 88 9e 79 d0 d1 38 56 f1 2c 27 73 f1 b8 2a cb 91 d9 d9 95 04 1c ef 9b 8c 2d 82 38 0c c3>,
  absValidity: 2018-03-21T17:27:11.440Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 40100180,
     cipherKeyVal: <Buffer 4d 1e 0b c5 7a 4e f2 ba 69 73 9b c1 73 2f 3c bb>,
     macKeyVal: <Buffer e3 1a bd 88 9e 79 d0 d1 38 56 f1 2c 27 73 f1 b8 2a cb 91 d9 d9 95 04 1c ef 9b 8c 2d 82 38 0c c3>,
     absValidity: 2018-03-21T17:27:11.440Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 56 82 a0 6b e4 cf 10 28>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Disconnected from auth before getting session key response
/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902
            eventHandlers.onError('Error occurred in migration request: Disconnected from auth before getting migration response: ' + error);
                                                                                                                                      ^

ReferenceError: error is not defined
    at Socket.<anonymous> (/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902:135)
    at emitNone (events.js:91:20)
    at Socket.emit (events.js:188:7)
    at endReadableNT (_stream_readable.js:975:12)
    at _combinedTickCallback (internal/process/next_tick.js:80:11)
    at process._tickCallback (internal/process/next_tick.js:104:9)
