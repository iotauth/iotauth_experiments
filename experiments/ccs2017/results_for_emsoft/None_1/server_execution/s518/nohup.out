changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s518.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's518',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 67 49 42 41 41 4b 43 41 51 45 41 33 62 ... > }
Handler: listening on port 22100
s518:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400229
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52990
received auth hello!
{ authId: 504, nonce: <Buffer 16 26 1c aa fb 55 4d c2> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 30 6b 0d e4 c4 f8 ec 53>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 2d 25 41 13 67 1f db 0e 27 be 08 5b d6 9a e6 d0>,
  macKeyVal: <Buffer bf 25 8b 81 8e 68 42 13 3b 1b 9c c4 05 d4 ad 66 9e d8 44 5d d2 be f0 9f ad 19 c9 6e d8 be 24 04>,
  absValidity: 2018-03-21T17:07:19.946Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0d 05 e8 40 84 a8 8c 9f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0d 05 e8 40 84 a8 8c 9f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.84:34100',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400231
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53022
received auth hello!
{ authId: 504, nonce: <Buffer e8 cd 6f 72 ea 36 c1 f1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ca 50 92 64 82 3a 1c 06>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f3 40 6b c6 44 6f 8a 5f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f3 40 6b c6 44 6f 8a 5f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.85:49586',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400235
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53260
received auth hello!
{ authId: 504, nonce: <Buffer ea f7 4e ce bf 1a 08 05> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c2 77 82 d0 df c8 d0 54>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cb ac d3 7d fa 36 95 f8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer cb ac d3 7d fa 36 95 f8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.84:34370',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400237
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53292
received auth hello!
{ authId: 504, nonce: <Buffer d4 13 c1 e2 f6 33 f1 c1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5f bd 99 30 21 5a c4 f6>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d9 7d e7 ed 65 5f 72 5c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d9 7d e7 ed 65 5f 72 5c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.85:49856',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400241
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53530
received auth hello!
{ authId: 504, nonce: <Buffer b7 32 eb c1 13 b0 e7 b5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bc 7d 52 43 09 fb aa 95>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f7 c5 fb 5e 53 86 fc 47>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f7 c5 fb 5e 53 86 fc 47> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.84:34640',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400243
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53562
received auth hello!
{ authId: 504, nonce: <Buffer ce e2 35 50 2b cd 4b 40> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e9 17 78 67 5d 42 f6 f8>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 77 35 b0 02 59 71 aa f2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 77 35 b0 02 59 71 aa f2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.85:50126',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400247
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53800
received auth hello!
{ authId: 504, nonce: <Buffer e4 e7 b6 a6 40 15 a7 6a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7e e8 78 18 c7 cc 10 a0>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 73 3a 32 74 2b 59 d7 4a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 73 3a 32 74 2b 59 d7 4a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.84:34910',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400249
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53832
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer 1f ed 9a 1c 6e da 63 42> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 08 b9 5c b8 a1 7b 12 54>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 60 31 0d c5 7b 79 f6 b5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 60 31 0d c5 7b 79 f6 b5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.85:50396',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400253
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54070
received auth hello!
{ authId: 504, nonce: <Buffer af bb 33 59 35 ac de 3d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 52 aa 05 d3 62 00 d6 2b>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 85 29 ad ea 2d d1 b7 03>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 85 29 ad ea 2d d1 b7 03> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.84:35180',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400255
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54102
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer 41 b9 2b 21 44 4e b3 1f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 71 a9 42 aa 35 25 8e 09>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3e 4d 1a 3d 20 bb 3a d1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3e 4d 1a 3d 20 bb 3a d1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.85:50668',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400259
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54340
received auth hello!
{ authId: 504, nonce: <Buffer 02 ce 96 e7 47 08 f1 08> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 96 8b a5 74 d5 68 8e f2>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 30 7f e9 af 4b ca 4e 56>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 30 7f e9 af 4b ca 4e 56> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.84:35450',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400261
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54372
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer 3c b3 70 09 7b 2a dd 06> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 36 e9 a8 5f 93 60 d6 e3>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7c ae 76 81 8b 7b 39 41>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 7c ae 76 81 8b 7b 39 41> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.85:50936',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
