changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s519.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's519',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 67 49 42 41 41 4b 43 41 51 45 41 70 4b ... > }
Handler: listening on port 22100
s519:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400232
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38630
received auth hello!
{ authId: 504, nonce: <Buffer 53 b7 47 d4 0b 37 5a 8b> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 66 29 6f 8c 3a 6b 50 31>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 15 ac 69 09 9b 10 34 68 e2 8b 5e 7c 17 63 6a 70>,
  macKeyVal: <Buffer e0 c1 0d ae 1a cc f3 44 29 87 cd c6 1f a9 8e 1d 6d 28 90 65 75 65 fc 88 fa f0 39 0c 3d 5f ab 21>,
  absValidity: 2018-03-21T17:07:33.275Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f3 4a 2b 47 d0 1d fb ba>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f3 4a 2b 47 d0 1d fb ba> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.86:47156',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400233
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38654
received auth hello!
{ authId: 504, nonce: <Buffer 3d 22 05 40 5c d4 77 3e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f0 26 46 4d b5 3e c8 0e>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a8 56 c6 e9 7f 7a 3a 8b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a8 56 c6 e9 7f 7a 3a 8b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.87:48444',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400238
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38900
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received auth hello!
{ authId: 504, nonce: <Buffer d6 0b 6c 1c 66 9e cf 2f> }
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400239
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b9 6f 48 56 c5 a7 85 95>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ce 58 a0 15 1a bf 2e a9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ce 58 a0 15 1a bf 2e a9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.86:47426',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
connected to auth! from local port 38922
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer 16 83 51 e3 f1 62 7c 12> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ac e6 13 d7 c3 51 e5 cc>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f0 46 cd fc 29 a9 82 cd>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f0 46 cd fc 29 a9 82 cd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.87:48712',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400244
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39170
received auth hello!
{ authId: 504, nonce: <Buffer 9e 56 33 6f b0 91 4b aa> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2c 6e 59 e8 7c 75 a3 97>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 23 b3 8d d0 71 13 cf f7>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 23 b3 8d d0 71 13 cf f7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.86:47696',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400245
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39192
received auth hello!
{ authId: 504, nonce: <Buffer 3d ed bd 0a 22 75 62 fe> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ab 8e 99 d6 c5 71 b6 1b>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 76 15 3d 12 c7 ba 78 22>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 76 15 3d 12 c7 ba 78 22> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.87:48984',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400250
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39440
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400251
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
received auth hello!
{ authId: 504, nonce: <Buffer bd 18 0d e2 12 e2 e4 a8> }
connected to auth! from local port 39458
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8e 42 ca c7 b9 b8 f4 5e>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5e 71 dc d7 18 8c db 9b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 5e 71 dc d7 18 8c db 9b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.86:47966',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer 7f 6c 00 12 ed 5c 0d de> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ec aa d5 df fb e4 55 f7>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 82 6f ed 88 e6 13 8e 60>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 82 6f ed 88 e6 13 8e 60> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.87:49248',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400256
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39710
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400257
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
received auth hello!
{ authId: 504, nonce: <Buffer 76 d9 cc 4e ef 53 36 f1> }
connected to auth! from local port 39728
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer aa 9b 58 44 c6 d6 b3 37>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 92 82 53 43 e9 93 b1 9d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 92 82 53 43 e9 93 b1 9d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.86:48236',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer 3d ab fd b2 93 1c c4 f8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 91 57 d7 b6 28 16 85 85>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ea d9 91 d7 1a a7 ac 0c>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ea d9 91 d7 1a a7 ac 0c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.87:49518',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400262
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39980
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400263
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39998
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer db bf 25 9a 33 27 44 16> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 72 a3 7c 6b 72 26 a1 a6>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer db 42 54 ca bc 6a d3 01>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer db 42 54 ca bc 6a d3 01> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.86:48506',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
