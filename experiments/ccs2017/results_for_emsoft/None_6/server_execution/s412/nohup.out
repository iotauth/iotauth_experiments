changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s412.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's412',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 34 74 ... > }
Handler: listening on port 22100
s412:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301338
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35874
received auth hello!
{ authId: 403, nonce: <Buffer 76 85 04 3b 14 97 b3 79> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 8d 1e 32 fe 68 0a 55 9c>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 98 f4 f0 39 76 19 b2 2a 90 65 7e a7 ba df 62 32>,
  macKeyVal: <Buffer ce 45 99 5b 12 52 a2 f0 14 f0 8f 17 5b 10 82 11 6b ce 35 6f 14 25 98 a0 5d a2 b5 d4 70 c9 75 4b>,
  absValidity: 2018-03-22T01:54:50.728Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ae 28 7b 70 88 f9 9c a6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ae 28 7b 70 88 f9 9c a6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.57:44944',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301344
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36072
received auth hello!
{ authId: 403, nonce: <Buffer bb f4 fb cb 05 3a 52 fa> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 13 51 68 88 b6 ee 17 90>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer eb a9 e6 66 ff 04 d9 14>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer eb a9 e6 66 ff 04 d9 14> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.57:45142',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301350
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36344
received auth hello!
{ authId: 403, nonce: <Buffer 6b 9a b3 5b 24 c5 31 d5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 57 6e 1c 32 45 d9 ad 75>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1b 5e d4 92 e1 ab fe d4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1b 5e d4 92 e1 ab fe d4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.57:45414',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301356
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36614
received auth hello!
{ authId: 403, nonce: <Buffer 59 06 35 b7 0f ea ad e2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1c 8a 1c 06 36 4d b9 4d>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5d ac 45 3e 0c 35 67 9f>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 5d ac 45 3e 0c 35 67 9f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.57:45684',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301362
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36884
received auth hello!
{ authId: 403, nonce: <Buffer de c6 d4 2f e2 f7 10 54> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 23 8b 87 f5 fc 37 be 5f>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7f d6 0b 57 21 2f cd 7f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 7f d6 0b 57 21 2f cd 7f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.57:45954',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301368
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37154
received auth hello!
{ authId: 403, nonce: <Buffer 28 a0 07 4c 98 4a 6c 77> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fb 27 8b be 13 f6 86 60>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3b 8a c9 73 fb fe 43 67>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3b 8a c9 73 fb fe 43 67> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.57:46224',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301374
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37424
received auth hello!
{ authId: 403, nonce: <Buffer d2 ca 18 69 4b 6b d9 42> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9a 26 ae f5 fa 95 79 03>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9f 86 60 b7 5e 0d 81 37>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9f 86 60 b7 5e 0d 81 37> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.57:46494',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301380
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37690
received auth hello!
{ authId: 403, nonce: <Buffer e7 f8 22 80 a5 ee 09 a7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5a bb 5f 1f ed 7f ba 68>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ba 73 03 fb 68 1f 23 ba>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ba 73 03 fb 68 1f 23 ba> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.57:46760',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
