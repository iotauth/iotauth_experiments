changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s504.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's504',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 32 2b ... > }
Handler: listening on port 22100
s504:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101317
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49202
received auth hello!
{ authId: 501, nonce: <Buffer 93 9e 17 be 0c 8a 00 4f> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 98 f3 c3 39 ae 25 87 13>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer db b5 19 4a 9d 52 34 32 2b d6 d8 60 fd 32 a0 c1>,
  macKeyVal: <Buffer eb f2 73 dc 76 54 eb 39 ff f4 12 01 e9 9f e5 6e 2f df 3f ce 57 8e 94 9a 26 df a1 9d dd 7f 81 df>,
  absValidity: 2018-03-22T01:55:23.352Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c8 8d e9 d1 08 5a 7b 19>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c8 8d e9 d1 08 5a 7b 19> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.67:41852',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101325
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49458
received auth hello!
{ authId: 501, nonce: <Buffer f0 20 3a 3d 8a b2 0d 35> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9a 43 29 3e ec 70 6b 0c>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7a 97 3a 05 84 a4 7f 9a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 7a 97 3a 05 84 a4 7f 9a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.67:42108',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101333
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49728
received auth hello!
{ authId: 501, nonce: <Buffer e3 2e c1 27 cb 08 64 5d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8a 5e 69 7d c0 e1 36 e2>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 54 1f 6a d8 f6 d1 1e c5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 54 1f 6a d8 f6 d1 1e c5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.67:42378',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101341
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49998
received auth hello!
{ authId: 501, nonce: <Buffer 69 bf 89 3c 0e 81 ff 3e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e8 7f d8 4a 4b 2c 7a 16>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 19 76 e2 a2 d7 9f 32 cd>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 19 76 e2 a2 d7 9f 32 cd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.67:42648',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101349
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50268
received auth hello!
{ authId: 501, nonce: <Buffer e2 de ec d6 3c 0d 79 56> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a2 90 90 a1 c2 8d ff da>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 55 56 4d fc f3 40 b4 72>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 55 56 4d fc f3 40 b4 72> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.67:42918',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101357
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50538
received auth hello!
{ authId: 501, nonce: <Buffer 90 3a e7 19 b9 37 1f 9a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c4 8d c6 99 6c 12 5f 1c>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 72 8c e8 ae 02 d0 f7 5f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 72 8c e8 ae 02 d0 f7 5f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.67:43188',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101365
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50808
received auth hello!
{ authId: 501, nonce: <Buffer 37 5b 3a 96 fd 33 82 a9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0c 48 66 65 2c 66 87 78>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer aa 2f d6 ce b5 a2 2c b9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer aa 2f d6 ce b5 a2 2c b9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.67:43458',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
