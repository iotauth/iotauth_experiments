changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s506.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's506',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 37 56 ... > }
Handler: listening on port 22100
s506:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101320
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46606
received auth hello!
{ authId: 501, nonce: <Buffer 34 30 f9 4b 64 ef 6e 1a> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 85 19 91 f6 31 45 2d f4>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer f9 8e fb d3 5f 8e 8c 41 a3 c5 31 40 a6 6a 63 36>,
  macKeyVal: <Buffer 38 a1 e7 80 1b 8e 9c 83 7b 07 46 02 55 38 1d f0 f9 4d 9c d9 65 78 40 24 af 03 b4 e0 6b 73 f2 bf>,
  absValidity: 2018-03-22T01:55:33.814Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 28 12 27 05 05 ed d7 e5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 28 12 27 05 05 ed d7 e5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.70:56736',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101328
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46874
received auth hello!
{ authId: 501, nonce: <Buffer 95 78 e2 a1 f3 be 44 cd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8a b8 a8 f7 1e 09 56 51>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e4 38 8d 0f 42 b5 b9 1b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e4 38 8d 0f 42 b5 b9 1b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.70:57004',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101336
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47148
received auth hello!
{ authId: 501, nonce: <Buffer 30 bc 3c 5d 46 1f a1 6c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 94 9f f8 1e a9 a6 e2 c6>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 62 c5 e3 01 91 a4 6c 29>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 62 c5 e3 01 91 a4 6c 29> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.70:57278',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101344
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47414
received auth hello!
{ authId: 501, nonce: <Buffer 66 90 30 0e f8 d6 e1 e7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1f 0d 6a 7b a9 ac 6a 88>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 99 e6 f3 f3 27 a7 56 14>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 99 e6 f3 f3 27 a7 56 14> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.70:57544',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101352
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47688
received auth hello!
{ authId: 501, nonce: <Buffer 92 60 ff bc a9 42 38 82> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 21 29 8c c3 c8 53 59 44>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 77 34 1d 90 6a 01 a7 6a>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 77 34 1d 90 6a 01 a7 6a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.70:57818',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101360
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47954
received auth hello!
{ authId: 501, nonce: <Buffer c8 f0 60 82 4a b9 2e 20> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3a 8a 64 63 90 b6 27 82>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b4 15 c2 90 2e 7d 06 ba>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b4 15 c2 90 2e 7d 06 ba> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.70:58084',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101368
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48228
received auth hello!
{ authId: 501, nonce: <Buffer f2 ed 92 c0 92 e2 45 2e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 40 3a af 48 17 ad f0 ff>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4a c7 4d 7a bf 21 f0 70>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4a c7 4d 7a bf 21 f0 70> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.70:58358',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
