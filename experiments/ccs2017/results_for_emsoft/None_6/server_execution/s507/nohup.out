changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s507.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's507',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 6d 66 ... > }
Handler: listening on port 22100
s507:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101321
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49998
received auth hello!
{ authId: 501, nonce: <Buffer 12 85 e9 a7 bf 71 5a 7e> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 2d 89 bb 5e 88 c9 5d a7>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 45 9c 9f e0 80 a1 b1 4a cf c9 8c 19 a2 d5 c4 f1>,
  macKeyVal: <Buffer 13 ef 2c b0 cb bf 8c 45 73 4a fb 27 77 db 39 1c e5 23 56 9b 13 60 89 03 bb be af 0a db f9 25 ec>,
  absValidity: 2018-03-22T01:55:37.787Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 34 b0 44 41 7c 8c d3 c1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 34 b0 44 41 7c 8c d3 c1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.71:35436',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101329
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50270
received auth hello!
{ authId: 501, nonce: <Buffer fd 29 20 a4 60 98 7e fe> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1c 26 10 8a 8c 52 e9 87>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7f 76 e5 d3 02 33 d9 6d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 7f 76 e5 d3 02 33 d9 6d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.71:35708',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101337
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50540
received auth hello!
{ authId: 501, nonce: <Buffer 73 6e b2 99 d5 68 b2 22> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cf 27 0a a8 9c 58 63 d6>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 71 fa 60 ae df c3 94 69>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 71 fa 60 ae df c3 94 69> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.71:35978',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101345
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50810
received auth hello!
{ authId: 501, nonce: <Buffer 5b 1b 64 c5 0b c4 87 0c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a2 18 e5 3e ef fc 25 dc>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f9 ce 5a 1d ad 9d 58 05>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f9 ce 5a 1d ad 9d 58 05> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.71:36248',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101353
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51080
received auth hello!
{ authId: 501, nonce: <Buffer d3 cc ed 97 75 7d 82 9f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ea ab 72 22 2b 2c 7d 25>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d5 e6 1a 23 0b c3 93 b4>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer d5 e6 1a 23 0b c3 93 b4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.71:36518',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101361
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51350
received auth hello!
{ authId: 501, nonce: <Buffer ef be f9 ee dc f1 ec d6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 96 fe c6 c1 b7 0a de 59>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ab 7a 95 64 9d 0c d3 41>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ab 7a 95 64 9d 0c d3 41> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.71:36788',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101369
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51620
received auth hello!
{ authId: 501, nonce: <Buffer ba 59 61 82 af 6c 79 c4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 25 95 f0 82 21 ee 89 05>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 44 21 42 57 4f f4 2d c5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 44 21 42 57 4f f4 2d c5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.71:37058',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
