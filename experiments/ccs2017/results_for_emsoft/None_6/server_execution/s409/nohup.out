changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s409.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's409',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 67 49 42 41 41 4b 43 41 51 45 41 6f 6c ... > }
Handler: listening on port 22100
s409:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200893
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56082
received auth hello!
{ authId: 402, nonce: <Buffer 59 91 88 1e 46 c9 1c ab> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer d3 f4 41 f5 45 1e 51 79>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 17 ee 42 2a 95 2d 23 56 44 c1 c9 8e a4 a2 2a fb>,
  macKeyVal: <Buffer 74 54 7c b8 8c 7a 34 cf 26 23 c6 55 ba 3b 84 f1 6f 26 f9 ef 18 93 fc be d4 da c2 96 5b 78 bd d8>,
  absValidity: 2018-03-22T01:54:46.952Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 35 80 23 66 f7 c1 b7 30>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 35 80 23 66 f7 c1 b7 30> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.55:45250',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200900
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56268
received auth hello!
{ authId: 402, nonce: <Buffer c2 ab 78 c2 1e f7 da 0b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9e 68 fd a2 b8 d7 41 89>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 93 d0 ff 66 22 7e 75 21>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 93 d0 ff 66 22 7e 75 21> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.55:45436',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200907
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56540
received auth hello!
{ authId: 402, nonce: <Buffer e9 b0 60 a3 b8 02 82 c4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 82 58 af 17 55 ca b7 0f>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4c b9 a9 8b 9c de 73 9e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4c b9 a9 8b 9c de 73 9e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.55:45708',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200914
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56810
received auth hello!
{ authId: 402, nonce: <Buffer 8e 44 26 e2 f9 33 b5 5f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d3 a1 5f 7d 45 5f e4 3e>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2b c3 3a 20 8e 27 ad e1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2b c3 3a 20 8e 27 ad e1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.55:45978',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200921
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57080
received auth hello!
{ authId: 402, nonce: <Buffer f5 23 68 35 3d 5c 8f 39> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e5 85 b2 73 3e 9f e4 7a>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 20 1f 27 45 45 b2 99 8f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 20 1f 27 45 45 b2 99 8f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.55:46248',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200928
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57350
received auth hello!
{ authId: 402, nonce: <Buffer bf 9e f0 4d af 1e 65 54> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c8 8b ef ef 77 4c 1b 3c>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d7 66 a8 05 56 66 c6 e3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d7 66 a8 05 56 66 c6 e3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.55:46518',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200935
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57620
received auth hello!
{ authId: 402, nonce: <Buffer 62 0d 5a 6b 5c f1 81 37> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 28 04 da 68 0e d6 3f 24>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5d 7f db 16 f5 bc 42 18>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5d 7f db 16 f5 bc 42 18> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.55:46788',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
