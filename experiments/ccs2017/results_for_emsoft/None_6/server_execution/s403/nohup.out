changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s403.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's403',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 67 49 42 41 41 4b 43 41 51 45 41 6c 44 ... > }
Handler: listening on port 22100
s403:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40102161
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34682
received auth hello!
{ authId: 401, nonce: <Buffer 95 d0 41 56 13 dd 7d bd> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer ca 0d 58 ad 49 14 ce 0f>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 71 51 08 e3 40 b4 f0 95 02 41 e0 f5 78 87 59 ee>,
  macKeyVal: <Buffer 73 f4 36 df d9 23 89 78 09 bf f7 df d6 f9 03 47 79 00 3a 82 89 15 71 a3 1a 88 e0 78 51 74 06 00>,
  absValidity: 2018-03-22T01:54:18.113Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a7 85 2a 85 e1 a7 bb 61>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer a7 85 2a 85 e1 a7 bb 61> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.47:50378',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40102167
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34820
received auth hello!
{ authId: 401, nonce: <Buffer 26 de 8b 1e 46 e2 68 5e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 66 53 aa d8 9c a8 13 f1>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cf 94 f1 53 f6 7f 5f fe>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer cf 94 f1 53 f6 7f 5f fe> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.47:50516',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40102173
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35068
received auth hello!
{ authId: 401, nonce: <Buffer db de f3 5d 5d d0 61 e4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c3 1f 43 c0 91 a5 c9 c8>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7f 1e 58 fc 6c 37 3e db>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 7f 1e 58 fc 6c 37 3e db> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.47:50764',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40102179
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35338
received auth hello!
{ authId: 401, nonce: <Buffer 9f d8 48 78 58 c4 01 30> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e1 ad 69 24 c4 9d 8d 06>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fa c5 56 f7 06 1c f8 0e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fa c5 56 f7 06 1c f8 0e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.47:51034',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40102185
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35608
received auth hello!
{ authId: 401, nonce: <Buffer 63 2d a6 4e 7d 6f 81 77> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 84 8f f5 52 ed fd f7 1e>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer af 6c e9 c4 62 ff b9 71>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer af 6c e9 c4 62 ff b9 71> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.47:51304',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40102191
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35878
received auth hello!
{ authId: 401, nonce: <Buffer a9 07 85 d0 7e 90 84 fc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1f 0e e9 aa 5a cd 26 8f>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 09 3f 46 57 87 d0 90 b3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 09 3f 46 57 87 d0 90 b3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.47:51574',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40102197
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36148
received auth hello!
{ authId: 401, nonce: <Buffer 9f 49 95 a1 8f da 0d a2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 58 7c 44 88 13 c0 0b 3f>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6f 4a b8 3a fc 77 f7 5a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6f 4a b8 3a fc 77 f7 5a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.47:51844',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40102203
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36418
received auth hello!
{ authId: 401, nonce: <Buffer f3 1a 30 a9 60 1c 8f 94> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a9 c8 98 90 68 64 c0 28>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 33 fb 83 73 de 73 47 00>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 33 fb 83 73 de 73 47 00> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.47:52114',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40102209
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36664
received auth hello!
{ authId: 401, nonce: <Buffer 18 b1 8d 4b 0d 98 8a 81> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fc b7 db e6 e2 61 33 6e>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5e ec 9c b7 eb 93 78 96>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 5e ec 9c b7 eb 93 78 96> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.47:52360',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
