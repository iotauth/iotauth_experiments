changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s415.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's415',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 74 46 ... > }
Handler: listening on port 22100
s415:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301340
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52002
received auth hello!
{ authId: 403, nonce: <Buffer 91 5e ff eb 1b a4 70 fb> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer f9 67 e0 f6 41 bb 4b c9>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer dc 25 8f b5 d9 cb 0a 69 26 34 1b 7d 1b 18 42 ec>,
  macKeyVal: <Buffer f9 04 d0 fb 26 c0 81 07 40 e5 a9 26 55 d5 f0 03 63 b0 dc 6e 4c e2 7b e5 dc be 97 e1 2d de 1b 0d>,
  absValidity: 2018-03-22T01:54:57.729Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ad 72 51 36 93 da 3e 46>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ad 72 51 36 93 da 3e 46> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.59:44744',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301346
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52212
received auth hello!
{ authId: 403, nonce: <Buffer a7 13 73 70 da d1 bc aa> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2d 2d 93 22 61 ca 26 7e>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 17 a1 a7 f9 73 4c bc 9d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 17 a1 a7 f9 73 4c bc 9d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.59:44952',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301352
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52484
received auth hello!
{ authId: 403, nonce: <Buffer 9d 89 80 bb 94 f5 08 56> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ab 67 25 3d e7 f2 a8 df>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 90 d4 d7 fb 28 c4 79 a2>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 90 d4 d7 fb 28 c4 79 a2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.59:45224',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301358
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52754
received auth hello!
{ authId: 403, nonce: <Buffer 22 26 d1 9b bc 91 88 16> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 79 d0 83 e5 34 a7 3e 11>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f2 45 01 03 e8 b3 5e 24>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f2 45 01 03 e8 b3 5e 24> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.59:45496',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301364
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53024
received auth hello!
{ authId: 403, nonce: <Buffer 70 85 d6 3b 37 3a b1 c8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 96 33 6d 0c c7 50 40 35>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d6 ae 2f be 30 ec 31 17>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d6 ae 2f be 30 ec 31 17> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.59:45764',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301370
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53294
received auth hello!
{ authId: 403, nonce: <Buffer ec d5 74 2a ba ee f7 9d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f2 6f 83 43 11 24 40 6b>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 17 13 2f 3c 5e ab 29 09>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 17 13 2f 3c 5e ab 29 09> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.59:46034',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301376
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53564
received auth hello!
{ authId: 403, nonce: <Buffer 2e 8a fb 0f 5f 8f 92 88> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 79 c7 d2 ed 92 a0 2e 99>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e1 54 b4 43 5e ee 8f 1f>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e1 54 b4 43 5e ee 8f 1f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.59:46304',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301382
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53830
received auth hello!
{ authId: 403, nonce: <Buffer 58 90 b6 28 5c 1d cf 16> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1b b9 63 f6 37 29 66 bc>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 63 ab f4 10 18 92 a9 d3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 63 ab f4 10 18 92 a9 d3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.59:46572',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
