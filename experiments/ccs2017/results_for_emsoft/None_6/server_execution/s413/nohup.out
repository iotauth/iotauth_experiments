changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s413.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's413',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 76 77 ... > }
Handler: listening on port 22100
s413:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301339
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50024
received auth hello!
{ authId: 403, nonce: <Buffer 36 66 de 19 65 a8 d6 f1> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer f6 20 5b c1 3a c8 23 ed>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer c9 4e 02 1e ed cf 9a 11 8d 5e 30 03 1c 5b 83 8b>,
  macKeyVal: <Buffer 71 15 67 77 42 90 9b f2 72 dd 11 88 53 22 2d 8a ee e0 36 c4 6e a7 0f 6d d1 bd 65 4f da cf 5b 02>,
  absValidity: 2018-03-22T01:54:53.930Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 24 2b 43 ba 0f fb b0 61>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 24 2b 43 ba 0f fb b0 61> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.58:56884',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301345
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50228
received auth hello!
{ authId: 403, nonce: <Buffer a6 07 bb 09 a7 1e e3 9f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 35 26 f4 44 3a 0f d5 d3>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ca 7a 97 dd f7 28 1e e3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ca 7a 97 dd f7 28 1e e3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.58:57088',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301351
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50500
received auth hello!
{ authId: 403, nonce: <Buffer 36 2b 69 1a 06 b7 ab 23> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 46 66 20 fc 42 9d ff a5>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e4 c1 73 aa f2 2a b9 2a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e4 c1 73 aa f2 2a b9 2a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.58:57360',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301357
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50770
received auth hello!
{ authId: 403, nonce: <Buffer 9f 84 54 58 4d 20 c9 a9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b7 64 08 3d db 2e ed 92>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 73 d3 a8 72 b2 9f d7 bc>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 73 d3 a8 72 b2 9f d7 bc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.58:57630',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301363
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51040
received auth hello!
{ authId: 403, nonce: <Buffer 78 a1 f7 8c c8 78 71 1e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a4 d5 74 98 6c 3c b9 0e>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 97 04 8b 0d 48 23 e6 bd>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 97 04 8b 0d 48 23 e6 bd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.58:57900',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301369
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51310
received auth hello!
{ authId: 403, nonce: <Buffer 51 01 27 1f f0 5e b4 f9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e6 20 45 f9 6d f2 0e 1b>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 67 97 38 3c 76 80 b7 0a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 67 97 38 3c 76 80 b7 0a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.58:58170',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301375
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51580
received auth hello!
{ authId: 403, nonce: <Buffer b6 50 f3 11 ff 3e 44 65> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7b f8 f6 e4 22 61 53 b4>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a1 de 88 a6 09 1d d4 fc>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a1 de 88 a6 09 1d d4 fc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.58:58440',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301381
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51846
received auth hello!
{ authId: 403, nonce: <Buffer a2 58 63 e1 cf f4 40 d3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3d 12 ae 8d 39 de 38 c7>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer eb 3d c1 4e 47 48 ba f3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer eb 3d c1 4e 47 48 ba f3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.58:58706',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
