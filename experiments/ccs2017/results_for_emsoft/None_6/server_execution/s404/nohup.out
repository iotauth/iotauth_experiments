changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s404.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's404',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 67 49 42 41 41 4b 43 41 51 45 41 78 78 ... > }
Handler: listening on port 22100
s404:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40102162
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54360
received auth hello!
{ authId: 401, nonce: <Buffer f0 f2 bc ae 32 a9 39 3d> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 43 a1 17 e7 85 65 05 6f>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer b0 71 56 f9 e9 aa 8d 23 95 6e ca 7f 31 65 e3 cc>,
  macKeyVal: <Buffer b6 e3 de 64 05 0e 62 2a 77 ae 57 11 34 ae fd 7b 0f 80 06 e0 b8 de 18 1d 77 b0 7c 1b e9 5a 92 30>,
  absValidity: 2018-03-22T01:54:21.678Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 53 63 0b d9 36 9a 1f f5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 53 63 0b d9 36 9a 1f f5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.48:36732',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40102168
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54504
received auth hello!
{ authId: 401, nonce: <Buffer 97 fe a5 63 f1 c5 15 6f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cc 33 ed dd e2 8f 8b d9>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2c 61 c7 ab a2 f7 63 c3>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 2c 61 c7 ab a2 f7 63 c3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.48:36876',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40102174
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54758
received auth hello!
{ authId: 401, nonce: <Buffer 56 b7 c8 ec f7 ba 3a 4a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bb 7f fc cf 68 ba e7 08>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0f 18 36 67 36 eb 07 ea>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0f 18 36 67 36 eb 07 ea> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.48:37130',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40102180
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55024
received auth hello!
{ authId: 401, nonce: <Buffer 9a f4 0d 4d 79 3e 9d a7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2b e7 3c 14 63 f2 14 de>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ef 5f b9 5f de 58 16 3c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ef 5f b9 5f de 58 16 3c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.48:37396',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40102186
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55294
received auth hello!
{ authId: 401, nonce: <Buffer 0c 3f 4a 3b 3e 89 ee f1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer db ac 8b 57 85 4b ea 1e>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer de 53 dd f1 b3 81 42 01>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer de 53 dd f1 b3 81 42 01> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.48:37666',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40102192
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55564
received auth hello!
{ authId: 401, nonce: <Buffer 15 11 ed c2 1c e9 fb 51> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ed 91 d5 a8 24 7c 9e 8c>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7f ae 28 9e ea d3 5e 7b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 7f ae 28 9e ea d3 5e 7b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.48:37936',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40102198
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55834
received auth hello!
{ authId: 401, nonce: <Buffer 42 b9 48 b1 09 4c d4 75> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2f c6 bd 64 8d b9 5c 5a>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fe 24 7e a1 8b 1e 7a 60>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fe 24 7e a1 8b 1e 7a 60> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.48:38206',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40102204
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56108
received auth hello!
{ authId: 401, nonce: <Buffer 98 60 72 ba 28 48 29 d8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ba 50 7d 8e 26 d3 31 95>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e7 e0 1b bc 7d c3 35 5e>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e7 e0 1b bc 7d c3 35 5e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.48:38480',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40102210
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56346
received auth hello!
{ authId: 401, nonce: <Buffer 81 df ac 7b 2c 65 65 19> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b0 44 64 d4 08 a7 7e 36>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6c d9 99 c6 12 a0 b5 f3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6c d9 99 c6 12 a0 b5 f3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.48:38718',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
