changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s408.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's408',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 70 6f ... > }
Handler: listening on port 22100
s408:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200890
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48120
received auth hello!
{ authId: 402, nonce: <Buffer d4 c7 95 f5 d8 41 e2 44> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer db 10 e0 e3 ff 7a 5c c8>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer d8 ec 3e 74 78 d5 84 15 39 cd 24 9f c8 2f d4 bc>,
  macKeyVal: <Buffer d8 08 b0 94 94 a2 20 5c f9 35 35 82 8a 79 96 40 1e c0 d5 24 e8 93 c0 b6 db 47 c3 34 53 f5 d8 57>,
  absValidity: 2018-03-22T01:54:34.907Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 12 89 7a c9 c5 9f 98 1c>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 12 89 7a c9 c5 9f 98 1c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.52:42144',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200892
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48132
received auth hello!
{ authId: 402, nonce: <Buffer 0c 01 08 42 74 b3 8c c1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 76 55 25 f8 d6 f9 33 d4>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6c 11 31 6c 05 14 de 81>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6c 11 31 6c 05 14 de 81> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.54:45900',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200897
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48288
received auth hello!
{ authId: 402, nonce: <Buffer 8e 66 0b a5 5c 47 36 fd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 54 c8 b7 1c e4 73 0b 92>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6a 72 b5 d5 a5 3a 4a 2e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6a 72 b5 d5 a5 3a 4a 2e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.52:42312',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200899
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48312
received auth hello!
{ authId: 402, nonce: <Buffer 95 21 dc e9 01 79 85 bb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0f 25 be db 42 a4 40 9d>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fb 16 3e 2f 49 04 62 6c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fb 16 3e 2f 49 04 62 6c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.54:46080',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200904
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48560
received auth hello!
{ authId: 402, nonce: <Buffer f1 db fd ce e4 53 bf 2b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 51 40 02 f7 fb 64 66 27>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 83 e8 4b 50 44 69 f0 85>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 83 e8 4b 50 44 69 f0 85> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.52:42582',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200906
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48584
received auth hello!
{ authId: 402, nonce: <Buffer b4 b3 2d f1 52 05 1e b5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4b ad 0d 3e 9d 7f 34 f1>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2c 90 2e 89 73 48 a6 3b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2c 90 2e 89 73 48 a6 3b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.54:46352',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200911
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48830
received auth hello!
{ authId: 402, nonce: <Buffer 93 bb 76 44 79 9e 4b 72> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 40 30 c9 b6 84 7e 54 b5>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 76 0b be 96 b4 16 eb 83>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 76 0b be 96 b4 16 eb 83> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.52:42854',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200913
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48854
received auth hello!
{ authId: 402, nonce: <Buffer 3e 17 16 3f f6 90 8a 28> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 72 fc 69 a0 44 cb 88 48>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 26 fa 51 16 dd d7 a1 10>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 26 fa 51 16 dd d7 a1 10> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.54:46622',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200918
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49100
received auth hello!
{ authId: 402, nonce: <Buffer bd 0f ce c0 6d b6 56 bc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d1 e0 35 35 56 ae 97 70>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e2 8b 00 6b df cc 54 1b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e2 8b 00 6b df cc 54 1b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.52:43122',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200920
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49124
received auth hello!
{ authId: 402, nonce: <Buffer d2 cb 30 a0 49 b1 ee 55> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 77 15 27 fc a0 2d 9e 63>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a7 a1 8c d9 98 d5 2f 03>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a7 a1 8c d9 98 d5 2f 03> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.54:46892',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200925
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49370
received auth hello!
{ authId: 402, nonce: <Buffer 4c 04 4d 50 cf 48 87 62> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ff 09 09 2f 1e e6 70 c7>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c0 d5 f1 ba c4 4d 75 24>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c0 d5 f1 ba c4 4d 75 24> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.52:43394',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200927
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49394
received auth hello!
{ authId: 402, nonce: <Buffer ae ec 39 a4 9a 14 6a 31> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ba 96 0a 73 06 5e 98 8a>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b0 ee c3 92 db 97 96 0c>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b0 ee c3 92 db 97 96 0c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.54:47162',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200932
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49640
received auth hello!
{ authId: 402, nonce: <Buffer f9 de a5 c9 71 de 41 d8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f2 83 13 05 bd 00 c3 2d>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fd d5 46 b9 65 0b 48 4d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fd d5 46 b9 65 0b 48 4d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.52:43662',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200934
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49664
received auth hello!
{ authId: 402, nonce: <Buffer c3 63 89 7a fc 0c fc 9a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 59 10 86 7b ab 7b ee 1b>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d8 20 ca d2 9a 3a 6f 2a>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer d8 20 ca d2 9a 3a 6f 2a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.54:47432',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200939
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49910
received auth hello!
{ authId: 402, nonce: <Buffer 7a 52 05 4a d8 d4 b0 53> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer af fc 91 ff fc 0d 91 f0>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5b 94 52 ad c9 ae 8d e7>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 5b 94 52 ad c9 ae 8d e7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.52:43934',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200941
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49934
received auth hello!
{ authId: 402, nonce: <Buffer 52 de e5 fb 37 1b 0b ea> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a3 ae 93 a9 03 3b 17 b0>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 37 93 f1 da 5a 29 a9 70>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 37 93 f1 da 5a 29 a9 70> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.54:47702',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
