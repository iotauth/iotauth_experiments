changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s513.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's513',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 75 74 ... > }
Handler: listening on port 22100
s513:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301511
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59468
received auth hello!
{ authId: 502, nonce: <Buffer 86 cd 9d f5 13 42 44 c7> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 30 24 85 33 28 97 31 7e>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer cb 52 2a 14 32 4e a5 4f 48 e8 22 73 11 87 cc 6f>,
  macKeyVal: <Buffer 64 df bc d7 de 37 3a 4e d3 3d 50 37 31 08 4f 16 c6 b8 41 6c ca 0d e1 99 00 c7 79 0a 12 f6 d8 ce>,
  absValidity: 2018-03-22T01:56:04.542Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c3 cf 09 2f 9c 55 e4 22>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c3 cf 09 2f 9c 55 e4 22> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.79:44952',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301516
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59740
received auth hello!
{ authId: 502, nonce: <Buffer 76 b4 9d f2 71 66 3e 69> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8f e7 76 2b 74 eb f4 e0>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0d de 16 f9 dc e1 bd b7>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 0d de 16 f9 dc e1 bd b7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.79:45224',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301521
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60010
received auth hello!
{ authId: 502, nonce: <Buffer a9 b2 ea 61 30 c0 8c a9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c4 b0 53 60 ba 01 c7 7a>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 36 6d c7 f9 90 0b 75 f3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 36 6d c7 f9 90 0b 75 f3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.79:45494',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301526
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60280
received auth hello!
{ authId: 502, nonce: <Buffer 60 9b 45 47 d7 20 e2 ea> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 90 63 2a f1 6e ca 11 b0>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d9 24 69 a3 a4 06 f6 db>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d9 24 69 a3 a4 06 f6 db> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.79:45764',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301531
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60550
received auth hello!
{ authId: 502, nonce: <Buffer fc de 78 51 2f d4 80 b2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 08 98 9b d8 6d 34 1a f1>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ff 16 c6 05 8f a8 e9 1e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ff 16 c6 05 8f a8 e9 1e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.79:46034',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301536
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60818
received auth hello!
{ authId: 502, nonce: <Buffer d9 0c 31 04 6e 51 e5 57> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 83 fe ed 7d 04 7f b8 17>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fe ec e9 bc 18 52 4a 0f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fe ec e9 bc 18 52 4a 0f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.79:46304',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301541
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 32854
received auth hello!
{ authId: 502, nonce: <Buffer b7 96 6e b9 65 ef 91 b1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 68 43 9e 64 2f 50 eb 93>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1a 32 11 16 e3 5b b4 6c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1a 32 11 16 e3 5b b4 6c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.79:46570',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
