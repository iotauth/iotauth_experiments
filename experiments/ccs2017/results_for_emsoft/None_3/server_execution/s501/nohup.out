changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s501.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's501',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 78 42 ... > }
Handler: listening on port 22100
s501:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101146
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57662
received auth hello!
{ authId: 501, nonce: <Buffer a5 7a 9a 9c e5 9b d0 4f> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 22 8f 8b dd bf e2 16 8c>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 2f c8 bf ee 84 71 90 72 b5 a1 02 c5 2c 91 32 57>,
  macKeyVal: <Buffer 22 81 dc b7 6a f8 26 79 3c b1 56 62 0d 55 81 f9 f1 38 71 51 19 7b 98 37 0d 25 66 fe 12 43 0c 6b>,
  absValidity: 2018-03-21T22:43:47.884Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1b e3 6a 1a a1 25 f2 7a>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 1b e3 6a 1a a1 25 f2 7a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.62:39736',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101154
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57892
received auth hello!
{ authId: 501, nonce: <Buffer 73 7a 31 5c fb ec 28 1e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8a bd e0 25 71 2f 05 a2>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bd e5 36 86 c3 0d ee 19>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bd e5 36 86 c3 0d ee 19> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.62:39966',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101162
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58162
received auth hello!
{ authId: 501, nonce: <Buffer f3 10 02 0f e8 6a 4e a4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 16 b3 a7 ff 4a 6f 38 a0>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 59 88 a7 a9 47 1f c5 c7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 59 88 a7 a9 47 1f c5 c7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.62:40236',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101170
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58432
received auth hello!
{ authId: 501, nonce: <Buffer 71 c2 28 57 08 4c 11 41> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8e 03 10 8a 86 46 1e 2b>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fc 7c fa 5d 85 a9 e3 7b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer fc 7c fa 5d 85 a9 e3 7b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.62:40506',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101178
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58702
received auth hello!
{ authId: 501, nonce: <Buffer 83 29 48 bd cf c6 47 a7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b0 68 e2 6d ed 5b c9 46>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 71 c4 8b 8c 87 89 6f c6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 71 c4 8b 8c 87 89 6f c6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.62:40776',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101186
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58972
received auth hello!
{ authId: 501, nonce: <Buffer f8 bd 90 0f 60 50 a6 ed> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c3 7c a8 d4 eb 55 bf 26>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 45 68 75 43 e2 cb 0f 19>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 45 68 75 43 e2 cb 0f 19> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.62:41046',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101194
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59242
received auth hello!
{ authId: 501, nonce: <Buffer aa e3 bb b3 0b ab a7 fa> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 43 25 1d 35 c0 82 98 12>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 65 68 62 f2 d4 12 ba e4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 65 68 62 f2 d4 12 ba e4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.62:41316',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
