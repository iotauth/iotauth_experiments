changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s406.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's406',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 33 6c ... > }
Handler: listening on port 22100
s406:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200723
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44354
received auth hello!
{ authId: 402, nonce: <Buffer f2 bf cd 19 5c 82 1c 5f> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 78 e7 cf 42 6a 47 dc 65>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 53 12 0f c7 13 6e e3 68 b0 27 2e 0c 35 78 e5 f5>,
  macKeyVal: <Buffer 27 3a fb 80 b3 2a be e0 f2 09 08 ab cd aa c4 cd b8 8e 9c 2a fd 90 8a 7f 98 33 4b aa f9 03 d7 9b>,
  absValidity: 2018-03-21T22:43:08.701Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3d a6 db 4f d2 65 04 8b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 3d a6 db 4f d2 65 04 8b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.50:59202',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200730
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44510
received auth hello!
{ authId: 402, nonce: <Buffer 41 60 63 13 6e 00 1e 7a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 85 24 63 25 40 85 3a 70>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 94 7e 57 97 d9 70 f2 ed>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 94 7e 57 97 d9 70 f2 ed> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.50:59358',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200737
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44772
received auth hello!
{ authId: 402, nonce: <Buffer 2f b0 3e da fc 85 ff 37> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6b d1 45 92 2f d0 b6 52>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 07 34 a4 ea ff 13 64 32>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 07 34 a4 ea ff 13 64 32> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.50:59620',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200744
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45042
received auth hello!
{ authId: 402, nonce: <Buffer 56 42 44 69 8d 9e f8 9f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bb 97 31 26 ee 93 ef d6>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e9 f0 2e de 9b d6 04 98>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e9 f0 2e de 9b d6 04 98> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.50:59890',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200751
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45312
received auth hello!
{ authId: 402, nonce: <Buffer 05 15 d5 fc c2 42 4c e3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2e ac f1 95 b9 33 12 54>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 33 05 16 26 6f e1 6d d3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 33 05 16 26 6f e1 6d d3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.50:60160',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200758
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45582
received auth hello!
{ authId: 402, nonce: <Buffer 63 62 26 1e a4 b4 d7 cc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5c 7c ac 5b 24 65 ea c7>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ad 08 64 1d 70 d8 51 59>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ad 08 64 1d 70 d8 51 59> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.50:60430',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200765
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45852
received auth hello!
{ authId: 402, nonce: <Buffer b1 0f 30 0a 54 1a 68 8e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 14 6d 36 13 9d ae eb f5>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5d 32 45 79 d0 41 c0 48>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5d 32 45 79 d0 41 c0 48> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.50:60700',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200772
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46122
received auth hello!
{ authId: 402, nonce: <Buffer 5f db 97 19 e2 ec 7e d0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 06 4b a9 c9 e4 b1 72 c5>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6e e7 3d e9 4b 44 64 79>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 6e e7 3d e9 4b 44 64 79> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.50:60970',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
