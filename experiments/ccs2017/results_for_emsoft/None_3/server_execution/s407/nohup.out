changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s407.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's407',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 6f 66 ... > }
Handler: listening on port 22100
s407:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200724
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60742
received auth hello!
{ authId: 402, nonce: <Buffer e8 ce c8 30 8c 31 35 ce> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer ac 17 72 c8 d4 35 f3 a6>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 6a 1b 59 5b 97 42 77 a6 6c 12 36 13 9e 9d 60 dd>,
  macKeyVal: <Buffer 70 45 81 a9 a8 93 c1 95 e2 1f 9d d7 55 c3 3d 85 96 ec be 7a 54 39 bc 85 d5 69 c4 fa 3c e9 5d c4>,
  absValidity: 2018-03-21T22:43:11.989Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1c 56 0b 1c 44 f8 d2 5f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1c 56 0b 1c 44 f8 d2 5f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.51:32906',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200731
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60904
received auth hello!
{ authId: 402, nonce: <Buffer 5d 80 b1 1d fd 4a dd 32> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9e 47 37 8a f5 4f f7 2e>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 49 03 94 47 21 ff 4d 08>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 49 03 94 47 21 ff 4d 08> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.51:33068',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200738
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 32940
received auth hello!
{ authId: 402, nonce: <Buffer 5f 38 67 64 0d 6c fb 8e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 62 84 6d 64 91 68 cb 85>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2f f0 af 91 de d7 0d cb>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 2f f0 af 91 de d7 0d cb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.51:33336',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200745
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33210
received auth hello!
{ authId: 402, nonce: <Buffer 09 c5 28 bb 14 60 c7 f2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ed 1b 0d 66 98 f9 50 74>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 78 98 34 4d 12 df 7f bb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 78 98 34 4d 12 df 7f bb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.51:33606',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200752
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33480
received auth hello!
{ authId: 402, nonce: <Buffer 09 ca d4 b2 17 7c a1 bb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7f 03 d7 6a 94 f0 a3 aa>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e4 65 6e 26 73 20 e5 4a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e4 65 6e 26 73 20 e5 4a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.51:33876',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200759
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33750
received auth hello!
{ authId: 402, nonce: <Buffer 1d 8e b2 0c 00 f0 41 4f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer aa 01 c1 02 ac 55 be d1>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ef c7 ed b2 8c b6 66 2b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ef c7 ed b2 8c b6 66 2b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.51:34146',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200766
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34020
received auth hello!
{ authId: 402, nonce: <Buffer ca 86 ed ca 27 8b f0 ae> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9e f8 ce fb 5f 8d fa 5f>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 80 d0 35 b4 18 50 67 d3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 80 d0 35 b4 18 50 67 d3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.51:34416',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200773
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34290
received auth hello!
{ authId: 402, nonce: <Buffer d0 69 bb 00 3e b2 df bb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 64 d7 35 ad 70 a0 a1 78>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a4 42 b9 83 c2 2a 75 39>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a4 42 b9 83 c2 2a 75 39> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.51:34686',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
