changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s507.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's507',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 6d 66 ... > }
Handler: listening on port 22100
s507:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101153
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33576
received auth hello!
{ authId: 501, nonce: <Buffer 1c ed e4 d6 c3 46 6b dd> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 85 cf 96 41 ae 2f 3b a1>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer d4 09 19 86 53 42 bc 07 6d a6 01 fb 95 92 57 28>,
  macKeyVal: <Buffer 8e e8 15 a1 28 1e a5 f9 c6 02 dc 57 a1 40 9b af 7c 71 13 e2 3c b6 72 4a b5 61 22 99 76 1b e8 ff>,
  absValidity: 2018-03-21T22:44:18.758Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4a ec 21 01 99 c6 5f 37>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4a ec 21 01 99 c6 5f 37> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.71:47246',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101161
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33848
received auth hello!
{ authId: 501, nonce: <Buffer 99 43 5f f9 d9 1e ac 22> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4b 4d 5f 9b 5e e5 eb e9>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer da 1c d9 9d 65 a0 bf 23>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer da 1c d9 9d 65 a0 bf 23> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.71:47518',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101169
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34118
received auth hello!
{ authId: 501, nonce: <Buffer 2a 61 a7 e9 8c 69 58 87> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7b 22 d3 1e dd 7f 7d ef>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ac 3a 98 c9 84 81 a3 2c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ac 3a 98 c9 84 81 a3 2c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.71:47788',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101177
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34388
received auth hello!
{ authId: 501, nonce: <Buffer d7 d2 db db 2a 6b 62 7b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b9 fd 31 b2 ec b9 5f 1a>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d0 ad ad 80 8f 81 23 2c>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer d0 ad ad 80 8f 81 23 2c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.71:48058',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101185
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34658
received auth hello!
{ authId: 501, nonce: <Buffer 2b 91 bd 97 34 32 d2 65> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 40 1b 43 60 35 40 ce 4f>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 93 ff 46 7b 7c bd 10 35>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 93 ff 46 7b 7c bd 10 35> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.71:48328',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101193
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34928
received auth hello!
{ authId: 501, nonce: <Buffer f6 26 35 4d 63 c3 7b f8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ba 23 6c 64 24 81 1f 27>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8a 7d 82 fe fe 62 c8 16>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8a 7d 82 fe fe 62 c8 16> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.71:48598',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101201
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35194
received auth hello!
{ authId: 501, nonce: <Buffer 2c 19 55 20 2f 5e 05 03> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 09 29 80 c3 9e 48 c0 28>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 58 54 ac d5 54 5f 6f 16>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 58 54 ac d5 54 5f 6f 16> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.71:48864',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
