changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s504.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's504',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 32 2b ... > }
Handler: listening on port 22100
s504:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101149
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 32780
received auth hello!
{ authId: 501, nonce: <Buffer a7 39 78 3d c9 6e 65 8d> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 7a 50 f7 85 57 00 0c 4c>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer c6 4a a2 32 8e cb 7b 4b 19 6a 44 47 dd ab c9 58>,
  macKeyVal: <Buffer 82 59 08 ff 42 89 1c 21 16 e2 80 58 5f 64 c7 16 39 9a 0c dd b8 51 e6 4a b4 90 79 4d ed dd 5e 29>,
  absValidity: 2018-03-21T22:44:04.333Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3e 6f 08 d8 51 cb c3 d2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3e 6f 08 d8 51 cb c3 d2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.67:53662',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101157
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33036
received auth hello!
{ authId: 501, nonce: <Buffer 68 b3 06 d0 14 fc 81 12> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bf 74 c3 bb 0f 35 cb a2>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bb 9f dd bf ff e4 0a 44>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bb 9f dd bf ff e4 0a 44> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.67:53918',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101165
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33306
received auth hello!
{ authId: 501, nonce: <Buffer ca 9a 65 85 0d 2b 1a 99> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 48 6d df 4e 1c 58 3e aa>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b8 c8 83 c1 2b b9 14 31>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b8 c8 83 c1 2b b9 14 31> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.67:54188',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101173
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33576
received auth hello!
{ authId: 501, nonce: <Buffer 3c 42 2a b6 42 4e fa 9e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fb 4d f3 ff 62 f8 62 41>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ed b2 b9 7f 3e 8c 25 95>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ed b2 b9 7f 3e 8c 25 95> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.67:54458',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101181
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33846
received auth hello!
{ authId: 501, nonce: <Buffer 2b 65 5a 31 56 1e 06 f5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 54 78 34 67 ef ab fe b5>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b8 dc 6f 7c 43 33 91 fb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b8 dc 6f 7c 43 33 91 fb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.67:54728',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101189
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34116
received auth hello!
{ authId: 501, nonce: <Buffer e5 2c 69 bd 3f 4c d3 81> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4f 76 3b e2 b1 7a 17 2b>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 36 4c d2 26 d2 66 ef 78>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 36 4c d2 26 d2 66 ef 78> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.67:54998',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101197
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34386
received auth hello!
{ authId: 501, nonce: <Buffer e5 89 31 3e a3 31 d2 5c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 38 60 c7 62 76 33 43 ff>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b3 a9 dc 1d 85 3d 00 d3>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b3 a9 dc 1d 85 3d 00 d3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.67:55268',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
