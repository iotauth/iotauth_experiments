changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s506.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's506',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 37 56 ... > }
Handler: listening on port 22100
s506:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101152
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58416
received auth hello!
{ authId: 501, nonce: <Buffer e6 79 da e3 d8 b6 9d 6b> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 7b 2d 2d bd e2 5a 63 a9>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 58 6b 0c de 70 9d 2a b8 77 55 33 1c 71 52 e1 22>,
  macKeyVal: <Buffer c8 bf ec 4d 83 c0 aa eb 20 91 31 4c 97 09 2f 45 80 db 43 56 d5 a7 b8 5d 8c 95 04 87 4c f3 f9 fe>,
  absValidity: 2018-03-21T22:44:14.799Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 30 8f 27 9f 86 43 09 65>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 30 8f 27 9f 86 43 09 65> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.70:40314',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101160
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58688
received auth hello!
{ authId: 501, nonce: <Buffer 8b 8e 5b 22 0c 28 9e b2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a9 83 f1 2f db 0f 51 83>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 54 e7 06 60 22 7a 92 40>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 54 e7 06 60 22 7a 92 40> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.70:40586',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101168
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58958
received auth hello!
{ authId: 501, nonce: <Buffer 44 1c 69 2a 62 2f c5 8a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e3 54 84 d0 64 a1 88 30>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 88 30 7a d9 3d 37 12 36>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 88 30 7a d9 3d 37 12 36> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.70:40856',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101176
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59228
received auth hello!
{ authId: 501, nonce: <Buffer b6 fa eb 7c 9c 87 02 d4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 63 00 49 92 2e 8d 3b 18>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 41 00 03 9f f7 25 93 69>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 41 00 03 9f f7 25 93 69> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.70:41126',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101184
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59494
received auth hello!
{ authId: 501, nonce: <Buffer c6 f4 15 0f ef fa 71 34> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ca 19 5c 66 30 33 9b 3b>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c2 1a db 74 7c d2 d5 e8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c2 1a db 74 7c d2 d5 e8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.70:41392',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101192
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59768
received auth hello!
{ authId: 501, nonce: <Buffer 0f ab 46 61 df 79 65 4b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cd ca 4a 36 aa 39 dd 73>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 06 16 ec 1e ab 5a f3 6e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 06 16 ec 1e ab 5a f3 6e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.70:41666',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101200
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60034
received auth hello!
{ authId: 501, nonce: <Buffer 68 11 50 03 26 86 08 15> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3c e2 02 8e f3 53 d1 0b>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b9 02 67 aa d9 58 4a 1d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b9 02 67 aa d9 58 4a 1d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.70:41932',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
