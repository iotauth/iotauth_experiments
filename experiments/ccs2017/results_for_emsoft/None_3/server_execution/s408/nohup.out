changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s408.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's408',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 70 6f ... > }
Handler: listening on port 22100
s408:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200725
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59930
received auth hello!
{ authId: 402, nonce: <Buffer 3d bd 9b b7 19 34 41 dc> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 23 7d 48 a9 74 9d 56 09>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 2c 2e 9a c2 9b 41 9a e2 e8 2a 59 0c 21 84 19 5d>,
  macKeyVal: <Buffer ef 39 d5 90 1a 77 32 7b 90 8c 7d 6d 7a 39 1f 90 15 72 2e d3 0f 22 9c 41 c1 48 ce ae 6e f0 ba 55>,
  absValidity: 2018-03-21T22:43:15.803Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 99 37 8c db 79 64 f0 5e>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 99 37 8c db 79 64 f0 5e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.52:53954',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200727
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59942
received auth hello!
{ authId: 402, nonce: <Buffer 39 d5 1b 76 52 b1 4b 1c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c5 d1 e8 5a 9b 03 10 56>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a9 9b a7 09 58 57 67 7b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a9 9b a7 09 58 57 67 7b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.54:57710',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200732
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60098
received auth hello!
{ authId: 402, nonce: <Buffer 5b a8 14 f0 28 20 70 35> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 02 cc 45 3b 6a fd d1 84>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 02 d2 dc 1f 79 c0 b2 64>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 02 d2 dc 1f 79 c0 b2 64> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.52:54122',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200734
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60122
received auth hello!
{ authId: 402, nonce: <Buffer 83 4f 4e a7 1c 10 d1 30> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 19 f2 0f b8 f1 9d 24 5a>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d1 c9 59 e6 69 c6 75 03>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d1 c9 59 e6 69 c6 75 03> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.54:57890',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200739
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60370
received auth hello!
{ authId: 402, nonce: <Buffer 80 ab 84 b9 f0 f5 32 3e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9c ec 29 41 fd 85 53 ae>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ab 6d eb c2 a2 e1 d5 84>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ab 6d eb c2 a2 e1 d5 84> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.52:54394',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200741
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60394
received auth hello!
{ authId: 402, nonce: <Buffer 05 06 1f 1a 56 bd bb 98> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 98 a7 c3 05 60 5e 58 71>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 11 55 01 ce 3c 71 89 dd>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 11 55 01 ce 3c 71 89 dd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.54:58162',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200746
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60640
received auth hello!
{ authId: 402, nonce: <Buffer 89 53 c3 27 6c 8a 9f 5c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 32 da 8a e5 d3 03 dd 14>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 48 a5 c9 17 20 14 da cf>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 48 a5 c9 17 20 14 da cf> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.52:54664',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200748
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60664
received auth hello!
{ authId: 402, nonce: <Buffer c0 62 e6 31 9a 1c 97 d4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f3 ae d2 8f 34 43 fe 3c>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c2 d0 64 7b 82 cc 99 79>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c2 d0 64 7b 82 cc 99 79> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.54:58432',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200753
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60910
received auth hello!
{ authId: 402, nonce: <Buffer 30 91 0d 23 b8 b5 51 a1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d0 b3 f9 5b 7b 26 a8 08>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0c b8 cc 44 9c 46 80 eb>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 0c b8 cc 44 9c 46 80 eb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.52:54934',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200755
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60934
received auth hello!
{ authId: 402, nonce: <Buffer 75 4c e9 72 82 95 5d 82> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a6 89 4a f0 7b 5e 9a dc>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3b 3c 50 c6 5a 02 17 07>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3b 3c 50 c6 5a 02 17 07> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.54:58702',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200760
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 32948
received auth hello!
{ authId: 402, nonce: <Buffer eb eb 18 78 01 91 29 22> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d3 42 f1 a3 ad 8c 8f 5b>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 32 14 06 f9 04 ed f0 93>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 32 14 06 f9 04 ed f0 93> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.52:55204',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200762
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 32972
received auth hello!
{ authId: 402, nonce: <Buffer 00 3b 31 72 c7 41 70 80> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 89 4c 68 a5 8b c5 8f d6>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 29 bd 3b ce d6 53 59 bd>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 29 bd 3b ce d6 53 59 bd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.54:58972',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200767
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33218
received auth hello!
{ authId: 402, nonce: <Buffer b0 4c fc 68 bb 4b 11 00> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0b c7 09 5f d0 db 0b b7>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c9 5a f4 aa 65 b4 3d 7f>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c9 5a f4 aa 65 b4 3d 7f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.52:55474',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200769
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33242
received auth hello!
{ authId: 402, nonce: <Buffer 1d 60 53 58 b6 05 ea 5e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 73 51 55 ee ac 2d 3f 85>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8e 85 9a 7e b9 33 c9 85>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8e 85 9a 7e b9 33 c9 85> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.54:59242',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200774
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33484
received auth hello!
{ authId: 402, nonce: <Buffer 28 fc 0b 1e 23 51 73 6e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 91 8f 5c 59 01 25 86 73>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cb b0 ce 7b 19 3a 13 bb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer cb b0 ce 7b 19 3a 13 bb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.52:55740',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200776
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33508
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
