changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s505.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's505',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 71 79 ... > }
Handler: listening on port 22100
s505:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101150
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44432
received auth hello!
{ authId: 501, nonce: <Buffer 08 68 91 c4 34 f6 be e6> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer c5 70 e7 2e 7d cc ae 0b>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 14 91 ea 07 7b 13 80 82 4d da b0 74 7c 3c 6e 4f>,
  macKeyVal: <Buffer 43 b0 d7 e0 3f 53 a7 fe 8c e5 aa 19 39 0f 3a a2 c0 68 52 38 65 62 bf 88 fb b6 61 23 ed 59 13 68>,
  absValidity: 2018-03-21T22:44:07.661Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e7 3f ed 52 f1 70 67 b1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e7 3f ed 52 f1 70 67 b1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.68:43718',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101151
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44444
received auth hello!
{ authId: 501, nonce: <Buffer 46 8c bb 2a c5 fa 7d de> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 53 99 8f f5 e1 e7 3a 51>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 65 e8 8c 16 91 0c 39 85>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 65 e8 8c 16 91 0c 39 85> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.69:60622',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101158
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44694
received auth hello!
{ authId: 501, nonce: <Buffer 57 7c cd 09 10 1f 84 07> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8e ba 6c ef 6e 4b 73 5a>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 42 fd 4a 99 d3 3b 45 90>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 42 fd 4a 99 d3 3b 45 90> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.68:43980',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101159
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44708
received auth hello!
{ authId: 501, nonce: <Buffer c9 2c fa ba cd 62 b2 43> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c5 d6 54 4f 2f f8 2d cb>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f7 d0 7e 45 63 6c 81 ed>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f7 d0 7e 45 63 6c 81 ed> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.69:60886',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101166
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44964
received auth hello!
{ authId: 501, nonce: <Buffer fd 44 76 b8 19 ba 9e d3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ff f7 91 74 bd a9 51 91>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3f f8 bf 31 a6 d4 1f f9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3f f8 bf 31 a6 d4 1f f9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.68:44250',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101167
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44978
received auth hello!
{ authId: 501, nonce: <Buffer 87 73 0a b8 3e 05 55 83> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 53 d4 d0 7a f5 54 dd 17>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ef 0a 37 98 3a de bf dc>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ef 0a 37 98 3a de bf dc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.69:32924',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101174
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45234
received auth hello!
{ authId: 501, nonce: <Buffer 85 d2 b6 b3 2f 19 0e d5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 90 60 45 c1 e3 f3 ca 78>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c6 4e b8 ee b9 7d 0f f8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c6 4e b8 ee b9 7d 0f f8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.68:44520',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101175
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45248
received auth hello!
{ authId: 501, nonce: <Buffer ca 3b 93 4a 24 a2 7a a5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1e 2d df 20 1b 5d ce d2>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8c 19 27 24 59 fb 92 b0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8c 19 27 24 59 fb 92 b0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.69:33194',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101182
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45504
received auth hello!
{ authId: 501, nonce: <Buffer 41 c6 0d e1 7a 1b a9 86> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 60 4e 3f 3b b3 6d 92 18>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c8 ec 5d 88 ea 64 47 d4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c8 ec 5d 88 ea 64 47 d4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.68:44790',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101183
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45522
received auth hello!
{ authId: 501, nonce: <Buffer 24 8e 26 4e 08 1e 46 1c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d3 c7 c9 c9 7a 8f 1c 11>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a0 dd 8e 67 f9 af 7c 40>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a0 dd 8e 67 f9 af 7c 40> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.69:33468',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101190
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45774
received auth hello!
{ authId: 501, nonce: <Buffer 7f 7a 7d 82 17 33 fe b2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3e e3 4f 46 7f bd 2f 69>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7b 69 7c 16 c9 d0 61 57>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 7b 69 7c 16 c9 d0 61 57> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.68:45060',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101191
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45792
received auth hello!
{ authId: 501, nonce: <Buffer e9 0d 78 2d ee 9f 85 17> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 88 0a 3c e8 fc 67 fb 1f>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7a 68 31 16 ee 8d 13 25>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 7a 68 31 16 ee 8d 13 25> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.69:33738',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101198
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46044
received auth hello!
{ authId: 501, nonce: <Buffer 6d b4 2a 3d 7c f4 9a d4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 28 c3 94 c6 f3 5c 83 12>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 60 62 e4 44 04 58 da 08>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 60 62 e4 44 04 58 da 08> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.68:45330',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101199
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46058
received auth hello!
{ authId: 501, nonce: <Buffer f4 2e ca cd 50 ec a1 be> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5e c8 93 ba d8 af 26 2c>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ea 9e 24 26 b6 0c 34 d2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ea 9e 24 26 b6 0c 34 d2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.69:34004',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
