changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c521.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c521',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 67 49 42 41 41 4b 43 41 51 45 41 77 6d ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521600330643
connected to auth! from local port 51842
received auth hello!
{ authId: 503, nonce: <Buffer 94 d5 fb b1 ce f6 4e 62> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 5d 7f cd 13 8e 02 f9 6a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 1c a1 a0 1e c8 f0 33 6a e8 45 f2 2b 2f 7a 98 92>,
  macKeyVal: <Buffer c8 41 3d 69 18 ad 16 5f ec 8a ea 4d c0 f1 3c 5a 6a d7 4c 67 35 33 08 b6 91 6e 91 55 8d d3 51 aa>,
  absValidity: 2018-03-21T03:45:30.844Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300704,
  cipherKeyVal: <Buffer 32 52 9e 85 53 c7 66 30 87 17 aa b0 73 c2 7e 71>,
  macKeyVal: <Buffer c4 7b d3 5a 7b 84 1c 8d bc 2b 2e 54 e3 9f 48 73 4e 7e 09 2e 73 da f3 75 69 55 94 73 19 4b aa a3>,
  absValidity: 2018-03-22T02:45:30.844Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.39',
  serverPort: 22100,
  sessionKey: 
   { id: 50300704,
     cipherKeyVal: <Buffer 32 52 9e 85 53 c7 66 30 87 17 aa b0 73 c2 7e 71>,
     macKeyVal: <Buffer c4 7b d3 5a 7b 84 1c 8d bc 2b 2e 54 e3 9f 48 73 4e 7e 09 2e 73 da f3 75 69 55 94 73 19 4b aa a3>,
     absValidity: 2018-03-22T02:45:30.844Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer d3 18 2f 58 59 30 d3 7a>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:45:31 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521600332096
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521600390698
connected to auth! from local port 52112
received auth hello!
{ authId: 503, nonce: <Buffer 7c 5a 8d cf fa cf 8f 6c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e0 06 40 6d b0 d0 51 07>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300709,
  cipherKeyVal: <Buffer d3 18 b8 30 4a 55 c8 49 39 6b 48 05 09 4c b0 5f>,
  macKeyVal: <Buffer 4e 67 4c 38 5e 6f f2 e1 7b 13 0f aa d6 16 93 72 2c de 8b 8e 65 12 6b 70 da 94 fe 78 a1 e9 92 19>,
  absValidity: 2018-03-22T02:46:30.865Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.39',
  serverPort: 22100,
  sessionKey: 
   { id: 50300709,
     cipherKeyVal: <Buffer d3 18 b8 30 4a 55 c8 49 39 6b 48 05 09 4c b0 5f>,
     macKeyVal: <Buffer 4e 67 4c 38 5e 6f f2 e1 7b 13 0f aa d6 16 93 72 2c de 8b 8e 65 12 6b 70 da 94 fe 78 a1 e9 92 19>,
     absValidity: 2018-03-22T02:46:30.865Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer e8 d9 75 2e 2a 0a de 18>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:46:31 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521600392405
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521600450729
connected to auth! from local port 52382
received auth hello!
{ authId: 503, nonce: <Buffer be 89 3a a4 a0 0c 09 97> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 36 01 04 92 1b f4 f3 8a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300714,
  cipherKeyVal: <Buffer d2 ce 70 d5 10 f8 c8 06 e8 27 72 b0 c1 1d e2 b0>,
  macKeyVal: <Buffer 5d 40 8a 8a 60 a0 de 8f d5 69 22 1a 25 b7 2c bd 05 1f 71 4b 0f 3f e3 9a 95 08 3d 2f 5b 9b 29 8e>,
  absValidity: 2018-03-22T02:47:30.864Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.39',
  serverPort: 22100,
  sessionKey: 
   { id: 50300714,
     cipherKeyVal: <Buffer d2 ce 70 d5 10 f8 c8 06 e8 27 72 b0 c1 1d e2 b0>,
     macKeyVal: <Buffer 5d 40 8a 8a 60 a0 de 8f d5 69 22 1a 25 b7 2c bd 05 1f 71 4b 0f 3f e3 9a 95 08 3d 2f 5b 9b 29 8e>,
     absValidity: 2018-03-22T02:47:30.864Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer d7 7e 4d ed 94 ea 01 d2>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:47:31 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521600452246
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521600510752
connected to auth! from local port 52652
received auth hello!
{ authId: 503, nonce: <Buffer 90 03 f6 ae 8e 53 6c 6d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ca 8a c3 7e 37 ef f8 f1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300719,
  cipherKeyVal: <Buffer 33 47 5f ae 86 f5 73 85 0b 31 8a 57 15 23 a8 64>,
  macKeyVal: <Buffer ac b4 e2 e9 dc b8 aa d1 6f 9c 2c 52 83 39 bc 9f 5e 80 4a ee 94 47 a7 fe 26 41 84 d8 79 99 d4 07>,
  absValidity: 2018-03-22T02:48:30.905Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.39',
  serverPort: 22100,
  sessionKey: 
   { id: 50300719,
     cipherKeyVal: <Buffer 33 47 5f ae 86 f5 73 85 0b 31 8a 57 15 23 a8 64>,
     macKeyVal: <Buffer ac b4 e2 e9 dc b8 aa d1 6f 9c 2c 52 83 39 bc 9f 5e 80 4a ee 94 47 a7 fe 26 41 84 d8 79 99 d4 07>,
     absValidity: 2018-03-22T02:48:30.905Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer df e9 e1 fd d1 97 ef 9f>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:48:31 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521600512265
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521600570811
connected to auth! from local port 52922
received auth hello!
{ authId: 503, nonce: <Buffer 3e 19 3a ee 27 a1 22 f0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 66 ba c9 b0 a4 9a 91 fc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300724,
  cipherKeyVal: <Buffer 54 33 b4 99 f3 98 51 03 4c 29 46 d7 16 b0 59 b8>,
  macKeyVal: <Buffer 5c 45 80 ab 6f 8c 24 a5 8c 6d f1 08 bc d8 d4 7c 00 14 18 e0 17 1a fb 3c 43 d5 d2 64 90 33 ba f6>,
  absValidity: 2018-03-22T02:49:30.949Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.39',
  serverPort: 22100,
  sessionKey: 
   { id: 50300724,
     cipherKeyVal: <Buffer 54 33 b4 99 f3 98 51 03 4c 29 46 d7 16 b0 59 b8>,
     macKeyVal: <Buffer 5c 45 80 ab 6f 8c 24 a5 8c 6d f1 08 bc d8 d4 7c 00 14 18 e0 17 1a fb 3c 43 d5 d2 64 90 33 ba f6>,
     absValidity: 2018-03-22T02:49:30.949Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 62 f2 a2 df cc e1 7f ca>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:49:31 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521600572245
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521600630869
connected to auth! from local port 53192
received auth hello!
{ authId: 503, nonce: <Buffer 31 80 a3 a6 54 9b 99 15> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 51 8a aa 5e a6 d3 58 14>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300729,
  cipherKeyVal: <Buffer 71 4e 5f 6c 30 8f c8 3d dd c5 48 7b 3f 58 c9 83>,
  macKeyVal: <Buffer 63 eb 0a 37 d4 bc 7d fa 9f 00 e8 d0 07 71 61 40 97 a2 d1 6a 0f 80 61 38 61 39 37 52 0e 3c da b1>,
  absValidity: 2018-03-22T02:50:31.011Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.39',
  serverPort: 22100,
  sessionKey: 
   { id: 50300729,
     cipherKeyVal: <Buffer 71 4e 5f 6c 30 8f c8 3d dd c5 48 7b 3f 58 c9 83>,
     macKeyVal: <Buffer 63 eb 0a 37 d4 bc 7d fa 9f 00 e8 d0 07 71 61 40 97 a2 d1 6a 0f 80 61 38 61 39 37 52 0e 3c da b1>,
     absValidity: 2018-03-22T02:50:31.011Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer e9 fe f3 0e 0b 65 2d f0>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:50:31 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521600632256
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521600690925
connected to auth! from local port 53446
received auth hello!
{ authId: 503, nonce: <Buffer 8c c4 df 9c 51 ce 85 36> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b1 bd ff 18 af 7a e4 8f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300734,
  cipherKeyVal: <Buffer 9a bd d5 81 89 77 36 54 9d 9d e5 4a bf ca bd c5>,
  macKeyVal: <Buffer e6 fb 82 cb 34 7c 2a e3 b7 4d 7f 41 1a 18 5a a4 39 fb 1c 92 4c 85 40 ea 2c 2a ac 74 65 42 da fb>,
  absValidity: 2018-03-22T02:51:31.081Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.39',
  serverPort: 22100,
  sessionKey: 
   { id: 50300734,
     cipherKeyVal: <Buffer 9a bd d5 81 89 77 36 54 9d 9d e5 4a bf ca bd c5>,
     macKeyVal: <Buffer e6 fb 82 cb 34 7c 2a e3 b7 4d 7f 41 1a 18 5a a4 39 fb 1c 92 4c 85 40 ea 2c 2a ac 74 65 42 da fb>,
     absValidity: 2018-03-22T02:51:31.081Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer da 4d bc 9f 6d 7a cf 10>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:51:31 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521600691878
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521600750944
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 9 0.7777777777777778 1521600810945
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
connected to auth! from local port 55248
received auth hello!
{ authId: 502, nonce: <Buffer 83 a7 3b 91 d5 d4 25 08> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth503',
     commonName: '10.0.0.6' },
  serial: '0162466F86EE',
  notBefore: 2018-03-21T02:40:36.000Z,
  notAfter: 2018-03-22T02:42:16.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'FD:ED:B6:7B:E1:1F:40:B6:A4:9F:CC:8D:82:E0:CF:DB:49:99:29:E5',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'FF6CB5202497CC77AF28EFDE774858E4FEF04355E5228E378962DF4235BE3683DAF9E38A7E22621D66B3B50166D897E97BF911F9E8FC09D686961AA39679014E5DDD27EA0F02DE853A41537DB5E37F33395E249F355C0D074419572E9856D1D598CAB2CD6951013DDCB0A163B943DFCD2694BE18B9B3892695B3052EBD9115D447293C83AF24A008794B842E4F0A6C2A8D0189612A600AA40A592603E43713C0ECCA681024E5EC429FAD09484B824919DF59C8BD488E0D372D2A3D8B99B6068E24BBBDA8F0BCDDBA806010E4A7181736DF08D4D1CFC16E26507C360EDCBFF1B5F4288CE304DE62E9696665C5108489AD7232658356998FF47C4F7E8A04225423',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJGb4buMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDMxETAPBgNVBAMMCDEwLjAuMC42MB4XDTE4MDMy\nMTAyNDAzNloXDTE4MDMyMjAyNDIxNlowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQD/bLUgJJfMd68o7953SFjk/vBDVeUijjeJYt9CNb42g9r544p+\nImIdZrO1AWbYl+l7+RH56PwJ1oaWGqOWeQFOXd0n6g8C3oU6QVN9teN/MzleJJ81\nXA0HRBlXLphW0dWYyrLNaVEBPdywoWO5Q9/NJpS+GLmziSaVswUuvZEV1EcpPIOv\nJKAIeUuELk8KbCqNAYlhKmAKpApZJgPkNxPA7MpoECTl7EKfrQlIS4JJGd9ZyL1I\njg03LSo9i5m2Bo4ku72o8LzduoBgEOSnGBc23wjU0c/BbiZQfDYO3L/xtfQojOME\n3mLpaWZlxRCEia1yMmWDVpmP9HxPfooEIlQjAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAAOpn4W0Vj6QyesFGVqgWa2PIvxur53e\nNkXt2+xrGfi4oKgz6mYzo2ZAvYtHm5QSLrL0MldxVWGKEwk55U5S3rXfkwt4vWYD\nv8JPHF3JrZ053T8d90BMx2/zi9SxU51/pJfZZdLdY+42BxBFIJvdPhfOu91B/hv4\nD1bP8dp+7Vn1Z3zCn45Aiewo9B1uxh3ihWdPYZsBXWcZq1WqqU7Bnd6sXajGHZnJ\nxRPrf2pChNGVmygojwy7uwhnncYUJBhYnkk/cF34MsZ4wBOZDzPQKd6ooUhdvDdY\nFsNBUZ9CM9IhXZSpyjd0pvaEUeDAsesFbneUAkJLkRNaHT4DFKQ1HEs=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 10 0.7 1521600870956
connected to auth! from local port 55446
received auth hello!
{ authId: 502, nonce: <Buffer 7b da 42 99 ef 59 57 46> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 8c d5 9e 59 d8 4a 5d d5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 9e 32 1c a8 0f ef da b5 e1 f0 5d ac 4f 4c 71 62>,
  macKeyVal: <Buffer b5 c0 54 fb d3 e9 10 2d 46 f1 4b d8 b7 c2 9e e4 99 29 a5 8e 56 f3 f7 49 c6 ed ac dc f7 e9 45 a7>,
  absValidity: 2018-03-21T03:54:34.853Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201100,
  cipherKeyVal: <Buffer 10 0a a0 c3 c2 41 8f 77 37 2f df f3 ac 29 7e fd>,
  macKeyVal: <Buffer 11 e1 30 b1 8b ce 73 2d f7 e2 91 e2 92 7b fc 4c f5 19 08 ef 12 e4 8f ca de 95 18 fd 94 8c bb 87>,
  absValidity: 2018-03-22T02:54:34.853Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.39',
  serverPort: 22100,
  sessionKey: 
   { id: 50201100,
     cipherKeyVal: <Buffer 10 0a a0 c3 c2 41 8f 77 37 2f df f3 ac 29 7e fd>,
     macKeyVal: <Buffer 11 e1 30 b1 8b ce 73 2d f7 e2 91 e2 92 7b fc 4c f5 19 08 ef 12 e4 8f ca de 95 18 fd 94 8c bb 87>,
     absValidity: 2018-03-22T02:54:34.853Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 42 bb 0f a6 8b 7c 75 b0>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.39:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 11 0.6363636363636364 1521600930962
connected to auth! from local port 55648
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 12 0.5833333333333334 1521600990969
connected to auth! from local port 55848
received auth hello!
{ authId: 502, nonce: <Buffer f5 4c 81 d3 21 06 fc d2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 29 d5 e9 b1 dc 1b 1b 44>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201129,
  cipherKeyVal: <Buffer 69 7c 44 96 46 70 57 52 ac 1a 49 a8 cf 2f 6b 8f>,
  macKeyVal: <Buffer cf 16 4a 05 8f 89 85 64 0c c4 34 8f d5 43 06 9a 0e 0a 40 50 af 28 06 73 d7 01 65 4c e3 5b aa 14>,
  absValidity: 2018-03-22T02:56:34.824Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.39',
  serverPort: 22100,
  sessionKey: 
   { id: 50201129,
     cipherKeyVal: <Buffer 69 7c 44 96 46 70 57 52 ac 1a 49 a8 cf 2f 6b 8f>,
     macKeyVal: <Buffer cf 16 4a 05 8f 89 85 64 0c c4 34 8f d5 43 06 9a 0e 0a 40 50 af 28 06 73 d7 01 65 4c e3 5b aa 14>,
     absValidity: 2018-03-22T02:56:34.824Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer bf 23 47 e7 7f 73 4d 98>
switching to HANDSHAKE_1_SENT
disconnected from auth
received auth hello!
{ authId: 502, nonce: <Buffer 66 bf 60 6a de 16 4f f5> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: write after end
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.39:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 13 0.5384615384615384 1521601050975
connected to auth! from local port 56060
received auth hello!
{ authId: 502, nonce: <Buffer 5c 7f fa d9 79 c9 ec ab> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3f dc 3c 72 f4 b4 76 fb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201145,
  cipherKeyVal: <Buffer 54 6c 11 6c f1 cf 8a f1 31 d9 d1 75 35 2d ca 7d>,
  macKeyVal: <Buffer 0e fd 4a 64 8c ca f3 38 2c 42 4b 15 c7 a3 4b d1 84 7e 09 75 86 e4 4d 28 49 91 b6 5a 0d 31 4f 12>,
  absValidity: 2018-03-22T02:57:34.825Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.39',
  serverPort: 22100,
  sessionKey: 
   { id: 50201145,
     cipherKeyVal: <Buffer 54 6c 11 6c f1 cf 8a f1 31 d9 d1 75 35 2d ca 7d>,
     macKeyVal: <Buffer 0e fd 4a 64 8c ca f3 38 2c 42 4b 15 c7 a3 4b d1 84 7e 09 75 86 e4 4d 28 49 91 b6 5a 0d 31 4f 12>,
     absValidity: 2018-03-22T02:57:34.825Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 78 f3 b7 15 5b 0f a6 70>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Connection with Auth timed out...
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.39:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 14 0.5 1521601110982
connected to auth! from local port 56254
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 15 0.4666666666666667 1521601170992
connected to auth! from local port 56446
received auth hello!
{ authId: 502, nonce: <Buffer cd 95 62 a0 33 1c 2b 1f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 97 d1 e4 13 cf d5 ce a0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201173,
  cipherKeyVal: <Buffer cb 0d eb 4a 6a ab 74 3b 33 42 13 4e cd 36 ef 31>,
  macKeyVal: <Buffer 0a 23 79 aa f2 2c 7b 45 e3 7e 8d a2 ef c0 3b bb 62 75 4a bf d1 f9 9e 26 59 ff 17 51 fc 48 1b 05>,
  absValidity: 2018-03-22T02:59:34.839Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.39',
  serverPort: 22100,
  sessionKey: 
   { id: 50201173,
     cipherKeyVal: <Buffer cb 0d eb 4a 6a ab 74 3b 33 42 13 4e cd 36 ef 31>,
     macKeyVal: <Buffer 0a 23 79 aa f2 2c 7b 45 e3 7e 8d a2 ef c0 3b bb 62 75 4a bf d1 f9 9e 26 59 ff 17 51 fc 48 1b 05>,
     absValidity: 2018-03-22T02:59:34.839Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 4d 90 59 e2 30 da 1c 5c>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.39:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 16 0.4375 1521601230998
connected to auth! from local port 56624
received auth hello!
{ authId: 502, nonce: <Buffer aa c8 41 bb 0f 10 eb 7b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer dc 4f c6 94 56 4c 34 00>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201186,
  cipherKeyVal: <Buffer 73 10 cf 71 6f 30 f9 e4 6f b4 a3 98 cd 83 df e6>,
  macKeyVal: <Buffer cf 40 f2 8a 7e ed e2 04 5c 6f a2 34 75 9c 08 89 c7 79 2f 34 15 ef d6 76 94 f9 18 87 18 17 cf b5>,
  absValidity: 2018-03-22T03:00:34.822Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.39',
  serverPort: 22100,
  sessionKey: 
   { id: 50201186,
     cipherKeyVal: <Buffer 73 10 cf 71 6f 30 f9 e4 6f b4 a3 98 cd 83 df e6>,
     macKeyVal: <Buffer cf 40 f2 8a 7e ed e2 04 5c 6f a2 34 75 9c 08 89 c7 79 2f 34 15 ef d6 76 94 f9 18 87 18 17 cf b5>,
     absValidity: 2018-03-22T03:00:34.822Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer a8 eb e6 25 c0 4e d0 9c>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.39:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 17 0.4117647058823529 1521601291005
connected to auth! from local port 56804
received auth hello!
{ authId: 502, nonce: <Buffer 0b ba d8 71 77 6a da 24> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a3 43 f5 1b 7c 2c 0a 14>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201199,
  cipherKeyVal: <Buffer 85 aa 15 be f2 2e 15 46 b2 3d a0 b2 b8 1d 92 07>,
  macKeyVal: <Buffer d6 10 49 8e 7a b2 41 80 17 6f 22 05 00 b7 ca a5 8b 7e 6a a9 a0 77 65 ae 59 8d c0 19 33 bc ad 35>,
  absValidity: 2018-03-22T03:01:34.822Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.39',
  serverPort: 22100,
  sessionKey: 
   { id: 50201199,
     cipherKeyVal: <Buffer 85 aa 15 be f2 2e 15 46 b2 3d a0 b2 b8 1d 92 07>,
     macKeyVal: <Buffer d6 10 49 8e 7a b2 41 80 17 6f 22 05 00 b7 ca a5 8b 7e 6a a9 a0 77 65 ae 59 8d c0 19 33 bc ad 35>,
     absValidity: 2018-03-22T03:01:34.822Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer cd 03 1d c7 1c 48 f2 c8>
switching to HANDSHAKE_1_SENT
disconnected from auth
received auth hello!
{ authId: 502, nonce: <Buffer de 9b 0d 6f ba a5 9d f3> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: write after end
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.39:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 18 0.3888888888888889 1521601351009
connected to auth! from local port 56974
received auth hello!
{ authId: 502, nonce: <Buffer 00 9d ea 05 5e 34 16 9b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0f 8d 2d 0f c3 59 5d 48>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201209,
  cipherKeyVal: <Buffer 9a e9 73 40 6e f0 87 cf e3 cc c2 fc 30 ed 9e 9e>,
  macKeyVal: <Buffer 08 fd 49 59 7b ff 87 47 98 92 0d e6 0a eb 10 cf 6f d9 ee dd 64 2c 11 08 a3 41 fd ed cc 6b d3 c3>,
  absValidity: 2018-03-22T03:02:34.815Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.39',
  serverPort: 22100,
  sessionKey: 
   { id: 50201209,
     cipherKeyVal: <Buffer 9a e9 73 40 6e f0 87 cf e3 cc c2 fc 30 ed 9e 9e>,
     macKeyVal: <Buffer 08 fd 49 59 7b ff 87 47 98 92 0d e6 0a eb 10 cf 6f d9 ee dd 64 2c 11 08 a3 41 fd ed cc 6b d3 c3>,
     absValidity: 2018-03-22T03:02:34.815Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer e2 b4 5f 26 76 59 42 67>
switching to HANDSHAKE_1_SENT
disconnected from auth
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:02:42 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 18 0.4444444444444444 1521601363342
Handler: Error in secure comm - details: Connection with Auth timed out...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 19 0.42105263157894735 1521601411032
connected to auth! from local port 57152
received auth hello!
{ authId: 502, nonce: <Buffer 54 73 de 96 31 a4 06 fc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 69 8b 9d c9 a7 8e 8a 90>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201232,
  cipherKeyVal: <Buffer de 3e 8f 9e 2c 20 b4 24 13 00 10 81 f5 a8 67 22>,
  macKeyVal: <Buffer 4f a3 0d 3e a6 07 94 21 96 6d 1a 2a d5 dc 9b e2 7a d1 2c 34 2a 2b 52 01 17 be d1 29 6c 8f ea 5e>,
  absValidity: 2018-03-22T03:04:18.821Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.39',
  serverPort: 22100,
  sessionKey: 
   { id: 50201232,
     cipherKeyVal: <Buffer de 3e 8f 9e 2c 20 b4 24 13 00 10 81 f5 a8 67 22>,
     macKeyVal: <Buffer 4f a3 0d 3e a6 07 94 21 96 6d 1a 2a d5 dc 9b e2 7a d1 2c 34 2a 2b 52 01 17 be d1 29 6c 8f ea 5e>,
     absValidity: 2018-03-22T03:04:18.821Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 96 08 b4 e7 35 62 93 92>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:04:23 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 9 19 0.47368421052631576 1521601463483
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 20 0.45 1521601471036
connected to auth! from local port 57326
received auth hello!
{ authId: 502, nonce: <Buffer 0e 01 c3 59 96 b0 3d 66> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 61 7e 14 f0 e2 d6 fd 30>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201243,
  cipherKeyVal: <Buffer 57 a6 fc f4 51 df 0b 17 17 85 a2 65 2c c4 04 21>,
  macKeyVal: <Buffer ea 46 cd 73 05 0e 96 05 af 10 16 b0 b7 32 76 b7 bd 1f 52 57 d4 1f c2 e9 52 fc da 84 2a 1c b6 b1>,
  absValidity: 2018-03-22T03:05:14.839Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.39',
  serverPort: 22100,
  sessionKey: 
   { id: 50201243,
     cipherKeyVal: <Buffer 57 a6 fc f4 51 df 0b 17 17 85 a2 65 2c c4 04 21>,
     macKeyVal: <Buffer ea 46 cd 73 05 0e 96 05 af 10 16 b0 b7 32 76 b7 bd 1f 52 57 d4 1f c2 e9 52 fc da 84 2a 1c b6 b1>,
     absValidity: 2018-03-22T03:05:14.839Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer ce 25 8c c5 4e 50 cf b0>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.39:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 21 0.42857142857142855 1521601531036
connected to auth! from local port 57500
received auth hello!
{ authId: 502, nonce: <Buffer 10 b8 3f 3e c7 f5 f7 1e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 69 cc 50 d4 f0 91 fe 9d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201256,
  cipherKeyVal: <Buffer 2f d8 e4 81 c9 50 00 1d e8 a2 52 7d d8 2d 6c b9>,
  macKeyVal: <Buffer b5 a0 0b 0b f7 38 dd 48 c5 b8 89 a0 66 f7 5e 57 2e fd c4 5a 1b 85 b7 e2 86 62 ef a3 63 12 02 4e>,
  absValidity: 2018-03-22T03:06:02.819Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.39',
  serverPort: 22100,
  sessionKey: 
   { id: 50201256,
     cipherKeyVal: <Buffer 2f d8 e4 81 c9 50 00 1d e8 a2 52 7d d8 2d 6c b9>,
     macKeyVal: <Buffer b5 a0 0b 0b f7 38 dd 48 c5 b8 89 a0 66 f7 5e 57 2e fd c4 5a 1b 85 b7 e2 86 62 ef a3 63 12 02 4e>,
     absValidity: 2018-03-22T03:06:02.819Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.39:22100
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 22 0.4090909090909091 1521601591061
connected to auth! from local port 57662
received auth hello!
{ authId: 502, nonce: <Buffer da 62 22 ce 7f 2e e4 dc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9f d4 be 4d a4 90 bb b2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201270,
  cipherKeyVal: <Buffer d5 25 fa 2a 81 c6 ae 84 df c7 4a 4b 36 1a af a2>,
  macKeyVal: <Buffer 06 82 51 c1 ae 70 89 34 77 5d 7a 84 db 83 f5 bd 17 08 12 6b 54 76 25 c4 b1 70 94 25 86 8c eb 2c>,
  absValidity: 2018-03-22T03:06:58.818Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.39',
  serverPort: 22100,
  sessionKey: 
   { id: 50201270,
     cipherKeyVal: <Buffer d5 25 fa 2a 81 c6 ae 84 df c7 4a 4b 36 1a af a2>,
     macKeyVal: <Buffer 06 82 51 c1 ae 70 89 34 77 5d 7a 84 db 83 f5 bd 17 08 12 6b 54 76 25 c4 b1 70 94 25 86 8c eb 2c>,
     absValidity: 2018-03-22T03:06:58.818Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.39:22100
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 23 0.391304347826087 1521601651062
connected to auth! from local port 57822
received auth hello!
{ authId: 502, nonce: <Buffer f2 69 4a 80 ac f5 98 67> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4f 03 b3 2a 46 60 d0 ca>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201282,
  cipherKeyVal: <Buffer 4a 03 7a 4a 05 72 d1 ee b0 51 e4 c1 2c e1 45 65>,
  macKeyVal: <Buffer 58 aa 43 0e cd 20 c5 42 a3 5d 61 c7 1f d7 7f 43 59 b6 84 7b 23 e9 e3 55 27 09 69 b1 c8 3d 7b 80>,
  absValidity: 2018-03-22T03:07:54.826Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.39',
  serverPort: 22100,
  sessionKey: 
   { id: 50201282,
     cipherKeyVal: <Buffer 4a 03 7a 4a 05 72 d1 ee b0 51 e4 c1 2c e1 45 65>,
     macKeyVal: <Buffer 58 aa 43 0e cd 20 c5 42 a3 5d 61 c7 1f d7 7f 43 59 b6 84 7b 23 e9 e3 55 27 09 69 b1 c8 3d 7b 80>,
     absValidity: 2018-03-22T03:07:54.826Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.39:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 24 0.375 1521601711098
connected to auth! from local port 57980
received auth hello!
{ authId: 502, nonce: <Buffer 2c cb 4d 11 f0 4f bb e3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d4 33 9c 9c b8 3c 6a c6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201296,
  cipherKeyVal: <Buffer d1 c6 10 61 85 fa 98 a1 e9 fe 60 3c a6 a6 7f b8>,
  macKeyVal: <Buffer a8 55 94 f5 67 48 90 72 da 4a 4c 13 a6 34 c3 74 9d 9a 0b b8 57 7c ca bd a5 24 2b 46 73 d1 65 da>,
  absValidity: 2018-03-22T03:08:50.940Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.39',
  serverPort: 22100,
  sessionKey: 
   { id: 50201296,
     cipherKeyVal: <Buffer d1 c6 10 61 85 fa 98 a1 e9 fe 60 3c a6 a6 7f b8>,
     macKeyVal: <Buffer a8 55 94 f5 67 48 90 72 da 4a 4c 13 a6 34 c3 74 9d 9a 0b b8 57 7c ca bd a5 24 2b 46 73 d1 65 da>,
     absValidity: 2018-03-22T03:08:50.940Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.39:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 25 0.36 1521601771137
connected to auth! from local port 58142
received auth hello!
{ authId: 502, nonce: <Buffer 26 80 4f 4e 2c c0 e2 c1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5f 46 15 b6 ec fe 48 9b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201305,
  cipherKeyVal: <Buffer 48 6b 73 ee 31 cf 26 fe bf 41 02 37 34 a5 da 56>,
  macKeyVal: <Buffer 55 cb d6 2e 80 ee ec 0b 3e cd e8 82 9a 44 60 10 ae 8f 85 d2 92 11 c4 9a 06 a8 28 b5 c7 6b b8 bb>,
  absValidity: 2018-03-22T03:09:42.848Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.39',
  serverPort: 22100,
  sessionKey: 
   { id: 50201305,
     cipherKeyVal: <Buffer 48 6b 73 ee 31 cf 26 fe bf 41 02 37 34 a5 da 56>,
     macKeyVal: <Buffer 55 cb d6 2e 80 ee ec 0b 3e cd e8 82 9a 44 60 10 ae 8f 85 d2 92 11 c4 9a 06 a8 28 b5 c7 6b b8 bb>,
     absValidity: 2018-03-22T03:09:42.848Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.39:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 26 0.34615384615384615 1521601831185
connected to auth! from local port 58294
received auth hello!
{ authId: 502, nonce: <Buffer 60 1c 2e 6a c9 65 d5 7b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 27 ca 90 00 ab dd a0 c9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201319,
  cipherKeyVal: <Buffer 35 81 a0 d6 3f 33 fc c9 24 e6 b6 79 aa 39 78 36>,
  macKeyVal: <Buffer 48 0e 95 05 c8 fc ea 7c 55 09 bf 41 dd d2 15 24 21 c2 bc 37 07 a6 17 46 3f 11 a8 db 7f f2 6c 27>,
  absValidity: 2018-03-22T03:11:02.828Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.39',
  serverPort: 22100,
  sessionKey: 
   { id: 50201319,
     cipherKeyVal: <Buffer 35 81 a0 d6 3f 33 fc c9 24 e6 b6 79 aa 39 78 36>,
     macKeyVal: <Buffer 48 0e 95 05 c8 fc ea 7c 55 09 bf 41 dd d2 15 24 21 c2 bc 37 07 a6 17 46 3f 11 a8 db 7f f2 6c 27>,
     absValidity: 2018-03-22T03:11:02.828Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.39:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 27 0.3333333333333333 1521601891213
connected to auth! from local port 58468
received auth hello!
{ authId: 502, nonce: <Buffer c4 39 a8 06 5f 65 6f ac> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d4 f3 e4 0c 42 a3 25 bc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201327,
  cipherKeyVal: <Buffer f3 26 1a ed 98 bc 58 9b f4 d4 06 80 17 65 b0 12>,
  macKeyVal: <Buffer 00 af 0d ee f0 66 f2 93 6f b8 c1 5f 31 21 e9 a4 87 d8 38 23 13 42 0c 01 4d c1 2f 29 a8 11 8e f9>,
  absValidity: 2018-03-22T03:11:35.100Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.39',
  serverPort: 22100,
  sessionKey: 
   { id: 50201327,
     cipherKeyVal: <Buffer f3 26 1a ed 98 bc 58 9b f4 d4 06 80 17 65 b0 12>,
     macKeyVal: <Buffer 00 af 0d ee f0 66 f2 93 6f b8 c1 5f 31 21 e9 a4 87 d8 38 23 13 42 0c 01 4d c1 2f 29 a8 11 8e f9>,
     absValidity: 2018-03-22T03:11:35.100Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.39:22100
