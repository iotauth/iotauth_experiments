changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c407.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c407',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 75 4b ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521600222103
connected to auth! from local port 45564
received auth hello!
{ authId: 402, nonce: <Buffer 42 7b 7b 55 15 82 1e 7e> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 82 03 c2 89 bd 0f 28 e3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer ac bb ce 71 22 32 84 e1 d2 a4 fb 68 c6 bc 4e 6c>,
  macKeyVal: <Buffer e1 c1 40 41 05 c5 d5 57 dd 27 48 fe 59 c7 be 92 3a 03 94 6e f7 83 c8 b3 0b 01 2f 69 4d f3 c7 b3>,
  absValidity: 2018-03-21T03:43:42.263Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200361,
  cipherKeyVal: <Buffer e5 94 d6 79 5a 6f b8 e4 33 e4 b4 3c 6f 6a 56 df>,
  macKeyVal: <Buffer f6 3a 0c 20 82 17 9e e9 d1 e4 55 bb e4 bf 78 c2 6f 4d 3e 1d 51 f7 9e b1 9c fb 02 88 91 ee 25 f9>,
  absValidity: 2018-03-22T02:43:42.257Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200361,
     cipherKeyVal: <Buffer e5 94 d6 79 5a 6f b8 e4 33 e4 b4 3c 6f 6a 56 df>,
     macKeyVal: <Buffer f6 3a 0c 20 82 17 9e e9 d1 e4 55 bb e4 bf 78 c2 6f 4d 3e 1d 51 f7 9e b1 9c fb 02 88 91 ee 25 f9>,
     absValidity: 2018-03-22T02:43:42.257Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 28 2a 5e 8f 0b 19 34 a1>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:43:42 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521600223162
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521600282162
connected to auth! from local port 45714
received auth hello!
{ authId: 402, nonce: <Buffer a0 6f 14 f5 5e 0b ab 9a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5c f2 5f d0 cb db 6c db>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200368,
  cipherKeyVal: <Buffer a8 bb 8e 1a ca 56 25 54 10 e0 9f 6d 84 23 41 0a>,
  macKeyVal: <Buffer f8 ce e3 41 10 2d 7f 0b 1f 3a 25 58 26 8f 2f b2 a2 7e a4 30 b6 5f c1 db 80 d4 4f f5 8f 8c e4 fd>,
  absValidity: 2018-03-22T02:44:42.322Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200368,
     cipherKeyVal: <Buffer a8 bb 8e 1a ca 56 25 54 10 e0 9f 6d 84 23 41 0a>,
     macKeyVal: <Buffer f8 ce e3 41 10 2d 7f 0b 1f 3a 25 58 26 8f 2f b2 a2 7e a4 30 b6 5f c1 db 80 d4 4f f5 8f 8c e4 fd>,
     absValidity: 2018-03-22T02:44:42.322Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 45 b1 a2 60 ff 44 c9 d4>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:44:43 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521600283301
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521600342183
connected to auth! from local port 45970
received auth hello!
{ authId: 402, nonce: <Buffer 63 7f 5a 04 89 d9 2e 19> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fb 43 3f 72 8f 91 4e b3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200375,
  cipherKeyVal: <Buffer dc 29 54 9e ed db 2b cc d5 a2 a4 2f 56 38 55 65>,
  macKeyVal: <Buffer bb b7 70 da c2 89 36 14 e1 7e 16 b7 77 55 4a 18 17 88 db f9 8c 19 5d 63 f8 ec 3d 17 b9 2a f6 8a>,
  absValidity: 2018-03-22T02:45:42.370Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200375,
     cipherKeyVal: <Buffer dc 29 54 9e ed db 2b cc d5 a2 a4 2f 56 38 55 65>,
     macKeyVal: <Buffer bb b7 70 da c2 89 36 14 e1 7e 16 b7 77 55 4a 18 17 88 db f9 8c 19 5d 63 f8 ec 3d 17 b9 2a f6 8a>,
     absValidity: 2018-03-22T02:45:42.370Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 3d 94 b7 88 25 ea 5b 48>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:45:43 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521600343458
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521600402242
connected to auth! from local port 46240
received auth hello!
{ authId: 402, nonce: <Buffer a9 db 8b 2f 59 5a 90 2c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e8 7e e8 ca 7b d6 b0 20>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200382,
  cipherKeyVal: <Buffer 7a ef 0f 15 52 77 8a 48 bf 05 20 54 fc 34 0a 3c>,
  macKeyVal: <Buffer b1 d6 73 fd ec ce da 00 fd cd a3 3a e9 f7 7f ec 21 1b 0c 95 5c 1e ba 50 6c da 40 44 12 4a 6d ef>,
  absValidity: 2018-03-22T02:46:42.395Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200382,
     cipherKeyVal: <Buffer 7a ef 0f 15 52 77 8a 48 bf 05 20 54 fc 34 0a 3c>,
     macKeyVal: <Buffer b1 d6 73 fd ec ce da 00 fd cd a3 3a e9 f7 7f ec 21 1b 0c 95 5c 1e ba 50 6c da 40 44 12 4a 6d ef>,
     absValidity: 2018-03-22T02:46:42.395Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer b0 48 58 a1 e6 78 3a bf>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:46:42 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521600403292
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521600462297
connected to auth! from local port 46510
received auth hello!
{ authId: 402, nonce: <Buffer a9 49 44 a9 31 51 ca b1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2a ac 69 08 56 24 50 97>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200389,
  cipherKeyVal: <Buffer 0b 7b 16 61 22 bc db 6f ed d0 fb 65 15 09 3d 2e>,
  macKeyVal: <Buffer 25 78 ea 01 0b 73 98 c1 3b c4 8c 15 d0 83 2e 69 5b 0f 2d 1f 5b 64 12 39 6a 1a 88 3d ad e1 94 17>,
  absValidity: 2018-03-22T02:47:42.446Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200389,
     cipherKeyVal: <Buffer 0b 7b 16 61 22 bc db 6f ed d0 fb 65 15 09 3d 2e>,
     macKeyVal: <Buffer 25 78 ea 01 0b 73 98 c1 3b c4 8c 15 d0 83 2e 69 5b 0f 2d 1f 5b 64 12 39 6a 1a 88 3d ad e1 94 17>,
     absValidity: 2018-03-22T02:47:42.446Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer e4 65 a8 b1 69 3a 62 fa>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:47:43 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521600463476
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521600522353
connected to auth! from local port 46780
received auth hello!
{ authId: 402, nonce: <Buffer b8 50 8e 55 36 34 84 46> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cb 0e be 67 f4 01 c0 cd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200396,
  cipherKeyVal: <Buffer 46 b6 cb aa cc 0d e7 00 d4 40 7e b3 3d cc e9 9a>,
  macKeyVal: <Buffer 5d c3 de eb 72 d6 97 21 e9 cd 1a fd 73 a6 2b 6a fa cb db 30 51 ef 19 a7 0d 81 1f c9 6c b8 0e aa>,
  absValidity: 2018-03-22T02:48:42.496Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200396,
     cipherKeyVal: <Buffer 46 b6 cb aa cc 0d e7 00 d4 40 7e b3 3d cc e9 9a>,
     macKeyVal: <Buffer 5d c3 de eb 72 d6 97 21 e9 cd 1a fd 73 a6 2b 6a fa cb db 30 51 ef 19 a7 0d 81 1f c9 6c b8 0e aa>,
     absValidity: 2018-03-22T02:48:42.496Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 05 83 54 ca 1b cc 2e 99>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:48:43 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521600523475
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521600582412
connected to auth! from local port 47050
received auth hello!
{ authId: 402, nonce: <Buffer 85 b6 50 a3 97 2d 22 b2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e2 e4 13 7b f2 5b 74 3a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200403,
  cipherKeyVal: <Buffer c2 10 26 57 4e a3 f8 4f 74 f7 bb 50 2c 3c 1a 5a>,
  macKeyVal: <Buffer 99 e3 5e c0 a0 e3 f5 d3 8d 48 d2 75 18 9d 31 13 14 23 73 5f dd f9 ac f4 3b b4 6a 70 e0 a6 ff 71>,
  absValidity: 2018-03-22T02:49:42.546Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200403,
     cipherKeyVal: <Buffer c2 10 26 57 4e a3 f8 4f 74 f7 bb 50 2c 3c 1a 5a>,
     macKeyVal: <Buffer 99 e3 5e c0 a0 e3 f5 d3 8d 48 d2 75 18 9d 31 13 14 23 73 5f dd f9 ac f4 3b b4 6a 70 e0 a6 ff 71>,
     absValidity: 2018-03-22T02:49:42.546Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 3f 09 40 bf 70 10 64 5e>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:49:43 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521600583365
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521600642451
connected to auth! from local port 47320
received auth hello!
{ authId: 402, nonce: <Buffer 3c 12 19 ce 12 0e 7e e8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e3 ad 49 21 4f 95 7c b0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200410,
  cipherKeyVal: <Buffer 1c c1 ee d3 d4 cc 27 d4 d6 7e e2 f8 2c 89 65 4b>,
  macKeyVal: <Buffer b8 42 da fc 5c fd a2 e0 1c ae e7 67 e1 46 d8 86 ff bf bf 55 03 ba 77 71 c4 9b 00 c9 c0 74 83 06>,
  absValidity: 2018-03-22T02:50:42.589Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200410,
     cipherKeyVal: <Buffer 1c c1 ee d3 d4 cc 27 d4 d6 7e e2 f8 2c 89 65 4b>,
     macKeyVal: <Buffer b8 42 da fc 5c fd a2 e0 1c ae e7 67 e1 46 d8 86 ff bf bf 55 03 ba 77 71 c4 9b 00 c9 c0 74 83 06>,
     absValidity: 2018-03-22T02:50:42.589Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 3f 3a 11 86 6f 7b 2d 52>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:50:43 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 8 1 1521600643512
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 9 0.8888888888888888 1521600702509
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 10 0.8 1521600762520
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.3:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 11 0.7272727272727273 1521600822528
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 39602
received auth hello!
{ authId: 502, nonce: <Buffer 1c 2e 29 c4 4f e7 80 7c> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 12 0.6666666666666666 1521600882538
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 39826
received auth hello!
{ authId: 502, nonce: <Buffer b7 ce 2e 77 18 37 3d 87> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 13 0.6153846153846154 1521600942545
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.6:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 14 0.5714285714285714 1521601002549
failure in connection with Auth : authFailureCount: 6
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 2
to: 3
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 49748
received auth hello!
{ authId: 401, nonce: <Buffer 54 16 b6 f4 db 48 32 e3> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth401',
     commonName: '10.0.1.1' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth402',
     commonName: '10.0.0.2' },
  serial: '0162466F80A3',
  notBefore: 2018-03-21T02:40:35.000Z,
  notAfter: 2018-03-22T02:42:15.000Z,
  subjectHash: 'de555cae',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '37:10:A7:B2:AF:72:07:DD:00:C3:52:3B:02:03:66:68:7C:94:F6:A3',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'B1D96D976344F70094AA7D00CFD0F6058B1B31F97C522A983DCB23C390F9190875BA7C64D5E5888B86F8FBB648A0578A448C8237E3471A64ED59A03226A81FB2D143B5D1B71755CE1746179065723893719601038056ABCE33D646915D78D23FCCCDAB70CDEB639AEA41A5AC90E02E3302A6EEA261EDEC33DAF9FF6E9D9AA13A87980386B0E5509FC1EC88DB6E99D090B087A95B3C78136AA98C511DF596BB516D5BEEA892745A9EBF372CC45AE13E88878E884DB48A986EB570DE84DB722811E539492023404AA567C0DE100C0C0E8B6B33FB2C63046063377803BC046949DBDCBCD85174D56D807C222E8E1C0DC97AA62D0B26CD1F36670A8CC0942EAA82E3',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.1' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 401,
  host: '10.0.1.1',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJGb4CjMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDIxETAPBgNVBAMMCDEwLjAuMC4yMB4XDTE4MDMy\nMTAyNDAzNVoXDTE4MDMyMjAyNDIxNVowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDQwMTERMA8GA1UEAwwIMTAuMC4xLjEwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQCx2W2XY0T3AJSqfQDP0PYFixsx+XxSKpg9yyPDkPkZCHW6fGTV\n5YiLhvj7tkigV4pEjII340caZO1ZoDImqB+y0UO10bcXVc4XRheQZXI4k3GWAQOA\nVqvOM9ZGkV140j/MzatwzetjmupBpayQ4C4zAqbuomHt7DPa+f9unZqhOoeYA4aw\n5VCfweyI226Z0JCwh6lbPHgTaqmMUR31lrtRbVvuqJJ0Wp6/NyzEWuE+iIeOiE20\niphutXDehNtyKBHlOUkgI0BKpWfA3hAMDA6LazP7LGMEYGM3eAO8BGlJ29y82FF0\n1W2AfCIujhwNyXqmLQsmzR82ZwqMwJQuqoLjAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQEwDQYJKoZIhvcNAQELBQADggEBAEPVaPffC1iepsTjpEOouJPglNveYZfR\nAutXaECRu31K44JmO4f/lP2azDdQwy/mhbwzdyglcxqjukNFXdpUTtYaI07xx0VW\nbEwm90xTzBa0j2ScYAVRL+aYDsXGxsh16SlPjN2qWmd0XRNLLt+XOeHISQIHQY2F\nr0mtWtc6zD7BDjKfgpGYc38FGMzNtRKXPDopU+7AVjHjgy1Fm+6JZ8KHV4wZen8y\n4TVyjgmbKGz58vhbC8/cNFgUWJ497+Q5mjiYtCbUoS3Yuasg/pPUypO2t76x0A/G\nXo62lm6YQmLDFBW8UnrrJrQit/TWGC8QfldS/tmiF1rpyFJqptE1DP0=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 3
to: 4
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 15 0.5333333333333333 1521601062557
connected to auth! from local port 49922
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 16 0.5 1521601122568
connected to auth! from local port 50120
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 17 0.47058823529411764 1521601182578
connected to auth! from local port 50310
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 18 0.4444444444444444 1521601242587
connected to auth! from local port 50488
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 19 0.42105263157894735 1521601302597
connected to auth! from local port 50662
received auth hello!
{ authId: 401, nonce: <Buffer 6b 6d c2 8f 9b 19 d4 ec> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 7b bc 0e ed 21 09 48 51>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 34 db 79 a1 00 44 6e 59 f9 ec 39 12 41 7d 71 e1>,
  macKeyVal: <Buffer 1b 86 ad b8 3a 5b a2 9f 77 30 3e 18 03 a5 5d 3f fc 56 88 e0 4a 11 2d aa 53 2d 81 a8 09 f4 01 54>,
  absValidity: 2018-03-21T04:01:50.249Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101281,
  cipherKeyVal: <Buffer 55 2b 50 25 c0 c3 01 64 4e fb 47 a7 45 1e c5 3f>,
  macKeyVal: <Buffer d7 9f 02 7a 92 4d 22 63 16 41 44 2a 28 e0 51 20 19 38 2b a8 dc 72 c5 72 26 97 5d ef c0 0c f7 f6>,
  absValidity: 2018-03-22T03:01:50.249Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40101281,
     cipherKeyVal: <Buffer 55 2b 50 25 c0 c3 01 64 4e fb 47 a7 45 1e c5 3f>,
     macKeyVal: <Buffer d7 9f 02 7a 92 4d 22 63 16 41 44 2a 28 e0 51 20 19 38 2b a8 dc 72 c5 72 26 97 5d ef c0 0c f7 f6>,
     absValidity: 2018-03-22T03:01:50.249Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 39 15 56 14 75 51 a6 d7>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 20 0.4 1521601362600
connected to auth! from local port 50836
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 21 0.38095238095238093 1521601422604
connected to auth! from local port 51014
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 22 0.36363636363636365 1521601482615
connected to auth! from local port 51188
Handler: Error in secure comm - details: Disconnected from auth before getting session key response
Handler: Error in secure comm - details: Disconnected from auth before getting session key response
Handler: Error in secure comm - details: Disconnected from auth before getting session key response
Handler: Error in secure comm - details: Disconnected from auth before getting session key response
Handler: Error in secure comm - details: Disconnected from auth before getting session key response
Handler: Error in secure comm - details: Disconnected from auth before getting session key response
Handler: Error in secure comm - details: Auth hello timedout ...
Handler: Error in secure comm - details: Disconnected from auth before getting session key response
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 23 0.34782608695652173 1521601542626
connected to auth! from local port 51358
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 24 0.3333333333333333 1521601602635
connected to auth! from local port 51518
received auth hello!
{ authId: 401, nonce: <Buffer e3 84 b7 71 0e 46 63 f4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 25 ff a5 16 ed 30 cc 70>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101340,
  cipherKeyVal: <Buffer 31 41 8e e9 95 0a c4 b5 11 7b a9 8d 29 ed 6a 0b>,
  macKeyVal: <Buffer 2f 67 e5 ad 6a b0 31 4c 30 53 05 24 4b 8e 38 5d 38 9d 62 be ba 59 4a a0 9f d3 5b bd ad b5 4f 29>,
  absValidity: 2018-03-22T03:06:50.330Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40101340,
     cipherKeyVal: <Buffer 31 41 8e e9 95 0a c4 b5 11 7b a9 8d 29 ed 6a 0b>,
     macKeyVal: <Buffer 2f 67 e5 ad 6a b0 31 4c 30 53 05 24 4b 8e 38 5d 38 9d 62 be ba 59 4a a0 9f d3 5b bd ad b5 4f 29>,
     absValidity: 2018-03-22T03:06:50.330Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 84 dc 27 98 02 10 f2 e5>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 25 0.32 1521601662638
connected to auth! from local port 51682
received auth hello!
{ authId: 401, nonce: <Buffer 33 b4 5a 8c 9a 30 a9 32> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b1 27 dd a6 c1 17 1b a9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101353,
  cipherKeyVal: <Buffer 37 de b0 72 be 76 e0 fe 7a e0 72 ba 53 89 02 be>,
  macKeyVal: <Buffer 38 32 95 0e b6 ec 1e 21 77 c7 f5 96 ce e7 b8 2e 4e 3e e9 e3 c3 12 45 3a 89 57 11 98 41 37 c4 f3>,
  absValidity: 2018-03-22T03:07:50.405Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40101353,
     cipherKeyVal: <Buffer 37 de b0 72 be 76 e0 fe 7a e0 72 ba 53 89 02 be>,
     macKeyVal: <Buffer 38 32 95 0e b6 ec 1e 21 77 c7 f5 96 ce e7 b8 2e 4e 3e e9 e3 c3 12 45 3a 89 57 11 98 41 37 c4 f3>,
     absValidity: 2018-03-22T03:07:50.405Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer b6 02 a9 56 26 c9 ca 43>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 26 0.3076923076923077 1521601722641
connected to auth! from local port 51838
received auth hello!
{ authId: 401, nonce: <Buffer e9 ac 14 e6 68 e1 f6 11> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 26 62 49 9d 48 5e bf 59>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101366,
  cipherKeyVal: <Buffer ad 79 35 5a cb 0d b8 74 40 06 8f d7 8f 90 55 bf>,
  macKeyVal: <Buffer b8 2c 63 15 31 ac 69 0a 77 ec 02 4d bd ba 28 80 71 bf 78 0c b3 a8 c4 56 1d 8b 02 bd 8b d8 3d 02>,
  absValidity: 2018-03-22T03:08:50.500Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40101366,
     cipherKeyVal: <Buffer ad 79 35 5a cb 0d b8 74 40 06 8f d7 8f 90 55 bf>,
     macKeyVal: <Buffer b8 2c 63 15 31 ac 69 0a 77 ec 02 4d bd ba 28 80 71 bf 78 0c b3 a8 c4 56 1d 8b 02 bd 8b d8 3d 02>,
     absValidity: 2018-03-22T03:08:50.500Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 8f a2 d2 e9 12 4c 6b 53>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 27 0.2962962962962963 1521601782644
connected to auth! from local port 51998
received auth hello!
{ authId: 401, nonce: <Buffer cc 44 f0 46 29 2f b6 13> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bb ee 23 0a ad 65 81 50>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101379,
  cipherKeyVal: <Buffer 29 a5 e7 77 2c 43 98 91 e3 b5 c8 ae 8f 92 3a 52>,
  macKeyVal: <Buffer de 41 47 a5 11 2e e4 1e 21 5d fe 3c f5 73 1c 77 5d b2 6f ec 69 c7 b8 d2 5e 72 f8 6d 72 94 ce 09>,
  absValidity: 2018-03-22T03:09:50.509Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40101379,
     cipherKeyVal: <Buffer 29 a5 e7 77 2c 43 98 91 e3 b5 c8 ae 8f 92 3a 52>,
     macKeyVal: <Buffer de 41 47 a5 11 2e e4 1e 21 5d fe 3c f5 73 1c 77 5d b2 6f ec 69 c7 b8 d2 5e 72 f8 6d 72 94 ce 09>,
     absValidity: 2018-03-22T03:09:50.509Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer c0 a0 8a dc 2d cb 7b a8>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 28 0.2857142857142857 1521601842646
connected to auth! from local port 52152
received auth hello!
{ authId: 401, nonce: <Buffer 97 a8 38 59 51 e0 af 6e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b8 3c 09 20 7f ac cc fc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101392,
  cipherKeyVal: <Buffer 1d 6f 92 b7 00 ea 30 59 3f eb d5 56 0d 09 90 7d>,
  macKeyVal: <Buffer 04 e0 1f 66 ce a8 0d 50 90 57 bb ee 5b 45 8d 44 4b 8e d5 7c ff 93 b1 d6 8f 31 49 d3 da cd 7a f1>,
  absValidity: 2018-03-22T03:10:50.536Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40101392,
     cipherKeyVal: <Buffer 1d 6f 92 b7 00 ea 30 59 3f eb d5 56 0d 09 90 7d>,
     macKeyVal: <Buffer 04 e0 1f 66 ce a8 0d 50 90 57 bb ee 5b 45 8d 44 4b 8e d5 7c ff 93 b1 d6 8f 31 49 d3 da cd 7a f1>,
     absValidity: 2018-03-22T03:10:50.536Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 20 ff 65 51 3e da d1 ad>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 29 0.27586206896551724 1521601902648
connected to auth! from local port 52326
