changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c412.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c412',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 31 7a ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521600238217
connected to auth! from local port 50182
received auth hello!
{ authId: 402, nonce: <Buffer 20 90 d5 25 55 67 48 cc> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 27 37 1f b3 02 2f 67 d5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer a2 f8 6d 04 e3 ea a6 3d a4 b2 32 97 70 92 f2 78>,
  macKeyVal: <Buffer 94 05 07 f1 43 aa 6e c2 a3 b2 1c e1 51 b4 cc 00 54 23 66 a0 e4 26 73 16 87 ee b8 83 70 0c a9 e3>,
  absValidity: 2018-03-21T03:43:59.224Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200366,
  cipherKeyVal: <Buffer 8f bc 08 89 16 19 db c8 ba 91 93 d8 6a f1 53 77>,
  macKeyVal: <Buffer 57 dc 66 0d 60 9b 96 92 64 35 a5 be 7e 8f 53 a7 3c 4e 2d ff a6 ac 6c c3 08 db 0e 01 51 14 6e 21>,
  absValidity: 2018-03-22T02:43:59.223Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200366,
     cipherKeyVal: <Buffer 8f bc 08 89 16 19 db c8 ba 91 93 d8 6a f1 53 77>,
     macKeyVal: <Buffer 57 dc 66 0d 60 9b 96 92 64 35 a5 be 7e 8f 53 a7 3c 4e 2d ff a6 ac 6c c3 08 db 0e 01 51 14 6e 21>,
     absValidity: 2018-03-22T02:43:59.223Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 0d dc 4b 68 92 14 1b ae>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:44:01 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521600241594
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521600298228
connected to auth! from local port 50362
received auth hello!
{ authId: 402, nonce: <Buffer 8e f3 eb 20 8d 18 a7 4a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1c 21 6b 6d 9d d7 68 d7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200373,
  cipherKeyVal: <Buffer 3d 0b 55 af 01 ca a5 56 f2 b5 80 d8 9b 8f 1e 80>,
  macKeyVal: <Buffer 77 96 e6 47 24 28 81 06 d9 66 41 e7 b6 b4 68 04 a8 98 2f 46 01 c0 36 05 21 10 d6 b7 d9 83 ae 3f>,
  absValidity: 2018-03-22T02:44:59.258Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200373,
     cipherKeyVal: <Buffer 3d 0b 55 af 01 ca a5 56 f2 b5 80 d8 9b 8f 1e 80>,
     macKeyVal: <Buffer 77 96 e6 47 24 28 81 06 d9 66 41 e7 b6 b4 68 04 a8 98 2f 46 01 c0 36 05 21 10 d6 b7 d9 83 ae 3f>,
     absValidity: 2018-03-22T02:44:59.258Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer ed 65 01 ac 66 63 cc 9c>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:45:01 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521600301814
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521600358285
connected to auth! from local port 50634
received auth hello!
{ authId: 402, nonce: <Buffer 85 52 79 58 e6 78 73 c2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1f 43 1c a6 8a c0 aa b9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200380,
  cipherKeyVal: <Buffer 44 27 e2 ed 44 f6 31 69 d8 50 ed 0c 0f f3 64 75>,
  macKeyVal: <Buffer 35 17 ca c5 da 7d 3d a3 b3 a7 04 7a f5 5e 18 f4 fa f0 30 d3 9e ae 50 37 02 26 52 d6 82 46 58 b4>,
  absValidity: 2018-03-22T02:45:59.270Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200380,
     cipherKeyVal: <Buffer 44 27 e2 ed 44 f6 31 69 d8 50 ed 0c 0f f3 64 75>,
     macKeyVal: <Buffer 35 17 ca c5 da 7d 3d a3 b3 a7 04 7a f5 5e 18 f4 fa f0 30 d3 9e ae 50 37 02 26 52 d6 82 46 58 b4>,
     absValidity: 2018-03-22T02:45:59.270Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer c8 da af 2c 0d 74 a9 b6>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:46:01 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521600361824
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521600418341
connected to auth! from local port 50904
received auth hello!
{ authId: 402, nonce: <Buffer 5b b2 74 54 d1 b8 80 3a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b3 68 b0 60 01 13 17 c3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200387,
  cipherKeyVal: <Buffer 7b be 58 33 b5 c2 74 45 25 4d 62 60 0d 43 d4 55>,
  macKeyVal: <Buffer 44 75 4a 0a 5e 57 29 5e bc 71 9b 31 1a e6 27 2f ad 14 28 53 97 75 ff 74 a0 af 48 c6 a9 0e 84 ca>,
  absValidity: 2018-03-22T02:46:59.348Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200387,
     cipherKeyVal: <Buffer 7b be 58 33 b5 c2 74 45 25 4d 62 60 0d 43 d4 55>,
     macKeyVal: <Buffer 44 75 4a 0a 5e 57 29 5e bc 71 9b 31 1a e6 27 2f ad 14 28 53 97 75 ff 74 a0 af 48 c6 a9 0e 84 ca>,
     absValidity: 2018-03-22T02:46:59.348Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer a0 7a 1a d1 61 27 c5 9c>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:47:01 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521600421951
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521600478397
connected to auth! from local port 51174
received auth hello!
{ authId: 402, nonce: <Buffer be 16 b9 b0 81 a1 a5 3d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 82 fe 1e 66 dd 47 01 99>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200394,
  cipherKeyVal: <Buffer 30 23 c9 ae 87 19 10 5a 31 2b e0 c0 2f 6e b1 29>,
  macKeyVal: <Buffer 96 91 3b 56 37 70 31 b7 ae b9 2e 42 8a 59 49 35 a2 00 7e c2 b0 a5 79 d6 8a 75 b1 d5 e5 88 f8 4f>,
  absValidity: 2018-03-22T02:47:59.388Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200394,
     cipherKeyVal: <Buffer 30 23 c9 ae 87 19 10 5a 31 2b e0 c0 2f 6e b1 29>,
     macKeyVal: <Buffer 96 91 3b 56 37 70 31 b7 ae b9 2e 42 8a 59 49 35 a2 00 7e c2 b0 a5 79 d6 8a 75 b1 d5 e5 88 f8 4f>,
     absValidity: 2018-03-22T02:47:59.388Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer cd 3c 3c 71 dc f5 e1 08>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:48:01 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521600481849
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521600538453
connected to auth! from local port 51444
received auth hello!
{ authId: 402, nonce: <Buffer 5f 72 62 9e 94 4d 68 10> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a6 71 a2 88 00 50 1d 0c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200401,
  cipherKeyVal: <Buffer d8 a7 7b de 8d e7 61 ac c0 d9 45 12 2e f1 74 a9>,
  macKeyVal: <Buffer 09 3d 9e e3 8c 2b b6 76 49 b2 d1 27 95 c4 ac 05 52 46 63 28 91 53 15 7c 59 98 6e 6e f3 55 04 66>,
  absValidity: 2018-03-22T02:48:59.459Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200401,
     cipherKeyVal: <Buffer d8 a7 7b de 8d e7 61 ac c0 d9 45 12 2e f1 74 a9>,
     macKeyVal: <Buffer 09 3d 9e e3 8c 2b b6 76 49 b2 d1 27 95 c4 ac 05 52 46 63 28 91 53 15 7c 59 98 6e 6e f3 55 04 66>,
     absValidity: 2018-03-22T02:48:59.459Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 11 25 2c cb 05 ef b6 f3>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:49:01 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521600541915
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521600598509
connected to auth! from local port 51714
received auth hello!
{ authId: 402, nonce: <Buffer db f0 e5 b4 13 07 63 68> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2b a2 cf cb 73 d3 e6 7e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200408,
  cipherKeyVal: <Buffer b1 be db 22 6a 37 74 f0 c3 d2 bd 89 29 3b 67 2b>,
  macKeyVal: <Buffer 26 4d 3c 17 50 4c 64 e3 41 30 8b f6 3e 1e f8 b8 1b 92 de dc 24 40 f7 67 23 00 c9 c8 3e 12 f1 94>,
  absValidity: 2018-03-22T02:49:59.537Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200408,
     cipherKeyVal: <Buffer b1 be db 22 6a 37 74 f0 c3 d2 bd 89 29 3b 67 2b>,
     macKeyVal: <Buffer 26 4d 3c 17 50 4c 64 e3 41 30 8b f6 3e 1e f8 b8 1b 92 de dc 24 40 f7 67 23 00 c9 c8 3e 12 f1 94>,
     absValidity: 2018-03-22T02:49:59.537Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer ef 0d 6c c9 b7 44 64 e9>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:50:01 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521600601963
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521600658565
connected to auth! from local port 51980
received auth hello!
{ authId: 402, nonce: <Buffer 6b fd e7 16 cc cc 13 a2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0c 23 39 d5 ff 1c 7a ee>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200415,
  cipherKeyVal: <Buffer 07 2f 6f 79 4d 3b db 13 2a 14 cb 76 ca b3 3f 60>,
  macKeyVal: <Buffer 66 bc 18 09 75 a9 e3 05 ba 1d bb 13 66 8b 61 39 e5 e6 26 1c f6 4c f8 9d 71 ae 79 0e 89 95 41 af>,
  absValidity: 2018-03-22T02:50:59.535Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200415,
     cipherKeyVal: <Buffer 07 2f 6f 79 4d 3b db 13 2a 14 cb 76 ca b3 3f 60>,
     macKeyVal: <Buffer 66 bc 18 09 75 a9 e3 05 ba 1d bb 13 66 8b 61 39 e5 e6 26 1c f6 4c f8 9d 71 ae 79 0e 89 95 41 af>,
     absValidity: 2018-03-22T02:50:59.535Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer d4 22 f2 7d 25 4c 2d 1f>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.15:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 9 0.7777777777777778 1521600718575
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 10 0.7 1521600778577
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 34488
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 11 0.6363636363636364 1521600838585
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 34698
/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902
            eventHandlers.onError('Error occurred in migration request: Disconnected from auth before getting migration response: ' + error);
                                                                                                                                      ^

ReferenceError: error is not defined
    at Socket.<anonymous> (/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902:135)
    at emitNone (events.js:91:20)
    at Socket.emit (events.js:188:7)
    at endReadableNT (_stream_readable.js:975:12)
    at _combinedTickCallback (internal/process/next_tick.js:80:11)
    at process._tickCallback (internal/process/next_tick.js:104:9)
