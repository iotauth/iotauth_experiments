changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c522.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c522',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 30 76 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521600334059
connected to auth! from local port 48170
received auth hello!
{ authId: 503, nonce: <Buffer d7 d5 2a 2f 7e d4 9b 77> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer cc 6c c5 4c 35 05 31 97>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer be d9 5c 40 81 7a 89 29 5b 24 7e cd 62 55 b2 55>,
  macKeyVal: <Buffer 0c a7 fe c2 b1 93 35 68 cd e6 75 59 ee 2d 4f a4 f0 74 2e 60 8d 1c cc 86 8d 71 38 69 32 c8 dd 0c>,
  absValidity: 2018-03-21T03:45:34.239Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300705,
  cipherKeyVal: <Buffer 28 76 13 17 cf 90 8f 01 43 54 0d e6 a3 72 d4 b8>,
  macKeyVal: <Buffer 35 8c 0f b4 f3 e9 6e 17 ff 96 7a 15 3c b5 07 48 71 d2 2c 3d 26 ac 04 80 3d 3e b3 de fe 13 a3 5f>,
  absValidity: 2018-03-22T02:45:34.239Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.40',
  serverPort: 22100,
  sessionKey: 
   { id: 50300705,
     cipherKeyVal: <Buffer 28 76 13 17 cf 90 8f 01 43 54 0d e6 a3 72 d4 b8>,
     macKeyVal: <Buffer 35 8c 0f b4 f3 e9 6e 17 ff 96 7a 15 3c b5 07 48 71 d2 2c 3d 26 ac 04 80 3d 3e b3 de fe 13 a3 5f>,
     absValidity: 2018-03-22T02:45:34.239Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 9b db 9f 50 53 8d fc 02>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:45:35 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521600335583
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521600394114
connected to auth! from local port 48440
received auth hello!
{ authId: 503, nonce: <Buffer 82 b7 9f f9 6b 64 55 6b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1b 21 a6 c9 84 43 bc f6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300710,
  cipherKeyVal: <Buffer 1b 5b e6 a6 ec 22 c7 0b bf 2e 83 40 8f de 17 c9>,
  macKeyVal: <Buffer fc 0f 75 08 df 10 12 53 95 3e 76 e4 65 63 b4 a5 7b a4 a2 28 27 29 a1 42 f8 f1 88 40 b8 59 f0 b0>,
  absValidity: 2018-03-22T02:46:34.277Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.40',
  serverPort: 22100,
  sessionKey: 
   { id: 50300710,
     cipherKeyVal: <Buffer 1b 5b e6 a6 ec 22 c7 0b bf 2e 83 40 8f de 17 c9>,
     macKeyVal: <Buffer fc 0f 75 08 df 10 12 53 95 3e 76 e4 65 63 b4 a5 7b a4 a2 28 27 29 a1 42 f8 f1 88 40 b8 59 f0 b0>,
     absValidity: 2018-03-22T02:46:34.277Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer dc 52 8c f6 aa 4a 29 12>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:46:35 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521600395636
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521600454170
connected to auth! from local port 48710
received auth hello!
{ authId: 503, nonce: <Buffer 00 1c 19 20 e9 7d e0 03> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cc 33 99 ae eb 63 6b 45>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300715,
  cipherKeyVal: <Buffer 1b 89 be 8f e7 dd f6 f1 fd 80 34 12 24 5a 94 42>,
  macKeyVal: <Buffer 0a 09 4b 96 42 04 78 13 7a 80 8f cf 78 84 80 ff 53 7b c7 3e 73 e8 7c 7e 56 2f ff 41 d3 02 8c 7c>,
  absValidity: 2018-03-22T02:47:34.300Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.40',
  serverPort: 22100,
  sessionKey: 
   { id: 50300715,
     cipherKeyVal: <Buffer 1b 89 be 8f e7 dd f6 f1 fd 80 34 12 24 5a 94 42>,
     macKeyVal: <Buffer 0a 09 4b 96 42 04 78 13 7a 80 8f cf 78 84 80 ff 53 7b c7 3e 73 e8 7c 7e 56 2f ff 41 d3 02 8c 7c>,
     absValidity: 2018-03-22T02:47:34.300Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 69 a9 35 d2 a7 95 4c 9a>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:47:35 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521600455741
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521600514225
connected to auth! from local port 48980
received auth hello!
{ authId: 503, nonce: <Buffer 31 5a 82 d1 62 b0 b7 a2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6d 79 6e 09 8e ea df dc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300720,
  cipherKeyVal: <Buffer f6 85 ee d7 14 f0 c0 1f 9e 6f fc 85 a6 74 03 49>,
  macKeyVal: <Buffer 9a ea f7 39 aa 0b 4e 9c 15 76 48 51 fd ef de ac 6c f4 e4 36 8d e2 3c 2a 83 46 1b 4b 6e 3b d8 0d>,
  absValidity: 2018-03-22T02:48:34.411Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.40',
  serverPort: 22100,
  sessionKey: 
   { id: 50300720,
     cipherKeyVal: <Buffer f6 85 ee d7 14 f0 c0 1f 9e 6f fc 85 a6 74 03 49>,
     macKeyVal: <Buffer 9a ea f7 39 aa 0b 4e 9c 15 76 48 51 fd ef de ac 6c f4 e4 36 8d e2 3c 2a 83 46 1b 4b 6e 3b d8 0d>,
     absValidity: 2018-03-22T02:48:34.411Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 48 e3 95 9f eb 3d 3c e5>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:48:35 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521600515682
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521600574282
connected to auth! from local port 49250
received auth hello!
{ authId: 503, nonce: <Buffer 2f cd a9 47 a3 f1 bb 21> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ad e9 ca 81 a0 e8 fd 39>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300725,
  cipherKeyVal: <Buffer 0c dc a7 a1 ec 4c 8e 11 67 3a 0f 88 10 75 f2 81>,
  macKeyVal: <Buffer 12 6e ea 87 0a 36 b5 1e c7 f8 b9 7f db fe 86 99 06 43 5b c0 79 6e 22 72 37 80 e4 bf 7d 3d 5d 40>,
  absValidity: 2018-03-22T02:49:34.442Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.40',
  serverPort: 22100,
  sessionKey: 
   { id: 50300725,
     cipherKeyVal: <Buffer 0c dc a7 a1 ec 4c 8e 11 67 3a 0f 88 10 75 f2 81>,
     macKeyVal: <Buffer 12 6e ea 87 0a 36 b5 1e c7 f8 b9 7f db fe 86 99 06 43 5b c0 79 6e 22 72 37 80 e4 bf 7d 3d 5d 40>,
     absValidity: 2018-03-22T02:49:34.442Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 80 5d f8 1d df 1e 0a 56>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:49:35 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521600575817
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521600634287
connected to auth! from local port 49520
received auth hello!
{ authId: 503, nonce: <Buffer 57 cd f8 c6 53 d8 e0 49> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d4 6a 90 23 0c 88 ce db>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300730,
  cipherKeyVal: <Buffer a2 ef 8e 9a 43 2b 14 5a c3 dd 92 f4 11 a4 78 cc>,
  macKeyVal: <Buffer 41 ea 06 01 46 a9 12 b9 fc e3 27 df 93 3b b2 1a a2 9d f9 61 09 b5 bb 25 1c 7e a7 33 78 4a 8c af>,
  absValidity: 2018-03-22T02:50:34.456Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.40',
  serverPort: 22100,
  sessionKey: 
   { id: 50300730,
     cipherKeyVal: <Buffer a2 ef 8e 9a 43 2b 14 5a c3 dd 92 f4 11 a4 78 cc>,
     macKeyVal: <Buffer 41 ea 06 01 46 a9 12 b9 fc e3 27 df 93 3b b2 1a a2 9d f9 61 09 b5 bb 25 1c 7e a7 33 78 4a 8c af>,
     absValidity: 2018-03-22T02:50:34.456Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer b3 90 f5 56 73 d1 b3 48>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:50:35 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521600635857
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521600694346
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect ECONNREFUSED 10.0.1.6:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 8 0.75 1521600754357
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
connected to auth! from local port 33274
received auth hello!
{ authId: 401, nonce: <Buffer 70 54 42 90 c4 b5 11 8b> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 9 0.6666666666666666 1521600814366
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
connected to auth! from local port 33422
received auth hello!
{ authId: 401, nonce: <Buffer de 35 0e cc b2 5e 2c f1> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 10 0.6 1521600874376
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
connected to auth! from local port 37678
received auth hello!
{ authId: 502, nonce: <Buffer 88 2f 27 4e 56 7f e8 cb> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth503',
     commonName: '10.0.0.6' },
  serial: '0162466F86EE',
  notBefore: 2018-03-21T02:40:36.000Z,
  notAfter: 2018-03-22T02:42:16.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'FD:ED:B6:7B:E1:1F:40:B6:A4:9F:CC:8D:82:E0:CF:DB:49:99:29:E5',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'FF6CB5202497CC77AF28EFDE774858E4FEF04355E5228E378962DF4235BE3683DAF9E38A7E22621D66B3B50166D897E97BF911F9E8FC09D686961AA39679014E5DDD27EA0F02DE853A41537DB5E37F33395E249F355C0D074419572E9856D1D598CAB2CD6951013DDCB0A163B943DFCD2694BE18B9B3892695B3052EBD9115D447293C83AF24A008794B842E4F0A6C2A8D0189612A600AA40A592603E43713C0ECCA681024E5EC429FAD09484B824919DF59C8BD488E0D372D2A3D8B99B6068E24BBBDA8F0BCDDBA806010E4A7181736DF08D4D1CFC16E26507C360EDCBFF1B5F4288CE304DE62E9696665C5108489AD7232658356998FF47C4F7E8A04225423',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJGb4buMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDMxETAPBgNVBAMMCDEwLjAuMC42MB4XDTE4MDMy\nMTAyNDAzNloXDTE4MDMyMjAyNDIxNlowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQD/bLUgJJfMd68o7953SFjk/vBDVeUijjeJYt9CNb42g9r544p+\nImIdZrO1AWbYl+l7+RH56PwJ1oaWGqOWeQFOXd0n6g8C3oU6QVN9teN/MzleJJ81\nXA0HRBlXLphW0dWYyrLNaVEBPdywoWO5Q9/NJpS+GLmziSaVswUuvZEV1EcpPIOv\nJKAIeUuELk8KbCqNAYlhKmAKpApZJgPkNxPA7MpoECTl7EKfrQlIS4JJGd9ZyL1I\njg03LSo9i5m2Bo4ku72o8LzduoBgEOSnGBc23wjU0c/BbiZQfDYO3L/xtfQojOME\n3mLpaWZlxRCEia1yMmWDVpmP9HxPfooEIlQjAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAAOpn4W0Vj6QyesFGVqgWa2PIvxur53e\nNkXt2+xrGfi4oKgz6mYzo2ZAvYtHm5QSLrL0MldxVWGKEwk55U5S3rXfkwt4vWYD\nv8JPHF3JrZ053T8d90BMx2/zi9SxU51/pJfZZdLdY+42BxBFIJvdPhfOu91B/hv4\nD1bP8dp+7Vn1Z3zCn45Aiewo9B1uxh3ihWdPYZsBXWcZq1WqqU7Bnd6sXajGHZnJ\nxRPrf2pChNGVmygojwy7uwhnncYUJBhYnkk/cF34MsZ4wBOZDzPQKd6ooUhdvDdY\nFsNBUZ9CM9IhXZSpyjd0pvaEUeDAsesFbneUAkJLkRNaHT4DFKQ1HEs=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 1
to: 2
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 11 0.5454545454545454 1521600934386
connected to auth! from local port 37858
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 12 0.5 1521600994397
connected to auth! from local port 38060
received auth hello!
{ authId: 502, nonce: <Buffer 0e 74 69 e2 5b 7c 59 f3> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 4f ad de fd ed b3 37 df>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer d9 1a 12 24 fa c2 27 24 80 3b e3 34 ea 32 5f d5>,
  macKeyVal: <Buffer be 91 99 d8 40 73 a9 ee 34 68 32 f9 f8 ff 10 85 aa ad 55 8e bb 52 c4 53 f8 a3 28 71 96 f1 c5 74>,
  absValidity: 2018-03-21T03:56:42.127Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201133,
  cipherKeyVal: <Buffer 95 6b c5 77 90 af 2c b4 b0 7b 1d 1b f9 12 7f 91>,
  macKeyVal: <Buffer 2f a4 05 77 94 cd f0 d8 f6 ef a0 07 8f 62 c9 62 fb 8a 65 79 99 5d 49 25 ee 8f 86 6f 17 e2 11 16>,
  absValidity: 2018-03-22T02:56:42.127Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.40',
  serverPort: 22100,
  sessionKey: 
   { id: 50201133,
     cipherKeyVal: <Buffer 95 6b c5 77 90 af 2c b4 b0 7b 1d 1b f9 12 7f 91>,
     macKeyVal: <Buffer 2f a4 05 77 94 cd f0 d8 f6 ef a0 07 8f 62 c9 62 fb 8a 65 79 99 5d 49 25 ee 8f 86 6f 17 e2 11 16>,
     absValidity: 2018-03-22T02:56:42.127Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer ed fa c3 08 46 12 28 45>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.40:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 13 0.46153846153846156 1521601054398
connected to auth! from local port 38268
received auth hello!
{ authId: 502, nonce: <Buffer e7 b5 c1 ea 1a 9a 5a da> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: write after end
received auth hello!
{ authId: 502, nonce: <Buffer 97 be a1 3f 9e 07 c5 cf> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 13 d8 70 72 12 5b 02 d6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201148,
  cipherKeyVal: <Buffer 82 91 64 d1 27 06 18 dd 19 66 b8 2f 9f 50 22 9e>,
  macKeyVal: <Buffer d3 f1 49 a6 ad 74 93 18 4c e2 74 27 64 a5 b3 23 3e 4f 32 0a 33 c3 18 a8 dc 1e fc c8 ef 50 f4 6f>,
  absValidity: 2018-03-22T02:57:42.256Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.40',
  serverPort: 22100,
  sessionKey: 
   { id: 50201148,
     cipherKeyVal: <Buffer 82 91 64 d1 27 06 18 dd 19 66 b8 2f 9f 50 22 9e>,
     macKeyVal: <Buffer d3 f1 49 a6 ad 74 93 18 4c e2 74 27 64 a5 b3 23 3e 4f 32 0a 33 c3 18 a8 dc 1e fc c8 ef 50 f4 6f>,
     absValidity: 2018-03-22T02:57:42.256Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 48 ad 75 e0 4a 29 73 e9>
switching to HANDSHAKE_1_SENT
disconnected from auth
disconnected from auth
Handler: Error in secure comm - details: Connection with Auth timed out...
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.40:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 14 0.42857142857142855 1521601114400
connected to auth! from local port 38458
received auth hello!
{ authId: 502, nonce: <Buffer cc 95 ce 04 4b c0 3e 77> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 68 f9 e6 c3 3c f1 a3 13>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201162,
  cipherKeyVal: <Buffer 19 96 79 79 a3 46 66 6a 99 eb b9 dc 2d 7e 9c 87>,
  macKeyVal: <Buffer eb 45 87 05 66 d7 e7 df 94 d8 33 c5 98 91 70 fa 98 26 c2 60 74 98 dd 88 1f d3 e1 ed aa 58 55 7f>,
  absValidity: 2018-03-22T02:58:42.062Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.40',
  serverPort: 22100,
  sessionKey: 
   { id: 50201162,
     cipherKeyVal: <Buffer 19 96 79 79 a3 46 66 6a 99 eb b9 dc 2d 7e 9c 87>,
     macKeyVal: <Buffer eb 45 87 05 66 d7 e7 df 94 d8 33 c5 98 91 70 fa 98 26 c2 60 74 98 dd 88 1f d3 e1 ed aa 58 55 7f>,
     absValidity: 2018-03-22T02:58:42.062Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 21 45 a5 ed ad 2a 7d 54>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.40:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 15 0.4 1521601174403
connected to auth! from local port 38650
received auth hello!
{ authId: 502, nonce: <Buffer 1d a5 fc 01 64 f5 02 5b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a4 38 1e c5 94 8e 60 b4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201176,
  cipherKeyVal: <Buffer 06 36 3e dc 80 90 d6 c6 d8 bb ac ac a4 a1 88 5e>,
  macKeyVal: <Buffer d3 7e 5a f2 6d 6c a1 59 81 bc e4 f1 9b 75 d3 44 79 42 d7 65 15 3a 0a d7 25 78 14 38 b7 0b a6 d9>,
  absValidity: 2018-03-22T02:59:42.202Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.40',
  serverPort: 22100,
  sessionKey: 
   { id: 50201176,
     cipherKeyVal: <Buffer 06 36 3e dc 80 90 d6 c6 d8 bb ac ac a4 a1 88 5e>,
     macKeyVal: <Buffer d3 7e 5a f2 6d 6c a1 59 81 bc e4 f1 9b 75 d3 44 79 42 d7 65 15 3a 0a d7 25 78 14 38 b7 0b a6 d9>,
     absValidity: 2018-03-22T02:59:42.202Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 87 51 fa 70 f8 e9 53 e4>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.40:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 16 0.375 1521601234406
connected to auth! from local port 38832
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 17 0.35294117647058826 1521601294416
connected to auth! from local port 39012
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 18 0.3333333333333333 1521601354427
connected to auth! from local port 39182
received auth hello!
{ authId: 502, nonce: <Buffer e0 6e b9 a8 62 49 11 51> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 49 c7 79 9b 9c 2c 05 dd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201210,
  cipherKeyVal: <Buffer e6 36 a8 00 26 69 49 27 c5 5f 2e 8d 13 c3 12 84>,
  macKeyVal: <Buffer 3c cd 4f 4f 98 e3 12 c4 05 b1 71 6d 4b 6d 72 ee 9e 63 4f 13 94 bb 4c e1 49 91 70 1e 30 ba cb 9b>,
  absValidity: 2018-03-22T03:02:38.097Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.40',
  serverPort: 22100,
  sessionKey: 
   { id: 50201210,
     cipherKeyVal: <Buffer e6 36 a8 00 26 69 49 27 c5 5f 2e 8d 13 c3 12 84>,
     macKeyVal: <Buffer 3c cd 4f 4f 98 e3 12 c4 05 b1 71 6d 4b 6d 72 ee 9e 63 4f 13 94 bb 4c e1 49 91 70 1e 30 ba cb 9b>,
     absValidity: 2018-03-22T03:02:38.097Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer d3 27 c0 b4 1b 07 82 7e>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:02:46 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 18 0.3888888888888889 1521601366708
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 19 0.3684210526315789 1521601414475
connected to auth! from local port 39356
received auth hello!
{ authId: 502, nonce: <Buffer 62 cf 7a cf 45 71 d4 1a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 54 90 9f 78 d8 44 d9 6a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201225,
  cipherKeyVal: <Buffer b5 04 e0 6a 53 9b ef bb 9e ba 4a fc 69 0f 46 47>,
  macKeyVal: <Buffer 5f 29 7a f2 b4 fe 9d 94 ec 94 6e 93 40 61 cd b0 23 8d 9f cb f7 2a 1c 26 94 6c 41 8a 0c a6 55 f8>,
  absValidity: 2018-03-22T03:03:42.342Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.40',
  serverPort: 22100,
  sessionKey: 
   { id: 50201225,
     cipherKeyVal: <Buffer b5 04 e0 6a 53 9b ef bb 9e ba 4a fc 69 0f 46 47>,
     macKeyVal: <Buffer 5f 29 7a f2 b4 fe 9d 94 ec 94 6e 93 40 61 cd b0 23 8d 9f cb f7 2a 1c 26 94 6c 41 8a 0c a6 55 f8>,
     absValidity: 2018-03-22T03:03:42.342Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 99 a2 d4 6b a8 32 ce ca>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:04:18 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 19 0.42105263157894735 1521601458661
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 20 0.4 1521601474490
connected to auth! from local port 39534
received auth hello!
{ authId: 502, nonce: <Buffer 9a 46 ee c3 19 10 d8 b9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 10 ce da ff ec 70 8b 58>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201238,
  cipherKeyVal: <Buffer 88 65 56 39 ea 2e 39 ca ca b7 49 a4 ec 6c 6e 4b>,
  macKeyVal: <Buffer b0 89 91 43 10 ad c2 b4 61 ba 88 c0 12 dd 94 59 08 0f dd 0a c8 b9 f6 f5 3f 5a 56 98 1c 73 64 c4>,
  absValidity: 2018-03-22T03:04:42.320Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.40',
  serverPort: 22100,
  sessionKey: 
   { id: 50201238,
     cipherKeyVal: <Buffer 88 65 56 39 ea 2e 39 ca ca b7 49 a4 ec 6c 6e 4b>,
     macKeyVal: <Buffer b0 89 91 43 10 ad c2 b4 61 ba 88 c0 12 dd 94 59 08 0f dd 0a c8 b9 f6 f5 3f 5a 56 98 1c 73 64 c4>,
     absValidity: 2018-03-22T03:04:42.320Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 08 11 16 58 24 84 d7 83>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:05:14 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 9 20 0.45 1521601514849
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 21 0.42857142857142855 1521601534510
connected to auth! from local port 39708
received auth hello!
{ authId: 502, nonce: <Buffer 62 a2 7c 30 5b e2 55 b1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 67 21 00 52 b7 f2 7f 3c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201253,
  cipherKeyVal: <Buffer 3e 51 0a e8 07 24 a6 d8 1f eb 66 62 31 d2 3a 1f>,
  macKeyVal: <Buffer 51 56 86 0a ee 06 37 11 af bb 72 79 19 0f f0 36 ff d8 56 42 bf 07 64 07 5a e3 38 a7 9d fd d1 75>,
  absValidity: 2018-03-22T03:05:50.395Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.40',
  serverPort: 22100,
  sessionKey: 
   { id: 50201253,
     cipherKeyVal: <Buffer 3e 51 0a e8 07 24 a6 d8 1f eb 66 62 31 d2 3a 1f>,
     macKeyVal: <Buffer 51 56 86 0a ee 06 37 11 af bb 72 79 19 0f f0 36 ff d8 56 42 bf 07 64 07 5a e3 38 a7 9d fd d1 75>,
     absValidity: 2018-03-22T03:05:50.395Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 35 3c a6 cd 96 99 b2 54>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:05:58 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 10 21 0.47619047619047616 1521601558675
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 10 22 0.45454545454545453 1521601594542
connected to auth! from local port 39870
received auth hello!
{ authId: 502, nonce: <Buffer f1 f6 2e 18 b4 96 22 64> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 61 30 c0 5c b4 4e 00 41>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201267,
  cipherKeyVal: <Buffer 15 66 89 64 98 08 05 89 79 60 39 22 98 d3 04 06>,
  macKeyVal: <Buffer 49 90 9c 54 3c 95 f9 bf c3 1e f9 ec 37 01 64 9e f5 fb 2e 83 39 06 1d 5a 43 24 ea 77 e4 40 19 11>,
  absValidity: 2018-03-22T03:06:50.354Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.40',
  serverPort: 22100,
  sessionKey: 
   { id: 50201267,
     cipherKeyVal: <Buffer 15 66 89 64 98 08 05 89 79 60 39 22 98 d3 04 06>,
     macKeyVal: <Buffer 49 90 9c 54 3c 95 f9 bf c3 1e f9 ec 37 01 64 9e f5 fb 2e 83 39 06 1d 5a 43 24 ea 77 e4 40 19 11>,
     absValidity: 2018-03-22T03:06:50.354Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer ba 19 cc a5 46 c0 90 41>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received auth hello!
{ authId: 502, nonce: <Buffer b0 4b a5 b0 e7 f6 ec 8f> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: write after end
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 10 23 0.43478260869565216 1521601654550
connected to auth! from local port 40028
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.40:undefined
received auth hello!
{ authId: 502, nonce: <Buffer f2 2b c3 67 3c ad 84 a2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f8 d9 6a 68 7b 96 c7 61>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201278,
  cipherKeyVal: <Buffer e8 3c 97 23 1c ad 97 d0 fc 69 b3 3e 51 8e 68 a4>,
  macKeyVal: <Buffer 8d f4 c0 c2 41 c5 93 72 50 78 58 4f e6 ba d7 a4 30 3b 4a 3f e0 fe 4d 0e 5e e4 6b 3c 90 a0 70 e7>,
  absValidity: 2018-03-22T03:07:42.309Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.40',
  serverPort: 22100,
  sessionKey: 
   { id: 50201278,
     cipherKeyVal: <Buffer e8 3c 97 23 1c ad 97 d0 fc 69 b3 3e 51 8e 68 a4>,
     macKeyVal: <Buffer 8d f4 c0 c2 41 c5 93 72 50 78 58 4f e6 ba d7 a4 30 3b 4a 3f e0 fe 4d 0e 5e e4 6b 3c 90 a0 70 e7>,
     absValidity: 2018-03-22T03:07:42.309Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 7f 8c 2b be 46 59 38 66>
switching to HANDSHAKE_1_SENT
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:07:50 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 11 23 0.4782608695652174 1521601670877
Handler: Error in secure comm - details: Connection with Auth timed out...
received auth hello!
{ authId: 502, nonce: <Buffer bf 93 e8 8d 63 e3 65 3e> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: write after end
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 11 24 0.4583333333333333 1521601714561
connected to auth! from local port 40184
received auth hello!
{ authId: 502, nonce: <Buffer 91 da da 78 b2 c7 16 31> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d6 f1 f3 ed 7a 75 c5 41>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201295,
  cipherKeyVal: <Buffer 3b a6 19 b1 43 f7 47 0e 36 4f f6 68 df 4d bc 34>,
  macKeyVal: <Buffer 9e 54 3a dd a5 25 c2 fb 87 34 0a fe 62 6d b8 60 a3 af f9 1f 2f 38 79 70 bf a0 87 1a e5 6f 30 4f>,
  absValidity: 2018-03-22T03:08:50.339Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.40',
  serverPort: 22100,
  sessionKey: 
   { id: 50201295,
     cipherKeyVal: <Buffer 3b a6 19 b1 43 f7 47 0e 36 4f f6 68 df 4d bc 34>,
     macKeyVal: <Buffer 9e 54 3a dd a5 25 c2 fb 87 34 0a fe 62 6d b8 60 a3 af f9 1f 2f 38 79 70 bf a0 87 1a e5 6f 30 4f>,
     absValidity: 2018-03-22T03:08:50.339Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer bc 0c b2 41 95 30 93 b6>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Connection with Auth timed out...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 11 25 0.44 1521601774605
connected to auth! from local port 40346
received auth hello!
{ authId: 502, nonce: <Buffer 07 ab 14 22 8e 20 a0 50> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ee 92 fd ff fc ed fa 32>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201304,
  cipherKeyVal: <Buffer d7 39 83 36 36 73 92 4f aa 7b 80 a5 37 2c 30 6b>,
  macKeyVal: <Buffer e9 22 df 5e 57 f6 c1 11 24 35 a4 cb ca a3 8b 9b 71 f9 66 d7 50 bc 5b c6 1b 70 25 5a f5 0c d7 34>,
  absValidity: 2018-03-22T03:09:38.336Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.40',
  serverPort: 22100,
  sessionKey: 
   { id: 50201304,
     cipherKeyVal: <Buffer d7 39 83 36 36 73 92 4f aa 7b 80 a5 37 2c 30 6b>,
     macKeyVal: <Buffer e9 22 df 5e 57 f6 c1 11 24 35 a4 cb ca a3 8b 9b 71 f9 66 d7 50 bc 5b c6 1b 70 25 5a f5 0c d7 34>,
     absValidity: 2018-03-22T03:09:38.336Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 04 f7 a0 8c a2 49 14 15>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.40:undefined
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:09:42 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 12 25 0.48 1521601782816
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: secure connection with the server closed.
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 12 26 0.46153846153846156 1521601834612
connected to auth! from local port 40502
received auth hello!
{ authId: 502, nonce: <Buffer 9c a5 53 87 49 74 49 38> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fa 9c 76 10 c0 af 3e 49>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201313,
  cipherKeyVal: <Buffer 89 d1 3a a8 18 13 15 c5 ae 39 db c3 2f 99 d3 a3>,
  macKeyVal: <Buffer 84 45 48 f1 61 1e 92 1b 17 1c 7d da 9f 1e 9b 59 fe a6 4a 1b 31 37 43 0d 71 9c c9 8d 55 8f 4e 88>,
  absValidity: 2018-03-22T03:10:38.331Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.40',
  serverPort: 22100,
  sessionKey: 
   { id: 50201313,
     cipherKeyVal: <Buffer 89 d1 3a a8 18 13 15 c5 ae 39 db c3 2f 99 d3 a3>,
     macKeyVal: <Buffer 84 45 48 f1 61 1e 92 1b 17 1c 7d da 9f 1e 9b 59 fe a6 4a 1b 31 37 43 0d 71 9c c9 8d 55 8f 4e 88>,
     absValidity: 2018-03-22T03:10:38.331Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 8f dc bc e4 0a d6 02 af>
switching to HANDSHAKE_1_SENT
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:10:42 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 13 26 0.5 1521601842793
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 13 27 0.48148148148148145 1521601894663
connected to auth! from local port 40672
received auth hello!
{ authId: 502, nonce: <Buffer 97 e1 6e ce a4 75 5e 65> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e7 76 60 fe 65 53 cf 73>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201329,
  cipherKeyVal: <Buffer a0 30 8b 32 16 50 e6 d8 86 a5 8e 57 49 22 95 89>,
  macKeyVal: <Buffer e1 9a d0 89 a7 3b e5 94 a3 85 51 23 f3 99 d1 0c a9 4b 90 d3 53 96 48 22 45 e0 36 9b db 4e cc e4>,
  absValidity: 2018-03-22T03:11:38.320Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.40',
  serverPort: 22100,
  sessionKey: 
   { id: 50201329,
     cipherKeyVal: <Buffer a0 30 8b 32 16 50 e6 d8 86 a5 8e 57 49 22 95 89>,
     macKeyVal: <Buffer e1 9a d0 89 a7 3b e5 94 a3 85 51 23 f3 99 d1 0c a9 4b 90 d3 53 96 48 22 45 e0 36 9b db 4e cc e4>,
     absValidity: 2018-03-22T03:11:38.320Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 95 a3 96 4c c2 53 81 fc>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:12:22 GMT+0000 (UTC)
switching to IN_COMM
