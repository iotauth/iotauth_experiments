changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s406.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's406',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 67 49 42 41 41 4b 43 41 51 45 41 73 33 ... > }
Handler: listening on port 22100
s406:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200362
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35730
received auth hello!
{ authId: 402, nonce: <Buffer 59 d3 19 8b bf 3d a0 f7> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 8c 44 29 b9 8b 97 fe 90>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 9a 6c 4a 05 b6 b0 7d 21 ca fb ff f4 9f ee 79 b9>,
  macKeyVal: <Buffer d6 c8 e0 2f fe 32 50 28 a2 02 7a c0 ba 2d b7 0d 59 63 e7 91 61 97 68 e2 13 94 ba be 21 94 bb 2f>,
  absValidity: 2018-03-21T03:43:45.983Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b4 12 4a 0b c2 bd 65 aa>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b4 12 4a 0b c2 bd 65 aa> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.50:50578',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200369
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35886
received auth hello!
{ authId: 402, nonce: <Buffer ad 05 49 3e 62 89 fb e3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 60 c3 d9 ef 9f bf 13 55>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8c 39 ec 06 b9 3e ba 8c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8c 39 ec 06 b9 3e ba 8c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.50:50734',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200376
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36148
received auth hello!
{ authId: 402, nonce: <Buffer ab 82 b2 be 9d 19 06 ab> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 29 4f ee 6d 97 93 a7 83>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bf a2 a8 dc ee 57 1b 4e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bf a2 a8 dc ee 57 1b 4e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.50:50996',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200383
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36418
received auth hello!
{ authId: 402, nonce: <Buffer ec 56 d3 a2 77 81 c1 26> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 30 75 d3 e1 d0 a8 d3 cb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2e be 7b c8 42 e8 d0 89>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2e be 7b c8 42 e8 d0 89> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.50:51266',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200390
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36688
received auth hello!
{ authId: 402, nonce: <Buffer 86 74 81 0d 18 60 d6 4a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ed a1 aa ae 2d 88 c8 23>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cf cc 97 7a 59 79 c1 2d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer cf cc 97 7a 59 79 c1 2d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.50:51536',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200397
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36958
received auth hello!
{ authId: 402, nonce: <Buffer d3 96 46 0d 8d f8 20 73> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a2 67 77 c2 42 06 6b 91>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3c a6 33 a1 d2 25 7b da>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 3c a6 33 a1 d2 25 7b da> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.50:51806',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200404
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37228
received auth hello!
{ authId: 402, nonce: <Buffer 67 d6 f9 4e 41 59 60 ef> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 52 c2 54 8a 7c 4c 2a 20>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a1 d8 7a 46 98 ad 78 cf>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a1 d8 7a 46 98 ad 78 cf> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.50:52076',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200411
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37498
received auth hello!
{ authId: 402, nonce: <Buffer bf 6c 91 fe 82 c2 77 d5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 22 95 97 c0 36 82 6f 6d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c6 14 38 73 7a 2e 6c 9d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c6 14 38 73 7a 2e 6c 9d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.50:52346',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
