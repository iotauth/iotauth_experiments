changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s415.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's415',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 67 49 42 41 41 4b 43 41 51 45 41 7a 43 ... > }
Handler: listening on port 22100
s415:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300573
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55188
received auth hello!
{ authId: 403, nonce: <Buffer 1d 25 f7 3b c7 37 a7 40> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 03 c8 57 e2 8f f4 1d fe>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 07 e1 81 76 e9 4a ee aa a0 a9 bc 67 04 47 bc 08>,
  macKeyVal: <Buffer 8c 52 35 af aa 25 14 3c 8b 75 9c 55 12 c6 91 2f c9 8c f7 70 db 76 e9 bf 62 43 c7 3a 1f b4 28 0a>,
  absValidity: 2018-03-21T03:44:15.887Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 41 a1 77 99 93 1f 80 a7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 41 a1 77 99 93 1f 80 a7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.59:47930',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300579
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55398
received auth hello!
{ authId: 403, nonce: <Buffer 86 bc 1d 9a 51 db ab 16> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 72 5e 08 f6 5f fb a6 fa>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b8 77 ad b9 a4 8b 52 d5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b8 77 ad b9 a4 8b 52 d5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.59:48140',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300585
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55670
received auth hello!
{ authId: 403, nonce: <Buffer 0f 23 a3 59 a6 5b dc 79> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 85 ae ee 6c 20 87 33 1b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 37 46 8d 78 f2 dc e6 be>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 37 46 8d 78 f2 dc e6 be> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.59:48412',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300591
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55940
received auth hello!
{ authId: 403, nonce: <Buffer bc c8 ff 68 c3 8d d4 15> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d0 d0 43 e7 60 5d 23 5c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ac 58 03 4a ea 54 d8 9c>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ac 58 03 4a ea 54 d8 9c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.59:48682',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300597
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56210
received auth hello!
{ authId: 403, nonce: <Buffer f6 db ef 2d bb ac 7c 82> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9c e6 00 13 4a 83 2c 90>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 41 57 0e 3d 5a 25 94 d3>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 41 57 0e 3d 5a 25 94 d3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.59:48952',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300603
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56480
received auth hello!
{ authId: 403, nonce: <Buffer da d4 6f 27 ba b1 f1 76> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 13 ba b0 cd 98 16 1a f9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 01 2e 5a 9f 52 e0 83 20>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 01 2e 5a 9f 52 e0 83 20> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.59:49222',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300609
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56750
received auth hello!
{ authId: 403, nonce: <Buffer 03 5d 5c 65 69 8a f2 73> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 89 5d b0 c3 5a 56 30 be>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 92 b6 fd 3b f0 63 ea aa>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 92 b6 fd 3b f0 63 ea aa> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.59:49492',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300615
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57012
received auth hello!
{ authId: 403, nonce: <Buffer f5 7a bc c3 96 3b 36 18> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3b e2 28 c4 70 10 8b ff>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bd df b3 5f c3 96 8a 94>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bd df b3 5f c3 96 8a 94> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.59:49754',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
