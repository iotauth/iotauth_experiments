changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s511.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's511',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 77 2f ... > }
Handler: listening on port 22100
s511:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201030
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36728
received auth hello!
{ authId: 502, nonce: <Buffer 8b 4e 0a 45 a4 41 8a fc> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer bb 9a e5 11 39 98 80 91>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 7c 73 5f d0 16 da bb 12 1f ee 2d 20 75 1c e3 e7>,
  macKeyVal: <Buffer e6 6a a3 eb ec 5b 24 e4 13 72 44 48 30 2b cd 1b e5 9b d7 a6 cc b6 47 90 5d e3 07 b3 f7 f8 f2 10>,
  absValidity: 2018-03-21T03:45:12.152Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4f 5c 34 94 51 7c 5d 42>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4f 5c 34 94 51 7c 5d 42> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.76:49012',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201037
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37000
received auth hello!
{ authId: 502, nonce: <Buffer 50 8e ff ab 39 dd 4e 6d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c6 57 ce 77 1f 87 54 af>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 83 32 6e 13 7f 24 b0 77>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 83 32 6e 13 7f 24 b0 77> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.76:49284',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201044
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37270
received auth hello!
{ authId: 502, nonce: <Buffer 1c 1d 4d 5e c3 22 8e 9c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 34 37 d2 fb 00 6f c3 e5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a0 ad f7 e7 31 d3 19 72>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a0 ad f7 e7 31 d3 19 72> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.76:49554',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201051
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37540
received auth hello!
{ authId: 502, nonce: <Buffer 1b 58 57 2c fd 7c 7a 0d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d3 74 7a 45 c0 9e 09 f7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ba c5 f1 a2 65 fe 72 b3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ba c5 f1 a2 65 fe 72 b3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.76:49824',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201058
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37810
received auth hello!
{ authId: 502, nonce: <Buffer a7 1b c4 25 50 98 5f d6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ec f4 33 e9 87 d3 7f db>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 37 e6 29 e9 10 80 0a 6a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 37 e6 29 e9 10 80 0a 6a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.76:50094',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201065
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38080
received auth hello!
{ authId: 502, nonce: <Buffer 41 1b 29 aa 6c e3 e5 a6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 39 91 36 67 6a 88 15 86>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bb d5 6f 6b f4 cd 65 e9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bb d5 6f 6b f4 cd 65 e9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.76:50364',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201072
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38342
received auth hello!
{ authId: 502, nonce: <Buffer 2f 86 c7 72 38 ba 6f 12> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4b 77 60 c8 50 8b 1f bf>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ac 10 4a c7 c4 9e 5c 70>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ac 10 4a c7 c4 9e 5c 70> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.76:50626',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201079
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38516
received auth hello!
{ authId: 502, nonce: <Buffer 81 66 28 c1 37 6a 10 44> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7f a8 92 00 55 14 06 0e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0b 81 58 9b de 28 35 79>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 0b 81 58 9b de 28 35 79> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.76:50800',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201086
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38706
received auth hello!
{ authId: 502, nonce: <Buffer 71 db 9e 73 36 32 65 c6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 82 67 a5 67 50 35 d5 3e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer df 85 fd 11 11 c6 fe 36>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer df 85 fd 11 11 c6 fe 36> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.76:50990',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201094
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38920
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 3a b6 d4 e2 0e e9 40 b4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e3 da 5e f0 3f 17 99 59>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b0 70 31 50 79 23 0f 9b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b0 70 31 50 79 23 0f 9b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.76:51204',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201110
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39140
received auth hello!
{ authId: 502, nonce: <Buffer f6 df 2f 49 50 4a 41 ae> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer aa 16 75 34 56 fa 0a 70>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 45 ac 00 f7 b7 4a ef af>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 45 ac 00 f7 b7 4a ef af> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.76:51424',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201125
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39342
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer f7 b0 d5 87 19 b4 f2 c8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e9 a4 d0 c0 db a8 1f 37>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5d 7a 93 81 b2 d8 3e a9>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 5d 7a 93 81 b2 d8 3e a9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.76:51626',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201169
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39936
received auth hello!
{ authId: 502, nonce: <Buffer 0d f7 4f 74 2d 77 da 74> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer de 47 94 64 b6 34 5e c6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 35 0f da eb aa 78 3d 38>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 35 0f da eb aa 78 3d 38> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.76:52220',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201183
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40122
received auth hello!
{ authId: 502, nonce: <Buffer ad 5c e8 46 70 2e 5e 65> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4f a0 b8 85 8d 9f 31 61>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0c 5b 7f be 39 ac 1c af>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 0c 5b 7f be 39 ac 1c af> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.76:52406',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201194
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40294
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
received auth hello!
{ authId: 502, nonce: <Buffer 1b 7c 1e 1a 4a 3a c0 b9> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: write after end
disconnected from auth
Handler: Error in server - details: Connection with Auth timed out...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201298
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41618
received auth hello!
{ authId: 502, nonce: <Buffer 4d 6a 16 35 a2 ef bf 65> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 80 09 02 f0 3e ab 42 76>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 11 8b 0f 87 c9 b4 27 05>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 11 8b 0f 87 c9 b4 27 05> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.76:53902',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
