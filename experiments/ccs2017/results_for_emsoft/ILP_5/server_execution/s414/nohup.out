changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s414.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's414',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 6c 46 ... > }
Handler: listening on port 22100
s414:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300570
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42178
received auth hello!
{ authId: 403, nonce: <Buffer 29 c2 20 1c 2e 94 e8 6d> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 97 cd e0 28 81 ee 02 14>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer b5 7d 3f 4d 82 82 ca b9 07 2c 7d b8 f8 e3 56 84>,
  macKeyVal: <Buffer 76 33 b8 22 f3 07 02 f1 1b c9 ee 07 2f 00 98 9a a8 68 dc 92 66 3a 44 11 e7 02 5e 58 60 96 cb de>,
  absValidity: 2018-03-21T03:44:05.717Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c8 25 24 30 49 4b 87 2c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c8 25 24 30 49 4b 87 2c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.56:42984',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300576
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42370
received auth hello!
{ authId: 403, nonce: <Buffer 18 92 b9 2b eb f3 7e f3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c3 d6 7a bc 6c 94 14 ba>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 78 20 9e e8 9d ed 58 ac>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 78 20 9e e8 9d ed 58 ac> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.56:43176',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300582
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42642
received auth hello!
{ authId: 403, nonce: <Buffer 79 9f 0c 08 c3 d6 63 fe> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 89 c8 56 c5 5b 49 0e 65>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 28 8a f2 73 74 dd 4c 20>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 28 8a f2 73 74 dd 4c 20> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.56:43448',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300588
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42912
received auth hello!
{ authId: 403, nonce: <Buffer cf af 66 37 40 70 69 70> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f8 be 44 f5 5a a8 93 a6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4a c0 a6 64 e6 91 96 ac>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4a c0 a6 64 e6 91 96 ac> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.56:43718',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300594
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43182
received auth hello!
{ authId: 403, nonce: <Buffer e2 99 9d 4b f0 64 15 5d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 80 c8 fc 57 3e cd ab 7c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 71 da 5e 2f b9 1e a9 1c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 71 da 5e 2f b9 1e a9 1c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.56:43988',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300600
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43452
received auth hello!
{ authId: 403, nonce: <Buffer 2f 96 7f 06 55 76 34 f2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 28 ee 08 29 55 04 cb 2d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 16 ef f3 25 1c 15 e4 4d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 16 ef f3 25 1c 15 e4 4d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.56:44258',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300606
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43722
received auth hello!
{ authId: 403, nonce: <Buffer 3e 54 80 29 64 8a c0 e3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f1 a0 2f 25 40 57 5d 5c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer aa 9a 8d cb 7d 55 c8 59>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer aa 9a 8d cb 7d 55 c8 59> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.56:44528',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300612
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43984
received auth hello!
{ authId: 403, nonce: <Buffer ea 06 02 b2 84 a9 ed a2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 62 b5 2b 5d 88 eb b8 8a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 34 84 ba 22 23 1a d9 d4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 34 84 ba 22 23 1a d9 d4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.56:44790',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
