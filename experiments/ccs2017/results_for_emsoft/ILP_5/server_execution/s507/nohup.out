changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s507.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's507',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 51 49 42 41 41 4b 43 41 51 45 41 71 58 ... > }
Handler: listening on port 22100
s507:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100594
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53184
received auth hello!
{ authId: 501, nonce: <Buffer bc af 4c 83 64 01 35 f7> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 2d ca 1b 86 0f 34 5c 53>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer bb 7b 43 99 68 d7 7d 7f 2d f2 9f 0d 24 c7 5b 25>,
  macKeyVal: <Buffer c2 fd 3a ca 4e 38 6f 47 12 50 42 4d 9a 0a 70 f8 11 0c 2a 1b 0b f0 98 ff 2b 71 ef bc 1b 7e 03 4c>,
  absValidity: 2018-03-21T03:44:55.784Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 01 3f 91 b3 34 80 25 31>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 01 3f 91 b3 34 80 25 31> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.71:38622',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100602
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53456
received auth hello!
{ authId: 501, nonce: <Buffer 00 a2 06 f3 b1 e2 c7 6e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a5 3e fa e1 51 52 74 33>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3a 71 03 18 72 93 83 73>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3a 71 03 18 72 93 83 73> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.71:38894',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100610
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53726
received auth hello!
{ authId: 501, nonce: <Buffer 7d cf 51 13 94 a9 61 b6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0d 4d f4 2d 13 bd 87 2f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2f 80 3f 8a 2d 84 b9 a4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2f 80 3f 8a 2d 84 b9 a4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.71:39164',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100618
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53996
received auth hello!
{ authId: 501, nonce: <Buffer 7e ab 0f 28 eb 39 3d 2b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ca 11 9d b5 1d 37 3a 52>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 84 09 53 9c 61 37 d7 a0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 84 09 53 9c 61 37 d7 a0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.71:39434',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100626
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54266
received auth hello!
{ authId: 501, nonce: <Buffer a4 3b 71 cd 1b 82 f6 77> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 19 98 9b 0e 2d 48 92 0b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 32 1b d4 7e 0c b1 14 ad>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 32 1b d4 7e 0c b1 14 ad> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.71:39704',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100634
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54536
received auth hello!
{ authId: 501, nonce: <Buffer d0 9a 20 81 7a e1 e9 b9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1e c2 41 c3 ee 71 56 23>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d9 4f 5e c0 69 20 ba 50>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer d9 4f 5e c0 69 20 ba 50> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.71:39974',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100642
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54802
received auth hello!
{ authId: 501, nonce: <Buffer eb be eb c0 70 8d 96 36> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fd fc f6 cd b2 96 3f 55>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ed 80 c3 8e 0b a3 2d 69>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ed 80 c3 8e 0b a3 2d 69> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.71:40240',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
