changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s411.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's411',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 73 61 ... > }
Handler: listening on port 22100
s411:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101128
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38938
received auth hello!
{ authId: 403, nonce: <Buffer d9 cd 84 83 e3 21 aa 45> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer bc 06 93 dc fc 8f 23 aa>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer b6 8f 69 c8 3b 06 2c 0f e0 0b 94 21 79 81 dc 10>,
  macKeyVal: <Buffer c3 55 e1 62 7b 4f a3 f2 44 d7 47 61 b4 8d c1 6c 68 4c f9 d4 2f 7e 1a 34 34 cb d2 af da 56 f8 5b>,
  absValidity: 2018-03-21T03:43:30.095Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 59 95 64 94 94 66 e7 c8>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 59 95 64 94 94 66 e7 c8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.45:41064',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101134
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39064
received auth hello!
{ authId: 403, nonce: <Buffer fc 30 5d 47 f4 75 eb 80> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2b c6 cb 9c 35 67 14 34>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c3 9f d4 b5 29 a8 d8 0e>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c3 9f d4 b5 29 a8 d8 0e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.45:41190',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101140
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39300
received auth hello!
{ authId: 403, nonce: <Buffer b9 ed d6 22 fa 5f b6 37> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 69 0f 6b e9 4b aa 33 bb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fb 59 d5 ef 81 56 b9 28>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fb 59 d5 ef 81 56 b9 28> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.45:41426',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101146
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39570
received auth hello!
{ authId: 403, nonce: <Buffer f6 8f 5a 5e 9a ff 43 27> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7c e1 ae 2d 45 83 a9 e3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d5 b2 4a ce bb 2b 35 93>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d5 b2 4a ce bb 2b 35 93> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.45:41696',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101152
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39840
received auth hello!
{ authId: 403, nonce: <Buffer 8a 80 3b 13 7a 25 67 c2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c4 45 be ab ff e2 bd 62>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9f 67 2a a5 2b 13 e6 5d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 9f 67 2a a5 2b 13 e6 5d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.45:41966',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101158
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40110
received auth hello!
{ authId: 403, nonce: <Buffer 08 f3 f9 a8 96 cc a1 97> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ff c2 57 4a 4d 3a fb 8f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d3 d8 be f4 05 46 a1 cb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d3 d8 be f4 05 46 a1 cb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.45:42236',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101164
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40380
received auth hello!
{ authId: 403, nonce: <Buffer 40 ec 9f e8 38 0f 9f af> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 77 99 ad f6 47 9f a2 82>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 23 78 d7 06 82 4c 30 51>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 23 78 d7 06 82 4c 30 51> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.45:42506',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101170
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40650
received auth hello!
{ authId: 403, nonce: <Buffer 90 6a 32 26 e6 7f f8 a6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4f 67 c4 21 93 ea 42 ae>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 93 af 13 22 e5 a2 da 17>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 93 af 13 22 e5 a2 da 17> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.45:42776',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101176
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect ECONNREFUSED 10.0.1.3:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101182
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.3:21100
Handler: Error in server - details: handshake2 timed out...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in server - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.6:21100
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in server - details: Error occurred in migration request: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101188
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.3:21100
connected to auth! from local port 50536
received auth hello!
{ authId: 401, nonce: <Buffer 8e 89 e8 29 d0 7a 0b 82> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth401',
     commonName: '10.0.1.1' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth403',
     commonName: '10.0.0.3' },
  serial: '0162466F81B3',
  notBefore: 2018-03-21T02:40:35.000Z,
  notAfter: 2018-03-22T02:42:15.000Z,
  subjectHash: 'de555cae',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '36:C6:27:93:B3:48:EA:66:1B:68:7B:29:4E:1C:2A:D8:95:5A:AB:FB',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'B1D96D976344F70094AA7D00CFD0F6058B1B31F97C522A983DCB23C390F9190875BA7C64D5E5888B86F8FBB648A0578A448C8237E3471A64ED59A03226A81FB2D143B5D1B71755CE1746179065723893719601038056ABCE33D646915D78D23FCCCDAB70CDEB639AEA41A5AC90E02E3302A6EEA261EDEC33DAF9FF6E9D9AA13A87980386B0E5509FC1EC88DB6E99D090B087A95B3C78136AA98C511DF596BB516D5BEEA892745A9EBF372CC45AE13E88878E884DB48A986EB570DE84DB722811E539492023404AA567C0DE100C0C0E8B6B33FB2C63046063377803BC046949DBDCBCD85174D56D807C222E8E1C0DC97AA62D0B26CD1F36670A8CC0942EAA82E3',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.1' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 401,
  host: '10.0.1.1',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJGb4GzMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDMxETAPBgNVBAMMCDEwLjAuMC4zMB4XDTE4MDMy\nMTAyNDAzNVoXDTE4MDMyMjAyNDIxNVowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDQwMTERMA8GA1UEAwwIMTAuMC4xLjEwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQCx2W2XY0T3AJSqfQDP0PYFixsx+XxSKpg9yyPDkPkZCHW6fGTV\n5YiLhvj7tkigV4pEjII340caZO1ZoDImqB+y0UO10bcXVc4XRheQZXI4k3GWAQOA\nVqvOM9ZGkV140j/MzatwzetjmupBpayQ4C4zAqbuomHt7DPa+f9unZqhOoeYA4aw\n5VCfweyI226Z0JCwh6lbPHgTaqmMUR31lrtRbVvuqJJ0Wp6/NyzEWuE+iIeOiE20\niphutXDehNtyKBHlOUkgI0BKpWfA3hAMDA6LazP7LGMEYGM3eAO8BGlJ29y82FF0\n1W2AfCIujhwNyXqmLQsmzR82ZwqMwJQuqoLjAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQEwDQYJKoZIhvcNAQELBQADggEBAHnC7SrUGcpPyQYMio9F9aahbGCCZSOs\nj4rWS75kAEIf7JXICiSWkKlMqGi+Xyqb4Cr5q+tr5Z4oGetdqVDdqMfvjhdQjRH/\n2s9PPidmI+yBw65IT8fV+c+niPbkWNwqfHtYSBY7DfunoLGwwo6vNhGssJFr7Mj/\nJcWY1Pc0NjWWy+bFFVe1H9gMl9Ci4p1JCERcQF9BKWOeoyzVRs7Vg28+T8hWayQC\nyoZxiUM0jw51iD/d/Wy2MY5r/owTH47Fh1L/A7u+Pa+WSecYPIuKkdp/dTPWR42u\ngdM2XE2jt7XRtm0t2HW6vs0rMIzrwP6K4OhhBdPZwf886LPLUOY0wtY=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 1
to: 2
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101196
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50736
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: Disconnected from auth before getting session key response
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101206
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50940
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101217
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51140
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101228
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51350
received auth hello!
{ authId: 401, nonce: <Buffer 2f 63 62 ef 07 fd b0 e2> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 68 1a e6 e5 f1 6b b7 2d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 76 6b 22 27 e4 11 c8 3c a6 b7 3e a0 08 00 5f a5>,
  macKeyVal: <Buffer 57 dc 87 78 5f 66 88 61 e7 74 a0 50 b5 5c 6b 60 6c 56 23 4f 3d 3d 8c 3b 53 68 2b b7 69 bf 95 d3>,
  absValidity: 2018-03-21T03:57:30.573Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e0 3e a2 9c b1 53 e6 6b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e0 3e a2 9c b1 53 e6 6b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.45:44208',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101239
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51546
received auth hello!
{ authId: 401, nonce: <Buffer c4 33 13 c9 b9 89 55 43> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 75 ca 67 ee be f0 14 fa>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 33 72 94 a9 ac 43 12 cb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 33 72 94 a9 ac 43 12 cb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.45:44404',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101250
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51738
received auth hello!
{ authId: 401, nonce: <Buffer 0d 38 29 c6 2b 71 2c b0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6e 93 2e f1 61 08 65 35>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0b 0f dd 30 cd 50 db 8e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0b 0f dd 30 cd 50 db 8e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.45:44596',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101262
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51916
received auth hello!
{ authId: 401, nonce: <Buffer bd 3b 64 91 6e 15 79 b7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 38 bc 8e df f6 b7 56 27>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 31 36 b4 8d 78 af a4 7f>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 31 36 b4 8d 78 af a4 7f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.45:44774',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101274
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52096
received auth hello!
{ authId: 401, nonce: <Buffer 2a 6c 72 e9 63 3d 43 ae> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bc 6e 02 2e 67 6a 26 97>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 05 64 52 e7 94 3d da 18>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 05 64 52 e7 94 3d da 18> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.45:44954',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101286
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52266
received auth hello!
{ authId: 401, nonce: <Buffer b5 d0 69 48 73 3a b8 90> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bb 39 63 26 00 b2 19 78>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bd 9c ff eb d1 75 69 aa>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bd 9c ff eb d1 75 69 aa> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.45:45124',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101297
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52444
received auth hello!
{ authId: 401, nonce: <Buffer 1b c0 40 f0 8b ce 6b a4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cd b7 0a 42 09 2a 0b c7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8f 32 dd 4c 94 ce b7 d3>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 8f 32 dd 4c 94 ce b7 d3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.45:45302',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101309
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52618
received auth hello!
{ authId: 401, nonce: <Buffer ed 8b c4 54 c5 e0 32 e2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 48 d5 27 15 05 b2 6d 84>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 40 f5 06 48 42 f6 f7 75>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 40 f5 06 48 42 f6 f7 75> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.45:45476',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Handler: Error in server - details: Disconnected from auth before getting session key response
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101321
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52802
Handler: Error in server - details: Disconnected from auth before getting session key response
received auth hello!
{ authId: 401, nonce: <Buffer 97 ac 75 ed 57 7a 07 6d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4a 8a d9 0a 1d db ec d4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 90 d4 83 4c 20 92 6c ea>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 90 d4 83 4c 20 92 6c ea> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.45:45660',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101334
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52954
received auth hello!
{ authId: 401, nonce: <Buffer c7 14 0b c1 01 0f 3b 8e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a5 f8 dd e9 bd 11 fc f1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4c da 94 13 f3 24 b9 af>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 4c da 94 13 f3 24 b9 af> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.45:45812',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101347
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53114
received auth hello!
{ authId: 401, nonce: <Buffer c6 b8 37 4d ff 54 6c ec> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8d 0e 21 fd a2 4b 4c 11>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2b 00 1f 7a 97 60 51 c5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2b 00 1f 7a 97 60 51 c5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.45:45972',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101360
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53272
received auth hello!
{ authId: 401, nonce: <Buffer 4b 9b be 6d fb b5 b0 a5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3a 7f 9d 58 a4 5d a6 e2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d5 5c 11 e0 2d 64 20 5c>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer d5 5c 11 e0 2d 64 20 5c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.45:46130',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101373
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53434
received auth hello!
{ authId: 401, nonce: <Buffer c7 c6 8b 33 85 d0 11 61> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 28 4a f8 db 85 af 06 c8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f2 d3 56 c0 55 8d 2e 0d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f2 d3 56 c0 55 8d 2e 0d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.45:46292',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101386
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53586
received auth hello!
{ authId: 401, nonce: <Buffer 4d 2a 49 77 47 0a c7 9d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 32 fe d4 7c 60 39 02 f7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1a 25 3c 9d d6 9b e2 e8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1a 25 3c 9d d6 9b e2 e8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.45:46444',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101399
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53760
received auth hello!
{ authId: 401, nonce: <Buffer b7 b3 fd e4 de c1 a3 b6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 78 0b bc be c4 6c 03 0b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 55 24 29 cb ca 96 5d 79>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 55 24 29 cb ca 96 5d 79> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.45:46618',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
