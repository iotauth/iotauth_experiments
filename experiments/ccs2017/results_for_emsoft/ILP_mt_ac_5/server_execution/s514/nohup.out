changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s514.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's514',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 51 49 42 41 41 4b 43 41 51 45 41 77 53 ... > }
Handler: listening on port 22100
s514:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300844
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42884
received auth hello!
{ authId: 503, nonce: <Buffer 01 d3 ce d2 e0 35 3c 09> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 49 9f 92 dc 11 cf 22 80>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 6c 33 dd 71 ef 3e 33 7f d8 52 7c 22 dd 8a f5 75>,
  macKeyVal: <Buffer 51 22 e9 f4 66 f4 c0 bb fb 30 c3 7f 67 be 40 bd 24 9e d0 dc c4 37 e4 93 06 25 c4 8d c8 7a 16 64>,
  absValidity: 2018-03-21T08:20:05.147Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 09 5d 24 7f ec 8f 5e 24>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 09 5d 24 7f ec 8f 5e 24> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.80:46094',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300849
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43154
received auth hello!
{ authId: 503, nonce: <Buffer 84 fd 22 58 ad 71 9d 6a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer eb 7c b8 54 85 6b 73 9c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e6 3e e0 84 fc 6c 34 3c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e6 3e e0 84 fc 6c 34 3c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.80:46364',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300854
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43424
received auth hello!
{ authId: 503, nonce: <Buffer b5 bf ff 72 9e 7c 75 62> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 18 d1 0e 61 c9 c6 f6 83>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a6 24 3d ae d1 de 32 de>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a6 24 3d ae d1 de 32 de> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.80:46634',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300859
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43694
received auth hello!
{ authId: 503, nonce: <Buffer 9c 13 d2 8a e6 ab 22 16> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ee 74 7c 73 ad 7c e3 94>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 96 2e 8e 31 86 11 39 a2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 96 2e 8e 31 86 11 39 a2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.80:46904',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300864
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43966
received auth hello!
{ authId: 503, nonce: <Buffer f4 db d8 96 ba d2 63 c0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 78 17 f2 fc de 26 f9 af>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer eb 67 76 b9 81 3f 7d bd>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer eb 67 76 b9 81 3f 7d bd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.80:47174',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300869
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44234
received auth hello!
{ authId: 503, nonce: <Buffer 8f 76 e8 6a fb d0 0a 94> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 49 55 5d cd 4e ab 3e aa>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer af c9 1b a4 7f ce f8 bc>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer af c9 1b a4 7f ce f8 bc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.80:47444',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300874
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44496
received auth hello!
{ authId: 503, nonce: <Buffer 70 9a 45 9b 0f b5 a8 0f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d8 ba 94 05 ba 1b 04 3c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6d 6b 9b 79 3a b4 01 f5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6d 6b 9b 79 3a b4 01 f5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.80:47706',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
