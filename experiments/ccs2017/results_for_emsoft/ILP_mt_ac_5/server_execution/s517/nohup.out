changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s517.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's517',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 77 79 ... > }
Handler: listening on port 22100
s517:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300847
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45230
received auth hello!
{ authId: 503, nonce: <Buffer e7 9b 14 75 4c 17 9c db> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 83 f0 9a d2 e8 ca c7 1f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 0f a4 4d ec dd 3b 7e 5a 4f 47 19 db da 02 01 0c>,
  macKeyVal: <Buffer 66 e0 c9 79 76 f4 ae 60 a7 24 9c 68 c4 13 4d 8a 51 d6 d0 0c a7 17 ab 09 84 c6 d7 ab 5b d5 32 c7>,
  absValidity: 2018-03-21T08:20:15.135Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c7 55 42 90 e5 c6 7a aa>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c7 55 42 90 e5 c6 7a aa> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.83:39696',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300852
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45500
received auth hello!
{ authId: 503, nonce: <Buffer 1e 78 39 fb 20 fb 89 83> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8d 56 82 be 2d 20 b5 0e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0f e8 25 d6 ff 24 33 6a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0f e8 25 d6 ff 24 33 6a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.83:39966',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300857
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45770
received auth hello!
{ authId: 503, nonce: <Buffer 61 fc 32 d5 73 06 5b 05> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b5 1d 66 b8 1b 81 c7 ba>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c4 f6 89 5a d3 62 ca 84>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c4 f6 89 5a d3 62 ca 84> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.83:40236',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300862
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46040
received auth hello!
{ authId: 503, nonce: <Buffer 45 17 7b 29 2f 29 3b 47> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ac 99 11 d9 06 27 0f 8b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5a 4d f9 a1 d4 55 d2 4b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5a 4d f9 a1 d4 55 d2 4b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.83:40506',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300867
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46310
received auth hello!
{ authId: 503, nonce: <Buffer 55 d2 41 09 cd 19 4c a6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b8 b9 68 e9 ff d8 b6 89>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8e 61 e7 52 82 93 81 68>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8e 61 e7 52 82 93 81 68> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.83:40776',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300872
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46580
received auth hello!
{ authId: 503, nonce: <Buffer 13 37 90 e2 21 10 0c 33> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e0 0e 66 b7 4c 8d 85 24>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5c 27 48 ab 69 2f 95 28>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5c 27 48 ab 69 2f 95 28> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.83:41046',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
