changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s410.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's410',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 35 5a ... > }
Handler: listening on port 22100
s410:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200365
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51942
received auth hello!
{ authId: 402, nonce: <Buffer f7 e8 3b f0 9c 12 d9 6c> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 22 09 e6 30 31 f1 08 9e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer e9 ab 0c 84 19 5f 3f 85 93 3d 61 61 19 39 19 0e>,
  macKeyVal: <Buffer 8e f3 f2 ad e0 95 71 86 6c b3 97 9d d7 08 c9 0a ca 42 a7 82 8c 77 1c 23 71 ac 78 31 4b 8f bb 0e>,
  absValidity: 2018-03-21T08:18:37.531Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer dd 9c 2e 7c 65 31 37 bd>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer dd 9c 2e 7c 65 31 37 bd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.53:54606',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200372
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52116
received auth hello!
{ authId: 402, nonce: <Buffer 50 aa f1 c4 b8 6b 81 01> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8e bf 4c a7 b8 6b 80 4e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 66 34 b6 3a 33 7e 23 53>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 66 34 b6 3a 33 7e 23 53> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.53:54780',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200379
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52388
received auth hello!
{ authId: 402, nonce: <Buffer 0d 93 ea 27 cb 66 d2 48> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 57 5d 7c 0d 13 d8 78 84>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cc 1f 75 cd 93 05 97 ed>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer cc 1f 75 cd 93 05 97 ed> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.53:55052',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200386
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52658
received auth hello!
{ authId: 402, nonce: <Buffer c2 09 79 a4 ec 0a f1 f5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cb 06 e9 9f 43 84 19 19>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 61 1f 02 7a 0d 6e ea bf>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 61 1f 02 7a 0d 6e ea bf> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.53:55322',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200393
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52928
received auth hello!
{ authId: 402, nonce: <Buffer a6 16 f3 7f a3 5f 6b 33> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 62 96 11 a6 37 6c 8e 2d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fe 04 e4 4b b4 83 3c 0f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fe 04 e4 4b b4 83 3c 0f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.53:55592',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200400
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53198
received auth hello!
{ authId: 402, nonce: <Buffer 7b 11 79 19 df bc 76 ff> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f3 8d 75 8e 9d 12 f6 51>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4d 82 76 2e a0 d9 c2 70>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4d 82 76 2e a0 d9 c2 70> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.53:55862',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200407
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53468
received auth hello!
{ authId: 402, nonce: <Buffer 6d 85 84 72 44 3a 50 85> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ff f0 48 f4 b3 fb 08 c5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2a cd 46 82 13 0f cb 3b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 2a cd 46 82 13 0f cb 3b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.53:56132',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200414
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53734
received auth hello!
{ authId: 402, nonce: <Buffer 2c 68 33 b3 83 c3 a2 f8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bb 89 db 85 ef e5 cd 8b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2f 91 60 d2 ab 7a d8 20>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2f 91 60 d2 ab 7a d8 20> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.53:56398',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
