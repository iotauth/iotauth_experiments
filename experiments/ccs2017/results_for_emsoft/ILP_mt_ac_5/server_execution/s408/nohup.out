changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s408.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's408',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 70 6f ... > }
Handler: listening on port 22100
s408:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200364
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35026
received auth hello!
{ authId: 402, nonce: <Buffer bf aa 08 a0 e8 5b bc b9> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer ae 04 5e 1c db 54 6b 30>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer e3 7e 06 7c 1c 09 23 2b 59 5a 47 1b 67 a2 9c 78>,
  macKeyVal: <Buffer 98 4e 35 32 d9 43 5c 80 28 6e 6a d9 17 8d 1b 71 48 48 84 04 d6 c3 51 41 47 2c b9 75 36 e1 a5 ad>,
  absValidity: 2018-03-21T08:18:33.508Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 33 eb d9 61 80 d4 40 d1>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 33 eb d9 61 80 d4 40 d1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.52:57282',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200366
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35038
received auth hello!
{ authId: 402, nonce: <Buffer 05 dd aa 87 53 8a 89 58> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c1 d6 10 06 8b 43 5d 66>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 35 7d 78 16 ba 26 3d 2a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 35 7d 78 16 ba 26 3d 2a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.54:32806',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200371
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35194
received auth hello!
{ authId: 402, nonce: <Buffer 94 42 d7 72 c5 19 70 3d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer da ec 8d fa aa bf 47 84>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fd fe 2d a2 b1 aa 5c 50>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer fd fe 2d a2 b1 aa 5c 50> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.52:57450',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200373
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35218
received auth hello!
{ authId: 402, nonce: <Buffer 20 a4 5f 7b 6e a1 70 49> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e0 22 cc 61 e5 ca 49 ad>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0b 12 03 02 92 a7 d3 4d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 0b 12 03 02 92 a7 d3 4d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.54:32986',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200378
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35466
received auth hello!
{ authId: 402, nonce: <Buffer 11 a5 20 e1 06 91 12 df> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6d a4 95 41 85 08 8b 61>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer df dc fe 01 f6 57 ba f1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer df dc fe 01 f6 57 ba f1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.52:57722',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200380
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35490
received auth hello!
{ authId: 402, nonce: <Buffer 1e 33 c7 9c e4 db 7e 85> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 02 1e bf 3c 95 06 ab 4d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 64 fd 92 2e 20 d8 d1 aa>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 64 fd 92 2e 20 d8 d1 aa> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.54:33258',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200385
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35736
received auth hello!
{ authId: 402, nonce: <Buffer 8d a8 84 68 13 ed a6 cb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ba 4a 4b cb 53 79 53 95>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 61 a9 41 94 7c be b5 51>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 61 a9 41 94 7c be b5 51> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.52:57992',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200387
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35760
received auth hello!
{ authId: 402, nonce: <Buffer 5d c8 0e 72 f0 27 c0 54> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a7 fd a3 a6 34 f9 d2 d3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1c 63 d1 1d df 2f 0a c8>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 1c 63 d1 1d df 2f 0a c8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.54:33528',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200392
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36006
received auth hello!
{ authId: 402, nonce: <Buffer 7c ab cb 8a fd fd be 84> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 75 ef 51 56 dd 3d 94 cd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d4 c2 d4 98 c5 f4 3c 6b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d4 c2 d4 98 c5 f4 3c 6b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.52:58262',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200394
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36030
received auth hello!
{ authId: 402, nonce: <Buffer 81 13 d2 2a 35 dc 58 30> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e4 ff f7 f6 2c af 79 0e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f1 c6 89 3b 83 de 47 56>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f1 c6 89 3b 83 de 47 56> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.54:33798',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200399
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36276
received auth hello!
{ authId: 402, nonce: <Buffer 0b 55 ba 4a d6 3a b9 c7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9c 28 e2 bd b7 33 42 8a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1f 90 a8 9d 78 30 20 63>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1f 90 a8 9d 78 30 20 63> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.52:58532',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200401
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36300
received auth hello!
{ authId: 402, nonce: <Buffer a0 de 83 da a9 8a b2 49> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ae e6 eb 63 51 23 43 b2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 02 30 50 b8 f0 27 9e 8b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 02 30 50 b8 f0 27 9e 8b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.54:34068',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200406
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36546
received auth hello!
{ authId: 402, nonce: <Buffer d8 ba 48 fc d7 06 10 db> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d8 e1 e6 a9 fb 26 d3 cc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 78 c8 65 f8 b5 1f 5e fd>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 78 c8 65 f8 b5 1f 5e fd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.52:58802',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200408
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36570
received auth hello!
{ authId: 402, nonce: <Buffer 3e 1d 54 a6 b6 43 97 98> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer eb af cd 4f 32 47 87 0e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e7 59 12 af ae bf 89 65>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e7 59 12 af ae bf 89 65> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.54:34338',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200413
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36812
received auth hello!
{ authId: 402, nonce: <Buffer 12 2f 11 4c ed e3 19 59> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b5 3e 64 9e 12 96 f7 24>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 50 02 fc dc 74 70 00 11>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 50 02 fc dc 74 70 00 11> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.52:59068',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200415
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36836
received auth hello!
{ authId: 402, nonce: <Buffer af a7 06 3d d9 9c 67 12> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ef 9e cf 6d 70 b6 f7 1c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f2 bb e8 cd bd 31 64 2d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f2 bb e8 cd bd 31 64 2d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.54:34604',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
