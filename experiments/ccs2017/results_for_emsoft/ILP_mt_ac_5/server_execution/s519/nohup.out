changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s519.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's519',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 67 49 42 41 41 4b 43 41 51 45 41 70 4b ... > }
Handler: listening on port 22100
s519:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400157
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55438
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400158
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55450
received auth hello!
{ authId: 504, nonce: <Buffer 09 3f c6 1a ff d6 d9 ee> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer ef 26 23 d9 88 5f ea 63>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 2c a6 c7 61 aa 10 07 47 41 e4 e7 81 16 89 1f f7>,
  macKeyVal: <Buffer 4c 8d 0b c2 a3 78 11 23 9f 78 94 f1 67 cc 13 67 0b d0 56 41 6a cb 2c b8 8d 2b b9 85 f6 92 47 44>,
  absValidity: 2018-03-21T08:20:32.005Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 05 81 33 1e a7 37 de 24>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 05 81 33 1e a7 37 de 24> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.86:35728',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer 5e 70 78 30 74 fd 61 76> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer c1 f8 99 7f 9b a7 31 35>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer d2 a2 23 1c 6f 61 7f 56 8f 7f 1b b5 55 0a 22 4c>,
  macKeyVal: <Buffer 24 47 d6 af 7a 3d 71 e2 9f e3 84 70 89 5a cd 7c 46 7b 26 b9 44 95 a5 21 f7 bd a8 2a 4d b3 bd c9>,
  absValidity: 2018-03-21T08:20:33.502Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a6 8b c6 81 43 fc a0 1f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a6 8b c6 81 43 fc a0 1f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.87:37008',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400163
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55706
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400164
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55720
received auth hello!
{ authId: 504, nonce: <Buffer 26 37 e6 01 dd 74 49 6a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 76 0c 22 81 5e 64 be 9a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a9 8f 1a eb 3d fc d5 a0>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer a9 8f 1a eb 3d fc d5 a0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.86:35998',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer fa da 70 f9 50 14 f8 57> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 30 33 6d 38 dd c3 6e 36>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9d c2 a2 75 2e 8f 7f 50>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9d c2 a2 75 2e 8f 7f 50> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.87:37280',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400169
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55976
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400170
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
received auth hello!
{ authId: 504, nonce: <Buffer b8 9e 2c d9 a7 4e ae 47> }
connected to auth! from local port 55992
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 94 a9 c6 40 c5 f3 be 41>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 50 28 6e ab e4 ba 11 d2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 50 28 6e ab e4 ba 11 d2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.86:36268',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer e8 46 ab 5b f9 cd 82 7b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0e f7 9a 8d 60 51 bf 5d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 13 b0 c1 e8 32 da 40 ff>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 13 b0 c1 e8 32 da 40 ff> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.87:37550',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400175
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56246
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400176
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
received auth hello!
{ authId: 504, nonce: <Buffer 49 17 c8 1d fc d4 82 75> }
connected to auth! from local port 56262
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e3 cf 29 f4 b2 55 5e f9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 50 c3 d3 6b 4b 53 28 a0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 50 c3 d3 6b 4b 53 28 a0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.86:36538',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer cf 35 0a 62 16 02 29 1e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer db 89 81 3f 16 af 67 2d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c7 20 be ae 42 84 01 d1>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c7 20 be ae 42 84 01 d1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.87:37820',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400181
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56514
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400182
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56532
received auth hello!
{ authId: 504, nonce: <Buffer cf 60 80 64 83 6b 52 0b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ae a7 30 79 e5 33 73 d0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bd bd 47 c5 fa d4 09 06>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bd bd 47 c5 fa d4 09 06> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.86:36806',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer 5d d2 b4 c4 9d 16 4c 98> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f7 dc 34 2c 35 80 df aa>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ab b6 b9 99 0e e2 fe 36>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ab b6 b9 99 0e e2 fe 36> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.87:38090',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400187
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56786
received auth hello!
{ authId: 504, nonce: <Buffer 1e d8 c8 02 e4 0d 72 d2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ce 33 59 1a d6 13 66 33>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f6 41 e4 e0 95 8f 20 d9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f6 41 e4 e0 95 8f 20 d9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.86:37078',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101051
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101062
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101063
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: handshake2 timed out...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in server - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.4:21100
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in server - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 3
Handler: Error in server - details: Error occurred in migration request: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 4
Handler: Error in server - details: Error occurred in migration request: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101072
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101073
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 37524
connected to auth! from local port 37526
received auth hello!
{ authId: 502, nonce: <Buffer 9a bc 4c 22 fa 1b ac 36> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth504',
     commonName: '10.0.0.7' },
  serial: '0162476AFF65',
  notBefore: 2018-03-21T07:15:17.000Z,
  notAfter: 2018-03-22T07:16:57.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '61:C1:C7:B1:BD:50:DF:AE:B3:DC:28:01:86:4E:2C:EE:CE:23:8B:36',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'AEEAB02ACD0C32937DD84F3EB43F6189EAF089B04CE490F227FEC1E1A42FF33AACC957083F15D2CFEBF0E484D5D2BD03DD21587B3DF0ADCF1F273CEB6D3ADD0C5BD72406DA2D4A379546AD8D1C72FF3DB6ECF5D19A3A100B89C7B659A65778923B085EE02B29C23C0BF27314DEEC84CC61B318C930EC82C3B5DB050AD2527763CDCB5CEE65C7B2D7C1052512A2B08B2601CA1A4E32273B811E50FD7E40A702A19D8D7DB1E27E4C4E0A2F783C9AE1F654053799A646075FDCF3A86C68C654BCCA093F1A4B4044DAAFAB0E1FA7692D70BA1D4DBF798207A97EFFA87E7F6BE94B5E3D49438D87392AA382C0493F6F6E59A3B858B64877C59B95478C667FEE6CD71D',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJHav9lMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDQxETAPBgNVBAMMCDEwLjAuMC43MB4XDTE4MDMy\nMTA3MTUxN1oXDTE4MDMyMjA3MTY1N1owYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQCu6rAqzQwyk33YTz60P2GJ6vCJsEzkkPIn/sHhpC/zOqzJVwg/\nFdLP6/DkhNXSvQPdIVh7PfCtzx8nPOttOt0MW9ckBtotSjeVRq2NHHL/Pbbs9dGa\nOhALice2WaZXeJI7CF7gKynCPAvycxTe7ITMYbMYyTDsgsO12wUK0lJ3Y83LXO5l\nx7LXwQUlEqKwiyYByhpOMic7gR5Q/X5ApwKhnY19seJ+TE4KL3g8muH2VAU3maZG\nB1/c86hsaMZUvMoJPxpLQETar6sOH6dpLXC6HU2/eYIHqX7/qH5/a+lLXj1JQ42H\nOSqjgsBJP29uWaO4WLZId8WblUeMZn/ubNcdAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBACe2PAi9o2kKTUP228GDbpOtgF8MwQKG\nbepu/R1JRI1kxyZp80ZWrBMwBLJQFqQcAKWgpkDA5oOsekfMAx/57+QV13uyw4Xd\nBjjsHZbTl69ld91MMYnPZSx1eiLus3HkazZdiSEic9QM9w4TbgXNoGqfk3EPE98R\nEVBF5AQQTDQcjhfcj9i84Jj2a3Yt3KkjrXhXOXCivMZ8PKX9PjtyxZPtpg8nrxad\nE9zSxk1D4YlkpdFEq+rg9XqrEMCRXS3Hd35B8hLvN6OM4bYOffBnNlNnO9k9FR6s\nMwVF3EK42/gNdc2mdXKS9M33HNd7PlGr0022kwF3Z/S+SR/pfOecvp0=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 1
to: 2
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 57 82 b1 53 78 90 68 eb> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth504',
     commonName: '10.0.0.7' },
  serial: '0162476AFF65',
  notBefore: 2018-03-21T07:15:17.000Z,
  notAfter: 2018-03-22T07:16:57.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '61:C1:C7:B1:BD:50:DF:AE:B3:DC:28:01:86:4E:2C:EE:CE:23:8B:36',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'AEEAB02ACD0C32937DD84F3EB43F6189EAF089B04CE490F227FEC1E1A42FF33AACC957083F15D2CFEBF0E484D5D2BD03DD21587B3DF0ADCF1F273CEB6D3ADD0C5BD72406DA2D4A379546AD8D1C72FF3DB6ECF5D19A3A100B89C7B659A65778923B085EE02B29C23C0BF27314DEEC84CC61B318C930EC82C3B5DB050AD2527763CDCB5CEE65C7B2D7C1052512A2B08B2601CA1A4E32273B811E50FD7E40A702A19D8D7DB1E27E4C4E0A2F783C9AE1F654053799A646075FDCF3A86C68C654BCCA093F1A4B4044DAAFAB0E1FA7692D70BA1D4DBF798207A97EFFA87E7F6BE94B5E3D49438D87392AA382C0493F6F6E59A3B858B64877C59B95478C667FEE6CD71D',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.7',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJHav9lMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDQxETAPBgNVBAMMCDEwLjAuMC43MB4XDTE4MDMy\nMTA3MTUxN1oXDTE4MDMyMjA3MTY1N1owYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQCu6rAqzQwyk33YTz60P2GJ6vCJsEzkkPIn/sHhpC/zOqzJVwg/\nFdLP6/DkhNXSvQPdIVh7PfCtzx8nPOttOt0MW9ckBtotSjeVRq2NHHL/Pbbs9dGa\nOhALice2WaZXeJI7CF7gKynCPAvycxTe7ITMYbMYyTDsgsO12wUK0lJ3Y83LXO5l\nx7LXwQUlEqKwiyYByhpOMic7gR5Q/X5ApwKhnY19seJ+TE4KL3g8muH2VAU3maZG\nB1/c86hsaMZUvMoJPxpLQETar6sOH6dpLXC6HU2/eYIHqX7/qH5/a+lLXj1JQ42H\nOSqjgsBJP29uWaO4WLZId8WblUeMZn/ubNcdAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBACe2PAi9o2kKTUP228GDbpOtgF8MwQKG\nbepu/R1JRI1kxyZp80ZWrBMwBLJQFqQcAKWgpkDA5oOsekfMAx/57+QV13uyw4Xd\nBjjsHZbTl69ld91MMYnPZSx1eiLus3HkazZdiSEic9QM9w4TbgXNoGqfk3EPE98R\nEVBF5AQQTDQcjhfcj9i84Jj2a3Yt3KkjrXhXOXCivMZ8PKX9PjtyxZPtpg8nrxad\nE9zSxk1D4YlkpdFEq+rg9XqrEMCRXS3Hd35B8hLvN6OM4bYOffBnNlNnO9k9FR6s\nMwVF3EK42/gNdc2mdXKS9M33HNd7PlGr0022kwF3Z/S+SR/pfOecvp0=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 2
to: 0
disconnected from auth
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in server - details: Error occurred in migration request: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101083
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101085
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
Handler: Error in server - details: handshake2 timed out...
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in server - details: handshake2 timed out...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in server - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 3
Handler: Error in server - details: Error occurred in migration request: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101094
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101095
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 37888
connected to auth! from local port 37890
received auth hello!
{ authId: 502, nonce: <Buffer 2f 1c 35 ba 06 89 25 e4> }
received auth hello!
{ authId: 502, nonce: <Buffer 68 d6 32 76 5d 82 6b f6> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth504',
     commonName: '10.0.0.7' },
  serial: '0162476AFF65',
  notBefore: 2018-03-21T07:15:17.000Z,
  notAfter: 2018-03-22T07:16:57.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '61:C1:C7:B1:BD:50:DF:AE:B3:DC:28:01:86:4E:2C:EE:CE:23:8B:36',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'AEEAB02ACD0C32937DD84F3EB43F6189EAF089B04CE490F227FEC1E1A42FF33AACC957083F15D2CFEBF0E484D5D2BD03DD21587B3DF0ADCF1F273CEB6D3ADD0C5BD72406DA2D4A379546AD8D1C72FF3DB6ECF5D19A3A100B89C7B659A65778923B085EE02B29C23C0BF27314DEEC84CC61B318C930EC82C3B5DB050AD2527763CDCB5CEE65C7B2D7C1052512A2B08B2601CA1A4E32273B811E50FD7E40A702A19D8D7DB1E27E4C4E0A2F783C9AE1F654053799A646075FDCF3A86C68C654BCCA093F1A4B4044DAAFAB0E1FA7692D70BA1D4DBF798207A97EFFA87E7F6BE94B5E3D49438D87392AA382C0493F6F6E59A3B858B64877C59B95478C667FEE6CD71D',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJHav9lMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDQxETAPBgNVBAMMCDEwLjAuMC43MB4XDTE4MDMy\nMTA3MTUxN1oXDTE4MDMyMjA3MTY1N1owYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQCu6rAqzQwyk33YTz60P2GJ6vCJsEzkkPIn/sHhpC/zOqzJVwg/\nFdLP6/DkhNXSvQPdIVh7PfCtzx8nPOttOt0MW9ckBtotSjeVRq2NHHL/Pbbs9dGa\nOhALice2WaZXeJI7CF7gKynCPAvycxTe7ITMYbMYyTDsgsO12wUK0lJ3Y83LXO5l\nx7LXwQUlEqKwiyYByhpOMic7gR5Q/X5ApwKhnY19seJ+TE4KL3g8muH2VAU3maZG\nB1/c86hsaMZUvMoJPxpLQETar6sOH6dpLXC6HU2/eYIHqX7/qH5/a+lLXj1JQ42H\nOSqjgsBJP29uWaO4WLZId8WblUeMZn/ubNcdAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBACe2PAi9o2kKTUP228GDbpOtgF8MwQKG\nbepu/R1JRI1kxyZp80ZWrBMwBLJQFqQcAKWgpkDA5oOsekfMAx/57+QV13uyw4Xd\nBjjsHZbTl69ld91MMYnPZSx1eiLus3HkazZdiSEic9QM9w4TbgXNoGqfk3EPE98R\nEVBF5AQQTDQcjhfcj9i84Jj2a3Yt3KkjrXhXOXCivMZ8PKX9PjtyxZPtpg8nrxad\nE9zSxk1D4YlkpdFEq+rg9XqrEMCRXS3Hd35B8hLvN6OM4bYOffBnNlNnO9k9FR6s\nMwVF3EK42/gNdc2mdXKS9M33HNd7PlGr0022kwF3Z/S+SR/pfOecvp0=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 1
to: 2
disconnected from auth
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth504',
     commonName: '10.0.0.7' },
  serial: '0162476AFF65',
  notBefore: 2018-03-21T07:15:17.000Z,
  notAfter: 2018-03-22T07:16:57.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '61:C1:C7:B1:BD:50:DF:AE:B3:DC:28:01:86:4E:2C:EE:CE:23:8B:36',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'AEEAB02ACD0C32937DD84F3EB43F6189EAF089B04CE490F227FEC1E1A42FF33AACC957083F15D2CFEBF0E484D5D2BD03DD21587B3DF0ADCF1F273CEB6D3ADD0C5BD72406DA2D4A379546AD8D1C72FF3DB6ECF5D19A3A100B89C7B659A65778923B085EE02B29C23C0BF27314DEEC84CC61B318C930EC82C3B5DB050AD2527763CDCB5CEE65C7B2D7C1052512A2B08B2601CA1A4E32273B811E50FD7E40A702A19D8D7DB1E27E4C4E0A2F783C9AE1F654053799A646075FDCF3A86C68C654BCCA093F1A4B4044DAAFAB0E1FA7692D70BA1D4DBF798207A97EFFA87E7F6BE94B5E3D49438D87392AA382C0493F6F6E59A3B858B64877C59B95478C667FEE6CD71D',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.7',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJHav9lMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDQxETAPBgNVBAMMCDEwLjAuMC43MB4XDTE4MDMy\nMTA3MTUxN1oXDTE4MDMyMjA3MTY1N1owYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQCu6rAqzQwyk33YTz60P2GJ6vCJsEzkkPIn/sHhpC/zOqzJVwg/\nFdLP6/DkhNXSvQPdIVh7PfCtzx8nPOttOt0MW9ckBtotSjeVRq2NHHL/Pbbs9dGa\nOhALice2WaZXeJI7CF7gKynCPAvycxTe7ITMYbMYyTDsgsO12wUK0lJ3Y83LXO5l\nx7LXwQUlEqKwiyYByhpOMic7gR5Q/X5ApwKhnY19seJ+TE4KL3g8muH2VAU3maZG\nB1/c86hsaMZUvMoJPxpLQETar6sOH6dpLXC6HU2/eYIHqX7/qH5/a+lLXj1JQ42H\nOSqjgsBJP29uWaO4WLZId8WblUeMZn/ubNcdAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBACe2PAi9o2kKTUP228GDbpOtgF8MwQKG\nbepu/R1JRI1kxyZp80ZWrBMwBLJQFqQcAKWgpkDA5oOsekfMAx/57+QV13uyw4Xd\nBjjsHZbTl69ld91MMYnPZSx1eiLus3HkazZdiSEic9QM9w4TbgXNoGqfk3EPE98R\nEVBF5AQQTDQcjhfcj9i84Jj2a3Yt3KkjrXhXOXCivMZ8PKX9PjtyxZPtpg8nrxad\nE9zSxk1D4YlkpdFEq+rg9XqrEMCRXS3Hd35B8hLvN6OM4bYOffBnNlNnO9k9FR6s\nMwVF3EK42/gNdc2mdXKS9M33HNd7PlGr0022kwF3Z/S+SR/pfOecvp0=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 2
to: 0
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in server - details: Error occurred in migration request: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in server - details: Error occurred in migration request: Connection with Auth timed out...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101105
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101106
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 38082
received auth hello!
{ authId: 502, nonce: <Buffer 55 78 8b 84 eb 34 02 71> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth504',
     commonName: '10.0.0.7' },
  serial: '0162476AFF65',
  notBefore: 2018-03-21T07:15:17.000Z,
  notAfter: 2018-03-22T07:16:57.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '61:C1:C7:B1:BD:50:DF:AE:B3:DC:28:01:86:4E:2C:EE:CE:23:8B:36',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'AEEAB02ACD0C32937DD84F3EB43F6189EAF089B04CE490F227FEC1E1A42FF33AACC957083F15D2CFEBF0E484D5D2BD03DD21587B3DF0ADCF1F273CEB6D3ADD0C5BD72406DA2D4A379546AD8D1C72FF3DB6ECF5D19A3A100B89C7B659A65778923B085EE02B29C23C0BF27314DEEC84CC61B318C930EC82C3B5DB050AD2527763CDCB5CEE65C7B2D7C1052512A2B08B2601CA1A4E32273B811E50FD7E40A702A19D8D7DB1E27E4C4E0A2F783C9AE1F654053799A646075FDCF3A86C68C654BCCA093F1A4B4044DAAFAB0E1FA7692D70BA1D4DBF798207A97EFFA87E7F6BE94B5E3D49438D87392AA382C0493F6F6E59A3B858B64877C59B95478C667FEE6CD71D',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJHav9lMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDQxETAPBgNVBAMMCDEwLjAuMC43MB4XDTE4MDMy\nMTA3MTUxN1oXDTE4MDMyMjA3MTY1N1owYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQCu6rAqzQwyk33YTz60P2GJ6vCJsEzkkPIn/sHhpC/zOqzJVwg/\nFdLP6/DkhNXSvQPdIVh7PfCtzx8nPOttOt0MW9ckBtotSjeVRq2NHHL/Pbbs9dGa\nOhALice2WaZXeJI7CF7gKynCPAvycxTe7ITMYbMYyTDsgsO12wUK0lJ3Y83LXO5l\nx7LXwQUlEqKwiyYByhpOMic7gR5Q/X5ApwKhnY19seJ+TE4KL3g8muH2VAU3maZG\nB1/c86hsaMZUvMoJPxpLQETar6sOH6dpLXC6HU2/eYIHqX7/qH5/a+lLXj1JQ42H\nOSqjgsBJP29uWaO4WLZId8WblUeMZn/ubNcdAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBACe2PAi9o2kKTUP228GDbpOtgF8MwQKG\nbepu/R1JRI1kxyZp80ZWrBMwBLJQFqQcAKWgpkDA5oOsekfMAx/57+QV13uyw4Xd\nBjjsHZbTl69ld91MMYnPZSx1eiLus3HkazZdiSEic9QM9w4TbgXNoGqfk3EPE98R\nEVBF5AQQTDQcjhfcj9i84Jj2a3Yt3KkjrXhXOXCivMZ8PKX9PjtyxZPtpg8nrxad\nE9zSxk1D4YlkpdFEq+rg9XqrEMCRXS3Hd35B8hLvN6OM4bYOffBnNlNnO9k9FR6s\nMwVF3EK42/gNdc2mdXKS9M33HNd7PlGr0022kwF3Z/S+SR/pfOecvp0=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 1
to: 2
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101116
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38262
received auth hello!
{ authId: 502, nonce: <Buffer df 56 ea 52 c7 ef 96 27> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 7d e1 f8 a4 b1 a3 35 83>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 5a 4b f2 66 94 44 8e 7e c8 bf 18 04 89 f4 43 3f>,
  macKeyVal: <Buffer 4e d0 8e ba 69 b3 25 16 b7 f9 07 25 5c 76 84 c0 80 23 5e 5a 3c 71 6d 34 77 c6 47 1e c7 5d b0 d7>,
  absValidity: 2018-03-21T08:34:31.601Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 95 34 25 bd 71 81 14 63>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 95 34 25 bd 71 81 14 63> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.87:40058',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101125
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38440
Unidentified client connected
received auth hello!
{ authId: 502, nonce: <Buffer 3c 57 0c 6a 80 cc 3c fb> }
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101126
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 04 9a 37 b7 e3 3b d5 06>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c9 36 33 67 e9 11 ab c7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c9 36 33 67 e9 11 ab c7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.87:40238',
  status: 'open' }
connected to auth! from local port 38446
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
received auth hello!
{ authId: 502, nonce: <Buffer ff 7c 71 bd 46 64 88 4f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5f 00 2e 9d fb a8 32 be>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f3 e0 34 18 f5 20 5e d0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f3 e0 34 18 f5 20 5e d0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.86:38976',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101136
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38626
received auth hello!
{ authId: 502, nonce: <Buffer 24 72 cd 0b 99 8c c6 7f> }
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 04 4e d8 09 fa 39 83 1b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 66 b4 2f 54 21 3c 71 0d>
switching to HANDSHAKE_2_SENT
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101137
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 66 b4 2f 54 21 3c 71 0d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.87:40424',
  status: 'open' }
connected to auth! from local port 38632
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
received auth hello!
{ authId: 502, nonce: <Buffer c1 50 86 7d d9 e7 90 84> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 18 e6 41 d1 37 63 5b c0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d5 b6 ab 13 9c 97 c1 02>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d5 b6 ab 13 9c 97 c1 02> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.86:39162',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101147
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38812
received auth hello!
{ authId: 502, nonce: <Buffer e5 1a 03 11 82 6d 33 e1> }
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101148
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 32 78 07 01 f3 b5 b1 0c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e6 e0 86 53 b9 4f d9 a5>
switching to HANDSHAKE_2_SENT
disconnected from auth
connected to auth! from local port 38818
received session key handshake3!
{ replyNonce: <Buffer e6 e0 86 53 b9 4f d9 a5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.87:40610',
  status: 'open' }
received auth hello!
{ authId: 502, nonce: <Buffer 80 8a 91 01 1c d1 ee ef> }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 63 15 85 01 56 7a 7a de>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9e b7 25 b5 b1 1f c2 01>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9e b7 25 b5 b1 1f c2 01> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.86:39348',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101158
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38998
received auth hello!
{ authId: 502, nonce: <Buffer 38 4b 3d 07 b6 7c 08 cb> }
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer be e0 22 8f 6b cc 29 5f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ab 96 bd be c8 7a e7 fe>
switching to HANDSHAKE_2_SENT
disconnected from auth
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101159
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
received session key handshake3!
{ replyNonce: <Buffer ab 96 bd be c8 7a e7 fe> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.87:40796',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
connected to auth! from local port 39004
received auth hello!
{ authId: 502, nonce: <Buffer 7a 99 67 0f 75 6c 23 be> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 78 a2 a3 73 65 a9 93 52>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 68 5f 3c c6 58 90 ec e6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 68 5f 3c c6 58 90 ec e6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.86:39534',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101169
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39184
received auth hello!
{ authId: 502, nonce: <Buffer 29 b0 0a 73 c1 ca ce c7> }
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 77 69 c3 17 7e 84 ae b3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 74 b1 53 6d c7 a0 fc 99>
switching to HANDSHAKE_2_SENT
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101170
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 74 b1 53 6d c7 a0 fc 99> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.87:40982',
  status: 'open' }
connected to auth! from local port 39190
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
received auth hello!
{ authId: 502, nonce: <Buffer 79 ba 1b e8 cf 98 d4 c0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 33 36 30 b7 a5 4f ac bc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4b 76 f3 f1 72 ab 9d b5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4b 76 f3 f1 72 ab 9d b5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.86:39720',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101179
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39362
received auth hello!
{ authId: 502, nonce: <Buffer 74 61 c8 7f 76 20 06 a5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer db 49 39 b5 d7 36 77 61>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 22 01 b8 0a 6d cc b3 40>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 22 01 b8 0a 6d cc b3 40> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.86:39894',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101181
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39374
received auth hello!
{ authId: 502, nonce: <Buffer 7b 46 f1 04 a0 f7 0e 5a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0b 8b 92 67 65 72 a4 c7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6b b6 10 c2 0d cc 70 91>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6b b6 10 c2 0d cc 70 91> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.87:41172',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101192
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39558
received auth hello!
{ authId: 502, nonce: <Buffer b2 12 9b ef 8a 29 d0 40> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e5 c1 e7 de a5 1b fe 03>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 44 14 5f a3 76 1c dd 45>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 44 14 5f a3 76 1c dd 45> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 24,
  remoteAddress: '::ffff:10.0.1.86:40090',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 24 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 24 }
specified socketID: 24
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101193
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39564
received auth hello!
{ authId: 502, nonce: <Buffer d9 1f 5a f1 a1 d9 bf 1c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3f ea ff f0 14 16 e9 67>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5f 78 ad 56 e2 89 0d 75>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5f 78 ad 56 e2 89 0d 75> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 25,
  remoteAddress: '::ffff:10.0.1.87:41362',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 25 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 25 }
specified socketID: 25
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #24 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101201
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39734
received auth hello!
{ authId: 502, nonce: <Buffer 10 76 35 b5 87 0e 58 70> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 88 8a 50 bb bc 6f fc 04>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c4 6d 3d b6 56 a2 d0 a8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c4 6d 3d b6 56 a2 d0 a8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 26,
  remoteAddress: '::ffff:10.0.1.86:40266',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 26 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 26 }
specified socketID: 26
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #25 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101203
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39746
received auth hello!
{ authId: 502, nonce: <Buffer 9a 4b ac 1b 9c 52 59 a7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 26 4a 4f ae e5 57 9b 98>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c9 2d 60 55 1b 15 61 7a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c9 2d 60 55 1b 15 61 7a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 27,
  remoteAddress: '::ffff:10.0.1.87:41544',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 27 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 27 }
specified socketID: 27
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #26 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101213
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39924
received auth hello!
{ authId: 502, nonce: <Buffer ba dd 9f 94 a3 f1 d8 af> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 88 83 77 09 2f 2d 70 b0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 70 52 c7 90 de 18 73 22>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 70 52 c7 90 de 18 73 22> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 28,
  remoteAddress: '::ffff:10.0.1.86:40456',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 28 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 28 }
specified socketID: 28
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #27 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101214
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39932
received auth hello!
{ authId: 502, nonce: <Buffer dd a6 32 ff fb e0 ba 8b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6e e0 aa 10 d1 1e c0 95>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 72 49 8d d0 96 1b c8 8b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 72 49 8d d0 96 1b c8 8b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 29,
  remoteAddress: '::ffff:10.0.1.87:41730',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 29 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 29 }
specified socketID: 29
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #29 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101224
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40114
received auth hello!
{ authId: 502, nonce: <Buffer 75 b8 8d f8 27 e8 a1 7a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 08 f0 51 61 c6 37 f4 51>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 13 bd 35 bb 80 f9 b5 fd>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 13 bd 35 bb 80 f9 b5 fd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 30,
  remoteAddress: '::ffff:10.0.1.87:41912',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 30 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 30 }
specified socketID: 30
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #28 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101225
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40120
received auth hello!
{ authId: 502, nonce: <Buffer 1b ff 4d 78 c8 88 fc 2e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 23 c5 17 00 5e 3c 34 30>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 65 36 c2 2d d3 b0 fb c9>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 65 36 c2 2d d3 b0 fb c9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 31,
  remoteAddress: '::ffff:10.0.1.86:40652',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 31 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 31 }
specified socketID: 31
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #30 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101235
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40300
received auth hello!
{ authId: 502, nonce: <Buffer 62 5a ad 15 5e b0 b8 47> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b6 68 95 6f 5e 9c 90 a9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3f e4 69 d3 d0 36 90 9b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3f e4 69 d3 d0 36 90 9b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 32,
  remoteAddress: '::ffff:10.0.1.87:42098',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 32 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 32 }
specified socketID: 32
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #31 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101236
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40306
received auth hello!
{ authId: 502, nonce: <Buffer 82 58 7e 39 c5 95 9c e5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a7 c9 9d a2 a3 77 e7 8c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 38 f6 32 63 79 71 fe b4>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 38 f6 32 63 79 71 fe b4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 33,
  remoteAddress: '::ffff:10.0.1.86:40838',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 33 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 33 }
specified socketID: 33
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #32 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101246
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40486
received auth hello!
{ authId: 502, nonce: <Buffer c8 26 c1 bb 9a a1 39 6b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f9 97 e9 0a b0 ff 64 8d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer aa ef 1c e6 97 70 93 9d>
switching to HANDSHAKE_2_SENT
disconnected from auth
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #33 closed
received session key handshake3!
{ replyNonce: <Buffer aa ef 1c e6 97 70 93 9d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 34,
  remoteAddress: '::ffff:10.0.1.87:42284',
  status: 'open' }
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101247
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 34 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 34 }
specified socketID: 34
connected to auth! from local port 40492
received auth hello!
{ authId: 502, nonce: <Buffer 93 7d 61 ca 1e f2 2e 5a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 60 53 ef ed ad 37 58 c1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 68 66 60 6a e6 c7 49 42>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 68 66 60 6a e6 c7 49 42> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 35,
  remoteAddress: '::ffff:10.0.1.86:41022',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 35 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 35 }
specified socketID: 35
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #35 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101251
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40624
received auth hello!
{ authId: 502, nonce: <Buffer cd 21 57 7e 28 ca 73 21> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a3 1b d1 3d 42 45 cf 5d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 72 39 a9 d4 a8 a9 54 0d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 72 39 a9 d4 a8 a9 54 0d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 36,
  remoteAddress: '::ffff:10.0.1.86:41156',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 36 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 36 }
specified socketID: 36
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #34 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101252
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40632
received auth hello!
{ authId: 502, nonce: <Buffer bc 86 75 b8 e1 53 48 2c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a2 6d 87 a5 5a 27 09 3a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3e 6d 88 0f 54 1e 10 f1>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 3e 6d 88 0f 54 1e 10 f1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 37,
  remoteAddress: '::ffff:10.0.1.87:42430',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 37 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 37 }
specified socketID: 37
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #36 closed
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #37 closed
