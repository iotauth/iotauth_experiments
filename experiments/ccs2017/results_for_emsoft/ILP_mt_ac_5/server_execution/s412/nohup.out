changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s412.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's412',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 34 74 ... > }
Handler: listening on port 22100
s412:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300647
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51012
received auth hello!
{ authId: 403, nonce: <Buffer 21 d7 82 31 ef 3a b1 e1> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 3a 1a d8 0b 9e 98 a1 6f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 15 4f 4b 1a 7e a2 8d 8f 4e 83 6c 8a 91 5e b7 34>,
  macKeyVal: <Buffer 82 7b 6b 18 4c da 32 33 36 94 eb 79 c2 c8 8d da 09 0f 46 1d 54 f7 d3 f2 61 41 b8 d5 4f 9b 29 b0>,
  absValidity: 2018-03-21T08:18:48.979Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 29 4d a1 ee 52 81 cd 84>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 29 4d a1 ee 52 81 cd 84> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.57:60082',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300653
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51210
received auth hello!
{ authId: 403, nonce: <Buffer fc 28 55 f1 e1 0e a4 08> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9e 96 96 da 10 4d de d8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cf 55 54 ac 7a b0 86 e2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer cf 55 54 ac 7a b0 86 e2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.57:60280',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300659
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51482
received auth hello!
{ authId: 403, nonce: <Buffer c3 23 ab b3 85 e5 a6 09> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d8 8c fb 0b 0b 11 b2 f9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 07 ca 8d d0 3c 30 dc fc>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 07 ca 8d d0 3c 30 dc fc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.57:60552',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300665
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51752
received auth hello!
{ authId: 403, nonce: <Buffer 3a 96 51 30 a1 bc c8 86> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5a 5b 55 61 f0 e0 eb 53>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1e 25 81 67 f5 f7 d4 ab>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1e 25 81 67 f5 f7 d4 ab> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.57:60822',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300671
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52022
received auth hello!
{ authId: 403, nonce: <Buffer 08 a5 c0 f0 a3 e2 4d b5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e7 47 75 d2 24 f5 67 20>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 45 aa fb 31 9a 5b 3c 78>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 45 aa fb 31 9a 5b 3c 78> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.57:32860',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300677
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52292
received auth hello!
{ authId: 403, nonce: <Buffer 6d f0 97 94 dc 5d 4d 15> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 73 7f d9 c8 d4 90 cc f9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 91 a4 81 54 24 85 31 80>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 91 a4 81 54 24 85 31 80> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.57:33130',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300683
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52562
received auth hello!
{ authId: 403, nonce: <Buffer 54 f5 f7 11 09 70 ef 25> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c7 7c 88 32 23 3e 5e d8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bf 54 5f 89 54 af 55 8f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bf 54 5f 89 54 af 55 8f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.57:33400',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300689
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52824
received auth hello!
{ authId: 403, nonce: <Buffer fa 09 b3 50 ec 93 54 7e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 32 1e 26 5b 36 dc 32 08>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8b 39 b0 d6 60 bf 76 73>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8b 39 b0 d6 60 bf 76 73> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.57:33662',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
