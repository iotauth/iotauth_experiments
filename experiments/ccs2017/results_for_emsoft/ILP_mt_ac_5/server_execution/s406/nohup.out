changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s406.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's406',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 33 6c ... > }
Handler: listening on port 22100
s406:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200362
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47682
received auth hello!
{ authId: 402, nonce: <Buffer c4 27 63 49 39 f2 22 45> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 9c d0 a2 19 5d 32 17 22>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer f1 3f 4b bd 0c dc 74 0b 64 80 de c2 fa e6 32 6e>,
  macKeyVal: <Buffer ac b7 82 ff 39 73 5a 88 4a 38 63 96 a7 66 b9 ec ba ec a2 0a 62 88 38 ec 7e 0d 95 f1 56 8b 92 b0>,
  absValidity: 2018-03-21T08:18:26.362Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1a e4 58 22 de 40 dc be>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 1a e4 58 22 de 40 dc be> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.50:34298',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200369
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47838
received auth hello!
{ authId: 402, nonce: <Buffer 2c 05 cf 63 d4 fe 0b 92> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 40 18 63 c7 cd e1 1c 7f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 67 e8 ad e8 30 85 fa 1d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 67 e8 ad e8 30 85 fa 1d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.50:34454',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200376
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48100
received auth hello!
{ authId: 402, nonce: <Buffer 9a 47 95 99 ae 41 f8 c2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c2 7c c3 52 3f 23 ff 64>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 14 02 3d 33 6f 64 b8 a4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 14 02 3d 33 6f 64 b8 a4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.50:34716',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200383
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48370
received auth hello!
{ authId: 402, nonce: <Buffer 44 ce 87 ca 60 2f 9f eb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b8 cf d5 4f 9f 53 b2 48>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4b 9e 39 5c 96 12 bc 9f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4b 9e 39 5c 96 12 bc 9f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.50:34986',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200390
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48640
received auth hello!
{ authId: 402, nonce: <Buffer 3f 87 32 a3 b1 0a 19 86> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5a 17 b5 db 45 18 41 3f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5e 03 e7 24 aa 3a ff 92>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5e 03 e7 24 aa 3a ff 92> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.50:35256',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200397
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48910
received auth hello!
{ authId: 402, nonce: <Buffer 7a f4 99 60 18 86 ef 77> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a2 74 4c ec b1 58 4e 24>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e4 80 db d9 81 e3 cd 16>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e4 80 db d9 81 e3 cd 16> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.50:35526',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200404
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49180
received auth hello!
{ authId: 402, nonce: <Buffer 80 75 37 96 a1 5b ae 81> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 48 d5 ad cc 75 67 3b 97>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1a 42 ff d0 e3 28 9f e6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1a 42 ff d0 e3 28 9f e6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.50:35796',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200411
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49450
received auth hello!
{ authId: 402, nonce: <Buffer 69 7e 02 23 e5 98 69 60> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7a ac 26 70 b4 22 b2 59>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a8 bb 17 79 72 1c a4 e3>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer a8 bb 17 79 72 1c a4 e3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.50:36066',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
