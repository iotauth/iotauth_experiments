changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s504.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's504',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 32 2b ... > }
Handler: listening on port 22100
s504:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100597
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36108
received auth hello!
{ authId: 501, nonce: <Buffer b8 67 00 6f f8 20 6d 89> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer c5 61 8f 62 de 1a dd ae>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer f2 ef c4 f5 d3 9a de b5 c1 6f 76 c6 a6 76 aa f5>,
  macKeyVal: <Buffer 63 cc dc 63 54 cc bc 8d 12 93 d7 97 93 54 df c9 7f 51 95 a7 cd 5a fd d5 68 c7 18 84 d5 59 d7 76>,
  absValidity: 2018-03-21T08:19:21.565Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e2 53 1f fc 77 f4 3f 9e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e2 53 1f fc 77 f4 3f 9e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.67:56990',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100605
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36364
received auth hello!
{ authId: 501, nonce: <Buffer 9d 3c ca 7f 6b 4e 60 69> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ea e9 d6 e6 50 e2 30 0c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 42 f8 95 a1 fc cd 9b 98>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 42 f8 95 a1 fc cd 9b 98> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.67:57246',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100613
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36634
received auth hello!
{ authId: 501, nonce: <Buffer 37 0e c7 47 d5 8d 02 c8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 06 8f 33 f8 83 60 82 cb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5c ef 32 63 07 95 06 d0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5c ef 32 63 07 95 06 d0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.67:57516',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100621
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36904
received auth hello!
{ authId: 501, nonce: <Buffer 1e 4d 9e 1e 45 e8 33 9e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ad 67 43 51 b4 a9 96 6c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6a 44 c8 3c 3b d7 59 ea>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6a 44 c8 3c 3b d7 59 ea> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.67:57786',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100629
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37174
received auth hello!
{ authId: 501, nonce: <Buffer 20 39 fb ff 42 fa b7 2e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cc 96 ce 42 19 be 1c 07>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a4 5e a4 b6 f4 5b 6f 19>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a4 5e a4 b6 f4 5b 6f 19> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.67:58056',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100637
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37444
received auth hello!
{ authId: 501, nonce: <Buffer 6b 48 04 79 05 6a 9a f3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ce fb 1c 87 32 96 e1 dc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 98 0d 2e b8 f0 59 25 76>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 98 0d 2e b8 f0 59 25 76> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.67:58326',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100645
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37714
received auth hello!
{ authId: 501, nonce: <Buffer cf 88 1d b8 aa 77 a6 da> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e0 55 17 e9 2b da 54 87>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2b a1 77 06 e8 84 fa 8a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2b a1 77 06 e8 84 fa 8a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.67:58596',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201203
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201216
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 56936
received auth hello!
{ authId: 502, nonce: <Buffer 99 5d 2b f7 04 57 d6 8a> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '0162476AF952',
  notBefore: 2018-03-21T07:15:15.000Z,
  notAfter: 2018-03-22T07:16:55.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '87:FF:1A:6E:97:8B:72:D5:27:DF:17:7E:26:D0:3D:BA:D4:BB:E3:6A',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'AEEAB02ACD0C32937DD84F3EB43F6189EAF089B04CE490F227FEC1E1A42FF33AACC957083F15D2CFEBF0E484D5D2BD03DD21587B3DF0ADCF1F273CEB6D3ADD0C5BD72406DA2D4A379546AD8D1C72FF3DB6ECF5D19A3A100B89C7B659A65778923B085EE02B29C23C0BF27314DEEC84CC61B318C930EC82C3B5DB050AD2527763CDCB5CEE65C7B2D7C1052512A2B08B2601CA1A4E32273B811E50FD7E40A702A19D8D7DB1E27E4C4E0A2F783C9AE1F654053799A646075FDCF3A86C68C654BCCA093F1A4B4044DAAFAB0E1FA7692D70BA1D4DBF798207A97EFFA87E7F6BE94B5E3D49438D87392AA382C0493F6F6E59A3B858B64877C59B95478C667FEE6CD71D',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJHavlSMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDMy\nMTA3MTUxNVoXDTE4MDMyMjA3MTY1NVowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQCu6rAqzQwyk33YTz60P2GJ6vCJsEzkkPIn/sHhpC/zOqzJVwg/\nFdLP6/DkhNXSvQPdIVh7PfCtzx8nPOttOt0MW9ckBtotSjeVRq2NHHL/Pbbs9dGa\nOhALice2WaZXeJI7CF7gKynCPAvycxTe7ITMYbMYyTDsgsO12wUK0lJ3Y83LXO5l\nx7LXwQUlEqKwiyYByhpOMic7gR5Q/X5ApwKhnY19seJ+TE4KL3g8muH2VAU3maZG\nB1/c86hsaMZUvMoJPxpLQETar6sOH6dpLXC6HU2/eYIHqX7/qH5/a+lLXj1JQ42H\nOSqjgsBJP29uWaO4WLZId8WblUeMZn/ubNcdAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBALf3yNv5DGfc5lz3EddzAfi0lKhdDFso\nIh0Na45fEKWRukPRRcYbb61mQHIVIJVsQ1tYjOZW8dHzaA/ZF1d5eAr08YNp6Tix\nACTosCgZUR4swjS+Iae3rn49+kgBJLFRlVJgfjWSD1kV3F+lbiSYam548JGXHnvy\nkK72yzfKUUvV4vnjNyWZW8zK740Qtcdv4unk0e+0/B2pG7bja3IDITeL0tXyJCW/\nmkFMaHlfCkHiUQo1xlIaYR7neGFsnzCW3ZIJovcCztKAYyNl3zYjhPsaqv9IChKk\nTDuV2Ehjz1a5Pr6IhruYql6JY2ZYkBdHwQKOGdOnSyPcHjx6J5+6H5w=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201229
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57124
received auth hello!
{ authId: 502, nonce: <Buffer 43 24 75 ba f6 db a0 81> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer f4 85 33 fe 18 14 43 94>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 08 bc 74 e6 49 b7 44 02 f1 28 cf be 54 5b 75 54>,
  macKeyVal: <Buffer e0 bc 46 e4 62 d8 e8 7a c1 a8 d0 47 d7 b4 4a 0e 6e 78 7e 6f f2 5a 32 73 0b bf 58 eb fd a2 40 31>,
  absValidity: 2018-03-21T08:30:22.916Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 51 6f be fb 27 6d 08 68>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 51 6f be fb 27 6d 08 68> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.67:59560',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201242
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57314
received auth hello!
{ authId: 502, nonce: <Buffer 91 40 be 1b 4c 74 12 bf> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8d 60 94 72 aa 42 7a b0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fa 1e 4f 01 91 2a c0 75>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fa 1e 4f 01 91 2a c0 75> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.67:59750',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201255
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57506
received auth hello!
{ authId: 502, nonce: <Buffer 76 85 9f 59 7d e2 82 1b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 70 bc 1c 30 04 bd 93 a0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a2 b6 02 29 da 69 92 fa>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer a2 b6 02 29 da 69 92 fa> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.67:59942',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201268
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57688
received auth hello!
{ authId: 502, nonce: <Buffer b7 02 4b 45 78 11 ce c0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 61 30 e3 69 8c 4f 02 36>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c6 04 57 cd 18 98 9f a1>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c6 04 57 cd 18 98 9f a1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.67:60124',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201281
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57876
received auth hello!
{ authId: 502, nonce: <Buffer 7a 77 a3 9a c0 bf 9c 59> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2e cf 74 4b fd f8 88 7c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c2 b0 d7 4a 0c 93 27 cc>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c2 b0 d7 4a 0c 93 27 cc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.67:60312',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201294
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58058
received auth hello!
{ authId: 502, nonce: <Buffer f3 40 de 7e 72 a1 84 2f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 64 b6 1d 38 35 aa 29 74>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c4 e9 6e 13 d4 71 b4 a0>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c4 e9 6e 13 d4 71 b4 a0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.67:60494',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201307
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58244
received auth hello!
{ authId: 502, nonce: <Buffer 09 6a 02 08 f0 d2 97 6e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 58 e4 1a 29 14 2e c6 b7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f0 f0 09 27 e5 d9 4d 0c>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f0 f0 09 27 e5 d9 4d 0c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.67:60680',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201320
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58430
received auth hello!
{ authId: 502, nonce: <Buffer 05 0d 93 77 05 c8 93 91> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e3 79 d1 c6 b8 96 f0 a3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f4 6d 24 20 c6 57 f9 14>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f4 6d 24 20 c6 57 f9 14> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.67:60866',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201333
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58616
received auth hello!
{ authId: 502, nonce: <Buffer 2e ca 3a 1f 16 56 94 a8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bf 0c 30 e9 6d cb ee 67>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 48 de ff dd 58 b9 6a 35>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 48 de ff dd 58 b9 6a 35> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.67:32820',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201346
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58802
received auth hello!
{ authId: 502, nonce: <Buffer 98 b2 a7 f9 57 de 88 b4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer df 1b d1 3d a3 63 0a f1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6e 76 a1 3e 68 cc 6d 99>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 6e 76 a1 3e 68 cc 6d 99> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.67:33006',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201359
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58988
received auth hello!
{ authId: 502, nonce: <Buffer a1 4b 39 df f0 53 dc e8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 61 6d 0c 10 5f 77 f7 6c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 72 a2 bf 53 6b c6 d0 c8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 72 a2 bf 53 6b c6 d0 c8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.67:33192',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201372
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59178
received auth hello!
{ authId: 502, nonce: <Buffer 8a 4b ed c6 c6 3e 2e 9d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fc eb e3 4c 7c c3 d7 a7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer eb 93 25 72 b2 4a f7 01>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer eb 93 25 72 b2 4a f7 01> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.67:33382',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201385
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59360
received auth hello!
{ authId: 502, nonce: <Buffer c9 2c 23 e5 23 a9 8c df> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 75 f7 91 5b 21 dc 61 7c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5b a9 50 fd 7d 8c c4 7c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5b a9 50 fd 7d 8c c4 7c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.67:33564',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201398
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59546
received auth hello!
{ authId: 502, nonce: <Buffer cb 85 89 d4 2c 52 73 57> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0e 09 bc 4d 74 26 27 8a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ea 41 47 ca 03 15 8a d4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ea 41 47 ca 03 15 8a d4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.67:33750',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201411
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59732
received auth hello!
{ authId: 502, nonce: <Buffer cc 58 78 7e 83 d8 42 2e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f9 ce 0e 73 49 a3 bb 9c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c6 e1 4e 33 38 2a fa 49>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c6 e1 4e 33 38 2a fa 49> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.67:33936',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201424
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59918
received auth hello!
{ authId: 502, nonce: <Buffer 7e 19 da 81 aa 41 ef 63> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 41 95 d9 61 71 ed 88 76>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 44 74 88 b1 58 ff 2b bd>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 44 74 88 b1 58 ff 2b bd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.67:34122',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201437
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60104
received auth hello!
{ authId: 502, nonce: <Buffer 04 c1 a4 59 91 90 13 49> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 22 b8 c5 b1 ea c8 71 cf>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3b 7f b7 a6 1f a6 66 54>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3b 7f b7 a6 1f a6 66 54> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.67:34308',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201450
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60262
received auth hello!
{ authId: 502, nonce: <Buffer 04 b8 a2 77 22 af 89 9e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 17 8e 1a bf 56 1d 48 bf>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b3 db 00 54 63 9f 3f 05>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b3 db 00 54 63 9f 3f 05> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 24,
  remoteAddress: '::ffff:10.0.1.67:34466',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 24 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 24 }
specified socketID: 24
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #24 closed
