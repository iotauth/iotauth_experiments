changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s506.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's506',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 37 56 ... > }
Handler: listening on port 22100
s506:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100544
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55012
received auth hello!
{ authId: 501, nonce: <Buffer 0b d4 c8 a2 05 4e bd 81> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer fe e0 ec 27 91 20 10 de>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer b7 ae 22 95 2d 09 a6 e8 da 89 e6 d5 fa 4d d4 67>,
  macKeyVal: <Buffer 89 3e bd 36 fe a8 66 1b 60 ec 12 fa d9 d1 8a 14 2b e7 32 93 75 86 b1 9e 45 48 91 b2 87 b3 6a 55>,
  absValidity: 2018-03-21T07:37:33.215Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 95 fa 0d d0 77 24 17 ad>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 95 fa 0d d0 77 24 17 ad> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.70:36910',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100552
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55280
received auth hello!
{ authId: 501, nonce: <Buffer 79 0e 41 44 de 3b a4 c6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 27 49 74 ba 5d ea f4 43>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 33 22 bc 5e c9 71 e2 c0>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 33 22 bc 5e c9 71 e2 c0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.70:37178',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100560
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55554
received auth hello!
{ authId: 501, nonce: <Buffer be 0e c5 03 d3 09 97 55> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 16 39 ef e6 25 d0 43 98>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d9 8a ec 98 46 57 63 6f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d9 8a ec 98 46 57 63 6f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.70:37450',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100568
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55824
received auth hello!
{ authId: 501, nonce: <Buffer 96 c2 79 1e f3 6e ce f2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 07 3d b8 6b a0 15 14 4e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ea c9 b6 84 01 48 20 cc>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ea c9 b6 84 01 48 20 cc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.70:37722',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100576
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56094
received auth hello!
{ authId: 501, nonce: <Buffer 88 dc 7c 3e cc 44 d9 d3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f7 37 43 f1 5d 29 4a 7f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e0 5d dd 52 bc 95 cc 0f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e0 5d dd 52 bc 95 cc 0f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.70:37992',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100584
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56364
received auth hello!
{ authId: 501, nonce: <Buffer 41 14 17 13 da 33 8b 57> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 38 57 94 18 98 39 2e a4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8e df 44 46 fe 4b 77 7d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 8e df 44 46 fe 4b 77 7d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.70:38262',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100592
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56630
received auth hello!
{ authId: 501, nonce: <Buffer c1 57 7b 2c 85 bb 07 ca> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 96 0e c4 24 52 55 f7 4b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 87 be 7d 87 21 0e e8 84>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 87 be 7d 87 21 0e e8 84> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.70:38528',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
