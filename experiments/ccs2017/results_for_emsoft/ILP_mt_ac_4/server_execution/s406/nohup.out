changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s406.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's406',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 33 6c ... > }
Handler: listening on port 22100
s406:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200307
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40950
received auth hello!
{ authId: 402, nonce: <Buffer 8f e3 53 ba 60 f5 cd 16> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 04 46 95 51 f8 d1 97 e9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 99 8b d2 21 3b 5b 46 9d d3 11 33 40 6f b0 85 bd>,
  macKeyVal: <Buffer b2 48 7f 53 3d 7f dc 8d ed a6 e0 b4 e6 e9 5a 1b 4e 53 93 61 81 55 16 5a 29 d1 2f 52 9f 8c 28 77>,
  absValidity: 2018-03-21T07:36:27.388Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 11 84 4d ca 30 e9 ae c9>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 11 84 4d ca 30 e9 ae c9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.50:55798',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200314
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41106
received auth hello!
{ authId: 402, nonce: <Buffer dd 02 26 55 df 71 2a 00> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6d 1a a6 44 cb d3 5e 9d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4d d9 f1 00 fb 87 0f c2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4d d9 f1 00 fb 87 0f c2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.50:55954',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200321
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41368
received auth hello!
{ authId: 402, nonce: <Buffer 76 05 2f 65 0f 0b 04 47> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4a fe db 96 75 6f 0b 93>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 16 58 cd e2 ee 4a cc e7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 16 58 cd e2 ee 4a cc e7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.50:56216',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200328
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41638
received auth hello!
{ authId: 402, nonce: <Buffer fa 87 0c 14 e6 bb 7b 23> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3c e9 4f 90 90 eb 5c c5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 44 9b 51 56 b8 1c a8 58>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 44 9b 51 56 b8 1c a8 58> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.50:56486',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200335
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41908
received auth hello!
{ authId: 402, nonce: <Buffer b8 eb 11 7c cb 5b 05 f5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d9 e2 aa 50 6c 6a e4 57>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1d cd 55 3f 12 b9 73 8f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1d cd 55 3f 12 b9 73 8f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.50:56756',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200342
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42178
received auth hello!
{ authId: 402, nonce: <Buffer 26 0d a7 e3 f6 69 0c 95> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5e 4d 6a 8e 5f b0 8b 4e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 33 35 34 a9 18 98 c2 19>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 33 35 34 a9 18 98 c2 19> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.50:57026',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200349
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42448
received auth hello!
{ authId: 402, nonce: <Buffer 7f f5 6b bf cc 12 c3 b2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 58 01 86 be bc ce 57 5b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 91 e1 46 d7 b4 cd 97 08>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 91 e1 46 d7 b4 cd 97 08> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.50:57296',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200356
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42718
received auth hello!
{ authId: 402, nonce: <Buffer 22 90 c5 61 a0 25 86 9d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8c cb 66 43 bc f1 53 17>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f6 67 53 44 72 ce 3e 9d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f6 67 53 44 72 ce 3e 9d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.50:57566',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300648
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300658
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 47090
received auth hello!
{ authId: 503, nonce: <Buffer 4a 1f 96 da 53 d3 0d 1a> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth503',
     commonName: '10.0.1.6' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth402',
     commonName: '10.0.0.2' },
  serial: '016247448955',
  notBefore: 2018-03-21T06:33:16.000Z,
  notAfter: 2018-03-22T06:34:56.000Z,
  subjectHash: '5542437f',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '17:CF:DE:B6:D5:09:75:D3:B7:40:FB:C7:C2:D2:BA:55:D2:6C:EE:E6',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'E2C77ADB548D185210E7FA2988369325521D9CF6957B61D640674333307D4FC133154B2C56A9BBCE5655BEDE59A620D2F68A660E6DEB43308DBAFD7A396559B1C6BD0ED769D2F4066CEB2BFDB38188C4D295C06D196ECCC621767B060A3D3BCF3CF4458D7031B2D0AB66B8846DD9C1D4374DEB5D3E30D68FF926574682526527828E3BB232E36626859A826F5DA69748C9567F01930811E1C310842AAE799D7FAD1E9BE8B5D23DC0BC0D4537FC44D1FE7D84E57938DEE6D651DAEC8C897885315FE2797FFB87939E2A342186F4C566B1623BD369CC0226678E3A96E9092471F81CCC14C868DBEA8B6F0B2E5D566294136E91C2B3B101366D8A5B6642614F0CF5',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.6' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 503,
  host: '10.0.1.6',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJHRIlVMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDIxETAPBgNVBAMMCDEwLjAuMC4yMB4XDTE4MDMy\nMTA2MzMxNloXDTE4MDMyMjA2MzQ1NlowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMzERMA8GA1UEAwwIMTAuMC4xLjYwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDix3rbVI0YUhDn+imINpMlUh2c9pV7YdZAZ0MzMH1PwTMVSyxW\nqbvOVlW+3lmmINL2imYObetDMI26/Xo5ZVmxxr0O12nS9AZs6yv9s4GIxNKVwG0Z\nbszGIXZ7Bgo9O8889EWNcDGy0KtmuIRt2cHUN03rXT4w1o/5JldGglJlJ4KOO7Iy\n42YmhZqCb12ml0jJVn8BkwgR4cMQhCqueZ1/rR6b6LXSPcC8DUU3/ETR/n2E5Xk4\n3ubWUdrsjIl4hTFf4nl/+4eTnio0IYb0xWaxYjvTacwCJmeOOpbpCSRx+BzMFMho\n2+qLbwsuXVZilBNukcKzsQE2bYpbZkJhTwz1AgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQYwDQYJKoZIhvcNAQELBQADggEBABYhpM52doni6a6R3Or4nzfAvq527r0g\nEBz00RfOW9xa8MuV7aGXT4ijaiI9v0ajnopbJXO28pQScI8ubk+AjpQ9MwqWRX2i\nfBkNHWzpwLSdjab5ziPn2TbV0oFyajNeyl5OPFeAYd/e8UICR3ylSNgZuqHa43Ah\nA/YBp5gNM+k3ziJyBI5Uc0lsi8srV/b4Bj39RYKHQR5gNJ+ydPYloe2Hnq+jFwIw\npPwe47uxbdHaqUKzigeiDic/3KDbylf9y473m1Lu4lg6Sak5HAw+FWWcOiFnTqXR\nK3g8Afchz7l8SLFBXNPwc4RBhNxh6tydzpO/dndDwqqhuMF7cuUEPgs=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300668
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47312
received auth hello!
{ authId: 503, nonce: <Buffer 27 b8 23 d4 9f 52 7f 38> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 98 99 84 9c 26 32 78 2f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 98 88 33 c4 18 5b d8 d1 e1 5e 43 8c 95 51 1f 7f>,
  macKeyVal: <Buffer a6 a1 fd 6b 27 a6 6c 1f 8e a3 e2 44 67 22 19 e2 ee a0 68 2d 31 c4 be b0 0d f2 08 19 08 c1 55 ff>,
  absValidity: 2018-03-21T07:48:27.933Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fe 7e 55 64 4e 94 9a 02>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fe 7e 55 64 4e 94 9a 02> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.50:58656',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300678
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47530
received auth hello!
{ authId: 503, nonce: <Buffer da 29 3f 6e 02 c5 2b b1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b1 dc 73 1c bd 16 59 ca>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2a 3f 07 e2 ce 3b 13 dc>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2a 3f 07 e2 ce 3b 13 dc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.50:58874',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300688
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47752
received auth hello!
{ authId: 503, nonce: <Buffer 07 9c 80 9e 7b e0 a2 30> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 90 b7 db 7b c0 ca c7 34>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 14 96 09 d0 c1 76 31 17>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 14 96 09 d0 c1 76 31 17> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.50:59094',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300698
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47976
received auth hello!
{ authId: 503, nonce: <Buffer 76 3e 39 2c 48 42 2d 7d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c6 f8 c0 08 14 9b 38 4d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 21 5b cb 0c 5a 7c fc 7f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 21 5b cb 0c 5a 7c fc 7f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.50:59320',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300708
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48196
received auth hello!
{ authId: 503, nonce: <Buffer 61 7a 0b d0 57 40 b1 8d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6c fb 83 21 18 5d 48 f5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d9 c4 38 23 00 be 46 9a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d9 c4 38 23 00 be 46 9a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.50:59538',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300718
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48420
received auth hello!
{ authId: 503, nonce: <Buffer 99 0e 5d 41 b0 38 f4 76> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 20 1a 4c c1 77 85 0d 6d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 33 4f 3f f3 a2 54 17 60>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 33 4f 3f f3 a2 54 17 60> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.50:59764',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300728
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48642
received auth hello!
{ authId: 503, nonce: <Buffer 57 dc 2f 45 1c ee ca 49> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ad 38 87 2b b2 fd d5 11>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 85 d5 50 e3 b7 57 3c af>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 85 d5 50 e3 b7 57 3c af> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.50:59982',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300738
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48868
received auth hello!
{ authId: 503, nonce: <Buffer 85 4e dc e8 a5 b7 7d 83> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 53 e6 ff ee d9 8e a5 c3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1a d1 1a 4d da d5 4d 27>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1a d1 1a 4d da d5 4d 27> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.50:60212',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300748
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49082
received auth hello!
{ authId: 503, nonce: <Buffer 36 ae 56 f1 62 03 06 6c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1d 8e f1 25 61 9f 49 b3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6c 12 63 62 fc 84 9b 3d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6c 12 63 62 fc 84 9b 3d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.50:60426',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300758
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49304
received auth hello!
{ authId: 503, nonce: <Buffer 1d 6c e9 71 ab 98 7f 7a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fa 8f a8 be dd 8b e5 ed>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer dd de 38 b6 d7 74 eb 2f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer dd de 38 b6 d7 74 eb 2f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.50:60648',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300768
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49526
received auth hello!
{ authId: 503, nonce: <Buffer 3b ea 21 7b a0 dc 54 b5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5d 5b e2 c9 65 80 0a c0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4b 22 21 93 b3 db d1 03>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4b 22 21 93 b3 db d1 03> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.50:60870',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300778
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49748
received auth hello!
{ authId: 503, nonce: <Buffer c3 69 e2 00 2c 5f e5 bd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer da 99 cb 6b 25 24 a2 35>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c0 e7 fd ac 5e ee dc 21>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c0 e7 fd ac 5e ee dc 21> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.50:32860',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300788
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49970
received auth hello!
{ authId: 503, nonce: <Buffer a3 e4 a3 e2 41 3c ad b8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 66 3c 45 06 22 e8 77 d9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1e 6d c6 e8 33 85 f9 ac>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1e 6d c6 e8 33 85 f9 ac> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.50:33082',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300798
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50192
received auth hello!
{ authId: 503, nonce: <Buffer 89 b4 d5 66 9c af 32 96> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2c ad f5 4f 69 8e 07 3a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cc f6 27 f0 dc 60 4a eb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer cc f6 27 f0 dc 60 4a eb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.50:33304',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300808
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50414
received auth hello!
{ authId: 503, nonce: <Buffer 9e 77 8f 15 98 1d 3e 85> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 79 c8 26 f4 a3 f7 f3 e8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 64 a3 23 b6 d3 4c 6a 89>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 64 a3 23 b6 d3 4c 6a 89> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.50:33526',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300818
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50636
received auth hello!
{ authId: 503, nonce: <Buffer 07 86 5e 2d 34 99 32 0d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 88 d3 91 7d 9f a9 9d f1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9d 5c 1c 3c aa 59 27 97>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 9d 5c 1c 3c aa 59 27 97> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.50:33748',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300828
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50854
received auth hello!
{ authId: 503, nonce: <Buffer ec 85 2a 28 a4 ad 85 0b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c8 83 7a 17 5e 9b 55 4d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0a b3 59 7a de 2a 23 d4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0a b3 59 7a de 2a 23 d4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 24,
  remoteAddress: '::ffff:10.0.1.50:33966',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 24 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 24 }
specified socketID: 24
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #24 closed
