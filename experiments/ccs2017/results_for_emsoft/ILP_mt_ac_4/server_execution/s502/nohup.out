changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s502.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's502',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 70 71 ... > }
Handler: listening on port 22100
s502:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100539
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35414
received auth hello!
{ authId: 501, nonce: <Buffer 4e 6a 8d 73 ed dd 69 9d> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 8b 6a 3b 45 72 c4 74 49>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 33 85 88 c3 4e 78 f1 d9 b2 d1 f5 1b 08 ac 79 0b>,
  macKeyVal: <Buffer 3c d0 19 8e 88 5f 26 2f ac 83 aa 44 96 e2 3f 90 40 b7 08 a9 22 1f ca 97 5d 2a 60 03 86 f7 ff 2f>,
  absValidity: 2018-03-21T07:37:09.722Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 25 bf ac 0d 84 45 7b 49>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 25 bf ac 0d 84 45 7b 49> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.63:49750',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100547
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35650
received auth hello!
{ authId: 501, nonce: <Buffer d4 9c 47 b5 9e a0 36 81> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 91 e5 9d a7 5a 1e bb 00>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5d 2c 75 b1 cd d6 5d 8c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5d 2c 75 b1 cd d6 5d 8c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.63:49986',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100555
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35920
received auth hello!
{ authId: 501, nonce: <Buffer 5a 41 60 77 51 5d 11 1b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f7 27 44 04 ef 6f b2 5b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4e 30 63 49 75 b1 2c 11>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4e 30 63 49 75 b1 2c 11> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.63:50256',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100563
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36190
received auth hello!
{ authId: 501, nonce: <Buffer 06 a1 4f 4f ef 2d 31 4c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8e 5c 34 8e a1 46 14 f6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a4 fc 73 26 79 19 5e 9e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a4 fc 73 26 79 19 5e 9e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.63:50526',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100571
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36460
received auth hello!
{ authId: 501, nonce: <Buffer 02 39 11 f7 1d dd 36 90> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9c 40 7f 2b 48 64 0d 0b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e9 94 76 c8 47 de e8 70>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e9 94 76 c8 47 de e8 70> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.63:50796',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100579
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36730
received auth hello!
{ authId: 501, nonce: <Buffer 78 b1 73 15 35 a3 5b 6d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fc 08 fe 11 eb 02 03 04>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4e 71 4f 92 0c fe f2 39>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 4e 71 4f 92 0c fe f2 39> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.63:51066',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100587
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37000
received auth hello!
{ authId: 501, nonce: <Buffer 7c d2 0a 67 d1 7a e7 1b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d9 77 c7 ca b9 db d1 dd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a9 be d9 8c b7 03 63 b9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a9 be d9 8c b7 03 63 b9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.63:51336',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
