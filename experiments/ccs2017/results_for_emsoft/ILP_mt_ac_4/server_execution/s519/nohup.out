changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s519.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's519',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 67 49 42 41 41 4b 43 41 51 45 41 70 4b ... > }
Handler: listening on port 22100
s519:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400120
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48700
received auth hello!
{ authId: 504, nonce: <Buffer 4e 15 86 ec ed 43 c3 80> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer a6 29 ee 88 5b 2b 85 f3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 54 52 49 55 9c 1a 66 5e 6e 30 e5 fb 01 22 bb 72>,
  macKeyVal: <Buffer 8d fe af f1 25 b1 67 30 4b 65 e1 b6 33 a9 29 26 d9 5c ab 95 ec ed cb c7 31 a5 a2 6a 74 c7 4a 84>,
  absValidity: 2018-03-21T07:38:32.426Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f3 3e 51 b4 68 de 78 98>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f3 3e 51 b4 68 de 78 98> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.86:57226',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400121
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48726
received auth hello!
{ authId: 504, nonce: <Buffer ac 73 d9 31 ca 47 4f 4d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3f 14 ec 03 79 de 30 0f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 28 a8 33 4a 55 d6 4c a8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 28 a8 33 4a 55 d6 4c a8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.87:58514',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400126
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48970
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400127
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
received auth hello!
{ authId: 504, nonce: <Buffer 10 2f 36 dc 9c 1a d8 19> }
connected to auth! from local port 48990
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ad 6b dc 14 1b 49 a3 20>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7c 45 f1 97 4f fd 4d 63>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 7c 45 f1 97 4f fd 4d 63> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.86:57496',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer 68 c0 48 2f 64 9f 54 48> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e1 ad 0f 0e e1 ec a8 eb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 31 13 97 c9 b3 be 90 75>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 31 13 97 c9 b3 be 90 75> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.87:58780',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400132
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49246
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400133
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49256
received auth hello!
{ authId: 504, nonce: <Buffer f3 36 db 55 c0 12 ad b2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ca 49 96 15 f5 ad f5 25>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6c b6 60 60 e6 c2 84 80>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6c b6 60 60 e6 c2 84 80> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.86:57772',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
received auth hello!
{ authId: 504, nonce: <Buffer 55 da a5 85 30 5c 80 92> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d3 97 78 5d 98 03 29 e5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 27 48 30 aa 2a 6d 3e 0b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 27 48 30 aa 2a 6d 3e 0b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.87:59048',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400138
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49510
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400139
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49526
received auth hello!
{ authId: 504, nonce: <Buffer 16 28 6d 63 6a a2 d1 61> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 28 40 2a 0a 23 1c ec 5c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cc cf 00 be 1c f9 b3 22>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer cc cf 00 be 1c f9 b3 22> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.86:58036',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer ba e0 39 ec 9a 7f 1a 36> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 41 88 9b cb 7b 6e 3e db>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 68 d3 2b 92 e4 a7 22 a9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 68 d3 2b 92 e4 a7 22 a9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.87:59318',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400144
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49786
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400145
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49796
received auth hello!
{ authId: 504, nonce: <Buffer 38 cb 3f d0 60 98 2c ea> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7d 5d 57 6d 01 13 a6 9c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f9 39 64 b9 db 06 cf 4a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f9 39 64 b9 db 06 cf 4a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.86:58312',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
received auth hello!
{ authId: 504, nonce: <Buffer 62 6e b6 72 c6 f1 f1 6c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d1 a6 2f c1 a8 23 db 6c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6f 3b 74 b2 0b dd 5a 08>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6f 3b 74 b2 0b dd 5a 08> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.87:59588',
  status: 'open' }
Handler: Error in server - details: handshake2 timed out...
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400150
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50056
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100782
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100791
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100792
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in server - details: handshake2 timed out...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in server - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.4:21100
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in server - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 3
Handler: Error in server - details: Error occurred in migration request: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 4
Handler: Error in server - details: Error occurred in migration request: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100801
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100802
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 59148
connected to auth! from local port 59150
received auth hello!
{ authId: 502, nonce: <Buffer 1d 8a b3 44 5b a5 27 e5> }
received auth hello!
{ authId: 502, nonce: <Buffer 38 5e 1a 09 f8 42 a2 97> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth504',
     commonName: '10.0.0.7' },
  serial: '01624744920C',
  notBefore: 2018-03-21T06:33:18.000Z,
  notAfter: 2018-03-22T06:34:58.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'B4:F5:78:6E:EB:90:8B:08:01:6A:0B:6A:74:54:58:71:F5:CD:8D:D8',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'AEEAB02ACD0C32937DD84F3EB43F6189EAF089B04CE490F227FEC1E1A42FF33AACC957083F15D2CFEBF0E484D5D2BD03DD21587B3DF0ADCF1F273CEB6D3ADD0C5BD72406DA2D4A379546AD8D1C72FF3DB6ECF5D19A3A100B89C7B659A65778923B085EE02B29C23C0BF27314DEEC84CC61B318C930EC82C3B5DB050AD2527763CDCB5CEE65C7B2D7C1052512A2B08B2601CA1A4E32273B811E50FD7E40A702A19D8D7DB1E27E4C4E0A2F783C9AE1F654053799A646075FDCF3A86C68C654BCCA093F1A4B4044DAAFAB0E1FA7692D70BA1D4DBF798207A97EFFA87E7F6BE94B5E3D49438D87392AA382C0493F6F6E59A3B858B64877C59B95478C667FEE6CD71D',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJHRJIMMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDQxETAPBgNVBAMMCDEwLjAuMC43MB4XDTE4MDMy\nMTA2MzMxOFoXDTE4MDMyMjA2MzQ1OFowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQCu6rAqzQwyk33YTz60P2GJ6vCJsEzkkPIn/sHhpC/zOqzJVwg/\nFdLP6/DkhNXSvQPdIVh7PfCtzx8nPOttOt0MW9ckBtotSjeVRq2NHHL/Pbbs9dGa\nOhALice2WaZXeJI7CF7gKynCPAvycxTe7ITMYbMYyTDsgsO12wUK0lJ3Y83LXO5l\nx7LXwQUlEqKwiyYByhpOMic7gR5Q/X5ApwKhnY19seJ+TE4KL3g8muH2VAU3maZG\nB1/c86hsaMZUvMoJPxpLQETar6sOH6dpLXC6HU2/eYIHqX7/qH5/a+lLXj1JQ42H\nOSqjgsBJP29uWaO4WLZId8WblUeMZn/ubNcdAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAKu4E0WSiKA41gROHV5GFJZ//MUvNtPI\ni6imrBjpJc1cauI/IBhqdTzqsb+IfoweMmXnFG5+nmV6hpgzNZU+u7aMl2ccwB2Y\nMSabAmOc0AidFn52geu/s8r07FoyUg6hf7ArEuFbT1TR2ePTgJKEtKK+nEEqi4zx\n1XxWBmXpBYhw7qQZwzRZ9cYWmK93EMETH/Yt4BVLerGl64Xaa/w2hhnnoB57d6q2\nxofdJBx4qmn3RqKhkBA3jYUzUEn5NwxVuhwdaJgqbKfOKOkP4d/udyV3jBw+mPs4\n4DMR8g+Ku7b9xc0TsGqc8hhta69Eo+VzuuAgd+0Y/BgZjbtZcjMW9+w=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 1
to: 2
disconnected from auth
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth504',
     commonName: '10.0.0.7' },
  serial: '01624744920C',
  notBefore: 2018-03-21T06:33:18.000Z,
  notAfter: 2018-03-22T06:34:58.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'B4:F5:78:6E:EB:90:8B:08:01:6A:0B:6A:74:54:58:71:F5:CD:8D:D8',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'AEEAB02ACD0C32937DD84F3EB43F6189EAF089B04CE490F227FEC1E1A42FF33AACC957083F15D2CFEBF0E484D5D2BD03DD21587B3DF0ADCF1F273CEB6D3ADD0C5BD72406DA2D4A379546AD8D1C72FF3DB6ECF5D19A3A100B89C7B659A65778923B085EE02B29C23C0BF27314DEEC84CC61B318C930EC82C3B5DB050AD2527763CDCB5CEE65C7B2D7C1052512A2B08B2601CA1A4E32273B811E50FD7E40A702A19D8D7DB1E27E4C4E0A2F783C9AE1F654053799A646075FDCF3A86C68C654BCCA093F1A4B4044DAAFAB0E1FA7692D70BA1D4DBF798207A97EFFA87E7F6BE94B5E3D49438D87392AA382C0493F6F6E59A3B858B64877C59B95478C667FEE6CD71D',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.7',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJHRJIMMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDQxETAPBgNVBAMMCDEwLjAuMC43MB4XDTE4MDMy\nMTA2MzMxOFoXDTE4MDMyMjA2MzQ1OFowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQCu6rAqzQwyk33YTz60P2GJ6vCJsEzkkPIn/sHhpC/zOqzJVwg/\nFdLP6/DkhNXSvQPdIVh7PfCtzx8nPOttOt0MW9ckBtotSjeVRq2NHHL/Pbbs9dGa\nOhALice2WaZXeJI7CF7gKynCPAvycxTe7ITMYbMYyTDsgsO12wUK0lJ3Y83LXO5l\nx7LXwQUlEqKwiyYByhpOMic7gR5Q/X5ApwKhnY19seJ+TE4KL3g8muH2VAU3maZG\nB1/c86hsaMZUvMoJPxpLQETar6sOH6dpLXC6HU2/eYIHqX7/qH5/a+lLXj1JQ42H\nOSqjgsBJP29uWaO4WLZId8WblUeMZn/ubNcdAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAKu4E0WSiKA41gROHV5GFJZ//MUvNtPI\ni6imrBjpJc1cauI/IBhqdTzqsb+IfoweMmXnFG5+nmV6hpgzNZU+u7aMl2ccwB2Y\nMSabAmOc0AidFn52geu/s8r07FoyUg6hf7ArEuFbT1TR2ePTgJKEtKK+nEEqi4zx\n1XxWBmXpBYhw7qQZwzRZ9cYWmK93EMETH/Yt4BVLerGl64Xaa/w2hhnnoB57d6q2\nxofdJBx4qmn3RqKhkBA3jYUzUEn5NwxVuhwdaJgqbKfOKOkP4d/udyV3jBw+mPs4\n4DMR8g+Ku7b9xc0TsGqc8hhta69Eo+VzuuAgd+0Y/BgZjbtZcjMW9+w=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 2
to: 0
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in server - details: Error occurred in migration request: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in server - details: Error occurred in migration request: Connection with Auth timed out...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100812
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100813
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 59380
received auth hello!
{ authId: 502, nonce: <Buffer 42 34 5e b6 08 bc c0 83> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth504',
     commonName: '10.0.0.7' },
  serial: '01624744920C',
  notBefore: 2018-03-21T06:33:18.000Z,
  notAfter: 2018-03-22T06:34:58.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'B4:F5:78:6E:EB:90:8B:08:01:6A:0B:6A:74:54:58:71:F5:CD:8D:D8',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'AEEAB02ACD0C32937DD84F3EB43F6189EAF089B04CE490F227FEC1E1A42FF33AACC957083F15D2CFEBF0E484D5D2BD03DD21587B3DF0ADCF1F273CEB6D3ADD0C5BD72406DA2D4A379546AD8D1C72FF3DB6ECF5D19A3A100B89C7B659A65778923B085EE02B29C23C0BF27314DEEC84CC61B318C930EC82C3B5DB050AD2527763CDCB5CEE65C7B2D7C1052512A2B08B2601CA1A4E32273B811E50FD7E40A702A19D8D7DB1E27E4C4E0A2F783C9AE1F654053799A646075FDCF3A86C68C654BCCA093F1A4B4044DAAFAB0E1FA7692D70BA1D4DBF798207A97EFFA87E7F6BE94B5E3D49438D87392AA382C0493F6F6E59A3B858B64877C59B95478C667FEE6CD71D',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJHRJIMMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDQxETAPBgNVBAMMCDEwLjAuMC43MB4XDTE4MDMy\nMTA2MzMxOFoXDTE4MDMyMjA2MzQ1OFowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQCu6rAqzQwyk33YTz60P2GJ6vCJsEzkkPIn/sHhpC/zOqzJVwg/\nFdLP6/DkhNXSvQPdIVh7PfCtzx8nPOttOt0MW9ckBtotSjeVRq2NHHL/Pbbs9dGa\nOhALice2WaZXeJI7CF7gKynCPAvycxTe7ITMYbMYyTDsgsO12wUK0lJ3Y83LXO5l\nx7LXwQUlEqKwiyYByhpOMic7gR5Q/X5ApwKhnY19seJ+TE4KL3g8muH2VAU3maZG\nB1/c86hsaMZUvMoJPxpLQETar6sOH6dpLXC6HU2/eYIHqX7/qH5/a+lLXj1JQ42H\nOSqjgsBJP29uWaO4WLZId8WblUeMZn/ubNcdAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAKu4E0WSiKA41gROHV5GFJZ//MUvNtPI\ni6imrBjpJc1cauI/IBhqdTzqsb+IfoweMmXnFG5+nmV6hpgzNZU+u7aMl2ccwB2Y\nMSabAmOc0AidFn52geu/s8r07FoyUg6hf7ArEuFbT1TR2ePTgJKEtKK+nEEqi4zx\n1XxWBmXpBYhw7qQZwzRZ9cYWmK93EMETH/Yt4BVLerGl64Xaa/w2hhnnoB57d6q2\nxofdJBx4qmn3RqKhkBA3jYUzUEn5NwxVuhwdaJgqbKfOKOkP4d/udyV3jBw+mPs4\n4DMR8g+Ku7b9xc0TsGqc8hhta69Eo+VzuuAgd+0Y/BgZjbtZcjMW9+w=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 1
to: 2
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100821
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59576
received auth hello!
{ authId: 502, nonce: <Buffer a4 5f 07 65 7d 7a 9b 71> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer a4 68 b6 62 5e 45 a5 89>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer a2 70 39 7c 0a d9 0d 77 d3 91 1a f9 a5 9c df 16>,
  macKeyVal: <Buffer 3e d9 e9 20 16 2d 15 91 3a be 2a 43 3a 63 12 4f 9f 64 ec 34 d8 66 00 69 75 74 4c e9 67 f4 07 e2>,
  absValidity: 2018-03-21T07:50:29.250Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fc 53 bb 43 10 ca 60 62>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fc 53 bb 43 10 ca 60 62> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.86:60108',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100823
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59592
received auth hello!
{ authId: 502, nonce: <Buffer 64 29 a4 b2 ed 0a 9d cd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cb dc 0d d3 cc 9b 99 ce>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 95 11 08 0d 63 ce 18 3c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 95 11 08 0d 63 ce 18 3c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.87:33158',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100833
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59804
received auth hello!
{ authId: 502, nonce: <Buffer 91 1b 8a 77 03 0b d0 02> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c1 18 5b 2c c7 7e a4 d5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 72 5c 97 2a 98 3e 5e 00>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 72 5c 97 2a 98 3e 5e 00> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.86:60334',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100835
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59818
received auth hello!
{ authId: 502, nonce: <Buffer 74 72 83 53 47 15 15 bc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6b da b4 73 44 38 93 ca>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 28 7a 85 a6 2a 83 ef c1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 28 7a 85 a6 2a 83 ef c1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.87:33384',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100845
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60036
received auth hello!
{ authId: 502, nonce: <Buffer d5 c2 69 4b 84 ba 43 64> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 62 46 96 3a 50 9d 6a 99>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5b 2a 11 cf 61 b8 d9 de>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5b 2a 11 cf 61 b8 d9 de> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.86:60568',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100846
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60042
received auth hello!
{ authId: 502, nonce: <Buffer 10 07 9c 56 06 f5 40 92> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ec 8a 18 0a 30 f3 ba 91>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e3 3a 59 25 62 ff 3e ee>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e3 3a 59 25 62 ff 3e ee> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.87:33608',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100855
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60248
received auth hello!
{ authId: 502, nonce: <Buffer 8e c9 8f 6b 3a 56 49 57> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c7 3c 53 a1 25 e6 80 bc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d7 6b 03 56 68 51 d6 c9>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer d7 6b 03 56 68 51 d6 c9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.86:60780',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100857
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60262
received auth hello!
{ authId: 502, nonce: <Buffer 21 1b c4 f1 e5 20 7d 58> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 41 15 23 a4 72 9c 1c 03>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2e 22 08 d3 77 e0 33 2e>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 2e 22 08 d3 77 e0 33 2e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.87:33828',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100865
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60466
received auth hello!
{ authId: 502, nonce: <Buffer 18 ab 73 57 48 7c 58 63> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5f 34 d2 05 b0 17 25 26>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 62 3c d9 2d eb 9d 93 ab>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 62 3c d9 2d eb 9d 93 ab> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.86:60996',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100867
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60480
received auth hello!
{ authId: 502, nonce: <Buffer 58 d4 45 9e 4d 56 3a a0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f2 0f 8a b6 49 1a c6 43>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 46 13 37 a6 9f 0d 0d 74>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 46 13 37 a6 9f 0d 0d 74> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.87:34046',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100878
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60704
received auth hello!
{ authId: 502, nonce: <Buffer f6 b6 8e b8 60 f1 aa ec> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 09 3d 0a 7c 74 ba 26 e3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 66 ab d1 24 40 30 f5 b0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 66 ab d1 24 40 30 f5 b0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.87:34268',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100886
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60906
received auth hello!
{ authId: 502, nonce: <Buffer c1 fb b7 a4 86 fa fb e8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 39 5d 4f ef c9 02 ad 43>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer aa 74 1e 8f b8 0f 26 99>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer aa 74 1e 8f b8 0f 26 99> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.86:33204',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100889
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60926
received auth hello!
{ authId: 502, nonce: <Buffer e7 70 c8 de 6b 23 0e 9d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1e 7b 6d 15 af ea bf 01>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 65 d5 30 5d ad 59 55 03>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 65 d5 30 5d ad 59 55 03> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.87:34492',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100899
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 32912
received auth hello!
{ authId: 502, nonce: <Buffer dc d1 ba 75 d4 ca 6f 61> }
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fe 3a 25 b5 ff 79 fd a0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 27 69 a8 f8 f2 33 94 24>
switching to HANDSHAKE_2_SENT
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100900
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 27 69 a8 f8 f2 33 94 24> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.86:33442',
  status: 'open' }
connected to auth! from local port 32916
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
received auth hello!
{ authId: 502, nonce: <Buffer 4e 30 aa 1d 07 6a 6c 53> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b0 98 f5 18 75 09 90 9c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0d 09 0d 7b 67 fe eb 31>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0d 09 0d 7b 67 fe eb 31> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 24,
  remoteAddress: '::ffff:10.0.1.87:34714',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 24 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 24 }
specified socketID: 24
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100908
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33118
received auth hello!
{ authId: 502, nonce: <Buffer c2 c7 5c ed 7d 15 a6 92> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d9 74 28 62 31 44 0e a9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 29 ff 14 38 17 7a a3 fb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 29 ff 14 38 17 7a a3 fb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 25,
  remoteAddress: '::ffff:10.0.1.86:33648',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 25 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 25 }
specified socketID: 25
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #24 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100911
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33138
received auth hello!
{ authId: 502, nonce: <Buffer f8 e0 6e e9 59 3b 73 83> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8b f7 79 a0 dd 8d dd 5a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9d 49 9a 64 26 c7 9d f4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9d 49 9a 64 26 c7 9d f4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 26,
  remoteAddress: '::ffff:10.0.1.87:34936',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 26 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 26 }
specified socketID: 26
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #25 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100921
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33354
received auth hello!
{ authId: 502, nonce: <Buffer b9 eb b9 68 4f 19 1f d9> }
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #26 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100922
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c8 f4 19 c0 36 84 30 41>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 10 cf 3d e4 d9 5d 1c 86>
switching to HANDSHAKE_2_SENT
disconnected from auth
connected to auth! from local port 33360
received session key handshake3!
{ replyNonce: <Buffer 10 cf 3d e4 d9 5d 1c 86> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 27,
  remoteAddress: '::ffff:10.0.1.86:33886',
  status: 'open' }
received auth hello!
{ authId: 502, nonce: <Buffer 05 57 2e 85 6b 70 19 2f> }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 27 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 27 }
specified socketID: 27
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 83 cf 73 35 5d df 1f 17>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 84 07 63 6b 0e 4e 6d 2d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 84 07 63 6b 0e 4e 6d 2d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 28,
  remoteAddress: '::ffff:10.0.1.87:35158',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 28 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 28 }
specified socketID: 28
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #27 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100930
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33562
received auth hello!
{ authId: 502, nonce: <Buffer f7 1e 0e a8 11 a1 7e e9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 33 79 1a c6 2f ef 66 be>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5f 7b fa 22 ef ed 10 4f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5f 7b fa 22 ef ed 10 4f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 29,
  remoteAddress: '::ffff:10.0.1.86:34094',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 29 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 29 }
specified socketID: 29
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #28 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100932
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33578
received auth hello!
{ authId: 502, nonce: <Buffer 21 df b0 b1 b7 c6 d2 80> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1b ed 91 6f 7e 67 50 f7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fe 6a 2c 5f 76 fa 35 fd>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer fe 6a 2c 5f 76 fa 35 fd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 30,
  remoteAddress: '::ffff:10.0.1.87:35376',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 30 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 30 }
specified socketID: 30
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #29 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100941
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33784
received auth hello!
{ authId: 502, nonce: <Buffer 45 52 13 d9 9a 80 e8 e8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1f 15 49 44 31 31 a7 d7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 50 be 54 11 27 c2 47 f5>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 50 be 54 11 27 c2 47 f5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 31,
  remoteAddress: '::ffff:10.0.1.86:34316',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 31 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 31 }
specified socketID: 31
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #31 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100952
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34006
received auth hello!
{ authId: 502, nonce: <Buffer ad 83 61 27 c0 d0 50 a7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6f c7 7e 74 50 29 87 57>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0e 90 41 19 e6 e2 63 b8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0e 90 41 19 e6 e2 63 b8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 32,
  remoteAddress: '::ffff:10.0.1.86:34538',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 32 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 32 }
specified socketID: 32
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #30 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100953
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34018
received auth hello!
{ authId: 502, nonce: <Buffer af af 69 de f7 ae 29 97> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3b b2 4c f9 21 36 86 47>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2f 4e b6 9c b0 0d 35 d3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2f 4e b6 9c b0 0d 35 d3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 33,
  remoteAddress: '::ffff:10.0.1.87:35816',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 33 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 33 }
specified socketID: 33
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #32 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100964
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34240
received auth hello!
{ authId: 502, nonce: <Buffer f6 84 a8 cb 88 76 e1 e0> }
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #33 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100965
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5d 2d 42 69 b1 ed 80 27>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3a 8e 4f 6c ef 54 e5 9a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3a 8e 4f 6c ef 54 e5 9a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 34,
  remoteAddress: '::ffff:10.0.1.86:34770',
  status: 'open' }
connected to auth! from local port 34244
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 34 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 34 }
specified socketID: 34
received auth hello!
{ authId: 502, nonce: <Buffer 4e f1 26 69 39 1f 83 4d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f2 6c 25 ad 25 1a 59 40>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 35 32 e6 e0 10 3e 09 e5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 35 32 e6 e0 10 3e 09 e5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 35,
  remoteAddress: '::ffff:10.0.1.87:36042',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 35 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 35 }
specified socketID: 35
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #34 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100973
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34446
received auth hello!
{ authId: 502, nonce: <Buffer 9a 9e c4 8c ca 37 bd 89> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2d ab 20 bb 09 5b 57 4c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 59 0d 8f 2b 11 b1 bc ee>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 59 0d 8f 2b 11 b1 bc ee> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 36,
  remoteAddress: '::ffff:10.0.1.86:34978',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 36 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 36 }
specified socketID: 36
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #35 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100976
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34466
received auth hello!
{ authId: 502, nonce: <Buffer ee 33 7f 0a ef ff d6 89> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bc ab c1 40 45 cc 99 54>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8a e2 6b eb 05 d7 05 f8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8a e2 6b eb 05 d7 05 f8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 37,
  remoteAddress: '::ffff:10.0.1.87:36264',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 37 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 37 }
specified socketID: 37
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #36 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100979
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34604
received auth hello!
{ authId: 502, nonce: <Buffer 20 6b 3d 07 45 09 00 96> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 31 65 f8 24 0f 32 c3 01>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0a e5 49 d5 86 1b 04 ba>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 0a e5 49 d5 86 1b 04 ba> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 38,
  remoteAddress: '::ffff:10.0.1.86:35136',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 38 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 38 }
specified socketID: 38
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #37 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100980
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34610
received auth hello!
{ authId: 502, nonce: <Buffer 86 9b a9 a9 56 2b 34 b7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 85 0e e1 a8 84 88 de 9c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fd c7 b1 74 d6 30 2f 06>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fd c7 b1 74 d6 30 2f 06> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 39,
  remoteAddress: '::ffff:10.0.1.87:36408',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 39 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 39 }
specified socketID: 39
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #38 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100982
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34700
received auth hello!
{ authId: 502, nonce: <Buffer 42 99 e1 98 8e 18 2a 3b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 85 a4 5d 5e a0 79 3d 9a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ff da 18 27 0b 98 89 b7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ff da 18 27 0b 98 89 b7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 40,
  remoteAddress: '::ffff:10.0.1.86:35232',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 40 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 40 }
specified socketID: 40
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #39 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100983
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34706
received auth hello!
{ authId: 502, nonce: <Buffer aa 49 05 89 b9 0e ab 96> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 53 51 ed 1e 05 f2 14 5d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7b bd db 5a 25 4e cc 33>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 7b bd db 5a 25 4e cc 33> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 41,
  remoteAddress: '::ffff:10.0.1.87:36504',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 41 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 41 }
specified socketID: 41
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #40 closed
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #41 closed
