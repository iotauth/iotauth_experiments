changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s407.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's407',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 6f 66 ... > }
Handler: listening on port 22100
s407:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200308
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57338
received auth hello!
{ authId: 402, nonce: <Buffer 11 88 7c 50 d5 7e 7a a4> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 50 a3 20 6b a4 85 65 ae>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer eb 86 22 c1 6c bd 6f b1 a7 e6 28 11 db 20 ce 46>,
  macKeyVal: <Buffer 78 2c ba 10 a3 4b 70 45 65 a7 c2 58 2f 7b 60 b5 fc f7 16 9a 07 34 4c 0a 05 95 95 54 03 6e 36 72>,
  absValidity: 2018-03-21T07:36:30.747Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7b d6 bf 64 d3 15 6e 51>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 7b d6 bf 64 d3 15 6e 51> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.51:57734',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200315
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57500
received auth hello!
{ authId: 402, nonce: <Buffer 51 75 bd 87 6a a3 bc 7a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2a 04 6f cc 7b 7c 1b 55>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f9 64 28 53 06 6e d0 59>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f9 64 28 53 06 6e d0 59> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.51:57896',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200322
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57768
received auth hello!
{ authId: 402, nonce: <Buffer 59 5f 76 84 c7 d8 00 1f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d8 87 e4 00 b2 1e ec 96>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a1 3f 6a 65 7f 01 f2 4b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer a1 3f 6a 65 7f 01 f2 4b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.51:58164',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200329
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58038
received auth hello!
{ authId: 402, nonce: <Buffer 07 d2 a8 1c 3a bf 07 cf> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ee 4c 81 ca 91 17 4d ff>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 88 bd fa e1 7f 92 5e b0>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 88 bd fa e1 7f 92 5e b0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.51:58434',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200336
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58308
received auth hello!
{ authId: 402, nonce: <Buffer f7 15 fb f3 c0 11 80 e7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5d ad ce bd 08 53 74 10>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fb 4e 5f ec 33 f9 19 11>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fb 4e 5f ec 33 f9 19 11> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.51:58704',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200343
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58578
received auth hello!
{ authId: 402, nonce: <Buffer 79 19 c2 54 21 03 cf 7e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 30 3e 33 6e 5c 85 42 15>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9f c8 5b 11 91 55 74 f5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9f c8 5b 11 91 55 74 f5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.51:58974',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200350
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58848
received auth hello!
{ authId: 402, nonce: <Buffer 3c 3e 28 60 f0 60 ee 3f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 30 64 59 a1 56 bd d0 4b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c9 5b 35 ea 98 42 b1 2d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c9 5b 35 ea 98 42 b1 2d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.51:59244',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200357
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59118
received auth hello!
{ authId: 402, nonce: <Buffer ca 64 b8 89 e7 8c c5 c4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a2 9f 53 94 43 88 00 51>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 99 54 8e 5b 76 c7 f4 ce>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 99 54 8e 5b 76 c7 f4 ce> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.51:59514',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300649
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300659
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 45244
received auth hello!
{ authId: 503, nonce: <Buffer 49 89 66 83 c6 ce c5 0e> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth503',
     commonName: '10.0.1.6' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth402',
     commonName: '10.0.0.2' },
  serial: '016247448955',
  notBefore: 2018-03-21T06:33:16.000Z,
  notAfter: 2018-03-22T06:34:56.000Z,
  subjectHash: '5542437f',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '17:CF:DE:B6:D5:09:75:D3:B7:40:FB:C7:C2:D2:BA:55:D2:6C:EE:E6',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'E2C77ADB548D185210E7FA2988369325521D9CF6957B61D640674333307D4FC133154B2C56A9BBCE5655BEDE59A620D2F68A660E6DEB43308DBAFD7A396559B1C6BD0ED769D2F4066CEB2BFDB38188C4D295C06D196ECCC621767B060A3D3BCF3CF4458D7031B2D0AB66B8846DD9C1D4374DEB5D3E30D68FF926574682526527828E3BB232E36626859A826F5DA69748C9567F01930811E1C310842AAE799D7FAD1E9BE8B5D23DC0BC0D4537FC44D1FE7D84E57938DEE6D651DAEC8C897885315FE2797FFB87939E2A342186F4C566B1623BD369CC0226678E3A96E9092471F81CCC14C868DBEA8B6F0B2E5D566294136E91C2B3B101366D8A5B6642614F0CF5',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.6' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 503,
  host: '10.0.1.6',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJHRIlVMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDIxETAPBgNVBAMMCDEwLjAuMC4yMB4XDTE4MDMy\nMTA2MzMxNloXDTE4MDMyMjA2MzQ1NlowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMzERMA8GA1UEAwwIMTAuMC4xLjYwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDix3rbVI0YUhDn+imINpMlUh2c9pV7YdZAZ0MzMH1PwTMVSyxW\nqbvOVlW+3lmmINL2imYObetDMI26/Xo5ZVmxxr0O12nS9AZs6yv9s4GIxNKVwG0Z\nbszGIXZ7Bgo9O8889EWNcDGy0KtmuIRt2cHUN03rXT4w1o/5JldGglJlJ4KOO7Iy\n42YmhZqCb12ml0jJVn8BkwgR4cMQhCqueZ1/rR6b6LXSPcC8DUU3/ETR/n2E5Xk4\n3ubWUdrsjIl4hTFf4nl/+4eTnio0IYb0xWaxYjvTacwCJmeOOpbpCSRx+BzMFMho\n2+qLbwsuXVZilBNukcKzsQE2bYpbZkJhTwz1AgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQYwDQYJKoZIhvcNAQELBQADggEBABYhpM52doni6a6R3Or4nzfAvq527r0g\nEBz00RfOW9xa8MuV7aGXT4ijaiI9v0ajnopbJXO28pQScI8ubk+AjpQ9MwqWRX2i\nfBkNHWzpwLSdjab5ziPn2TbV0oFyajNeyl5OPFeAYd/e8UICR3ylSNgZuqHa43Ah\nA/YBp5gNM+k3ziJyBI5Uc0lsi8srV/b4Bj39RYKHQR5gNJ+ydPYloe2Hnq+jFwIw\npPwe47uxbdHaqUKzigeiDic/3KDbylf9y473m1Lu4lg6Sak5HAw+FWWcOiFnTqXR\nK3g8Afchz7l8SLFBXNPwc4RBhNxh6tydzpO/dndDwqqhuMF7cuUEPgs=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300669
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45466
received auth hello!
{ authId: 503, nonce: <Buffer 3e f7 d7 09 cb c6 24 b3> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer ac 55 82 74 9f c3 ec 67>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 9d 1c 84 12 51 d1 9c be 14 d4 1a 0f ba 6f 8e 29>,
  macKeyVal: <Buffer 3d a9 f2 f3 d5 bf 05 6c ec 66 17 f9 cf 2a 89 e0 c7 d5 15 2e 0a b6 88 98 13 da 20 6a 7c 7e db 05>,
  absValidity: 2018-03-21T07:48:31.999Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2a 43 c9 45 c7 12 59 bc>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 2a 43 c9 45 c7 12 59 bc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.51:60604',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300679
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45682
received auth hello!
{ authId: 503, nonce: <Buffer 54 49 88 0a 3d 26 f4 4d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c9 9f 13 ae 11 bf cc 4a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a5 da 5c 4c f5 bc 96 ae>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a5 da 5c 4c f5 bc 96 ae> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.51:60818',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300689
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45908
received auth hello!
{ authId: 503, nonce: <Buffer f5 38 a2 a4 b7 1f 3b eb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 38 24 27 66 6a 55 a9 11>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 00 13 0d d9 dd 4f bd 4d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 00 13 0d d9 dd 4f bd 4d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.51:32814',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300699
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46130
received auth hello!
{ authId: 503, nonce: <Buffer 5b 54 37 07 39 d8 fb 3e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5d 10 46 1e 0e 4b a2 6f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0a ca 47 1d 33 8f bf e5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0a ca 47 1d 33 8f bf e5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.51:33036',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300709
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46350
received auth hello!
{ authId: 503, nonce: <Buffer fc bc 07 47 c0 7e db 23> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 70 c4 b7 bf 4a 36 8b 25>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 38 6c f1 f0 56 3a d7 10>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 38 6c f1 f0 56 3a d7 10> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.51:33254',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300719
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46574
received auth hello!
{ authId: 503, nonce: <Buffer d2 96 b5 8a 47 ac 91 c0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 41 9a 47 80 21 e4 11 96>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ec 78 bc 5b b0 79 3d 90>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ec 78 bc 5b b0 79 3d 90> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.51:33480',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300729
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46796
received auth hello!
{ authId: 503, nonce: <Buffer df b1 56 bb 30 82 d2 1e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer dd 67 a8 70 aa 97 e2 16>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 48 cf f6 09 38 cc 45 81>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 48 cf f6 09 38 cc 45 81> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.51:33702',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300739
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47014
received auth hello!
{ authId: 503, nonce: <Buffer 42 b6 fe 0e e6 e2 7b 9b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4a 0f 23 14 f6 bd ed 87>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9e 18 f2 52 d1 ca 80 9a>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 9e 18 f2 52 d1 ca 80 9a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.51:33920',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300749
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47232
received auth hello!
{ authId: 503, nonce: <Buffer 50 65 37 27 58 23 d0 b7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer aa 6e 10 44 58 44 ae a3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b2 2a df e8 cc 49 ac 8d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b2 2a df e8 cc 49 ac 8d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.51:34138',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300759
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47456
received auth hello!
{ authId: 503, nonce: <Buffer f4 64 af 58 bc a7 2b e3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 13 e3 a6 00 a7 72 4e 65>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 12 ee 63 2c 9d 65 3f 61>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 12 ee 63 2c 9d 65 3f 61> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.51:34360',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300769
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47676
received auth hello!
{ authId: 503, nonce: <Buffer 0f 22 9c e0 9f 30 11 68> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer df b5 bd d1 73 30 7e 70>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 63 24 53 1c 2c df 00 23>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 63 24 53 1c 2c df 00 23> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.51:34582',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300779
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47898
received auth hello!
{ authId: 503, nonce: <Buffer cf 9b 8a ec e4 5d 0e d0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 74 b2 5f 80 ae c2 2c ca>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer eb 92 ab 9b ac ab b8 d4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer eb 92 ab 9b ac ab b8 d4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.51:34804',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300789
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48120
received auth hello!
{ authId: 503, nonce: <Buffer fc 03 41 73 5d 73 d9 6a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fd 8d d2 ea c1 be eb 8f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 49 86 cd 00 c5 9d 2a 7a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 49 86 cd 00 c5 9d 2a 7a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.51:35026',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300799
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48342
received auth hello!
{ authId: 503, nonce: <Buffer cd b1 83 10 60 1e e3 35> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9c c8 87 46 01 4a f0 06>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 63 38 6f 97 82 82 ca 90>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 63 38 6f 97 82 82 ca 90> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.51:35248',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300809
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48564
received auth hello!
{ authId: 503, nonce: <Buffer 96 3f ed ef 25 cc a6 00> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 42 44 e0 3d 40 3a a5 e2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 56 26 e2 31 a9 4a bf 1d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 56 26 e2 31 a9 4a bf 1d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.51:35470',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300819
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48782
received auth hello!
{ authId: 503, nonce: <Buffer 22 2f d9 57 73 1d 90 42> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0b b0 3d 04 ba b8 ae e6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 23 82 c0 40 8a 14 d2 4e>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 23 82 c0 40 8a 14 d2 4e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.51:35688',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300829
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49006
received auth hello!
{ authId: 503, nonce: <Buffer e3 4a b9 63 dc 49 ed 98> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f3 8d 01 8c e8 ec f9 03>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 38 ed dd 69 90 94 6c b6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 38 ed dd 69 90 94 6c b6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 24,
  remoteAddress: '::ffff:10.0.1.51:35910',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 24 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 24 }
specified socketID: 24
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #24 closed
