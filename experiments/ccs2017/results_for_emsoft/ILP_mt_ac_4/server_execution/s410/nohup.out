changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s410.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's410',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 35 5a ... > }
Handler: listening on port 22100
s410:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200310
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45210
received auth hello!
{ authId: 402, nonce: <Buffer d8 85 d5 be ad a3 21 8a> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 9a a0 11 df e5 3a f6 ce>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 23 62 52 87 1d df 7f 7a 50 6b 27 f1 cb 57 ff a9>,
  macKeyVal: <Buffer 77 48 ae 2c e3 b2 c1 0e b9 56 83 48 15 38 25 c4 f2 36 b0 be ca fc f5 8e 1d 6b 8b 36 2f f5 51 85>,
  absValidity: 2018-03-21T07:36:38.540Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 05 20 37 fd 59 9b 92 71>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 05 20 37 fd 59 9b 92 71> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.53:47874',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200317
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45384
received auth hello!
{ authId: 402, nonce: <Buffer 18 3e c1 7b 05 c7 44 ea> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3e a3 1e a1 78 2f 4e 42>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a7 73 b0 0c 91 c0 55 d6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a7 73 b0 0c 91 c0 55 d6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.53:48048',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200324
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45656
received auth hello!
{ authId: 402, nonce: <Buffer cd 96 d7 dd 2b de 86 d0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9a f2 14 a0 bd 95 48 7e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ed d1 f6 c6 15 2a d4 10>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ed d1 f6 c6 15 2a d4 10> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.53:48320',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200331
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45926
received auth hello!
{ authId: 402, nonce: <Buffer e1 3f ac 4d 38 12 6e 41> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 18 3c 66 a5 1c e2 b4 58>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 40 76 5c 9e 52 36 f5 e6>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 40 76 5c 9e 52 36 f5 e6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.53:48590',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200338
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46196
received auth hello!
{ authId: 402, nonce: <Buffer 9f 8d 48 3e 70 98 d1 5f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4f 5c 45 0a 9a c5 a5 4b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 64 58 bc 8b c5 ef 5d 8a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 64 58 bc 8b c5 ef 5d 8a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.53:48860',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200345
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46466
received auth hello!
{ authId: 402, nonce: <Buffer 28 4e 6a 81 f2 75 e1 40> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ba 22 98 30 f1 06 3a 77>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8d 44 1c 4a 5a 94 3e 2a>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 8d 44 1c 4a 5a 94 3e 2a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.53:49130',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200352
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46736
received auth hello!
{ authId: 402, nonce: <Buffer 0a 93 2e 25 0c b4 af 85> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 32 e3 32 ac ae cf 5c ed>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 85 c6 9d 31 3b e9 2c f7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 85 c6 9d 31 3b e9 2c f7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.53:49400',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200359
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47002
received auth hello!
{ authId: 402, nonce: <Buffer d5 0f 00 cf 98 19 b4 67> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f5 04 86 eb da e6 c9 91>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1b b2 39 fa b5 5f b7 ac>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1b b2 39 fa b5 5f b7 ac> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.53:49666',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300651
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300661
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 55586
received auth hello!
{ authId: 503, nonce: <Buffer ef b6 1c 66 d8 37 d9 53> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth503',
     commonName: '10.0.1.6' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth402',
     commonName: '10.0.0.2' },
  serial: '016247448955',
  notBefore: 2018-03-21T06:33:16.000Z,
  notAfter: 2018-03-22T06:34:56.000Z,
  subjectHash: '5542437f',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '17:CF:DE:B6:D5:09:75:D3:B7:40:FB:C7:C2:D2:BA:55:D2:6C:EE:E6',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'E2C77ADB548D185210E7FA2988369325521D9CF6957B61D640674333307D4FC133154B2C56A9BBCE5655BEDE59A620D2F68A660E6DEB43308DBAFD7A396559B1C6BD0ED769D2F4066CEB2BFDB38188C4D295C06D196ECCC621767B060A3D3BCF3CF4458D7031B2D0AB66B8846DD9C1D4374DEB5D3E30D68FF926574682526527828E3BB232E36626859A826F5DA69748C9567F01930811E1C310842AAE799D7FAD1E9BE8B5D23DC0BC0D4537FC44D1FE7D84E57938DEE6D651DAEC8C897885315FE2797FFB87939E2A342186F4C566B1623BD369CC0226678E3A96E9092471F81CCC14C868DBEA8B6F0B2E5D566294136E91C2B3B101366D8A5B6642614F0CF5',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.6' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 503,
  host: '10.0.1.6',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJHRIlVMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDIxETAPBgNVBAMMCDEwLjAuMC4yMB4XDTE4MDMy\nMTA2MzMxNloXDTE4MDMyMjA2MzQ1NlowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMzERMA8GA1UEAwwIMTAuMC4xLjYwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDix3rbVI0YUhDn+imINpMlUh2c9pV7YdZAZ0MzMH1PwTMVSyxW\nqbvOVlW+3lmmINL2imYObetDMI26/Xo5ZVmxxr0O12nS9AZs6yv9s4GIxNKVwG0Z\nbszGIXZ7Bgo9O8889EWNcDGy0KtmuIRt2cHUN03rXT4w1o/5JldGglJlJ4KOO7Iy\n42YmhZqCb12ml0jJVn8BkwgR4cMQhCqueZ1/rR6b6LXSPcC8DUU3/ETR/n2E5Xk4\n3ubWUdrsjIl4hTFf4nl/+4eTnio0IYb0xWaxYjvTacwCJmeOOpbpCSRx+BzMFMho\n2+qLbwsuXVZilBNukcKzsQE2bYpbZkJhTwz1AgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQYwDQYJKoZIhvcNAQELBQADggEBABYhpM52doni6a6R3Or4nzfAvq527r0g\nEBz00RfOW9xa8MuV7aGXT4ijaiI9v0ajnopbJXO28pQScI8ubk+AjpQ9MwqWRX2i\nfBkNHWzpwLSdjab5ziPn2TbV0oFyajNeyl5OPFeAYd/e8UICR3ylSNgZuqHa43Ah\nA/YBp5gNM+k3ziJyBI5Uc0lsi8srV/b4Bj39RYKHQR5gNJ+ydPYloe2Hnq+jFwIw\npPwe47uxbdHaqUKzigeiDic/3KDbylf9y473m1Lu4lg6Sak5HAw+FWWcOiFnTqXR\nK3g8Afchz7l8SLFBXNPwc4RBhNxh6tydzpO/dndDwqqhuMF7cuUEPgs=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300671
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55800
received auth hello!
{ authId: 503, nonce: <Buffer a1 7f a5 d7 63 b3 31 8d> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 23 ce 04 92 20 0e 6f 1e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer fe 74 81 f5 6a 71 3b fe d8 99 ba f0 3b fd 7f fb>,
  macKeyVal: <Buffer f6 14 bb 2e 23 ad ff ae df 9a c5 c5 e5 8f cb 6f 0c 54 c7 fe f8 7d 22 4a 36 5e 59 e5 b0 ca ba a8>,
  absValidity: 2018-03-21T07:48:37.913Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a4 40 db c9 c9 3e 23 ca>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a4 40 db c9 c9 3e 23 ca> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.53:50754',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300681
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56024
received auth hello!
{ authId: 503, nonce: <Buffer 85 a7 d4 76 b7 82 bf 21> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 33 ec 50 a2 ce 9f 8d a9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 31 5b 24 1f 4f 47 f2 45>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 31 5b 24 1f 4f 47 f2 45> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.53:50978',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300691
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56246
received auth hello!
{ authId: 503, nonce: <Buffer f7 90 21 6f 91 e1 27 e0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fb 4e a4 7e 16 f9 86 b3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 55 d8 f1 18 c1 9f 70 6b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 55 d8 f1 18 c1 9f 70 6b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.53:51200',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300701
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56468
received auth hello!
{ authId: 503, nonce: <Buffer e5 81 f0 a3 21 6e 60 77> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c5 c9 8f b9 7a 3e 38 db>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 27 c3 07 a0 71 49 d2 d9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 27 c3 07 a0 71 49 d2 d9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.53:51422',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300711
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56690
received auth hello!
{ authId: 503, nonce: <Buffer c8 ea 97 fe 93 f3 ba 97> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c9 05 1a f1 cc 6b 04 e1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 51 f3 c0 8c df 76 07 96>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 51 f3 c0 8c df 76 07 96> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.53:51644',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300721
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56912
received auth hello!
{ authId: 503, nonce: <Buffer de ef 9c 7d da 66 12 bf> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 68 bc 10 46 92 61 2b 1d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 25 65 83 ae 2d d0 e0 2d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 25 65 83 ae 2d d0 e0 2d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.53:51866',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300731
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57134
received auth hello!
{ authId: 503, nonce: <Buffer 36 bd 0c 98 61 d2 36 41> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7f be 24 33 cf 70 a1 11>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9b b1 21 78 be 67 b6 ec>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 9b b1 21 78 be 67 b6 ec> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.53:52088',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300741
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57352
received auth hello!
{ authId: 503, nonce: <Buffer 15 2e 1a 55 14 86 4a 27> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 35 c5 7d 80 cc 4c e3 bd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5c df 7c 69 5a 20 f6 18>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 5c df 7c 69 5a 20 f6 18> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.53:52306',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300751
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57574
received auth hello!
{ authId: 503, nonce: <Buffer 54 7d 33 4e c8 46 41 ac> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c8 7f d6 0a 1b 72 8b c1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0c 99 0e 60 d8 42 c2 c2>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 0c 99 0e 60 d8 42 c2 c2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.53:52528',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300761
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57796
received auth hello!
{ authId: 503, nonce: <Buffer 4f 1f 5d 65 de 6b 50 aa> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f9 2d 51 5c 93 e6 05 34>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4c 72 98 b6 49 1f 24 f1>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 4c 72 98 b6 49 1f 24 f1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.53:52750',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300771
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58018
received auth hello!
{ authId: 503, nonce: <Buffer a5 58 30 3b 4e ef 4c 0e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6c 42 45 a4 25 1b 5d 13>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3f 86 ac 36 13 3d 13 08>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3f 86 ac 36 13 3d 13 08> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.53:52972',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300781
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58240
received auth hello!
{ authId: 503, nonce: <Buffer cb 83 07 38 2f 37 73 95> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0e 64 5e 72 fa de 59 38>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 43 ed 52 3a fe 1d 53 68>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 43 ed 52 3a fe 1d 53 68> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.53:53194',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300791
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58462
received auth hello!
{ authId: 503, nonce: <Buffer 8d d2 c4 b1 0a 4a ef 70> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fd 4f a2 76 39 37 b7 4a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d6 28 7a 37 88 75 02 e9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d6 28 7a 37 88 75 02 e9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.53:53416',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300801
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58680
received auth hello!
{ authId: 503, nonce: <Buffer 62 4c 2d b2 fc d6 76 6a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ae 75 8c 64 f3 b6 9d 63>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 49 33 62 89 62 a8 75 44>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 49 33 62 89 62 a8 75 44> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.53:53634',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300811
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58902
received auth hello!
{ authId: 503, nonce: <Buffer 3e 5a 03 ea 2d cd ed 9a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4e 2f 2b df 16 5d 6c 26>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 21 0b 50 8b 0f e7 fc 5f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 21 0b 50 8b 0f e7 fc 5f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.53:53856',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300821
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59124
received auth hello!
{ authId: 503, nonce: <Buffer 77 46 53 bb ac 9f 32 a7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 96 d8 7c 6a f6 ad ee 4d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6a 44 3d a2 46 c9 83 ac>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6a 44 3d a2 46 c9 83 ac> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.53:54078',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300831
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59346
received auth hello!
{ authId: 503, nonce: <Buffer db 7b c6 60 60 7c 93 7b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 77 77 51 72 6b 31 eb 4b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b4 c7 d5 ca aa 4d ea d3>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b4 c7 d5 ca aa 4d ea d3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 24,
  remoteAddress: '::ffff:10.0.1.53:54300',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 24 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 24 }
specified socketID: 24
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #24 closed
