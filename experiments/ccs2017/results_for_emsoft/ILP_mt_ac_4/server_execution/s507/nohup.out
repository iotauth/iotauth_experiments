changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s507.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's507',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 6d 66 ... > }
Handler: listening on port 22100
s507:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100545
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58404
received auth hello!
{ authId: 501, nonce: <Buffer 42 87 a1 ae 7b 21 ae 60> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer ca aa e8 14 b4 57 ec ae>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer eb c9 ca ff f5 41 9b 64 28 f2 f9 e0 1b 9e 62 91>,
  macKeyVal: <Buffer 16 00 19 a9 9f bd b1 99 0c 92 ef f5 7f b9 4c aa 2d 02 e6 8a 2d e7 df 2d a7 3a 57 43 be 10 fe bb>,
  absValidity: 2018-03-21T07:37:37.209Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 07 cc 93 cb 94 66 4e 03>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 07 cc 93 cb 94 66 4e 03> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.71:43842',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100553
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58676
received auth hello!
{ authId: 501, nonce: <Buffer 79 da cb 4c d2 40 0e 64> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ff 07 27 93 98 65 ff 59>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f3 c7 97 23 dc 0e f3 f7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f3 c7 97 23 dc 0e f3 f7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.71:44114',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100561
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58946
received auth hello!
{ authId: 501, nonce: <Buffer e2 e6 12 dc 23 91 99 1c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2f c5 15 ce b2 de 0d a6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8e df 9b 55 3b 8d 7c 9f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8e df 9b 55 3b 8d 7c 9f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.71:44384',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100569
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59216
received auth hello!
{ authId: 501, nonce: <Buffer 97 5a 16 da 9d a3 25 e5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 44 23 4e fe 5e 42 4f 6b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 79 9a 70 40 79 32 44 f4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 79 9a 70 40 79 32 44 f4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.71:44654',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100577
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59486
received auth hello!
{ authId: 501, nonce: <Buffer fb 3b 3f 09 9c bb 98 ee> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 97 e6 51 f8 46 4e bc 63>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2d 6b fb a7 26 4d 88 1d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 2d 6b fb a7 26 4d 88 1d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.71:44924',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100585
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59756
received auth hello!
{ authId: 501, nonce: <Buffer 49 2a f6 73 58 2f 50 dd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 96 1f 18 aa fe da 46 26>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2b 01 79 85 a2 01 cb 80>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 2b 01 79 85 a2 01 cb 80> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.71:45194',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100593
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60022
received auth hello!
{ authId: 501, nonce: <Buffer 49 d2 06 36 ab 8e 23 69> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d5 de 43 26 cf 00 dc 35>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 56 79 fd 88 23 da 65 4e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 56 79 fd 88 23 da 65 4e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.71:45460',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200884
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200897
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 55378
received auth hello!
{ authId: 502, nonce: <Buffer 4e 51 f7 c9 86 0b 48 00> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '016247448BCF',
  notBefore: 2018-03-21T06:33:17.000Z,
  notAfter: 2018-03-22T06:34:57.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'BC:93:7A:E9:07:32:EB:DC:53:6B:77:89:6D:3B:B2:C7:7B:21:7A:DC',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'AEEAB02ACD0C32937DD84F3EB43F6189EAF089B04CE490F227FEC1E1A42FF33AACC957083F15D2CFEBF0E484D5D2BD03DD21587B3DF0ADCF1F273CEB6D3ADD0C5BD72406DA2D4A379546AD8D1C72FF3DB6ECF5D19A3A100B89C7B659A65778923B085EE02B29C23C0BF27314DEEC84CC61B318C930EC82C3B5DB050AD2527763CDCB5CEE65C7B2D7C1052512A2B08B2601CA1A4E32273B811E50FD7E40A702A19D8D7DB1E27E4C4E0A2F783C9AE1F654053799A646075FDCF3A86C68C654BCCA093F1A4B4044DAAFAB0E1FA7692D70BA1D4DBF798207A97EFFA87E7F6BE94B5E3D49438D87392AA382C0493F6F6E59A3B858B64877C59B95478C667FEE6CD71D',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJHRIvPMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDMy\nMTA2MzMxN1oXDTE4MDMyMjA2MzQ1N1owYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQCu6rAqzQwyk33YTz60P2GJ6vCJsEzkkPIn/sHhpC/zOqzJVwg/\nFdLP6/DkhNXSvQPdIVh7PfCtzx8nPOttOt0MW9ckBtotSjeVRq2NHHL/Pbbs9dGa\nOhALice2WaZXeJI7CF7gKynCPAvycxTe7ITMYbMYyTDsgsO12wUK0lJ3Y83LXO5l\nx7LXwQUlEqKwiyYByhpOMic7gR5Q/X5ApwKhnY19seJ+TE4KL3g8muH2VAU3maZG\nB1/c86hsaMZUvMoJPxpLQETar6sOH6dpLXC6HU2/eYIHqX7/qH5/a+lLXj1JQ42H\nOSqjgsBJP29uWaO4WLZId8WblUeMZn/ubNcdAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAMfzbWnVYMjPYxn4+EnClH/XkOUMXvVB\nua7cZsOmrMfe9PRU6xG/FgnQqnQ6F5a4dplZNDPQE3xpM/OIrKxD6zQjPvF+SrS1\nHB4pJ/yUwzefUkF5endnLSbACBYeKQyDAwpp14U3q4btjbi9QllUdjYBsYe/0ZG1\nfMz8NTKoQYZWgT4Ayb/Np40tt80cO7qy8fFd2wEc8rj5ZhNI8FyUKxh4TtXM5OaQ\nHjWQc728fX5FksHukitiFQByxV0m2zvy4ZgL1voBFzTrW6v65+I+LW6FsMOi0Ikw\nEOWRt5BkmnCMMWkftm7nt9rocgj1mcfR4JBfD7A33P2WRSGApLq/l1I=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200910
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55598
received auth hello!
{ authId: 502, nonce: <Buffer d9 be 9b a7 7a 1e fe b4> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 07 41 43 fe 59 16 2f 75>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 6a 89 03 d1 30 ee 27 50 35 67 b4 90 23 06 ec 51>,
  macKeyVal: <Buffer 19 da 8a 61 9f 12 c4 e8 6d f4 11 6c 5d 19 8c 4d 20 56 63 2c 7a b8 c3 68 c2 ff 37 83 c6 e4 71 01>,
  absValidity: 2018-03-21T07:48:36.243Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 30 8f b2 50 04 44 85 ae>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 30 8f b2 50 04 44 85 ae> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.71:46548',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200923
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55822
received auth hello!
{ authId: 502, nonce: <Buffer 92 b0 20 93 3d 9c e5 95> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 27 16 97 29 61 24 c7 89>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 07 8b 85 46 ea f4 5b 5e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 07 8b 85 46 ea f4 5b 5e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.71:46772',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200936
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56044
received auth hello!
{ authId: 502, nonce: <Buffer f0 93 96 ac 84 0a 13 e7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8b 65 07 4d 62 01 e7 84>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 85 ec 4e 6f 9b db 50 d3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 85 ec 4e 6f 9b db 50 d3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.71:46994',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200949
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56266
received auth hello!
{ authId: 502, nonce: <Buffer 39 8e 26 1f a2 70 f1 42> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 25 28 3b 36 98 73 c0 59>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cd c9 47 7d 20 70 96 2b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer cd c9 47 7d 20 70 96 2b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.71:47216',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200962
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56488
received auth hello!
{ authId: 502, nonce: <Buffer f8 92 08 76 ec a6 0f 5b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 66 88 83 86 f7 28 e2 d4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 45 1f 3e 66 aa d3 9f 39>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 45 1f 3e 66 aa d3 9f 39> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.71:47438',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200975
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56710
received auth hello!
{ authId: 502, nonce: <Buffer bc 5b 9e 65 76 4e 01 ad> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3c d2 9c 3e 2d 8b 7f 8a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a6 af d8 59 17 26 44 27>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a6 af d8 59 17 26 44 27> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.71:47660',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200988
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56932
received auth hello!
{ authId: 502, nonce: <Buffer 16 ba b2 63 44 5d 3a 68> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 89 fd 9c fb 02 5d 6f bf>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a5 0e 90 7b 94 e6 36 df>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a5 0e 90 7b 94 e6 36 df> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.71:47882',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201001
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57150
received auth hello!
{ authId: 502, nonce: <Buffer 1f c3 89 43 a3 e2 84 44> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 74 28 d3 65 9b ca ea 04>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer eb a5 36 78 8d 62 eb d0>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer eb a5 36 78 8d 62 eb d0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.71:48100',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201014
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57372
received auth hello!
{ authId: 502, nonce: <Buffer e5 9a d6 4f b1 66 0f 12> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e7 1e dc cf c7 b5 04 d4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d0 f2 66 4e 8e a5 cf fd>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d0 f2 66 4e 8e a5 cf fd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.71:48322',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201027
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57594
received auth hello!
{ authId: 502, nonce: <Buffer 13 be c1 75 18 a1 5e 73> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 79 c9 da fe b2 b7 7c 79>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 63 c8 98 d3 53 7e d8 0e>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 63 c8 98 d3 53 7e d8 0e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.71:48544',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201040
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57816
received auth hello!
{ authId: 502, nonce: <Buffer 19 25 0d 1b 84 93 23 4b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1d ae 25 d9 79 56 db 86>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a7 ad ae bd 7c 14 04 da>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer a7 ad ae bd 7c 14 04 da> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.71:48766',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201053
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58038
received auth hello!
{ authId: 502, nonce: <Buffer 43 99 3b 53 23 0b 65 99> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f3 e2 58 20 e5 11 3c 29>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d8 7f 59 ae 3a db 68 1e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d8 7f 59 ae 3a db 68 1e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.71:48988',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201066
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58260
received auth hello!
{ authId: 502, nonce: <Buffer 84 41 93 70 12 9f 10 c1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9d 7e 9c 95 ae b5 3e 60>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9b 6a d3 dc 52 d3 5a d1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9b 6a d3 dc 52 d3 5a d1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.71:49210',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201079
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58478
received auth hello!
{ authId: 502, nonce: <Buffer 36 51 5e fd 2e 64 c2 6d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9d 48 8a 01 24 bc 44 a5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 88 c7 a9 ce 89 a7 4b b1>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 88 c7 a9 ce 89 a7 4b b1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.71:49428',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201092
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58700
received auth hello!
{ authId: 502, nonce: <Buffer e1 b9 38 a2 32 e3 99 b6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 96 0a 04 4c c5 cd e4 66>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer dc 3a 54 9f c0 11 88 63>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer dc 3a 54 9f c0 11 88 63> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.71:49650',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201105
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58922
received auth hello!
{ authId: 502, nonce: <Buffer ed fd 8b ca 35 fb 8d a6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fd 22 f2 14 54 54 eb 69>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4b 9a 4a 9f d5 bd ad 9f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4b 9a 4a 9f d5 bd ad 9f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.71:49872',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201118
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59144
received auth hello!
{ authId: 502, nonce: <Buffer 32 89 0a af d1 eb e1 ab> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7c f0 be fa 30 ad db fc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 33 25 7d 89 97 f3 24 ce>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 33 25 7d 89 97 f3 24 ce> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.71:50094',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
