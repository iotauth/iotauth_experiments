changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s516.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's516',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 76 34 ... > }
Handler: listening on port 22100
s516:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300738
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51576
received auth hello!
{ authId: 503, nonce: <Buffer 6a ae 7a a5 69 20 8b 9a> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 54 78 f2 a2 35 ad 8a e3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 4a 5e 50 bb dd 1b 5f 80 8b 37 45 31 71 25 06 25>,
  macKeyVal: <Buffer 54 a2 b3 73 5f 0b b5 b1 27 d3 af 9f f5 ad 4b d9 f5 58 07 37 af 55 3a 48 78 39 c4 15 7f 32 40 57>,
  absValidity: 2018-03-21T04:23:37.560Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 57 ab e8 79 6f 21 db fe>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 57 ab e8 79 6f 21 db fe> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.82:60418',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300743
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51846
received auth hello!
{ authId: 503, nonce: <Buffer 89 a4 f6 1a 88 31 fa 9b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 17 27 4c c8 b6 42 b1 e1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 79 58 42 46 69 4e 05 9a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 79 58 42 46 69 4e 05 9a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.82:60688',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300748
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52116
received auth hello!
{ authId: 503, nonce: <Buffer 00 83 bc 53 e4 6c 3b f2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d3 e3 e6 59 fd 2f 30 b9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 04 64 a6 2b e9 b6 58 86>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 04 64 a6 2b e9 b6 58 86> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.82:60958',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300753
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52386
received auth hello!
{ authId: 503, nonce: <Buffer b1 2c b4 1d 2f b7 9a 68> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 06 05 88 07 91 ed e1 78>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c6 83 db ae ab 49 f1 3e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c6 83 db ae ab 49 f1 3e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.82:32996',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300758
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52656
received auth hello!
{ authId: 503, nonce: <Buffer b2 18 ea 8a 9c 5a 96 2c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 42 8a 69 67 a1 53 cd da>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d5 23 3e 6b 4e a1 a8 49>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d5 23 3e 6b 4e a1 a8 49> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.82:33266',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300763
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52926
received auth hello!
{ authId: 503, nonce: <Buffer 36 78 4c 0c 36 14 d0 24> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bf 3f 82 bc 35 58 1a 6d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a0 f7 9c 97 78 cb cf 5e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a0 f7 9c 97 78 cb cf 5e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.82:33536',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300768
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53184
received auth hello!
{ authId: 503, nonce: <Buffer 49 5f 91 a3 95 52 08 9a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e7 50 52 2b 94 a4 a5 be>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1a 92 bf 33 cb 37 c6 64>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1a 92 bf 33 cb 37 c6 64> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.82:33794',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201425
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201444
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
Handler: Error in server - details: handshake2 timed out...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in server - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.1:21100
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in server - details: Error occurred in migration request: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201472
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
connected to auth! from local port 50770
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 5d 7f 53 2e e0 4e dc e8> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth503',
     commonName: '10.0.0.6' },
  serial: '0162469268AF',
  notBefore: 2018-03-21T03:18:42.000Z,
  notAfter: 2018-03-22T03:20:22.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '1D:27:C3:AB:64:0A:C5:CD:65:6B:32:D2:6F:93:CB:C2:3A:F2:93:CA',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'FF6CB5202497CC77AF28EFDE774858E4FEF04355E5228E378962DF4235BE3683DAF9E38A7E22621D66B3B50166D897E97BF911F9E8FC09D686961AA39679014E5DDD27EA0F02DE853A41537DB5E37F33395E249F355C0D074419572E9856D1D598CAB2CD6951013DDCB0A163B943DFCD2694BE18B9B3892695B3052EBD9115D447293C83AF24A008794B842E4F0A6C2A8D0189612A600AA40A592603E43713C0ECCA681024E5EC429FAD09484B824919DF59C8BD488E0D372D2A3D8B99B6068E24BBBDA8F0BCDDBA806010E4A7181736DF08D4D1CFC16E26507C360EDCBFF1B5F4288CE304DE62E9696665C5108489AD7232658356998FF47C4F7E8A04225423',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJGkmivMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDMxETAPBgNVBAMMCDEwLjAuMC42MB4XDTE4MDMy\nMTAzMTg0MloXDTE4MDMyMjAzMjAyMlowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQD/bLUgJJfMd68o7953SFjk/vBDVeUijjeJYt9CNb42g9r544p+\nImIdZrO1AWbYl+l7+RH56PwJ1oaWGqOWeQFOXd0n6g8C3oU6QVN9teN/MzleJJ81\nXA0HRBlXLphW0dWYyrLNaVEBPdywoWO5Q9/NJpS+GLmziSaVswUuvZEV1EcpPIOv\nJKAIeUuELk8KbCqNAYlhKmAKpApZJgPkNxPA7MpoECTl7EKfrQlIS4JJGd9ZyL1I\njg03LSo9i5m2Bo4ku72o8LzduoBgEOSnGBc23wjU0c/BbiZQfDYO3L/xtfQojOME\n3mLpaWZlxRCEia1yMmWDVpmP9HxPfooEIlQjAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAB9w+Zza1811ywob7sNL2ckUhOnGDdVD\nta9ZoMiKoFtFgIdUUlnoZYPadNkJTl2ayABCgcmxyoxzu+RCgqRt06bnMo5nKm4a\nW6B3HLeuhn+GJGW0vm0icZlJ4U0m3c77+2CSqlax059NU51OrhHCTfj7IWzFiJQc\np0CBkqEAnggC7t0w6sDezoz4GxcuHNDT/mk8Lf8IiswoiBBu2FL2hQVGJdpTJhfX\ngFHEZt8jLuY3XjtNxcaLNAAmcM+3nGf4uFLqqMEznVltZDzER16/rksEjHmN2nCK\neucQDIdmpACkbVZVychpOS4kFx6qyMTtrGkWbiSKDpqivzR0IthSilI=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 1
to: 2
disconnected from auth
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201487
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50914
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201555
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51598
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201571
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51762
Handler: Error in server - details: handshake2 timed out...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201584
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51892
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
received auth hello!
{ authId: 502, nonce: <Buffer c1 24 f5 d7 70 ec a7 aa> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer a2 15 3b 7a 4b af 36 88>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 5a 2f 90 8c 20 1f a3 77 48 7d 23 fe e5 3f ca 13>,
  macKeyVal: <Buffer 56 16 5f 67 98 79 fb d4 36 38 8b c2 d3 14 14 dc fd ec e6 51 fd 4c a5 e8 37 31 f5 ef 02 e2 21 ad>,
  absValidity: 2018-03-21T04:45:09.046Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c6 de 55 fe 23 db f4 26>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c6 de 55 fe 23 db f4 26> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.82:36274',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201593
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51988
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201606
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52138
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201619
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52282
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 07 46 54 ee e2 67 83 bb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2c f7 f3 ec 76 d2 79 94>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 28 81 1a ef a6 1f 0c 48>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 28 81 1a ef a6 1f 0c 48> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.82:36664',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201635
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52440
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer d1 e2 d0 22 32 78 53 03> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 18 20 cb 59 93 b2 6c f3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 28 50 f9 49 e3 17 e6 ab>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 28 50 f9 49 e3 17 e6 ab> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.82:36822',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201646
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52560
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201661
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52702
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 0f 49 07 5b a0 23 95 59> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 81 20 8a e5 bd af d5 15>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c3 d6 a2 5d 01 c4 0d 39>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c3 d6 a2 5d 01 c4 0d 39> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.82:37084',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
received auth hello!
{ authId: 502, nonce: <Buffer 50 99 ac de 74 c3 f5 6b> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: write after end
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
disconnected from auth
received auth hello!
{ authId: 502, nonce: <Buffer ed 0d 61 89 fc 90 e3 00> }
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: write after end
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in server - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.6:21100
Handler: Error in server - details: Connection with Auth timed out...
disconnected from auth
received auth hello!
{ authId: 502, nonce: <Buffer f8 34 48 ef 5b 04 75 87> }
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: write after end
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in server - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.6:21100
disconnected from auth
