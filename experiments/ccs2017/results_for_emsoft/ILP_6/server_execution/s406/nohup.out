changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s406.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's406',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 67 49 42 41 41 4b 43 41 51 45 41 73 33 ... > }
Handler: listening on port 22100
s406:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200417
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41424
received auth hello!
{ authId: 402, nonce: <Buffer c4 0c cb c7 bb 99 8a ee> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 0b fb 87 63 d6 f3 b6 86>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 93 0a 19 7a b9 b4 44 54 3d 33 f3 b4 50 db fa 4c>,
  macKeyVal: <Buffer 06 76 34 b1 95 e9 1a 66 cf f4 7c 94 be 63 52 da 17 42 93 2b e5 c0 13 b7 fb 4b 5a f9 86 90 5d f5>,
  absValidity: 2018-03-21T04:21:52.264Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 54 b2 18 e5 f2 d3 fd 47>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 54 b2 18 e5 f2 d3 fd 47> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.50:56272',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200424
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41580
received auth hello!
{ authId: 402, nonce: <Buffer a6 4c a3 35 67 63 44 4b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 59 92 6f 6a b7 31 af b9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 73 21 5e f2 a6 4b 49 90>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 73 21 5e f2 a6 4b 49 90> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.50:56428',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200431
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41842
received auth hello!
{ authId: 402, nonce: <Buffer 87 2b e6 18 18 c9 c9 3d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 56 b6 ba 57 4b 1a 15 46>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 87 b5 bd 1d dc 14 86 3d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 87 b5 bd 1d dc 14 86 3d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.50:56690',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200438
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42112
received auth hello!
{ authId: 402, nonce: <Buffer 1b 6a 7a 26 63 45 da 5c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 10 48 2a 5f 9e 7d f8 0e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d3 26 8a 7d ca 94 42 36>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d3 26 8a 7d ca 94 42 36> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.50:56960',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200445
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42382
received auth hello!
{ authId: 402, nonce: <Buffer 85 47 93 a5 58 55 cb fa> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ce 44 44 c0 6d b2 af e9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e5 14 aa ae 55 96 7c 95>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e5 14 aa ae 55 96 7c 95> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.50:57230',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200452
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42652
received auth hello!
{ authId: 402, nonce: <Buffer 12 79 f9 f6 8e d2 9f 2f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a3 a0 44 fc 9b 1a ea 63>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c1 2f 94 13 25 c7 f7 63>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c1 2f 94 13 25 c7 f7 63> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.50:57500',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200459
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42922
received auth hello!
{ authId: 402, nonce: <Buffer 34 9f ce c3 46 eb 8b de> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7e bf ad 8e b1 41 0b ad>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 51 1f d8 b5 7a eb c8 ee>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 51 1f d8 b5 7a eb c8 ee> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.50:57770',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200466
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43192
received auth hello!
{ authId: 402, nonce: <Buffer ee 94 4a 22 f4 fb d5 e3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4a df 1c df 57 85 4f 6a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 63 59 23 e6 cb d3 f4 77>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 63 59 23 e6 cb d3 f4 77> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.50:58040',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
