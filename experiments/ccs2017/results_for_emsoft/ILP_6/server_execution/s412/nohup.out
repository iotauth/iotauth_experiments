changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s412.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's412',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 67 49 42 41 41 4b 43 41 51 45 41 74 63 ... > }
Handler: listening on port 22100
s412:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300619
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44754
received auth hello!
{ authId: 403, nonce: <Buffer e0 50 04 cb 25 4c 96 66> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 03 bd 1c 33 9d af 4e 13>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer be 58 42 45 11 38 90 fe 95 72 aa c1 0a b8 75 a2>,
  macKeyVal: <Buffer b9 35 96 c2 f1 f7 0d 7a 10 cf 38 38 48 5c 78 eb b9 36 83 77 7d c4 db fd 1f 72 00 b5 1c ff 45 fd>,
  absValidity: 2018-03-21T04:22:14.953Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e2 3a 76 ed bf e2 41 b3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e2 3a 76 ed bf e2 41 b3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.57:53824',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300625
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44952
received auth hello!
{ authId: 403, nonce: <Buffer a7 dd 9e cd 1a 6e 1a 51> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 89 cf d6 b1 68 a4 a1 78>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 70 63 83 2a b7 7e fe e8>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 70 63 83 2a b7 7e fe e8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.57:54022',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300631
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45224
received auth hello!
{ authId: 403, nonce: <Buffer 57 40 49 80 01 09 20 af> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 08 d9 c6 ba 2e f5 ce a0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fc 14 f1 b4 6f bd d2 c6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fc 14 f1 b4 6f bd d2 c6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.57:54294',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300637
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45494
received auth hello!
{ authId: 403, nonce: <Buffer cb 9a 87 0f c6 54 d3 97> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 50 0f 1a f8 3f ce 8f fa>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d9 07 1b 6c b1 57 c2 be>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d9 07 1b 6c b1 57 c2 be> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.57:54564',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300643
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45764
received auth hello!
{ authId: 403, nonce: <Buffer 6b c0 58 8e bc 9d e6 35> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d0 8d 66 a3 e7 80 f1 8c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cd a2 23 05 50 30 af 6f>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer cd a2 23 05 50 30 af 6f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.57:54834',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300649
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46034
received auth hello!
{ authId: 403, nonce: <Buffer 6b e8 2e 2c 6b a5 c8 d7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2e 92 69 78 68 72 ae 65>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a9 7e 5f 68 c4 a9 61 45>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a9 7e 5f 68 c4 a9 61 45> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.57:55104',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300655
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46304
received auth hello!
{ authId: 403, nonce: <Buffer b7 8b fa e2 db a4 c6 ce> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a6 2a 3c bf 4d 86 60 31>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 13 1c 0a 04 48 04 37 19>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 13 1c 0a 04 48 04 37 19> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.57:55374',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300661
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46570
received auth hello!
{ authId: 403, nonce: <Buffer 31 d1 ee 77 9d e0 c3 6c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 65 cb 8d 2f ba 40 fe 23>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 96 c8 70 ac b3 b3 18 79>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 96 c8 70 ac b3 b3 18 79> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.57:55640',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
