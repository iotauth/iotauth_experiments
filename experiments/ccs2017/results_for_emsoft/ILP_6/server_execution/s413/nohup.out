changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s413.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's413',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 30 6d ... > }
Handler: listening on port 22100
s413:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300620
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58904
received auth hello!
{ authId: 403, nonce: <Buffer 63 f7 82 ef d6 7c bd db> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer c8 59 44 fb db bf 6c 2d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 6a c0 a2 24 dd 8e 2d f6 66 3c 7c cb e4 a9 ac 08>,
  macKeyVal: <Buffer fe 96 52 42 6a 73 11 61 3d 36 1b 92 a9 0c 4f c9 a1 51 cd 0d 95 9f 11 40 7e a9 36 21 a0 39 d7 77>,
  absValidity: 2018-03-21T04:22:18.117Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 78 f8 06 a8 3b 25 cb 1c>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 78 f8 06 a8 3b 25 cb 1c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.58:37532',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300626
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59108
received auth hello!
{ authId: 403, nonce: <Buffer 74 d9 48 81 30 21 b4 82> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 83 92 6d af 38 2a 48 52>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 58 35 d2 41 be 8b 58 f2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 58 35 d2 41 be 8b 58 f2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.58:37736',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300632
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59380
received auth hello!
{ authId: 403, nonce: <Buffer 75 50 b2 43 14 c0 e1 37> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 48 24 d3 6b d1 4a a6 70>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7a a6 10 46 f8 d1 95 a9>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 7a a6 10 46 f8 d1 95 a9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.58:38008',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300638
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59650
received auth hello!
{ authId: 403, nonce: <Buffer 3f d7 9a ff 2d b9 1d 55> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 38 4e 0c 48 8c e7 8f b6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d5 43 62 86 48 81 0b d9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d5 43 62 86 48 81 0b d9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.58:38278',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300644
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59920
received auth hello!
{ authId: 403, nonce: <Buffer 84 02 23 98 19 db b9 7b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 66 de c9 55 16 8d e5 03>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 98 7f e7 d4 da d2 1c 19>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 98 7f e7 d4 da d2 1c 19> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.58:38548',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300650
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60190
received auth hello!
{ authId: 403, nonce: <Buffer 64 a3 2f 60 e0 97 59 fe> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f7 3d ec ce 46 c7 4b 6a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b8 e4 05 b6 96 b3 39 ca>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b8 e4 05 b6 96 b3 39 ca> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.58:38818',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300656
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60460
received auth hello!
{ authId: 403, nonce: <Buffer 67 c9 b7 09 55 52 d5 d9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 31 97 3a 2f 64 40 d6 84>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a8 1f 2c 2a 0e a3 c6 66>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a8 1f 2c 2a 0e a3 c6 66> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.58:39088',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300662
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60726
received auth hello!
{ authId: 403, nonce: <Buffer e7 8a 3b ca 7c a7 26 fc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e5 6d 44 1b 8e ca 1d 7f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 85 7c 0d bd 2b ba 5b ba>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 85 7c 0d bd 2b ba 5b ba> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.58:39354',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
