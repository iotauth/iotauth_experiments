changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s513.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's513',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 75 2f ... > }
Handler: listening on port 22100
s513:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300735
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40116
received auth hello!
{ authId: 502, nonce: <Buffer e0 3f e7 39 cc 2b 52 8a> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 68 76 ba 87 88 0a da ef>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer d0 eb c2 76 64 15 1d 42 a7 ec 53 01 11 2f 00 27>,
  macKeyVal: <Buffer 2b 8d 02 0a e2 aa 7e 73 11 70 6a b0 1d b9 a7 03 43 e7 21 aa 86 13 a7 4d c4 3b 22 7e b0 6b 74 87>,
  absValidity: 2018-03-21T04:23:28.981Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6a 2b 28 56 12 e4 e7 cc>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 6a 2b 28 56 12 e4 e7 cc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.79:53832',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300740
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40386
received auth hello!
{ authId: 502, nonce: <Buffer d5 2b cc 3b 14 8f b2 82> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f8 c0 c5 af 95 e6 49 07>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9e 4b dc e2 84 31 d5 ca>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9e 4b dc e2 84 31 d5 ca> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.79:54104',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300745
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40656
received auth hello!
{ authId: 502, nonce: <Buffer 1d ed 22 07 24 40 26 1f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b8 6e b7 86 7d cc 32 37>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 90 2b 08 aa 4c de 9d d1>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 90 2b 08 aa 4c de 9d d1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.79:54374',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300750
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40926
received auth hello!
{ authId: 502, nonce: <Buffer 33 b8 50 32 89 b5 1a 6e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 19 bf 2f f6 bc 17 4e e2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5a 3a c3 cf f7 62 c4 9f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5a 3a c3 cf f7 62 c4 9f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.79:54644',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300755
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41196
received auth hello!
{ authId: 502, nonce: <Buffer a1 c0 d0 1c e7 4b a8 cd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b7 5b 17 df 2c 62 f3 0a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7d 35 59 20 70 dc 1d 33>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 7d 35 59 20 70 dc 1d 33> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.79:54914',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300760
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41466
received auth hello!
{ authId: 502, nonce: <Buffer 76 12 22 b0 36 6e d5 ef> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a2 6f 11 9a 02 26 27 1a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e7 49 23 3b 35 d8 16 bf>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e7 49 23 3b 35 d8 16 bf> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.79:55184',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300765
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41732
received auth hello!
{ authId: 502, nonce: <Buffer 3d 28 b4 58 73 33 59 da> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6b af 1c fa 94 77 95 f5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 69 2a 2d 4c 88 7a a4 3d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 69 2a 2d 4c 88 7a a4 3d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.79:55450',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201407
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42420
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201423
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42604
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201442
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42788
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 04 66 f4 ca 66 9c 89 27> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 18 2f 0b de 47 cc e9 68>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 50 12 92 b4 d7 b2 6c 3b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 50 12 92 b4 d7 b2 6c 3b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.79:56506',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201458
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42968
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201470
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43098
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201485
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43254
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201499
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43404
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201515
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43560
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201530
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43714
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201575
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44166
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201591
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44322
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201603
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44460
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201627
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44716
Handler: Error in server - details: handshake2 timed out...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201630
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44752
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201654
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44992
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 36 78 91 fa e9 b0 e1 25> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9a 03 b0 fe 01 1d a3 6f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3f 07 8f 09 92 eb 74 3b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 3f 07 8f 09 92 eb 74 3b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.79:58710',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201667
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45116
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
received auth hello!
{ authId: 502, nonce: <Buffer f3 82 f1 fb 14 74 20 03> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bf 84 c7 97 06 cf 54 27>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 53 46 6c 84 68 d3 ae ce>
Handler: Error in server - details: Error during comm init, details: Error: This socket has been ended by the other party
switching to HANDSHAKE_2_SENT
disconnected from auth
received auth hello!
{ authId: 502, nonce: <Buffer 6e 47 c0 80 5c e8 02 86> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: write after end
received auth hello!
{ authId: 502, nonce: <Buffer cb ba 09 fd 58 1d ae ed> }
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
Failed to migrate! host/port of current Auth is the same as host of the Auth which we migrate to
Handler: Error in server - details: Error occurred in session key request: Error: write after end
disconnected from auth
disconnected from auth
received auth hello!
{ authId: 502, nonce: <Buffer 9c 9d a1 22 c3 80 17 4a> }
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
Failed to migrate! host/port of current Auth is the same as host of the Auth which we migrate to
Handler: Error in server - details: Error occurred in session key request: Error: write after end
received auth hello!
{ authId: 502, nonce: <Buffer 31 98 01 6e 57 1c 3c ba> }
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
Failed to migrate! host/port of current Auth is the same as host of the Auth which we migrate to
Handler: Error in server - details: Error occurred in session key request: Error: write after end
received auth hello!
{ authId: 502, nonce: <Buffer 53 c7 5a b3 b9 05 71 ca> }
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
Failed to migrate! host/port of current Auth is the same as host of the Auth which we migrate to
Handler: Error in server - details: Error occurred in session key request: Error: write after end
disconnected from auth
Handler: Error in server - details: Connection with Auth timed out...
