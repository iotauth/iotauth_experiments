changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s511.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's511',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 77 2f ... > }
Handler: listening on port 22100
s511:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201339
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42424
received auth hello!
{ authId: 502, nonce: <Buffer 81 c0 41 c5 03 f5 16 7a> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer ad ce ae 34 c9 17 58 20>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 6d 8b c8 09 be ff 62 31 df 93 88 e7 80 93 3f 4e>,
  macKeyVal: <Buffer ce 7a b1 c3 46 62 93 79 2a f1 d2 15 8a 3f 49 dc 8d d8 e7 db e3 78 ce fa 62 6d 95 d0 97 3e 1d 71>,
  absValidity: 2018-03-21T04:23:18.901Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 12 75 f1 43 4f 04 84 58>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 12 75 f1 43 4f 04 84 58> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.76:54706',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201346
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42694
received auth hello!
{ authId: 502, nonce: <Buffer 87 26 fe 83 76 2a 46 bc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ab 00 ee c3 2a 3d 8f a7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d7 5d 34 33 32 08 2b 5d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d7 5d 34 33 32 08 2b 5d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.76:54978',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201353
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42964
received auth hello!
{ authId: 502, nonce: <Buffer 1a 09 52 6c e4 0f 5c 3c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 16 e3 87 a9 56 7b 82 02>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 48 41 88 af 11 6e 66 6a>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 48 41 88 af 11 6e 66 6a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.76:55248',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201360
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43234
received auth hello!
{ authId: 502, nonce: <Buffer ab 80 e4 b8 56 62 cf b0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e8 f8 df 9a 34 7c 05 b9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b8 98 c2 8f fe d1 c4 0e>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b8 98 c2 8f fe d1 c4 0e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.76:55518',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201367
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43504
received auth hello!
{ authId: 502, nonce: <Buffer 3c 81 14 a5 0b 01 65 a0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 82 6d df 23 93 29 33 93>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 99 9e ff bb f1 83 24 ed>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 99 9e ff bb f1 83 24 ed> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.76:55788',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201374
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43774
received auth hello!
{ authId: 502, nonce: <Buffer 10 58 2c a2 1f b2 0d 25> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1e 9b fc 19 e8 e5 be a2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5d b6 0c 2f 61 f3 5b de>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5d b6 0c 2f 61 f3 5b de> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.76:56058',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201381
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44040
received auth hello!
{ authId: 502, nonce: <Buffer e9 9f 19 ff 3b e4 4c 57> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c7 75 80 57 07 41 92 5b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 93 67 11 a5 b8 58 de 8c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 93 67 11 a5 b8 58 de 8c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.76:56324',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201388
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44214
received auth hello!
{ authId: 502, nonce: <Buffer f3 4f 0e bf f6 94 77 fa> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2f 3b 8a 8c 22 93 6d 18>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 65 a9 08 5c 1e 9b 71 e1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 65 a9 08 5c 1e 9b 71 e1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.76:56498',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201395
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44382
received auth hello!
{ authId: 502, nonce: <Buffer 0b 05 4f f1 8b 54 f4 ae> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 18 5a 26 a5 d0 a6 7e f3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 13 d5 47 a7 41 f7 9a 7f>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 13 d5 47 a7 41 f7 9a 7f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.76:56662',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201401
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44588
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201410
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44778
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201518
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45934
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201532
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46068
Handler: Error in server - details: handshake2 timed out...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201543
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46186
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer c7 9c ff 5b 2c b1 c1 1e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ed dc 51 4c a0 d3 b5 81>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 18 6b 7b ea 2e 92 1b 8d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 18 6b 7b ea 2e 92 1b 8d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.76:58470',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201558
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46338
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 59 01 9c 40 bf 09 7d 56> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e5 78 64 8e cf c2 6c c6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0a 88 be 3d e5 93 99 cf>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0a 88 be 3d e5 93 99 cf> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.76:58622',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201572
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46484
received auth hello!
{ authId: 502, nonce: <Buffer 22 93 7d b5 7b bd b3 30> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 98 2e bc 7b 95 a9 bd e3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 59 52 08 0a 26 54 d1 02>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 59 52 08 0a 26 54 d1 02> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.76:58768',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
