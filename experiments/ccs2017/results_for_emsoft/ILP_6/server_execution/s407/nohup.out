changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s407.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's407',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 72 72 ... > }
Handler: listening on port 22100
s407:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200418
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57812
received auth hello!
{ authId: 402, nonce: <Buffer 38 ee 99 a4 44 ce b8 71> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 65 d3 7d 5e c8 6d 94 ff>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer f0 8c 61 c3 1e af 4c 6a 07 35 b2 6e b3 64 04 18>,
  macKeyVal: <Buffer 39 0a d0 ca 5a f6 2f 1d 86 ea 07 ee 9f 1b 67 db 61 eb 3b 5d af 33 97 90 ab 81 79 5c 5a e7 26 a8>,
  absValidity: 2018-03-21T04:21:55.576Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7f bf 97 e9 2a 2a b2 4e>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 7f bf 97 e9 2a 2a b2 4e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.51:58208',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200425
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57974
received auth hello!
{ authId: 402, nonce: <Buffer ec 87 b2 5a bb a4 44 15> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 56 ff 07 f8 62 a4 40 02>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 07 f2 dd 87 4b d4 58 3e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 07 f2 dd 87 4b d4 58 3e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.51:58370',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200432
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58242
received auth hello!
{ authId: 402, nonce: <Buffer 50 48 94 ad 60 43 62 4a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c3 31 11 66 c7 72 9c 85>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 43 37 39 f9 eb 7b b3 e0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 43 37 39 f9 eb 7b b3 e0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.51:58638',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200439
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58512
received auth hello!
{ authId: 402, nonce: <Buffer 43 6c 77 b3 03 b8 84 06> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8a 45 fb 70 0e ce 84 c7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 83 6b 0b 14 ea 3c bd ce>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 83 6b 0b 14 ea 3c bd ce> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.51:58908',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200446
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58782
received auth hello!
{ authId: 402, nonce: <Buffer 56 6c 6b c2 5a d1 b0 e2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6e a9 96 ca e9 be 41 56>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 56 6b 34 bc 0f f5 43 6f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 56 6b 34 bc 0f f5 43 6f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.51:59178',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200453
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59052
received auth hello!
{ authId: 402, nonce: <Buffer 6a c2 f1 ae f5 63 04 9d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6d 67 10 35 50 6a 2d 66>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 21 aa 4b a2 fd 40 ab 3f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 21 aa 4b a2 fd 40 ab 3f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.51:59448',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200460
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59322
received auth hello!
{ authId: 402, nonce: <Buffer 9e e2 35 96 8f 76 7c f9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f9 33 c4 9c c4 ed 03 68>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5a b2 d0 ee d3 83 58 30>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5a b2 d0 ee d3 83 58 30> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.51:59718',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200467
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59592
received auth hello!
{ authId: 402, nonce: <Buffer f2 cd f0 ad e3 00 58 ab> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7c e9 e0 24 0c 4e 33 e5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 90 3b ff 1b 0b 1c d1 45>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 90 3b ff 1b 0b 1c d1 45> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.51:59988',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
