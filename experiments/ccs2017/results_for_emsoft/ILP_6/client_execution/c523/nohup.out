changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c523.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c523',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 76 7a ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521602623457
connected to auth! from local port 51374
received auth hello!
{ authId: 504, nonce: <Buffer b5 2e eb cc 8b cb c3 b6> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 09 c7 ed 06 b4 e0 61 05>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 30 5c 51 e9 6d 9e fa ed 6a 04 3e 99 a9 dd 51 c3>,
  macKeyVal: <Buffer 5b e4 75 41 75 7c b4 ab db 44 c3 97 cb 73 2f ca 71 44 7e 5f 23 e2 a3 dd bc 31 72 c0 1f 16 55 21>,
  absValidity: 2018-03-21T04:23:43.621Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400191,
  cipherKeyVal: <Buffer 8f 7a 25 75 d9 8b 0d c1 9e 8e 48 99 83 53 58 04>,
  macKeyVal: <Buffer 6b e3 8d f1 ca f8 14 0f fd b5 16 78 88 a2 ff ac 6c 0b b9 16 a4 1e 13 9c eb f1 9f 4c 83 0c ef dc>,
  absValidity: 2018-03-22T03:23:43.620Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50400191,
     cipherKeyVal: <Buffer 8f 7a 25 75 d9 8b 0d c1 9e 8e 48 99 83 53 58 04>,
     macKeyVal: <Buffer 6b e3 8d f1 ca f8 14 0f fd b5 16 78 88 a2 ff ac 6c 0b b9 16 a4 1e 13 9c eb f1 9f 4c 83 0c ef dc>,
     absValidity: 2018-03-22T03:23:43.620Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 5a 75 8b 0c 4e b4 81 66>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:23:48 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521602629360
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521602683501
connected to auth! from local port 51644
received auth hello!
{ authId: 504, nonce: <Buffer 01 c2 5b 0c 96 95 41 ac> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d0 cb ef 62 1c f9 a1 29>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400197,
  cipherKeyVal: <Buffer 40 f1 2c a1 2a 31 ad a7 f4 8c bb 31 45 16 41 87>,
  macKeyVal: <Buffer ff 30 9c 5a 9e ed bb 84 70 db 7b bc 31 de 75 36 0b f2 12 78 19 7b 16 7b 78 20 47 ad 91 fd 0c 15>,
  absValidity: 2018-03-22T03:24:43.633Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50400197,
     cipherKeyVal: <Buffer 40 f1 2c a1 2a 31 ad a7 f4 8c bb 31 45 16 41 87>,
     macKeyVal: <Buffer ff 30 9c 5a 9e ed bb 84 70 db 7b bc 31 de 75 36 0b f2 12 78 19 7b 16 7b 78 20 47 ad 91 fd 0c 15>,
     absValidity: 2018-03-22T03:24:43.633Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 6b 59 c0 6a 28 3e 92 19>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:24:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521602684654
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521602743527
connected to auth! from local port 51914
received auth hello!
{ authId: 504, nonce: <Buffer 65 b4 79 42 29 6d 14 a6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 33 44 a4 0f 7c 66 8e 69>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400203,
  cipherKeyVal: <Buffer f6 44 7d f0 04 96 26 bf 00 58 a9 2d 65 8e 81 0e>,
  macKeyVal: <Buffer 7d 24 82 d7 60 01 fd 77 bb 06 db ce ed 9c 8a c6 f1 05 6d e6 5c 29 86 62 d4 ca dc c9 86 49 dd b9>,
  absValidity: 2018-03-22T03:25:43.673Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50400203,
     cipherKeyVal: <Buffer f6 44 7d f0 04 96 26 bf 00 58 a9 2d 65 8e 81 0e>,
     macKeyVal: <Buffer 7d 24 82 d7 60 01 fd 77 bb 06 db ce ed 9c 8a c6 f1 05 6d e6 5c 29 86 62 d4 ca dc c9 86 49 dd b9>,
     absValidity: 2018-03-22T03:25:43.673Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 64 57 a8 49 e5 69 23 3f>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:25:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521602744564
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521602803587
connected to auth! from local port 52184
received auth hello!
{ authId: 504, nonce: <Buffer 06 88 73 85 28 73 0d 53> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 80 95 3b 13 9d 3a 06 10>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400209,
  cipherKeyVal: <Buffer e5 1f 57 f1 1e 63 a2 18 ef 36 3e f5 8f 9b 2a 97>,
  macKeyVal: <Buffer 5a 40 fe b8 d9 32 24 6c d3 66 6a b9 4f 21 ed d1 e9 9e a5 c0 47 08 fd 2d bf 79 02 17 13 05 c1 dd>,
  absValidity: 2018-03-22T03:26:43.738Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50400209,
     cipherKeyVal: <Buffer e5 1f 57 f1 1e 63 a2 18 ef 36 3e f5 8f 9b 2a 97>,
     macKeyVal: <Buffer 5a 40 fe b8 d9 32 24 6c d3 66 6a b9 4f 21 ed d1 e9 9e a5 c0 47 08 fd 2d bf 79 02 17 13 05 c1 dd>,
     absValidity: 2018-03-22T03:26:43.738Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 14 e0 c3 78 6b 21 e2 3f>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:26:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521602804621
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521602863646
connected to auth! from local port 52454
received auth hello!
{ authId: 504, nonce: <Buffer 24 84 9b f6 ef a2 18 57> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c3 59 c7 cb 52 1f 8a 79>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400215,
  cipherKeyVal: <Buffer aa 3b 6d c8 2e 66 2d e5 fa b5 96 1f fe ac 27 e5>,
  macKeyVal: <Buffer 7b 5b 5a c6 17 93 95 ef 0b 57 5e b7 eb e3 19 fd 02 ee ff 9b 71 3b 8d c0 d5 94 83 48 f5 54 f8 c5>,
  absValidity: 2018-03-22T03:27:43.785Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50400215,
     cipherKeyVal: <Buffer aa 3b 6d c8 2e 66 2d e5 fa b5 96 1f fe ac 27 e5>,
     macKeyVal: <Buffer 7b 5b 5a c6 17 93 95 ef 0b 57 5e b7 eb e3 19 fd 02 ee ff 9b 71 3b 8d c0 d5 94 83 48 f5 54 f8 c5>,
     absValidity: 2018-03-22T03:27:43.785Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 0b 6c 1b 2e 18 41 25 7f>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:27:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521602864641
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521602923705
connected to auth! from local port 52724
received auth hello!
{ authId: 504, nonce: <Buffer 12 00 e3 ad ce 59 d2 05> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 92 c2 aa d6 c7 31 ea c5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400221,
  cipherKeyVal: <Buffer ae 9e 30 21 75 40 97 bf c9 f0 9b cd 1e c9 c9 a1>,
  macKeyVal: <Buffer 31 81 73 4f 23 21 6a 45 99 c6 27 8e 91 dd 46 c4 69 fb ff 79 69 76 75 a1 81 1b f1 43 1d 75 db 62>,
  absValidity: 2018-03-22T03:28:43.845Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50400221,
     cipherKeyVal: <Buffer ae 9e 30 21 75 40 97 bf c9 f0 9b cd 1e c9 c9 a1>,
     macKeyVal: <Buffer 31 81 73 4f 23 21 6a 45 99 c6 27 8e 91 dd 46 c4 69 fb ff 79 69 76 75 a1 81 1b f1 43 1d 75 db 62>,
     absValidity: 2018-03-22T03:28:43.845Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer e2 70 16 8a ab e3 07 54>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:28:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521602924728
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521602983706
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 8 0.75 1521603043717
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.1:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 9 0.6666666666666666 1521603103725
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.6:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 10 0.6 1521603163733
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.3:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 11 0.5454545454545454 1521603223740
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 2
to: 3
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 51990
received auth hello!
{ authId: 502, nonce: <Buffer b8 a8 97 0c 96 1f bd 4c> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth504',
     commonName: '10.0.0.7' },
  serial: '016246926CD0',
  notBefore: 2018-03-21T03:18:44.000Z,
  notAfter: 2018-03-22T03:20:24.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'F8:81:DB:4C:A4:89:3E:C1:C4:B9:97:BF:F9:A8:1C:72:94:92:9C:0F',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'FF6CB5202497CC77AF28EFDE774858E4FEF04355E5228E378962DF4235BE3683DAF9E38A7E22621D66B3B50166D897E97BF911F9E8FC09D686961AA39679014E5DDD27EA0F02DE853A41537DB5E37F33395E249F355C0D074419572E9856D1D598CAB2CD6951013DDCB0A163B943DFCD2694BE18B9B3892695B3052EBD9115D447293C83AF24A008794B842E4F0A6C2A8D0189612A600AA40A592603E43713C0ECCA681024E5EC429FAD09484B824919DF59C8BD488E0D372D2A3D8B99B6068E24BBBDA8F0BCDDBA806010E4A7181736DF08D4D1CFC16E26507C360EDCBFF1B5F4288CE304DE62E9696665C5108489AD7232658356998FF47C4F7E8A04225423',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJGkmzQMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDQxETAPBgNVBAMMCDEwLjAuMC43MB4XDTE4MDMy\nMTAzMTg0NFoXDTE4MDMyMjAzMjAyNFowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQD/bLUgJJfMd68o7953SFjk/vBDVeUijjeJYt9CNb42g9r544p+\nImIdZrO1AWbYl+l7+RH56PwJ1oaWGqOWeQFOXd0n6g8C3oU6QVN9teN/MzleJJ81\nXA0HRBlXLphW0dWYyrLNaVEBPdywoWO5Q9/NJpS+GLmziSaVswUuvZEV1EcpPIOv\nJKAIeUuELk8KbCqNAYlhKmAKpApZJgPkNxPA7MpoECTl7EKfrQlIS4JJGd9ZyL1I\njg03LSo9i5m2Bo4ku72o8LzduoBgEOSnGBc23wjU0c/BbiZQfDYO3L/xtfQojOME\n3mLpaWZlxRCEia1yMmWDVpmP9HxPfooEIlQjAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAExpyvhS7LxfbbznCOjWQdVJY1AJmvtB\nMNuMmLgPAKlqU06FSUVcHVPjT/X4aN3OQxaTBUB+x4xgpr8hukB8oSXQZvJDCdeK\nU9nwvZzDcjZ5ugohbASY7BKr+Dorj9kuekP8oawxxlVQhjaNcS6GDyHTjeKzIFjF\nc67AmliBCuoLymW0RIL2WZpY4JG/DwV+mHxT0MHSjW9O5p0pWbIVpwtDYT+HqQdz\n/7cDJNlarAUj/dQLaafyQXwol0vCCdzISPi3nFhP3r9KfMHjFJY1bH5Ic5J4eBZI\nAndLHJD6Zzje/UPxwbTdeNA7Oj1X4A5QeQyt4Z47byQW+KGm0xeSn8U=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 3
to: 4
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 12 0.5 1521603283750
connected to auth! from local port 52152
received auth hello!
{ authId: 502, nonce: <Buffer 8d 77 34 87 b2 27 0e 8a> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 23 eb 96 46 ca 7e d2 b6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer db 50 f1 f3 1e 56 ad 3d 2b bb d3 bb cf 6b 1c 7a>,
  macKeyVal: <Buffer bf 37 b6 83 33 47 eb 59 92 66 4d 27 d1 e0 5c 00 99 d1 2c 15 c7 4f 27 ad e3 49 83 5b da 26 d9 0b>,
  absValidity: 2018-03-21T04:34:51.544Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201429,
  cipherKeyVal: <Buffer 33 01 d5 cd 5d 85 55 d2 65 c8 68 fc d5 f1 61 92>,
  macKeyVal: <Buffer 81 0f d6 d0 90 3d 5a 43 3f d8 19 4b 8c f8 44 3c c9 97 73 cd dd 8d e3 11 96 94 4a 58 62 fa 60 62>,
  absValidity: 2018-03-22T03:34:51.543Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50201429,
     cipherKeyVal: <Buffer 33 01 d5 cd 5d 85 55 d2 65 c8 68 fc d5 f1 61 92>,
     macKeyVal: <Buffer 81 0f d6 d0 90 3d 5a 43 3f d8 19 4b 8c f8 44 3c c9 97 73 cd dd 8d e3 11 96 94 4a 58 62 fa 60 62>,
     absValidity: 2018-03-22T03:34:51.543Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer c9 60 19 13 8c 7a 74 71>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.41:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 13 0.46153846153846156 1521603343749
connected to auth! from local port 52340
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 14 0.42857142857142855 1521603403759
connected to auth! from local port 52494
received auth hello!
{ authId: 502, nonce: <Buffer 3e 74 e4 f9 f8 13 9f de> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 23 f1 e7 73 b4 d1 b6 00>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201462,
  cipherKeyVal: <Buffer a4 32 16 f5 a1 d2 c0 25 69 1e cd 62 c1 1e 14 a3>,
  macKeyVal: <Buffer d8 56 94 5b c7 c6 e2 39 ac 22 4f d4 13 54 83 49 05 40 5e 37 fa 80 55 ff 97 ae c2 7f a1 d6 de 73>,
  absValidity: 2018-03-22T03:36:59.516Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50201462,
     cipherKeyVal: <Buffer a4 32 16 f5 a1 d2 c0 25 69 1e cd 62 c1 1e 14 a3>,
     macKeyVal: <Buffer d8 56 94 5b c7 c6 e2 39 ac 22 4f d4 13 54 83 49 05 40 5e 37 fa 80 55 ff 97 ae c2 7f a1 d6 de 73>,
     absValidity: 2018-03-22T03:36:59.516Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer bf 2a 16 ab 13 e2 7b 81>
switching to HANDSHAKE_1_SENT
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:37:03 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 14 0.5 1521603423934
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 15 0.4666666666666667 1521603463797
connected to auth! from local port 52648
received auth hello!
{ authId: 502, nonce: <Buffer bc b8 3e 1a d9 ed 38 03> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 26 aa f6 49 5e 36 d6 54>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201479,
  cipherKeyVal: <Buffer ac 5d fb 0f d6 f6 b6 1e c4 d1 91 7f 51 1e 2c a3>,
  macKeyVal: <Buffer 85 d9 0f 71 93 03 5e 3f 77 8a dc a4 bd 47 dc c4 ce a2 51 aa 69 1a de 20 f4 a2 77 5e 15 36 0e bb>,
  absValidity: 2018-03-22T03:38:03.671Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50201479,
     cipherKeyVal: <Buffer ac 5d fb 0f d6 f6 b6 1e c4 d1 91 7f 51 1e 2c a3>,
     macKeyVal: <Buffer 85 d9 0f 71 93 03 5e 3f 77 8a dc a4 bd 47 dc c4 ce a2 51 aa 69 1a de 20 f4 a2 77 5e 15 36 0e bb>,
     absValidity: 2018-03-22T03:38:03.671Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer b5 59 94 32 c0 58 ad 06>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:38:07 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 15 0.5333333333333333 1521603488207
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 16 0.5 1521603523834
connected to auth! from local port 52802
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 17 0.47058823529411764 1521603583843
connected to auth! from local port 52952
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 18 0.4444444444444444 1521603643853
connected to auth! from local port 53108
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 19 0.42105263157894735 1521603703864
connected to auth! from local port 53266
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 20 0.4 1521603763875
connected to auth! from local port 53412
received auth hello!
{ authId: 502, nonce: <Buffer e6 03 c1 c2 06 4d 57 c4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 31 d2 91 99 53 88 c8 96>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201554,
  cipherKeyVal: <Buffer 8d cc bc 84 af 4a c7 15 aa 70 bf 9b 32 c4 4e 26>,
  macKeyVal: <Buffer 98 ed 3f 75 59 21 2d 2e f0 29 e7 7e 67 40 0c 47 95 60 e1 0a 6b ce 45 7f f2 a0 f4 38 34 17 96 77>,
  absValidity: 2018-03-22T03:43:03.567Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50201554,
     cipherKeyVal: <Buffer 8d cc bc 84 af 4a c7 15 aa 70 bf 9b 32 c4 4e 26>,
     macKeyVal: <Buffer 98 ed 3f 75 59 21 2d 2e f0 29 e7 7e 67 40 0c 47 95 60 e1 0a 6b ce 45 7f f2 a0 f4 38 34 17 96 77>,
     absValidity: 2018-03-22T03:43:03.567Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer a8 31 02 fd 85 ea 3c f0>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 21 0.38095238095238093 1521603823916
connected to auth! from local port 53564
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.41:undefined
received auth hello!
{ authId: 502, nonce: <Buffer 2a b5 ce 94 48 29 b7 e3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 07 66 f2 66 33 fc 5e d1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201570,
  cipherKeyVal: <Buffer 0c d8 84 68 18 f6 22 c8 ec 90 75 52 51 52 a9 01>,
  macKeyVal: <Buffer 37 ba da a8 6b 53 c7 4f aa d9 36 7d 00 5c bf 26 bc b9 7c ba b3 42 03 f6 b4 57 f3 19 59 0a b4 c6>,
  absValidity: 2018-03-22T03:44:07.534Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50201570,
     cipherKeyVal: <Buffer 0c d8 84 68 18 f6 22 c8 ec 90 75 52 51 52 a9 01>,
     macKeyVal: <Buffer 37 ba da a8 6b 53 c7 4f aa d9 36 7d 00 5c bf 26 bc b9 7c ba b3 42 03 f6 b4 57 f3 19 59 0a b4 c6>,
     absValidity: 2018-03-22T03:44:07.534Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 09 f7 bd 16 aa d3 03 f0>
switching to HANDSHAKE_1_SENT
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:44:11 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 9 21 0.42857142857142855 1521603851844
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 22 0.4090909090909091 1521603883948
connected to auth! from local port 53714
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 23 0.391304347826087 1521603943957
connected to auth! from local port 53862
Handler: Error in secure comm - details: Auth hello timedout ...
received auth hello!
{ authId: 502, nonce: <Buffer 12 2f 35 31 b3 2c fd 6e> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: write after end
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 24 0.375 1521604003962
connected to auth! from local port 54004
disconnected from auth
Handler: Error in secure comm - details: Connection with Auth timed out...
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 25 0.36 1521604063969
connected to auth! from local port 54148
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 26 0.34615384615384615 1521604123979
connected to auth! from local port 54304
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 27 0.3333333333333333 1521604183991
connected to auth! from local port 54448
received auth hello!
{ authId: 502, nonce: <Buffer 75 7f d7 24 ee b2 59 2e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4f 5f 47 d7 ce 38 df 56>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201659,
  cipherKeyVal: <Buffer 92 6c 18 a4 59 73 42 2f dd 99 80 46 50 8a ab 70>,
  macKeyVal: <Buffer e4 54 f8 54 5a 1b ee c6 0c e5 3b 0d bb 33 f7 ea de b4 cd 50 78 83 3c 39 83 b4 3d 81 64 ee a8 82>,
  absValidity: 2018-03-22T03:50:31.781Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50201659,
     cipherKeyVal: <Buffer 92 6c 18 a4 59 73 42 2f dd 99 80 46 50 8a ab 70>,
     macKeyVal: <Buffer e4 54 f8 54 5a 1b ee c6 0c e5 3b 0d bb 33 f7 ea de b4 cd 50 78 83 3c 39 83 b4 3d 81 64 ee a8 82>,
     absValidity: 2018-03-22T03:50:31.781Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer a1 fd 9f 31 b5 cb 74 e2>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 28 0.32142857142857145 1521604244001
connected to auth! from local port 54584
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:50:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 10 28 0.35714285714285715 1521604244397
received auth hello!
{ authId: 502, nonce: <Buffer 85 c4 51 43 42 15 51 47> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer df 07 c1 cb 17 c1 0b b6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201669,
  cipherKeyVal: <Buffer ae cd 95 ed e2 b6 f6 73 75 5c 8a 36 86 01 6f 60>,
  macKeyVal: <Buffer f4 90 c1 19 74 39 97 b3 d9 12 1f db f4 3c e0 41 f7 80 d6 81 04 0a 27 f1 61 4d b1 bd 1c 0f b8 89>,
  absValidity: 2018-03-22T03:51:15.946Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50201669,
     cipherKeyVal: <Buffer ae cd 95 ed e2 b6 f6 73 75 5c 8a 36 86 01 6f 60>,
     macKeyVal: <Buffer f4 90 c1 19 74 39 97 b3 d9 12 1f db f4 3c e0 41 f7 80 d6 81 04 0a 27 f1 61 4d b1 bd 1c 0f b8 89>,
     absValidity: 2018-03-22T03:51:15.946Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer c4 a5 a8 79 8e a2 6d a0>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:51:20 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 11 28 0.39285714285714285 1521604280713
