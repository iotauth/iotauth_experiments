changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c402.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c402',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 76 2f ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521602492144
connected to auth! from local port 57616
received auth hello!
{ authId: 401, nonce: <Buffer 9f 37 72 b5 db 6b 6b 70> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 34 23 fd ad f8 d7 dc 9c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 62 34 8e 2e bf 0c 2b c9 c7 94 2a af 9c 68 6a 6a>,
  macKeyVal: <Buffer 4d cd 89 7b 0a dd 73 a5 d5 04 c3 e3 fc c7 43 74 be 95 5f 02 56 ea f0 cc 14 f1 ab d0 18 a3 46 d8>,
  absValidity: 2018-03-21T04:21:32.307Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101408,
  cipherKeyVal: <Buffer ef ab a2 ae 61 55 b5 d6 28 ab 9b f1 eb 51 d0 b8>,
  macKeyVal: <Buffer ee 18 7d 24 44 07 b0 32 6d 45 db d6 99 8d ec 90 f2 09 96 75 26 f7 d2 48 52 ee 02 f9 6e 0e 3d ab>,
  absValidity: 2018-03-22T03:21:32.307Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.9',
  serverPort: 22100,
  sessionKey: 
   { id: 40101408,
     cipherKeyVal: <Buffer ef ab a2 ae 61 55 b5 d6 28 ab 9b f1 eb 51 d0 b8>,
     macKeyVal: <Buffer ee 18 7d 24 44 07 b0 32 6d 45 db d6 99 8d ec 90 f2 09 96 75 26 f7 d2 48 52 ee 02 f9 6e 0e 3d ab>,
     absValidity: 2018-03-22T03:21:32.307Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 22 a5 99 78 6a 9d 03 7c>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:21:32 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521602493208
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521602552195
connected to auth! from local port 57736
received auth hello!
{ authId: 401, nonce: <Buffer 31 48 95 df c8 df 64 89> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6a 2d 2b 6f 11 b5 19 45>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101414,
  cipherKeyVal: <Buffer 23 dc ea 57 c8 b2 be 5e 19 28 f4 6b eb f8 03 d6>,
  macKeyVal: <Buffer 8b d4 48 0c 2e 63 54 25 7f 0a a2 0c 8f 3c cf 35 70 2e 5b 79 4c 72 e6 c8 0f 55 5f 48 82 0f 09 f2>,
  absValidity: 2018-03-22T03:22:32.361Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.9',
  serverPort: 22100,
  sessionKey: 
   { id: 40101414,
     cipherKeyVal: <Buffer 23 dc ea 57 c8 b2 be 5e 19 28 f4 6b eb f8 03 d6>,
     macKeyVal: <Buffer 8b d4 48 0c 2e 63 54 25 7f 0a a2 0c 8f 3c cf 35 70 2e 5b 79 4c 72 e6 c8 0f 55 5f 48 82 0f 09 f2>,
     absValidity: 2018-03-22T03:22:32.361Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 65 e4 66 44 b1 3c bd 6d>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:22:33 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521602553335
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521602612222
connected to auth! from local port 57966
received auth hello!
{ authId: 401, nonce: <Buffer 3b fb 75 91 be 62 e0 2c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f7 0e 98 2e 57 5b ba 74>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101420,
  cipherKeyVal: <Buffer e0 f7 0a cd c1 f7 5a ba 9b d2 6b c0 b8 08 9d 2a>,
  macKeyVal: <Buffer e5 19 63 06 8f c6 bc f7 25 f1 3e 75 5c 49 a7 a2 61 80 f2 4c 3c fc 04 5c 6f 5d 27 71 40 ba 0a ae>,
  absValidity: 2018-03-22T03:23:32.369Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.9',
  serverPort: 22100,
  sessionKey: 
   { id: 40101420,
     cipherKeyVal: <Buffer e0 f7 0a cd c1 f7 5a ba 9b d2 6b c0 b8 08 9d 2a>,
     macKeyVal: <Buffer e5 19 63 06 8f c6 bc f7 25 f1 3e 75 5c 49 a7 a2 61 80 f2 4c 3c fc 04 5c 6f 5d 27 71 40 ba 0a ae>,
     absValidity: 2018-03-22T03:23:32.369Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 23 9e ba 85 ee a7 f6 c9>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:23:33 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521602613315
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521602672279
connected to auth! from local port 58236
received auth hello!
{ authId: 401, nonce: <Buffer fa da f9 03 14 36 c1 0e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f6 6e dc 16 28 75 43 8e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101426,
  cipherKeyVal: <Buffer a0 55 47 8a 29 97 db 3d 02 c1 d8 fa 94 36 1f 12>,
  macKeyVal: <Buffer 65 c4 3c f1 f4 f2 70 7c f9 17 88 e5 94 7d c9 31 96 39 ae fe fa 5a c3 da c2 38 b4 4a 21 c6 09 50>,
  absValidity: 2018-03-22T03:24:32.406Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.9',
  serverPort: 22100,
  sessionKey: 
   { id: 40101426,
     cipherKeyVal: <Buffer a0 55 47 8a 29 97 db 3d 02 c1 d8 fa 94 36 1f 12>,
     macKeyVal: <Buffer 65 c4 3c f1 f4 f2 70 7c f9 17 88 e5 94 7d c9 31 96 39 ae fe fa 5a c3 da c2 38 b4 4a 21 c6 09 50>,
     absValidity: 2018-03-22T03:24:32.406Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 74 76 9e 08 a7 d3 c8 43>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:24:33 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521602673290
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521602732337
connected to auth! from local port 58506
received auth hello!
{ authId: 401, nonce: <Buffer b1 5c a3 16 04 a7 2e d9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 14 7b 1e 8c a4 0b 99 2f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101432,
  cipherKeyVal: <Buffer e3 b5 fb ea 52 9a 22 d0 d4 8b c8 68 05 a1 64 e8>,
  macKeyVal: <Buffer ee 8f 1b 34 7a f0 62 04 a1 46 be 1a 93 f6 ba 6f d2 7c 99 83 a9 30 ed 7d 0a 58 f7 2a c2 44 1e e1>,
  absValidity: 2018-03-22T03:25:32.472Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.9',
  serverPort: 22100,
  sessionKey: 
   { id: 40101432,
     cipherKeyVal: <Buffer e3 b5 fb ea 52 9a 22 d0 d4 8b c8 68 05 a1 64 e8>,
     macKeyVal: <Buffer ee 8f 1b 34 7a f0 62 04 a1 46 be 1a 93 f6 ba 6f d2 7c 99 83 a9 30 ed 7d 0a 58 f7 2a c2 44 1e e1>,
     absValidity: 2018-03-22T03:25:32.472Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 05 7f f9 b2 17 85 35 df>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:25:33 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521602733350
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521602792393
connected to auth! from local port 58776
received auth hello!
{ authId: 401, nonce: <Buffer d7 bb 82 36 a5 93 93 31> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2f c3 84 ab cc cc 68 87>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101438,
  cipherKeyVal: <Buffer f4 c5 39 e0 0a cf 72 b8 3a f4 01 4b b0 b3 1e 0f>,
  macKeyVal: <Buffer 65 a9 8d 92 a3 3b 13 5c 1f 21 0a 94 25 60 ff 4f ed f5 cb 85 9c 06 87 db 42 b5 0b 10 5d ee 50 32>,
  absValidity: 2018-03-22T03:26:32.534Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.9',
  serverPort: 22100,
  sessionKey: 
   { id: 40101438,
     cipherKeyVal: <Buffer f4 c5 39 e0 0a cf 72 b8 3a f4 01 4b b0 b3 1e 0f>,
     macKeyVal: <Buffer 65 a9 8d 92 a3 3b 13 5c 1f 21 0a 94 25 60 ff 4f ed f5 cb 85 9c 06 87 db 42 b5 0b 10 5d ee 50 32>,
     absValidity: 2018-03-22T03:26:32.534Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 80 c9 cd 52 45 d5 a1 d1>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:26:33 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521602793341
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521602852449
connected to auth! from local port 59046
received auth hello!
{ authId: 401, nonce: <Buffer ef 9a b0 de c0 ed 94 13> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 11 46 bb 76 82 2d ab 0b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101444,
  cipherKeyVal: <Buffer 96 0c 1c 0e fe c1 2b 17 70 90 05 50 84 60 e6 17>,
  macKeyVal: <Buffer 3d c7 b2 db 9c e5 43 f4 9a 22 71 84 f3 81 39 86 aa df 55 a8 7e 51 39 de 02 04 89 f5 7e 18 90 83>,
  absValidity: 2018-03-22T03:27:32.588Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.9',
  serverPort: 22100,
  sessionKey: 
   { id: 40101444,
     cipherKeyVal: <Buffer 96 0c 1c 0e fe c1 2b 17 70 90 05 50 84 60 e6 17>,
     macKeyVal: <Buffer 3d c7 b2 db 9c e5 43 f4 9a 22 71 84 f3 81 39 86 aa df 55 a8 7e 51 39 de 02 04 89 f5 7e 18 90 83>,
     absValidity: 2018-03-22T03:27:32.588Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 09 c8 b6 b8 68 bf 01 61>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:27:33 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521602853511
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521602912505
connected to auth! from local port 59316
received auth hello!
{ authId: 401, nonce: <Buffer 0c 73 75 42 84 3c 44 a4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 14 2c 75 c3 51 42 e4 5c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101450,
  cipherKeyVal: <Buffer 2d ba b5 07 a1 7c ae 3d 02 8a 99 7f 7b 4f cf 0f>,
  macKeyVal: <Buffer bf 80 c3 37 63 a9 1b 41 ac b5 12 e5 c3 c0 ba 32 17 8d 7e 65 81 1d 8a a3 06 6b 6d 77 0f 3a 8b 9c>,
  absValidity: 2018-03-22T03:28:32.628Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.9',
  serverPort: 22100,
  sessionKey: 
   { id: 40101450,
     cipherKeyVal: <Buffer 2d ba b5 07 a1 7c ae 3d 02 8a 99 7f 7b 4f cf 0f>,
     macKeyVal: <Buffer bf 80 c3 37 63 a9 1b 41 ac b5 12 e5 c3 c0 ba 32 17 8d 7e 65 81 1d 8a a3 06 6b 6d 77 0f 3a 8b 9c>,
     absValidity: 2018-03-22T03:28:32.628Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer ec 84 d8 8e 95 23 ec 94>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:28:33 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 8 1 1521602913447
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 9 0.8888888888888888 1521602972565
connected to auth! from local port 59578
received auth hello!
{ authId: 401, nonce: <Buffer 49 a4 2d b0 de a9 5e 90> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 92 fa 74 3f fa f5 a2 68>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101456,
  cipherKeyVal: <Buffer 9b c9 33 ac ae d6 c0 69 46 20 92 06 c5 26 cc a3>,
  macKeyVal: <Buffer 29 b8 ff fc 07 2e 79 f0 fe b8 ca 39 03 25 76 d6 cb a1 aa 71 7d 02 58 37 c6 a5 22 fe 0e 50 64 93>,
  absValidity: 2018-03-22T03:29:32.731Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.9',
  serverPort: 22100,
  sessionKey: 
   { id: 40101456,
     cipherKeyVal: <Buffer 9b c9 33 ac ae d6 c0 69 46 20 92 06 c5 26 cc a3>,
     macKeyVal: <Buffer 29 b8 ff fc 07 2e 79 f0 fe b8 ca 39 03 25 76 d6 cb a1 aa 71 7d 02 58 37 c6 a5 22 fe 0e 50 64 93>,
     absValidity: 2018-03-22T03:29:32.731Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 63 de 90 30 b0 5b 5b cf>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:29:33 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 9 9 1 1521602973545
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 10 0.9 1521603032609
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.1:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 11 0.8181818181818182 1521603092613
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.1:21100
connected to auth! from local port 50462
received auth hello!
{ authId: 502, nonce: <Buffer 71 c6 10 33 bb b7 6f 2c> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth401',
     commonName: '10.0.0.1' },
  serial: '0162469261A3',
  notBefore: 2018-03-21T03:18:41.000Z,
  notAfter: 2018-03-22T03:20:21.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '4C:EC:5C:20:C7:CD:EF:0F:EB:B9:84:94:B4:A5:18:CE:39:84:EB:51',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'FF6CB5202497CC77AF28EFDE774858E4FEF04355E5228E378962DF4235BE3683DAF9E38A7E22621D66B3B50166D897E97BF911F9E8FC09D686961AA39679014E5DDD27EA0F02DE853A41537DB5E37F33395E249F355C0D074419572E9856D1D598CAB2CD6951013DDCB0A163B943DFCD2694BE18B9B3892695B3052EBD9115D447293C83AF24A008794B842E4F0A6C2A8D0189612A600AA40A592603E43713C0ECCA681024E5EC429FAD09484B824919DF59C8BD488E0D372D2A3D8B99B6068E24BBBDA8F0BCDDBA806010E4A7181736DF08D4D1CFC16E26507C360EDCBFF1B5F4288CE304DE62E9696665C5108489AD7232658356998FF47C4F7E8A04225423',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJGkmGjMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDExETAPBgNVBAMMCDEwLjAuMC4xMB4XDTE4MDMy\nMTAzMTg0MVoXDTE4MDMyMjAzMjAyMVowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQD/bLUgJJfMd68o7953SFjk/vBDVeUijjeJYt9CNb42g9r544p+\nImIdZrO1AWbYl+l7+RH56PwJ1oaWGqOWeQFOXd0n6g8C3oU6QVN9teN/MzleJJ81\nXA0HRBlXLphW0dWYyrLNaVEBPdywoWO5Q9/NJpS+GLmziSaVswUuvZEV1EcpPIOv\nJKAIeUuELk8KbCqNAYlhKmAKpApZJgPkNxPA7MpoECTl7EKfrQlIS4JJGd9ZyL1I\njg03LSo9i5m2Bo4ku72o8LzduoBgEOSnGBc23wjU0c/BbiZQfDYO3L/xtfQojOME\n3mLpaWZlxRCEia1yMmWDVpmP9HxPfooEIlQjAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAFnTVXEOlJGyhqLSdf0h2VrhzhIl4BSI\nYRm7gHmUB4kNQkRPveYyqn0shzv1cNkLsWnuULxIRMyAvKuj1IarOIurGtcsGwv9\nwLZiR4jTzTxbX3aRXWw8rX2jnbgkF+AaLZna31Grij4TktPtdjoW18/G6Tk3TQTh\nLf7qmQCf/MrfMFeOZWeeO2Rnzb1KP/oy/8WSfFczH0HW1qsvniRax0d8G05Vi0U1\nq++i3ZkmUY3EeLWVd2FK7NoBdHLkr3iPTuckLDP/E88fnHwGnPhR5iHLpoWrw1Dp\njyaJdLdnwD0HMQlPMMKCR/3IX6/DK9hOcJGEfTAW5OhTDB5INQJ/Y1k=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 12 0.75 1521603152621
connected to auth! from local port 50630
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 13 0.6923076923076923 1521603212632
connected to auth! from local port 50800
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 14 0.6428571428571429 1521603272643
connected to auth! from local port 50980
received auth hello!
{ authId: 502, nonce: <Buffer 6f d4 1f 21 ae 37 84 e9> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer da c9 1d 52 9a ad b3 c4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 2b ca ec 4c 56 4e c8 f0 cd a6 a0 7e 70 2f 18 1f>,
  macKeyVal: <Buffer d2 67 83 a8 7d d6 b8 2d c8 b7 ea a6 5a 82 2f b1 2c d5 21 26 b2 f0 a0 29 77 8f 9e f0 ed be b3 96>,
  absValidity: 2018-03-21T04:34:44.333Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201427,
  cipherKeyVal: <Buffer 73 19 3a e7 e4 cb fa f6 4b 49 5b 5c b0 cd c0 81>,
  macKeyVal: <Buffer 8b ee 30 e1 d8 29 5f e1 d7 24 4a 44 c9 02 c4 bd 72 64 69 d2 5e 6a 3b 50 ec d2 02 66 4b 70 6b 0d>,
  absValidity: 2018-03-22T03:34:44.333Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.9',
  serverPort: 22100,
  sessionKey: 
   { id: 50201427,
     cipherKeyVal: <Buffer 73 19 3a e7 e4 cb fa f6 4b 49 5b 5c b0 cd c0 81>,
     macKeyVal: <Buffer 8b ee 30 e1 d8 29 5f e1 d7 24 4a 44 c9 02 c4 bd 72 64 69 d2 5e 6a 3b 50 ec d2 02 66 4b 70 6b 0d>,
     absValidity: 2018-03-22T03:34:44.333Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 6b 71 30 50 58 d8 1e d0>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 15 0.6 1521603332691
connected to auth! from local port 51166
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.9:undefined
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 16 0.5625 1521603392700
connected to auth! from local port 51324
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 17 0.5294117647058824 1521603452701
connected to auth! from local port 51476
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 18 0.5 1521603512711
connected to auth! from local port 51630
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 19 0.47368421052631576 1521603572721
connected to auth! from local port 51784
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 20 0.45 1521603632731
connected to auth! from local port 51940
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 21 0.42857142857142855 1521603692742
connected to auth! from local port 52094
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 22 0.4090909090909091 1521603752752
connected to auth! from local port 52244
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 23 0.391304347826087 1521603812763
connected to auth! from local port 52392
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 24 0.375 1521603872774
connected to auth! from local port 52546
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 25 0.36 1521603932784
connected to auth! from local port 52698
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 26 0.34615384615384615 1521603992795
connected to auth! from local port 52840
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 27 0.3333333333333333 1521604052804
connected to auth! from local port 52978
received auth hello!
{ authId: 502, nonce: <Buffer 60 24 3d 1d 34 8a e2 2a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 29 a0 78 16 88 c7 84 8c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201626,
  cipherKeyVal: <Buffer 04 60 86 85 73 f8 cf 0c a9 d1 44 6c c5 83 07 55>,
  macKeyVal: <Buffer db 32 de 46 ff 5e e6 66 f9 4a b2 99 cb 8c 11 7f 51 72 99 c8 69 d3 29 f4 94 6b 2d f9 39 0c a5 18>,
  absValidity: 2018-03-22T03:48:12.537Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.9',
  serverPort: 22100,
  sessionKey: 
   { id: 50201626,
     cipherKeyVal: <Buffer 04 60 86 85 73 f8 cf 0c a9 d1 44 6c c5 83 07 55>,
     macKeyVal: <Buffer db 32 de 46 ff 5e e6 66 f9 4a b2 99 cb 8c 11 7f 51 72 99 c8 69 d3 29 f4 94 6b 2d f9 39 0c a5 18>,
     absValidity: 2018-03-22T03:48:12.537Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer d2 ec 0a e5 5e de 4e 3e>
switching to HANDSHAKE_1_SENT
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 28 0.32142857142857145 1521604112818
connected to auth! from local port 53132
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.9:undefined
received auth hello!
{ authId: 502, nonce: <Buffer 46 ed 31 01 48 36 92 61> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c5 3e 35 54 d2 73 e9 88>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201641,
  cipherKeyVal: <Buffer 76 3f 2d 78 df fc 28 3c 5f 1d 3f bf 8d f5 bb ae>,
  macKeyVal: <Buffer 52 ed a2 dc b7 87 02 f2 e1 64 80 ae 3c 74 b2 0f 4d da b6 d6 af 19 81 e5 35 a6 4a cb 83 41 19 b8>,
  absValidity: 2018-03-22T03:49:12.527Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.9',
  serverPort: 22100,
  sessionKey: 
   { id: 50201641,
     cipherKeyVal: <Buffer 76 3f 2d 78 df fc 28 3c 5f 1d 3f bf 8d f5 bb ae>,
     macKeyVal: <Buffer 52 ed a2 dc b7 87 02 f2 e1 64 80 ae 3c 74 b2 0f 4d da b6 d6 af 19 81 e5 35 a6 4a cb 83 41 19 b8>,
     absValidity: 2018-03-22T03:49:12.527Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer ac df ba 39 b1 af 19 73>
switching to HANDSHAKE_1_SENT
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:49:16 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 10 28 0.35714285714285715 1521604156966
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 10 29 0.3448275862068966 1521604172834
connected to auth! from local port 53280
