changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c403.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c403',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 37 77 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521602495335
connected to auth! from local port 50294
received auth hello!
{ authId: 401, nonce: <Buffer e0 b0 c9 75 b0 b0 76 05> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer b5 25 d4 34 1e f3 b9 fe>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 10 bb 16 72 9e 53 21 01 b0 74 2c 53 f1 d7 66 72>,
  macKeyVal: <Buffer ac b2 44 5e da ad a8 81 41 3e 55 b7 d2 96 67 48 d2 d5 59 8e 5b e8 d8 bc e5 41 6a 7b 76 7b ae 73>,
  absValidity: 2018-03-21T04:21:35.502Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101409,
  cipherKeyVal: <Buffer 34 cf 35 30 dc bf 92 d2 3a b0 52 4d ed 3c 7e 60>,
  macKeyVal: <Buffer 26 a8 b6 1f 36 71 8b e7 81 da 8e 3e e4 7f f8 77 f9 42 18 6b 59 76 24 ba 0c 89 c8 1f 23 5c 5d 87>,
  absValidity: 2018-03-22T03:21:35.502Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.18',
  serverPort: 22100,
  sessionKey: 
   { id: 40101409,
     cipherKeyVal: <Buffer 34 cf 35 30 dc bf 92 d2 3a b0 52 4d ed 3c 7e 60>,
     macKeyVal: <Buffer 26 a8 b6 1f 36 71 8b e7 81 da 8e 3e e4 7f f8 77 f9 42 18 6b 59 76 24 ba 0c 89 c8 1f 23 5c 5d 87>,
     absValidity: 2018-03-22T03:21:35.502Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 93 fa be e9 39 10 5a 06>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:21:36 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521602496421
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521602555394
connected to auth! from local port 50420
received auth hello!
{ authId: 401, nonce: <Buffer 79 00 37 58 eb 2f f2 20> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a1 4d 5b e2 b7 c1 c4 af>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101415,
  cipherKeyVal: <Buffer 04 64 1b 14 47 3e 5f bf 16 c7 a8 dc 02 62 bc 05>,
  macKeyVal: <Buffer 7f 43 c5 31 1b fd e2 3e 02 b7 40 27 63 e9 6f c3 cf bc 94 1e 0a af 81 2a 43 d5 04 94 68 15 0a 4a>,
  absValidity: 2018-03-22T03:22:35.515Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.18',
  serverPort: 22100,
  sessionKey: 
   { id: 40101415,
     cipherKeyVal: <Buffer 04 64 1b 14 47 3e 5f bf 16 c7 a8 dc 02 62 bc 05>,
     macKeyVal: <Buffer 7f 43 c5 31 1b fd e2 3e 02 b7 40 27 63 e9 6f c3 cf bc 94 1e 0a af 81 2a 43 d5 04 94 68 15 0a 4a>,
     absValidity: 2018-03-22T03:22:35.515Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 8c 3c f9 91 fb 5c 74 99>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:22:36 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521602556341
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521602615453
connected to auth! from local port 50656
received auth hello!
{ authId: 401, nonce: <Buffer 40 9f 3f 66 05 d6 ec 56> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d1 b6 c2 e1 94 00 04 a1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101421,
  cipherKeyVal: <Buffer 9c 01 38 bb ca 33 d9 9d 34 ac 89 97 7e be 73 e6>,
  macKeyVal: <Buffer 99 d1 9d 76 d6 12 9d c8 aa 12 30 db da 44 80 1a 3e 38 ba db a4 13 3e c1 4a af 29 81 79 b7 63 21>,
  absValidity: 2018-03-22T03:23:35.605Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.18',
  serverPort: 22100,
  sessionKey: 
   { id: 40101421,
     cipherKeyVal: <Buffer 9c 01 38 bb ca 33 d9 9d 34 ac 89 97 7e be 73 e6>,
     macKeyVal: <Buffer 99 d1 9d 76 d6 12 9d c8 aa 12 30 db da 44 80 1a 3e 38 ba db a4 13 3e c1 4a af 29 81 79 b7 63 21>,
     absValidity: 2018-03-22T03:23:35.605Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 2f 08 03 3f 9f 02 ff 64>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:23:36 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521602616463
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521602675509
connected to auth! from local port 50926
received auth hello!
{ authId: 401, nonce: <Buffer d0 73 b4 19 45 7b 93 35> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 83 2a 51 0f c6 ae 85 1d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101427,
  cipherKeyVal: <Buffer 78 a1 a9 14 0d 36 b9 aa ab ef 41 49 2f f6 e3 d0>,
  macKeyVal: <Buffer cf 3e ba 3a 5c ec f3 41 9f 01 c1 38 38 0e ad 95 50 eb eb 7c b7 cb c4 c9 e9 1f dd 63 4e b6 0f 16>,
  absValidity: 2018-03-22T03:24:35.653Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.18',
  serverPort: 22100,
  sessionKey: 
   { id: 40101427,
     cipherKeyVal: <Buffer 78 a1 a9 14 0d 36 b9 aa ab ef 41 49 2f f6 e3 d0>,
     macKeyVal: <Buffer cf 3e ba 3a 5c ec f3 41 9f 01 c1 38 38 0e ad 95 50 eb eb 7c b7 cb c4 c9 e9 1f dd 63 4e b6 0f 16>,
     absValidity: 2018-03-22T03:24:35.653Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 1a ab a9 78 05 f4 42 d9>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:24:36 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521602676532
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521602735556
connected to auth! from local port 51196
received auth hello!
{ authId: 401, nonce: <Buffer 31 17 95 9b 0a 6e 1d 35> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 53 15 ac 85 30 7b 02 e5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101433,
  cipherKeyVal: <Buffer 74 e4 c0 cf ef b3 f3 d0 6c 0f 5a 03 a6 87 db 45>,
  macKeyVal: <Buffer 78 4a 0a 13 a2 3b d7 92 95 b5 0c 00 ed 45 bf 91 77 8a d7 c2 59 69 a4 ba 43 3c 55 e8 15 dc 63 6d>,
  absValidity: 2018-03-22T03:25:35.728Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.18',
  serverPort: 22100,
  sessionKey: 
   { id: 40101433,
     cipherKeyVal: <Buffer 74 e4 c0 cf ef b3 f3 d0 6c 0f 5a 03 a6 87 db 45>,
     macKeyVal: <Buffer 78 4a 0a 13 a2 3b d7 92 95 b5 0c 00 ed 45 bf 91 77 8a d7 c2 59 69 a4 ba 43 3c 55 e8 15 dc 63 6d>,
     absValidity: 2018-03-22T03:25:35.728Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 2a 65 c6 8b 63 ca aa 23>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:25:36 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521602736618
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521602795585
connected to auth! from local port 51466
received auth hello!
{ authId: 401, nonce: <Buffer 9a 5b 8e e7 e8 b7 39 9c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 88 a0 02 dc 62 e6 a1 90>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101439,
  cipherKeyVal: <Buffer 3a d6 c7 2a 17 40 7c 3f c7 41 fb 5e 20 b7 ae d2>,
  macKeyVal: <Buffer db 16 59 64 43 b6 0a 64 f4 1a cb 45 bc 83 73 87 ab a9 73 3f d3 d1 76 ed 37 cd 7b 44 3c 38 db f1>,
  absValidity: 2018-03-22T03:26:35.747Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.18',
  serverPort: 22100,
  sessionKey: 
   { id: 40101439,
     cipherKeyVal: <Buffer 3a d6 c7 2a 17 40 7c 3f c7 41 fb 5e 20 b7 ae d2>,
     macKeyVal: <Buffer db 16 59 64 43 b6 0a 64 f4 1a cb 45 bc 83 73 87 ab a9 73 3f d3 d1 76 ed 37 cd 7b 44 3c 38 db f1>,
     absValidity: 2018-03-22T03:26:35.747Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer ef 2f 62 03 e0 c5 6b 14>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:26:36 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521602796628
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521602855633
connected to auth! from local port 51736
received auth hello!
{ authId: 401, nonce: <Buffer 3d 51 68 3c bf 9a 21 8d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 34 0e 8e 02 3e 74 c0 dc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101445,
  cipherKeyVal: <Buffer f4 12 b6 a3 a6 6d 6e 9d a6 ee 33 61 65 bf 2b 74>,
  macKeyVal: <Buffer 00 32 ac 05 d9 f5 50 55 f0 25 d8 0f 97 41 bc 31 81 b5 a6 a1 47 ce 87 a4 07 66 0d 95 ce 1f a7 f6>,
  absValidity: 2018-03-22T03:27:35.791Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.18',
  serverPort: 22100,
  sessionKey: 
   { id: 40101445,
     cipherKeyVal: <Buffer f4 12 b6 a3 a6 6d 6e 9d a6 ee 33 61 65 bf 2b 74>,
     macKeyVal: <Buffer 00 32 ac 05 d9 f5 50 55 f0 25 d8 0f 97 41 bc 31 81 b5 a6 a1 47 ce 87 a4 07 66 0d 95 ce 1f a7 f6>,
     absValidity: 2018-03-22T03:27:35.791Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 4f 18 14 d1 48 f0 eb 70>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:27:36 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521602856555
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521602915682
connected to auth! from local port 52006
received auth hello!
{ authId: 401, nonce: <Buffer df e0 6a cf a1 0e 60 15> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1f f0 07 6c 7b fe 54 fd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101451,
  cipherKeyVal: <Buffer b0 89 47 2d d1 f0 1b 56 86 c6 d7 98 bb 0a 6d f8>,
  macKeyVal: <Buffer 0e 6f ae 33 5c 52 9f 07 0e ea 4a 91 51 ad 02 0b 17 6a 5e af 56 f0 6f 9d f7 a7 f7 e2 82 4a cf 63>,
  absValidity: 2018-03-22T03:28:35.845Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.18',
  serverPort: 22100,
  sessionKey: 
   { id: 40101451,
     cipherKeyVal: <Buffer b0 89 47 2d d1 f0 1b 56 86 c6 d7 98 bb 0a 6d f8>,
     macKeyVal: <Buffer 0e 6f ae 33 5c 52 9f 07 0e ea 4a 91 51 ad 02 0b 17 6a 5e af 56 f0 6f 9d f7 a7 f7 e2 82 4a cf 63>,
     absValidity: 2018-03-22T03:28:35.845Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 28 fa ec 12 c7 3a 28 cb>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:28:36 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 8 1 1521602916798
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 9 0.8888888888888888 1521602975711
connected to auth! from local port 52264
received auth hello!
{ authId: 401, nonce: <Buffer 33 a0 28 3a 48 d4 8d a2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f4 9f d6 22 82 24 c9 9b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101457,
  cipherKeyVal: <Buffer e5 e6 e5 48 71 50 fa 18 66 98 0d 10 4d 45 1c 74>,
  macKeyVal: <Buffer 22 17 9b 4d e7 39 67 a4 cd e1 e0 b4 49 c3 99 be 09 3e ae fd 54 10 cf 64 4f 4d ac 33 f5 42 7c 65>,
  absValidity: 2018-03-22T03:29:35.876Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.18',
  serverPort: 22100,
  sessionKey: 
   { id: 40101457,
     cipherKeyVal: <Buffer e5 e6 e5 48 71 50 fa 18 66 98 0d 10 4d 45 1c 74>,
     macKeyVal: <Buffer 22 17 9b 4d e7 39 67 a4 cd e1 e0 b4 49 c3 99 be 09 3e ae fd 54 10 cf 64 4f 4d ac 33 f5 42 7c 65>,
     absValidity: 2018-03-22T03:29:35.876Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer f1 f1 4b 28 63 34 2c b0>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.18:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 10 0.8 1521603035722
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.1:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 11 0.7272727272727273 1521603095732
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.1:21100
connected to auth! from local port 49938
received auth hello!
{ authId: 502, nonce: <Buffer be 5f 9a 2f 9b b0 fa dc> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth401',
     commonName: '10.0.0.1' },
  serial: '0162469261A3',
  notBefore: 2018-03-21T03:18:41.000Z,
  notAfter: 2018-03-22T03:20:21.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '4C:EC:5C:20:C7:CD:EF:0F:EB:B9:84:94:B4:A5:18:CE:39:84:EB:51',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'FF6CB5202497CC77AF28EFDE774858E4FEF04355E5228E378962DF4235BE3683DAF9E38A7E22621D66B3B50166D897E97BF911F9E8FC09D686961AA39679014E5DDD27EA0F02DE853A41537DB5E37F33395E249F355C0D074419572E9856D1D598CAB2CD6951013DDCB0A163B943DFCD2694BE18B9B3892695B3052EBD9115D447293C83AF24A008794B842E4F0A6C2A8D0189612A600AA40A592603E43713C0ECCA681024E5EC429FAD09484B824919DF59C8BD488E0D372D2A3D8B99B6068E24BBBDA8F0BCDDBA806010E4A7181736DF08D4D1CFC16E26507C360EDCBFF1B5F4288CE304DE62E9696665C5108489AD7232658356998FF47C4F7E8A04225423',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJGkmGjMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDExETAPBgNVBAMMCDEwLjAuMC4xMB4XDTE4MDMy\nMTAzMTg0MVoXDTE4MDMyMjAzMjAyMVowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQD/bLUgJJfMd68o7953SFjk/vBDVeUijjeJYt9CNb42g9r544p+\nImIdZrO1AWbYl+l7+RH56PwJ1oaWGqOWeQFOXd0n6g8C3oU6QVN9teN/MzleJJ81\nXA0HRBlXLphW0dWYyrLNaVEBPdywoWO5Q9/NJpS+GLmziSaVswUuvZEV1EcpPIOv\nJKAIeUuELk8KbCqNAYlhKmAKpApZJgPkNxPA7MpoECTl7EKfrQlIS4JJGd9ZyL1I\njg03LSo9i5m2Bo4ku72o8LzduoBgEOSnGBc23wjU0c/BbiZQfDYO3L/xtfQojOME\n3mLpaWZlxRCEia1yMmWDVpmP9HxPfooEIlQjAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAFnTVXEOlJGyhqLSdf0h2VrhzhIl4BSI\nYRm7gHmUB4kNQkRPveYyqn0shzv1cNkLsWnuULxIRMyAvKuj1IarOIurGtcsGwv9\nwLZiR4jTzTxbX3aRXWw8rX2jnbgkF+AaLZna31Grij4TktPtdjoW18/G6Tk3TQTh\nLf7qmQCf/MrfMFeOZWeeO2Rnzb1KP/oy/8WSfFczH0HW1qsvniRax0d8G05Vi0U1\nq++i3ZkmUY3EeLWVd2FK7NoBdHLkr3iPTuckLDP/E88fnHwGnPhR5iHLpoWrw1Dp\njyaJdLdnwD0HMQlPMMKCR/3IX6/DK9hOcJGEfTAW5OhTDB5INQJ/Y1k=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 12 0.6666666666666666 1521603155742
connected to auth! from local port 50104
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 13 0.6153846153846154 1521603215753
connected to auth! from local port 50278
received auth hello!
{ authId: 502, nonce: <Buffer 73 b6 24 63 37 ea d2 dc> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer e8 ac dd 07 51 a4 ed 6c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer a6 a2 84 00 e4 4d 23 1a d0 ba a7 df b6 af 14 40>,
  macKeyVal: <Buffer 7a 4f 29 11 29 97 60 e3 c6 93 88 fe f2 55 ec 28 bd b5 a2 dd 39 d9 ad d9 f3 1d 66 45 63 62 33 a1>,
  absValidity: 2018-03-21T04:33:39.546Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201411,
  cipherKeyVal: <Buffer ec f9 2a f5 c7 52 b9 01 54 ee b1 9d f3 dc 8c 9f>,
  macKeyVal: <Buffer 3d ec 26 6d 16 ab 9e bb 34 4b 4e 97 7c 00 81 c2 c0 a4 ff 1f 15 29 f3 fe c5 bd e5 8f dd 2d 63 3e>,
  absValidity: 2018-03-22T03:33:39.546Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.18',
  serverPort: 22100,
  sessionKey: 
   { id: 50201411,
     cipherKeyVal: <Buffer ec f9 2a f5 c7 52 b9 01 54 ee b1 9d f3 dc 8c 9f>,
     macKeyVal: <Buffer 3d ec 26 6d 16 ab 9e bb 34 4b 4e 97 7c 00 81 c2 c0 a4 ff 1f 15 29 f3 fe c5 bd e5 8f dd 2d 63 3e>,
     absValidity: 2018-03-22T03:33:39.546Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 7e 37 30 26 31 59 8a 71>
switching to HANDSHAKE_1_SENT
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.18:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 14 0.5714285714285714 1521603275760
connected to auth! from local port 50450
received auth hello!
{ authId: 502, nonce: <Buffer fa ed e8 84 6c 97 69 62> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e5 95 95 0b 68 5c 51 cd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201435,
  cipherKeyVal: <Buffer 41 92 68 e9 e0 85 7f 1d 18 07 cd 0e e8 a5 75 47>,
  macKeyVal: <Buffer 72 fb e9 40 31 67 15 b4 81 8e cd d8 dd 06 d1 0e 27 e2 22 0f 3c b4 8c 03 eb 5f 6d a0 e6 22 37 5a>,
  absValidity: 2018-03-22T03:35:03.531Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.18',
  serverPort: 22100,
  sessionKey: 
   { id: 50201435,
     cipherKeyVal: <Buffer 41 92 68 e9 e0 85 7f 1d 18 07 cd 0e e8 a5 75 47>,
     macKeyVal: <Buffer 72 fb e9 40 31 67 15 b4 81 8e cd d8 dd 06 d1 0e 27 e2 22 0f 3c b4 8c 03 eb 5f 6d a0 e6 22 37 5a>,
     absValidity: 2018-03-22T03:35:03.531Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer c4 bc b8 9d f7 2b ae 18>
switching to HANDSHAKE_1_SENT
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 15 0.5333333333333333 1521603335793
connected to auth! from local port 50636
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.18:undefined
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 16 0.5 1521603395803
connected to auth! from local port 50794
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 17 0.47058823529411764 1521603455814
connected to auth! from local port 50946
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 18 0.4444444444444444 1521603515825
connected to auth! from local port 51100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 19 0.42105263157894735 1521603575833
connected to auth! from local port 51254
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 20 0.4 1521603635844
connected to auth! from local port 51410
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 21 0.38095238095238093 1521603695853
connected to auth! from local port 51568
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 22 0.36363636363636365 1521603755864
connected to auth! from local port 51718
received auth hello!
{ authId: 502, nonce: <Buffer 62 20 06 15 04 07 69 d2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 93 4a 14 04 39 8a ef 80>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201556,
  cipherKeyVal: <Buffer c3 10 87 e5 0c ba a4 da c6 23 ad 27 e7 09 7b 9e>,
  macKeyVal: <Buffer 35 7e a4 34 75 53 2c 0a b4 e3 e4 52 d3 1b 72 c7 a0 da dc ba dd 64 91 46 1c 80 33 e3 22 5a 6c 72>,
  absValidity: 2018-03-22T03:43:11.547Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.18',
  serverPort: 22100,
  sessionKey: 
   { id: 50201556,
     cipherKeyVal: <Buffer c3 10 87 e5 0c ba a4 da c6 23 ad 27 e7 09 7b 9e>,
     macKeyVal: <Buffer 35 7e a4 34 75 53 2c 0a b4 e3 e4 52 d3 1b 72 c7 a0 da dc ba dd 64 91 46 1c 80 33 e3 22 5a 6c 72>,
     absValidity: 2018-03-22T03:43:11.547Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 09 01 d5 60 37 51 a9 ec>
switching to HANDSHAKE_1_SENT
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 23 0.34782608695652173 1521603815890
connected to auth! from local port 51866
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.18:undefined
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 24 0.3333333333333333 1521603875903
connected to auth! from local port 52016
received auth hello!
{ authId: 502, nonce: <Buffer ff c8 90 4b b2 09 c4 a9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2d 3a c8 b8 fa ec e3 17>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201585,
  cipherKeyVal: <Buffer 38 b9 78 c4 ee c1 c8 ca 54 70 2c 51 81 00 7b 1e>,
  macKeyVal: <Buffer 2e 67 88 12 d6 34 6c 6d 32 2b 22 42 db 53 e2 cc 3b 82 93 03 84 3c f0 72 04 2e 90 0d aa a7 0d 64>,
  absValidity: 2018-03-22T03:45:11.532Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.18',
  serverPort: 22100,
  sessionKey: 
   { id: 50201585,
     cipherKeyVal: <Buffer 38 b9 78 c4 ee c1 c8 ca 54 70 2c 51 81 00 7b 1e>,
     macKeyVal: <Buffer 2e 67 88 12 d6 34 6c 6d 32 2b 22 42 db 53 e2 cc 3b 82 93 03 84 3c f0 72 04 2e 90 0d aa a7 0d 64>,
     absValidity: 2018-03-22T03:45:11.532Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 14 26 3a 4a be 8a 4c 19>
switching to HANDSHAKE_1_SENT
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 25 0.32 1521603935926
connected to auth! from local port 52168
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.18:undefined
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 26 0.3076923076923077 1521603995935
connected to auth! from local port 52310
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 27 0.2962962962962963 1521604055946
connected to auth! from local port 52448
received auth hello!
{ authId: 502, nonce: <Buffer ed 5d e1 2d e6 bb 9f 11> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d3 4d 1c 41 9a df 65 cb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201624,
  cipherKeyVal: <Buffer 2a b1 ce e7 cd bb 57 5a 6c 73 72 37 12 23 6a 1f>,
  macKeyVal: <Buffer b4 8f 36 52 f8 22 23 7e be ab 5d a2 d4 fd cc f0 82 77 df 31 65 3b 64 25 a8 6d e9 87 40 65 34 dd>,
  absValidity: 2018-03-22T03:48:07.540Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.18',
  serverPort: 22100,
  sessionKey: 
   { id: 50201624,
     cipherKeyVal: <Buffer 2a b1 ce e7 cd bb 57 5a 6c 73 72 37 12 23 6a 1f>,
     macKeyVal: <Buffer b4 8f 36 52 f8 22 23 7e be ab 5d a2 d4 fd cc f0 82 77 df 31 65 3b 64 25 a8 6d e9 87 40 65 34 dd>,
     absValidity: 2018-03-22T03:48:07.540Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 45 2e 43 d2 69 1e d3 37>
switching to HANDSHAKE_1_SENT
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 28 0.2857142857142857 1521604115974
connected to auth! from local port 52602
received auth hello!
{ authId: 502, nonce: <Buffer fa 05 00 56 09 c9 85 28> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 18 b7 05 44 d2 8a b1 ac>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201632,
  cipherKeyVal: <Buffer 3e 99 76 0b 8f 0b d7 d5 4b 93 2d 69 2c 1f 4a 4a>,
  macKeyVal: <Buffer 98 26 b7 ab 1b 4c c3 74 13 d9 ec 56 b3 b6 f9 c5 78 3a 30 34 1d 3b 2f a2 8e b7 56 53 18 af a5 3b>,
  absValidity: 2018-03-22T03:48:39.774Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.18',
  serverPort: 22100,
  sessionKey: 
   { id: 50201632,
     cipherKeyVal: <Buffer 3e 99 76 0b 8f 0b d7 d5 4b 93 2d 69 2c 1f 4a 4a>,
     macKeyVal: <Buffer 98 26 b7 ab 1b 4c c3 74 13 d9 ec 56 b3 b6 f9 c5 78 3a 30 34 1d 3b 2f a2 8e b7 56 53 18 af a5 3b>,
     absValidity: 2018-03-22T03:48:39.774Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 7f 5a 04 57 fa 61 c3 61>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.18:undefined
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.18:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 29 0.27586206896551724 1521604175981
connected to auth! from local port 52750
