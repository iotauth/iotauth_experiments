changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s406.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's406',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 33 6c ... > }
Handler: listening on port 22100
s406:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200417
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53648
received auth hello!
{ authId: 402, nonce: <Buffer 58 ac e3 e0 ed 03 1d e2> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 30 90 ae 8e 57 f1 fb a6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer c5 9d 0f d0 52 bc 6e be f2 8c a5 90 89 a2 96 63>,
  macKeyVal: <Buffer 8f 9c 4c 51 98 5f 92 90 28 d1 32 91 6b 04 b3 f3 6a 16 aa 79 d3 e0 f8 65 07 ec fc 6c 59 1e 83 36>,
  absValidity: 2018-03-21T09:01:55.533Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 84 19 0d c3 b8 b5 65 32>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 84 19 0d c3 b8 b5 65 32> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.50:40264',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200424
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53804
received auth hello!
{ authId: 402, nonce: <Buffer d3 d0 dc 46 8b 80 80 d2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e5 33 fb 86 e7 d9 34 77>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 70 20 91 d0 3c fa 89 e3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 70 20 91 d0 3c fa 89 e3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.50:40420',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200431
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54066
received auth hello!
{ authId: 402, nonce: <Buffer 20 5f b8 ee 2a c9 73 61> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1d 33 44 6a 40 cd d5 f7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c2 5a 7b 6b df 46 23 38>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c2 5a 7b 6b df 46 23 38> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.50:40682',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200438
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54336
received auth hello!
{ authId: 402, nonce: <Buffer 05 5d e7 16 d8 c0 90 c2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7f 47 9e 90 66 ed 40 ba>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 18 fd 2f 2a ab e8 68 6a>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 18 fd 2f 2a ab e8 68 6a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.50:40952',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200445
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54606
received auth hello!
{ authId: 402, nonce: <Buffer a2 0e 2d 04 24 f1 ea be> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 72 57 85 b9 79 19 45 fe>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 59 5e 28 bf 33 4c 30 ce>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 59 5e 28 bf 33 4c 30 ce> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.50:41222',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200452
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54876
received auth hello!
{ authId: 402, nonce: <Buffer 1b aa 9c c5 a8 f4 a6 1c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 77 26 c5 d9 7b ae b5 99>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 65 92 48 90 20 dd 6f 17>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 65 92 48 90 20 dd 6f 17> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.50:41492',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200459
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55146
received auth hello!
{ authId: 402, nonce: <Buffer 07 a1 47 48 f6 38 99 ce> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c5 91 05 48 75 37 30 4c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 09 35 2d 6e 0b b5 1d db>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 09 35 2d 6e 0b b5 1d db> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.50:41762',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200466
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55416
received auth hello!
{ authId: 402, nonce: <Buffer c1 49 35 7b bb 28 1a ac> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5c b5 cc c8 e3 3b 4f da>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3b f0 f1 af 58 10 8e ab>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3b f0 f1 af 58 10 8e ab> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.50:42032',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
