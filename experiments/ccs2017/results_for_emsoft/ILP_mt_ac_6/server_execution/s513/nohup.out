changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s513.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's513',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 75 74 ... > }
Handler: listening on port 22100
s513:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300877
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52340
received auth hello!
{ authId: 502, nonce: <Buffer e2 9a de 77 5e 07 dc 85> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 39 eb a9 70 98 5b 98 1d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 2e c4 eb 3c 54 91 fc c9 fd 45 fc f9 d4 d5 ff 5c>,
  macKeyVal: <Buffer 90 b3 6a fc 79 e5 88 5c b7 b2 9c ff 94 d7 06 5f d0 61 13 da b8 95 8a 47 10 95 f9 70 99 a8 c7 ad>,
  absValidity: 2018-03-21T09:03:31.937Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 05 aa b0 e3 b0 4d d8 33>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 05 aa b0 e3 b0 4d d8 33> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.79:37824',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300882
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52610
received auth hello!
{ authId: 502, nonce: <Buffer 19 96 7b ae cc 41 18 fe> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 72 ef 99 ec 4c 09 54 9b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3d c8 5f c2 5d ef f2 b4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3d c8 5f c2 5d ef f2 b4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.79:38096',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300887
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52880
received auth hello!
{ authId: 502, nonce: <Buffer 16 5f ac a6 78 1f 1c da> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d8 17 c1 59 9b c0 16 0c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5b 01 05 a9 bc 4c 11 8d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 5b 01 05 a9 bc 4c 11 8d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.79:38366',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300892
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53150
received auth hello!
{ authId: 502, nonce: <Buffer 44 e8 fe 77 57 f7 1f 1d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fc ed c0 32 99 82 77 67>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 90 ea f4 16 b2 47 46 ca>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 90 ea f4 16 b2 47 46 ca> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.79:38636',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300897
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53422
received auth hello!
{ authId: 502, nonce: <Buffer e6 a5 e6 ea a2 23 f3 a7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer aa 8a eb 09 d2 5b a7 30>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bc 0a e1 f4 64 c5 92 97>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bc 0a e1 f4 64 c5 92 97> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.79:38906',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300902
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53690
received auth hello!
{ authId: 502, nonce: <Buffer 42 9a f5 b9 f2 9e 49 4e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 51 51 37 c9 c3 dd af 8e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ac 1c 5d 53 b5 93 fb 05>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ac 1c 5d 53 b5 93 fb 05> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.79:39176',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300907
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53958
received auth hello!
{ authId: 502, nonce: <Buffer e5 30 08 e7 65 85 a2 ac> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 74 fb 43 e0 46 7f ad ae>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 69 23 b4 3c 96 26 a6 71>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 69 23 b4 3c 96 26 a6 71> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.79:39442',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
