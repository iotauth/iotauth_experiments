changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s410.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's410',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 35 5a ... > }
Handler: listening on port 22100
s410:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200420
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57908
received auth hello!
{ authId: 402, nonce: <Buffer 89 0b 8e 3b 76 17 6e 65> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer d9 6b 8c a3 0a 29 f3 05>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 83 60 85 22 4d 41 6d a4 4b 04 b9 5a ca eb 0e 44>,
  macKeyVal: <Buffer 99 84 7b 0e 75 ea 30 c9 f2 2d 0b e7 fb 35 bc f2 62 7b 82 f0 7f 3d f4 71 ac d6 1c f2 00 5f 4e f5>,
  absValidity: 2018-03-21T09:02:06.756Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e1 92 dd ac b5 43 05 46>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e1 92 dd ac b5 43 05 46> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.53:60572',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200427
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58082
received auth hello!
{ authId: 402, nonce: <Buffer 9d b7 09 4b e1 42 3e e9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 26 4d db d2 ee 65 fb 79>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 42 c9 35 54 fc 8a 9d cc>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 42 c9 35 54 fc 8a 9d cc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.53:60746',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200434
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58354
received auth hello!
{ authId: 402, nonce: <Buffer 5d 6c b4 25 ba 32 e3 72> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d3 5e 08 f1 52 2f 68 2a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer dd 67 36 00 51 02 0c 7d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer dd 67 36 00 51 02 0c 7d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.53:32786',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200441
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58624
received auth hello!
{ authId: 402, nonce: <Buffer e1 55 17 f4 04 b7 1f 28> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 06 e8 53 ab b5 5c ed 26>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d3 2c da da 56 7a 8a 50>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer d3 2c da da 56 7a 8a 50> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.53:33056',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200448
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58894
received auth hello!
{ authId: 402, nonce: <Buffer 0a ca 29 e0 96 c8 d5 dc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 21 c3 47 a2 f7 ab 81 08>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9a de fc 39 e9 31 6a ac>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9a de fc 39 e9 31 6a ac> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.53:33326',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200455
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59164
received auth hello!
{ authId: 402, nonce: <Buffer 1a 49 f8 f4 7f dc 8d 06> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c8 fc f6 ec 16 51 21 c0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a3 f8 de 48 56 99 aa 06>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a3 f8 de 48 56 99 aa 06> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.53:33596',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200462
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59434
received auth hello!
{ authId: 402, nonce: <Buffer 7a 3b a2 9e 4d 85 69 cf> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6c bb 0b 6f 7d fb 0e 9a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ec 6b 00 77 e7 42 28 bd>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ec 6b 00 77 e7 42 28 bd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.53:33866',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200469
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59704
received auth hello!
{ authId: 402, nonce: <Buffer 55 9a 04 75 f3 bf 79 e8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4f 68 47 e2 a7 b8 81 56>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5c e3 01 3e d3 44 d6 aa>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5c e3 01 3e d3 44 d6 aa> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.53:34136',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
