changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s403.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's403',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 67 49 42 41 41 4b 43 41 51 45 41 6c 44 ... > }
Handler: listening on port 22100
s403:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101257
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55786
received auth hello!
{ authId: 401, nonce: <Buffer c5 74 ec c5 93 de 83 3b> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 1f f2 39 f0 db 60 ac 72>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 13 23 c0 4b 1b 28 5b 77 4c 0d 9d e4 2f e3 01 03>,
  macKeyVal: <Buffer a4 66 f1 a9 78 d6 ca 4f 8f 92 82 5a 70 49 92 bd d4 6b ea 9b a1 5d ed 3b dd 08 88 c7 1b 67 8a c7>,
  absValidity: 2018-03-21T09:01:45.926Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b6 90 23 2d 92 f8 14 73>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b6 90 23 2d 92 f8 14 73> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.47:43250',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101263
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55924
received auth hello!
{ authId: 401, nonce: <Buffer cc b7 ba e9 6a f6 77 f9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1e e6 64 68 b6 fe ec c0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 46 f2 51 dc fa b6 30 da>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 46 f2 51 dc fa b6 30 da> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.47:43388',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101269
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56172
received auth hello!
{ authId: 401, nonce: <Buffer de 3c d7 ea 2f 09 6d 58> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 91 93 a8 b8 6b 57 8e 31>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2b ec 7c ba b6 b3 9e f7>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 2b ec 7c ba b6 b3 9e f7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.47:43636',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101275
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56442
received auth hello!
{ authId: 401, nonce: <Buffer 5e ef 39 80 2f 34 cb ca> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9f e5 fb f3 4d 4b 8d 38>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 25 21 ac 05 f4 3c 4b 83>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 25 21 ac 05 f4 3c 4b 83> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.47:43906',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101281
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56712
received auth hello!
{ authId: 401, nonce: <Buffer d4 8d a2 f8 b4 ef 45 b8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 80 db 9a 0c 75 55 96 74>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e4 98 1c ba 60 29 40 94>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e4 98 1c ba 60 29 40 94> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.47:44176',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101287
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56982
received auth hello!
{ authId: 401, nonce: <Buffer 59 16 0e 93 ff 63 cb 1d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b2 2f 4e 58 8e 80 01 1f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a3 7c be 7e d2 2d 45 20>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a3 7c be 7e d2 2d 45 20> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.47:44446',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101293
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57252
received auth hello!
{ authId: 401, nonce: <Buffer ce 5f 2f 0b ae 12 74 8e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 49 09 cd 71 1b 52 8f 11>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8e 0d 5f a0 01 40 3e 49>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8e 0d 5f a0 01 40 3e 49> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.47:44716',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101299
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57522
received auth hello!
{ authId: 401, nonce: <Buffer 4c 8d 6e 00 b8 9b 6a 05> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 04 6d 29 68 b4 4e c7 69>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 39 20 7c f8 ca 28 e8 fc>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 39 20 7c f8 ca 28 e8 fc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.47:44986',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101305
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57768
received auth hello!
{ authId: 401, nonce: <Buffer e5 9e 77 2a d2 b1 77 23> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b0 c0 f8 d6 79 7a 40 a4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d8 4e 14 13 c8 5d 2d 18>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d8 4e 14 13 c8 5d 2d 18> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.47:45232',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
