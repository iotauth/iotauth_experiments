changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s415.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's415',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 74 46 ... > }
Handler: listening on port 22100
s415:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300697
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44874
received auth hello!
{ authId: 403, nonce: <Buffer 76 ba 69 ed 9a a2 70 98> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer af 0f f6 a9 43 c3 fd c8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 85 40 03 2e 6a 8b 55 61 d6 86 98 ae da 66 c0 56>,
  macKeyVal: <Buffer 80 f1 d9 6d f3 5b 23 1b 36 fd 6a d4 38 bd 05 cc e7 e4 a9 51 1c 91 d7 f1 25 6f 45 1f c9 f9 98 ae>,
  absValidity: 2018-03-21T09:02:25.264Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d2 6a c0 ca 2d 1c 76 1b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer d2 6a c0 ca 2d 1c 76 1b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.59:37616',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300703
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45084
received auth hello!
{ authId: 403, nonce: <Buffer e8 4b d6 80 d4 82 7c e2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 72 70 6c 5f 3e 3c 48 03>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ee fd e8 d9 04 e9 90 3d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ee fd e8 d9 04 e9 90 3d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.59:37826',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300709
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45356
received auth hello!
{ authId: 403, nonce: <Buffer 00 eb 00 95 82 79 f6 b2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a3 7b ee 4c c5 8b 87 55>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ed e6 a4 02 8e a0 79 58>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ed e6 a4 02 8e a0 79 58> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.59:38098',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300715
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45626
received auth hello!
{ authId: 403, nonce: <Buffer f3 eb c1 8a d1 96 e3 69> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 63 ec 43 5f f5 7e 1b 40>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5b 4a 91 68 4e cd 10 ae>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5b 4a 91 68 4e cd 10 ae> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.59:38368',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300721
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45896
received auth hello!
{ authId: 403, nonce: <Buffer ac 4d 00 da e4 5c ea d6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ba 5c be aa 9d a5 8e 08>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e6 6a 79 75 69 9e 59 fa>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e6 6a 79 75 69 9e 59 fa> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.59:38638',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300727
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46166
received auth hello!
{ authId: 403, nonce: <Buffer 68 b8 12 f2 ae 6b fa f2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer dc 50 ce 72 cc c3 96 27>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b8 7a 51 e1 6c 5b 75 eb>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b8 7a 51 e1 6c 5b 75 eb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.59:38908',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300733
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46436
received auth hello!
{ authId: 403, nonce: <Buffer 96 34 14 9b ca 15 36 66> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bb a0 07 8b 5b bc 23 7d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ab dd 85 b4 0e 24 9a 13>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ab dd 85 b4 0e 24 9a 13> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.59:39178',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300739
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46702
received auth hello!
{ authId: 403, nonce: <Buffer 6d b5 33 2a a5 a8 7e c9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e4 61 a8 81 85 db 13 ea>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a8 cb e7 1d 1e 7b 6f 30>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a8 cb e7 1d 1e 7b 6f 30> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.59:39444',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
