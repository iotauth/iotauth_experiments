changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s506.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's506',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 37 56 ... > }
Handler: listening on port 22100
s506:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100656
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39478
received auth hello!
{ authId: 501, nonce: <Buffer 82 a4 b8 14 07 2a b3 6c> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 7a 1b f6 3c ec de 30 dd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer fa 8b 60 a0 4e d2 13 bd 02 01 0d 68 6f c0 a1 cf>,
  macKeyVal: <Buffer 42 90 6a a9 71 f0 3d c6 58 00 92 3a ad 68 22 a0 44 75 71 72 8d aa cd 8f 6c 70 8c 69 7d a2 49 fd>,
  absValidity: 2018-03-21T09:03:01.367Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cf fa c1 04 0e 1d b0 e3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer cf fa c1 04 0e 1d b0 e3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.70:49608',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100664
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39750
received auth hello!
{ authId: 501, nonce: <Buffer e5 aa dd b3 8f 34 38 12> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 92 fa d7 52 10 33 86 ec>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8c 62 c9 4b 3d ef ec c5>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 8c 62 c9 4b 3d ef ec c5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.70:49878',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100672
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40020
received auth hello!
{ authId: 501, nonce: <Buffer 4d a2 7f da ae f4 eb fc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 40 86 00 8d 5e 07 0a 9a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 43 7f f7 e8 09 cb 5d 6c>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 43 7f f7 e8 09 cb 5d 6c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.70:50148',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100680
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40286
received auth hello!
{ authId: 501, nonce: <Buffer 31 f8 d1 77 a7 09 42 85> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 21 ba 3f 4f bf 73 3d 47>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f0 73 87 45 bf 00 22 01>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f0 73 87 45 bf 00 22 01> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.70:50416',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100688
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40560
received auth hello!
{ authId: 501, nonce: <Buffer ac 3a 65 84 88 d8 2e 8d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fd ee bb 15 9e c2 7a c5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fe 74 c2 b7 e4 0c 5b e8>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer fe 74 c2 b7 e4 0c 5b e8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.70:50690',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100696
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40830
received auth hello!
{ authId: 501, nonce: <Buffer 33 70 f4 12 e3 6e 6b c3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 84 d3 6e 93 c3 c5 4b 63>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4d 1a 46 a7 d2 68 5b ff>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4d 1a 46 a7 d2 68 5b ff> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.70:50960',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100704
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41100
received auth hello!
{ authId: 501, nonce: <Buffer 13 0b 2b 93 39 3b f5 4e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f3 19 a6 b5 82 0a e5 86>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ab 63 9b a5 7a bc e3 ed>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ab 63 9b a5 7a bc e3 ed> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.70:51230',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
