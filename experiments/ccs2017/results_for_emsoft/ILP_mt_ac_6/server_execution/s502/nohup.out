changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s502.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's502',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 70 71 ... > }
Handler: listening on port 22100
s502:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100651
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48112
received auth hello!
{ authId: 501, nonce: <Buffer 3e 6a cc 50 77 30 4e da> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer cd 6d d3 be a4 ff 8a 0b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer ab f2 3e b5 7e 36 99 50 65 2a 6a 99 29 4f 8f 91>,
  macKeyVal: <Buffer ef 6b 7f 8f a9 71 6a 4f ec 78 a4 71 66 d6 ec 7a 5b 31 53 79 4e 0a d2 4c 87 c1 3b c2 ff 82 61 95>,
  absValidity: 2018-03-21T09:02:37.644Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 59 a2 f6 9a c0 bf 57 be>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 59 a2 f6 9a c0 bf 57 be> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.63:34216',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100659
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48348
received auth hello!
{ authId: 501, nonce: <Buffer d5 2b 24 b5 43 1f a0 68> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 98 71 2e 25 d4 d4 a3 72>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3e 0c 07 45 5d ba 7a 54>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3e 0c 07 45 5d ba 7a 54> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.63:34452',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100667
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48618
received auth hello!
{ authId: 501, nonce: <Buffer 70 33 35 fa 29 8b 94 57> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b7 77 cb f0 39 5f ce 98>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 56 26 a7 6f 0b 3c 16 82>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 56 26 a7 6f 0b 3c 16 82> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.63:34722',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100675
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48888
received auth hello!
{ authId: 501, nonce: <Buffer c1 c3 41 ce 37 9f d9 b9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 57 50 2a 72 7a 59 5a 94>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ae e0 bc 62 ca 74 3c c3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ae e0 bc 62 ca 74 3c c3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.63:34992',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100683
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49158
received auth hello!
{ authId: 501, nonce: <Buffer 53 fb 6f 92 7e 35 71 f9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a1 a4 c2 a4 89 96 46 fe>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7c 79 a3 ca 79 cf 29 00>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 7c 79 a3 ca 79 cf 29 00> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.63:35262',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100691
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49428
received auth hello!
{ authId: 501, nonce: <Buffer e7 28 01 8e 07 3f dd 02> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 39 e4 1d c5 80 83 ad e2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b2 41 9e e3 47 37 9a 7a>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b2 41 9e e3 47 37 9a 7a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.63:35532',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100699
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49698
received auth hello!
{ authId: 501, nonce: <Buffer 96 36 b4 26 f8 67 50 e0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer dd ca da 5e a7 df 54 46>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0d 5c 1e aa ba 6d c1 30>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0d 5c 1e aa ba 6d c1 30> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.63:35802',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
