changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s411.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's411',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 79 45 ... > }
Handler: listening on port 22100
s411:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101255
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56854
received auth hello!
{ authId: 403, nonce: <Buffer b1 05 2c f3 f2 b2 4e 14> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 21 8f d6 3b 28 2f ce b9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 46 6a bf f1 a4 c9 b7 ba e9 9d 3e 35 ab c0 47 8a>,
  macKeyVal: <Buffer 4b d6 e5 90 e6 25 f7 7b 6f 44 28 ba 82 72 72 36 82 1a 55 7f fc 0d fa c9 5b 32 0b c6 f5 a2 28 c4>,
  absValidity: 2018-03-21T09:01:39.540Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 42 9a 07 aa c3 e5 a4 2a>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 42 9a 07 aa c3 e5 a4 2a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.45:58980',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101261
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56982
received auth hello!
{ authId: 403, nonce: <Buffer a5 0a 66 2c 4b 81 37 11> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d5 23 42 62 7b c1 a2 ec>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e3 4b af db 80 6f 27 13>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e3 4b af db 80 6f 27 13> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.45:59108',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101267
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57218
received auth hello!
{ authId: 403, nonce: <Buffer ad cf 4e 79 f2 59 60 9c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 24 c1 90 c4 72 d7 9a 5f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 06 09 ec 62 63 91 64 cb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 06 09 ec 62 63 91 64 cb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.45:59344',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101273
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57488
received auth hello!
{ authId: 403, nonce: <Buffer 50 e9 0f b0 38 ae 86 9d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1d 3a d3 dc a7 1e 57 e0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b4 ef 05 07 cc e1 21 dc>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b4 ef 05 07 cc e1 21 dc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.45:59614',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101279
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57758
received auth hello!
{ authId: 403, nonce: <Buffer 03 8e 5b bf 72 38 85 19> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a2 b7 9d 48 3c 25 59 cb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a5 59 bf 9d fd ca bc d0>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer a5 59 bf 9d fd ca bc d0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.45:59884',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101285
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58028
received auth hello!
{ authId: 403, nonce: <Buffer 03 c3 68 4d a3 74 11 03> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer de 80 28 41 e2 e6 2b 7d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 44 de 91 ac eb 5e d5 72>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 44 de 91 ac eb 5e d5 72> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.45:60154',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101291
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58298
received auth hello!
{ authId: 403, nonce: <Buffer fd e5 c4 4d 8c ff 8c 4b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8e 25 07 5f 75 6c 3e c9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 17 da 8f de b7 cb 03 8e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 17 da 8f de b7 cb 03 8e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.45:60424',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101297
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58568
received auth hello!
{ authId: 403, nonce: <Buffer 49 3c 02 d7 89 5d d6 3d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8d a4 77 61 f7 bf 73 57>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e8 55 79 c1 ef 91 45 cd>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e8 55 79 c1 ef 91 45 cd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.45:60694',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101303
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect ECONNREFUSED 10.0.1.3:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
