changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s404.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's404',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 67 49 42 41 41 4b 43 41 51 45 41 78 78 ... > }
Handler: listening on port 22100
s404:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101258
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47232
received auth hello!
{ authId: 401, nonce: <Buffer a3 a8 55 3a 1e 7f d6 23> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 4a 2f 88 b6 06 3e b4 54>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer ce 1e 9b 7f 32 cb f1 53 eb e0 a3 bb e0 6b 3b 55>,
  macKeyVal: <Buffer f0 84 95 f8 20 4a bd 15 d8 d6 13 30 a6 94 4e 33 ce f0 86 54 cf 6b ef 23 3c ed 6f fa 3e 9c 16 f1>,
  absValidity: 2018-03-21T09:01:49.382Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 75 67 aa da e4 1c 07 92>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 75 67 aa da e4 1c 07 92> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.48:57836',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101264
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47376
received auth hello!
{ authId: 401, nonce: <Buffer cb 3e a0 c7 cb d1 54 a7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 40 1b 4a 4e 46 ef 3e c5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 99 61 e8 5c 72 f9 35 66>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 99 61 e8 5c 72 f9 35 66> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.48:57980',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101270
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47628
received auth hello!
{ authId: 401, nonce: <Buffer af 9f bb 4e 40 4b 32 cf> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e5 e7 45 25 ba 17 17 a4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 59 39 b0 c8 9e 7f 34 77>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 59 39 b0 c8 9e 7f 34 77> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.48:58230',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101276
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47898
received auth hello!
{ authId: 401, nonce: <Buffer 0f f0 ce af d7 d0 fb 4d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d7 a6 a9 d7 ac 22 7b 7e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a0 6c a1 7a e8 a1 d7 ce>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a0 6c a1 7a e8 a1 d7 ce> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.48:58500',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101282
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48168
received auth hello!
{ authId: 401, nonce: <Buffer 1a ad 5a 29 8a c5 25 70> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e9 36 f4 8c 38 b2 cf 4f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 07 c3 b9 97 e9 5b ea 13>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 07 c3 b9 97 e9 5b ea 13> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.48:58770',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101288
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48438
received auth hello!
{ authId: 401, nonce: <Buffer e1 11 33 5b f1 55 0e a2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4d ad ea bf be 37 0a 60>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6e 8d 4a ef aa e0 99 f9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6e 8d 4a ef aa e0 99 f9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.48:59040',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101294
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48708
received auth hello!
{ authId: 401, nonce: <Buffer d5 29 e7 2c dd 94 b7 16> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 17 f3 a0 a7 17 f2 02 0f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d5 87 6b b7 aa be 19 25>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer d5 87 6b b7 aa be 19 25> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.48:59310',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101300
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48978
received auth hello!
{ authId: 401, nonce: <Buffer 7a 01 e7 df 26 81 05 50> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a1 f7 7a aa cb 3a c2 a3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4a 2b ed b6 7a 56 e3 f9>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 4a 2b ed b6 7a 56 e3 f9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.48:59580',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101306
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49218
received auth hello!
{ authId: 401, nonce: <Buffer 3a 81 9a 5e ce fe de 49> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b5 88 15 99 16 b6 1b c7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 99 9e 4d fc 0a ec 5f 39>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 99 9e 4d fc 0a ec 5f 39> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.48:59822',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
