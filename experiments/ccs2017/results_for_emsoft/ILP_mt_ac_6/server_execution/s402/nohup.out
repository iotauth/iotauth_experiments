changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s402.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's402',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 35 57 ... > }
Handler: listening on port 22100
s402:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101254
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34346
received auth hello!
{ authId: 401, nonce: <Buffer 3b b9 cb 0c b3 6d 64 64> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 8a 5a 75 7e 35 c3 ef a8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer d8 89 a2 d9 9f d8 e6 90 2b 51 57 d3 51 e6 8d ef>,
  macKeyVal: <Buffer 83 6f d7 cf 1c 32 5b 6d 8e 3c d1 00 c1 3b 56 86 4a 60 46 8c f2 3d ca 72 c8 89 1f 04 6f 1a 76 27>,
  absValidity: 2018-03-21T09:01:36.167Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 04 a7 e2 7a 40 6e e4 10>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 04 a7 e2 7a 40 6e e4 10> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.44:35324',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101260
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34468
received auth hello!
{ authId: 401, nonce: <Buffer bb 3e 5a c3 df aa 8c 76> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 20 d6 67 14 b0 3f ec b1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2e 6e 27 de ce e6 3b 39>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2e 6e 27 de ce e6 3b 39> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.44:35446',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101266
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34698
received auth hello!
{ authId: 401, nonce: <Buffer 0a b1 3a 26 77 90 35 53> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5b df b7 b0 0c 8f 1d 97>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 59 22 49 df 48 e4 69 90>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 59 22 49 df 48 e4 69 90> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.44:35676',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101272
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34968
received auth hello!
{ authId: 401, nonce: <Buffer 0b c7 ed 88 5e 9c 9c ca> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ba 10 6c de c6 a2 bc 78>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 43 85 21 a2 d0 2d 22 2c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 43 85 21 a2 d0 2d 22 2c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.44:35946',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101278
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35238
received auth hello!
{ authId: 401, nonce: <Buffer 53 d1 b6 86 b7 da ed bf> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1e 1a 81 df 2f da 65 f8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 67 6c 45 8e 61 3f dd a2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 67 6c 45 8e 61 3f dd a2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.44:36216',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101284
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35508
received auth hello!
{ authId: 401, nonce: <Buffer 9d 40 53 39 9c 37 04 f6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 51 84 49 f7 1f 6e e9 44>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4e 21 fd fa 1b cd fe 57>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4e 21 fd fa 1b cd fe 57> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.44:36486',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101290
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35778
received auth hello!
{ authId: 401, nonce: <Buffer 16 7c c8 7d db ae b1 88> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ac 25 16 fb 77 9c f1 52>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 80 9e 8b e4 44 5b 17 ce>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 80 9e 8b e4 44 5b 17 ce> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.44:36756',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101296
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36048
received auth hello!
{ authId: 401, nonce: <Buffer 18 42 87 a5 b1 8d d5 0f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0a 12 5c 8a 1d ea 00 a2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 39 03 41 0c 32 86 05 ed>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 39 03 41 0c 32 86 05 ed> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.44:37026',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101302
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36310
received auth hello!
{ authId: 401, nonce: <Buffer a7 a1 d3 5a ac 61 ca 60> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 50 39 da ec 91 bb 3d c8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3c 5b ec ea 92 8f 52 ef>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3c 5b ec ea 92 8f 52 ef> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.44:37288',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
