changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s408.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's408',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 70 6f ... > }
Handler: listening on port 22100
s408:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200419
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40992
received auth hello!
{ authId: 402, nonce: <Buffer 0e 97 94 91 08 44 f0 76> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer eb ea 18 7c 1a 25 41 25>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 3e bf 81 ed 9d 01 14 41 8e d3 06 4d 3d b5 45 24>,
  macKeyVal: <Buffer 32 58 a1 ec 7a 8c 1d 4a c1 05 08 06 88 e3 e3 86 49 71 34 15 72 34 c7 ca 0d c3 1a 68 f4 a7 bf 21>,
  absValidity: 2018-03-21T09:02:02.741Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ac 75 4a 5f 7e c5 fa 45>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ac 75 4a 5f 7e c5 fa 45> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.52:35016',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200421
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41004
received auth hello!
{ authId: 402, nonce: <Buffer 22 17 90 2e 0e 31 4c 15> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c2 ff 64 c3 36 9b 6b 9a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a6 d5 b1 65 94 38 25 db>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a6 d5 b1 65 94 38 25 db> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.54:38772',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200426
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41160
received auth hello!
{ authId: 402, nonce: <Buffer 8e 67 de 01 22 6b b8 a5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cb 42 cd 25 e4 f3 47 e3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 49 2d ae 7f 48 18 68 5e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 49 2d ae 7f 48 18 68 5e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.52:35184',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200428
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41184
received auth hello!
{ authId: 402, nonce: <Buffer a8 b7 d0 f1 7d 87 cb ea> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer de 6d d2 14 8f ea d1 8b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1a 68 b0 d3 9a 64 59 a7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1a 68 b0 d3 9a 64 59 a7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.54:38952',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200433
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41432
received auth hello!
{ authId: 402, nonce: <Buffer 69 c8 39 63 58 b6 88 28> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e2 9f e5 22 f1 05 c4 00>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 62 09 86 96 83 d0 39 9a>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 62 09 86 96 83 d0 39 9a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.52:35456',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200435
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41456
received auth hello!
{ authId: 402, nonce: <Buffer 45 c4 9d 8a 63 ea 36 2a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 97 e0 8a fa ab f5 80 c4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d0 59 30 65 cf f8 3b 0a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d0 59 30 65 cf f8 3b 0a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.54:39224',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200440
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41702
received auth hello!
{ authId: 402, nonce: <Buffer 88 22 cc 59 07 0e b4 b9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e1 5d 83 89 81 eb c9 6d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c9 37 7d 16 10 8d 7a 26>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c9 37 7d 16 10 8d 7a 26> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.52:35726',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200442
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41726
received auth hello!
{ authId: 402, nonce: <Buffer 95 c0 1d e5 3f 38 e9 55> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b3 09 32 c2 96 63 c7 88>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e3 0d ee 89 a8 fb 8a 85>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e3 0d ee 89 a8 fb 8a 85> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.54:39494',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200447
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41972
received auth hello!
{ authId: 402, nonce: <Buffer b9 18 56 92 4a 19 d0 37> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 99 22 20 46 99 53 59 78>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 04 93 a3 f5 26 ad 27 e2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 04 93 a3 f5 26 ad 27 e2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.52:35996',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200449
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41996
received auth hello!
{ authId: 402, nonce: <Buffer 6d 83 c6 a3 2f 1d d9 6d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 56 00 eb e1 26 d3 1e b3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fd 64 15 19 c8 e6 e2 a3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fd 64 15 19 c8 e6 e2 a3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.54:39764',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200454
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42242
received auth hello!
{ authId: 402, nonce: <Buffer df 96 4b 9d 99 f4 b1 e3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bc 82 cf 84 59 60 bf e4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ad b0 91 6c 41 d1 34 a0>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ad b0 91 6c 41 d1 34 a0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.52:36266',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200456
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42266
received auth hello!
{ authId: 402, nonce: <Buffer 14 2e d9 8e d2 a9 04 80> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d7 35 0e c7 35 8e 38 6b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 38 07 f9 e0 2f 05 ad c1>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 38 07 f9 e0 2f 05 ad c1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.54:40034',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200461
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42512
received auth hello!
{ authId: 402, nonce: <Buffer bc 02 0c 04 30 38 4e fb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d5 34 6c 60 8b 72 9c 77>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 41 89 05 88 01 89 6b d7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 41 89 05 88 01 89 6b d7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.52:36536',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200463
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42536
received auth hello!
{ authId: 402, nonce: <Buffer 2a 89 02 13 0c 93 51 31> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e6 9b 84 1d b3 9f dd 76>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 28 39 52 21 6a e5 67 f1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 28 39 52 21 6a e5 67 f1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.54:40304',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200468
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42782
received auth hello!
{ authId: 402, nonce: <Buffer 83 38 fc a6 a2 11 24 34> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2d 5b a2 e0 72 9a e6 25>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bb 94 88 d5 e6 f0 5a 65>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bb 94 88 d5 e6 f0 5a 65> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.52:36806',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200470
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42806
received auth hello!
{ authId: 402, nonce: <Buffer df e3 25 2c a4 53 34 b0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 92 8d a7 a9 70 f3 6a de>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 10 f7 3c 50 c5 57 14 c6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 10 f7 3c 50 c5 57 14 c6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.54:40574',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
