changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s407.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's407',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 6f 66 ... > }
Handler: listening on port 22100
s407:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200198
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42510
received auth hello!
{ authId: 402, nonce: <Buffer a8 af d8 fc af ad f9 b3> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 91 75 14 24 8c 2a ca 9e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 29 ec 56 c7 b2 01 a0 fc 50 bc c6 ea 33 3c 15 6a>,
  macKeyVal: <Buffer 96 e7 1d f4 6c d3 df c5 de b9 5d 5d f7 4d b3 b8 3d 4a 63 2f 25 18 25 82 e1 ae fe 57 57 37 0c 4b>,
  absValidity: 2018-03-21T06:02:39.817Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 72 ab ea df bc 31 ab b5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 72 ab ea df bc 31 ab b5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.51:42906',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200205
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42672
received auth hello!
{ authId: 402, nonce: <Buffer 23 a1 2b 4b 84 83 df 52> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 22 cd f3 e1 88 f1 1c 6d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 04 9d de 24 8c 7e f1 cc>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 04 9d de 24 8c 7e f1 cc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.51:43068',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200212
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42940
received auth hello!
{ authId: 402, nonce: <Buffer cf a2 a9 ac 19 a2 50 9f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 32 16 0a f2 ed 80 ce 36>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 47 84 c4 d3 57 e2 48 40>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 47 84 c4 d3 57 e2 48 40> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.51:43336',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200219
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43210
received auth hello!
{ authId: 402, nonce: <Buffer 0a 51 e8 3c d0 80 9e 95> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f2 ff f7 b6 b9 68 9b 02>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8d fb ed d0 b3 7a 40 04>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 8d fb ed d0 b3 7a 40 04> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.51:43606',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200226
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43480
received auth hello!
{ authId: 402, nonce: <Buffer fc dd cf fd 0d 5f 62 f5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5c 43 09 ac 81 d1 87 9e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 69 f6 4e 38 49 96 17 7d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 69 f6 4e 38 49 96 17 7d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.51:43876',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200233
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43750
received auth hello!
{ authId: 402, nonce: <Buffer 9b 33 8f df ae a4 e6 bd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fb ce 90 91 ce 3e 19 57>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1c 15 f9 18 4d 2f ae 20>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 1c 15 f9 18 4d 2f ae 20> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.51:44146',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200240
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44020
received auth hello!
{ authId: 402, nonce: <Buffer 4f 31 46 f7 88 c4 01 dd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a7 7f 8d 27 1a 8f e6 91>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c9 f1 50 ee 17 04 1d 26>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c9 f1 50 ee 17 04 1d 26> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.51:44416',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200247
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44290
received auth hello!
{ authId: 402, nonce: <Buffer 8e e6 61 e5 ac 43 d8 b7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 13 01 17 ab 06 f8 f5 c6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8a cb 59 1b 39 39 85 e4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8a cb 59 1b 39 39 85 e4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.51:44686',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300187
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300197
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 58796
received auth hello!
{ authId: 503, nonce: <Buffer f2 c7 a0 2f ed 61 74 c9> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth503',
     commonName: '10.0.1.6' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth402',
     commonName: '10.0.0.2' },
  serial: '016246EE9CC9',
  notBefore: 2018-03-21T04:59:25.000Z,
  notAfter: 2018-03-22T05:01:05.000Z,
  subjectHash: '5542437f',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'ED:59:C1:CD:8F:D8:22:41:D5:07:A3:DF:8D:4C:AF:0B:8D:7B:16:80',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'E2C77ADB548D185210E7FA2988369325521D9CF6957B61D640674333307D4FC133154B2C56A9BBCE5655BEDE59A620D2F68A660E6DEB43308DBAFD7A396559B1C6BD0ED769D2F4066CEB2BFDB38188C4D295C06D196ECCC621767B060A3D3BCF3CF4458D7031B2D0AB66B8846DD9C1D4374DEB5D3E30D68FF926574682526527828E3BB232E36626859A826F5DA69748C9567F01930811E1C310842AAE799D7FAD1E9BE8B5D23DC0BC0D4537FC44D1FE7D84E57938DEE6D651DAEC8C897885315FE2797FFB87939E2A342186F4C566B1623BD369CC0226678E3A96E9092471F81CCC14C868DBEA8B6F0B2E5D566294136E91C2B3B101366D8A5B6642614F0CF5',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.6' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 503,
  host: '10.0.1.6',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJG7pzJMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDIxETAPBgNVBAMMCDEwLjAuMC4yMB4XDTE4MDMy\nMTA0NTkyNVoXDTE4MDMyMjA1MDEwNVowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMzERMA8GA1UEAwwIMTAuMC4xLjYwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDix3rbVI0YUhDn+imINpMlUh2c9pV7YdZAZ0MzMH1PwTMVSyxW\nqbvOVlW+3lmmINL2imYObetDMI26/Xo5ZVmxxr0O12nS9AZs6yv9s4GIxNKVwG0Z\nbszGIXZ7Bgo9O8889EWNcDGy0KtmuIRt2cHUN03rXT4w1o/5JldGglJlJ4KOO7Iy\n42YmhZqCb12ml0jJVn8BkwgR4cMQhCqueZ1/rR6b6LXSPcC8DUU3/ETR/n2E5Xk4\n3ubWUdrsjIl4hTFf4nl/+4eTnio0IYb0xWaxYjvTacwCJmeOOpbpCSRx+BzMFMho\n2+qLbwsuXVZilBNukcKzsQE2bYpbZkJhTwz1AgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQYwDQYJKoZIhvcNAQELBQADggEBALMEUwPDm8I0xyKuhsItBhz9NBiTqlwm\nlxHlhbWBbdfIPGPY40mlsas1Lm1HVQVaQPEYU/d60AqUB9SC/fCrY3YOQLK5mM1O\n8fbSJjrQlmM3go6tKH4oWMQq8BIgB10+1c0p+XDR8EUPvp6ZEXWD17SBUb/mvwzg\nROmKid2Y0A1dMUukNN68TO2HScqHF6EzVsD5DiJGUPYtc+uj0+WDA9RfA54ECZH3\nzDNIgYGseyikjtxOdgl6oe8SnFQie9fM2xrpnjJRii6sUL0vwK7BkV/Nf01/qwAE\nNhmkwmuYwSJlmrdVgizIRQz0WOgUx/oC/0gbKc01BbvcU10qjfzog2w=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300207
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59064
received auth hello!
{ authId: 503, nonce: <Buffer 07 96 f4 f0 ed b3 b6 30> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 17 59 26 02 d2 cc bc 36>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer e8 b5 49 64 e6 97 5c 4f cc 7d 17 51 77 93 cb cf>,
  macKeyVal: <Buffer 10 64 a0 94 98 cf 80 0c 82 f8 55 be a6 a0 3c 53 91 15 7b c8 04 b8 94 bc 43 cf 82 5c df d2 09 b9>,
  absValidity: 2018-03-21T06:14:40.269Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 52 f8 bd 0f 3b e1 7b 96>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 52 f8 bd 0f 3b e1 7b 96> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.51:45970',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300217
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59332
received auth hello!
{ authId: 503, nonce: <Buffer 57 99 0a 03 09 34 fc f2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7e c9 8e 98 52 87 70 e2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 12 d9 c3 a4 dd ed 3e 19>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 12 d9 c3 a4 dd ed 3e 19> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.51:46238',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300227
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59598
received auth hello!
{ authId: 503, nonce: <Buffer 28 cd 6d d7 0e 9f a9 f1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bc f7 2e d2 87 06 8b 7d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d3 e4 a8 4b ea 3e 94 19>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d3 e4 a8 4b ea 3e 94 19> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.51:46502',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300237
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59864
received auth hello!
{ authId: 503, nonce: <Buffer dd 7a 92 8c e1 28 47 a7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8a f7 c1 33 af 3f 14 b8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f1 5d cb 2c 84 e5 08 34>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f1 5d cb 2c 84 e5 08 34> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.51:46770',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300247
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60134
received auth hello!
{ authId: 503, nonce: <Buffer ee e8 ef 37 9e 25 4d f5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 23 5a e8 b8 3f 0c 81 06>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 82 4d a7 23 e6 e1 5f 85>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 82 4d a7 23 e6 e1 5f 85> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.51:47036',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300257
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60400
received auth hello!
{ authId: 503, nonce: <Buffer c5 14 f3 f5 9b 1a 9c ed> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7a 14 e4 44 4b 34 09 2a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 84 f5 73 2c f6 43 29 00>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 84 f5 73 2c f6 43 29 00> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.51:47306',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300267
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60666
received auth hello!
{ authId: 503, nonce: <Buffer ef 0a 4c 0a f0 cb bf bf> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ea ef 2d 44 de e2 e8 14>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer dc c4 6f 8e 40 aa 0c 0f>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer dc c4 6f 8e 40 aa 0c 0f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.51:47572',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300277
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60928
received auth hello!
{ authId: 503, nonce: <Buffer 44 f8 d1 3e db 5f 7d 88> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a3 4a fb 4e b3 9a a8 cc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8e e9 e1 30 aa b3 aa 4d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 8e e9 e1 30 aa b3 aa 4d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.51:47834',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300287
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 32966
received auth hello!
{ authId: 503, nonce: <Buffer 9a 2f 13 3b 0c de c0 6e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ee 1f c9 87 9b 10 a0 dd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6c 6e d7 f4 bb ca be 41>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 6c 6e d7 f4 bb ca be 41> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.51:48104',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300297
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33224
received auth hello!
{ authId: 503, nonce: <Buffer 16 69 5c 3d 4e 62 06 74> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4b 3a 35 12 c7 5d cf 23>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 29 a8 8f 03 aa f7 e6 27>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 29 a8 8f 03 aa f7 e6 27> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.51:48362',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300307
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33490
received auth hello!
{ authId: 503, nonce: <Buffer ed 44 8f 29 60 38 9f c4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 04 e6 98 4f ce b9 64 5c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1c 56 28 c8 1c cc 2a b7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1c 56 28 c8 1c cc 2a b7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.51:48628',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300317
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33760
received auth hello!
{ authId: 503, nonce: <Buffer 27 6c 09 da 1e 65 42 03> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9b db 64 1b ea 1d 34 b6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ed 51 74 19 44 d4 8d 1d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ed 51 74 19 44 d4 8d 1d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.51:48898',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300327
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34030
received auth hello!
{ authId: 503, nonce: <Buffer 64 06 08 fc 1b ca 15 4a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c6 55 80 73 78 63 68 42>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6d 2c de 65 fd 3d a5 e4>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 6d 2c de 65 fd 3d a5 e4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.51:49168',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300337
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34292
received auth hello!
{ authId: 503, nonce: <Buffer f8 44 0e 23 85 48 40 0b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3c 8a f3 30 dd fe 14 c1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a2 67 77 ca 3e 47 5d 5a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a2 67 77 ca 3e 47 5d 5a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.51:49430',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300347
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34554
received auth hello!
{ authId: 503, nonce: <Buffer 4f b3 71 01 27 f4 1f 26> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 25 df 0c 53 d0 a7 2c a6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 92 24 95 27 6b 9a 22 1d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 92 24 95 27 6b 9a 22 1d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.51:49692',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300357
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34820
received auth hello!
{ authId: 503, nonce: <Buffer ea 13 7f 43 c7 84 51 a8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 90 7c be 06 93 43 9b de>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b8 75 26 de 8a ac 30 b8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b8 75 26 de 8a ac 30 b8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.51:49958',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
