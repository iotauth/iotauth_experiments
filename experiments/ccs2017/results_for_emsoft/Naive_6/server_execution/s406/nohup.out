changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s406.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's406',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 7a 42 ... > }
Handler: listening on port 22100
s406:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200417
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58684
received auth hello!
{ authId: 402, nonce: <Buffer 70 2d 2a fa f9 32 4e 40> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 9d 07 6e 66 89 7f 3c f9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 16 07 82 81 66 e4 ec de c6 7f b1 db b9 7c e3 35>,
  macKeyVal: <Buffer 6f 3b dd e4 fc 2e 52 23 5f 2b be cc 98 e3 ff 9c fc 61 43 8c 29 86 f1 8b 08 98 dc 00 bd f7 95 d0>,
  absValidity: 2018-03-20T23:09:04.520Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bd a8 b6 3b d0 44 07 89>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer bd a8 b6 3b d0 44 07 89> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.50:45300',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200424
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58840
received auth hello!
{ authId: 402, nonce: <Buffer 89 e3 26 fa 1f be b6 d3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3f 65 1f ea 7e d4 5b c3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 83 17 49 f8 7f 17 85 8a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 83 17 49 f8 7f 17 85 8a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.50:45456',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200431
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59100
received auth hello!
{ authId: 402, nonce: <Buffer a0 14 57 e4 7a 31 27 d8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0c de aa b0 8c 4c 18 4a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 84 4b 67 98 13 1d 04 6e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 84 4b 67 98 13 1d 04 6e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.50:45716',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200438
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59370
received auth hello!
{ authId: 402, nonce: <Buffer 9a e8 f6 22 b1 42 0f 0c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7a 43 19 39 55 4f c5 6d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6b 01 a8 1b 95 f6 b5 ca>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6b 01 a8 1b 95 f6 b5 ca> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.50:45986',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200445
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59640
received auth hello!
{ authId: 402, nonce: <Buffer 6f b6 7f 64 c7 10 bf 52> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 12 8c 92 f1 86 0c 99 af>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ad c9 2f 65 39 bc 3a ff>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ad c9 2f 65 39 bc 3a ff> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.50:46256',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200452
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59910
received auth hello!
{ authId: 402, nonce: <Buffer 68 04 07 2c 44 d3 47 da> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c2 1e ef b0 87 09 85 8f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fd e2 14 2e 2f ad 0b 46>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fd e2 14 2e 2f ad 0b 46> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.50:46526',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200459
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60180
received auth hello!
{ authId: 402, nonce: <Buffer cf d2 4a 1e c9 3f d5 f5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 15 8f 60 e3 4b f3 e5 9a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 72 91 91 77 93 0d cc ee>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 72 91 91 77 93 0d cc ee> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.50:46796',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200466
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60450
received auth hello!
{ authId: 402, nonce: <Buffer 2f d9 d1 85 db c2 cb ad> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ae f6 3e 34 45 68 25 f8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 83 03 1c 2e ca 5e 89 eb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 83 03 1c 2e ca 5e 89 eb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.50:47066',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
