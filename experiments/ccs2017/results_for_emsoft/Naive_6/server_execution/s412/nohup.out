changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s412.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's412',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 67 49 42 41 41 4b 43 41 51 45 41 77 76 ... > }
Handler: listening on port 22100
s412:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300601
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33782
received auth hello!
{ authId: 403, nonce: <Buffer 95 3e fa 88 b8 16 74 af> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 93 79 cc 0a be 72 5b fb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 44 c1 42 01 a8 05 12 bf 28 74 e4 6e 3d eb 75 9d>,
  macKeyVal: <Buffer a9 cf bd 1b ea e3 9b ba 6f a4 ee eb b0 55 1c b4 08 01 dd 82 aa da 71 a0 3e 69 e5 36 bc 5a 69 0f>,
  absValidity: 2018-03-20T23:09:27.187Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c0 d6 87 ff 0b f9 d7 f3>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c0 d6 87 ff 0b f9 d7 f3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.57:42852',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300607
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33980
received auth hello!
{ authId: 403, nonce: <Buffer bf a0 fa bf bc d4 ce 39> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 01 34 13 a9 a0 07 67 a3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ee 72 11 dc d0 40 3e c4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ee 72 11 dc d0 40 3e c4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.57:43050',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300613
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34250
received auth hello!
{ authId: 403, nonce: <Buffer 6e cb 8b 22 e2 ad 2e 69> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a3 20 9a da 9c 88 c4 fd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ad bd 05 38 b3 97 56 49>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ad bd 05 38 b3 97 56 49> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.57:43320',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300619
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34520
received auth hello!
{ authId: 403, nonce: <Buffer d3 ed 53 f4 80 4a 3b 5c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 51 65 36 11 cd 8c 61 bf>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 95 0d 79 fd 08 32 b8 69>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 95 0d 79 fd 08 32 b8 69> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.57:43590',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300625
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34790
received auth hello!
{ authId: 403, nonce: <Buffer 67 1f 69 3d 02 22 28 e0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 49 75 0f 99 27 cb 86 84>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a6 1a 0d 5a f6 26 ed 7b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a6 1a 0d 5a f6 26 ed 7b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.57:43860',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300631
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35060
received auth hello!
{ authId: 403, nonce: <Buffer 49 3b 5a 68 c1 f2 7f 47> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2f 41 77 3b 13 53 27 29>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 80 6f 62 c9 80 a0 3b af>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 80 6f 62 c9 80 a0 3b af> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.57:44130',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300637
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35330
received auth hello!
{ authId: 403, nonce: <Buffer 21 a7 b8 e9 df dd da ed> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 43 e1 75 69 53 35 90 a8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b9 60 b6 4e 99 2a 9a 5e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b9 60 b6 4e 99 2a 9a 5e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.57:44400',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300643
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35596
received auth hello!
{ authId: 403, nonce: <Buffer 02 f8 6a 04 96 1b c4 6c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5b dd 32 22 7e 4f 25 53>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer dd a5 02 63 0e 09 70 c5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer dd a5 02 63 0e 09 70 c5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.57:44666',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
