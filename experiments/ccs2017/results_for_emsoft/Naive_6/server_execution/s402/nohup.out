changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s402.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's402',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 51 49 42 41 41 4b 43 41 51 45 41 33 6a ... > }
Handler: listening on port 22100
s402:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101300
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39384
received auth hello!
{ authId: 401, nonce: <Buffer 56 9e 5d 57 44 03 17 f2> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer d4 15 be 4b f9 a1 8b 74>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 6e dd 59 80 3a ac bb 0c c3 81 7c ff 44 c8 2a 73>,
  macKeyVal: <Buffer f1 a8 7c 69 87 25 da 62 c8 fa 7e 47 3c 1c 83 e6 c0 1d 1c 34 fe e4 da 32 2e 5a 0c 4d 76 88 c3 46>,
  absValidity: 2018-03-20T23:08:45.109Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6b 02 dc a0 8c dd 48 17>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 6b 02 dc a0 8c dd 48 17> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.44:40362',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101306
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39504
received auth hello!
{ authId: 401, nonce: <Buffer 31 51 fd 05 1f 3f f1 33> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ab db e0 44 19 4d 96 a8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f3 cc f2 11 ed fe 4f 66>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f3 cc f2 11 ed fe 4f 66> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.44:40482',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101312
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39732
received auth hello!
{ authId: 401, nonce: <Buffer 46 72 67 99 bd 89 15 f0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 16 09 a4 dc e7 c2 9e ae>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 73 ad b2 72 84 2d 58 5f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 73 ad b2 72 84 2d 58 5f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.44:40710',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101318
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40002
received auth hello!
{ authId: 401, nonce: <Buffer a4 3e ce 71 8f 8b d9 70> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a7 66 f1 82 95 35 39 95>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 25 57 85 96 56 5a e1 56>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 25 57 85 96 56 5a e1 56> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.44:40980',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101324
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40272
received auth hello!
{ authId: 401, nonce: <Buffer 85 df 6a 9f 3c 9f 55 58> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 23 ff e4 9b 78 07 33 43>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 16 85 44 57 4f 45 02 d0>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 16 85 44 57 4f 45 02 d0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.44:41250',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101330
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40542
received auth hello!
{ authId: 401, nonce: <Buffer 65 20 8d ab 6c 6c a3 af> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e0 82 49 dc 7f c7 93 08>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5d e1 31 12 2a 4c cf 92>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5d e1 31 12 2a 4c cf 92> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.44:41520',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101336
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40812
received auth hello!
{ authId: 401, nonce: <Buffer 59 6d e0 01 cb 4b 17 03> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer df 42 73 f3 f0 af db ee>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 95 8d 98 87 89 88 95 16>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 95 8d 98 87 89 88 95 16> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.44:41790',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101342
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41082
received auth hello!
{ authId: 401, nonce: <Buffer dc e7 d8 74 99 c0 72 25> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 15 62 08 41 c1 d2 b0 cb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7d 04 74 c9 f4 62 56 16>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 7d 04 74 c9 f4 62 56 16> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.44:42060',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101348
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41344
received auth hello!
{ authId: 401, nonce: <Buffer 49 ac 99 4a 70 d0 8f a5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3e 55 33 09 63 ea 06 32>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 85 34 59 38 47 b2 68 32>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 85 34 59 38 47 b2 68 32> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.44:42322',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
