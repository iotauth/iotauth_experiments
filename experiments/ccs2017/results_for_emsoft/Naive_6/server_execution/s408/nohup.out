changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s408.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's408',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 51 49 42 41 41 4b 43 41 51 45 41 76 61 ... > }
Handler: listening on port 22100
s408:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200419
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46028
received auth hello!
{ authId: 402, nonce: <Buffer e9 4e 30 68 73 11 0b 99> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 13 41 05 7e 2e ff b6 af>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 5b a5 13 20 09 0a 80 6f 67 b5 09 13 45 aa 1e 19>,
  macKeyVal: <Buffer 41 37 e3 22 a5 7a 6c 9f 10 b4 fa ef 20 9c 98 1c 82 2a 90 14 74 68 8a f4 1b 7f 41 f1 03 e1 7c 6d>,
  absValidity: 2018-03-20T23:09:11.650Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cb 54 76 a4 24 17 c6 79>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer cb 54 76 a4 24 17 c6 79> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.52:40052',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200421
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46040
received auth hello!
{ authId: 402, nonce: <Buffer 9e a7 bf fd 0f 18 7c 9b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a6 f7 b6 80 12 93 72 cc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d5 e3 3e e1 97 20 e9 17>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d5 e3 3e e1 97 20 e9 17> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.54:43808',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200426
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46196
received auth hello!
{ authId: 402, nonce: <Buffer 94 d2 96 c3 4c 9d 87 4d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a9 8d 0b 4e 89 a5 e5 ea>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 54 bd c4 40 18 11 29 60>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 54 bd c4 40 18 11 29 60> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.52:40220',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200428
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46220
received auth hello!
{ authId: 402, nonce: <Buffer b9 a3 4b 4f e4 d7 65 ce> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 12 63 e5 bf a5 a2 fa e3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 08 bc c9 c2 9a c1 ef 53>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 08 bc c9 c2 9a c1 ef 53> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.54:43988',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200433
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46466
received auth hello!
{ authId: 402, nonce: <Buffer 27 c3 de 11 51 70 a5 b7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a4 4b e9 fd 63 71 a6 c7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 22 fd d6 fa 19 06 a0 ea>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 22 fd d6 fa 19 06 a0 ea> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.52:40490',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200435
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46490
received auth hello!
{ authId: 402, nonce: <Buffer 83 fe e7 36 da 4f 46 9a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 52 f7 a4 35 b3 e0 0f 9e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0f c2 45 4a 06 98 75 dd>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0f c2 45 4a 06 98 75 dd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.54:44258',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200440
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46736
received auth hello!
{ authId: 402, nonce: <Buffer 14 0b c5 31 4e e7 ef ac> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3a dd c2 b6 75 af c0 32>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 84 67 7f d8 5a 1d 9d 4d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 84 67 7f d8 5a 1d 9d 4d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.52:40760',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200442
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46760
received auth hello!
{ authId: 402, nonce: <Buffer 65 ea ba 4a 5d 5c de b6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 09 0d b8 73 d0 49 98 df>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f6 0f 8b b5 34 b0 b0 30>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f6 0f 8b b5 34 b0 b0 30> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.54:44528',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200447
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47006
received auth hello!
{ authId: 402, nonce: <Buffer 3a 9c e8 48 cb b2 df 12> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d7 db 66 ca eb f1 fa ba>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9d 31 e3 02 26 fb 3c d3>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 9d 31 e3 02 26 fb 3c d3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.52:41030',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200449
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47030
received auth hello!
{ authId: 402, nonce: <Buffer f1 f3 17 0a 49 71 3d 9b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 78 b9 26 9b 49 09 01 93>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 19 90 65 0e b5 c7 57 a5>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 19 90 65 0e b5 c7 57 a5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.54:44798',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200454
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47276
received auth hello!
{ authId: 402, nonce: <Buffer 53 d5 9d b2 20 8d 24 30> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b6 c3 0d e0 5f 69 39 f6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ab ae 70 54 d4 7b f7 8c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ab ae 70 54 d4 7b f7 8c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.52:41300',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200456
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47300
received auth hello!
{ authId: 402, nonce: <Buffer 0c aa 4b b6 82 dc 05 73> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 88 cf aa 34 f2 ce c6 c6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 61 f3 a8 df 5b f7 2f 46>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 61 f3 a8 df 5b f7 2f 46> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.54:45068',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200461
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47546
received auth hello!
{ authId: 402, nonce: <Buffer 70 86 5f 7e 6b c2 60 ef> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2e f4 3e f8 43 a5 df 1f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b2 0c 5c 1d 9b 3a bb 98>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b2 0c 5c 1d 9b 3a bb 98> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.52:41570',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200463
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47570
received auth hello!
{ authId: 402, nonce: <Buffer 3f 12 44 9c ef ac eb 51> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b9 bc 62 80 f9 b4 09 14>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 37 8b 62 51 23 29 8f 9c>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 37 8b 62 51 23 29 8f 9c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.54:45338',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200468
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47816
received auth hello!
{ authId: 402, nonce: <Buffer 40 17 85 18 4a 62 20 d8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 70 04 0a ac 5c d1 70 fa>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer af fe 27 b6 95 3a d1 ab>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer af fe 27 b6 95 3a d1 ab> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.52:41840',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200470
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47840
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
