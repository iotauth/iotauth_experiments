changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s410.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's410',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 67 49 42 41 41 4b 43 41 51 45 41 77 4c ... > }
Handler: listening on port 22100
s410:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200420
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34712
received auth hello!
{ authId: 402, nonce: <Buffer 81 e6 28 e3 49 62 43 54> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer ca eb d6 53 0e ad 92 fe>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 8f a5 3c 6e 4c 15 a4 67 69 c9 c5 67 ad 9c 3b 04>,
  macKeyVal: <Buffer 64 93 a4 09 79 aa d4 6d a3 e7 42 85 df fd 03 19 b9 7a c0 68 75 d4 a7 79 6f 8b 5c d3 74 4d cb b6>,
  absValidity: 2018-03-20T23:09:15.666Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 99 8c 41 87 20 0c f4 29>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 99 8c 41 87 20 0c f4 29> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.53:37376',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200427
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34886
received auth hello!
{ authId: 402, nonce: <Buffer b6 cd f5 b7 86 06 82 3e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 73 f9 ea 19 0c fc ef 11>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a0 0f 78 7e de e0 5d c2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a0 0f 78 7e de e0 5d c2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.53:37550',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200434
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35156
received auth hello!
{ authId: 402, nonce: <Buffer c5 5c be ce b0 4c fe c2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 25 18 aa 99 db 55 c1 f2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d2 91 80 5a 54 63 cc 51>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer d2 91 80 5a 54 63 cc 51> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.53:37820',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200441
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35426
received auth hello!
{ authId: 402, nonce: <Buffer 75 73 f8 66 c9 2b cf ae> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 38 56 be e0 7d 39 d5 fe>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e9 b0 74 32 74 2f 08 aa>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e9 b0 74 32 74 2f 08 aa> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.53:38090',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200448
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35696
received auth hello!
{ authId: 402, nonce: <Buffer b4 06 c6 b6 8a c6 f8 af> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e6 c1 17 a8 61 1e 87 12>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0c d2 36 6c c8 4f c9 c7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0c d2 36 6c c8 4f c9 c7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.53:38360',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200455
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35966
received auth hello!
{ authId: 402, nonce: <Buffer 0c 76 57 ad b4 92 48 5d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 37 eb 3b 66 68 e1 88 1d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 52 2c e2 28 ea 53 34 32>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 52 2c e2 28 ea 53 34 32> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.53:38630',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200462
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36236
received auth hello!
{ authId: 402, nonce: <Buffer 5a 57 61 cd 24 33 73 61> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 71 86 72 c2 e2 6d f2 fd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 10 02 d4 17 d1 e9 bf c3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 10 02 d4 17 d1 e9 bf c3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.53:38900',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200469
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36506
received auth hello!
{ authId: 402, nonce: <Buffer cc 30 33 3f 2c aa ca 16> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 59 c3 71 56 7e 68 1c 2d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e1 64 cf ef a0 b4 e5 f1>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e1 64 cf ef a0 b4 e5 f1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.53:39170',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
