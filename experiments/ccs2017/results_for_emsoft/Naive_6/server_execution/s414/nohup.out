changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s414.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's414',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 6e 70 ... > }
Handler: listening on port 22100
s414:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300600
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36900
received auth hello!
{ authId: 403, nonce: <Buffer 57 4e bf 4b d3 93 d8 a2> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer d7 92 f7 50 a0 11 ba de>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 3d e4 4b 13 2c 48 56 e3 dc d3 47 e8 93 18 6c b7>,
  macKeyVal: <Buffer 58 09 d4 06 e5 80 1f c6 94 4c 55 bd 25 e3 b1 98 3b 47 94 f3 eb db a3 16 1a c1 d1 df db 79 64 22>,
  absValidity: 2018-03-20T23:09:24.172Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ae 9e b5 de b1 c9 b3 01>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ae 9e b5 de b1 c9 b3 01> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.56:37706',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300606
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37092
received auth hello!
{ authId: 403, nonce: <Buffer f8 4b 64 e3 79 94 bc e7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 80 92 f1 48 03 7d b1 81>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 86 00 d4 93 1a 3f 86 3a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 86 00 d4 93 1a 3f 86 3a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.56:37898',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300612
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37362
received auth hello!
{ authId: 403, nonce: <Buffer 6a 5e 4d 55 46 ef 4c 96> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e4 6e 56 a6 86 4e e0 84>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5f 2a be d8 db b5 ce e7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5f 2a be d8 db b5 ce e7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.56:38168',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300618
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37632
received auth hello!
{ authId: 403, nonce: <Buffer 42 fe a3 17 e8 5a d0 ed> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a4 96 8e 96 ad 21 1e b9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0d 2c fb 46 e4 d3 a6 2a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0d 2c fb 46 e4 d3 a6 2a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.56:38438',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300624
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37902
received auth hello!
{ authId: 403, nonce: <Buffer db 36 9a 31 fb ff 08 f8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 51 2a 25 25 14 6f 87 0d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 96 e4 78 88 88 14 b7 9c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 96 e4 78 88 88 14 b7 9c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.56:38708',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300630
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38172
received auth hello!
{ authId: 403, nonce: <Buffer 09 13 8e 48 db c1 18 ea> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4b e4 89 e7 5d 07 df a5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d7 dd 92 5e 0e 71 e9 04>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d7 dd 92 5e 0e 71 e9 04> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.56:38978',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300636
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38442
received auth hello!
{ authId: 403, nonce: <Buffer 41 8a 0a 5f 9d 10 b9 f7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 44 a8 ea 38 93 95 85 46>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d5 03 4c 11 bd 74 0a f9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d5 03 4c 11 bd 74 0a f9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.56:39248',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300642
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38708
received auth hello!
{ authId: 403, nonce: <Buffer b1 e7 99 6f 54 80 0d 99> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 11 08 01 50 da f6 14 85>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 84 54 b4 ad 0d 66 fa 6d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 84 54 b4 ad 0d 66 fa 6d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.56:39514',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
