changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s511.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's511',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 76 6e ... > }
Handler: listening on port 22100
s511:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201347
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59682
received auth hello!
{ authId: 502, nonce: <Buffer fe f2 4c 28 a9 0e b8 25> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 31 ab ac 4e a1 dd aa 98>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 2e 24 57 b0 6b 42 6c 66 68 26 93 10 70 40 49 86>,
  macKeyVal: <Buffer 5d 99 79 fa 2b 2e fd 36 ad 9f 68 d8 8d f8 e1 f0 10 71 53 28 f9 a2 b9 16 66 72 06 30 fd ec de fc>,
  absValidity: 2018-03-20T23:10:31.011Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f7 4f e7 05 4c fb ac 1b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f7 4f e7 05 4c fb ac 1b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.76:43734',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201354
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59952
received auth hello!
{ authId: 502, nonce: <Buffer 3b e6 89 73 f3 73 b9 89> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1d 7b 94 dd 7f 92 41 a4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c2 a4 66 e4 21 6d 8b 63>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c2 a4 66 e4 21 6d 8b 63> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.76:44004',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201361
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60222
received auth hello!
{ authId: 502, nonce: <Buffer ea b0 5c b5 1a 10 ca 0b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bf ab 45 b3 2a ee 0a 32>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d2 98 b8 be 33 d2 b3 7e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d2 98 b8 be 33 d2 b3 7e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.76:44274',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201368
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60492
received auth hello!
{ authId: 502, nonce: <Buffer fe 53 80 40 03 7f d2 f7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 58 28 15 d7 6d 53 91 f8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 66 3c 7c b2 d4 e0 18 06>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 66 3c 7c b2 d4 e0 18 06> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.76:44544',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201375
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60762
received auth hello!
{ authId: 502, nonce: <Buffer cc 95 6e 86 41 c5 b2 6d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e9 cc 74 fe cd 19 d1 bc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c2 46 a0 53 14 a6 72 f7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c2 46 a0 53 14 a6 72 f7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.76:44814',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201382
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 32800
received auth hello!
{ authId: 502, nonce: <Buffer d7 76 50 b9 54 31 f4 80> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer eb ee ce 4a 10 41 cd b3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1f 8e 1e f1 c0 c2 93 3c>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 1f 8e 1e f1 c0 c2 93 3c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.76:45084',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201389
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33066
received auth hello!
{ authId: 502, nonce: <Buffer ef 93 71 29 96 a5 4f 36> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8f 13 c0 df 58 56 10 c0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 42 ea 58 d0 69 3a 26 b6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 42 ea 58 d0 69 3a 26 b6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.76:45350',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201396
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33240
received auth hello!
{ authId: 502, nonce: <Buffer 24 fa 27 1d 22 87 72 d9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 09 25 b7 2d 11 e0 b0 14>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5f d9 3e f4 f4 87 8b fb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5f d9 3e f4 f4 87 8b fb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.76:45524',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201402
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33410
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 9a 2d 9c a8 a0 10 c5 69> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 35 b1 23 d1 9d bd 92 72>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2a 68 e9 93 40 41 64 02>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 2a 68 e9 93 40 41 64 02> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.76:45694',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201412
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33658
received auth hello!
{ authId: 502, nonce: <Buffer 6a f3 30 cb e4 80 98 75> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d0 54 45 3e 6f 00 87 6f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f7 2e f0 b0 b5 f2 cb a7>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f7 2e f0 b0 b5 f2 cb a7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.76:45938',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201419
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33798
received auth hello!
{ authId: 502, nonce: <Buffer 89 78 ef ac 86 b5 7b 91> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c9 da 27 c4 77 ff c5 de>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e7 3a 52 95 f4 2c 02 70>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e7 3a 52 95 f4 2c 02 70> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.76:46080',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201435
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34016
received auth hello!
{ authId: 502, nonce: <Buffer 48 90 d0 73 86 19 63 00> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4c a1 8d 79 95 ed 75 5c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 92 2d 6c b8 ef 35 70 ce>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 92 2d 6c b8 ef 35 70 ce> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.76:46298',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201478
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34644
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer d4 16 39 83 75 d3 8b 7c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 34 d2 1f ed 0a 96 c0 39>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c4 b0 a2 23 e8 a1 30 bb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c4 b0 a2 23 e8 a1 30 bb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.76:46928',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201489
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34802
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201502
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34952
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201519
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35128
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201638
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36484
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201654
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36648
received auth hello!
{ authId: 502, nonce: <Buffer 41 60 86 1b 0c c7 ba ac> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 70 be cd cc d2 5c 74 e6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 16 f2 44 1f f4 8b 27 a5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 16 f2 44 1f f4 8b 27 a5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.76:48932',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
received auth hello!
{ authId: 502, nonce: <Buffer 91 68 af f1 2b 19 13 b4> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: write after end
