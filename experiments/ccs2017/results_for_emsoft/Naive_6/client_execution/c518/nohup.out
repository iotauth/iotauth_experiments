changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c518.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c518',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 77 45 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521583839274
connected to auth! from local port 48644
received auth hello!
{ authId: 503, nonce: <Buffer 3d dc 43 cb 1f cb 26 39> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 7d cf 2a c7 d4 19 a4 e0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 06 d5 ec ee 36 5e 7f 61 90 00 c9 2e c1 a3 08 69>,
  macKeyVal: <Buffer 95 1c 5b 1b 4a 9c 80 f5 aa e0 aa 2c 18 10 92 98 5d 51 cc ed bc 9d 1b 0d de 98 ac 88 3e e9 b4 43>,
  absValidity: 2018-03-20T23:10:39.484Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300590,
  cipherKeyVal: <Buffer 84 cc 14 54 46 f6 22 4e 3e cf a1 7e 0f e7 f1 ab>,
  macKeyVal: <Buffer c2 ea 4b fa 57 7d 1a f1 e2 3b fe 5b 13 cd 80 95 5f 7c a3 4a 0f 94 ab 7e c2 47 87 14 74 8e 30 5b>,
  absValidity: 2018-03-21T22:10:39.481Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.36',
  serverPort: 22100,
  sessionKey: 
   { id: 50300590,
     cipherKeyVal: <Buffer 84 cc 14 54 46 f6 22 4e 3e cf a1 7e 0f e7 f1 ab>,
     macKeyVal: <Buffer c2 ea 4b fa 57 7d 1a f1 e2 3b fe 5b 13 cd 80 95 5f 7c a3 4a 0f 94 ab 7e c2 47 87 14 74 8e 30 5b>,
     absValidity: 2018-03-21T22:10:39.481Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer ca 35 cd b5 d0 42 78 c4>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:10:41 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521583841499
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521583899330
connected to auth! from local port 48914
received auth hello!
{ authId: 503, nonce: <Buffer 44 6d 0e c0 61 0d 38 c3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 40 70 ae 21 78 12 7c 1a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300595,
  cipherKeyVal: <Buffer 6f fb f5 8b 83 76 bd ee 4c 88 17 17 69 a6 5e 3c>,
  macKeyVal: <Buffer 88 07 a4 2b a6 8d e9 a6 48 a6 88 5b 56 e1 4a 86 15 7c 77 ac 2b 00 ec ac c7 4b eb f1 15 6b e3 73>,
  absValidity: 2018-03-21T22:11:39.524Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.36',
  serverPort: 22100,
  sessionKey: 
   { id: 50300595,
     cipherKeyVal: <Buffer 6f fb f5 8b 83 76 bd ee 4c 88 17 17 69 a6 5e 3c>,
     macKeyVal: <Buffer 88 07 a4 2b a6 8d e9 a6 48 a6 88 5b 56 e1 4a 86 15 7c 77 ac 2b 00 ec ac c7 4b eb f1 15 6b e3 73>,
     absValidity: 2018-03-21T22:11:39.524Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 2e 44 7e 46 7f 5d a8 7b>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:11:41 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521583901498
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521583959385
connected to auth! from local port 49184
received auth hello!
{ authId: 503, nonce: <Buffer af 38 a5 66 16 67 eb 6d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c3 4a 4c 41 e5 20 44 74>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300600,
  cipherKeyVal: <Buffer f5 9a ab 16 ac 3d 93 34 f3 06 e6 17 45 ed 2e 79>,
  macKeyVal: <Buffer 4e fb fa 82 11 68 b8 21 d4 e7 86 be 91 cc 4b 0e 99 8b 07 aa 88 7a 35 84 55 6d 6c 4c 85 cd 1e fa>,
  absValidity: 2018-03-21T22:12:39.535Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.36',
  serverPort: 22100,
  sessionKey: 
   { id: 50300600,
     cipherKeyVal: <Buffer f5 9a ab 16 ac 3d 93 34 f3 06 e6 17 45 ed 2e 79>,
     macKeyVal: <Buffer 4e fb fa 82 11 68 b8 21 d4 e7 86 be 91 cc 4b 0e 99 8b 07 aa 88 7a 35 84 55 6d 6c 4c 85 cd 1e fa>,
     absValidity: 2018-03-21T22:12:39.535Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 70 f0 83 25 c3 89 c7 4c>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:12:41 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521583961496
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521584019441
connected to auth! from local port 49454
received auth hello!
{ authId: 503, nonce: <Buffer 3b 1a 28 ef d7 af 81 3a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 14 77 1c 05 6b 11 c4 78>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300605,
  cipherKeyVal: <Buffer ae 17 c0 ce e6 25 87 fb 5c 61 57 e7 bb ce 92 a5>,
  macKeyVal: <Buffer df cd eb ff 66 24 0e 8a 18 3d 87 44 f0 24 f8 ce 82 e9 0b bb 99 01 72 28 90 55 f0 6f db 4a 7d ae>,
  absValidity: 2018-03-21T22:13:39.618Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.36',
  serverPort: 22100,
  sessionKey: 
   { id: 50300605,
     cipherKeyVal: <Buffer ae 17 c0 ce e6 25 87 fb 5c 61 57 e7 bb ce 92 a5>,
     macKeyVal: <Buffer df cd eb ff 66 24 0e 8a 18 3d 87 44 f0 24 f8 ce 82 e9 0b bb 99 01 72 28 90 55 f0 6f db 4a 7d ae>,
     absValidity: 2018-03-21T22:13:39.618Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 0d 32 99 db a6 92 34 70>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:13:41 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521584021545
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521584079500
connected to auth! from local port 49724
received auth hello!
{ authId: 503, nonce: <Buffer 74 f4 4b 6f bd 51 25 e1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1a 4a 5a ea 27 3a fd 45>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300610,
  cipherKeyVal: <Buffer 66 37 8d d1 e1 8d c0 72 27 fe df c6 d8 cf 64 b0>,
  macKeyVal: <Buffer a9 ba e3 b8 bf 42 85 b5 3e 9a 96 8b c6 55 5d 5b de 90 b9 57 b3 50 a9 ed 70 96 3b df b6 73 3f e0>,
  absValidity: 2018-03-21T22:14:39.707Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.36',
  serverPort: 22100,
  sessionKey: 
   { id: 50300610,
     cipherKeyVal: <Buffer 66 37 8d d1 e1 8d c0 72 27 fe df c6 d8 cf 64 b0>,
     macKeyVal: <Buffer a9 ba e3 b8 bf 42 85 b5 3e 9a 96 8b c6 55 5d 5b de 90 b9 57 b3 50 a9 ed 70 96 3b df b6 73 3f e0>,
     absValidity: 2018-03-21T22:14:39.707Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer df 7a 68 4a 55 bb 30 3f>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:14:41 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521584081569
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521584139554
connected to auth! from local port 49994
received auth hello!
{ authId: 503, nonce: <Buffer 88 6c 6e 2f dc f4 e3 02> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 96 71 10 7d 44 8d 96 3a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300615,
  cipherKeyVal: <Buffer 33 68 86 34 36 01 c9 fb 30 81 ea 66 2e 0a 00 1d>,
  macKeyVal: <Buffer ec 0a ef 99 51 df ba 50 42 38 94 bd 10 1c 87 8a 38 c2 db 13 c1 5a 37 ef d7 c0 fe 6a 7b 77 30 d2>,
  absValidity: 2018-03-21T22:15:39.757Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.36',
  serverPort: 22100,
  sessionKey: 
   { id: 50300615,
     cipherKeyVal: <Buffer 33 68 86 34 36 01 c9 fb 30 81 ea 66 2e 0a 00 1d>,
     macKeyVal: <Buffer ec 0a ef 99 51 df ba 50 42 38 94 bd 10 1c 87 8a 38 c2 db 13 c1 5a 37 ef d7 c0 fe 6a 7b 77 30 d2>,
     absValidity: 2018-03-21T22:15:39.757Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 04 e3 e3 92 36 d0 88 fd>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:15:41 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521584141582
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521584199596
connected to auth! from local port 50260
received auth hello!
{ authId: 503, nonce: <Buffer ce 6b 83 fe d2 55 39 93> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7f 5e 48 7b 50 24 36 ce>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300620,
  cipherKeyVal: <Buffer 4d 57 23 4b da 48 4a 5b 45 d4 de 2d 7f 00 d2 4c>,
  macKeyVal: <Buffer 37 2a 0e d1 f4 21 97 51 8c cf 71 72 71 dc 18 a2 e1 d8 d4 70 d0 8b 68 45 5d 4e 97 58 a6 71 aa be>,
  absValidity: 2018-03-21T22:16:39.810Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.36',
  serverPort: 22100,
  sessionKey: 
   { id: 50300620,
     cipherKeyVal: <Buffer 4d 57 23 4b da 48 4a 5b 45 d4 de 2d 7f 00 d2 4c>,
     macKeyVal: <Buffer 37 2a 0e d1 f4 21 97 51 8c cf 71 72 71 dc 18 a2 e1 d8 d4 70 d0 8b 68 45 5d 4e 97 58 a6 71 aa be>,
     absValidity: 2018-03-21T22:16:39.810Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 41 5f 29 3b 7a b2 64 7c>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:16:41 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521584201745
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521584259655
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 9 0.7777777777777778 1521584319665
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 10 0.7 1521584379673
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
connected to auth! from local port 43980
received auth hello!
{ authId: 502, nonce: <Buffer 3b 72 cd e1 24 b5 67 dc> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth503',
     commonName: '10.0.0.6' },
  serial: '016245740A71',
  notBefore: 2018-03-20T22:05:55.000Z,
  notAfter: 2018-03-21T22:07:35.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'FB:B5:D0:57:BD:9C:24:19:35:75:88:B6:A5:1B:43:DF:72:56:9E:E2',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'E40B9EF20959AA49D02016EC2E9896074EE0818689EAD7319ECC8ED8C9557412ED46C95E67464598F6233ECEB8BF25A876F0D30B65CED2B1FED8D1F07CF9042FD7F86E3B637BE17FBFD7C9F0DB5850835170B354A52C175B769A37BA578F965436FF29BCFD54C5D4E939E02214503C8A69FFBBF0EC06657DF9498BE98DEB26B62E1453817F6DFAE9B50EE21C5A643FF0292539838A682562303CB77FC6028B22B30B78957E4F78E539103F991928681EBF3100D31960F43F8ECFC6C2F3063B353E92BFFEF77A49BBCBF417864AE8169AA061F590E5FB3393A4592EFA1100FC186B95B83724CA0B11D8BC02BC9BD4F9E08552DE2D1EB0EE0E866E41A520730E6F',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJFdApxMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDMxETAPBgNVBAMMCDEwLjAuMC42MB4XDTE4MDMy\nMDIyMDU1NVoXDTE4MDMyMTIyMDczNVowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDkC57yCVmqSdAgFuwumJYHTuCBhonq1zGezI7YyVV0Eu1GyV5n\nRkWY9iM+zri/Jah28NMLZc7Ssf7Y0fB8+QQv1/huO2N74X+/18nw21hQg1Fws1Sl\nLBdbdpo3ulePllQ2/ym8/VTF1Ok54CIUUDyKaf+78OwGZX35SYvpjesmti4UU4F/\nbfrptQ7iHFpkP/ApJTmDimglYjA8t3/GAosiswt4lX5PeOU5ED+ZGShoHr8xANMZ\nYPQ/js/GwvMGOzU+kr/+93pJu8v0F4ZK6BaaoGH1kOX7M5OkWS76EQD8GGuVuDck\nygsR2LwCvJvU+eCFUt4tHrDuDoZuQaUgcw5vAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBACxCihvWPwrcEWB4Ctvqyh7E5S9lOOs9\nSJtW0mx6P9pbP6If7DM4n5zwZmF8vvF81SR+FcX9vjrTXlhQlaW4ScfjFWGjCaQT\nj9qr2buLRpgw1977OF4b2FBzC9R2nGtk22Z+SCSF4x3RwmZS00q9x0EegPeXNT+h\nz6yGQkURkmbr9dEKU99vmI+lVDHN+mbXDWbVITax/bF3647TVYOqLq7IfyLogYWI\nyc+j0qvy0TBpnAk1QpE40a4tULGC+OQKgX32kxzIFWKYHTZ+cWmRLD2VVMCpXZcd\nUVFLP1SunR5+d+DT30H8nshNXMXcT4Nwu0LhyxcqaoOm4bNtYAjCu3M=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 1
to: 2
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 11 0.6363636363636364 1521584439683
connected to auth! from local port 44176
received auth hello!
{ authId: 502, nonce: <Buffer 51 da 12 8b 83 c5 51 bc> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 00 b8 2f f6 ad 11 6b fd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 76 7e c3 e6 82 d2 12 ac ec 19 21 48 ae 62 67 d8>,
  macKeyVal: <Buffer 61 dd 24 76 92 c8 78 f7 06 12 b7 62 d5 e8 38 22 0a 04 26 05 fa 68 c7 52 62 e8 11 36 95 84 6d 7b>,
  absValidity: 2018-03-20T23:20:41.528Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201422,
  cipherKeyVal: <Buffer 3e d7 14 f1 1f 45 f6 cf f5 71 3e 05 78 b1 5f c6>,
  macKeyVal: <Buffer 57 1d ed 5e ea 47 32 4d f9 86 d8 00 99 95 2a 86 ea 8d 38 9a 4d dd 6c 28 d3 23 79 07 1d ba a5 e2>,
  absValidity: 2018-03-21T22:20:41.527Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.36',
  serverPort: 22100,
  sessionKey: 
   { id: 50201422,
     cipherKeyVal: <Buffer 3e d7 14 f1 1f 45 f6 cf f5 71 3e 05 78 b1 5f c6>,
     macKeyVal: <Buffer 57 1d ed 5e ea 47 32 4d f9 86 d8 00 99 95 2a 86 ea 8d 38 9a 4d dd 6c 28 d3 23 79 07 1d ba a5 e2>,
     absValidity: 2018-03-21T22:20:41.527Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer aa 4b ec b5 6a 51 ca 1e>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:20:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 11 0.7272727272727273 1521584444329
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 12 0.6666666666666666 1521584499739
connected to auth! from local port 44394
received auth hello!
{ authId: 502, nonce: <Buffer 59 29 97 0b 17 64 2d 04> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a0 20 27 53 c3 8b f0 d2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201440,
  cipherKeyVal: <Buffer 04 46 ae 35 ca e4 b6 f7 11 2f 5d be 34 6a 44 e1>,
  macKeyVal: <Buffer ec c0 2d e2 7f 89 19 5a 09 d4 a3 0c cc 88 1a c0 c9 78 33 85 76 34 1d 12 2a 0b 3d 6c b7 59 b0 cd>,
  absValidity: 2018-03-21T22:21:52.321Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.36',
  serverPort: 22100,
  sessionKey: 
   { id: 50201440,
     cipherKeyVal: <Buffer 04 46 ae 35 ca e4 b6 f7 11 2f 5d be 34 6a 44 e1>,
     macKeyVal: <Buffer ec c0 2d e2 7f 89 19 5a 09 d4 a3 0c cc 88 1a c0 c9 78 33 85 76 34 1d 12 2a 0b 3d 6c b7 59 b0 cd>,
     absValidity: 2018-03-21T22:21:52.321Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 6f c9 4c 20 79 6d 93 95>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:22:08 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 9 12 0.75 1521584528679
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 13 0.6923076923076923 1521584559769
connected to auth! from local port 44620
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 14 0.6428571428571429 1521584619780
connected to auth! from local port 44808
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 15 0.6 1521584679791
connected to auth! from local port 45014
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 16 0.5625 1521584739802
connected to auth! from local port 45166
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 17 0.5294117647058824 1521584799812
connected to auth! from local port 45316
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 18 0.5 1521584859823
connected to auth! from local port 45492
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 19 0.47368421052631576 1521584919832
connected to auth! from local port 45652
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 20 0.45 1521584979842
connected to auth! from local port 45818
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 21 0.42857142857142855 1521585039853
connected to auth! from local port 45976
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 22 0.4090909090909091 1521585099863
connected to auth! from local port 46132
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 23 0.391304347826087 1521585159872
connected to auth! from local port 46284
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 24 0.375 1521585219884
connected to auth! from local port 46418
received auth hello!
{ authId: 502, nonce: <Buffer ff a3 f1 16 7a 42 ea 3f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 82 08 63 ea 63 7b 75 b2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201604,
  cipherKeyVal: <Buffer 95 f5 84 42 ce ff d0 4f 2a c6 f8 a6 03 21 5a 92>,
  macKeyVal: <Buffer d2 b0 a0 3b 11 e3 7b fe 9b 3b 3e ad 03 be 7e 76 5b 09 8f 7f 76 ac 89 e1 5a d5 3d 8c ba d0 2d 99>,
  absValidity: 2018-03-21T22:33:51.615Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.36',
  serverPort: 22100,
  sessionKey: 
   { id: 50201604,
     cipherKeyVal: <Buffer 95 f5 84 42 ce ff d0 4f 2a c6 f8 a6 03 21 5a 92>,
     macKeyVal: <Buffer d2 b0 a0 3b 11 e3 7b fe 9b 3b 3e ad 03 be 7e 76 5b 09 8f 7f 76 ac 89 e1 5a d5 3d 8c ba d0 2d 99>,
     absValidity: 2018-03-21T22:33:51.615Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer f8 35 a2 64 2d e8 74 56>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:33:56 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 10 24 0.4166666666666667 1521585236396
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 10 25 0.4 1521585279927
connected to auth! from local port 46556
received auth hello!
{ authId: 502, nonce: <Buffer 31 ac ae 72 24 13 46 2d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c5 90 cb 16 fa dc 78 5a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201617,
  cipherKeyVal: <Buffer 77 b8 73 11 01 b6 bb 47 73 85 e3 59 9c b0 6a ae>,
  macKeyVal: <Buffer 82 e0 04 b2 bd d0 d5 7e 3d ef 99 7c 02 b5 31 84 30 c5 01 e3 c8 f6 4d 18 40 1c 3b 1c dc 47 eb c2>,
  absValidity: 2018-03-21T22:34:51.637Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.36',
  serverPort: 22100,
  sessionKey: 
   { id: 50201617,
     cipherKeyVal: <Buffer 77 b8 73 11 01 b6 bb 47 73 85 e3 59 9c b0 6a ae>,
     macKeyVal: <Buffer 82 e0 04 b2 bd d0 d5 7e 3d ef 99 7c 02 b5 31 84 30 c5 01 e3 c8 f6 4d 18 40 1c 3b 1c dc 47 eb c2>,
     absValidity: 2018-03-21T22:34:51.637Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer cb 53 f6 89 44 33 bb 8b>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:35:31 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 11 25 0.44 1521585332175
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 11 26 0.4230769230769231 1521585339935
connected to auth! from local port 46700
received auth hello!
{ authId: 502, nonce: <Buffer 91 43 dc b9 08 5a 82 d2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8c be 67 bc ff 50 83 91>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201628,
  cipherKeyVal: <Buffer dd 7a 98 9e d7 e6 e5 c4 56 73 50 b0 e9 76 cd f2>,
  macKeyVal: <Buffer 41 31 27 32 79 7d 70 a6 bc 2f 09 83 9e f4 d7 23 f4 40 3c 69 cb 64 e1 f8 a1 f4 09 2b b6 c6 23 3f>,
  absValidity: 2018-03-21T22:35:43.601Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.36',
  serverPort: 22100,
  sessionKey: 
   { id: 50201628,
     cipherKeyVal: <Buffer dd 7a 98 9e d7 e6 e5 c4 56 73 50 b0 e9 76 cd f2>,
     macKeyVal: <Buffer 41 31 27 32 79 7d 70 a6 bc 2f 09 83 9e f4 d7 23 f4 40 3c 69 cb 64 e1 f8 a1 f4 09 2b b6 c6 23 3f>,
     absValidity: 2018-03-21T22:35:43.601Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer a8 40 bc 7a 69 eb 1c 75>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:35:47 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 12 26 0.46153846153846156 1521585347978
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 12 27 0.4444444444444444 1521585399987
connected to auth! from local port 46832
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 12 28 0.42857142857142855 1521585459997
connected to auth! from local port 46984
