changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c524.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c524',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 71 67 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521583859382
connected to auth! from local port 37750
received auth hello!
{ authId: 504, nonce: <Buffer 37 d4 03 e8 a6 ac 17 06> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer bb 5b 1f 9d b1 20 5a 90>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 3f e1 7c 60 90 98 19 6b 17 6e 9b 12 0b ed a8 34>,
  macKeyVal: <Buffer c2 4b ac 37 a5 f4 39 31 30 12 e4 62 45 76 8b e2 d5 4a 88 a9 54 f2 12 55 b4 c9 a6 f0 06 db 16 ee>,
  absValidity: 2018-03-20T23:11:01.935Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400192,
  cipherKeyVal: <Buffer d7 3d b8 ac 38 2e 40 03 c3 04 96 d2 cc 77 9d 8a>,
  macKeyVal: <Buffer bb 75 93 e4 52 d1 79 2b 32 1d 8f cd ef ed 01 db e6 25 38 d2 f7 34 3f b6 41 32 85 c8 37 3b 27 48>,
  absValidity: 2018-03-21T22:11:01.935Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50400192,
     cipherKeyVal: <Buffer d7 3d b8 ac 38 2e 40 03 c3 04 96 d2 cc 77 9d 8a>,
     macKeyVal: <Buffer bb 75 93 e4 52 d1 79 2b 32 1d 8f cd ef ed 01 db e6 25 38 d2 f7 34 3f b6 41 32 85 c8 37 3b 27 48>,
     absValidity: 2018-03-21T22:11:01.935Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 4b 0d 50 ee c4 cf d0 dd>
switching to HANDSHAKE_1_SENT
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:11:05 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521583865609
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521583919421
connected to auth! from local port 38020
received auth hello!
{ authId: 504, nonce: <Buffer 84 de c3 91 60 ce 3c 73> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f9 d4 66 3b 39 62 72 18>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400198,
  cipherKeyVal: <Buffer 0f c6 7d 02 bc 39 49 38 d9 fe ac ec f6 c3 89 53>,
  macKeyVal: <Buffer 1d d2 cf 2b e5 e5 13 1d 86 3e 83 e6 84 82 b3 f0 fd ee d9 5c a6 81 16 3e 92 fa 56 8e d7 af 87 c3>,
  absValidity: 2018-03-21T22:12:01.960Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50400198,
     cipherKeyVal: <Buffer 0f c6 7d 02 bc 39 49 38 d9 fe ac ec f6 c3 89 53>,
     macKeyVal: <Buffer 1d d2 cf 2b e5 e5 13 1d 86 3e 83 e6 84 82 b3 f0 fd ee d9 5c a6 81 16 3e 92 fa 56 8e d7 af 87 c3>,
     absValidity: 2018-03-21T22:12:01.960Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer d8 62 0f 49 40 64 51 fe>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:12:05 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521583925542
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521583979473
connected to auth! from local port 38290
received auth hello!
{ authId: 504, nonce: <Buffer 38 58 f6 3f 52 47 e7 f1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c0 c8 82 3e a2 86 d1 35>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400204,
  cipherKeyVal: <Buffer 6c 97 4d 2b e1 f0 85 c7 f4 ae 35 95 27 14 e6 26>,
  macKeyVal: <Buffer 34 e9 a7 d1 87 85 24 6e 30 0a a1 7b c4 9a 73 48 fe fc 8c a8 c4 73 57 8e 85 58 59 32 16 40 1f 21>,
  absValidity: 2018-03-21T22:13:01.961Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50400204,
     cipherKeyVal: <Buffer 6c 97 4d 2b e1 f0 85 c7 f4 ae 35 95 27 14 e6 26>,
     macKeyVal: <Buffer 34 e9 a7 d1 87 85 24 6e 30 0a a1 7b c4 9a 73 48 fe fc 8c a8 c4 73 57 8e 85 58 59 32 16 40 1f 21>,
     absValidity: 2018-03-21T22:13:01.961Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer b0 5e 91 8c 73 67 51 21>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:13:05 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521583985432
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521584039528
connected to auth! from local port 38560
received auth hello!
{ authId: 504, nonce: <Buffer 3f e2 63 1b 02 37 6e 1d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 89 b5 c2 30 7a 35 d6 db>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400210,
  cipherKeyVal: <Buffer 7a fc cf 27 7c 3d a8 31 1f fb 1a 15 74 5b 35 09>,
  macKeyVal: <Buffer 9b cc c9 18 fb 26 e6 1d fe 81 8b ea 7a ff 4d b2 b6 37 c0 07 bc eb 1b f4 22 36 75 9c 7c db bb d6>,
  absValidity: 2018-03-21T22:14:02.009Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50400210,
     cipherKeyVal: <Buffer 7a fc cf 27 7c 3d a8 31 1f fb 1a 15 74 5b 35 09>,
     macKeyVal: <Buffer 9b cc c9 18 fb 26 e6 1d fe 81 8b ea 7a ff 4d b2 b6 37 c0 07 bc eb 1b f4 22 36 75 9c 7c db bb d6>,
     absValidity: 2018-03-21T22:14:02.009Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 45 59 ef 71 90 0c 04 e4>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:14:05 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521584045586
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521584099558
connected to auth! from local port 38830
received auth hello!
{ authId: 504, nonce: <Buffer 6d 47 f6 8a f7 90 c2 6f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4f 2b ac 44 c9 6a 14 1a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400216,
  cipherKeyVal: <Buffer 41 a6 cf d3 79 86 6e bb 60 11 01 36 1a 78 97 c7>,
  macKeyVal: <Buffer 4e 0b 35 58 c3 34 c2 a0 22 e9 e5 fc bf e9 3b f8 a1 9d 79 77 1f 5e a3 a3 02 f6 0d 57 ff 45 22 85>,
  absValidity: 2018-03-21T22:15:02.071Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50400216,
     cipherKeyVal: <Buffer 41 a6 cf d3 79 86 6e bb 60 11 01 36 1a 78 97 c7>,
     macKeyVal: <Buffer 4e 0b 35 58 c3 34 c2 a0 22 e9 e5 fc bf e9 3b f8 a1 9d 79 77 1f 5e a3 a3 02 f6 0d 57 ff 45 22 85>,
     absValidity: 2018-03-21T22:15:02.071Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 6e 56 e7 0d ea 29 8d ab>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:15:05 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521584105707
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521584159610
connected to auth! from local port 39100
received auth hello!
{ authId: 504, nonce: <Buffer ca 08 f8 ba ce cc aa 03> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d3 2f 0f 64 46 c0 9e 71>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400222,
  cipherKeyVal: <Buffer b7 79 a0 0c 63 04 ba 39 15 16 a7 89 75 e5 d4 ee>,
  macKeyVal: <Buffer 43 3a c0 d5 6c dd a9 76 4e 8c 41 31 cc ec 63 5f 80 5d 8e 45 73 4d 6c ef 73 f1 46 84 76 f6 36 1e>,
  absValidity: 2018-03-21T22:16:02.114Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50400222,
     cipherKeyVal: <Buffer b7 79 a0 0c 63 04 ba 39 15 16 a7 89 75 e5 d4 ee>,
     macKeyVal: <Buffer 43 3a c0 d5 6c dd a9 76 4e 8c 41 31 cc ec 63 5f 80 5d 8e 45 73 4d 6c ef 73 f1 46 84 76 f6 36 1e>,
     absValidity: 2018-03-21T22:16:02.114Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer b0 38 61 45 f9 5c 86 71>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:16:05 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521584165691
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521584219664
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 8 0.75 1521584279675
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.6:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 9 0.6666666666666666 1521584339683
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.3:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 10 0.6 1521584399690
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.1:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 11 0.5454545454545454 1521584459697
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 2
to: 3
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 12 0.5 1521584519705
failure in connection with Auth : authFailureCount: 6
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 3
to: 4
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 13 0.46153846153846156 1521584579712
failure in connection with Auth : authFailureCount: 7
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 4
to: 5
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 56670
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 14 0.42857142857142855 1521584639719
failure in connection with Auth : authFailureCount: 8
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 56850
received auth hello!
{ authId: 502, nonce: <Buffer 2d 9d 6f f3 7a 71 d2 60> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth504',
     commonName: '10.0.0.7' },
  serial: '016245740CB7',
  notBefore: 2018-03-20T22:05:56.000Z,
  notAfter: 2018-03-21T22:07:36.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '36:5F:CE:E1:EA:99:80:10:89:FF:F6:13:CA:5E:17:59:60:B8:38:32',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'E40B9EF20959AA49D02016EC2E9896074EE0818689EAD7319ECC8ED8C9557412ED46C95E67464598F6233ECEB8BF25A876F0D30B65CED2B1FED8D1F07CF9042FD7F86E3B637BE17FBFD7C9F0DB5850835170B354A52C175B769A37BA578F965436FF29BCFD54C5D4E939E02214503C8A69FFBBF0EC06657DF9498BE98DEB26B62E1453817F6DFAE9B50EE21C5A643FF0292539838A682562303CB77FC6028B22B30B78957E4F78E539103F991928681EBF3100D31960F43F8ECFC6C2F3063B353E92BFFEF77A49BBCBF417864AE8169AA061F590E5FB3393A4592EFA1100FC186B95B83724CA0B11D8BC02BC9BD4F9E08552DE2D1EB0EE0E866E41A520730E6F',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJFdAy3MA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDQxETAPBgNVBAMMCDEwLjAuMC43MB4XDTE4MDMy\nMDIyMDU1NloXDTE4MDMyMTIyMDczNlowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDkC57yCVmqSdAgFuwumJYHTuCBhonq1zGezI7YyVV0Eu1GyV5n\nRkWY9iM+zri/Jah28NMLZc7Ssf7Y0fB8+QQv1/huO2N74X+/18nw21hQg1Fws1Sl\nLBdbdpo3ulePllQ2/ym8/VTF1Ok54CIUUDyKaf+78OwGZX35SYvpjesmti4UU4F/\nbfrptQ7iHFpkP/ApJTmDimglYjA8t3/GAosiswt4lX5PeOU5ED+ZGShoHr8xANMZ\nYPQ/js/GwvMGOzU+kr/+93pJu8v0F4ZK6BaaoGH1kOX7M5OkWS76EQD8GGuVuDck\nygsR2LwCvJvU+eCFUt4tHrDuDoZuQaUgcw5vAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAHjpcsYdFl8Ksztl0CxHnpJb6pcspFG4\nGrTJJl3jZeEiMAUTvzLYUIFsN0fl4AjcnVY0xH6l+B8toQHSF6iCjX3CzX/SRuAC\no4iMTzsLdKxgkOo4RQIo0vIYe8g//4+m/fsidWvkgn1Meh3+AEjteyx6+tJfxFav\nZa+vaXZnBwqQo7f3NtiIlEbak72beZiG/JjFHIkrTQDNKnmzFZqaZMLY+fZLLBaV\niEsw07AQ70SJKW575LK7BnYOkojPvQfyhnuWcD6JDyDRCqXOVEriu95aej6WWwID\n2uznotgjsnnLJPTqvAkrxoloEgDyjhfNbtHjCWuhLquexyfbFJwq714=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 5
to: 6
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 15 0.4 1521584699729
connected to auth! from local port 57040
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 16 0.375 1521584759740
connected to auth! from local port 57192
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 17 0.35294117647058826 1521584819749
connected to auth! from local port 57350
received auth hello!
{ authId: 502, nonce: <Buffer f0 44 86 ce bc 5e 50 88> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 42 c9 08 92 33 90 ed 20>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 75 b7 e4 a9 e2 56 29 83 f9 4d 97 ea 27 f8 da 7d>,
  macKeyVal: <Buffer 69 b3 5b 75 60 b9 3f 02 05 2f ae b5 5f 3f 1f c9 4a 7e 01 b6 ba f3 1b c5 59 94 d8 d7 c7 1f 26 e1>,
  absValidity: 2018-03-20T23:27:19.592Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201514,
  cipherKeyVal: <Buffer 3e 89 aa b6 25 af c6 a8 f6 56 aa 6d a9 8e 3d f5>,
  macKeyVal: <Buffer 4f 02 fd 78 cc 64 ff 43 87 30 a3 75 61 56 4b 4a 51 af 9d c4 7a 13 9d eb 5d 6e 64 57 d9 0d e3 cb>,
  absValidity: 2018-03-21T22:27:19.592Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50201514,
     cipherKeyVal: <Buffer 3e 89 aa b6 25 af c6 a8 f6 56 aa 6d a9 8e 3d f5>,
     macKeyVal: <Buffer 4f 02 fd 78 cc 64 ff 43 87 30 a3 75 61 56 4b 4a 51 af 9d c4 7a 13 9d eb 5d 6e 64 57 d9 0d e3 cb>,
     absValidity: 2018-03-21T22:27:19.592Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer fa 20 2a 14 91 69 1a 97>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 18 0.3333333333333333 1521584879790
connected to auth! from local port 57512
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.41:undefined
received auth hello!
{ authId: 502, nonce: <Buffer 4c fb e0 60 c1 e6 2e 28> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 47 d3 65 05 b2 1a f0 8f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201530,
  cipherKeyVal: <Buffer 9d b2 8b f3 07 d8 9c 7f 56 34 b5 40 e0 84 d9 0b>,
  macKeyVal: <Buffer 4e 2f 13 ef 68 6c b7 32 27 59 d3 04 a1 11 24 67 ce 3d c1 7c ce 53 f8 be 58 c0 af a7 c1 d6 27 95>,
  absValidity: 2018-03-21T22:28:19.577Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50201530,
     cipherKeyVal: <Buffer 9d b2 8b f3 07 d8 9c 7f 56 34 b5 40 e0 84 d9 0b>,
     macKeyVal: <Buffer 4e 2f 13 ef 68 6c b7 32 27 59 d3 04 a1 11 24 67 ce 3d c1 7c ce 53 f8 be 58 c0 af a7 c1 d6 27 95>,
     absValidity: 2018-03-21T22:28:19.577Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 66 df e3 c1 d9 60 25 f6>
switching to HANDSHAKE_1_SENT
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 19 0.3157894736842105 1521584939831
connected to auth! from local port 57678
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.41:undefined
received auth hello!
{ authId: 502, nonce: <Buffer 4b eb a0 60 1b 14 da cd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 30 7b 0c 23 a1 59 5c ae>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201546,
  cipherKeyVal: <Buffer 4f 98 3e ed 3f 94 13 48 78 96 4a d2 75 79 f9 c3>,
  macKeyVal: <Buffer 06 bf c5 78 e0 bc 3e 28 e1 f6 d0 a1 a3 47 44 a7 91 9b b5 7b 78 d3 dd 96 48 e4 83 0a f7 e0 74 1b>,
  absValidity: 2018-03-21T22:29:15.599Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50201546,
     cipherKeyVal: <Buffer 4f 98 3e ed 3f 94 13 48 78 96 4a d2 75 79 f9 c3>,
     macKeyVal: <Buffer 06 bf c5 78 e0 bc 3e 28 e1 f6 d0 a1 a3 47 44 a7 91 9b b5 7b 78 d3 dd 96 48 e4 83 0a f7 e0 74 1b>,
     absValidity: 2018-03-21T22:29:15.599Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 6b ab e2 73 12 80 8c 14>
switching to HANDSHAKE_1_SENT
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 20 0.3 1521584999875
connected to auth! from local port 57836
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.41:undefined
received auth hello!
{ authId: 502, nonce: <Buffer 47 b6 12 e9 db 00 3d 26> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 57 df 5e 02 50 59 a6 47>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201561,
  cipherKeyVal: <Buffer 85 ef 10 42 98 c9 f4 07 70 45 90 d2 a5 9c 11 fa>,
  macKeyVal: <Buffer 40 0a 71 94 7b 93 a7 db 3c f2 21 de c8 bd 0c 0f 17 d5 64 6c af 3e 16 a4 f7 c2 4d 60 f7 d0 bd 10>,
  absValidity: 2018-03-21T22:30:15.581Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50201561,
     cipherKeyVal: <Buffer 85 ef 10 42 98 c9 f4 07 70 45 90 d2 a5 9c 11 fa>,
     macKeyVal: <Buffer 40 0a 71 94 7b 93 a7 db 3c f2 21 de c8 bd 0c 0f 17 d5 64 6c af 3e 16 a4 f7 c2 4d 60 f7 d0 bd 10>,
     absValidity: 2018-03-21T22:30:15.581Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer ed 6c 75 13 1d 60 ad d5>
switching to HANDSHAKE_1_SENT
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 21 0.2857142857142857 1521585059921
connected to auth! from local port 57990
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.41:undefined
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 22 0.2727272727272727 1521585119930
connected to auth! from local port 58146
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 23 0.2608695652173913 1521585179940
connected to auth! from local port 58296
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 24 0.25 1521585239951
connected to auth! from local port 58434
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 25 0.24 1521585299962
connected to auth! from local port 58572
received auth hello!
{ authId: 502, nonce: <Buffer a5 4e 48 43 e4 94 24 58> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 59 1a c0 f9 44 4c 86 45>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201622,
  cipherKeyVal: <Buffer 31 98 cc c8 72 92 66 6c 5d d4 df 87 39 44 78 d4>,
  macKeyVal: <Buffer 8c 6c 5e 1b c1 0e be cc 25 81 82 86 dc 71 5d 9f 7f de 2b 96 17 45 0b 69 70 ef 7d fd 9f 97 b7 08>,
  absValidity: 2018-03-21T22:35:11.821Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50201622,
     cipherKeyVal: <Buffer 31 98 cc c8 72 92 66 6c 5d d4 df 87 39 44 78 d4>,
     macKeyVal: <Buffer 8c 6c 5e 1b c1 0e be cc 25 81 82 86 dc 71 5d 9f 7f de 2b 96 17 45 0b 69 70 ef 7d fd 9f 97 b7 08>,
     absValidity: 2018-03-21T22:35:11.821Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer f3 c1 5e ec 98 1f 1b a8>
switching to HANDSHAKE_1_SENT
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:35:15 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 25 0.28 1521585316183
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 26 0.2692307692307692 1521585359963
connected to auth! from local port 58708
received auth hello!
{ authId: 502, nonce: <Buffer 16 b3 de 55 53 fc 9d 86> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b4 b3 91 87 a0 b1 cb 1d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201630,
  cipherKeyVal: <Buffer 08 04 ec a2 c2 46 a5 90 f8 8a 21 fb e7 e1 8e 6e>,
  macKeyVal: <Buffer 73 1b 4f b7 32 6e f3 97 39 96 f4 8a 30 20 9d 31 a6 0c 18 08 5b 42 39 01 cd c3 7b d0 20 73 77 45>,
  absValidity: 2018-03-21T22:36:03.822Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50201630,
     cipherKeyVal: <Buffer 08 04 ec a2 c2 46 a5 90 f8 8a 21 fb e7 e1 8e 6e>,
     macKeyVal: <Buffer 73 1b 4f b7 32 6e f3 97 39 96 f4 8a 30 20 9d 31 a6 0c 18 08 5b 42 39 01 cd c3 7b d0 20 73 77 45>,
     absValidity: 2018-03-21T22:36:03.822Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer b9 21 6a 6d 23 8a 9d 64>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:36:07 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 26 0.3076923076923077 1521585368243
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 27 0.2962962962962963 1521585420015
connected to auth! from local port 58870
received auth hello!
{ authId: 502, nonce: <Buffer 5a c0 28 42 3c 84 09 8a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 54 f7 32 23 a1 3e 9f cf>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201648,
  cipherKeyVal: <Buffer 8f 52 61 68 1f c7 73 6f c7 b4 0d ed 6e b7 c5 14>,
  macKeyVal: <Buffer 9f cb 15 75 8f 96 b8 9f 1b 3f 82 db 95 5b 42 b1 ae af 69 af ed e2 89 e1 0e 55 80 29 02 f4 21 31>,
  absValidity: 2018-03-21T22:37:03.825Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50201648,
     cipherKeyVal: <Buffer 8f 52 61 68 1f c7 73 6f c7 b4 0d ed 6e b7 c5 14>,
     macKeyVal: <Buffer 9f cb 15 75 8f 96 b8 9f 1b 3f 82 db 95 5b 42 b1 ae af 69 af ed e2 89 e1 0e 55 80 29 02 f4 21 31>,
     absValidity: 2018-03-21T22:37:03.825Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 25 31 b8 d0 2a 46 b2 8a>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:37:07 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 9 27 0.3333333333333333 1521585428208
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 28 0.32142857142857145 1521585480067
connected to auth! from local port 58992
