changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c502.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c502',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 7a 61 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521583785955
connected to auth! from local port 52212
received auth hello!
{ authId: 501, nonce: <Buffer e3 66 40 a6 b1 f3 07 e0> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 07 24 4f 9a 51 49 84 2e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 96 39 c2 eb 2a 3b 1c 87 f2 6a 40 c9 cc 29 48 a5>,
  macKeyVal: <Buffer 47 24 be 3a aa 7a 46 24 32 97 bd 5c 07 6b 69 4e 05 fd e4 69 aa ef 81 25 a9 bb d1 c3 78 5e a6 51>,
  absValidity: 2018-03-20T23:09:46.140Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100611,
  cipherKeyVal: <Buffer 8a ae e3 1a d8 db 3b 3e dd 01 d6 c6 6c 93 2a 84>,
  macKeyVal: <Buffer 7f f3 94 0c b9 1d 75 61 9e c9 5c da 89 2d 2a 74 1a dc 8f 06 d3 dc 68 b3 11 24 4d f0 f8 1a ad 28>,
  absValidity: 2018-03-21T22:09:46.139Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.25',
  serverPort: 22100,
  sessionKey: 
   { id: 50100611,
     cipherKeyVal: <Buffer 8a ae e3 1a d8 db 3b 3e dd 01 d6 c6 6c 93 2a 84>,
     macKeyVal: <Buffer 7f f3 94 0c b9 1d 75 61 9e c9 5c da 89 2d 2a 74 1a dc 8f 06 d3 dc 68 b3 11 24 4d f0 f8 1a ad 28>,
     absValidity: 2018-03-21T22:09:46.139Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 3a 87 cd 5f 71 fc 96 c4>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:09:46 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521583787096
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521583846014
connected to auth! from local port 52440
received auth hello!
{ authId: 501, nonce: <Buffer 69 7f bf ab 12 5f fc 04> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8d 3f 15 01 0b 97 34 7c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100619,
  cipherKeyVal: <Buffer 17 d4 20 ad 36 ba cc 29 e4 60 2f 37 38 fc 72 e1>,
  macKeyVal: <Buffer e3 63 50 9d 26 12 d1 72 24 90 ee 3f 6c af ab 08 9e db 6f ff ec a9 a2 6c b5 94 65 00 cc 07 1a 96>,
  absValidity: 2018-03-21T22:10:46.224Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.25',
  serverPort: 22100,
  sessionKey: 
   { id: 50100619,
     cipherKeyVal: <Buffer 17 d4 20 ad 36 ba cc 29 e4 60 2f 37 38 fc 72 e1>,
     macKeyVal: <Buffer e3 63 50 9d 26 12 d1 72 24 90 ee 3f 6c af ab 08 9e db 6f ff ec a9 a2 6c b5 94 65 00 cc 07 1a 96>,
     absValidity: 2018-03-21T22:10:46.224Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 82 f5 74 f7 f5 76 cd 8d>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:10:47 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521583847672
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521583906073
connected to auth! from local port 52710
received auth hello!
{ authId: 501, nonce: <Buffer e8 94 d6 e4 35 57 af 17> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e7 ed 58 5f f6 ca d9 07>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100627,
  cipherKeyVal: <Buffer 02 e8 e0 f9 05 4f 7e 75 37 7a 8a b5 74 00 21 a9>,
  macKeyVal: <Buffer c3 92 ce fc 87 61 73 6b 43 e3 96 e5 52 a9 92 90 ce 53 76 d1 53 fc bd 13 15 31 80 78 83 9c 67 ef>,
  absValidity: 2018-03-21T22:11:46.244Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.25',
  serverPort: 22100,
  sessionKey: 
   { id: 50100627,
     cipherKeyVal: <Buffer 02 e8 e0 f9 05 4f 7e 75 37 7a 8a b5 74 00 21 a9>,
     macKeyVal: <Buffer c3 92 ce fc 87 61 73 6b 43 e3 96 e5 52 a9 92 90 ce 53 76 d1 53 fc bd 13 15 31 80 78 83 9c 67 ef>,
     absValidity: 2018-03-21T22:11:46.244Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 2f 4e 03 a4 0a 2e fe 9c>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:11:47 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521583907633
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521583966130
connected to auth! from local port 52980
received auth hello!
{ authId: 501, nonce: <Buffer dc 90 87 43 30 e9 b7 07> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0e b5 50 8f 29 f7 d5 44>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100635,
  cipherKeyVal: <Buffer aa dc 21 1f e4 ee 42 dc 4c fe b6 79 ce 7d 7c 76>,
  macKeyVal: <Buffer c7 98 54 54 95 e7 01 84 c5 9f 7b e7 a7 6e 69 aa 01 83 88 1d c3 41 b7 f8 3e 32 9f fa 6d dc 28 62>,
  absValidity: 2018-03-21T22:12:46.325Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.25',
  serverPort: 22100,
  sessionKey: 
   { id: 50100635,
     cipherKeyVal: <Buffer aa dc 21 1f e4 ee 42 dc 4c fe b6 79 ce 7d 7c 76>,
     macKeyVal: <Buffer c7 98 54 54 95 e7 01 84 c5 9f 7b e7 a7 6e 69 aa 01 83 88 1d c3 41 b7 f8 3e 32 9f fa 6d dc 28 62>,
     absValidity: 2018-03-21T22:12:46.325Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer c6 f7 26 22 19 f7 61 20>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:12:47 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521583967652
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521584026188
connected to auth! from local port 53252
received auth hello!
{ authId: 501, nonce: <Buffer 6e df 88 43 a7 ec e6 f1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 85 96 33 73 85 13 4a 63>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100643,
  cipherKeyVal: <Buffer a1 e9 fc c5 bc 36 62 6c 6b db d9 73 0a da be b3>,
  macKeyVal: <Buffer 4e a3 83 28 17 f9 6b d9 00 28 42 49 80 3c b7 8c 7c 8e 63 21 8a c5 73 e3 15 f4 37 54 eb a5 03 f1>,
  absValidity: 2018-03-21T22:13:46.378Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.25',
  serverPort: 22100,
  sessionKey: 
   { id: 50100643,
     cipherKeyVal: <Buffer a1 e9 fc c5 bc 36 62 6c 6b db d9 73 0a da be b3>,
     macKeyVal: <Buffer 4e a3 83 28 17 f9 6b d9 00 28 42 49 80 3c b7 8c 7c 8e 63 21 8a c5 73 e3 15 f4 37 54 eb a5 03 f1>,
     absValidity: 2018-03-21T22:13:46.378Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 46 1a e3 77 e3 f3 3b bc>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:13:47 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521584027725
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521584086245
connected to auth! from local port 53522
received auth hello!
{ authId: 501, nonce: <Buffer 5d 17 1a 2c 00 e8 e0 78> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 53 13 4e 70 9f ca f2 c7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100651,
  cipherKeyVal: <Buffer c6 0f d4 b4 13 b6 72 fe 60 e0 95 53 e9 4c d0 e5>,
  macKeyVal: <Buffer f1 63 0e 45 86 32 d8 5a 82 93 f7 4e 6a c8 cd c0 79 62 3a 1e f0 ca c7 ad 79 a6 1e b7 30 b0 27 1d>,
  absValidity: 2018-03-21T22:14:46.454Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.25',
  serverPort: 22100,
  sessionKey: 
   { id: 50100651,
     cipherKeyVal: <Buffer c6 0f d4 b4 13 b6 72 fe 60 e0 95 53 e9 4c d0 e5>,
     macKeyVal: <Buffer f1 63 0e 45 86 32 d8 5a 82 93 f7 4e 6a c8 cd c0 79 62 3a 1e f0 ca c7 ad 79 a6 1e b7 30 b0 27 1d>,
     absValidity: 2018-03-21T22:14:46.454Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 7c ca b4 14 b9 ec ec 9d>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:14:47 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521584087845
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521584146301
connected to auth! from local port 53792
received auth hello!
{ authId: 501, nonce: <Buffer 4c 51 e4 a8 0f 3d 56 d2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9d d2 1a 58 11 75 88 0c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100659,
  cipherKeyVal: <Buffer b0 19 11 ae 5a e0 65 08 8a bb a5 8a 14 3b 34 60>,
  macKeyVal: <Buffer cb ce 60 2d 4f c4 83 0c b0 e3 26 c3 f1 d3 0d c1 85 20 f6 e8 b6 c3 c7 19 d8 e8 15 99 6b 1e 34 7a>,
  absValidity: 2018-03-21T22:15:46.509Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.25',
  serverPort: 22100,
  sessionKey: 
   { id: 50100659,
     cipherKeyVal: <Buffer b0 19 11 ae 5a e0 65 08 8a bb a5 8a 14 3b 34 60>,
     macKeyVal: <Buffer cb ce 60 2d 4f c4 83 0c b0 e3 26 c3 f1 d3 0d c1 85 20 f6 e8 b6 c3 c7 19 d8 e8 15 99 6b 1e 34 7a>,
     absValidity: 2018-03-21T22:15:46.509Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 82 5d 18 f4 a0 a5 80 59>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:15:47 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521584147925
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521584206326
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 9 0.7777777777777778 1521584266336
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.1:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 10 0.7 1521584326344
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 11 0.6363636363636364 1521584386352
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 47820
received auth hello!
{ authId: 502, nonce: <Buffer 98 66 31 12 51 b8 d3 6a> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '016245740808',
  notBefore: 2018-03-20T22:05:54.000Z,
  notAfter: 2018-03-21T22:07:34.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'E4:19:6D:0C:8B:16:48:A2:32:B6:94:73:F6:80:86:72:13:AA:3E:3D',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'E40B9EF20959AA49D02016EC2E9896074EE0818689EAD7319ECC8ED8C9557412ED46C95E67464598F6233ECEB8BF25A876F0D30B65CED2B1FED8D1F07CF9042FD7F86E3B637BE17FBFD7C9F0DB5850835170B354A52C175B769A37BA578F965436FF29BCFD54C5D4E939E02214503C8A69FFBBF0EC06657DF9498BE98DEB26B62E1453817F6DFAE9B50EE21C5A643FF0292539838A682562303CB77FC6028B22B30B78957E4F78E539103F991928681EBF3100D31960F43F8ECFC6C2F3063B353E92BFFEF77A49BBCBF417864AE8169AA061F590E5FB3393A4592EFA1100FC186B95B83724CA0B11D8BC02BC9BD4F9E08552DE2D1EB0EE0E866E41A520730E6F',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJFdAgIMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDMy\nMDIyMDU1NFoXDTE4MDMyMTIyMDczNFowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDkC57yCVmqSdAgFuwumJYHTuCBhonq1zGezI7YyVV0Eu1GyV5n\nRkWY9iM+zri/Jah28NMLZc7Ssf7Y0fB8+QQv1/huO2N74X+/18nw21hQg1Fws1Sl\nLBdbdpo3ulePllQ2/ym8/VTF1Ok54CIUUDyKaf+78OwGZX35SYvpjesmti4UU4F/\nbfrptQ7iHFpkP/ApJTmDimglYjA8t3/GAosiswt4lX5PeOU5ED+ZGShoHr8xANMZ\nYPQ/js/GwvMGOzU+kr/+93pJu8v0F4ZK6BaaoGH1kOX7M5OkWS76EQD8GGuVuDck\nygsR2LwCvJvU+eCFUt4tHrDuDoZuQaUgcw5vAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBABkJcVLNsxiUWt25hTnwKEx7IA6XcBdq\nQAG5AQhTIOW7Dy3BCfN8WaAdvH2bBAdeBUGoge6adhSadohUK/dBWzdfL1zKcXQ8\nt8riR0jbgml5opFtx57BaKJUWeVwvWoj4kouLbEalRJw/EuULcxV4+2A1n6Q+q3I\nqrLJBmIRounZCERGRmOwXgkQ/kIEdgSsHQmOqQ1Vs6Fc4jmsyIWkAGiGoWsdRs33\nCc+Ls/p3Qf+m6jz5zrzelh5dAsNBC1hRc3Z5O1fHDPAJ8Ak8YOWhflE+vHQKt2dt\nEAoR7vwzF2xK/1u19vbMdzwqAOiZGFvuXqg5WBgHciMzXbSKh6gYx1I=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 2
to: 3
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 12 0.5833333333333334 1521584446361
connected to auth! from local port 48016
received auth hello!
{ authId: 502, nonce: <Buffer fe 09 69 78 68 60 40 c6> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer a0 8e a0 c9 e4 22 76 07>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer d7 b8 88 a2 8b f7 3e 11 19 06 74 1d 47 d4 d5 6b>,
  macKeyVal: <Buffer 0b 66 93 77 d3 d8 28 7b 09 b1 9c 53 30 9f 5e 8f f3 06 c6 dc 82 6f e2 51 6f 77 b3 ce 4b 5f 55 87>,
  absValidity: 2018-03-20T23:20:49.542Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201424,
  cipherKeyVal: <Buffer 34 ee ec 4c c2 99 61 4a b6 8b 69 11 bf f1 eb c8>,
  macKeyVal: <Buffer 7a a3 e8 29 00 59 fd ae 0e db 8e 3b 8f 5e da 8b a0 ab 8c 1a df 67 01 53 f9 f0 80 38 30 65 d1 a1>,
  absValidity: 2018-03-21T22:20:49.542Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.25',
  serverPort: 22100,
  sessionKey: 
   { id: 50201424,
     cipherKeyVal: <Buffer 34 ee ec 4c c2 99 61 4a b6 8b 69 11 bf f1 eb c8>,
     macKeyVal: <Buffer 7a a3 e8 29 00 59 fd ae 0e db 8e 3b 8f 5e da 8b a0 ab 8c 1a df 67 01 53 f9 f0 80 38 30 65 d1 a1>,
     absValidity: 2018-03-21T22:20:49.542Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 81 81 c8 f1 36 aa cb ea>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.25:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 13 0.5384615384615384 1521584506369
connected to auth! from local port 48224
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 14 0.5 1521584566377
connected to auth! from local port 48446
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 15 0.4666666666666667 1521584626387
connected to auth! from local port 48638
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 16 0.4375 1521584686398
connected to auth! from local port 48844
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 17 0.4117647058823529 1521584746408
connected to auth! from local port 48994
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 18 0.3888888888888889 1521584806418
connected to auth! from local port 49150
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 19 0.3684210526315789 1521584866428
connected to auth! from local port 49320
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 20 0.35 1521584926438
connected to auth! from local port 49486
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 21 0.3333333333333333 1521584986448
connected to auth! from local port 49650
received auth hello!
{ authId: 502, nonce: <Buffer 87 3c 33 90 e2 37 cc 2d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 98 39 aa 12 e4 09 94 28>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201554,
  cipherKeyVal: <Buffer 2b fb 06 53 f8 bf bb 1f 21 0e f5 69 f2 85 ab 88>,
  macKeyVal: <Buffer 87 b4 18 c3 03 85 db d0 7b 66 2f 74 cb 4e 40 8f db 43 31 38 ff 4f fd a9 e5 53 22 14 d3 18 cb cb>,
  absValidity: 2018-03-21T22:29:50.089Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.25',
  serverPort: 22100,
  sessionKey: 
   { id: 50201554,
     cipherKeyVal: <Buffer 2b fb 06 53 f8 bf bb 1f 21 0e f5 69 f2 85 ab 88>,
     macKeyVal: <Buffer 87 b4 18 c3 03 85 db d0 7b 66 2f 74 cb 4e 40 8f db 43 31 38 ff 4f fd a9 e5 53 22 14 d3 18 cb cb>,
     absValidity: 2018-03-21T22:29:50.089Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 8d 95 89 98 52 e2 c5 8e>
switching to HANDSHAKE_1_SENT
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.25:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 22 0.3181818181818182 1521585046454
connected to auth! from local port 49804
received auth hello!
{ authId: 502, nonce: <Buffer 50 34 33 84 5f 60 68 5b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fa d6 a1 1e ba ba d1 92>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201568,
  cipherKeyVal: <Buffer df e5 0c 70 4e 95 b9 23 5a 85 1b 10 b0 12 91 04>,
  macKeyVal: <Buffer e0 fc f3 32 79 94 84 22 4b b3 2e 91 81 fc 18 e3 bc 54 1c b5 63 b9 fd 35 f1 e3 d1 5f 18 bd 1b b4>,
  absValidity: 2018-03-21T22:30:50.100Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.25',
  serverPort: 22100,
  sessionKey: 
   { id: 50201568,
     cipherKeyVal: <Buffer df e5 0c 70 4e 95 b9 23 5a 85 1b 10 b0 12 91 04>,
     macKeyVal: <Buffer e0 fc f3 32 79 94 84 22 4b b3 2e 91 81 fc 18 e3 bc 54 1c b5 63 b9 fd 35 f1 e3 d1 5f 18 bd 1b b4>,
     absValidity: 2018-03-21T22:30:50.100Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 4f a6 d6 e7 44 00 dd a5>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.25:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 23 0.30434782608695654 1521585106461
connected to auth! from local port 49960
received auth hello!
{ authId: 502, nonce: <Buffer f8 25 85 fc 4a 54 3a b0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 83 c1 97 35 33 37 14 65>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201582,
  cipherKeyVal: <Buffer 84 96 98 fa c7 4d 33 2d cc a5 cd 40 43 78 74 9c>,
  macKeyVal: <Buffer 99 b0 76 f5 dd 19 30 bb 10 af 12 21 9a dc 2b 30 1e db f5 44 13 0f c9 5d 43 26 eb c2 ba 85 4d 49>,
  absValidity: 2018-03-21T22:31:50.146Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.25',
  serverPort: 22100,
  sessionKey: 
   { id: 50201582,
     cipherKeyVal: <Buffer 84 96 98 fa c7 4d 33 2d cc a5 cd 40 43 78 74 9c>,
     macKeyVal: <Buffer 99 b0 76 f5 dd 19 30 bb 10 af 12 21 9a dc 2b 30 1e db f5 44 13 0f c9 5d 43 26 eb c2 ba 85 4d 49>,
     absValidity: 2018-03-21T22:31:50.146Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 12 77 fa 75 a7 a5 14 f6>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.25:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 24 0.2916666666666667 1521585166465
connected to auth! from local port 50116
received auth hello!
{ authId: 502, nonce: <Buffer 2c 20 31 74 f9 ac ea be> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 14 ed f3 48 38 e0 bf 87>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201595,
  cipherKeyVal: <Buffer 36 28 27 6b cb 65 a6 82 6a 87 45 52 75 7b 9e b8>,
  macKeyVal: <Buffer 2d e3 3f d9 4b dc 36 68 67 6c 1d be 06 41 8a 74 49 09 5b 20 b3 55 99 c0 e7 d9 b9 d3 71 d0 33 97>,
  absValidity: 2018-03-21T22:32:50.192Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.25',
  serverPort: 22100,
  sessionKey: 
   { id: 50201595,
     cipherKeyVal: <Buffer 36 28 27 6b cb 65 a6 82 6a 87 45 52 75 7b 9e b8>,
     macKeyVal: <Buffer 2d e3 3f d9 4b dc 36 68 67 6c 1d be 06 41 8a 74 49 09 5b 20 b3 55 99 c0 e7 d9 b9 d3 71 d0 33 97>,
     absValidity: 2018-03-21T22:32:50.192Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 3b 9e 31 d0 8e 76 be 63>
switching to HANDSHAKE_1_SENT
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:32:54 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 24 0.3333333333333333 1521585174469
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 25 0.32 1521585226519
connected to auth! from local port 50246
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 26 0.3076923076923077 1521585286528
connected to auth! from local port 50388
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 27 0.2962962962962963 1521585346539
connected to auth! from local port 50528
received auth hello!
{ authId: 502, nonce: <Buffer 38 ac a8 92 1d ab db 9e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 46 9b 15 89 85 53 8d 50>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201636,
  cipherKeyVal: <Buffer ca 46 96 a5 56 54 b1 8d 0a f1 81 51 27 10 7e 9e>,
  macKeyVal: <Buffer 70 e3 82 e0 97 b3 30 d4 e3 da 67 73 81 39 03 12 1c 85 5e c8 9a ec 68 43 13 09 6a 9d 3e 4d 0e be>,
  absValidity: 2018-03-21T22:36:34.327Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.25',
  serverPort: 22100,
  sessionKey: 
   { id: 50201636,
     cipherKeyVal: <Buffer ca 46 96 a5 56 54 b1 8d 0a f1 81 51 27 10 7e 9e>,
     macKeyVal: <Buffer 70 e3 82 e0 97 b3 30 d4 e3 da 67 73 81 39 03 12 1c 85 5e c8 9a ec 68 43 13 09 6a 9d 3e 4d 0e be>,
     absValidity: 2018-03-21T22:36:34.327Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 79 d3 6b 12 ea 8d d6 f4>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:36:38 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 9 27 0.3333333333333333 1521585398871
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 28 0.32142857142857145 1521585406541
connected to auth! from local port 50664
Handler: Error in secure comm - details: Auth hello timedout ...
received auth hello!
{ authId: 502, nonce: <Buffer 83 8e a0 2c ad 4b 9b 03> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: write after end
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 29 0.3103448275862069 1521585466549
connected to auth! from local port 50816
