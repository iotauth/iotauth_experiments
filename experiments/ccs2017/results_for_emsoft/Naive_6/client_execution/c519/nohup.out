changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c519.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c519',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 71 7a ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521583842677
connected to auth! from local port 38742
received auth hello!
{ authId: 503, nonce: <Buffer 19 fe bc e7 57 6d 90 a8> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer c4 69 34 72 5a d1 6a fc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer c1 4c 3f 13 ae 1d eb 45 01 2a 30 d4 d6 8c b0 80>,
  macKeyVal: <Buffer e8 a7 7c a7 32 3b 5c c7 c5 38 c8 35 cd 7b 17 9f b6 21 73 47 bd 95 b7 7d 49 cd 77 8b 02 74 d3 70>,
  absValidity: 2018-03-20T23:10:42.954Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300591,
  cipherKeyVal: <Buffer aa 1f 99 fa 3b 68 50 94 9a 95 ed 9c e8 cb f2 45>,
  macKeyVal: <Buffer c3 15 e5 06 3e 59 70 c4 ad c7 0d 36 9f db b4 10 d6 5e bf 08 42 91 62 df d1 bb 44 6c 78 1f e3 60>,
  absValidity: 2018-03-21T22:10:42.953Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.37',
  serverPort: 22100,
  sessionKey: 
   { id: 50300591,
     cipherKeyVal: <Buffer aa 1f 99 fa 3b 68 50 94 9a 95 ed 9c e8 cb f2 45>,
     macKeyVal: <Buffer c3 15 e5 06 3e 59 70 c4 ad c7 0d 36 9f db b4 10 d6 5e bf 08 42 91 62 df d1 bb 44 6c 78 1f e3 60>,
     absValidity: 2018-03-21T22:10:42.953Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 66 9d 50 0d 70 91 5f e7>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:10:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521583844532
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521583902734
connected to auth! from local port 39012
received auth hello!
{ authId: 503, nonce: <Buffer 22 a3 23 88 ab 76 51 a5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 17 a1 c7 f0 5d 49 bf 65>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300596,
  cipherKeyVal: <Buffer 9d c9 6f 30 f6 04 a2 35 eb 32 e1 e2 c9 d8 ba 4b>,
  macKeyVal: <Buffer b4 47 57 66 21 5e 60 db 59 69 d8 5c e6 51 05 fa 38 27 2c 40 b8 85 ae 79 33 51 7b 9a 57 49 86 34>,
  absValidity: 2018-03-21T22:11:42.963Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.37',
  serverPort: 22100,
  sessionKey: 
   { id: 50300596,
     cipherKeyVal: <Buffer 9d c9 6f 30 f6 04 a2 35 eb 32 e1 e2 c9 d8 ba 4b>,
     macKeyVal: <Buffer b4 47 57 66 21 5e 60 db 59 69 d8 5c e6 51 05 fa 38 27 2c 40 b8 85 ae 79 33 51 7b 9a 57 49 86 34>,
     absValidity: 2018-03-21T22:11:42.963Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 78 fc 88 a1 a0 b4 37 2c>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:11:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521583904473
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521583962793
connected to auth! from local port 39282
received auth hello!
{ authId: 503, nonce: <Buffer 25 28 d7 12 86 60 af 15> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 49 02 3a ae 47 e8 89 df>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300601,
  cipherKeyVal: <Buffer 2d 6a 5d 63 17 d5 e1 9f c5 18 4a 8b 91 bc 42 0c>,
  macKeyVal: <Buffer e5 d0 cb 13 05 ef 84 a6 ed 6b ac 3a be b0 8d 6f b2 ed eb 1c e1 65 6e 8e 6b d9 f5 4a 85 5c 21 f5>,
  absValidity: 2018-03-21T22:12:43.035Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.37',
  serverPort: 22100,
  sessionKey: 
   { id: 50300601,
     cipherKeyVal: <Buffer 2d 6a 5d 63 17 d5 e1 9f c5 18 4a 8b 91 bc 42 0c>,
     macKeyVal: <Buffer e5 d0 cb 13 05 ef 84 a6 ed 6b ac 3a be b0 8d 6f b2 ed eb 1c e1 65 6e 8e 6b d9 f5 4a 85 5c 21 f5>,
     absValidity: 2018-03-21T22:12:43.035Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 56 db 66 9c 17 ac 4d e9>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:12:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521583964511
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521584022849
connected to auth! from local port 39552
received auth hello!
{ authId: 503, nonce: <Buffer a7 41 4a 6b 7c 7f 96 4f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8d c6 c4 aa b6 75 68 fa>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300606,
  cipherKeyVal: <Buffer 9e 74 61 c8 0f 50 11 18 66 62 ce 33 b8 6f 99 6c>,
  macKeyVal: <Buffer f7 cd 58 f0 e1 b6 de cf 20 83 e4 07 06 db 96 10 92 06 ad 33 03 44 14 77 49 49 6f 85 f7 53 68 ea>,
  absValidity: 2018-03-21T22:13:43.096Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.37',
  serverPort: 22100,
  sessionKey: 
   { id: 50300606,
     cipherKeyVal: <Buffer 9e 74 61 c8 0f 50 11 18 66 62 ce 33 b8 6f 99 6c>,
     macKeyVal: <Buffer f7 cd 58 f0 e1 b6 de cf 20 83 e4 07 06 db 96 10 92 06 ad 33 03 44 14 77 49 49 6f 85 f7 53 68 ea>,
     absValidity: 2018-03-21T22:13:43.096Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 29 a3 68 da a0 db ad 8f>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:13:43 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521584024487
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521584082899
connected to auth! from local port 39822
received auth hello!
{ authId: 503, nonce: <Buffer 50 46 bd e8 32 f4 a1 b5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer da a1 66 99 9d d2 7b a4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300611,
  cipherKeyVal: <Buffer e7 93 36 1c 2e 12 74 8f 19 6a b7 59 fc a0 99 38>,
  macKeyVal: <Buffer 52 8d 05 42 bd 67 2b 34 bb 78 9f 69 da 99 89 11 63 8e 46 73 1d 61 d3 9b 7c 53 02 7b a2 e2 39 d7>,
  absValidity: 2018-03-21T22:14:43.114Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.37',
  serverPort: 22100,
  sessionKey: 
   { id: 50300611,
     cipherKeyVal: <Buffer e7 93 36 1c 2e 12 74 8f 19 6a b7 59 fc a0 99 38>,
     macKeyVal: <Buffer 52 8d 05 42 bd 67 2b 34 bb 78 9f 69 da 99 89 11 63 8e 46 73 1d 61 d3 9b 7c 53 02 7b a2 e2 39 d7>,
     absValidity: 2018-03-21T22:14:43.114Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 3a f7 1c 73 5d 36 db ac>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:14:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521584084588
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521584142949
connected to auth! from local port 40092
received auth hello!
{ authId: 503, nonce: <Buffer 4e c5 b9 df 59 b4 8c 4a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 69 c7 e0 97 13 12 75 31>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300616,
  cipherKeyVal: <Buffer 47 39 68 56 c9 59 67 ee 11 91 84 82 69 ec 52 10>,
  macKeyVal: <Buffer 31 d2 12 41 4f 00 6b dc 09 60 38 5e 58 ab 47 0c 6c 03 a6 91 30 c5 df 92 4d bc ca f5 48 f1 36 56>,
  absValidity: 2018-03-21T22:15:43.173Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.37',
  serverPort: 22100,
  sessionKey: 
   { id: 50300616,
     cipherKeyVal: <Buffer 47 39 68 56 c9 59 67 ee 11 91 84 82 69 ec 52 10>,
     macKeyVal: <Buffer 31 d2 12 41 4f 00 6b dc 09 60 38 5e 58 ab 47 0c 6c 03 a6 91 30 c5 df 92 4d bc ca f5 48 f1 36 56>,
     absValidity: 2018-03-21T22:15:43.173Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 0d 4c bb 78 40 66 4d b5>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:15:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521584144571
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521584202985
connected to auth! from local port 40358
received auth hello!
{ authId: 503, nonce: <Buffer eb 97 5a eb c0 51 67 48> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer aa b4 ec 39 bd 70 b4 58>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300621,
  cipherKeyVal: <Buffer f6 3e e3 89 ba 35 03 ae 8c c8 dd 58 ff 59 f5 98>,
  macKeyVal: <Buffer f9 06 0f ec 2e c5 f9 73 d9 e7 6b a4 8f 52 7a 8d da d3 ac 84 dc 78 46 df 54 38 97 f6 46 b8 ea 5f>,
  absValidity: 2018-03-21T22:16:43.122Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.37',
  serverPort: 22100,
  sessionKey: 
   { id: 50300621,
     cipherKeyVal: <Buffer f6 3e e3 89 ba 35 03 ae 8c c8 dd 58 ff 59 f5 98>,
     macKeyVal: <Buffer f9 06 0f ec 2e c5 f9 73 d9 e7 6b a4 8f 52 7a 8d da d3 ac 84 dc 78 46 df 54 38 97 f6 46 b8 ea 5f>,
     absValidity: 2018-03-21T22:16:43.122Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 64 da 22 46 e6 93 f6 7d>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:16:43 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521584204123
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521584263018
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 9 0.7777777777777778 1521584323028
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.3:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 10 0.7 1521584383036
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 11 0.6363636363636364 1521584443045
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
connected to auth! from local port 33998
received auth hello!
{ authId: 502, nonce: <Buffer 88 d6 e0 a7 62 ed b8 0d> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth503',
     commonName: '10.0.0.6' },
  serial: '016245740A71',
  notBefore: 2018-03-20T22:05:55.000Z,
  notAfter: 2018-03-21T22:07:35.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'FB:B5:D0:57:BD:9C:24:19:35:75:88:B6:A5:1B:43:DF:72:56:9E:E2',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'E40B9EF20959AA49D02016EC2E9896074EE0818689EAD7319ECC8ED8C9557412ED46C95E67464598F6233ECEB8BF25A876F0D30B65CED2B1FED8D1F07CF9042FD7F86E3B637BE17FBFD7C9F0DB5850835170B354A52C175B769A37BA578F965436FF29BCFD54C5D4E939E02214503C8A69FFBBF0EC06657DF9498BE98DEB26B62E1453817F6DFAE9B50EE21C5A643FF0292539838A682562303CB77FC6028B22B30B78957E4F78E539103F991928681EBF3100D31960F43F8ECFC6C2F3063B353E92BFFEF77A49BBCBF417864AE8169AA061F590E5FB3393A4592EFA1100FC186B95B83724CA0B11D8BC02BC9BD4F9E08552DE2D1EB0EE0E866E41A520730E6F',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJFdApxMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDMxETAPBgNVBAMMCDEwLjAuMC42MB4XDTE4MDMy\nMDIyMDU1NVoXDTE4MDMyMTIyMDczNVowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDkC57yCVmqSdAgFuwumJYHTuCBhonq1zGezI7YyVV0Eu1GyV5n\nRkWY9iM+zri/Jah28NMLZc7Ssf7Y0fB8+QQv1/huO2N74X+/18nw21hQg1Fws1Sl\nLBdbdpo3ulePllQ2/ym8/VTF1Ok54CIUUDyKaf+78OwGZX35SYvpjesmti4UU4F/\nbfrptQ7iHFpkP/ApJTmDimglYjA8t3/GAosiswt4lX5PeOU5ED+ZGShoHr8xANMZ\nYPQ/js/GwvMGOzU+kr/+93pJu8v0F4ZK6BaaoGH1kOX7M5OkWS76EQD8GGuVuDck\nygsR2LwCvJvU+eCFUt4tHrDuDoZuQaUgcw5vAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBACxCihvWPwrcEWB4Ctvqyh7E5S9lOOs9\nSJtW0mx6P9pbP6If7DM4n5zwZmF8vvF81SR+FcX9vjrTXlhQlaW4ScfjFWGjCaQT\nj9qr2buLRpgw1977OF4b2FBzC9R2nGtk22Z+SCSF4x3RwmZS00q9x0EegPeXNT+h\nz6yGQkURkmbr9dEKU99vmI+lVDHN+mbXDWbVITax/bF3647TVYOqLq7IfyLogYWI\nyc+j0qvy0TBpnAk1QpE40a4tULGC+OQKgX32kxzIFWKYHTZ+cWmRLD2VVMCpXZcd\nUVFLP1SunR5+d+DT30H8nshNXMXcT4Nwu0LhyxcqaoOm4bNtYAjCu3M=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 2
to: 3
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 12 0.5833333333333334 1521584503055
connected to auth! from local port 34200
received auth hello!
{ authId: 502, nonce: <Buffer 6d b4 a6 93 f7 67 7f c1> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer a1 4f 76 93 0f 0f 72 c4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer df 73 6a 34 9b f8 e9 e1 cd f0 38 d6 e2 33 57 e9>,
  macKeyVal: <Buffer 8c bd b9 07 20 14 fe 08 46 d3 05 e2 48 a1 64 6f 83 8e 65 e5 1e 64 0c 53 06 c6 3b 02 33 1a e6 40>,
  absValidity: 2018-03-20T23:21:50.842Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201439,
  cipherKeyVal: <Buffer f9 9a 2a 30 b7 47 76 82 a1 c9 51 63 b0 5c 87 da>,
  macKeyVal: <Buffer 6a 98 24 a7 9d 82 35 f1 86 6e 33 ee 4c 6f 3d ad 25 98 58 28 09 f5 06 bc 71 4a ee dd 29 db 59 26>,
  absValidity: 2018-03-21T22:21:50.842Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.37',
  serverPort: 22100,
  sessionKey: 
   { id: 50201439,
     cipherKeyVal: <Buffer f9 9a 2a 30 b7 47 76 82 a1 c9 51 63 b0 5c 87 da>,
     macKeyVal: <Buffer 6a 98 24 a7 9d 82 35 f1 86 6e 33 ee 4c 6f 3d ad 25 98 58 28 09 f5 06 bc 71 4a ee dd 29 db 59 26>,
     absValidity: 2018-03-21T22:21:50.842Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 0f 37 98 6d f9 00 16 5a>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.37:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 13 0.5384615384615384 1521584563058
connected to auth! from local port 34424
received auth hello!
{ authId: 502, nonce: <Buffer 2b dc 8a cb 43 20 24 83> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 33 bd 7b 48 f7 80 0e c4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201457,
  cipherKeyVal: <Buffer 7d fd 5d 77 86 07 4c 87 5b fd 47 55 a8 ca 07 f4>,
  macKeyVal: <Buffer 1c 99 ec c8 ab ec 52 91 15 15 ea 1e ce ee a6 a8 d3 8e a1 a1 48 fe 31 01 37 3a e1 18 48 ea 7e 12>,
  absValidity: 2018-03-21T22:22:50.841Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.37',
  serverPort: 22100,
  sessionKey: 
   { id: 50201457,
     cipherKeyVal: <Buffer 7d fd 5d 77 86 07 4c 87 5b fd 47 55 a8 ca 07 f4>,
     macKeyVal: <Buffer 1c 99 ec c8 ab ec 52 91 15 15 ea 1e ce ee a6 a8 d3 8e a1 a1 48 fe 31 01 37 3a e1 18 48 ea 7e 12>,
     absValidity: 2018-03-21T22:22:50.841Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer a6 3f 44 29 92 51 73 b9>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.37:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 14 0.5 1521584623060
connected to auth! from local port 34612
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 15 0.4666666666666667 1521584683069
connected to auth! from local port 34818
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 16 0.4375 1521584743080
connected to auth! from local port 34970
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 17 0.4117647058823529 1521584803090
connected to auth! from local port 35120
received auth hello!
{ authId: 502, nonce: <Buffer e0 24 cb 33 47 1e 02 f8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f6 6c f4 ed 01 33 dc 25>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201507,
  cipherKeyVal: <Buffer d0 75 03 8d 21 67 e3 c2 77 b3 f2 c6 45 1c 15 f2>,
  macKeyVal: <Buffer bf ce 95 46 8f cc 49 95 26 fe 33 66 59 27 ab 09 76 44 d4 dd e7 a3 7e 3a 40 c0 a4 a2 e3 f2 67 09>,
  absValidity: 2018-03-21T22:26:50.851Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.37',
  serverPort: 22100,
  sessionKey: 
   { id: 50201507,
     cipherKeyVal: <Buffer d0 75 03 8d 21 67 e3 c2 77 b3 f2 c6 45 1c 15 f2>,
     macKeyVal: <Buffer bf ce 95 46 8f cc 49 95 26 fe 33 66 59 27 ab 09 76 44 d4 dd e7 a3 7e 3a 40 c0 a4 a2 e3 f2 67 09>,
     absValidity: 2018-03-21T22:26:50.851Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer d1 cb 67 49 aa 3e 25 57>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.37:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 18 0.3888888888888889 1521584863092
connected to auth! from local port 35294
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 19 0.3684210526315789 1521584923102
connected to auth! from local port 35458
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 20 0.35 1521584983110
connected to auth! from local port 35624
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 21 0.3333333333333333 1521585043120
connected to auth! from local port 35778
Handler: Error in secure comm - details: Auth hello timedout ...
received auth hello!
{ authId: 502, nonce: <Buffer d0 be 59 bb 44 2f 3e 73> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: write after end
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 22 0.3181818181818182 1521585103125
connected to auth! from local port 35934
disconnected from auth
Handler: Error in secure comm - details: Connection with Auth timed out...
Handler: Error in secure comm - details: Auth hello timedout ...
received auth hello!
{ authId: 502, nonce: <Buffer 66 35 7f 99 9d e5 77 0b> }
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: write after end
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 23 0.30434782608695654 1521585163125
connected to auth! from local port 36090
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.4:21100
disconnected from auth
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Handler: Error in secure comm - details: Connection with Auth timed out...
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 24 0.2916666666666667 1521585223136
connected to auth! from local port 36220
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 25 0.28 1521585283146
connected to auth! from local port 36362
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 26 0.2692307692307692 1521585343156
connected to auth! from local port 36502
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 27 0.25925925925925924 1521585403165
connected to auth! from local port 36642
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 28 0.25 1521585463176
connected to auth! from local port 36794
