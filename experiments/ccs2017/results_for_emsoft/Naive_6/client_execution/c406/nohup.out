changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c406.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c406',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 67 49 42 41 41 4b 43 41 51 45 41 6f 6f ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521583737302
connected to auth! from local port 35858
received auth hello!
{ authId: 401, nonce: <Buffer 2c cc 8b 4e 0b 9e 7d e7> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 76 c5 09 43 57 ad b0 e5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer b4 a9 92 03 9a 9e 31 0e ea 7d c6 c0 6e 0f c7 df>,
  macKeyVal: <Buffer 17 d3 1b 8d c3 0d 52 0a d5 fb 29 a5 1f 98 ff c1 2a 9b 5b df c5 bc 80 b7 0b 52 c6 51 f3 39 9a 9f>,
  absValidity: 2018-03-20T23:08:57.475Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101304,
  cipherKeyVal: <Buffer 1c 84 3a cb fc d6 06 48 9c c1 3e 16 91 16 ac c1>,
  macKeyVal: <Buffer bd e9 3e 1d 6f 9f 74 87 a3 32 d1 b3 7a ee 31 b7 32 22 24 75 90 44 5e f7 39 b5 84 76 7c f3 27 8c>,
  absValidity: 2018-03-21T22:08:57.475Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.11',
  serverPort: 22100,
  sessionKey: 
   { id: 40101304,
     cipherKeyVal: <Buffer 1c 84 3a cb fc d6 06 48 9c c1 3e 16 91 16 ac c1>,
     macKeyVal: <Buffer bd e9 3e 1d 6f 9f 74 87 a3 32 d1 b3 7a ee 31 b7 32 22 24 75 90 44 5e f7 39 b5 84 76 7c f3 27 8c>,
     absValidity: 2018-03-21T22:08:57.475Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 67 2c 24 08 57 48 6f e3>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:08:58 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521583738806
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521583797335
connected to auth! from local port 36002
received auth hello!
{ authId: 401, nonce: <Buffer e4 39 ab 3b 17 9f e4 6c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 82 1b bd f1 b1 a1 1e 56>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101310,
  cipherKeyVal: <Buffer 3c 83 44 a3 23 c7 12 f1 4a e1 3c 8d 10 8d 82 ca>,
  macKeyVal: <Buffer cb 80 c0 d1 9a b1 ea b0 b0 24 d5 63 e9 65 02 e7 7a 25 15 03 4e 95 9b 6c 70 b1 3d a0 24 7e 74 23>,
  absValidity: 2018-03-21T22:09:57.483Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.11',
  serverPort: 22100,
  sessionKey: 
   { id: 40101310,
     cipherKeyVal: <Buffer 3c 83 44 a3 23 c7 12 f1 4a e1 3c 8d 10 8d 82 ca>,
     macKeyVal: <Buffer cb 80 c0 d1 9a b1 ea b0 b0 24 d5 63 e9 65 02 e7 7a 25 15 03 4e 95 9b 6c 70 b1 3d a0 24 7e 74 23>,
     absValidity: 2018-03-21T22:09:57.483Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer ae 40 ad 55 e5 64 59 4e>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:09:58 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521583798773
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521583857395
connected to auth! from local port 36254
received auth hello!
{ authId: 401, nonce: <Buffer 2b 4b 24 70 56 ff 11 ac> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c1 65 ef 76 40 8c 75 8b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101316,
  cipherKeyVal: <Buffer 1a c0 17 a9 35 f0 7d 62 5d a1 c8 b8 bf 1c 32 cc>,
  macKeyVal: <Buffer 69 b5 dd 96 f9 f8 21 fb f6 b2 6e 11 9c 0f e9 b6 76 90 91 81 bb a8 79 93 39 61 b8 85 ad fc a5 90>,
  absValidity: 2018-03-21T22:10:57.556Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.11',
  serverPort: 22100,
  sessionKey: 
   { id: 40101316,
     cipherKeyVal: <Buffer 1a c0 17 a9 35 f0 7d 62 5d a1 c8 b8 bf 1c 32 cc>,
     macKeyVal: <Buffer 69 b5 dd 96 f9 f8 21 fb f6 b2 6e 11 9c 0f e9 b6 76 90 91 81 bb a8 79 93 39 61 b8 85 ad fc a5 90>,
     absValidity: 2018-03-21T22:10:57.556Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 75 5f cc 6a 20 db 27 f3>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:10:58 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521583859025
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521583917449
connected to auth! from local port 36524
received auth hello!
{ authId: 401, nonce: <Buffer 0c 62 44 47 6c ac 85 0b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 35 79 76 b8 29 41 69 67>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101322,
  cipherKeyVal: <Buffer 6e 8c ba 68 f5 a6 37 a2 d2 2b c9 b1 ab b3 82 00>,
  macKeyVal: <Buffer a6 16 30 df 0e 91 a1 36 41 72 00 04 ac 7d ce 6f 30 93 87 8f f9 49 3a aa c9 6a e6 aa 4f 39 3a 55>,
  absValidity: 2018-03-21T22:11:57.622Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.11',
  serverPort: 22100,
  sessionKey: 
   { id: 40101322,
     cipherKeyVal: <Buffer 6e 8c ba 68 f5 a6 37 a2 d2 2b c9 b1 ab b3 82 00>,
     macKeyVal: <Buffer a6 16 30 df 0e 91 a1 36 41 72 00 04 ac 7d ce 6f 30 93 87 8f f9 49 3a aa c9 6a e6 aa 4f 39 3a 55>,
     absValidity: 2018-03-21T22:11:57.622Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer e6 87 de 9b be 94 06 1a>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:11:58 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521583919087
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521583977505
connected to auth! from local port 36794
received auth hello!
{ authId: 401, nonce: <Buffer e4 05 e0 66 b4 72 22 13> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 58 27 89 79 72 03 5a ab>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101328,
  cipherKeyVal: <Buffer 72 9e 38 b2 f5 c7 fd 02 1a 94 7c 33 03 d1 11 b0>,
  macKeyVal: <Buffer 18 cc 74 9b 41 56 e8 74 20 e1 1d 1a 53 4d 90 fc 8b d8 9a 23 7e 59 0f 12 92 bc 53 14 22 72 73 cb>,
  absValidity: 2018-03-21T22:12:57.630Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.11',
  serverPort: 22100,
  sessionKey: 
   { id: 40101328,
     cipherKeyVal: <Buffer 72 9e 38 b2 f5 c7 fd 02 1a 94 7c 33 03 d1 11 b0>,
     macKeyVal: <Buffer 18 cc 74 9b 41 56 e8 74 20 e1 1d 1a 53 4d 90 fc 8b d8 9a 23 7e 59 0f 12 92 bc 53 14 22 72 73 cb>,
     absValidity: 2018-03-21T22:12:57.630Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer a2 db 50 d3 ba 1e 44 16>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:12:58 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521583979132
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521584037564
connected to auth! from local port 37064
received auth hello!
{ authId: 401, nonce: <Buffer b9 b0 56 df b8 b2 0a c0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5f c7 4a 9f 32 11 bf a9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101334,
  cipherKeyVal: <Buffer de db a8 21 42 f3 32 50 1f 6c cc 8a 86 6d 55 7a>,
  macKeyVal: <Buffer 3c 4a e2 ae 29 b3 94 05 d4 30 2f ee b3 d4 70 f0 79 9c 32 19 7b a3 90 4f ac 65 90 b4 4c 6e 4d c4>,
  absValidity: 2018-03-21T22:13:57.708Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.11',
  serverPort: 22100,
  sessionKey: 
   { id: 40101334,
     cipherKeyVal: <Buffer de db a8 21 42 f3 32 50 1f 6c cc 8a 86 6d 55 7a>,
     macKeyVal: <Buffer 3c 4a e2 ae 29 b3 94 05 d4 30 2f ee b3 d4 70 f0 79 9c 32 19 7b a3 90 4f ac 65 90 b4 4c 6e 4d c4>,
     absValidity: 2018-03-21T22:13:57.708Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 30 cf 3d a9 ed bc 9f 3e>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:13:58 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521584039165
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521584097585
connected to auth! from local port 37334
received auth hello!
{ authId: 401, nonce: <Buffer f3 a2 bb fb ee 69 40 99> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 93 4c b6 7a f5 2e f4 9b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101340,
  cipherKeyVal: <Buffer 16 67 fb f5 7a bb df ad 0e 84 ab 38 c0 35 33 bd>,
  macKeyVal: <Buffer 49 fa f2 07 b4 89 cd 2b 1c 3b 77 9c 5c 2e 2b 51 0d db 29 18 7d e2 b2 3e 3b 99 c4 6b 55 e9 c6 51>,
  absValidity: 2018-03-21T22:14:57.732Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.11',
  serverPort: 22100,
  sessionKey: 
   { id: 40101340,
     cipherKeyVal: <Buffer 16 67 fb f5 7a bb df ad 0e 84 ab 38 c0 35 33 bd>,
     macKeyVal: <Buffer 49 fa f2 07 b4 89 cd 2b 1c 3b 77 9c 5c 2e 2b 51 0d db 29 18 7d e2 b2 3e 3b 99 c4 6b 55 e9 c6 51>,
     absValidity: 2018-03-21T22:14:57.732Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 7c f5 d6 cb c7 a5 3a e2>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:14:58 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521584099325
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521584157610
connected to auth! from local port 37604
received auth hello!
{ authId: 401, nonce: <Buffer 5d df ae 3c 63 d1 aa 09> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bc 1f 59 c6 a7 ac d4 c8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101346,
  cipherKeyVal: <Buffer f8 ec 68 ba 35 b2 d9 b9 d1 d6 bf 6a 49 01 2b 93>,
  macKeyVal: <Buffer 56 51 eb c0 9e 23 2d ab 51 da e5 1e 0f ca 6f 52 85 b7 f3 3c 35 28 fb 12 7e e2 d9 21 ed 36 41 b0>,
  absValidity: 2018-03-21T22:15:57.733Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.11',
  serverPort: 22100,
  sessionKey: 
   { id: 40101346,
     cipherKeyVal: <Buffer f8 ec 68 ba 35 b2 d9 b9 d1 d6 bf 6a 49 01 2b 93>,
     macKeyVal: <Buffer 56 51 eb c0 9e 23 2d ab 51 da e5 1e 0f ca 6f 52 85 b7 f3 3c 35 28 fb 12 7e e2 d9 21 ed 36 41 b0>,
     absValidity: 2018-03-21T22:15:57.733Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 2a 4f 53 56 41 5b 46 ac>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:15:58 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 8 1 1521584159283
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 9 0.8888888888888888 1521584217668
connected to auth! from local port 37842
received auth hello!
{ authId: 401, nonce: <Buffer 31 67 c3 9d 39 cc af 47> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 68 d8 4d 53 fb 31 5e d8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101352,
  cipherKeyVal: <Buffer 35 fb c0 44 08 8a c1 90 cc 1f 7c 38 79 bf 40 30>,
  macKeyVal: <Buffer 02 c4 d8 82 15 2e c1 60 1a 0f e5 3b bc 48 72 92 05 b4 2f 82 ca fa 4a 31 49 57 f2 2f ef 44 66 b6>,
  absValidity: 2018-03-21T22:16:57.800Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.11',
  serverPort: 22100,
  sessionKey: 
   { id: 40101352,
     cipherKeyVal: <Buffer 35 fb c0 44 08 8a c1 90 cc 1f 7c 38 79 bf 40 30>,
     macKeyVal: <Buffer 02 c4 d8 82 15 2e c1 60 1a 0f e5 3b bc 48 72 92 05 b4 2f 82 ca fa 4a 31 49 57 f2 2f ef 44 66 b6>,
     absValidity: 2018-03-21T22:16:57.800Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer ef ae 7b 71 25 f7 fc c2>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:16:58 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 9 9 1 1521584219160
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 10 0.9 1521584277727
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.1:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 11 0.8181818181818182 1521584337737
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.1:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 12 0.75 1521584397745
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.1:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 13 0.6923076923076923 1521584457749
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.1:21100
connected to auth! from local port 37676
received auth hello!
{ authId: 502, nonce: <Buffer 9d 9d e9 a4 33 f5 cf 43> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth401',
     commonName: '10.0.0.1' },
  serial: '0162457401A2',
  notBefore: 2018-03-20T22:05:53.000Z,
  notAfter: 2018-03-21T22:07:33.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '0B:97:D5:ED:39:1B:E5:E0:95:C9:31:E4:BC:B1:7B:18:89:B1:33:C1',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'E40B9EF20959AA49D02016EC2E9896074EE0818689EAD7319ECC8ED8C9557412ED46C95E67464598F6233ECEB8BF25A876F0D30B65CED2B1FED8D1F07CF9042FD7F86E3B637BE17FBFD7C9F0DB5850835170B354A52C175B769A37BA578F965436FF29BCFD54C5D4E939E02214503C8A69FFBBF0EC06657DF9498BE98DEB26B62E1453817F6DFAE9B50EE21C5A643FF0292539838A682562303CB77FC6028B22B30B78957E4F78E539103F991928681EBF3100D31960F43F8ECFC6C2F3063B353E92BFFEF77A49BBCBF417864AE8169AA061F590E5FB3393A4592EFA1100FC186B95B83724CA0B11D8BC02BC9BD4F9E08552DE2D1EB0EE0E866E41A520730E6F',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJFdAGiMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDExETAPBgNVBAMMCDEwLjAuMC4xMB4XDTE4MDMy\nMDIyMDU1M1oXDTE4MDMyMTIyMDczM1owYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDkC57yCVmqSdAgFuwumJYHTuCBhonq1zGezI7YyVV0Eu1GyV5n\nRkWY9iM+zri/Jah28NMLZc7Ssf7Y0fB8+QQv1/huO2N74X+/18nw21hQg1Fws1Sl\nLBdbdpo3ulePllQ2/ym8/VTF1Ok54CIUUDyKaf+78OwGZX35SYvpjesmti4UU4F/\nbfrptQ7iHFpkP/ApJTmDimglYjA8t3/GAosiswt4lX5PeOU5ED+ZGShoHr8xANMZ\nYPQ/js/GwvMGOzU+kr/+93pJu8v0F4ZK6BaaoGH1kOX7M5OkWS76EQD8GGuVuDck\nygsR2LwCvJvU+eCFUt4tHrDuDoZuQaUgcw5vAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAItvUfipOkdPZlqJIASIPmKrWCQ1qHcR\nByG8136cn34lxZmVDcX65a1JlFoXxMr7rc2sqbIVYUcwE8n70MGCS778eg1IcuVH\npmoouw5TNPsxE6ZXsUHQQbcZhuuqB232lOJdNC+wUy/4px2qFO0GJrQuDR7/9YB9\nHvwUBAwgTb17G1XmArygnwBWFlBUbHKXAtRSbkvOKXvVAAvDK5B7/d8icH+g4yqx\nYl5nYN3lp/hl/Wp5j44ua3zAQS5YL8eb4iAShTLFw+kRHTTA/1x5NeFMhE3ExUA/\nR2VPBlZpBkv7UsqWfuLU6in9FmEEVLI2pBAm5bN7KVS/6H6ix/2FqtU=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 2
to: 3
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 14 0.6428571428571429 1521584517760
connected to auth! from local port 37878
received auth hello!
{ authId: 502, nonce: <Buffer 02 64 b5 a9 01 93 06 61> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 12 cc 38 39 48 e4 ca 09>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 9d 9a e8 d1 b8 b6 55 bb 29 76 d9 9a 5a 7a f1 99>,
  macKeyVal: <Buffer 1a 8c ea 69 54 65 0a 94 37 30 99 c9 fb ea af 83 76 1a b6 80 a5 7c 59 24 e1 08 d0 3a 07 96 4d 93>,
  absValidity: 2018-03-20T23:22:05.584Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201446,
  cipherKeyVal: <Buffer ff 3b f9 97 9d 1c c8 f9 9b a4 03 e8 3e 3c 20 94>,
  macKeyVal: <Buffer 58 3c 7a ae fa ec e9 f4 65 ca df d0 c8 de 8b d6 0b ca 61 85 73 4a ad ab 13 40 89 3c 79 8e e5 58>,
  absValidity: 2018-03-21T22:22:05.584Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.11',
  serverPort: 22100,
  sessionKey: 
   { id: 50201446,
     cipherKeyVal: <Buffer ff 3b f9 97 9d 1c c8 f9 9b a4 03 e8 3e 3c 20 94>,
     macKeyVal: <Buffer 58 3c 7a ae fa ec e9 f4 65 ca df d0 c8 de 8b d6 0b ca 61 85 73 4a ad ab 13 40 89 3c 79 8e e5 58>,
     absValidity: 2018-03-21T22:22:05.584Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer d9 02 c4 de 8e cf 12 57>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.11:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 15 0.6 1521584577762
connected to auth! from local port 38104
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 16 0.5625 1521584637771
connected to auth! from local port 38286
received auth hello!
{ authId: 502, nonce: <Buffer 78 d6 e9 09 cd 85 32 ed> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 17 7a a0 9c c9 88 3a 7c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201479,
  cipherKeyVal: <Buffer a2 b9 3d 19 9e fd 6f ea f1 0d 5e 0b f5 91 e9 20>,
  macKeyVal: <Buffer ee a1 63 19 2e b7 e0 78 c6 27 0c 3b 4a a3 1e 51 1d ac 48 18 94 0a ad 8c a3 74 45 65 11 7b 7b d0>,
  absValidity: 2018-03-21T22:24:35.259Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.11',
  serverPort: 22100,
  sessionKey: 
   { id: 50201479,
     cipherKeyVal: <Buffer a2 b9 3d 19 9e fd 6f ea f1 0d 5e 0b f5 91 e9 20>,
     macKeyVal: <Buffer ee a1 63 19 2e b7 e0 78 c6 27 0c 3b 4a a3 1e 51 1d ac 48 18 94 0a ad 8c a3 74 45 65 11 7b 7b d0>,
     absValidity: 2018-03-21T22:24:35.259Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer e6 66 0b 8f c2 f8 5a d2>
switching to HANDSHAKE_1_SENT
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 17 0.5294117647058824 1521584697794
connected to auth! from local port 38486
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.11:undefined
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 18 0.5 1521584757805
connected to auth! from local port 38638
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 19 0.47368421052631576 1521584817815
connected to auth! from local port 38796
received auth hello!
{ authId: 502, nonce: <Buffer 9e ee 9c bb a2 cf e3 75> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 15 0e 1a cd 0a db 85 b0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201517,
  cipherKeyVal: <Buffer 64 b9 30 d1 8c 17 1d 72 22 25 4b b5 26 34 99 96>,
  macKeyVal: <Buffer 08 ad c4 cb e7 26 2f e9 6a 1d bf b6 78 dd ad 02 24 55 82 35 c5 db 1c 21 a4 02 90 9f 63 2c 09 d3>,
  absValidity: 2018-03-21T22:27:29.606Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.11',
  serverPort: 22100,
  sessionKey: 
   { id: 50201517,
     cipherKeyVal: <Buffer 64 b9 30 d1 8c 17 1d 72 22 25 4b b5 26 34 99 96>,
     macKeyVal: <Buffer 08 ad c4 cb e7 26 2f e9 6a 1d bf b6 78 dd ad 02 24 55 82 35 c5 db 1c 21 a4 02 90 9f 63 2c 09 d3>,
     absValidity: 2018-03-21T22:27:29.606Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer cd f2 88 fc cf 37 ea c2>
switching to HANDSHAKE_1_SENT
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 20 0.45 1521584877844
connected to auth! from local port 38962
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.11:undefined
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 21 0.42857142857142855 1521584937853
connected to auth! from local port 39128
received auth hello!
{ authId: 502, nonce: <Buffer 65 6a 92 f1 86 6f 42 ba> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c6 09 63 92 4a 2e 1f a4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201547,
  cipherKeyVal: <Buffer fb 6b 92 de 40 d7 04 fa cd d8 d6 70 ff ef a7 2d>,
  macKeyVal: <Buffer 94 f3 7c 14 94 05 28 60 b4 4e 68 b8 42 59 ce 1f 9c 52 86 50 ba ed 54 9a 72 41 92 ef f1 18 c0 98>,
  absValidity: 2018-03-21T22:29:17.591Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.11',
  serverPort: 22100,
  sessionKey: 
   { id: 50201547,
     cipherKeyVal: <Buffer fb 6b 92 de 40 d7 04 fa cd d8 d6 70 ff ef a7 2d>,
     macKeyVal: <Buffer 94 f3 7c 14 94 05 28 60 b4 4e 68 b8 42 59 ce 1f 9c 52 86 50 ba ed 54 9a 72 41 92 ef f1 18 c0 98>,
     absValidity: 2018-03-21T22:29:17.591Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 4e cf 6a a8 86 1d b1 51>
switching to HANDSHAKE_1_SENT
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 22 0.4090909090909091 1521584997894
connected to auth! from local port 39286
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.11:undefined
received auth hello!
{ authId: 502, nonce: <Buffer cc e1 93 ed d3 88 91 a7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3d 85 df fe c0 6a 6b 9f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201562,
  cipherKeyVal: <Buffer ae 08 df 03 bb d4 61 48 94 20 72 42 67 84 e0 66>,
  macKeyVal: <Buffer 9e 11 72 25 c2 c4 e3 09 4f fc 69 01 75 db 06 19 fd da 25 92 6e c9 3f 58 aa 65 80 29 8a 38 9b 54>,
  absValidity: 2018-03-21T22:30:17.580Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.11',
  serverPort: 22100,
  sessionKey: 
   { id: 50201562,
     cipherKeyVal: <Buffer ae 08 df 03 bb d4 61 48 94 20 72 42 67 84 e0 66>,
     macKeyVal: <Buffer 9e 11 72 25 c2 c4 e3 09 4f fc 69 01 75 db 06 19 fd da 25 92 6e c9 3f 58 aa 65 80 29 8a 38 9b 54>,
     absValidity: 2018-03-21T22:30:17.580Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 07 fd 6b 96 4e 91 91 f6>
switching to HANDSHAKE_1_SENT
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 23 0.391304347826087 1521585057935
connected to auth! from local port 39440
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.11:undefined
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 24 0.375 1521585117937
connected to auth! from local port 39596
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 25 0.36 1521585177947
connected to auth! from local port 39746
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 26 0.34615384615384615 1521585237956
connected to auth! from local port 39884
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 27 0.3333333333333333 1521585297966
connected to auth! from local port 40022
received auth hello!
{ authId: 502, nonce: <Buffer 68 73 90 08 86 4a 2e f0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7b 09 f2 63 9d 09 96 f6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201619,
  cipherKeyVal: <Buffer 4a d7 ef f9 e9 f5 99 ea f7 9d f5 57 50 0f 05 23>,
  macKeyVal: <Buffer 10 0a 58 d8 b4 75 79 72 e6 8a 33 ce bf 2d a3 c9 0f 4c 9a a1 90 5b e6 8f 06 ee e2 40 1a 9c 74 d3>,
  absValidity: 2018-03-21T22:35:01.602Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.11',
  serverPort: 22100,
  sessionKey: 
   { id: 50201619,
     cipherKeyVal: <Buffer 4a d7 ef f9 e9 f5 99 ea f7 9d f5 57 50 0f 05 23>,
     macKeyVal: <Buffer 10 0a 58 d8 b4 75 79 72 e6 8a 33 ce bf 2d a3 c9 0f 4c 9a a1 90 5b e6 8f 06 ee e2 40 1a 9c 74 d3>,
     absValidity: 2018-03-21T22:35:01.602Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer c1 d1 45 62 c6 d1 92 7f>
switching to HANDSHAKE_1_SENT
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.11:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 28 0.32142857142857145 1521585357973
connected to auth! from local port 40158
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 29 0.3103448275862069 1521585417982
connected to auth! from local port 40318
received auth hello!
{ authId: 502, nonce: <Buffer 0c b9 c0 ec d0 79 f1 ca> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 80 ca a9 44 44 a3 b5 c2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201647,
  cipherKeyVal: <Buffer 82 c4 e9 37 c8 05 b0 1e a7 80 84 a8 d7 46 73 01>,
  macKeyVal: <Buffer e7 8d be 6f ad 32 2e ba da 60 ad 48 db b8 82 10 f1 69 bc 1d 5b 99 6a 2f ba 72 ba b8 ac 63 10 ab>,
  absValidity: 2018-03-21T22:37:01.569Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.11',
  serverPort: 22100,
  sessionKey: 
   { id: 50201647,
     cipherKeyVal: <Buffer 82 c4 e9 37 c8 05 b0 1e a7 80 84 a8 d7 46 73 01>,
     macKeyVal: <Buffer e7 8d be 6f ad 32 2e ba da 60 ad 48 db b8 82 10 f1 69 bc 1d 5b 99 6a 2f ba 72 ba b8 ac 63 10 ab>,
     absValidity: 2018-03-21T22:37:01.569Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 8f 6f 62 55 69 60 13 08>
switching to HANDSHAKE_1_SENT
disconnected from auth
