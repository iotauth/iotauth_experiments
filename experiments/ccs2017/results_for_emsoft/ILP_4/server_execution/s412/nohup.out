changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s412.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's412',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 67 49 42 41 41 4b 43 41 51 45 41 74 63 ... > }
Handler: listening on port 22100
s412:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300523
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60972
received auth hello!
{ authId: 403, nonce: <Buffer 01 b7 09 dc 4e b1 73 09> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 2e 2e 14 c5 3d 4d 25 4e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer e4 3b f0 a7 92 0c 30 62 cd e6 0c 67 0d d9 05 b3>,
  macKeyVal: <Buffer a5 cf f7 02 c6 de be 6d 96 6e f7 45 58 26 67 ce 21 a3 60 fb 39 97 8f 3c 93 41 f4 9b 65 b8 56 2b>,
  absValidity: 2018-03-21T02:58:47.299Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a9 a6 97 09 08 cf a5 91>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer a9 a6 97 09 08 cf a5 91> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.57:41810',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300529
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 32938
received auth hello!
{ authId: 403, nonce: <Buffer 4d 09 8e 5d 1c 18 8e c6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 50 a9 b5 b4 38 71 fc e4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6e 8a 18 11 ca 83 30 d7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6e 8a 18 11 ca 83 30 d7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.57:42008',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300535
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33210
received auth hello!
{ authId: 403, nonce: <Buffer bc 43 57 8c e6 1e 62 a8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a9 7c 5d 39 2a fb 89 cc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cc ce 9d 16 c1 f8 a9 fe>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer cc ce 9d 16 c1 f8 a9 fe> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.57:42280',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300541
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33480
received auth hello!
{ authId: 403, nonce: <Buffer 25 57 33 01 ec fb 9e 55> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a5 5c 7c 72 76 cc 18 80>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d0 c3 5f cf d0 db e2 ac>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d0 c3 5f cf d0 db e2 ac> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.57:42550',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300547
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33750
received auth hello!
{ authId: 403, nonce: <Buffer db 38 92 0c ab 09 87 fc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 53 cd 22 4f 0a 79 4c 01>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f7 87 85 b5 d7 5d aa 97>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f7 87 85 b5 d7 5d aa 97> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.57:42820',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300553
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34020
received auth hello!
{ authId: 403, nonce: <Buffer ba 0f 99 50 49 8d 67 9d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b2 ad 11 a6 6b bb 17 cd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 29 b2 9b 43 e4 91 69 47>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 29 b2 9b 43 e4 91 69 47> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.57:43090',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300559
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34290
received auth hello!
{ authId: 403, nonce: <Buffer 29 1c d1 96 fb 03 8e 23> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 49 ed 7d fc 33 30 72 75>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer aa 07 47 1c aa bd 71 53>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer aa 07 47 1c aa bd 71 53> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.57:43360',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300565
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34556
received auth hello!
{ authId: 403, nonce: <Buffer f3 eb 84 7f e6 c2 08 80> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 50 9c fa dc 29 d8 7a 30>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5e 57 7b 92 bf 2b f8 00>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5e 57 7b 92 bf 2b f8 00> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.57:43626',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
