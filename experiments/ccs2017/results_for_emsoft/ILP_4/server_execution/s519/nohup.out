changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s519.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's519',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 73 6b ... > }
Handler: listening on port 22100
s519:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400119
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37162
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400120
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37178
received auth hello!
{ authId: 504, nonce: <Buffer ca 8b be 5d 5b 29 ab e7> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer f0 49 47 29 c2 6d 4d 18>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 29 31 91 f9 1b b3 8e 03 fc 37 1a 8d 06 b0 76 36>,
  macKeyVal: <Buffer 23 75 6c 94 9d 65 f3 89 af ac 43 09 94 e3 e8 97 4f 96 f8 97 89 67 64 ce dc fb 71 90 9a 6d b6 c4>,
  absValidity: 2018-03-21T03:00:30.203Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ad e5 80 0b 6a 45 01 f9>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ad e5 80 0b 6a 45 01 f9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.86:45688',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer 6d 2c 43 10 8e 9b 4f 3b> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer ab 0a df d6 2f ca 5d 88>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer cd dc b1 90 10 bb 73 40 4b ef 42 8e e9 72 ec cc>,
  macKeyVal: <Buffer c3 11 ad 8e 5f 94 58 2a b6 af 84 f6 46 d7 6a 7e 22 dd b7 fd c1 79 06 cd ae e5 1e 34 2b 0b 33 43>,
  absValidity: 2018-03-21T03:00:31.991Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer dc bd 94 d3 4c 9e ce ec>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer dc bd 94 d3 4c 9e ce ec> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.87:46968',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400125
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37432
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400126
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37446
received auth hello!
{ authId: 504, nonce: <Buffer d2 32 35 1f 1d 7a ea 83> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d0 ea 63 2e 6d 57 bd f8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 69 6b a2 cd fa 3b 7a b7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 69 6b a2 cd fa 3b 7a b7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.86:45956',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer 03 78 61 2e 50 98 43 d8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d0 6b 03 1d e2 f3 4f 6b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8c 47 c8 d8 f6 a8 83 08>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8c 47 c8 d8 f6 a8 83 08> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.87:47238',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400131
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37702
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400132
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37720
received auth hello!
{ authId: 504, nonce: <Buffer df 6d 33 d9 ec 88 63 d1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 27 f7 5e 97 37 c4 25 07>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer af 57 0a d0 d9 ba 97 8b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer af 57 0a d0 d9 ba 97 8b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.86:46226',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer 35 40 53 02 29 7a 2a e3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8d 51 23 04 a0 bf 9f 54>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5a e0 3f ee 95 90 7a 26>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 5a e0 3f ee 95 90 7a 26> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.87:47508',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400137
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37972
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400138
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37990
received auth hello!
{ authId: 504, nonce: <Buffer 75 52 a9 e5 33 55 34 84> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 66 7f 2f 20 f8 67 7f c5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f2 2f dd 11 d6 27 d3 38>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f2 2f dd 11 d6 27 d3 38> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.86:46496',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer 81 93 ed b9 0c ac 20 0b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e5 f1 11 9d f0 90 4f 17>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 27 1b 2e 54 12 03 b3 48>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 27 1b 2e 54 12 03 b3 48> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.87:47778',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400143
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38242
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400144
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38260
received auth hello!
{ authId: 504, nonce: <Buffer 02 4c 21 96 7f 4c 41 52> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a0 a3 fa b6 65 ca 15 ba>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4b 46 fe 36 46 5c ad 69>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4b 46 fe 36 46 5c ad 69> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.86:46768',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer 0f 01 df ec 39 70 e5 e2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 12 2f b3 90 04 2a ca 03>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e6 0a 36 cc 3a da 24 1c>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e6 0a 36 cc 3a da 24 1c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.87:48050',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400149
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38512
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400150
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38530
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer 39 ef ba aa 76 dd 35 2f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer db d1 00 27 a6 5b 96 e7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 35 20 14 9a 1d b3 0e 8c>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 35 20 14 9a 1d b3 0e 8c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.86:47036',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100906
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100916
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100917
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in server - details: handshake2 timed out...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in server - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.2:21100
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in server - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 3
Handler: Error in server - details: Error occurred in migration request: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 4
Handler: Error in server - details: Error occurred in migration request: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100928
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 47642
received auth hello!
{ authId: 502, nonce: <Buffer 0e f0 2e 3d e0 2a 59 b8> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth504',
     commonName: '10.0.0.7' },
  serial: '016246460309',
  notBefore: 2018-03-21T01:55:16.000Z,
  notAfter: 2018-03-22T01:56:56.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'AB:B4:22:6D:DC:14:27:9B:72:32:67:BA:1A:E8:82:A3:33:F0:33:71',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'FF6CB5202497CC77AF28EFDE774858E4FEF04355E5228E378962DF4235BE3683DAF9E38A7E22621D66B3B50166D897E97BF911F9E8FC09D686961AA39679014E5DDD27EA0F02DE853A41537DB5E37F33395E249F355C0D074419572E9856D1D598CAB2CD6951013DDCB0A163B943DFCD2694BE18B9B3892695B3052EBD9115D447293C83AF24A008794B842E4F0A6C2A8D0189612A600AA40A592603E43713C0ECCA681024E5EC429FAD09484B824919DF59C8BD488E0D372D2A3D8B99B6068E24BBBDA8F0BCDDBA806010E4A7181736DF08D4D1CFC16E26507C360EDCBFF1B5F4288CE304DE62E9696665C5108489AD7232658356998FF47C4F7E8A04225423',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJGRgMJMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDQxETAPBgNVBAMMCDEwLjAuMC43MB4XDTE4MDMy\nMTAxNTUxNloXDTE4MDMyMjAxNTY1NlowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQD/bLUgJJfMd68o7953SFjk/vBDVeUijjeJYt9CNb42g9r544p+\nImIdZrO1AWbYl+l7+RH56PwJ1oaWGqOWeQFOXd0n6g8C3oU6QVN9teN/MzleJJ81\nXA0HRBlXLphW0dWYyrLNaVEBPdywoWO5Q9/NJpS+GLmziSaVswUuvZEV1EcpPIOv\nJKAIeUuELk8KbCqNAYlhKmAKpApZJgPkNxPA7MpoECTl7EKfrQlIS4JJGd9ZyL1I\njg03LSo9i5m2Bo4ku72o8LzduoBgEOSnGBc23wjU0c/BbiZQfDYO3L/xtfQojOME\n3mLpaWZlxRCEia1yMmWDVpmP9HxPfooEIlQjAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAJe4gcV0gxhx3i9/8mmGRxjw+DyeOLYk\nLdDGYSKkewMB5kt5+dO3FZvRXlWEqKnnsHWfDA30PSJx3a5KsJGDKmSCgD2lPHtp\n9NM9Lh3gdBrTYeX7f+ar4rSh10I4Zokx0jIFGoE3IbEIHQSC9Igj9NOYvHaqegZY\noJhsgCa52HjCEyLw9gaZ88wZ0kCpjruppwkN7e6lRnkjNJ53fzdAPRbEeACS0ISS\nbrw6vBCCOzsygupM335GwzwNs6Iom+U6LvWAEyvM2HOmzaUvqiXH3UYzmmxhTUYe\nZCxCKQtTO/bYMTVSjlIA7oZ0TWyuxv9nIc2k2fmuerLXe4/C0NsM2CU=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 1
to: 2
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100938
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47858
received auth hello!
{ authId: 502, nonce: <Buffer 23 81 e2 d4 fe 20 58 c3> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 1b 65 70 a1 43 2a 06 aa>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 48 6f dd 84 61 c7 97 0a 6f 0c 99 ab 03 34 93 63>,
  macKeyVal: <Buffer 18 1c c2 e3 4e 9c 21 0b 24 86 06 e3 18 43 75 74 a1 08 43 c0 d7 55 cd 51 dd a4 f6 fa 9e 88 5c 46>,
  absValidity: 2018-03-21T03:11:30.828Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 68 6b 62 51 50 22 c1 6a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 68 6b 62 51 50 22 c1 6a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.87:49654',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100951
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48088
received auth hello!
{ authId: 502, nonce: <Buffer 90 f5 a5 f1 3b c2 ff 1d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 03 3c 34 49 32 25 f5 d3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 19 a0 ff a4 71 64 64 39>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 19 a0 ff a4 71 64 64 39> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.87:49884',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100952
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48094
received auth hello!
{ authId: 502, nonce: <Buffer c6 d1 89 08 ef 55 6c 77> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9f 47 6a c3 d2 51 65 79>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d5 0b af e1 6c 72 f0 7f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d5 0b af e1 6c 72 f0 7f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.86:48626',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100965
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48324
received auth hello!
{ authId: 502, nonce: <Buffer 3a 21 c5 2e 94 e4 cd 1e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6e 20 5e af 44 82 59 6c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 91 fd 8f 1d 0e 68 a4 65>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 91 fd 8f 1d 0e 68 a4 65> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.87:50122',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100976
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48536
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100978
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48550
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer f7 2a 1d dd db e4 a0 a1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7e 38 92 96 bf e3 bc 1c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0f 36 d1 d3 df 95 69 1a>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 0f 36 d1 d3 df 95 69 1a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.86:49068',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100988
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48742
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100989
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48750
received auth hello!
{ authId: 502, nonce: <Buffer d2 6f fe c3 f5 c2 c8 5a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 21 75 e1 0d d4 76 c9 9f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2d c5 90 d4 8d cb de b6>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 2d c5 90 d4 8d cb de b6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.86:49274',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 05 a5 42 1c 3d 38 89 7c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4f 8a b8 57 c3 b4 a0 0c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 67 7b 17 04 c3 41 6f f2>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 67 7b 17 04 c3 41 6f f2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.87:50548',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101001
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48954
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
received auth hello!
{ authId: 502, nonce: <Buffer f8 30 48 26 ac b1 d2 af> }
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101003
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ae fe 8d 75 b0 67 64 19>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 04 11 6a 13 86 32 e5 c2>
Handler: Error in server - details: Error during comm init, details: Error: This socket has been ended by the other party
switching to HANDSHAKE_2_SENT
disconnected from auth
connected to auth! from local port 48968
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer be b7 13 12 28 a4 93 d4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer da 46 2f cb 29 fc 3f d8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 08 03 eb 20 76 a1 df 83>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 08 03 eb 20 76 a1 df 83> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.87:50766',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer d3 8a 34 69 48 d6 c5 74> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3e 75 6a a0 33 34 be 21>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 97 da 96 da a5 71 10 ba>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 97 da 96 da a5 71 10 ba> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.86:49486',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101013
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49146
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101015
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49166
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101025
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49352
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101027
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49364
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer a3 e7 57 3d 2c 7f 60 22> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a4 08 d8 19 35 2b c1 58>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d0 d8 09 30 ef a6 38 a4>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer d0 d8 09 30 ef a6 38 a4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.87:51162',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101038
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49556
received auth hello!
{ authId: 502, nonce: <Buffer fe 8c 29 aa 60 a8 ec c3> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: write after end
received auth hello!
{ authId: 502, nonce: <Buffer 89 e6 29 fa 5d 43 82 18> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ac ae de 3b bf ee 82 bd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 53 13 f1 48 ed e5 af 53>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 53 13 f1 48 ed e5 af 53> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.86:50086',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101040
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49570
Handler: Error in server - details: handshake2 timed out...
disconnected from auth
Handler: Error in server - details: Connection with Auth timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101051
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49762
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101052
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49774
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 85 22 89 47 73 9b f1 9e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b1 77 37 0a 72 85 79 95>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3b 0c 87 20 27 e5 04 45>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3b 0c 87 20 27 e5 04 45> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.87:51572',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 9b 69 84 d5 ad 0d 21 bc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 97 36 72 cf cc f2 7d 65>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 13 0a a4 43 67 62 aa bb>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 13 0a a4 43 67 62 aa bb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.86:50292',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
received auth hello!
{ authId: 502, nonce: <Buffer 38 8e 12 2f 7d de 55 1b> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: write after end
received auth hello!
{ authId: 502, nonce: <Buffer d9 54 85 fc 6d a9 1f 7e> }
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: write after end
connected to auth! from local port 55498
Handler: Error in server - details: Auth hello timedout ...
received auth hello!
{ authId: 502, nonce: <Buffer 59 6d 17 f8 28 bf 64 f7> }
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: write after end
connected to auth! from local port 55506
disconnected from auth
received auth hello!
{ authId: 401, nonce: <Buffer e4 4d 51 85 c8 28 e4 32> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth401',
     commonName: '10.0.1.1' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth504',
     commonName: '10.0.0.7' },
  serial: '01624646027E',
  notBefore: 2018-03-21T01:55:16.000Z,
  notAfter: 2018-03-22T01:56:56.000Z,
  subjectHash: 'de555cae',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '2F:D7:31:69:89:24:34:78:45:87:47:CD:32:D2:D7:7A:8E:89:84:C2',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'B1D96D976344F70094AA7D00CFD0F6058B1B31F97C522A983DCB23C390F9190875BA7C64D5E5888B86F8FBB648A0578A448C8237E3471A64ED59A03226A81FB2D143B5D1B71755CE1746179065723893719601038056ABCE33D646915D78D23FCCCDAB70CDEB639AEA41A5AC90E02E3302A6EEA261EDEC33DAF9FF6E9D9AA13A87980386B0E5509FC1EC88DB6E99D090B087A95B3C78136AA98C511DF596BB516D5BEEA892745A9EBF372CC45AE13E88878E884DB48A986EB570DE84DB722811E539492023404AA567C0DE100C0C0E8B6B33FB2C63046063377803BC046949DBDCBCD85174D56D807C222E8E1C0DC97AA62D0B26CD1F36670A8CC0942EAA82E3',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.1' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 401,
  host: '10.0.1.1',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJGRgJ+MA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDQxETAPBgNVBAMMCDEwLjAuMC43MB4XDTE4MDMy\nMTAxNTUxNloXDTE4MDMyMjAxNTY1NlowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDQwMTERMA8GA1UEAwwIMTAuMC4xLjEwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQCx2W2XY0T3AJSqfQDP0PYFixsx+XxSKpg9yyPDkPkZCHW6fGTV\n5YiLhvj7tkigV4pEjII340caZO1ZoDImqB+y0UO10bcXVc4XRheQZXI4k3GWAQOA\nVqvOM9ZGkV140j/MzatwzetjmupBpayQ4C4zAqbuomHt7DPa+f9unZqhOoeYA4aw\n5VCfweyI226Z0JCwh6lbPHgTaqmMUR31lrtRbVvuqJJ0Wp6/NyzEWuE+iIeOiE20\niphutXDehNtyKBHlOUkgI0BKpWfA3hAMDA6LazP7LGMEYGM3eAO8BGlJ29y82FF0\n1W2AfCIujhwNyXqmLQsmzR82ZwqMwJQuqoLjAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQEwDQYJKoZIhvcNAQELBQADggEBAIYO02N5ZnPO24X4zkJmUB6mPMKcRJoM\nJdkAVRDz3MbabQWzkBqW99NRKLJRlM+Q2XJO46ZiApakpNx+97b6a7eXZzrFQDQe\nWplGmBemuss54P83usgw2/F8e1NprwGejdofIalFRkfjNoVets+TLZ6hNDGMyBba\nP78o68cJKdOGmTVue1jlhOKEIrLJ0EBGjBfCzrKrzT59uV5Iht+wUGh/+11Pnrx9\nkXKSw6pjCp1/uBwHlkNusqSLzNxai0/ZgXTZgI037YoAqgPrbcjpPJe3bzM3oMIo\nNH1oNecgMIgl2tEQw2ZV3ZoZDYxQtTAG+vRCab2O1Vfk4+STaUorVpo=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 2
to: 3
disconnected from auth
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101063
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55544
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101064
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55558
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
disconnected from auth
Handler: Error in server - details: Connection with Auth timed out...
Handler: Error in server - details: Connection with Auth timed out...
Handler: Error in server - details: Connection with Auth timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101075
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55722
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101076
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55730
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 401, nonce: <Buffer cf af 78 d6 d2 44 6e 23> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 86 bd a8 d7 eb 6d 7f 74>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 70 55 3b fc 13 e8 ec 1d 17 98 f4 70 4c e7 d3 56>,
  macKeyVal: <Buffer ea 96 9e 05 aa 63 db 61 bc 60 d1 6e 2b dc 9a 2c 86 67 11 51 83 0e f0 ab 3b 84 82 71 0f 70 a2 04>,
  absValidity: 2018-03-21T03:22:34.206Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a6 d0 59 6b a3 74 26 59>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a6 d0 59 6b a3 74 26 59> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 24,
  remoteAddress: '::ffff:10.0.1.87:51936',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 24 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 24 }
specified socketID: 24
received auth hello!
{ authId: 401, nonce: <Buffer 08 0d e7 cc a6 9d 89 1f> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 2f 0d 58 ee 9d 26 09 2a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 91 1d 6f 66 8f 52 57 ef d4 cb 61 0f a8 2b 98 0d>,
  macKeyVal: <Buffer 34 17 1f d3 2d 11 e8 c4 b4 db 4f 8e 0a da 26 1b 6c 31 5b b9 4b 7b b1 b1 dd 2c 4d bc ac 22 c0 7b>,
  absValidity: 2018-03-21T03:22:34.964Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f6 c3 b0 4c d5 bf 1c db>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f6 c3 b0 4c d5 bf 1c db> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 25,
  remoteAddress: '::ffff:10.0.1.86:50662',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 25 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 25 }
specified socketID: 25
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #25 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101086
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55908
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #24 closed
Unidentified client connected
received auth hello!
{ authId: 401, nonce: <Buffer 0d 9f 76 68 89 22 d4 15> }
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101089
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 55 df 66 2a b1 a5 0c b1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 98 d6 e4 e7 23 ac 67 29>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 98 d6 e4 e7 23 ac 67 29> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 26,
  remoteAddress: '::ffff:10.0.1.86:50848',
  status: 'open' }
connected to auth! from local port 55926
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 26 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 26 }
specified socketID: 26
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #26 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101097
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56098
received auth hello!
{ authId: 401, nonce: <Buffer 11 28 66 43 47 a3 67 30> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 69 c0 02 1e 2b 06 6d 8d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 85 1e 09 13 7a 26 77 65>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 85 1e 09 13 7a 26 77 65> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 27,
  remoteAddress: '::ffff:10.0.1.86:51038',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 27 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 27 }
specified socketID: 27
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101098
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56118
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #27 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101110
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56288
Unidentified client connected
Handler: Error in server - details: handshake2 timed out...
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101111
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
received auth hello!
{ authId: 401, nonce: <Buffer e3 79 4e c5 c3 fa 47 53> }
connected to auth! from local port 56304
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 15 62 1e 61 a7 67 85 f4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8f 34 6c 31 b1 25 c7 5d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8f 34 6c 31 b1 25 c7 5d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 28,
  remoteAddress: '::ffff:10.0.1.86:51228',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 28 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 28 }
specified socketID: 28
received auth hello!
{ authId: 401, nonce: <Buffer 33 08 d0 40 4e d1 3c c9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 63 88 ba 58 d0 23 75 94>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bc c8 18 ff 1b a5 90 2f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bc c8 18 ff 1b a5 90 2f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 29,
  remoteAddress: '::ffff:10.0.1.87:52508',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 29 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 29 }
specified socketID: 29
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #28 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101120
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56458
received auth hello!
{ authId: 401, nonce: <Buffer 33 15 71 4d 1c 3e b7 fc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 29 c0 5c 30 1e 90 0a 82>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0f 4f e7 77 e4 9b a0 a3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0f 4f e7 77 e4 9b a0 a3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 30,
  remoteAddress: '::ffff:10.0.1.86:51396',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 30 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 30 }
specified socketID: 30
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #29 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101121
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56466
received auth hello!
{ authId: 401, nonce: <Buffer f0 aa 3a fe 2b a1 23 ae> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f7 81 be 84 54 91 09 a2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 19 d1 77 51 61 88 95 77>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 19 d1 77 51 61 88 95 77> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 31,
  remoteAddress: '::ffff:10.0.1.87:52672',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 31 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 31 }
specified socketID: 31
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #30 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101124
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56568
received auth hello!
{ authId: 401, nonce: <Buffer 3a 8e da 3f c3 fe 7b 4d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 24 2f f9 83 9c d2 1c ae>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 81 4b ed a6 6a 18 fe e0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 81 4b ed a6 6a 18 fe e0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 32,
  remoteAddress: '::ffff:10.0.1.86:51508',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 32 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 32 }
specified socketID: 32
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #31 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101125
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56574
received auth hello!
{ authId: 401, nonce: <Buffer f5 85 a9 59 89 29 a2 a7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 59 69 55 b6 18 35 b2 b1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 48 82 ac 6d d5 59 a6 2a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 48 82 ac 6d d5 59 a6 2a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 33,
  remoteAddress: '::ffff:10.0.1.87:52780',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 33 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 33 }
specified socketID: 33
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #32 closed
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #33 closed
