changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s416.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's416',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 30 61 ... > }
Handler: listening on port 22100
s416:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300526
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56574
received auth hello!
{ authId: 403, nonce: <Buffer ac 15 90 09 99 a9 4f 93> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 17 db 65 4e 72 c8 74 63>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer c5 5a a9 51 04 34 19 db a6 68 02 3b df 16 34 ea>,
  macKeyVal: <Buffer b4 6a 9a af 61 cb 3c 99 ea ef c8 a0 b3 ec 53 b6 38 49 ef 91 ed d2 ef 7e cf 8a 05 a8 78 d4 0a f5>,
  absValidity: 2018-03-21T02:58:58.456Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e7 74 4d bc 10 20 c3 4e>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e7 74 4d bc 10 20 c3 4e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.60:60306',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300527
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56580
received auth hello!
{ authId: 403, nonce: <Buffer 61 a6 ae 3c cc 65 47 22> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6d d2 34 69 f2 b0 75 40>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 83 e7 31 30 ce 20 77 65>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 83 e7 31 30 ce 20 77 65> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.61:54636',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300532
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56786
received auth hello!
{ authId: 403, nonce: <Buffer 13 d2 d4 67 96 0b 7e 79> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 43 a6 95 67 89 31 cb 82>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 31 52 20 ed 39 91 3c 79>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 31 52 20 ed 39 91 3c 79> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.60:60518',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300533
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56802
received auth hello!
{ authId: 403, nonce: <Buffer 27 b2 91 82 62 32 27 66> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1b 78 4f 05 86 87 2c e2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer da db c2 34 21 6c c7 fc>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer da db c2 34 21 6c c7 fc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.61:54858',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300538
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57058
received auth hello!
{ authId: 403, nonce: <Buffer d8 26 74 d4 83 37 dd 6a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 03 4a 44 14 40 dd 30 d1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer eb 16 d1 78 14 e8 0b 60>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer eb 16 d1 78 14 e8 0b 60> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.60:60790',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300539
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57074
received auth hello!
{ authId: 403, nonce: <Buffer 52 04 51 e7 34 af ce 25> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 26 b6 2c c5 23 cc ed d1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 69 b2 23 92 06 14 55 b5>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 69 b2 23 92 06 14 55 b5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.61:55130',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300544
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57328
received auth hello!
{ authId: 403, nonce: <Buffer e1 72 48 c3 8c c6 28 45> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ff d5 8e 84 3d d1 5a b0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 64 09 2d 3a d4 b0 fd 04>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 64 09 2d 3a d4 b0 fd 04> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.60:32828',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300545
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57344
received auth hello!
{ authId: 403, nonce: <Buffer 8d 5e fa cb 71 94 c6 51> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer af e3 84 5a 18 cd 1c 0e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2b f5 cf 11 e3 37 7f e7>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 2b f5 cf 11 e3 37 7f e7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.61:55400',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300550
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57598
received auth hello!
{ authId: 403, nonce: <Buffer 1e 42 2a ba 47 f2 db 57> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2d f5 86 81 20 ce 6c ff>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ad 11 83 7d 97 2c 93 c4>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ad 11 83 7d 97 2c 93 c4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.60:33098',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300551
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57614
received auth hello!
{ authId: 403, nonce: <Buffer 2c 79 58 f6 46 5e f8 0a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 40 6e b5 5e c6 86 d6 a6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a9 0d 9e 60 e2 f6 61 a5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a9 0d 9e 60 e2 f6 61 a5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.61:55670',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300556
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57868
received auth hello!
{ authId: 403, nonce: <Buffer 37 ce 1f f4 75 f5 b8 8d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e8 8b 19 10 8b 8e 65 d1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6d 32 ff d5 d6 fc cb 13>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 6d 32 ff d5 d6 fc cb 13> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.60:33368',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300557
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57884
received auth hello!
{ authId: 403, nonce: <Buffer 37 bd b0 97 8e 45 e9 15> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1f 3c 8f d3 e1 ab 60 99>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2e 1e cd 8e 6c 70 a1 07>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2e 1e cd 8e 6c 70 a1 07> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.61:55940',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300562
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58138
received auth hello!
{ authId: 403, nonce: <Buffer 12 f1 a6 b9 28 5c cd 4f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 82 76 58 61 e0 32 29 45>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6b 56 42 28 4c 54 6f fe>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6b 56 42 28 4c 54 6f fe> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.60:33638',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300563
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58154
received auth hello!
{ authId: 403, nonce: <Buffer 5c f9 fe a0 33 9d fb ac> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 45 8a 44 18 cb c5 ae c8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 32 14 88 7c a5 95 15 94>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 32 14 88 7c a5 95 15 94> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.61:56210',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300568
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58404
received auth hello!
{ authId: 403, nonce: <Buffer fd 30 8c e7 e6 37 70 01> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d4 57 87 85 e9 9e a2 d0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7e 2f cb e0 bf c6 27 14>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 7e 2f cb e0 bf c6 27 14> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.60:33904',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300569
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58420
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
