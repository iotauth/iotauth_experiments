changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s503.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's503',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 77 58 ... > }
Handler: listening on port 22100
s503:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100533
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42234
received auth hello!
{ authId: 504, nonce: <Buffer ce 0b 3a 22 9b ac 12 f6> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer ea ce 3b 67 80 3b ff c1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 23 aa 65 19 f5 40 3e 1b 05 24 1c e0 24 09 b9 fb>,
  macKeyVal: <Buffer 55 8b dc 35 91 93 1e 39 5f 66 0a 78 bf 05 82 1e 58 21 c3 9d cd 3f d4 cd 26 43 f5 d7 06 55 c2 8d>,
  absValidity: 2018-03-21T02:59:10.206Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 80 9e d6 18 a1 d3 23 c9>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 80 9e d6 18 a1 d3 23 c9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.64:34932',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400113
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42246
received auth hello!
{ authId: 504, nonce: <Buffer 5f 7c 59 0d 98 47 4c 91> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bd c0 91 f6 a7 17 7b d3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9c 67 d4 56 89 de f3 14>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9c 67 d4 56 89 de f3 14> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.65:40274',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400114
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42258
received auth hello!
{ authId: 504, nonce: <Buffer 2f f7 e0 ba d8 4f 7e 10> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a7 a0 a3 74 6c e8 bd fa>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a1 36 33 ab e1 74 73 57>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a1 36 33 ab e1 74 73 57> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.66:38846',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100541
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42476
received auth hello!
{ authId: 504, nonce: <Buffer 72 35 70 5a 61 a7 5c a1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 22 99 a0 a2 21 0f d8 a3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 74 10 6c 47 73 1a 0a 0d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 74 10 6c 47 73 1a 0a 0d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.64:35172',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400115
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42494
received auth hello!
{ authId: 504, nonce: <Buffer ea b8 33 63 cc fd a9 a4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 48 19 ba 7a 52 24 f8 38>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c0 61 c2 76 67 36 cd cc>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c0 61 c2 76 67 36 cd cc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.65:40520',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400117
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42512
received auth hello!
{ authId: 504, nonce: <Buffer e0 64 f0 df 68 64 f3 d2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 90 7e 51 f7 6b 38 0c 66>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 67 45 d8 24 3b 1b 54 c5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 67 45 d8 24 3b 1b 54 c5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.66:39100',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100549
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42746
received auth hello!
{ authId: 504, nonce: <Buffer 18 39 1b a8 d5 7e d1 e1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1c e8 f1 49 c2 0a bb 04>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ff 61 7d 51 9e ea 24 5e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ff 61 7d 51 9e ea 24 5e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.64:35442',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400121
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42764
received auth hello!
{ authId: 504, nonce: <Buffer cb 68 b2 70 be 3c 8e 8b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 92 3a b9 ce 49 41 a7 15>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ac 50 d3 c4 fc 8b b5 af>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ac 50 d3 c4 fc 8b b5 af> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.65:40790',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400123
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42782
received auth hello!
{ authId: 504, nonce: <Buffer 22 50 42 66 af 66 7b 79> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer be ba 28 ee 00 16 6d bb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ef 96 0a d6 4b 83 68 c9>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ef 96 0a d6 4b 83 68 c9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.66:39370',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100557
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43016
received auth hello!
{ authId: 504, nonce: <Buffer a3 f7 37 75 62 44 c8 6d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b4 7c a3 2e 23 29 2d bd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 70 15 5d ee 1a 69 0b fd>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 70 15 5d ee 1a 69 0b fd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.64:35712',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400127
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43034
received auth hello!
{ authId: 504, nonce: <Buffer e5 fb e5 16 68 e6 04 b0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 55 dc ad 51 37 bd 99 fd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c2 14 ab 6f ae 8f 6d eb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c2 14 ab 6f ae 8f 6d eb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.65:41060',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400129
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43052
received auth hello!
{ authId: 504, nonce: <Buffer 13 2b 8a 1b 3d 8a 54 4a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 39 8a 85 84 a5 1a af 70>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 94 09 3d 34 ee f2 3e 04>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 94 09 3d 34 ee f2 3e 04> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.66:39640',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100565
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43286
received auth hello!
{ authId: 504, nonce: <Buffer 3b 5a 08 bf 26 12 65 e7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 72 20 2f 40 6a e3 8d 2e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8d 7b ae ee 63 49 b2 57>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8d 7b ae ee 63 49 b2 57> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.64:35984',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400133
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43304
received auth hello!
{ authId: 504, nonce: <Buffer 5e f7 ce 24 b9 06 c3 21> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3b 56 53 7b 00 da ef 8d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e4 27 de d6 16 43 32 34>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e4 27 de d6 16 43 32 34> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.65:41330',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400135
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43322
received auth hello!
{ authId: 504, nonce: <Buffer 27 5e e7 d0 e8 cb 2f 15> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 73 ad 83 8e cf 56 1c d2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 50 2d ef 7d d9 81 f1 08>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 50 2d ef 7d d9 81 f1 08> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.66:39910',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100573
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43556
received auth hello!
{ authId: 504, nonce: <Buffer eb b7 ae 6d e0 d6 c4 14> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c2 d6 60 e9 69 6d 08 af>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 92 97 5c c3 7a 41 ce 1c>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 92 97 5c c3 7a 41 ce 1c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.64:36252',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400139
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43574
received auth hello!
{ authId: 504, nonce: <Buffer be d1 da 3d 52 a4 65 7f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a1 10 8f 42 6e 50 e7 d9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c7 3f 0d 13 9c 8b 3b 36>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c7 3f 0d 13 9c 8b 3b 36> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.65:41600',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400141
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43592
received auth hello!
{ authId: 504, nonce: <Buffer 07 4d e4 7f de dd 14 f1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 16 6e 2a a8 01 90 c2 e6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b8 5b fd 0c 93 23 de 13>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b8 5b fd 0c 93 23 de 13> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.66:40180',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100581
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43826
received auth hello!
{ authId: 504, nonce: <Buffer 99 16 dd f0 64 a0 69 0a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9e 1e 84 91 1d 6e 16 a4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4e e3 59 bb 98 c6 94 18>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 4e e3 59 bb 98 c6 94 18> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.64:36522',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400145
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43844
received auth hello!
{ authId: 504, nonce: <Buffer 62 b5 29 b6 49 07 b8 16> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 36 ff db 9c ec f0 d6 0d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 76 93 96 4f f1 c4 d1 22>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 76 93 96 4f f1 c4 d1 22> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.65:41870',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400147
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43862
received auth hello!
{ authId: 504, nonce: <Buffer bf 98 21 b3 03 59 35 d7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 94 60 98 f2 c4 7a 5d 5a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f1 04 da 08 07 2a 1d 1a>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f1 04 da 08 07 2a 1d 1a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.66:40450',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100901
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100912
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200781
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in server - details: handshake2 timed out...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in server - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.4:21100
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in server - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 3
Handler: Error in server - details: Error occurred in migration request: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 4
Handler: Error in server - details: Error occurred in migration request: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100923
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200792
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 51582
connected to auth! from local port 51584
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in server - details: Error occurred in migration request: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in server - details: Error occurred in migration request: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100934
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200806
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 6
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in connection with Auth : authFailureCount: 7
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 41644
connected to auth! from local port 41646
received auth hello!
{ authId: 502, nonce: <Buffer d8 51 ea bd c6 f4 0d 12> }
received auth hello!
{ authId: 502, nonce: <Buffer 3c 29 0b 54 b4 43 e4 b5> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth504',
     commonName: '10.0.0.7' },
  serial: '016246460309',
  notBefore: 2018-03-21T01:55:16.000Z,
  notAfter: 2018-03-22T01:56:56.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'AB:B4:22:6D:DC:14:27:9B:72:32:67:BA:1A:E8:82:A3:33:F0:33:71',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'FF6CB5202497CC77AF28EFDE774858E4FEF04355E5228E378962DF4235BE3683DAF9E38A7E22621D66B3B50166D897E97BF911F9E8FC09D686961AA39679014E5DDD27EA0F02DE853A41537DB5E37F33395E249F355C0D074419572E9856D1D598CAB2CD6951013DDCB0A163B943DFCD2694BE18B9B3892695B3052EBD9115D447293C83AF24A008794B842E4F0A6C2A8D0189612A600AA40A592603E43713C0ECCA681024E5EC429FAD09484B824919DF59C8BD488E0D372D2A3D8B99B6068E24BBBDA8F0BCDDBA806010E4A7181736DF08D4D1CFC16E26507C360EDCBFF1B5F4288CE304DE62E9696665C5108489AD7232658356998FF47C4F7E8A04225423',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJGRgMJMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDQxETAPBgNVBAMMCDEwLjAuMC43MB4XDTE4MDMy\nMTAxNTUxNloXDTE4MDMyMjAxNTY1NlowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQD/bLUgJJfMd68o7953SFjk/vBDVeUijjeJYt9CNb42g9r544p+\nImIdZrO1AWbYl+l7+RH56PwJ1oaWGqOWeQFOXd0n6g8C3oU6QVN9teN/MzleJJ81\nXA0HRBlXLphW0dWYyrLNaVEBPdywoWO5Q9/NJpS+GLmziSaVswUuvZEV1EcpPIOv\nJKAIeUuELk8KbCqNAYlhKmAKpApZJgPkNxPA7MpoECTl7EKfrQlIS4JJGd9ZyL1I\njg03LSo9i5m2Bo4ku72o8LzduoBgEOSnGBc23wjU0c/BbiZQfDYO3L/xtfQojOME\n3mLpaWZlxRCEia1yMmWDVpmP9HxPfooEIlQjAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAJe4gcV0gxhx3i9/8mmGRxjw+DyeOLYk\nLdDGYSKkewMB5kt5+dO3FZvRXlWEqKnnsHWfDA30PSJx3a5KsJGDKmSCgD2lPHtp\n9NM9Lh3gdBrTYeX7f+ar4rSh10I4Zokx0jIFGoE3IbEIHQSC9Igj9NOYvHaqegZY\noJhsgCa52HjCEyLw9gaZ88wZ0kCpjruppwkN7e6lRnkjNJ53fzdAPRbEeACS0ISS\nbrw6vBCCOzsygupM335GwzwNs6Iom+U6LvWAEyvM2HOmzaUvqiXH3UYzmmxhTUYe\nZCxCKQtTO/bYMTVSjlIA7oZ0TWyuxv9nIc2k2fmuerLXe4/C0NsM2CU=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 2
to: 3
disconnected from auth
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth504',
     commonName: '10.0.0.7' },
  serial: '016246460309',
  notBefore: 2018-03-21T01:55:16.000Z,
  notAfter: 2018-03-22T01:56:56.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'AB:B4:22:6D:DC:14:27:9B:72:32:67:BA:1A:E8:82:A3:33:F0:33:71',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'FF6CB5202497CC77AF28EFDE774858E4FEF04355E5228E378962DF4235BE3683DAF9E38A7E22621D66B3B50166D897E97BF911F9E8FC09D686961AA39679014E5DDD27EA0F02DE853A41537DB5E37F33395E249F355C0D074419572E9856D1D598CAB2CD6951013DDCB0A163B943DFCD2694BE18B9B3892695B3052EBD9115D447293C83AF24A008794B842E4F0A6C2A8D0189612A600AA40A592603E43713C0ECCA681024E5EC429FAD09484B824919DF59C8BD488E0D372D2A3D8B99B6068E24BBBDA8F0BCDDBA806010E4A7181736DF08D4D1CFC16E26507C360EDCBFF1B5F4288CE304DE62E9696665C5108489AD7232658356998FF47C4F7E8A04225423',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.7',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJGRgMJMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDQxETAPBgNVBAMMCDEwLjAuMC43MB4XDTE4MDMy\nMTAxNTUxNloXDTE4MDMyMjAxNTY1NlowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQD/bLUgJJfMd68o7953SFjk/vBDVeUijjeJYt9CNb42g9r544p+\nImIdZrO1AWbYl+l7+RH56PwJ1oaWGqOWeQFOXd0n6g8C3oU6QVN9teN/MzleJJ81\nXA0HRBlXLphW0dWYyrLNaVEBPdywoWO5Q9/NJpS+GLmziSaVswUuvZEV1EcpPIOv\nJKAIeUuELk8KbCqNAYlhKmAKpApZJgPkNxPA7MpoECTl7EKfrQlIS4JJGd9ZyL1I\njg03LSo9i5m2Bo4ku72o8LzduoBgEOSnGBc23wjU0c/BbiZQfDYO3L/xtfQojOME\n3mLpaWZlxRCEia1yMmWDVpmP9HxPfooEIlQjAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAJe4gcV0gxhx3i9/8mmGRxjw+DyeOLYk\nLdDGYSKkewMB5kt5+dO3FZvRXlWEqKnnsHWfDA30PSJx3a5KsJGDKmSCgD2lPHtp\n9NM9Lh3gdBrTYeX7f+ar4rSh10I4Zokx0jIFGoE3IbEIHQSC9Igj9NOYvHaqegZY\noJhsgCa52HjCEyLw9gaZ88wZ0kCpjruppwkN7e6lRnkjNJ53fzdAPRbEeACS0ISS\nbrw6vBCCOzsygupM335GwzwNs6Iom+U6LvWAEyvM2HOmzaUvqiXH3UYzmmxhTUYe\nZCxCKQtTO/bYMTVSjlIA7oZ0TWyuxv9nIc2k2fmuerLXe4/C0NsM2CU=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 3
to: 0
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in server - details: Error occurred in migration request: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in server - details: Error occurred in migration request: Connection with Auth timed out...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100946
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200821
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 52026
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in server - details: Error occurred in migration request: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100959
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200836
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 52258
connected to auth! from local port 52260
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in server - details: Error occurred in migration request: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 3
Handler: Error in server - details: Error occurred in migration request: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100971
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200851
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in connection with Auth : authFailureCount: 6
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 42328
connected to auth! from local port 42330
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 62 a5 86 8a 40 98 8a 48> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth504',
     commonName: '10.0.0.7' },
  serial: '016246460309',
  notBefore: 2018-03-21T01:55:16.000Z,
  notAfter: 2018-03-22T01:56:56.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'AB:B4:22:6D:DC:14:27:9B:72:32:67:BA:1A:E8:82:A3:33:F0:33:71',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'FF6CB5202497CC77AF28EFDE774858E4FEF04355E5228E378962DF4235BE3683DAF9E38A7E22621D66B3B50166D897E97BF911F9E8FC09D686961AA39679014E5DDD27EA0F02DE853A41537DB5E37F33395E249F355C0D074419572E9856D1D598CAB2CD6951013DDCB0A163B943DFCD2694BE18B9B3892695B3052EBD9115D447293C83AF24A008794B842E4F0A6C2A8D0189612A600AA40A592603E43713C0ECCA681024E5EC429FAD09484B824919DF59C8BD488E0D372D2A3D8B99B6068E24BBBDA8F0BCDDBA806010E4A7181736DF08D4D1CFC16E26507C360EDCBFF1B5F4288CE304DE62E9696665C5108489AD7232658356998FF47C4F7E8A04225423',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJGRgMJMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDQxETAPBgNVBAMMCDEwLjAuMC43MB4XDTE4MDMy\nMTAxNTUxNloXDTE4MDMyMjAxNTY1NlowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQD/bLUgJJfMd68o7953SFjk/vBDVeUijjeJYt9CNb42g9r544p+\nImIdZrO1AWbYl+l7+RH56PwJ1oaWGqOWeQFOXd0n6g8C3oU6QVN9teN/MzleJJ81\nXA0HRBlXLphW0dWYyrLNaVEBPdywoWO5Q9/NJpS+GLmziSaVswUuvZEV1EcpPIOv\nJKAIeUuELk8KbCqNAYlhKmAKpApZJgPkNxPA7MpoECTl7EKfrQlIS4JJGd9ZyL1I\njg03LSo9i5m2Bo4ku72o8LzduoBgEOSnGBc23wjU0c/BbiZQfDYO3L/xtfQojOME\n3mLpaWZlxRCEia1yMmWDVpmP9HxPfooEIlQjAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAJe4gcV0gxhx3i9/8mmGRxjw+DyeOLYk\nLdDGYSKkewMB5kt5+dO3FZvRXlWEqKnnsHWfDA30PSJx3a5KsJGDKmSCgD2lPHtp\n9NM9Lh3gdBrTYeX7f+ar4rSh10I4Zokx0jIFGoE3IbEIHQSC9Igj9NOYvHaqegZY\noJhsgCa52HjCEyLw9gaZ88wZ0kCpjruppwkN7e6lRnkjNJ53fzdAPRbEeACS0ISS\nbrw6vBCCOzsygupM335GwzwNs6Iom+U6LvWAEyvM2HOmzaUvqiXH3UYzmmxhTUYe\nZCxCKQtTO/bYMTVSjlIA7oZ0TWyuxv9nIc2k2fmuerLXe4/C0NsM2CU=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 2
to: 3
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in server - details: Error occurred in migration request: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100984
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42534
received auth hello!
{ authId: 502, nonce: <Buffer 32 02 4a 84 84 20 d6 5f> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 08 56 66 78 e5 27 ae 76>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 3e 47 d5 d2 87 9d ed 8b b8 4e 34 76 1c 11 8d 72>,
  macKeyVal: <Buffer da f2 1b 77 f1 ab 6f f7 a7 e2 a9 61 f9 57 85 d3 0b 93 e7 d1 06 18 ee 0c 0d f9 63 af c1 5e 16 97>,
  absValidity: 2018-03-21T03:15:19.644Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5f 35 ac a6 b1 47 a8 b4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5f 35 ac a6 b1 47 a8 b4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.65:44120',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200865
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42552
received auth hello!
{ authId: 502, nonce: <Buffer 05 dc 20 9e 72 c3 70 03> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 26 69 b8 5c 6e d2 7e 17>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7e d9 17 c9 68 53 6a f8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 7e d9 17 c9 68 53 6a f8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.66:42698',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100997
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42744
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200878
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42762
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 1e 75 c4 ca 6e f7 b4 f6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e7 e7 d3 5f c6 05 5b 6e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer eb 7f c9 b9 4f 48 4d 01>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer eb 7f c9 b9 4f 48 4d 01> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.66:42908',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101009
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42940
received auth hello!
{ authId: 502, nonce: <Buffer ca 3c 6e 98 91 35 3c 06> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ba 74 4f d1 19 eb 53 11>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b0 e9 47 ba 62 b2 77 4e>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b0 e9 47 ba 62 b2 77 4e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 24,
  remoteAddress: '::ffff:10.0.1.65:44526',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 24 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 24 }
specified socketID: 24
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200889
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42958
received auth hello!
{ authId: 502, nonce: <Buffer d6 82 5b ae 01 9a 2f 88> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7e b9 b9 74 ae b2 25 d1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8c c2 aa b4 ef cf 52 42>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8c c2 aa b4 ef cf 52 42> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 25,
  remoteAddress: '::ffff:10.0.1.66:43104',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 25 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 25 }
specified socketID: 25
received auth hello!
{ authId: 502, nonce: <Buffer c4 fc 60 ea f7 a1 56 11> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: write after end
disconnected from auth
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #24 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101021
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43140
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #25 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200902
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43160
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 97 da 2c e3 f1 e3 2b 16> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e6 b5 c5 90 bd 7c f4 f0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 51 a6 41 96 38 f1 70 a0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 51 a6 41 96 38 f1 70 a0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 26,
  remoteAddress: '::ffff:10.0.1.66:43306',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 26 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 26 }
specified socketID: 26
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: Connection with Auth timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 22 06 2f d7 82 fa 73 c3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9a b9 76 52 83 ac ac 72>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f6 b1 53 07 56 03 d8 a7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f6 b1 53 07 56 03 d8 a7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 27,
  remoteAddress: '::ffff:10.0.1.65:44726',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 27 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 27 }
specified socketID: 27
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #27 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101033
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43348
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #26 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200919
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43436
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101046
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43554
received auth hello!
{ authId: 502, nonce: <Buffer 37 5b de e5 d0 72 cc ee> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 18 28 c0 80 04 a3 3e d2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d4 72 b0 a2 6a 30 1a 2b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer d4 72 b0 a2 6a 30 1a 2b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 28,
  remoteAddress: '::ffff:10.0.1.65:45140',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 28 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 28 }
specified socketID: 28
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902
            eventHandlers.onError('Error occurred in migration request: Disconnected from auth before getting migration response: ' + error);
                                                                                                                                      ^

ReferenceError: error is not defined
    at Socket.<anonymous> (/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902:135)
    at emitNone (events.js:91:20)
    at Socket.emit (events.js:188:7)
    at endReadableNT (_stream_readable.js:975:12)
    at _combinedTickCallback (internal/process/next_tick.js:80:11)
    at process._tickCallback (internal/process/next_tick.js:104:9)
