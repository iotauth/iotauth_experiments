changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c503.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c503',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 6c 69 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521597549477
connected to auth! from local port 42066
received auth hello!
{ authId: 501, nonce: <Buffer 6b 77 b7 c0 47 08 28 26> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 7a 32 c2 62 23 31 38 1f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 4d 2a 20 c5 41 2c d3 6d 75 bf 79 1a a5 f2 09 c3>,
  macKeyVal: <Buffer 7e 8f 8b ef 4f 54 f3 42 22 34 30 b9 ee 5a b7 2d fb 1c 4a 68 d0 61 06 b4 54 10 92 6e 8f 42 d3 c0>,
  absValidity: 2018-03-21T02:59:09.658Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100533,
  cipherKeyVal: <Buffer 27 8b 9b 22 9d 1d 3a 2d f3 39 ca a0 24 33 cf cb>,
  macKeyVal: <Buffer c7 51 c8 5c eb d9 d2 d6 6f 5a 83 20 2a b2 6c c7 a9 76 35 c8 fe 98 92 76 64 7b 02 38 b2 49 43 90>,
  absValidity: 2018-03-22T01:59:09.657Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50100533,
     cipherKeyVal: <Buffer 27 8b 9b 22 9d 1d 3a 2d f3 39 ca a0 24 33 cf cb>,
     macKeyVal: <Buffer c7 51 c8 5c eb d9 d2 d6 6f 5a 83 20 2a b2 6c c7 a9 76 35 c8 fe 98 92 76 64 7b 02 38 b2 49 43 90>,
     absValidity: 2018-03-22T01:59:09.657Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 27 e9 5d 86 d9 ea 72 10>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 01:59:10 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521597550612
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521597609534
connected to auth! from local port 42304
received auth hello!
{ authId: 501, nonce: <Buffer 75 e1 72 ca ff fb d7 f0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4e c0 df c9 d9 52 5a 2a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100541,
  cipherKeyVal: <Buffer 55 6a 98 6e 36 4d fe a9 69 53 9b 65 4c c5 df 7e>,
  macKeyVal: <Buffer 43 53 5c c5 02 71 b4 52 b5 a9 7c bb 3a eb c3 6e 12 f5 ab 66 25 4a 4b 84 7d 38 44 73 87 b6 97 2b>,
  absValidity: 2018-03-22T02:00:09.800Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50100541,
     cipherKeyVal: <Buffer 55 6a 98 6e 36 4d fe a9 69 53 9b 65 4c c5 df 7e>,
     macKeyVal: <Buffer 43 53 5c c5 02 71 b4 52 b5 a9 7c bb 3a eb c3 6e 12 f5 ab 66 25 4a 4b 84 7d 38 44 73 87 b6 97 2b>,
     absValidity: 2018-03-22T02:00:09.800Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 1c 37 7d c5 10 b7 a9 4c>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:00:10 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521597611052
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521597669592
connected to auth! from local port 42574
received auth hello!
{ authId: 501, nonce: <Buffer 1f ff 56 53 54 f1 b0 8b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 69 0e 6f 76 b9 8b ca 83>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100549,
  cipherKeyVal: <Buffer 4d a9 41 04 a4 4d 6a c8 12 b0 6c 7f e5 26 7d d8>,
  macKeyVal: <Buffer 44 23 cf 3a 98 fc ce 8b 5a b5 48 b6 23 d1 d0 4a 0a aa ef 55 a2 0e 0e 4b be f6 67 c3 46 31 c9 1d>,
  absValidity: 2018-03-22T02:01:09.774Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50100549,
     cipherKeyVal: <Buffer 4d a9 41 04 a4 4d 6a c8 12 b0 6c 7f e5 26 7d d8>,
     macKeyVal: <Buffer 44 23 cf 3a 98 fc ce 8b 5a b5 48 b6 23 d1 d0 4a 0a aa ef 55 a2 0e 0e 4b be f6 67 c3 46 31 c9 1d>,
     absValidity: 2018-03-22T02:01:09.774Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 7d fa bd b5 4a 9d 1a 2f>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:01:10 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521597671066
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521597729649
connected to auth! from local port 42844
received auth hello!
{ authId: 501, nonce: <Buffer 24 f6 0f a5 1f 8a cd e1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 71 e3 12 8d bc 37 68 4c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100557,
  cipherKeyVal: <Buffer cc 31 03 5f 53 94 ca cf 21 86 b0 00 2d 25 ff e5>,
  macKeyVal: <Buffer 50 52 79 b5 09 93 73 87 46 98 4d 2a 8b 63 53 75 f9 4e 83 25 8a 5a 5e 2d b0 a4 b6 d2 a8 d7 d9 48>,
  absValidity: 2018-03-22T02:02:09.869Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50100557,
     cipherKeyVal: <Buffer cc 31 03 5f 53 94 ca cf 21 86 b0 00 2d 25 ff e5>,
     macKeyVal: <Buffer 50 52 79 b5 09 93 73 87 46 98 4d 2a 8b 63 53 75 f9 4e 83 25 8a 5a 5e 2d b0 a4 b6 d2 a8 d7 d9 48>,
     absValidity: 2018-03-22T02:02:09.869Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 95 b4 19 4b 4f fa 39 0b>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:02:10 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521597731242
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521597789703
connected to auth! from local port 43114
received auth hello!
{ authId: 501, nonce: <Buffer b6 04 f4 74 83 01 97 8f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8d 03 8e 2a ec eb fa a7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100565,
  cipherKeyVal: <Buffer c7 68 da f7 cc a1 1f a5 3d d9 d3 42 2d 41 1e 7c>,
  macKeyVal: <Buffer 23 f3 f2 0b ee 39 42 fa fb ec a3 c9 c4 af 4b 04 be d2 cb c3 b2 99 0e 19 0b de d1 00 51 8e a2 77>,
  absValidity: 2018-03-22T02:03:09.960Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50100565,
     cipherKeyVal: <Buffer c7 68 da f7 cc a1 1f a5 3d d9 d3 42 2d 41 1e 7c>,
     macKeyVal: <Buffer 23 f3 f2 0b ee 39 42 fa fb ec a3 c9 c4 af 4b 04 be d2 cb c3 b2 99 0e 19 0b de d1 00 51 8e a2 77>,
     absValidity: 2018-03-22T02:03:09.960Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer fb 2e 21 e2 ba 95 5a f3>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:03:10 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521597791250
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521597849739
connected to auth! from local port 43384
received auth hello!
{ authId: 501, nonce: <Buffer d4 c4 86 ec fd ac a3 9f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cf 55 cb 07 5c 2c e9 6a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100573,
  cipherKeyVal: <Buffer 02 8d d8 a6 8f b6 36 82 b6 ce fc d6 6c ab 31 f0>,
  macKeyVal: <Buffer ae db 32 e5 2a c1 0c df 54 58 b3 e1 2b d7 58 76 28 0b 7d f1 78 49 a4 81 dd cc 58 3b e8 21 93 db>,
  absValidity: 2018-03-22T02:04:09.915Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50100573,
     cipherKeyVal: <Buffer 02 8d d8 a6 8f b6 36 82 b6 ce fc d6 6c ab 31 f0>,
     macKeyVal: <Buffer ae db 32 e5 2a c1 0c df 54 58 b3 e1 2b d7 58 76 28 0b 7d f1 78 49 a4 81 dd cc 58 3b e8 21 93 db>,
     absValidity: 2018-03-22T02:04:09.915Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer f4 47 3f ed 6c 38 cd 3e>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:04:10 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521597851155
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521597909797
connected to auth! from local port 43654
received auth hello!
{ authId: 501, nonce: <Buffer 45 9c 5d 1c a5 5b 8a 4d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 49 03 8c 8b 73 68 fb d9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100581,
  cipherKeyVal: <Buffer 45 81 b4 be f0 0a 36 70 fe 37 f0 da 8d f3 ef 3c>,
  macKeyVal: <Buffer e0 44 50 44 db 47 63 f8 64 01 c8 b4 76 9a 47 fc 12 9b e3 c8 16 72 00 38 9e 9d 3c 47 bd a4 0d 66>,
  absValidity: 2018-03-22T02:05:09.985Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50100581,
     cipherKeyVal: <Buffer 45 81 b4 be f0 0a 36 70 fe 37 f0 da 8d f3 ef 3c>,
     macKeyVal: <Buffer e0 44 50 44 db 47 63 f8 64 01 c8 b4 76 9a 47 fc 12 9b e3 c8 16 72 00 38 9e 9d 3c 47 bd a4 0d 66>,
     absValidity: 2018-03-22T02:05:09.985Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer c5 e7 1e 7d 2d 2c 26 87>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:05:10 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521597911274
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521597969798
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 9 0.7777777777777778 1521598029808
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 50430
received auth hello!
{ authId: 401, nonce: <Buffer 97 04 58 89 28 46 de f7> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 10 0.7 1521598089819
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 50648
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 11 0.6363636363636364 1521598149825
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 53092
received auth hello!
{ authId: 503, nonce: <Buffer 13 f8 f8 97 7f 1b 71 ce> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902
            eventHandlers.onError('Error occurred in migration request: Disconnected from auth before getting migration response: ' + error);
                                                                                                                                      ^

ReferenceError: error is not defined
    at Socket.<anonymous> (/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902:135)
    at emitNone (events.js:91:20)
    at Socket.emit (events.js:188:7)
    at endReadableNT (_stream_readable.js:975:12)
    at _combinedTickCallback (internal/process/next_tick.js:80:11)
    at process._tickCallback (internal/process/next_tick.js:104:9)
