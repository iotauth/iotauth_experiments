changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c412.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c412',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 31 7a ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521597516820
connected to auth! from local port 43862
received auth hello!
{ authId: 402, nonce: <Buffer f4 1e a7 5e 7a 31 21 01> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 3f d9 04 84 97 64 ee c5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 70 b9 d2 5a 70 34 61 86 05 ef 64 0b 67 52 5f cb>,
  macKeyVal: <Buffer ab 5f 1a 1f cc c0 d0 1e e5 c6 a3 a8 cd 6f 75 9c c9 8b 3b fb 9f 34 0d f9 d4 de 76 be 52 1f 35 27>,
  absValidity: 2018-03-21T02:58:37.827Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200311,
  cipherKeyVal: <Buffer 2c 87 4f 5d 08 de 74 60 a4 4b 4b 27 17 13 fd 6f>,
  macKeyVal: <Buffer 77 ea 86 85 3d d1 e2 af 72 81 93 89 4e 48 a0 a4 69 32 96 be 61 64 d0 9a e1 79 cf fd 9a 35 34 f5>,
  absValidity: 2018-03-22T01:58:37.826Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200311,
     cipherKeyVal: <Buffer 2c 87 4f 5d 08 de 74 60 a4 4b 4b 27 17 13 fd 6f>,
     macKeyVal: <Buffer 77 ea 86 85 3d d1 e2 af 72 81 93 89 4e 48 a0 a4 69 32 96 be 61 64 d0 9a e1 79 cf fd 9a 35 34 f5>,
     absValidity: 2018-03-22T01:58:37.826Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 34 32 c4 71 f1 16 27 29>
switching to HANDSHAKE_1_SENT
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 01:58:39 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521597520229
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521597576874
connected to auth! from local port 44042
received auth hello!
{ authId: 402, nonce: <Buffer fc 4e 48 f7 b2 cc bd 2e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ce 47 a8 b0 b6 b8 03 42>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200318,
  cipherKeyVal: <Buffer 60 59 5a 31 3b 2a f2 d6 8f f3 4d 5a 91 ca 6d c6>,
  macKeyVal: <Buffer 51 cb a8 11 13 da 7d 4b 0c 58 43 c5 2b 4e 0d 78 94 94 55 50 cb b5 33 a3 77 81 62 d9 d7 be 6e c3>,
  absValidity: 2018-03-22T01:59:37.867Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200318,
     cipherKeyVal: <Buffer 60 59 5a 31 3b 2a f2 d6 8f f3 4d 5a 91 ca 6d c6>,
     macKeyVal: <Buffer 51 cb a8 11 13 da 7d 4b 0c 58 43 c5 2b 4e 0d 78 94 94 55 50 cb b5 33 a3 77 81 62 d9 d7 be 6e c3>,
     absValidity: 2018-03-22T01:59:37.867Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 74 38 fb 7d d5 f3 2a 97>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 01:59:39 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521597580264
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521597636922
connected to auth! from local port 44314
received auth hello!
{ authId: 402, nonce: <Buffer 07 5e 14 55 0f 2b 46 ea> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 45 78 c8 5e 7e 78 b2 32>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200325,
  cipherKeyVal: <Buffer 74 76 26 39 ff 62 90 9e 5c d6 12 53 4e 02 eb 18>,
  macKeyVal: <Buffer fd 45 1b 4c d5 d7 bc 53 18 e0 de 69 cd c4 ff 21 18 3d 92 79 f4 d7 c7 39 e8 f8 46 ea 0a 6a 9d 51>,
  absValidity: 2018-03-22T02:00:37.905Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200325,
     cipherKeyVal: <Buffer 74 76 26 39 ff 62 90 9e 5c d6 12 53 4e 02 eb 18>,
     macKeyVal: <Buffer fd 45 1b 4c d5 d7 bc 53 18 e0 de 69 cd c4 ff 21 18 3d 92 79 f4 d7 c7 39 e8 f8 46 ea 0a 6a 9d 51>,
     absValidity: 2018-03-22T02:00:37.905Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 4e 10 0d 84 9e 5d 42 94>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:00:40 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521597640517
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521597696938
connected to auth! from local port 44584
received auth hello!
{ authId: 402, nonce: <Buffer e0 e8 0f 3e 83 bd 15 28> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e8 38 7c 16 10 de 72 87>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200332,
  cipherKeyVal: <Buffer 10 5a 0a 97 69 7e b6 93 de 86 0c 73 06 2c 7c 00>,
  macKeyVal: <Buffer 45 2e 3e 3e c3 a7 8e a3 39 47 06 fe 97 f2 62 4f 84 75 d5 79 66 c4 55 81 36 8b 64 69 59 98 07 ed>,
  absValidity: 2018-03-22T02:01:37.964Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200332,
     cipherKeyVal: <Buffer 10 5a 0a 97 69 7e b6 93 de 86 0c 73 06 2c 7c 00>,
     macKeyVal: <Buffer 45 2e 3e 3e c3 a7 8e a3 39 47 06 fe 97 f2 62 4f 84 75 d5 79 66 c4 55 81 36 8b 64 69 59 98 07 ed>,
     absValidity: 2018-03-22T02:01:37.964Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 27 34 7a 6e ae bb af 45>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:01:40 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521597700615
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521597756960
connected to auth! from local port 44854
received auth hello!
{ authId: 402, nonce: <Buffer 44 e5 76 8c 31 e4 91 ef> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b5 17 6d fb 10 5f 02 65>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200339,
  cipherKeyVal: <Buffer 8e 93 3a c8 e5 ef af 94 fc d0 a5 85 a7 e0 68 f8>,
  macKeyVal: <Buffer 3e f9 08 e7 5c ee bf 3b 83 48 4b 7d 05 2d 58 71 50 b6 16 a6 86 c9 4e a6 e7 03 46 de e3 ad e5 50>,
  absValidity: 2018-03-22T02:02:37.991Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200339,
     cipherKeyVal: <Buffer 8e 93 3a c8 e5 ef af 94 fc d0 a5 85 a7 e0 68 f8>,
     macKeyVal: <Buffer 3e f9 08 e7 5c ee bf 3b 83 48 4b 7d 05 2d 58 71 50 b6 16 a6 86 c9 4e a6 e7 03 46 de e3 ad e5 50>,
     absValidity: 2018-03-22T02:02:37.991Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer ff d0 93 48 8f 8c 4b 11>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:02:40 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521597760532
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521597817013
connected to auth! from local port 45124
received auth hello!
{ authId: 402, nonce: <Buffer 60 ba 35 2f 2d d6 64 48> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e8 0f f8 6a e1 4f 72 d6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200346,
  cipherKeyVal: <Buffer 6a c9 37 5b c3 58 15 61 9e 23 aa eb 1d 74 ed e5>,
  macKeyVal: <Buffer 50 35 0d 4c dd 49 74 b1 10 f2 e6 44 ec d3 92 f5 c1 0b 8d 2e 7c 6a 4b b2 63 9c 1a 28 ab fa bb ac>,
  absValidity: 2018-03-22T02:03:38.067Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200346,
     cipherKeyVal: <Buffer 6a c9 37 5b c3 58 15 61 9e 23 aa eb 1d 74 ed e5>,
     macKeyVal: <Buffer 50 35 0d 4c dd 49 74 b1 10 f2 e6 44 ec d3 92 f5 c1 0b 8d 2e 7c 6a 4b b2 63 9c 1a 28 ab fa bb ac>,
     absValidity: 2018-03-22T02:03:38.067Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 2e 11 15 44 c3 97 2a ff>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:03:40 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521597820615
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521597877062
connected to auth! from local port 45394
received auth hello!
{ authId: 402, nonce: <Buffer 1c 5a 96 60 54 32 fe 2b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 60 58 33 0b 8c ff 11 e2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200353,
  cipherKeyVal: <Buffer 89 d1 c6 ba 8b 32 92 20 17 3c 4b 42 64 7a 3d 50>,
  macKeyVal: <Buffer 3a d8 74 1c 5c 68 42 c6 3e aa 8c cb 4a 7c e4 9a 6d 81 b5 4b 15 70 1b 6a 89 32 67 b9 0d 10 2a ed>,
  absValidity: 2018-03-22T02:04:38.170Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200353,
     cipherKeyVal: <Buffer 89 d1 c6 ba 8b 32 92 20 17 3c 4b 42 64 7a 3d 50>,
     macKeyVal: <Buffer 3a d8 74 1c 5c 68 42 c6 3e aa 8c cb 4a 7c e4 9a 6d 81 b5 4b 15 70 1b 6a 89 32 67 b9 0d 10 2a ed>,
     absValidity: 2018-03-22T02:04:38.170Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 0a e0 eb 8d b7 2e 1b 34>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:04:40 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521597880773
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521597937064
connected to auth! from local port 45664
received auth hello!
{ authId: 402, nonce: <Buffer a6 da 3d f3 90 e0 4a 82> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 52 12 2a 24 63 ee 3a e9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200360,
  cipherKeyVal: <Buffer f9 d7 94 c2 e1 91 47 c1 f4 5a 88 28 d7 ed d4 c3>,
  macKeyVal: <Buffer 60 24 76 7f b3 55 37 3b d4 8b ac 58 ec 7c d1 d6 b3 91 0d 78 6d 39 81 53 66 26 ef 05 38 5e 35 6a>,
  absValidity: 2018-03-22T02:05:38.077Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200360,
     cipherKeyVal: <Buffer f9 d7 94 c2 e1 91 47 c1 f4 5a 88 28 d7 ed d4 c3>,
     macKeyVal: <Buffer 60 24 76 7f b3 55 37 3b d4 8b ac 58 ec 7c d1 d6 b3 91 0d 78 6d 39 81 53 66 26 ef 05 38 5e 35 6a>,
     absValidity: 2018-03-22T02:05:38.077Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer e5 cd b1 45 7e 04 0f 48>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.15:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 9 0.7777777777777778 1521597997073
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 10 0.7 1521598057083
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 56424
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 11 0.6363636363636364 1521598117090
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 56656
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 12 0.5833333333333334 1521598177097
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 47852
received auth hello!
{ authId: 502, nonce: <Buffer 42 d6 d6 c9 e2 49 70 b5> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902
            eventHandlers.onError('Error occurred in migration request: Disconnected from auth before getting migration response: ' + error);
                                                                                                                                      ^

ReferenceError: error is not defined
    at Socket.<anonymous> (/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902:135)
    at emitNone (events.js:91:20)
    at Socket.emit (events.js:188:7)
    at endReadableNT (_stream_readable.js:975:12)
    at _combinedTickCallback (internal/process/next_tick.js:80:11)
    at process._tickCallback (internal/process/next_tick.js:104:9)
