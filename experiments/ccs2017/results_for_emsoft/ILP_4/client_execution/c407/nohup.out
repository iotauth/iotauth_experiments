changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c407.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c407',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 75 4b ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521597500688
connected to auth! from local port 39244
received auth hello!
{ authId: 402, nonce: <Buffer a6 4a fc f9 d5 6d 46 15> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer c8 31 c2 d7 f7 4b c2 31>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 28 a5 3e 95 65 c3 c5 07 4f 26 14 22 7c 76 b9 c6>,
  macKeyVal: <Buffer 5f 69 27 56 84 f2 39 c1 f5 aa 13 40 db 6c 62 51 68 b4 55 fd ef 61 70 6d 2f 44 22 0e 74 14 6d 1f>,
  absValidity: 2018-03-21T02:58:20.863Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200306,
  cipherKeyVal: <Buffer 52 d8 38 da 82 2d 10 7c cc bc 6d b9 ef e9 99 27>,
  macKeyVal: <Buffer fc 6b 54 77 a1 62 98 00 a5 a8 3c b7 48 b5 60 3e 62 77 75 67 7a b8 13 74 75 e3 2d d4 6d bd 2a 1c>,
  absValidity: 2018-03-22T01:58:20.857Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200306,
     cipherKeyVal: <Buffer 52 d8 38 da 82 2d 10 7c cc bc 6d b9 ef e9 99 27>,
     macKeyVal: <Buffer fc 6b 54 77 a1 62 98 00 a5 a8 3c b7 48 b5 60 3e 62 77 75 67 7a b8 13 74 75 e3 2d d4 6d bd 2a 1c>,
     absValidity: 2018-03-22T01:58:20.857Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 61 10 77 b1 6b a5 7e ab>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 01:58:21 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521597501802
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521597560746
connected to auth! from local port 39394
received auth hello!
{ authId: 402, nonce: <Buffer 09 1a 79 af 30 80 b0 65> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer db a6 d9 07 dc 7b 12 79>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200313,
  cipherKeyVal: <Buffer df d5 2c ab 40 67 57 f5 cb e4 be b9 7a c7 39 11>,
  macKeyVal: <Buffer e8 0d 4c 1e 04 91 a9 e8 d6 04 d8 e6 4f 44 50 5d a5 57 42 e2 90 33 f6 c2 35 49 ed b4 06 27 86 17>,
  absValidity: 2018-03-22T01:59:20.893Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200313,
     cipherKeyVal: <Buffer df d5 2c ab 40 67 57 f5 cb e4 be b9 7a c7 39 11>,
     macKeyVal: <Buffer e8 0d 4c 1e 04 91 a9 e8 d6 04 d8 e6 4f 44 50 5d a5 57 42 e2 90 33 f6 c2 35 49 ed b4 06 27 86 17>,
     absValidity: 2018-03-22T01:59:20.893Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 93 66 de 25 00 da 48 54>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 01:59:21 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521597561837
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521597620791
connected to auth! from local port 39650
received auth hello!
{ authId: 402, nonce: <Buffer a5 ed 7f d1 1e bb 58 38> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 04 63 7b e5 49 c6 d3 20>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200320,
  cipherKeyVal: <Buffer 17 f2 e4 7d 1a 94 fa 09 4e 89 db 7e 8e 09 1c a5>,
  macKeyVal: <Buffer de 57 37 4a 94 cd 93 d5 be 57 da 0a d7 37 42 1a 78 80 81 29 07 c7 47 a6 c6 0d 7c 5e 0a 6f db 20>,
  absValidity: 2018-03-22T02:00:20.969Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200320,
     cipherKeyVal: <Buffer 17 f2 e4 7d 1a 94 fa 09 4e 89 db 7e 8e 09 1c a5>,
     macKeyVal: <Buffer de 57 37 4a 94 cd 93 d5 be 57 da 0a d7 37 42 1a 78 80 81 29 07 c7 47 a6 c6 0d 7c 5e 0a 6f db 20>,
     absValidity: 2018-03-22T02:00:20.969Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 3b 87 c7 a6 b6 c2 b4 77>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:00:21 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521597621878
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521597680849
connected to auth! from local port 39920
received auth hello!
{ authId: 402, nonce: <Buffer 5d 8f cd 3d 62 26 e8 75> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 02 39 c2 5c 5f d1 58 50>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200327,
  cipherKeyVal: <Buffer 28 53 ee 32 29 60 56 9d d0 34 4a 5c 09 0f 4c 3b>,
  macKeyVal: <Buffer 66 c4 88 1d b5 b0 ba b0 88 e8 1c 3f 45 a9 ab 50 9a be c1 b2 ab c8 56 e2 74 55 6d c8 3f cb 63 15>,
  absValidity: 2018-03-22T02:01:21.023Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200327,
     cipherKeyVal: <Buffer 28 53 ee 32 29 60 56 9d d0 34 4a 5c 09 0f 4c 3b>,
     macKeyVal: <Buffer 66 c4 88 1d b5 b0 ba b0 88 e8 1c 3f 45 a9 ab 50 9a be c1 b2 ab c8 56 e2 74 55 6d c8 3f cb 63 15>,
     absValidity: 2018-03-22T02:01:21.023Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 34 9e ea 31 c9 a3 45 07>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:01:21 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521597681817
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521597740905
connected to auth! from local port 40190
received auth hello!
{ authId: 402, nonce: <Buffer 21 a0 31 5d 68 46 e5 90> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f6 2e 27 e2 6f 5e 32 97>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200334,
  cipherKeyVal: <Buffer e0 41 78 ee de 74 56 6b e4 c2 97 32 c2 2f 1d bd>,
  macKeyVal: <Buffer 73 7a 83 34 68 69 45 0d 74 18 ec ea 0e 00 ed 3d d0 d5 2e 23 ff 69 47 21 59 fc 96 ad 1e 65 cf 09>,
  absValidity: 2018-03-22T02:02:21.060Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200334,
     cipherKeyVal: <Buffer e0 41 78 ee de 74 56 6b e4 c2 97 32 c2 2f 1d bd>,
     macKeyVal: <Buffer 73 7a 83 34 68 69 45 0d 74 18 ec ea 0e 00 ed 3d d0 d5 2e 23 ff 69 47 21 59 fc 96 ad 1e 65 cf 09>,
     absValidity: 2018-03-22T02:02:21.060Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 81 70 96 ae 39 35 5c c0>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:02:21 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521597742190
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521597800962
connected to auth! from local port 40460
received auth hello!
{ authId: 402, nonce: <Buffer ef b1 aa 3c 90 fc 27 45> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer de 85 d4 f3 2a b3 8a 9e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200341,
  cipherKeyVal: <Buffer 54 b4 36 b3 af 6a 64 a4 cb e6 ea b3 55 0d 0f 9d>,
  macKeyVal: <Buffer ec 07 ad 88 3d 35 61 33 e7 74 4c 29 fc 0c 3e fa a7 44 30 4a c2 cb ea 4c 09 5c 09 d2 ea 7a 93 09>,
  absValidity: 2018-03-22T02:03:21.123Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200341,
     cipherKeyVal: <Buffer 54 b4 36 b3 af 6a 64 a4 cb e6 ea b3 55 0d 0f 9d>,
     macKeyVal: <Buffer ec 07 ad 88 3d 35 61 33 e7 74 4c 29 fc 0c 3e fa a7 44 30 4a c2 cb ea 4c 09 5c 09 d2 ea 7a 93 09>,
     absValidity: 2018-03-22T02:03:21.123Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer fa 10 36 73 f9 39 c6 4c>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:03:21 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521597801972
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521597860977
connected to auth! from local port 40730
received auth hello!
{ authId: 402, nonce: <Buffer 57 ab f0 b6 c2 a3 5c 2a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fc 36 ef 4b 82 f1 82 e9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200348,
  cipherKeyVal: <Buffer f7 85 10 a3 bc 3d 46 9f 62 03 c5 a9 ec a5 08 34>,
  macKeyVal: <Buffer ac 5e d9 cb 9a df da 42 62 a2 ac 78 bd 9c 10 a1 56 85 08 8f c0 f7 a9 05 82 ab 86 66 f0 3b 19 e6>,
  absValidity: 2018-03-22T02:04:21.223Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200348,
     cipherKeyVal: <Buffer f7 85 10 a3 bc 3d 46 9f 62 03 c5 a9 ec a5 08 34>,
     macKeyVal: <Buffer ac 5e d9 cb 9a df da 42 62 a2 ac 78 bd 9c 10 a1 56 85 08 8f c0 f7 a9 05 82 ab 86 66 f0 3b 19 e6>,
     absValidity: 2018-03-22T02:04:21.223Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 43 dd 24 26 6b d6 94 1b>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:04:21 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521597862211
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521597920979
connected to auth! from local port 41000
received auth hello!
{ authId: 402, nonce: <Buffer 92 f0 70 9a 1e 99 97 f7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3e 08 39 e5 01 52 46 f4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200355,
  cipherKeyVal: <Buffer 23 13 bb 1d ec f6 f0 49 d3 1d be 3f 93 2b 91 06>,
  macKeyVal: <Buffer 04 a4 84 82 b4 48 13 c3 1c de 79 7b 86 5b 99 38 d8 7c 0b e3 7d 5e e4 34 82 f8 3a 3d e1 a6 c6 a5>,
  absValidity: 2018-03-22T02:05:21.131Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200355,
     cipherKeyVal: <Buffer 23 13 bb 1d ec f6 f0 49 d3 1d be 3f 93 2b 91 06>,
     macKeyVal: <Buffer 04 a4 84 82 b4 48 13 c3 1c de 79 7b 86 5b 99 38 d8 7c 0b e3 7d 5e e4 34 82 f8 3a 3d e1 a6 c6 a5>,
     absValidity: 2018-03-22T02:05:21.131Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer e8 fc 25 d2 51 77 1c de>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:05:21 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 8 1 1521597922095
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 9 0.8888888888888888 1521597981038
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 10 0.8 1521598041048
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.3:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 11 0.7272727272727273 1521598101056
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 33328
received auth hello!
{ authId: 502, nonce: <Buffer de 5f e1 f6 1b 65 03 a7> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 12 0.6666666666666666 1521598161067
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 33566
received auth hello!
{ authId: 502, nonce: <Buffer a3 01 23 eb 0c d2 2a 2c> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 13 0.6153846153846154 1521598221077
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 50770
received auth hello!
{ authId: 503, nonce: <Buffer 0f 29 37 90 5d b7 eb 4c> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth503',
     commonName: '10.0.1.6' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth402',
     commonName: '10.0.0.2' },
  serial: '01624645F814',
  notBefore: 2018-03-21T01:55:13.000Z,
  notAfter: 2018-03-22T01:56:53.000Z,
  subjectHash: '5542437f',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'F1:D7:C3:86:73:CE:D8:1D:E2:FF:04:33:0C:68:F2:0B:78:08:EB:85',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'BEF8F49475DE2A7247021F450606CD5891A65AED3D5B5352F639856656DABAB71FBB39B48DC0B2D02F476ECDDA817725D9247F8343EFA59CE3C8A1478669A0BBC7331BFA8CA47D0D8AF82267CED06E82D935EE41A36521595DE2E9C9282C6C4EE18E9EF871EB69AFA64DAF8AF9C918FF6EBDCE83735918F691FBA5D857D30199CC98C65973C1020FC538746EF90A2737A41391E8FFB49EFEDDB1B9899BB362DE128DF9797D19395ABA6F755427F4D2533E459F827BEFAB7F66A40D2E20A5261297BEA33E1532F5BC6F4F7AB69CBFFC885108509A63CB8EBD0F0FB315C71A59CD5995A1BE71E5570E2D3AA54A128F129827DA7DE4AAB6B1B12275D61933AA6811',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.6' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 503,
  host: '10.0.1.6',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJGRfgUMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDIxETAPBgNVBAMMCDEwLjAuMC4yMB4XDTE4MDMy\nMTAxNTUxM1oXDTE4MDMyMjAxNTY1M1owYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMzERMA8GA1UEAwwIMTAuMC4xLjYwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQC++PSUdd4qckcCH0UGBs1YkaZa7T1bU1L2OYVmVtq6tx+7ObSN\nwLLQL0duzdqBdyXZJH+DQ++lnOPIoUeGaaC7xzMb+oykfQ2K+CJnztBugtk17kGj\nZSFZXeLpySgsbE7hjp74cetpr6ZNr4r5yRj/br3Og3NZGPaR+6XYV9MBmcyYxllz\nwQIPxTh0bvkKJzekE5Ho/7Se/t2xuYmbs2LeEo35eX0ZOVq6b3VUJ/TSUz5Fn4J7\n76t/ZqQNLiClJhKXvqM+FTL1vG9Peracv/yIUQhQmmPLjr0PD7MVxxpZzVmVob5x\n5VcOLTqlShKPEpgn2n3kqraxsSJ11hkzqmgRAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQYwDQYJKoZIhvcNAQELBQADggEBAFJmAAUJ7ulHPHIapkKNUvjUj801jbm3\n6IJLjZCw02Gw/vi7YtYRVy+uF/hOaEyGwH7oy5jeYG5L+5kkwsLhUIPa0NTJ0Rg5\nS7KQk7By8Ek3vVpxeZrR5s8LvuMdRW1jZZTTTqhypu3cGEox/6vdYadA3UgSWGXK\nF3BSDBjA1N8nfeBonPyujsT3h0/ZOW59W+N0MzW65+20VVQzyzZO9xSQbAjUyxLl\nSOj3KHWFkgT7Slze43X5NFAVVgOoDVOlS8/jrDGxdKtymLz4NmCE6OHw/jSWsVwk\nvV1+FNH3nwo+vhGS+siwwwRgsd9a2qpeTs6x/4xwGxsomtgY8Vj+trQ=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 2
to: 3
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 14 0.5714285714285714 1521598281088
connected to auth! from local port 50966
received auth hello!
{ authId: 503, nonce: <Buffer a9 fa 3e 7d 2b 53 e8 53> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer a2 96 91 da 19 77 97 94>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 25 b2 f1 5d 74 85 b1 7b 5b 9f 5f 12 f1 c1 1d d3>,
  macKeyVal: <Buffer d6 47 19 ef 03 34 47 f1 5b 91 78 f5 00 d7 14 bd af 93 b3 ed 5d 95 41 fb 6b 66 d4 21 c4 36 1f 52>,
  absValidity: 2018-03-21T03:11:21.228Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300575,
  cipherKeyVal: <Buffer 4e a1 8f f2 83 a4 ce 66 97 f0 af a3 0f d2 cc 78>,
  macKeyVal: <Buffer 3d ec a0 40 f4 e7 cf d0 2d 8d cf 14 6f e2 b2 45 02 e5 dd d5 ac e3 89 78 ba 34 9b 34 df 44 71 be>,
  absValidity: 2018-03-22T02:11:21.227Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 50300575,
     cipherKeyVal: <Buffer 4e a1 8f f2 83 a4 ce 66 97 f0 af a3 0f d2 cc 78>,
     macKeyVal: <Buffer 3d ec a0 40 f4 e7 cf d0 2d 8d cf 14 6f e2 b2 45 02 e5 dd d5 ac e3 89 78 ba 34 9b 34 df 44 71 be>,
     absValidity: 2018-03-22T02:11:21.227Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 19 be 6f b5 88 d4 67 a8>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 15 0.5333333333333333 1521598341098
connected to auth! from local port 51194
received auth hello!
{ authId: 503, nonce: <Buffer ab bd ea 0a e0 df 0f 89> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 09 71 04 fe 38 b5 8b fe>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300583,
  cipherKeyVal: <Buffer 51 01 0b 10 aa b2 34 9d 2f ea 42 12 78 8d 53 bd>,
  macKeyVal: <Buffer 7f 0a a1 59 c1 e7 7a 6f 78 c8 b5 f2 cb 23 c0 b2 9b f7 1e 6c 22 0e 26 7e 70 ba 28 12 b2 dc b6 90>,
  absValidity: 2018-03-22T02:12:21.275Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 50300583,
     cipherKeyVal: <Buffer 51 01 0b 10 aa b2 34 9d 2f ea 42 12 78 8d 53 bd>,
     macKeyVal: <Buffer 7f 0a a1 59 c1 e7 7a 6f 78 c8 b5 f2 cb 23 c0 b2 9b f7 1e 6c 22 0e 26 7e 70 ba 28 12 b2 dc b6 90>,
     absValidity: 2018-03-22T02:12:21.275Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer ee 44 b2 61 da 6e 55 b3>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 16 0.5 1521598401105
connected to auth! from local port 51424
received auth hello!
{ authId: 503, nonce: <Buffer 05 2a 06 22 eb 2e 95 2c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bf 76 ec 10 fe 76 84 f0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300591,
  cipherKeyVal: <Buffer 10 61 e2 41 2f 85 90 cd 30 b5 c3 b5 81 7a f3 69>,
  macKeyVal: <Buffer e5 6e d9 ab 86 dc cd 52 70 ed e0 55 72 bd 3e 5e 1c fd f1 d1 f9 b9 3e e8 f6 99 9a 1e e7 5e 84 88>,
  absValidity: 2018-03-22T02:13:21.235Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 50300591,
     cipherKeyVal: <Buffer 10 61 e2 41 2f 85 90 cd 30 b5 c3 b5 81 7a f3 69>,
     macKeyVal: <Buffer e5 6e d9 ab 86 dc cd 52 70 ed e0 55 72 bd 3e 5e 1c fd f1 d1 f9 b9 3e e8 f6 99 9a 1e e7 5e 84 88>,
     absValidity: 2018-03-22T02:13:21.235Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 24 33 a7 b4 36 f7 92 0d>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 17 0.47058823529411764 1521598461116
connected to auth! from local port 51646
received auth hello!
{ authId: 503, nonce: <Buffer dd 3f 01 a0 9a 54 a4 8f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1e 8a da 8a 3d 4b 55 d1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300599,
  cipherKeyVal: <Buffer 01 e8 8b b4 02 cb 61 4b 25 81 9a c9 2c dc 6e 2a>,
  macKeyVal: <Buffer ba f2 cb b3 aa cd 96 97 e6 8c 19 9d d2 76 2b 06 5a 16 7c ec b0 71 bb 13 93 2e d6 29 0e 33 9c 4e>,
  absValidity: 2018-03-22T02:14:21.217Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 50300599,
     cipherKeyVal: <Buffer 01 e8 8b b4 02 cb 61 4b 25 81 9a c9 2c dc 6e 2a>,
     macKeyVal: <Buffer ba f2 cb b3 aa cd 96 97 e6 8c 19 9d d2 76 2b 06 5a 16 7c ec b0 71 bb 13 93 2e d6 29 0e 33 9c 4e>,
     absValidity: 2018-03-22T02:14:21.217Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer c7 9e 90 98 c2 83 65 7d>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 18 0.4444444444444444 1521598521127
connected to auth! from local port 51864
received auth hello!
{ authId: 503, nonce: <Buffer a9 8e c6 64 1a 90 dc 2e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d9 1e 31 7f b7 33 39 0b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300607,
  cipherKeyVal: <Buffer 3c 3a e0 5e 03 9d 52 c9 68 86 c9 2a 56 af a0 e1>,
  macKeyVal: <Buffer c8 e4 e1 4f ba 4c 22 05 dd 5a e0 9d 9d d3 53 5e 6d f6 31 31 12 8e 69 7e be c0 e3 a2 26 df 24 45>,
  absValidity: 2018-03-22T02:15:21.230Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 50300607,
     cipherKeyVal: <Buffer 3c 3a e0 5e 03 9d 52 c9 68 86 c9 2a 56 af a0 e1>,
     macKeyVal: <Buffer c8 e4 e1 4f ba 4c 22 05 dd 5a e0 9d 9d d3 53 5e 6d f6 31 31 12 8e 69 7e be c0 e3 a2 26 df 24 45>,
     absValidity: 2018-03-22T02:15:21.230Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer f9 e2 f9 50 6b a3 09 73>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 19 0.42105263157894735 1521598581134
connected to auth! from local port 52074
received auth hello!
{ authId: 503, nonce: <Buffer e8 90 02 31 f1 96 a5 e8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1e a5 f4 4c 05 7b 89 71>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300615,
  cipherKeyVal: <Buffer 3f a8 ab 26 b9 a0 17 d4 b4 36 d4 7f 3a 4d 89 ee>,
  macKeyVal: <Buffer 28 6f 25 7b 45 dd bd 4e 27 09 03 b1 0d 30 37 98 51 0b 4b e9 b4 1c 27 7c fd 55 1a f0 b5 5b a3 df>,
  absValidity: 2018-03-22T02:16:21.302Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 50300615,
     cipherKeyVal: <Buffer 3f a8 ab 26 b9 a0 17 d4 b4 36 d4 7f 3a 4d 89 ee>,
     macKeyVal: <Buffer 28 6f 25 7b 45 dd bd 4e 27 09 03 b1 0d 30 37 98 51 0b 4b e9 b4 1c 27 7c fd 55 1a f0 b5 5b a3 df>,
     absValidity: 2018-03-22T02:16:21.302Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 0a d0 29 d5 91 4f b7 bb>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 20 0.4 1521598641141
connected to auth! from local port 52270
received auth hello!
{ authId: 503, nonce: <Buffer 0a cc 7d a9 88 83 50 c5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c5 c4 fc af 73 99 63 53>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300623,
  cipherKeyVal: <Buffer 9d ef 72 b8 5a d2 06 12 4b db 46 ae c7 db f8 1a>,
  macKeyVal: <Buffer 33 51 03 5f 07 19 9d 04 52 56 26 1e ea af 9e ab 93 20 cf 6e b6 e0 13 66 ee 86 7d 79 18 94 0e 90>,
  absValidity: 2018-03-22T02:17:21.281Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 50300623,
     cipherKeyVal: <Buffer 9d ef 72 b8 5a d2 06 12 4b db 46 ae c7 db f8 1a>,
     macKeyVal: <Buffer 33 51 03 5f 07 19 9d 04 52 56 26 1e ea af 9e ab 93 20 cf 6e b6 e0 13 66 ee 86 7d 79 18 94 0e 90>,
     absValidity: 2018-03-22T02:17:21.281Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 6e a7 e9 ab 05 6d 20 9f>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 21 0.38095238095238093 1521598701152
connected to auth! from local port 52472
received auth hello!
{ authId: 503, nonce: <Buffer 4a a9 0b 8a b5 4e 66 5b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b7 07 be 23 07 fe 51 e6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300631,
  cipherKeyVal: <Buffer 5a 89 6d 42 51 09 fe 75 6c 0e 99 f9 a2 41 ba 76>,
  macKeyVal: <Buffer 78 00 45 76 00 5e 6e 1e 84 ae a6 f3 fc a2 92 50 d8 b2 a9 0a c3 d1 0e db 7c 5a cb 61 a3 6c 34 44>,
  absValidity: 2018-03-22T02:18:21.298Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 50300631,
     cipherKeyVal: <Buffer 5a 89 6d 42 51 09 fe 75 6c 0e 99 f9 a2 41 ba 76>,
     macKeyVal: <Buffer 78 00 45 76 00 5e 6e 1e 84 ae a6 f3 fc a2 92 50 d8 b2 a9 0a c3 d1 0e db 7c 5a cb 61 a3 6c 34 44>,
     absValidity: 2018-03-22T02:18:21.298Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer bb dc 02 35 b2 41 f9 38>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 22 0.36363636363636365 1521598761161
connected to auth! from local port 52676
received auth hello!
{ authId: 503, nonce: <Buffer 41 85 9e 3b a7 ed 1c d6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b9 b9 d7 07 c7 95 0b 03>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300639,
  cipherKeyVal: <Buffer 48 a2 47 8c ed e9 f4 f5 ca b6 de c8 76 29 78 42>,
  macKeyVal: <Buffer 1a 7e c3 64 71 25 f7 07 e9 c0 37 c8 0b 5f c9 08 e4 c2 68 08 26 0c 06 0f 0f 9c fc 2d e7 15 6c 90>,
  absValidity: 2018-03-22T02:19:21.461Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 50300639,
     cipherKeyVal: <Buffer 48 a2 47 8c ed e9 f4 f5 ca b6 de c8 76 29 78 42>,
     macKeyVal: <Buffer 1a 7e c3 64 71 25 f7 07 e9 c0 37 c8 0b 5f c9 08 e4 c2 68 08 26 0c 06 0f 0f 9c fc 2d e7 15 6c 90>,
     absValidity: 2018-03-22T02:19:21.461Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 87 dc 6c a3 28 d1 04 c0>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 23 0.34782608695652173 1521598821171
connected to auth! from local port 52880
received auth hello!
{ authId: 503, nonce: <Buffer 49 e3 86 6b 64 92 59 65> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f7 b5 b7 4a df af 3f 08>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300647,
  cipherKeyVal: <Buffer 97 e0 be 8f 2b 4b 84 a1 49 8b 95 10 95 96 2e f5>,
  macKeyVal: <Buffer 95 5c 45 42 f1 6c cf e5 b2 22 70 61 fe f4 f9 cd 7e 1f 68 21 3e 55 79 1e 48 3c 74 7f ae 68 97 14>,
  absValidity: 2018-03-22T02:20:21.341Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 50300647,
     cipherKeyVal: <Buffer 97 e0 be 8f 2b 4b 84 a1 49 8b 95 10 95 96 2e f5>,
     macKeyVal: <Buffer 95 5c 45 42 f1 6c cf e5 b2 22 70 61 fe f4 f9 cd 7e 1f 68 21 3e 55 79 1e 48 3c 74 7f ae 68 97 14>,
     absValidity: 2018-03-22T02:20:21.341Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 6c bb 0a b1 ef ed c2 6d>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 24 0.3333333333333333 1521598881177
connected to auth! from local port 53078
received auth hello!
{ authId: 503, nonce: <Buffer 06 c5 e9 9d 97 73 26 49> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5d d2 e5 4e a5 84 e3 4f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300655,
  cipherKeyVal: <Buffer 7d 0a bf 0b d5 ab 6d 84 6d 7d bd 0c 3e 1e 3b 0d>,
  macKeyVal: <Buffer d8 ea 06 32 e1 fc 3e b1 bf 9d 89 a0 39 72 33 04 21 4e 01 c4 8a 74 e7 37 40 f5 d5 1e dd 45 29 3c>,
  absValidity: 2018-03-22T02:21:21.355Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 50300655,
     cipherKeyVal: <Buffer 7d 0a bf 0b d5 ab 6d 84 6d 7d bd 0c 3e 1e 3b 0d>,
     macKeyVal: <Buffer d8 ea 06 32 e1 fc 3e b1 bf 9d 89 a0 39 72 33 04 21 4e 01 c4 8a 74 e7 37 40 f5 d5 1e dd 45 29 3c>,
     absValidity: 2018-03-22T02:21:21.355Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.12:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 25 0.32 1521598941237
connected to auth! from local port 53250
received auth hello!
{ authId: 503, nonce: <Buffer ef 14 c0 04 39 34 1c 1c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7e 61 47 b8 15 80 0e 56>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300663,
  cipherKeyVal: <Buffer 51 41 c4 5f e5 3d 8c b6 c0 e4 84 de 98 db d0 d8>,
  macKeyVal: <Buffer 06 fc 78 0d 68 db b5 15 ac 32 d9 ef 27 2d 71 84 84 90 98 d7 30 07 2e 02 d1 22 5a ae f5 35 d6 a7>,
  absValidity: 2018-03-22T02:22:21.398Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 50300663,
     cipherKeyVal: <Buffer 51 41 c4 5f e5 3d 8c b6 c0 e4 84 de 98 db d0 d8>,
     macKeyVal: <Buffer 06 fc 78 0d 68 db b5 15 ac 32 d9 ef 27 2d 71 84 84 90 98 d7 30 07 2e 02 d1 22 5a ae f5 35 d6 a7>,
     absValidity: 2018-03-22T02:22:21.398Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.12:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 26 0.3076923076923077 1521599001297
connected to auth! from local port 53440
received auth hello!
{ authId: 503, nonce: <Buffer 46 c8 c2 7b 80 1e 24 0e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e8 af be 9f 50 80 37 ba>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300671,
  cipherKeyVal: <Buffer 8f 22 98 86 34 24 3f 23 25 44 cb ea 59 40 ca ae>,
  macKeyVal: <Buffer 12 ba 55 17 03 db 47 fe 95 1a 78 e3 46 fc cf 91 e6 8e 21 23 02 68 39 19 0f 24 00 f6 11 e9 0a 0b>,
  absValidity: 2018-03-22T02:23:21.452Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 50300671,
     cipherKeyVal: <Buffer 8f 22 98 86 34 24 3f 23 25 44 cb ea 59 40 ca ae>,
     macKeyVal: <Buffer 12 ba 55 17 03 db 47 fe 95 1a 78 e3 46 fc cf 91 e6 8e 21 23 02 68 39 19 0f 24 00 f6 11 e9 0a 0b>,
     absValidity: 2018-03-22T02:23:21.452Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.12:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 27 0.2962962962962963 1521599061353
connected to auth! from local port 53634
received auth hello!
{ authId: 503, nonce: <Buffer f0 a8 4c 5f 9e 89 13 25> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a1 fb bf c8 fe af 83 e6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300679,
  cipherKeyVal: <Buffer f1 ba d3 04 e1 c6 22 69 4f e2 61 ed 0a 3a 2d 83>,
  macKeyVal: <Buffer f6 75 17 40 d9 12 1e 8c 6d bd 9e 2a 75 85 f4 32 f3 1f c2 d0 3d c0 c1 a9 54 18 b2 55 1d 3c 48 59>,
  absValidity: 2018-03-22T02:24:21.487Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 50300679,
     cipherKeyVal: <Buffer f1 ba d3 04 e1 c6 22 69 4f e2 61 ed 0a 3a 2d 83>,
     macKeyVal: <Buffer f6 75 17 40 d9 12 1e 8c 6d bd 9e 2a 75 85 f4 32 f3 1f c2 d0 3d c0 c1 a9 54 18 b2 55 1d 3c 48 59>,
     absValidity: 2018-03-22T02:24:21.487Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.12:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 28 0.2857142857142857 1521599121413
connected to auth! from local port 53830
received auth hello!
{ authId: 503, nonce: <Buffer e0 51 d1 b7 07 6c eb 7c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 73 95 a4 7f 8b 8f fa a2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300687,
  cipherKeyVal: <Buffer 9a 2e ff 2d 4f 0e 1a 78 80 73 ce b2 6c a7 03 8b>,
  macKeyVal: <Buffer 47 1e 27 a0 1c 6e 08 8f 64 62 3d 83 06 22 a3 ff c5 c6 53 77 43 b5 3c 68 27 f8 b4 4a b6 17 55 a7>,
  absValidity: 2018-03-22T02:25:21.571Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 50300687,
     cipherKeyVal: <Buffer 9a 2e ff 2d 4f 0e 1a 78 80 73 ce b2 6c a7 03 8b>,
     macKeyVal: <Buffer 47 1e 27 a0 1c 6e 08 8f 64 62 3d 83 06 22 a3 ff c5 c6 53 77 43 b5 3c 68 27 f8 b4 4a b6 17 55 a7>,
     absValidity: 2018-03-22T02:25:21.571Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.12:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 29 0.27586206896551724 1521599181473
connected to auth! from local port 54010
received auth hello!
{ authId: 503, nonce: <Buffer a1 fd 6f db 89 2f bc 6f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 93 5f 65 12 7c 44 a5 a4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300695,
  cipherKeyVal: <Buffer e8 92 9f b1 78 f8 88 cc be 8c 33 d4 92 2e 03 c3>,
  macKeyVal: <Buffer e1 fa 55 48 3d 01 8c 6f 36 4e 57 c9 b5 02 d3 5b 00 76 df 16 37 d3 ec 68 54 84 e1 e7 da 52 d6 e3>,
  absValidity: 2018-03-22T02:26:21.651Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 50300695,
     cipherKeyVal: <Buffer e8 92 9f b1 78 f8 88 cc be 8c 33 d4 92 2e 03 c3>,
     macKeyVal: <Buffer e1 fa 55 48 3d 01 8c 6f 36 4e 57 c9 b5 02 d3 5b 00 76 df 16 37 d3 ec 68 54 84 e1 e7 da 52 d6 e3>,
     absValidity: 2018-03-22T02:26:21.651Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.12:22100
disconnected from auth
