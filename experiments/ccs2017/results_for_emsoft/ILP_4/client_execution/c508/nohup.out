changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c508.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c508',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 35 31 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521597565990
connected to auth! from local port 45154
received auth hello!
{ authId: 501, nonce: <Buffer b0 21 d4 04 28 35 1b cd> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer f4 c3 d3 fa 64 5c e6 04>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 1f 18 bc ab 4d a0 6c 3b 9f af b6 5d ed b3 78 c9>,
  macKeyVal: <Buffer fa 70 2b 55 9d 0c e6 51 47 92 49 7d ac 2f 43 0c 87 f2 3c 36 f8 bb c3 2b 94 2c be 77 ed b1 ff 63>,
  absValidity: 2018-03-21T02:59:26.171Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100536,
  cipherKeyVal: <Buffer 88 3a 18 b9 00 65 d6 90 09 30 01 ee 19 1d b7 c0>,
  macKeyVal: <Buffer 1d 23 d0 4e b7 b2 9d ef 14 b3 34 03 2f e3 f5 41 f6 9b c4 af 78 03 57 59 2e 38 24 c5 5e 13 01 7b>,
  absValidity: 2018-03-22T01:59:26.170Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100536,
     cipherKeyVal: <Buffer 88 3a 18 b9 00 65 d6 90 09 30 01 ee 19 1d b7 c0>,
     macKeyVal: <Buffer 1d 23 d0 4e b7 b2 9d ef 14 b3 34 03 2f e3 f5 41 f6 9b c4 af 78 03 57 59 2e 38 24 c5 5e 13 01 7b>,
     absValidity: 2018-03-22T01:59:26.170Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer c4 a6 7c 3c 14 7f 08 73>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 01:59:26 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521597567031
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521597626046
connected to auth! from local port 45418
received auth hello!
{ authId: 501, nonce: <Buffer 38 26 ec ca 20 d3 e9 1d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2c 9c 2e 77 2e a8 52 cf>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100544,
  cipherKeyVal: <Buffer b0 39 5e 2d 41 7a 5d 49 43 d1 fa 8a 34 40 66 55>,
  macKeyVal: <Buffer 4b 14 17 64 f4 3a 72 1a 17 80 97 32 a8 8d 7e 11 9e 4f a1 45 92 7d f4 d2 b2 b0 77 bc 16 eb 9a 9c>,
  absValidity: 2018-03-22T02:00:26.332Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100544,
     cipherKeyVal: <Buffer b0 39 5e 2d 41 7a 5d 49 43 d1 fa 8a 34 40 66 55>,
     macKeyVal: <Buffer 4b 14 17 64 f4 3a 72 1a 17 80 97 32 a8 8d 7e 11 9e 4f a1 45 92 7d f4 d2 b2 b0 77 bc 16 eb 9a 9c>,
     absValidity: 2018-03-22T02:00:26.332Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 07 b8 7f 41 a0 f1 87 23>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:00:27 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521597627486
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521597686101
connected to auth! from local port 45690
received auth hello!
{ authId: 501, nonce: <Buffer 91 f3 5f a1 76 e6 41 98> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ff 79 3e 04 12 3a 29 06>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100552,
  cipherKeyVal: <Buffer e8 f9 85 95 be c1 b4 a2 35 2c bd 06 a2 b2 de 4a>,
  macKeyVal: <Buffer ef b8 9d d8 7a 37 c7 f7 61 64 4c 33 35 01 fe 5b f2 5d 27 38 65 0d 91 96 41 12 d8 44 4e 8f c1 db>,
  absValidity: 2018-03-22T02:01:26.305Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100552,
     cipherKeyVal: <Buffer e8 f9 85 95 be c1 b4 a2 35 2c bd 06 a2 b2 de 4a>,
     macKeyVal: <Buffer ef b8 9d d8 7a 37 c7 f7 61 64 4c 33 35 01 fe 5b f2 5d 27 38 65 0d 91 96 41 12 d8 44 4e 8f c1 db>,
     absValidity: 2018-03-22T02:01:26.305Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 13 51 bb a6 3e 8b fc 94>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:01:27 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521597687587
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521597746157
connected to auth! from local port 45960
received auth hello!
{ authId: 501, nonce: <Buffer b2 08 f6 b5 42 4a 25 29> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 85 56 73 9d 17 11 9c 5e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100560,
  cipherKeyVal: <Buffer e2 c5 b7 d6 b2 b1 90 b7 6e 4e f9 b5 25 41 91 05>,
  macKeyVal: <Buffer 79 93 89 4c 7e 3b fd e0 28 2b 19 80 8f bc 02 f9 40 10 74 ef 96 57 a1 7a ba 21 be 60 fb 24 fc 4e>,
  absValidity: 2018-03-22T02:02:26.433Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100560,
     cipherKeyVal: <Buffer e2 c5 b7 d6 b2 b1 90 b7 6e 4e f9 b5 25 41 91 05>,
     macKeyVal: <Buffer 79 93 89 4c 7e 3b fd e0 28 2b 19 80 8f bc 02 f9 40 10 74 ef 96 57 a1 7a ba 21 be 60 fb 24 fc 4e>,
     absValidity: 2018-03-22T02:02:26.433Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer e3 4e f9 10 70 5d 22 c7>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:02:27 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521597747276
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521597806217
connected to auth! from local port 46230
received auth hello!
{ authId: 501, nonce: <Buffer ed af 89 4c f8 a1 c8 eb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 48 72 1c 56 19 ce e2 fc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100568,
  cipherKeyVal: <Buffer 38 d5 8d 60 1c 32 51 6f 2e e7 92 80 03 40 12 41>,
  macKeyVal: <Buffer cc ef fb ed 43 48 c1 5c a8 7f b1 1b 63 67 09 7f 6d e5 45 e7 fe 4f 90 ba 28 c6 cf 89 5f f4 26 2e>,
  absValidity: 2018-03-22T02:03:26.430Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100568,
     cipherKeyVal: <Buffer 38 d5 8d 60 1c 32 51 6f 2e e7 92 80 03 40 12 41>,
     macKeyVal: <Buffer cc ef fb ed 43 48 c1 5c a8 7f b1 1b 63 67 09 7f 6d e5 45 e7 fe 4f 90 ba 28 c6 cf 89 5f f4 26 2e>,
     absValidity: 2018-03-22T02:03:26.430Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer c4 60 5e ec e6 c1 f0 13>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:03:27 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521597807656
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521597866277
connected to auth! from local port 46498
received auth hello!
{ authId: 501, nonce: <Buffer f7 27 6a 2b 4a 4f dd df> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 76 93 49 5d 11 ab c5 e1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100576,
  cipherKeyVal: <Buffer 48 1e 27 8c df cd 5a 9d fb c5 15 0d d9 35 be de>,
  macKeyVal: <Buffer bc 66 a5 59 ea 22 1d ad bf b3 a2 43 6b 46 14 de 6c 7a 09 eb 9b 31 65 7d 7a 20 46 6b 55 83 c7 18>,
  absValidity: 2018-03-22T02:04:26.501Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100576,
     cipherKeyVal: <Buffer 48 1e 27 8c df cd 5a 9d fb c5 15 0d d9 35 be de>,
     macKeyVal: <Buffer bc 66 a5 59 ea 22 1d ad bf b3 a2 43 6b 46 14 de 6c 7a 09 eb 9b 31 65 7d 7a 20 46 6b 55 83 c7 18>,
     absValidity: 2018-03-22T02:04:26.501Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer fd 96 30 0e 4a 49 63 01>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:04:27 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521597867673
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521597926297
connected to auth! from local port 46770
received auth hello!
{ authId: 501, nonce: <Buffer 54 fa 11 42 25 a5 1f bc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cb 84 cf 48 e6 35 03 be>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100584,
  cipherKeyVal: <Buffer ca 06 af a9 59 30 73 42 0e ce ea 54 bb 84 8d 0a>,
  macKeyVal: <Buffer d8 5c f5 1d d3 f5 66 e6 f0 6c 9f ae 1d f8 73 ae 36 f1 13 cf 05 04 1b 83 26 36 89 82 ce 85 20 dc>,
  absValidity: 2018-03-22T02:05:26.520Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100584,
     cipherKeyVal: <Buffer ca 06 af a9 59 30 73 42 0e ce ea 54 bb 84 8d 0a>,
     macKeyVal: <Buffer d8 5c f5 1d d3 f5 66 e6 f0 6c 9f ae 1d f8 73 ae 36 f1 13 cf 05 04 1b 83 26 36 89 82 ce 85 20 dc>,
     absValidity: 2018-03-22T02:05:26.520Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 28 5d 5b 9c c5 46 3b 06>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:05:27 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521597927583
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521597986357
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 9 0.7777777777777778 1521598046366
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 32920
received auth hello!
{ authId: 503, nonce: <Buffer f1 ee ca 7c f6 b8 0f 5d> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 10 0.7 1521598106376
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 33150
received auth hello!
{ authId: 503, nonce: <Buffer f2 38 ce 29 a0 1b 5c 92> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 11 0.6363636363636364 1521598166387
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 52310
received auth hello!
{ authId: 502, nonce: <Buffer 21 b3 05 da 81 b2 23 09> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '01624645FAB9',
  notBefore: 2018-03-21T01:55:14.000Z,
  notAfter: 2018-03-22T01:56:54.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '2E:C0:89:B5:17:EF:3A:05:8F:67:B9:FE:AA:B3:DE:73:47:D9:C8:CC',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'FF6CB5202497CC77AF28EFDE774858E4FEF04355E5228E378962DF4235BE3683DAF9E38A7E22621D66B3B50166D897E97BF911F9E8FC09D686961AA39679014E5DDD27EA0F02DE853A41537DB5E37F33395E249F355C0D074419572E9856D1D598CAB2CD6951013DDCB0A163B943DFCD2694BE18B9B3892695B3052EBD9115D447293C83AF24A008794B842E4F0A6C2A8D0189612A600AA40A592603E43713C0ECCA681024E5EC429FAD09484B824919DF59C8BD488E0D372D2A3D8B99B6068E24BBBDA8F0BCDDBA806010E4A7181736DF08D4D1CFC16E26507C360EDCBFF1B5F4288CE304DE62E9696665C5108489AD7232658356998FF47C4F7E8A04225423',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJGRfq5MA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDMy\nMTAxNTUxNFoXDTE4MDMyMjAxNTY1NFowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQD/bLUgJJfMd68o7953SFjk/vBDVeUijjeJYt9CNb42g9r544p+\nImIdZrO1AWbYl+l7+RH56PwJ1oaWGqOWeQFOXd0n6g8C3oU6QVN9teN/MzleJJ81\nXA0HRBlXLphW0dWYyrLNaVEBPdywoWO5Q9/NJpS+GLmziSaVswUuvZEV1EcpPIOv\nJKAIeUuELk8KbCqNAYlhKmAKpApZJgPkNxPA7MpoECTl7EKfrQlIS4JJGd9ZyL1I\njg03LSo9i5m2Bo4ku72o8LzduoBgEOSnGBc23wjU0c/BbiZQfDYO3L/xtfQojOME\n3mLpaWZlxRCEia1yMmWDVpmP9HxPfooEIlQjAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAJtn2soSweKqNdCE0rJBsO8oTEnmF8hO\n4ZUxr8YZVwzfcbTRhi3zT6QRSkycbmuAixrS1pb2vtd7yhu+ZtKotzfe5cYAr7Dn\nTnaXJ58Yw6nr15yEX9JVmva4bxtiU3Zowv3x9ySJ3SWmBPR609MPB/V+n7+Ayna/\nfsCTqShchjmVZyfCTs5TjcTqsJLZhKfXKrDyZaMhSDkvCvVkOWBMptSFmncis3m3\ncfq9J9miuSmhMMWN0saQpvSxvNlDZ0b0nYW2i2WHQaxO8UslsZCNRt6NDLi46WK6\nyhm9I4P3rehTQZEq2b8y+WwUkOuEFf0TdgUrPmFPzxGqf2Jr5ysChNg=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 1
to: 2
disconnected from auth
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 12 0.5833333333333334 1521598226397
connected to auth! from local port 52544
received auth hello!
{ authId: 502, nonce: <Buffer 38 41 79 15 05 d4 dd 6a> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 38 53 c8 78 48 92 93 e0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 4f 5f 46 da 30 57 40 d7 6c d4 e4 62 03 2e bc f9>,
  macKeyVal: <Buffer e2 95 fa 91 c0 a3 db 51 15 22 d5 39 0a 38 da f1 e1 6c 44 03 a6 52 7b ed c5 8e c0 34 3a 5a 05 52>,
  absValidity: 2018-03-21T03:10:26.651Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200795,
  cipherKeyVal: <Buffer ba b4 76 4e b4 90 9b 20 a3 c4 dc b6 f1 27 b7 df>,
  macKeyVal: <Buffer b3 03 a8 d0 41 71 6b eb e5 d5 4e 3e 46 ac cb aa d4 72 0f b5 4d ba 64 82 5a 63 4a 34 ac da e4 95>,
  absValidity: 2018-03-22T02:10:26.651Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200795,
     cipherKeyVal: <Buffer ba b4 76 4e b4 90 9b 20 a3 c4 dc b6 f1 27 b7 df>,
     macKeyVal: <Buffer b3 03 a8 d0 41 71 6b eb e5 d5 4e 3e 46 ac cb aa d4 72 0f b5 4d ba 64 82 5a 63 4a 34 ac da e4 95>,
     absValidity: 2018-03-22T02:10:26.651Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 13 0.5384615384615384 1521598286456
connected to auth! from local port 52758
received auth hello!
{ authId: 502, nonce: <Buffer 95 fb 55 eb bd db 81 88> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b1 47 38 d1 39 73 e0 a5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200809,
  cipherKeyVal: <Buffer 5b d4 a5 aa b7 3c fe 42 1f 92 53 fd 73 38 a0 16>,
  macKeyVal: <Buffer e9 5f da 55 c7 e2 07 da cf ad 80 60 79 30 b7 56 8a 0e d7 f9 47 b3 6e 97 c7 91 4c 4f 25 6b b1 e0>,
  absValidity: 2018-03-22T02:11:26.684Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200809,
     cipherKeyVal: <Buffer 5b d4 a5 aa b7 3c fe 42 1f 92 53 fd 73 38 a0 16>,
     macKeyVal: <Buffer e9 5f da 55 c7 e2 07 da cf ad 80 60 79 30 b7 56 8a 0e d7 f9 47 b3 6e 97 c7 91 4c 4f 25 6b b1 e0>,
     absValidity: 2018-03-22T02:11:26.684Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 14 0.5 1521598346504
connected to auth! from local port 52984
received auth hello!
{ authId: 502, nonce: <Buffer 28 42 7a 29 eb d6 6a 6f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 45 df 7c 87 ee e3 ae 54>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200824,
  cipherKeyVal: <Buffer ff 5e 14 cd f3 f2 ab 71 13 14 9f 43 4b a2 f5 69>,
  macKeyVal: <Buffer 0c 62 07 89 27 09 48 1c 90 f2 ae b0 3d 32 7e ba 7e c4 85 1b f6 d6 1f 26 85 7f d9 c9 6a 32 bf d7>,
  absValidity: 2018-03-22T02:12:26.690Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200824,
     cipherKeyVal: <Buffer ff 5e 14 cd f3 f2 ab 71 13 14 9f 43 4b a2 f5 69>,
     macKeyVal: <Buffer 0c 62 07 89 27 09 48 1c 90 f2 ae b0 3d 32 7e ba 7e c4 85 1b f6 d6 1f 26 85 7f d9 c9 6a 32 bf d7>,
     absValidity: 2018-03-22T02:12:26.690Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 15 0.4666666666666667 1521598406563
connected to auth! from local port 53218
received auth hello!
{ authId: 502, nonce: <Buffer 4e bb 09 c1 81 9a dc 3e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0d 40 05 ae 71 b0 45 b9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200839,
  cipherKeyVal: <Buffer 66 9d ee 44 40 21 e6 fe 82 ac 6a 80 28 fe 6f b2>,
  macKeyVal: <Buffer 2a f3 6e 1a 1e 62 74 a6 07 59 f8 b4 4d a0 ad 49 f3 1f 53 21 88 bd 76 eb 1d 35 d3 99 2f e2 23 6b>,
  absValidity: 2018-03-22T02:13:26.758Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200839,
     cipherKeyVal: <Buffer 66 9d ee 44 40 21 e6 fe 82 ac 6a 80 28 fe 6f b2>,
     macKeyVal: <Buffer 2a f3 6e 1a 1e 62 74 a6 07 59 f8 b4 4d a0 ad 49 f3 1f 53 21 88 bd 76 eb 1d 35 d3 99 2f e2 23 6b>,
     absValidity: 2018-03-22T02:13:26.758Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 16 0.4375 1521598466621
connected to auth! from local port 53436
received auth hello!
{ authId: 502, nonce: <Buffer a7 3f 0e 7d 67 68 0a a2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 86 22 e2 d3 46 b5 30 a8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200853,
  cipherKeyVal: <Buffer 6a 7b 5e 57 21 b9 17 94 36 02 b2 ff 5a f4 04 31>,
  macKeyVal: <Buffer c1 74 f0 d7 4c 50 ed 41 ec be e8 f0 eb 7b 0f df 9f 5e a2 50 13 05 c2 a2 62 3d 1d f0 62 25 e2 07>,
  absValidity: 2018-03-22T02:14:30.371Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200853,
     cipherKeyVal: <Buffer 6a 7b 5e 57 21 b9 17 94 36 02 b2 ff 5a f4 04 31>,
     macKeyVal: <Buffer c1 74 f0 d7 4c 50 ed 41 ec be e8 f0 eb 7b 0f df 9f 5e a2 50 13 05 c2 a2 62 3d 1d f0 62 25 e2 07>,
     absValidity: 2018-03-22T02:14:30.371Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 17 0.4117647058823529 1521598526678
connected to auth! from local port 53654
received auth hello!
{ authId: 502, nonce: <Buffer 38 b7 78 28 b7 84 c1 37> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8f 87 85 ec 77 24 4b 38>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200875,
  cipherKeyVal: <Buffer 2c 30 65 33 bf 65 cf 25 a0 22 78 2d 7c 5d 74 95>,
  macKeyVal: <Buffer 34 55 21 e7 77 63 b8 95 dd 6d b5 7f a6 b9 84 d3 be a4 8e 6e cd 21 e0 e5 61 c3 af 83 ec 3f dc 94>,
  absValidity: 2018-03-22T02:16:06.408Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200875,
     cipherKeyVal: <Buffer 2c 30 65 33 bf 65 cf 25 a0 22 78 2d 7c 5d 74 95>,
     macKeyVal: <Buffer 34 55 21 e7 77 63 b8 95 dd 6d b5 7f a6 b9 84 d3 be a4 8e 6e cd 21 e0 e5 61 c3 af 83 ec 3f dc 94>,
     absValidity: 2018-03-22T02:16:06.408Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 18 0.3888888888888889 1521598586697
connected to auth! from local port 53860
received auth hello!
{ authId: 502, nonce: <Buffer 7f 49 e5 12 9f db d6 29> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 66 25 c2 71 b3 d1 c3 fe>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200879,
  cipherKeyVal: <Buffer 9c 79 e8 a6 fd 50 e5 e3 9c bb 6d 2c 94 2c 0a 2e>,
  macKeyVal: <Buffer af 9e e8 92 09 ea 82 53 13 2c 70 e2 a3 55 10 f2 9f 5d 8e 51 6a f6 07 d9 50 88 5d 78 fd bc 12 e5>,
  absValidity: 2018-03-22T02:16:30.359Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200879,
     cipherKeyVal: <Buffer 9c 79 e8 a6 fd 50 e5 e3 9c bb 6d 2c 94 2c 0a 2e>,
     macKeyVal: <Buffer af 9e e8 92 09 ea 82 53 13 2c 70 e2 a3 55 10 f2 9f 5d 8e 51 6a f6 07 d9 50 88 5d 78 fd bc 12 e5>,
     absValidity: 2018-03-22T02:16:30.359Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 19 0.3684210526315789 1521598646753
connected to auth! from local port 54058
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 20 0.35 1521598706764
connected to auth! from local port 54258
received auth hello!
{ authId: 502, nonce: <Buffer 4b a2 13 cb 74 c3 21 d1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9c f4 d1 f9 65 c9 72 49>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200903,
  cipherKeyVal: <Buffer 20 59 8b f9 f3 dd f1 98 13 26 f6 ac 50 c9 f2 9c>,
  macKeyVal: <Buffer fb a9 11 93 f0 60 f0 11 49 1f 4a 5f de 03 1d 96 8b 04 61 5e 82 aa 1d 53 97 ff 52 fb b4 ce bc c7>,
  absValidity: 2018-03-22T02:18:34.634Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200903,
     cipherKeyVal: <Buffer 20 59 8b f9 f3 dd f1 98 13 26 f6 ac 50 c9 f2 9c>,
     macKeyVal: <Buffer fb a9 11 93 f0 60 f0 11 49 1f 4a 5f de 03 1d 96 8b 04 61 5e 82 aa 1d 53 97 ff 52 fb b4 ce bc c7>,
     absValidity: 2018-03-22T02:18:34.634Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 21 0.3333333333333333 1521598766816
connected to auth! from local port 54470
received auth hello!
{ authId: 502, nonce: <Buffer da 26 5d b5 2b 33 4f 30> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 20 ab df 4b dd 59 eb f6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200916,
  cipherKeyVal: <Buffer 1d 91 18 a9 f1 c5 c9 a4 1e d6 b8 d1 ff 67 ef 21>,
  macKeyVal: <Buffer 9e f4 f5 10 22 cf 0d 60 78 aa 1f 51 34 7b a7 81 b0 26 e4 50 dc bf f3 cb 94 27 66 ef b1 21 36 6b>,
  absValidity: 2018-03-22T02:19:34.630Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200916,
     cipherKeyVal: <Buffer 1d 91 18 a9 f1 c5 c9 a4 1e d6 b8 d1 ff 67 ef 21>,
     macKeyVal: <Buffer 9e f4 f5 10 22 cf 0d 60 78 aa 1f 51 34 7b a7 81 b0 26 e4 50 dc bf f3 cb 94 27 66 ef b1 21 36 6b>,
     absValidity: 2018-03-22T02:19:34.630Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 22 0.3181818181818182 1521598826865
connected to auth! from local port 54676
received auth hello!
{ authId: 502, nonce: <Buffer a2 32 f5 90 20 05 76 6e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 45 7e 0c 9b a4 13 3c f7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200929,
  cipherKeyVal: <Buffer e7 23 ae 27 83 8e 2a 3c c3 d4 5d 28 12 9c 81 68>,
  macKeyVal: <Buffer d6 4a e9 7a f0 df 7e ee 75 b2 72 0c 8d e5 ab 78 7c a8 b9 d3 de b6 ec 23 a2 8d 6c 4a 7c cc 8c a8>,
  absValidity: 2018-03-22T02:20:30.620Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200929,
     cipherKeyVal: <Buffer e7 23 ae 27 83 8e 2a 3c c3 d4 5d 28 12 9c 81 68>,
     macKeyVal: <Buffer d6 4a e9 7a f0 df 7e ee 75 b2 72 0c 8d e5 ab 78 7c a8 b9 d3 de b6 ec 23 a2 8d 6c 4a 7c cc 8c a8>,
     absValidity: 2018-03-22T02:20:30.620Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
received auth hello!
{ authId: 502, nonce: <Buffer bc f3 aa f7 6c 11 f7 17> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: write after end
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 23 0.30434782608695654 1521598886869
connected to auth! from local port 54870
received auth hello!
{ authId: 502, nonce: <Buffer b7 96 6e 72 c8 6c ea ac> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ad 94 b5 5e 45 2e 2e cd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200941,
  cipherKeyVal: <Buffer dd a0 9e 08 34 39 da ea 37 06 81 cd b9 2f 15 07>,
  macKeyVal: <Buffer c1 69 92 17 be a0 da a8 66 e0 cc 5b 94 2d 6e a1 bd 5e 4d 05 2c d9 47 60 7d 9a fa c1 6f 6a 06 74>,
  absValidity: 2018-03-22T02:21:30.621Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200941,
     cipherKeyVal: <Buffer dd a0 9e 08 34 39 da ea 37 06 81 cd b9 2f 15 07>,
     macKeyVal: <Buffer c1 69 92 17 be a0 da a8 66 e0 cc 5b 94 2d 6e a1 bd 5e 4d 05 2c d9 47 60 7d 9a fa c1 6f 6a 06 74>,
     absValidity: 2018-03-22T02:21:30.621Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
disconnected from auth
Handler: Error in secure comm - details: Connection with Auth timed out...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 24 0.2916666666666667 1521598946871
connected to auth! from local port 55042
received auth hello!
{ authId: 502, nonce: <Buffer fe 22 f3 c8 9e 60 bd 68> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e8 c3 33 10 52 f5 a8 ea>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200953,
  cipherKeyVal: <Buffer fd 7f 4c ee db ab f2 17 cd 44 a0 43 01 6a da 96>,
  macKeyVal: <Buffer c8 53 cc 25 89 e8 f7 d4 64 ad 06 e1 59 a1 78 ea db b5 ea 40 39 74 21 b2 d1 9e 1b 34 00 04 8f c3>,
  absValidity: 2018-03-22T02:22:30.641Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200953,
     cipherKeyVal: <Buffer fd 7f 4c ee db ab f2 17 cd 44 a0 43 01 6a da 96>,
     macKeyVal: <Buffer c8 53 cc 25 89 e8 f7 d4 64 ad 06 e1 59 a1 78 ea db b5 ea 40 39 74 21 b2 d1 9e 1b 34 00 04 8f c3>,
     absValidity: 2018-03-22T02:22:30.641Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 25 0.28 1521599006928
connected to auth! from local port 55228
received auth hello!
{ authId: 502, nonce: <Buffer 54 a9 62 bd 49 c5 fe ae> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c4 e8 9f 63 45 2e 31 e4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200968,
  cipherKeyVal: <Buffer 51 5f a9 51 ea d2 90 3f 1e dd 72 1e 30 8d 3b db>,
  macKeyVal: <Buffer e4 e8 f3 e0 59 cb 27 e6 ac 8d 46 3b 0c af 5e 56 87 ea ef 6c 2d d5 02 32 a1 6b 20 91 9b 89 9d fb>,
  absValidity: 2018-03-22T02:23:30.639Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200968,
     cipherKeyVal: <Buffer 51 5f a9 51 ea d2 90 3f 1e dd 72 1e 30 8d 3b db>,
     macKeyVal: <Buffer e4 e8 f3 e0 59 cb 27 e6 ac 8d 46 3b 0c af 5e 56 87 ea ef 6c 2d d5 02 32 a1 6b 20 91 9b 89 9d fb>,
     absValidity: 2018-03-22T02:23:30.639Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 26 0.2692307692307692 1521599066984
connected to auth! from local port 55418
received auth hello!
{ authId: 502, nonce: <Buffer a3 66 4b 79 3b f1 2f 1d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 95 25 bc 31 8b 50 b8 6d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200986,
  cipherKeyVal: <Buffer 30 d4 e7 fe e7 ae ef b2 5a fb 7c d8 fd 78 24 41>,
  macKeyVal: <Buffer 32 93 09 0d 00 55 aa af ce 5a 31 f2 07 29 d9 1f de 1a e6 fb dc a2 29 f8 cf 17 17 1c 48 49 35 15>,
  absValidity: 2018-03-22T02:24:30.608Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200986,
     cipherKeyVal: <Buffer 30 d4 e7 fe e7 ae ef b2 5a fb 7c d8 fd 78 24 41>,
     macKeyVal: <Buffer 32 93 09 0d 00 55 aa af ce 5a 31 f2 07 29 d9 1f de 1a e6 fb dc a2 29 f8 cf 17 17 1c 48 49 35 15>,
     absValidity: 2018-03-22T02:24:30.608Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 27 0.25925925925925924 1521599127040
connected to auth! from local port 55616
received auth hello!
{ authId: 502, nonce: <Buffer a0 74 33 0b 82 7a 94 15> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 59 42 74 c4 79 c7 34 2b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201001,
  cipherKeyVal: <Buffer 54 6d 10 2e a5 7e e9 06 bc 75 90 d6 46 47 95 3f>,
  macKeyVal: <Buffer cb fa 21 cb 45 0e f0 7c 81 ba 76 18 4d 80 9d 7e 15 77 c3 bc 28 60 61 a0 d9 d6 df 57 17 54 52 85>,
  absValidity: 2018-03-22T02:25:27.201Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50201001,
     cipherKeyVal: <Buffer 54 6d 10 2e a5 7e e9 06 bc 75 90 d6 46 47 95 3f>,
     macKeyVal: <Buffer cb fa 21 cb 45 0e f0 7c 81 ba 76 18 4d 80 9d 7e 15 77 c3 bc 28 60 61 a0 d9 d6 df 57 17 54 52 85>,
     absValidity: 2018-03-22T02:25:27.201Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 28 0.25 1521599187097
connected to auth! from local port 55792
received auth hello!
{ authId: 502, nonce: <Buffer a4 1b 92 b7 9e d0 15 d2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 97 56 da a3 33 60 47 bd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201016,
  cipherKeyVal: <Buffer a6 bf 60 e0 36 a2 dd 4b ed 86 57 fd d1 bf d9 dc>,
  macKeyVal: <Buffer e9 b8 f2 68 00 d7 4d bf 7e 69 03 9b c0 44 b1 83 24 6b 62 3a 75 3c 40 79 0e 17 e4 c5 aa 6f e7 6f>,
  absValidity: 2018-03-22T02:26:27.312Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50201016,
     cipherKeyVal: <Buffer a6 bf 60 e0 36 a2 dd 4b ed 86 57 fd d1 bf d9 dc>,
     macKeyVal: <Buffer e9 b8 f2 68 00 d7 4d bf 7e 69 03 9b c0 44 b1 83 24 6b 62 3a 75 3c 40 79 0e 17 e4 c5 aa 6f e7 6f>,
     absValidity: 2018-03-22T02:26:27.312Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
