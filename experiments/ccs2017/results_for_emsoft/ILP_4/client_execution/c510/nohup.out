changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c510.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c510',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 73 6f ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521597572661
connected to auth! from local port 49238
received auth hello!
{ authId: 501, nonce: <Buffer 7a d5 e4 33 9a 15 e8 be> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer b3 c8 58 fd 08 b8 c4 bd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 0e cc 1c a5 65 a2 a0 3c ca 7b 63 7e a6 a3 64 69>,
  macKeyVal: <Buffer ad 7e b9 55 da e3 5e b3 0c e8 56 87 ca 8e c9 3a f8 7c a0 0a e0 54 00 41 3a 40 ae ec 80 65 cf c4>,
  absValidity: 2018-03-21T02:59:32.832Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100538,
  cipherKeyVal: <Buffer b8 64 27 bb f8 10 a9 64 14 59 00 a7 eb 70 3b f0>,
  macKeyVal: <Buffer 6a 29 a7 f1 8b 0d 06 16 67 78 60 d4 27 bf 2e 88 52 22 62 3b 41 04 55 a8 77 6c 59 6b 2e 21 e3 0e>,
  absValidity: 2018-03-22T01:59:32.832Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.30',
  serverPort: 22100,
  sessionKey: 
   { id: 50100538,
     cipherKeyVal: <Buffer b8 64 27 bb f8 10 a9 64 14 59 00 a7 eb 70 3b f0>,
     macKeyVal: <Buffer 6a 29 a7 f1 8b 0d 06 16 67 78 60 d4 27 bf 2e 88 52 22 62 3b 41 04 55 a8 77 6c 59 6b 2e 21 e3 0e>,
     absValidity: 2018-03-22T01:59:32.832Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer f0 8f 83 c1 df bf 2d 23>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 01:59:34 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521597574930
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521597632715
connected to auth! from local port 49510
received auth hello!
{ authId: 501, nonce: <Buffer b7 16 bf 1e a1 10 84 4f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 75 c0 84 da 59 8d 27 1a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100546,
  cipherKeyVal: <Buffer 13 e9 34 96 dc 84 ea 6c 99 b1 0b e1 7c 69 9e 8f>,
  macKeyVal: <Buffer a6 4f 8c b8 11 87 da c3 36 c6 17 06 9e db 2b 8e f7 23 2d e2 48 e3 6a dc a7 2f 10 36 a2 09 5c 9f>,
  absValidity: 2018-03-22T02:00:32.861Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.30',
  serverPort: 22100,
  sessionKey: 
   { id: 50100546,
     cipherKeyVal: <Buffer 13 e9 34 96 dc 84 ea 6c 99 b1 0b e1 7c 69 9e 8f>,
     macKeyVal: <Buffer a6 4f 8c b8 11 87 da c3 36 c6 17 06 9e db 2b 8e f7 23 2d e2 48 e3 6a dc a7 2f 10 36 a2 09 5c 9f>,
     absValidity: 2018-03-22T02:00:32.861Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer dd 89 e2 dd 4a 0d 24 4d>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:00:34 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521597634958
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521597692749
connected to auth! from local port 49780
received auth hello!
{ authId: 501, nonce: <Buffer 84 96 50 2d 2d fb ac 7d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 81 6f 59 e2 cd 35 4b 7e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100554,
  cipherKeyVal: <Buffer 3f 14 b4 2e d5 a9 36 c3 c9 1e c4 c8 a3 32 ad a5>,
  macKeyVal: <Buffer 55 d6 2d 7a ae 85 47 79 d7 09 7d 3d 45 52 2a cf 4e 9d 0a a0 7e 4e 4a be 82 ab a8 01 c7 23 8c 10>,
  absValidity: 2018-03-22T02:01:32.894Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.30',
  serverPort: 22100,
  sessionKey: 
   { id: 50100554,
     cipherKeyVal: <Buffer 3f 14 b4 2e d5 a9 36 c3 c9 1e c4 c8 a3 32 ad a5>,
     macKeyVal: <Buffer 55 d6 2d 7a ae 85 47 79 d7 09 7d 3d 45 52 2a cf 4e 9d 0a a0 7e 4e 4a be 82 ab a8 01 c7 23 8c 10>,
     absValidity: 2018-03-22T02:01:32.894Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 22 b0 21 c6 46 bd 13 27>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:01:34 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521597694915
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521597752798
connected to auth! from local port 50050
received auth hello!
{ authId: 501, nonce: <Buffer a2 87 2c 13 48 9d 68 c1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a5 2f 43 ac dc f1 9a 84>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100562,
  cipherKeyVal: <Buffer 9e 90 a0 94 6e b2 fd d6 b2 dc 7a 11 ef 3f b9 1d>,
  macKeyVal: <Buffer 51 40 35 4c 36 fe 29 c1 85 a7 d5 93 fa 62 b0 e3 b4 09 48 42 1c 1f 5f 30 d0 e6 5d 48 3d 62 2c aa>,
  absValidity: 2018-03-22T02:02:32.946Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.30',
  serverPort: 22100,
  sessionKey: 
   { id: 50100562,
     cipherKeyVal: <Buffer 9e 90 a0 94 6e b2 fd d6 b2 dc 7a 11 ef 3f b9 1d>,
     macKeyVal: <Buffer 51 40 35 4c 36 fe 29 c1 85 a7 d5 93 fa 62 b0 e3 b4 09 48 42 1c 1f 5f 30 d0 e6 5d 48 3d 62 2c aa>,
     absValidity: 2018-03-22T02:02:32.946Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 62 84 a4 4f 13 3d a8 c0>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:02:34 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521597755014
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521597812835
connected to auth! from local port 50320
received auth hello!
{ authId: 501, nonce: <Buffer 9e 91 9e 0c 79 60 dc 40> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 18 af 58 a7 74 2b a7 c0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100570,
  cipherKeyVal: <Buffer d0 d6 3f 46 b2 ee 4d 01 26 ab 40 f7 b8 66 7b d4>,
  macKeyVal: <Buffer c8 5e 17 76 4c 88 53 e0 e4 88 99 1c 2a 29 23 04 2c 7f 78 31 6a f4 5d 55 1e 01 ba 6e 0a 8b 7e 4a>,
  absValidity: 2018-03-22T02:03:32.982Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.30',
  serverPort: 22100,
  sessionKey: 
   { id: 50100570,
     cipherKeyVal: <Buffer d0 d6 3f 46 b2 ee 4d 01 26 ab 40 f7 b8 66 7b d4>,
     macKeyVal: <Buffer c8 5e 17 76 4c 88 53 e0 e4 88 99 1c 2a 29 23 04 2c 7f 78 31 6a f4 5d 55 1e 01 ba 6e 0a 8b 7e 4a>,
     absValidity: 2018-03-22T02:03:32.982Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer fb cf f5 1c 16 d0 da 3f>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:03:34 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521597814993
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521597872890
connected to auth! from local port 50590
received auth hello!
{ authId: 501, nonce: <Buffer de 79 37 d7 ed bb ae a1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 39 7c 4f 70 5a f9 ed f4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100578,
  cipherKeyVal: <Buffer e8 ff da d4 e1 02 0d 04 2c 46 c4 88 7e dd 4b 39>,
  macKeyVal: <Buffer 6f 1a 67 ff 2d 14 fb 5d ea 1e 58 7d 43 3d 7d 7f de 8c c7 38 c7 1a ec 4c c6 43 9d eb 96 a8 08 e1>,
  absValidity: 2018-03-22T02:04:33.019Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.30',
  serverPort: 22100,
  sessionKey: 
   { id: 50100578,
     cipherKeyVal: <Buffer e8 ff da d4 e1 02 0d 04 2c 46 c4 88 7e dd 4b 39>,
     macKeyVal: <Buffer 6f 1a 67 ff 2d 14 fb 5d ea 1e 58 7d 43 3d 7d 7f de 8c c7 38 c7 1a ec 4c c6 43 9d eb 96 a8 08 e1>,
     absValidity: 2018-03-22T02:04:33.019Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 96 04 8e 00 20 b0 4c 8e>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:04:34 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521597875098
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521597932911
connected to auth! from local port 50860
received auth hello!
{ authId: 501, nonce: <Buffer 28 c9 69 dd c9 e2 84 73> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e6 51 90 e1 93 c7 e2 0c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100586,
  cipherKeyVal: <Buffer bb af b4 4f 0b ab b3 63 a1 f9 9d 27 6f 09 ac f8>,
  macKeyVal: <Buffer 1e ed ce 29 2a bb 98 dd 3f 83 8f 2f 98 62 ee 9b 9b e6 fa 1c b0 ae 70 ee 77 64 5e ab af 6b 1c a5>,
  absValidity: 2018-03-22T02:05:33.065Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.30',
  serverPort: 22100,
  sessionKey: 
   { id: 50100586,
     cipherKeyVal: <Buffer bb af b4 4f 0b ab b3 63 a1 f9 9d 27 6f 09 ac f8>,
     macKeyVal: <Buffer 1e ed ce 29 2a bb 98 dd 3f 83 8f 2f 98 62 ee 9b 9b e6 fa 1c b0 ae 70 ee 77 64 5e ab af 6b 1c a5>,
     absValidity: 2018-03-22T02:05:33.065Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 23 0c cb e8 69 59 be f6>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:05:34 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521597935168
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521597992970
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 9 0.7777777777777778 1521598052980
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.3:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 10 0.7 1521598112985
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 41074
received auth hello!
{ authId: 401, nonce: <Buffer f9 7c 12 f8 ee 5f 16 e0> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 11 0.6363636363636364 1521598172993
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 41322
received auth hello!
{ authId: 401, nonce: <Buffer 1d 2f 9b ec 76 b8 bf ae> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 12 0.5833333333333334 1521598233004
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 37244
received auth hello!
{ authId: 502, nonce: <Buffer 0c 1f 84 d5 7b 32 c9 8f> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '01624645FAB9',
  notBefore: 2018-03-21T01:55:14.000Z,
  notAfter: 2018-03-22T01:56:54.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '2E:C0:89:B5:17:EF:3A:05:8F:67:B9:FE:AA:B3:DE:73:47:D9:C8:CC',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'FF6CB5202497CC77AF28EFDE774858E4FEF04355E5228E378962DF4235BE3683DAF9E38A7E22621D66B3B50166D897E97BF911F9E8FC09D686961AA39679014E5DDD27EA0F02DE853A41537DB5E37F33395E249F355C0D074419572E9856D1D598CAB2CD6951013DDCB0A163B943DFCD2694BE18B9B3892695B3052EBD9115D447293C83AF24A008794B842E4F0A6C2A8D0189612A600AA40A592603E43713C0ECCA681024E5EC429FAD09484B824919DF59C8BD488E0D372D2A3D8B99B6068E24BBBDA8F0BCDDBA806010E4A7181736DF08D4D1CFC16E26507C360EDCBFF1B5F4288CE304DE62E9696665C5108489AD7232658356998FF47C4F7E8A04225423',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJGRfq5MA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDMy\nMTAxNTUxNFoXDTE4MDMyMjAxNTY1NFowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQD/bLUgJJfMd68o7953SFjk/vBDVeUijjeJYt9CNb42g9r544p+\nImIdZrO1AWbYl+l7+RH56PwJ1oaWGqOWeQFOXd0n6g8C3oU6QVN9teN/MzleJJ81\nXA0HRBlXLphW0dWYyrLNaVEBPdywoWO5Q9/NJpS+GLmziSaVswUuvZEV1EcpPIOv\nJKAIeUuELk8KbCqNAYlhKmAKpApZJgPkNxPA7MpoECTl7EKfrQlIS4JJGd9ZyL1I\njg03LSo9i5m2Bo4ku72o8LzduoBgEOSnGBc23wjU0c/BbiZQfDYO3L/xtfQojOME\n3mLpaWZlxRCEia1yMmWDVpmP9HxPfooEIlQjAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAJtn2soSweKqNdCE0rJBsO8oTEnmF8hO\n4ZUxr8YZVwzfcbTRhi3zT6QRSkycbmuAixrS1pb2vtd7yhu+ZtKotzfe5cYAr7Dn\nTnaXJ58Yw6nr15yEX9JVmva4bxtiU3Zowv3x9ySJ3SWmBPR609MPB/V+n7+Ayna/\nfsCTqShchjmVZyfCTs5TjcTqsJLZhKfXKrDyZaMhSDkvCvVkOWBMptSFmncis3m3\ncfq9J9miuSmhMMWN0saQpvSxvNlDZ0b0nYW2i2WHQaxO8UslsZCNRt6NDLi46WK6\nyhm9I4P3rehTQZEq2b8y+WwUkOuEFf0TdgUrPmFPzxGqf2Jr5ysChNg=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 2
to: 3
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 13 0.5384615384615384 1521598293015
connected to auth! from local port 37454
received auth hello!
{ authId: 502, nonce: <Buffer 8e a9 13 46 84 90 bc 52> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer a3 e1 00 0f aa 20 2e 68>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 50 ba 20 15 58 c0 b1 ff 75 2d 07 44 2a a0 bb 23>,
  macKeyVal: <Buffer dd e9 c9 f7 d9 84 6a 53 66 77 19 18 ec e7 17 f2 61 d6 99 ac 39 5a 68 72 14 3f b8 ed fc c3 29 b9>,
  absValidity: 2018-03-21T03:11:33.794Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200811,
  cipherKeyVal: <Buffer 8c 1d f8 90 c6 27 51 39 1e c8 d5 23 43 fe 48 11>,
  macKeyVal: <Buffer c0 eb eb 33 18 a7 55 ae 7f 73 7d 7c 8c b4 01 fa dc b3 38 fc 85 2b 44 eb 17 cb 3a ff b3 69 27 e8>,
  absValidity: 2018-03-22T02:11:33.794Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.30',
  serverPort: 22100,
  sessionKey: 
   { id: 50200811,
     cipherKeyVal: <Buffer 8c 1d f8 90 c6 27 51 39 1e c8 d5 23 43 fe 48 11>,
     macKeyVal: <Buffer c0 eb eb 33 18 a7 55 ae 7f 73 7d 7c 8c b4 01 fa dc b3 38 fc 85 2b 44 eb 17 cb 3a ff b3 69 27 e8>,
     absValidity: 2018-03-22T02:11:33.794Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 45 fa e2 23 00 4c bc 41>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.30:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 14 0.5 1521598353025
connected to auth! from local port 37684
received auth hello!
{ authId: 502, nonce: <Buffer ac dd 36 99 83 69 02 e3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 06 8c 71 77 06 4c c9 e1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200826,
  cipherKeyVal: <Buffer d5 65 a0 f7 70 5f a2 3e c7 c1 0b 07 4b 27 1b 76>,
  macKeyVal: <Buffer 57 45 52 3f d4 1d 70 66 75 12 8e 40 c2 03 38 c4 4b 73 ed a7 4e 5c d1 87 1c 32 44 9a 7c f7 24 e8>,
  absValidity: 2018-03-22T02:12:33.631Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.30',
  serverPort: 22100,
  sessionKey: 
   { id: 50200826,
     cipherKeyVal: <Buffer d5 65 a0 f7 70 5f a2 3e c7 c1 0b 07 4b 27 1b 76>,
     macKeyVal: <Buffer 57 45 52 3f d4 1d 70 66 75 12 8e 40 c2 03 38 c4 4b 73 ed a7 4e 5c d1 87 1c 32 44 9a 7c f7 24 e8>,
     absValidity: 2018-03-22T02:12:33.631Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer a6 74 4f 28 20 b2 71 36>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.30:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 15 0.4666666666666667 1521598413034
connected to auth! from local port 37914
received auth hello!
{ authId: 502, nonce: <Buffer 24 51 d8 e3 19 01 ce 8a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1d 7c 1c ab a3 d6 8d 9c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200841,
  cipherKeyVal: <Buffer 3f 40 07 77 19 b5 c7 40 ab e3 ed ce 3c 3b f6 cf>,
  macKeyVal: <Buffer f7 6d 1c ee 3b 7a 81 1f 62 cf b9 82 b0 52 ac 78 a1 93 b2 ea 8a d8 12 ec b9 c4 21 5d 09 a5 6b b5>,
  absValidity: 2018-03-22T02:13:40.151Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.30',
  serverPort: 22100,
  sessionKey: 
   { id: 50200841,
     cipherKeyVal: <Buffer 3f 40 07 77 19 b5 c7 40 ab e3 ed ce 3c 3b f6 cf>,
     macKeyVal: <Buffer f7 6d 1c ee 3b 7a 81 1f 62 cf b9 82 b0 52 ac 78 a1 93 b2 ea 8a d8 12 ec b9 c4 21 5d 09 a5 6b b5>,
     absValidity: 2018-03-22T02:13:40.151Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer c2 5b c8 29 21 05 b3 77>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.30:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 16 0.4375 1521598473037
connected to auth! from local port 38136
received auth hello!
{ authId: 502, nonce: <Buffer 63 02 95 61 ae df 87 af> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 17 32 1a 37 c5 1b 3d 27>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200857,
  cipherKeyVal: <Buffer d3 99 b4 d3 e1 cc a4 8b 5b 07 8d 27 88 fe cd 70>,
  macKeyVal: <Buffer 54 2a f5 f8 1c 14 b7 97 8f 26 1b 47 75 06 c3 14 e7 a4 0d b5 7c 13 ae bd bf ee 3e bc 2c 5e ab ea>,
  absValidity: 2018-03-22T02:14:48.872Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.30',
  serverPort: 22100,
  sessionKey: 
   { id: 50200857,
     cipherKeyVal: <Buffer d3 99 b4 d3 e1 cc a4 8b 5b 07 8d 27 88 fe cd 70>,
     macKeyVal: <Buffer 54 2a f5 f8 1c 14 b7 97 8f 26 1b 47 75 06 c3 14 e7 a4 0d b5 7c 13 ae bd bf ee 3e bc 2c 5e ab ea>,
     absValidity: 2018-03-22T02:14:48.872Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer c0 fb bb c8 b5 4e da 21>
switching to HANDSHAKE_1_SENT
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 17 0.4117647058823529 1521598533081
connected to auth! from local port 38346
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.30:undefined
received auth hello!
{ authId: 502, nonce: <Buffer a6 c9 e5 19 ad 34 d8 99> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0e ca 0b b3 0c 78 3e 16>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200870,
  cipherKeyVal: <Buffer b6 43 09 00 64 6d bd 78 db 30 bc 64 45 d0 e2 45>,
  macKeyVal: <Buffer ec b8 26 7a aa 6e 12 6b 9f 3a 34 57 d0 b2 a7 62 de ce a0 e6 47 de 16 e8 54 25 b2 a2 6e 82 c1 84>,
  absValidity: 2018-03-22T02:15:48.858Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.30',
  serverPort: 22100,
  sessionKey: 
   { id: 50200870,
     cipherKeyVal: <Buffer b6 43 09 00 64 6d bd 78 db 30 bc 64 45 d0 e2 45>,
     macKeyVal: <Buffer ec b8 26 7a aa 6e 12 6b 9f 3a 34 57 d0 b2 a7 62 de ce a0 e6 47 de 16 e8 54 25 b2 a2 6e 82 c1 84>,
     absValidity: 2018-03-22T02:15:48.858Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 4b ae 51 9d db 06 0d 76>
switching to HANDSHAKE_1_SENT
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 18 0.3888888888888889 1521598593125
connected to auth! from local port 38554
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.30:undefined
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 19 0.3684210526315789 1521598653135
connected to auth! from local port 38752
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 20 0.35 1521598713141
connected to auth! from local port 38950
received auth hello!
{ authId: 502, nonce: <Buffer f0 a8 3e 4b da 37 e5 60> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d5 c5 d7 de 3a 7e f1 90>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200907,
  cipherKeyVal: <Buffer 75 52 ae 53 3c 6d 23 f5 fb 46 be 6e 1c fe 1d f1>,
  macKeyVal: <Buffer 58 58 59 a4 11 b9 16 e4 81 f0 f2 44 ed 59 b8 8f 7b 56 12 70 00 a4 3d 66 9a e7 76 3d 25 09 0e 0a>,
  absValidity: 2018-03-22T02:18:41.020Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.30',
  serverPort: 22100,
  sessionKey: 
   { id: 50200907,
     cipherKeyVal: <Buffer 75 52 ae 53 3c 6d 23 f5 fb 46 be 6e 1c fe 1d f1>,
     macKeyVal: <Buffer 58 58 59 a4 11 b9 16 e4 81 f0 f2 44 ed 59 b8 8f 7b 56 12 70 00 a4 3d 66 9a e7 76 3d 25 09 0e 0a>,
     absValidity: 2018-03-22T02:18:41.020Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer a6 d6 7a 9e 5c 62 8a 25>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.30:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 21 0.3333333333333333 1521598773144
connected to auth! from local port 39156
received auth hello!
{ authId: 502, nonce: <Buffer 49 36 4c 27 14 e8 aa 57> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 82 07 4a bf da 19 4c db>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200922,
  cipherKeyVal: <Buffer 65 b9 83 10 0b 28 ae ba 3f fc 79 0c b6 31 64 76>,
  macKeyVal: <Buffer 06 85 8d 13 13 a2 89 25 c0 ed 72 fc 30 3b 71 c0 5c 10 7b b6 ff 0e 74 8a 94 81 f8 fa e8 e0 95 7b>,
  absValidity: 2018-03-22T02:19:48.878Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.30',
  serverPort: 22100,
  sessionKey: 
   { id: 50200922,
     cipherKeyVal: <Buffer 65 b9 83 10 0b 28 ae ba 3f fc 79 0c b6 31 64 76>,
     macKeyVal: <Buffer 06 85 8d 13 13 a2 89 25 c0 ed 72 fc 30 3b 71 c0 5c 10 7b b6 ff 0e 74 8a 94 81 f8 fa e8 e0 95 7b>,
     absValidity: 2018-03-22T02:19:48.878Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer d8 1f 5a 05 26 3d ed 48>
switching to HANDSHAKE_1_SENT
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:20:20 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 21 0.38095238095238093 1521598821376
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 22 0.36363636363636365 1521598833155
connected to auth! from local port 39364
received auth hello!
{ authId: 502, nonce: <Buffer 68 6b 34 8c 7d 87 af b0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4c 72 10 87 ad 07 42 37>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200934,
  cipherKeyVal: <Buffer 2b 5e 13 95 7f 5a 6d 4b 23 e0 60 9c 00 2c ff 99>,
  macKeyVal: <Buffer 76 82 cc 8f ce 71 8e 31 ce 33 72 f2 19 05 f8 fb 27 df 6d c5 79 2b 3c 11 f3 5a 1e f8 ff 06 65 aa>,
  absValidity: 2018-03-22T02:20:52.885Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.30',
  serverPort: 22100,
  sessionKey: 
   { id: 50200934,
     cipherKeyVal: <Buffer 2b 5e 13 95 7f 5a 6d 4b 23 e0 60 9c 00 2c ff 99>,
     macKeyVal: <Buffer 76 82 cc 8f ce 71 8e 31 ce 33 72 f2 19 05 f8 fb 27 df 6d c5 79 2b 3c 11 f3 5a 1e f8 ff 06 65 aa>,
     absValidity: 2018-03-22T02:20:52.885Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer c4 bb 12 87 c9 59 1e 3f>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:20:56 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 9 22 0.4090909090909091 1521598857305
Handler: secure connection with the server closed.
received auth hello!
{ authId: 502, nonce: <Buffer 68 72 99 9e 8e e4 1e f9> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: write after end
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 23 0.391304347826087 1521598893156
connected to auth! from local port 39556
received auth hello!
{ authId: 502, nonce: <Buffer 63 94 f5 60 af fe fc 2b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b5 e0 0f 61 61 bd b1 47>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200943,
  cipherKeyVal: <Buffer 12 aa 00 4e 10 38 e6 c3 a5 4a a3 2f 43 a2 8f 24>,
  macKeyVal: <Buffer 48 d7 37 3d 74 2c a7 3b 22 35 28 30 5b 4b 4b 1b ba 6f 5a 18 9a 05 39 8d f8 75 5b f0 c7 1d 94 73>,
  absValidity: 2018-03-22T02:21:36.881Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.30',
  serverPort: 22100,
  sessionKey: 
   { id: 50200943,
     cipherKeyVal: <Buffer 12 aa 00 4e 10 38 e6 c3 a5 4a a3 2f 43 a2 8f 24>,
     macKeyVal: <Buffer 48 d7 37 3d 74 2c a7 3b 22 35 28 30 5b 4b 4b 1b ba 6f 5a 18 9a 05 39 8d f8 75 5b f0 c7 1d 94 73>,
     absValidity: 2018-03-22T02:21:36.881Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.30:22100
disconnected from auth
received auth hello!
{ authId: 502, nonce: <Buffer 8e e6 4c 26 d0 81 d7 62> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: write after end
Handler: Error in secure comm - details: Connection with Auth timed out...
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 24 0.375 1521598953181
connected to auth! from local port 39730
Handler: Error in secure comm - details: Connection with Auth timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 5c 46 be 1c 17 ce fb cd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2b ac e5 4b f8 8a 35 0c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200954,
  cipherKeyVal: <Buffer 53 b6 70 30 34 e1 52 23 ca 9c 8a 3c 8c 4d cd 23>,
  macKeyVal: <Buffer 9b 88 75 dd 9b 83 76 52 97 58 c2 1d ee 8b c9 7a 14 b9 ac 24 7d 15 0a 65 36 80 54 d8 1b c1 4b 29>,
  absValidity: 2018-03-22T02:22:36.878Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.30',
  serverPort: 22100,
  sessionKey: 
   { id: 50200954,
     cipherKeyVal: <Buffer 53 b6 70 30 34 e1 52 23 ca 9c 8a 3c 8c 4d cd 23>,
     macKeyVal: <Buffer 9b 88 75 dd 9b 83 76 52 97 58 c2 1d ee 8b c9 7a 14 b9 ac 24 7d 15 0a 65 36 80 54 d8 1b c1 4b 29>,
     absValidity: 2018-03-22T02:22:36.878Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.30:22100
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 25 0.36 1521599013238
connected to auth! from local port 39912
received auth hello!
{ authId: 502, nonce: <Buffer 2d 77 94 10 c1 2e 99 3f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 79 2b ac 0e 5f 5c f4 42>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200971,
  cipherKeyVal: <Buffer b6 37 dd a0 ce 93 15 6c 50 70 7c 5c e0 c8 0d f0>,
  macKeyVal: <Buffer b7 67 b5 26 f5 b4 5c c8 2a fa 6e 58 4d 66 0e 5e ad a9 05 78 53 4c 63 22 a5 01 87 18 49 3a 7c d5>,
  absValidity: 2018-03-22T02:23:40.865Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.30',
  serverPort: 22100,
  sessionKey: 
   { id: 50200971,
     cipherKeyVal: <Buffer b6 37 dd a0 ce 93 15 6c 50 70 7c 5c e0 c8 0d f0>,
     macKeyVal: <Buffer b7 67 b5 26 f5 b4 5c c8 2a fa 6e 58 4d 66 0e 5e ad a9 05 78 53 4c 63 22 a5 01 87 18 49 3a 7c d5>,
     absValidity: 2018-03-22T02:23:40.865Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.30:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 26 0.34615384615384615 1521599073290
connected to auth! from local port 40104
received auth hello!
{ authId: 502, nonce: <Buffer 51 fa 94 65 39 56 ef 37> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 49 69 09 0e d9 f8 09 29>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200988,
  cipherKeyVal: <Buffer f0 db cd bf 79 83 50 ca 56 40 84 f6 e9 d8 b6 e4>,
  macKeyVal: <Buffer a7 21 92 16 69 c7 54 69 47 14 16 57 ed ae 7c 4f 0b f2 d8 3e f9 0a 8a 04 b0 7d 7d 2e 92 d0 2b 25>,
  absValidity: 2018-03-22T02:24:34.393Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.30',
  serverPort: 22100,
  sessionKey: 
   { id: 50200988,
     cipherKeyVal: <Buffer f0 db cd bf 79 83 50 ca 56 40 84 f6 e9 d8 b6 e4>,
     macKeyVal: <Buffer a7 21 92 16 69 c7 54 69 47 14 16 57 ed ae 7c 4f 0b f2 d8 3e f9 0a 8a 04 b0 7d 7d 2e 92 d0 2b 25>,
     absValidity: 2018-03-22T02:24:34.393Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.30:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 27 0.3333333333333333 1521599133349
connected to auth! from local port 40302
received auth hello!
{ authId: 502, nonce: <Buffer 7b ba 6e 36 a4 40 8b da> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f0 2b 57 4c 70 83 68 8c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201003,
  cipherKeyVal: <Buffer 79 31 be 95 74 3a 1c 18 b1 a1 06 06 6c 76 c4 88>,
  macKeyVal: <Buffer 4d 79 ff 89 3f c7 b4 54 44 8a 48 7a 86 6e 47 80 32 a9 e6 2c c7 0d 2b d0 9c 3c 17 e8 f3 1b 38 41>,
  absValidity: 2018-03-22T02:25:33.459Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.30',
  serverPort: 22100,
  sessionKey: 
   { id: 50201003,
     cipherKeyVal: <Buffer 79 31 be 95 74 3a 1c 18 b1 a1 06 06 6c 76 c4 88>,
     macKeyVal: <Buffer 4d 79 ff 89 3f c7 b4 54 44 8a 48 7a 86 6e 47 80 32 a9 e6 2c c7 0d 2b d0 9c 3c 17 e8 f3 1b 38 41>,
     absValidity: 2018-03-22T02:25:33.459Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.30:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 28 0.32142857142857145 1521599193407
connected to auth! from local port 40468
received auth hello!
{ authId: 502, nonce: <Buffer f7 68 de 37 28 d4 1e c8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fd ce 03 0c 98 10 86 be>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201018,
  cipherKeyVal: <Buffer f4 2b 3f 6d 66 70 ff b5 dc 1a f6 2a c6 36 4c 2e>,
  macKeyVal: <Buffer 34 ba 77 88 ec 71 85 2c 4c 9d 97 3d 76 3a a8 45 fc be 01 82 01 e1 c8 17 33 fd ef 70 cb 78 6c 7c>,
  absValidity: 2018-03-22T02:26:33.559Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.30',
  serverPort: 22100,
  sessionKey: 
   { id: 50201018,
     cipherKeyVal: <Buffer f4 2b 3f 6d 66 70 ff b5 dc 1a f6 2a c6 36 4c 2e>,
     macKeyVal: <Buffer 34 ba 77 88 ec 71 85 2c 4c 9d 97 3d 76 3a a8 45 fc be 01 82 01 e1 c8 17 33 fd ef 70 cb 78 6c 7c>,
     absValidity: 2018-03-22T02:26:33.559Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.30:22100
disconnected from auth
