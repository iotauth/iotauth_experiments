changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c414.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c414',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 73 53 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521597523340
connected to auth! from local port 58634
received auth hello!
{ authId: 403, nonce: <Buffer 4d 1c 53 28 da 3b 52 a5> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 50 53 5d 6b fb 34 3b e1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 31 d9 ec 81 c4 2c 67 08 96 88 47 28 6f 5e e3 b2>,
  macKeyVal: <Buffer 7e cb 0d cb 2e b5 0b 17 74 de ca 5b f2 c2 75 72 e8 da 76 20 1b dc a0 1f 23 a2 ba a1 78 a8 60 c2>,
  absValidity: 2018-03-21T02:58:43.509Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300522,
  cipherKeyVal: <Buffer 5f 8d 26 e5 08 5b 9e 26 ea 76 17 a9 42 cc 8d 54>,
  macKeyVal: <Buffer 77 e2 5d 71 1c 64 af a5 2d ba 59 08 26 26 92 5d 37 3b e7 30 7a 16 0e 79 a0 c2 f6 37 38 e3 43 92>,
  absValidity: 2018-03-22T01:58:43.508Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.21',
  serverPort: 22100,
  sessionKey: 
   { id: 40300522,
     cipherKeyVal: <Buffer 5f 8d 26 e5 08 5b 9e 26 ea 76 17 a9 42 cc 8d 54>,
     macKeyVal: <Buffer 77 e2 5d 71 1c 64 af a5 2d ba 59 08 26 26 92 5d 37 3b e7 30 7a 16 0e 79 a0 c2 f6 37 38 e3 43 92>,
     absValidity: 2018-03-22T01:58:43.508Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer c4 b5 81 1a c5 00 a5 6f>
switching to HANDSHAKE_1_SENT
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 01:58:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521597524712
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521597583391
connected to auth! from local port 58826
received auth hello!
{ authId: 403, nonce: <Buffer fd 12 1d ba 8a 20 65 eb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 08 be 67 bf f5 61 0d 16>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300528,
  cipherKeyVal: <Buffer c9 51 05 e0 ed 91 e1 f6 3f 0c 08 ca 27 fc 9f 6e>,
  macKeyVal: <Buffer a4 ea ab 6f 04 54 8b 45 6c a5 08 84 52 6e e7 09 6d 0c 7b 7a cc bc 7c af b9 1c d5 4e a8 86 1b 86>,
  absValidity: 2018-03-22T01:59:43.668Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.21',
  serverPort: 22100,
  sessionKey: 
   { id: 40300528,
     cipherKeyVal: <Buffer c9 51 05 e0 ed 91 e1 f6 3f 0c 08 ca 27 fc 9f 6e>,
     macKeyVal: <Buffer a4 ea ab 6f 04 54 8b 45 6c a5 08 84 52 6e e7 09 6d 0c 7b 7a cc bc 7c af b9 1c d5 4e a8 86 1b 86>,
     absValidity: 2018-03-22T01:59:43.668Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 38 ff eb c1 36 f9 e7 81>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 01:59:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521597584908
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521597643449
connected to auth! from local port 59098
received auth hello!
{ authId: 403, nonce: <Buffer 8a 18 94 51 c4 5e f5 a2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer eb f9 df 75 de 13 cc d5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300534,
  cipherKeyVal: <Buffer 29 bd e2 99 00 3c 9a b7 4c 17 48 79 20 cd bf 07>,
  macKeyVal: <Buffer 82 c4 44 20 0d 86 1f 17 e8 ab f2 0c 57 00 7a 0a 8c a5 97 fd b4 94 80 34 7a 0b 08 26 7f 41 58 7c>,
  absValidity: 2018-03-22T02:00:43.705Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.21',
  serverPort: 22100,
  sessionKey: 
   { id: 40300534,
     cipherKeyVal: <Buffer 29 bd e2 99 00 3c 9a b7 4c 17 48 79 20 cd bf 07>,
     macKeyVal: <Buffer 82 c4 44 20 0d 86 1f 17 e8 ab f2 0c 57 00 7a 0a 8c a5 97 fd b4 94 80 34 7a 0b 08 26 7f 41 58 7c>,
     absValidity: 2018-03-22T02:00:43.705Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 55 95 7e d2 0d b3 6b 87>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:00:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521597644961
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521597703467
connected to auth! from local port 59368
received auth hello!
{ authId: 403, nonce: <Buffer 34 a1 6a c4 b2 95 e8 ae> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8a 40 23 77 de b5 f9 4f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300540,
  cipherKeyVal: <Buffer 2f 90 b2 7f d7 1a 93 d6 4b 51 a1 3c 54 ba 6c cc>,
  macKeyVal: <Buffer 25 f1 df 4c 7d 86 f8 a2 8e 2b 29 f3 9a 10 51 03 bf 9e 6e 91 64 89 a0 00 7d 7a 8e b2 82 59 9e 48>,
  absValidity: 2018-03-22T02:01:43.672Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.21',
  serverPort: 22100,
  sessionKey: 
   { id: 40300540,
     cipherKeyVal: <Buffer 2f 90 b2 7f d7 1a 93 d6 4b 51 a1 3c 54 ba 6c cc>,
     macKeyVal: <Buffer 25 f1 df 4c 7d 86 f8 a2 8e 2b 29 f3 9a 10 51 03 bf 9e 6e 91 64 89 a0 00 7d 7a 8e b2 82 59 9e 48>,
     absValidity: 2018-03-22T02:01:43.672Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 3b ff 2f 4b bf 16 6c 17>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:01:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521597704918
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521597763527
connected to auth! from local port 59638
received auth hello!
{ authId: 403, nonce: <Buffer bc 88 9a e8 19 b4 d3 4f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bd 8c b3 71 ed 39 7d 70>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300546,
  cipherKeyVal: <Buffer 5e 7c 1b 98 29 5d 39 e8 9d a5 41 65 19 02 a9 c5>,
  macKeyVal: <Buffer 73 be 2e 01 73 0e be 3b da 37 58 20 ff 9c e3 97 b7 b4 7b 91 bb d2 b7 58 87 f6 97 6f 5a 08 44 e1>,
  absValidity: 2018-03-22T02:02:43.807Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.21',
  serverPort: 22100,
  sessionKey: 
   { id: 40300546,
     cipherKeyVal: <Buffer 5e 7c 1b 98 29 5d 39 e8 9d a5 41 65 19 02 a9 c5>,
     macKeyVal: <Buffer 73 be 2e 01 73 0e be 3b da 37 58 20 ff 9c e3 97 b7 b4 7b 91 bb d2 b7 58 87 f6 97 6f 5a 08 44 e1>,
     absValidity: 2018-03-22T02:02:43.807Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 74 80 c4 39 11 a4 85 b8>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:02:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521597765182
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521597823585
connected to auth! from local port 59908
received auth hello!
{ authId: 403, nonce: <Buffer 13 8e b5 71 9e ca 72 e6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fb 6c 8b 2a b3 5a ce 93>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300552,
  cipherKeyVal: <Buffer 42 5d 54 e7 0b 0a 93 0b da c1 bb 9c f2 2c 4c ed>,
  macKeyVal: <Buffer d0 45 64 5f 89 70 08 ec 97 1b e1 f2 f8 22 29 3c d6 08 aa 6d 49 27 4e 70 56 4c 89 14 75 0a 92 5e>,
  absValidity: 2018-03-22T02:03:43.838Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.21',
  serverPort: 22100,
  sessionKey: 
   { id: 40300552,
     cipherKeyVal: <Buffer 42 5d 54 e7 0b 0a 93 0b da c1 bb 9c f2 2c 4c ed>,
     macKeyVal: <Buffer d0 45 64 5f 89 70 08 ec 97 1b e1 f2 f8 22 29 3c d6 08 aa 6d 49 27 4e 70 56 4c 89 14 75 0a 92 5e>,
     absValidity: 2018-03-22T02:03:43.838Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer c0 f7 a1 50 09 6c 56 71>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:03:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521597825046
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521597883645
connected to auth! from local port 60178
received auth hello!
{ authId: 403, nonce: <Buffer e8 ed bb 3c c4 3e d9 42> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 96 da c7 05 3a 40 fb 21>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300558,
  cipherKeyVal: <Buffer 55 e7 90 ef 52 40 3e 3f 67 49 53 2c 51 57 9d a1>,
  macKeyVal: <Buffer 94 3e 46 6b 86 f3 d0 c2 4a e1 78 57 ea 47 f4 2c 64 22 0b be 79 02 bf 1d 9a 3b 83 e2 89 bb 52 ab>,
  absValidity: 2018-03-22T02:04:43.872Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.21',
  serverPort: 22100,
  sessionKey: 
   { id: 40300558,
     cipherKeyVal: <Buffer 55 e7 90 ef 52 40 3e 3f 67 49 53 2c 51 57 9d a1>,
     macKeyVal: <Buffer 94 3e 46 6b 86 f3 d0 c2 4a e1 78 57 ea 47 f4 2c 64 22 0b be 79 02 bf 1d 9a 3b 83 e2 89 bb 52 ab>,
     absValidity: 2018-03-22T02:04:43.872Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 53 6c 44 7a 48 e9 a4 97>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:04:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521597885048
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521597943703
connected to auth! from local port 60444
received auth hello!
{ authId: 403, nonce: <Buffer bd 19 5e 02 4d b2 5c 53> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 65 22 03 7d 7f 85 84 b9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300564,
  cipherKeyVal: <Buffer 62 53 3a a9 47 4b 4e 31 70 f4 9c d6 a5 06 f0 a4>,
  macKeyVal: <Buffer c6 c8 db aa 97 b5 07 8e 97 f0 ca c3 c9 49 58 e5 27 90 36 07 93 b3 69 b1 5c 4d c9 b3 67 5b 6c b9>,
  absValidity: 2018-03-22T02:05:43.911Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.21',
  serverPort: 22100,
  sessionKey: 
   { id: 40300564,
     cipherKeyVal: <Buffer 62 53 3a a9 47 4b 4e 31 70 f4 9c d6 a5 06 f0 a4>,
     macKeyVal: <Buffer c6 c8 db aa 97 b5 07 8e 97 f0 ca c3 c9 49 58 e5 27 90 36 07 93 b3 69 b1 5c 4d c9 b3 67 5b 6c b9>,
     absValidity: 2018-03-22T02:05:43.911Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer ce c5 1c 94 ec 44 ba 9e>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:05:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 8 1 1521597944914
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 9 0.8888888888888888 1521598003761
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.3:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 10 0.8 1521598063769
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.3:21100
connected to auth! from local port 46804
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 11 0.7272727272727273 1521598123777
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.3:21100
connected to auth! from local port 47038
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 12 0.6666666666666666 1521598183783
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.3:21100
connected to auth! from local port 57572
/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902
            eventHandlers.onError('Error occurred in migration request: Disconnected from auth before getting migration response: ' + error);
                                                                                                                                      ^

ReferenceError: error is not defined
    at Socket.<anonymous> (/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902:135)
    at emitNone (events.js:91:20)
    at Socket.emit (events.js:188:7)
    at endReadableNT (_stream_readable.js:975:12)
    at _combinedTickCallback (internal/process/next_tick.js:80:11)
    at process._tickCallback (internal/process/next_tick.js:104:9)
