changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c418.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c418',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 31 51 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521597536273
connected to auth! from local port 53204
received auth hello!
{ authId: 403, nonce: <Buffer dc c2 7a 68 de 66 9a f2> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 0b d8 d2 a7 17 b1 33 16>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer de af 1a 33 28 12 9e 5b e1 f5 43 e1 8a 02 12 3e>,
  macKeyVal: <Buffer db 8b 77 a3 76 3f 5d 95 53 68 8f 83 ae 22 70 4d e7 65 0f 9e cd c0 98 04 9d f3 0c 1a a2 f1 19 fa>,
  absValidity: 2018-03-21T02:58:56.446Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300526,
  cipherKeyVal: <Buffer 3a de 46 3b 22 20 69 1f b1 fb 85 eb b9 6e 75 8b>,
  macKeyVal: <Buffer fb 18 b2 e2 d5 40 6b 5c 53 b0 35 45 d9 26 a4 ab 08 0d bc 7d 6a f5 23 64 5b 56 83 58 67 31 81 12>,
  absValidity: 2018-03-22T01:58:56.446Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.23',
  serverPort: 22100,
  sessionKey: 
   { id: 40300526,
     cipherKeyVal: <Buffer 3a de 46 3b 22 20 69 1f b1 fb 85 eb b9 6e 75 8b>,
     macKeyVal: <Buffer fb 18 b2 e2 d5 40 6b 5c 53 b0 35 45 d9 26 a4 ab 08 0d bc 7d 6a f5 23 64 5b 56 83 58 67 31 81 12>,
     absValidity: 2018-03-22T01:58:56.446Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 5b 8a 85 7c 0a 0e 7b e3>
switching to HANDSHAKE_1_SENT
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 01:58:58 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521597538889
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521597596331
connected to auth! from local port 53416
received auth hello!
{ authId: 403, nonce: <Buffer bd 4b 40 16 a3 c5 1b 72> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ef cc 8f 13 86 3a 3f 64>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300532,
  cipherKeyVal: <Buffer c7 6c c8 58 ce ac e0 48 c2 05 e9 83 16 1a 49 45>,
  macKeyVal: <Buffer ef c5 23 b2 a3 4c 97 e4 5b 07 2b 36 11 be f5 75 23 0d 8f f8 ba 9f 77 cc 72 2c 97 12 e9 b4 6c 92>,
  absValidity: 2018-03-22T01:59:56.573Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.23',
  serverPort: 22100,
  sessionKey: 
   { id: 40300532,
     cipherKeyVal: <Buffer c7 6c c8 58 ce ac e0 48 c2 05 e9 83 16 1a 49 45>,
     macKeyVal: <Buffer ef c5 23 b2 a3 4c 97 e4 5b 07 2b 36 11 be f5 75 23 0d 8f f8 ba 9f 77 cc 72 2c 97 12 e9 b4 6c 92>,
     absValidity: 2018-03-22T01:59:56.573Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 8b b3 8c c8 4a 3b 95 d7>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 01:59:58 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521597598931
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521597656385
connected to auth! from local port 53688
received auth hello!
{ authId: 403, nonce: <Buffer 30 80 f8 af c6 6f a9 10> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 78 1c 08 85 df fa 30 31>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300538,
  cipherKeyVal: <Buffer a5 fe 3f 7a 66 c1 0e 05 a5 59 2b 80 dc 11 7a 3e>,
  macKeyVal: <Buffer 37 66 5d b5 97 c8 c2 2f cb ed 0b 57 61 67 e1 f5 0f 6e dc 53 d3 17 de 1f 15 14 23 eb b0 7b 4d 4a>,
  absValidity: 2018-03-22T02:00:56.612Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.23',
  serverPort: 22100,
  sessionKey: 
   { id: 40300538,
     cipherKeyVal: <Buffer a5 fe 3f 7a 66 c1 0e 05 a5 59 2b 80 dc 11 7a 3e>,
     macKeyVal: <Buffer 37 66 5d b5 97 c8 c2 2f cb ed 0b 57 61 67 e1 f5 0f 6e dc 53 d3 17 de 1f 15 14 23 eb b0 7b 4d 4a>,
     absValidity: 2018-03-22T02:00:56.612Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 53 ac 11 0a e9 cb 48 09>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:00:58 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521597659009
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521597716441
connected to auth! from local port 53958
received auth hello!
{ authId: 403, nonce: <Buffer cf 0d bf 0e dc 52 76 56> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 83 e3 28 8c 8c ab 65 a0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300544,
  cipherKeyVal: <Buffer d3 f1 f2 5c c1 13 2e db 9f 21 40 98 78 92 77 cb>,
  macKeyVal: <Buffer 69 2a 1c 31 84 f1 14 cd 15 6c 64 b9 a0 3b cd a4 73 35 0a 59 30 7e 41 87 50 b6 f0 71 a8 50 64 3b>,
  absValidity: 2018-03-22T02:01:56.596Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.23',
  serverPort: 22100,
  sessionKey: 
   { id: 40300544,
     cipherKeyVal: <Buffer d3 f1 f2 5c c1 13 2e db 9f 21 40 98 78 92 77 cb>,
     macKeyVal: <Buffer 69 2a 1c 31 84 f1 14 cd 15 6c 64 b9 a0 3b cd a4 73 35 0a 59 30 7e 41 87 50 b6 f0 71 a8 50 64 3b>,
     absValidity: 2018-03-22T02:01:56.596Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 14 77 8a 94 77 ef 57 73>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:01:58 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521597718967
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521597776490
connected to auth! from local port 54228
received auth hello!
{ authId: 403, nonce: <Buffer 4f 99 8e b5 b3 b0 00 ca> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 01 d5 f6 02 e1 07 28 a9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300550,
  cipherKeyVal: <Buffer 3f 58 b9 6e e1 96 d5 43 e1 99 dd cf ef 0b 95 6b>,
  macKeyVal: <Buffer 33 6b 56 01 57 af 5e d3 6c c6 ca d3 df eb 91 3a 7e bd 90 5b 13 1e 02 d2 ff 9a e9 e1 0c 19 72 91>,
  absValidity: 2018-03-22T02:02:56.623Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.23',
  serverPort: 22100,
  sessionKey: 
   { id: 40300550,
     cipherKeyVal: <Buffer 3f 58 b9 6e e1 96 d5 43 e1 99 dd cf ef 0b 95 6b>,
     macKeyVal: <Buffer 33 6b 56 01 57 af 5e d3 6c c6 ca d3 df eb 91 3a 7e bd 90 5b 13 1e 02 d2 ff 9a e9 e1 0c 19 72 91>,
     absValidity: 2018-03-22T02:02:56.623Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 4a b9 9d 26 60 1d 68 a4>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:02:58 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521597778971
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521597836549
connected to auth! from local port 54498
received auth hello!
{ authId: 403, nonce: <Buffer 97 64 dc ad 0c f8 40 b0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cd 38 0f c4 95 37 21 6d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300556,
  cipherKeyVal: <Buffer 15 e1 69 77 3e 3f 08 a5 74 0c ca fc b0 d1 03 d3>,
  macKeyVal: <Buffer ca cc 1d 7c 7e 8f 4b fc 6c f6 28 0a e1 1e 02 ce 18 df 33 2a d6 52 0a 17 bd 07 83 2f a1 7e e6 89>,
  absValidity: 2018-03-22T02:03:56.732Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.23',
  serverPort: 22100,
  sessionKey: 
   { id: 40300556,
     cipherKeyVal: <Buffer 15 e1 69 77 3e 3f 08 a5 74 0c ca fc b0 d1 03 d3>,
     macKeyVal: <Buffer ca cc 1d 7c 7e 8f 4b fc 6c f6 28 0a e1 1e 02 ce 18 df 33 2a d6 52 0a 17 bd 07 83 2f a1 7e e6 89>,
     absValidity: 2018-03-22T02:03:56.732Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 1c ed 24 88 04 ec 8f f5>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:03:58 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521597839039
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521597896597
connected to auth! from local port 54768
received auth hello!
{ authId: 403, nonce: <Buffer ac 4a 1b fa 0e 7f 42 7a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 56 c3 6d 43 72 20 c9 3e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300562,
  cipherKeyVal: <Buffer 5e 77 5b 16 1e 2b b2 fd 10 f0 88 58 2e cc d8 fe>,
  macKeyVal: <Buffer eb 16 4b 64 ff fb 5d 9d 6d 2f e2 be 59 57 28 15 1c 68 75 6e 64 34 06 9f 39 79 11 9a 27 ba 8b 6b>,
  absValidity: 2018-03-22T02:04:56.827Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.23',
  serverPort: 22100,
  sessionKey: 
   { id: 40300562,
     cipherKeyVal: <Buffer 5e 77 5b 16 1e 2b b2 fd 10 f0 88 58 2e cc d8 fe>,
     macKeyVal: <Buffer eb 16 4b 64 ff fb 5d 9d 6d 2f e2 be 59 57 28 15 1c 68 75 6e 64 34 06 9f 39 79 11 9a 27 ba 8b 6b>,
     absValidity: 2018-03-22T02:04:56.827Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 2b d9 53 8e 6c 51 8b 64>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:04:58 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521597899201
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521597956597
connected to auth! from local port 55034
received auth hello!
{ authId: 403, nonce: <Buffer 6b a0 8c ab f7 3d 4e d3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2a 4f 7c 43 0c 09 4e ca>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300568,
  cipherKeyVal: <Buffer d0 62 f2 72 2f d1 0b 98 49 74 eb 7c f1 52 e7 59>,
  macKeyVal: <Buffer 68 b2 e4 73 49 45 95 e6 39 84 59 06 a5 52 9d 55 cd 7e 4d 7c 24 86 8b 30 49 f2 bb 95 09 84 ce 14>,
  absValidity: 2018-03-22T02:05:56.857Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.23',
  serverPort: 22100,
  sessionKey: 
   { id: 40300568,
     cipherKeyVal: <Buffer d0 62 f2 72 2f d1 0b 98 49 74 eb 7c f1 52 e7 59>,
     macKeyVal: <Buffer 68 b2 e4 73 49 45 95 e6 39 84 59 06 a5 52 9d 55 cd 7e 4d 7c 24 86 8b 30 49 f2 bb 95 09 84 ce 14>,
     absValidity: 2018-03-22T02:05:56.857Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer fe ab b1 95 39 63 1f ba>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:05:58 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 8 1 1521597959228
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 9 0.8888888888888888 1521598016606
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.3:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 10 0.8 1521598076609
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.3:21100
connected to auth! from local port 53768
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 11 0.7272727272727273 1521598136613
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.3:21100
connected to auth! from local port 54000
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 12 0.6666666666666666 1521598196621
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.3:21100
connected to auth! from local port 49100
/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902
            eventHandlers.onError('Error occurred in migration request: Disconnected from auth before getting migration response: ' + error);
                                                                                                                                      ^

ReferenceError: error is not defined
    at Socket.<anonymous> (/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902:135)
    at emitNone (events.js:91:20)
    at Socket.emit (events.js:188:7)
    at endReadableNT (_stream_readable.js:975:12)
    at _combinedTickCallback (internal/process/next_tick.js:80:11)
    at process._tickCallback (internal/process/next_tick.js:104:9)
