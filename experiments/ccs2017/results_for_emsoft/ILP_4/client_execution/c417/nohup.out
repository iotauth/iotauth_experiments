changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c417.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c417',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 67 49 42 41 41 4b 43 41 51 45 41 38 58 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521597533098
connected to auth! from local port 34438
received auth hello!
{ authId: 403, nonce: <Buffer 8e 17 99 b2 cf 16 01 60> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 83 2a 12 4f e9 0b f8 a9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 1c f3 e6 1e ce c3 87 a3 a5 09 7a 63 bb 1f 8d 1f>,
  macKeyVal: <Buffer f1 93 ec 01 43 ad 3e 0d 99 84 5e 14 c1 5b 0c e4 cf dd 4a ff 2c 1b 21 0f cd e5 92 88 8f 24 ff 55>,
  absValidity: 2018-03-21T02:58:53.264Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300525,
  cipherKeyVal: <Buffer ac c9 7d f8 e7 a0 d9 96 f5 5f 71 19 f7 8a da a1>,
  macKeyVal: <Buffer b4 59 db f7 c8 68 cf ab 0b 8b a6 4c 9f f8 f5 c6 c1 8e 62 b7 ec 25 78 86 59 b1 a4 e3 d1 b9 30 89>,
  absValidity: 2018-03-22T01:58:53.263Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.22',
  serverPort: 22100,
  sessionKey: 
   { id: 40300525,
     cipherKeyVal: <Buffer ac c9 7d f8 e7 a0 d9 96 f5 5f 71 19 f7 8a da a1>,
     macKeyVal: <Buffer b4 59 db f7 c8 68 cf ab 0b 8b a6 4c 9f f8 f5 c6 c1 8e 62 b7 ec 25 78 86 59 b1 a4 e3 d1 b9 30 89>,
     absValidity: 2018-03-22T01:58:53.263Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 94 ed 64 89 d2 d1 c1 06>
switching to HANDSHAKE_1_SENT
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 01:58:54 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521597534897
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521597593154
connected to auth! from local port 34644
received auth hello!
{ authId: 403, nonce: <Buffer dd 61 4f 3d 13 c7 a3 dc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ad 39 a0 17 17 29 3b 85>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300531,
  cipherKeyVal: <Buffer 4b 1a 4d 82 44 9c 8b 0c f2 42 6e 2e 2c 7b 98 3d>,
  macKeyVal: <Buffer f7 4f 9f 7e ed 41 a1 af 92 7e d9 a1 0c 51 df 6c 96 53 68 5c 56 e3 23 bc 58 09 54 66 a5 d9 e2 58>,
  absValidity: 2018-03-22T01:59:53.433Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.22',
  serverPort: 22100,
  sessionKey: 
   { id: 40300531,
     cipherKeyVal: <Buffer 4b 1a 4d 82 44 9c 8b 0c f2 42 6e 2e 2c 7b 98 3d>,
     macKeyVal: <Buffer f7 4f 9f 7e ed 41 a1 af 92 7e d9 a1 0c 51 df 6c 96 53 68 5c 56 e3 23 bc 58 09 54 66 a5 d9 e2 58>,
     absValidity: 2018-03-22T01:59:53.433Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer a7 09 8b 26 e6 3a e8 54>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 01:59:54 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521597594960
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521597653209
connected to auth! from local port 34916
received auth hello!
{ authId: 403, nonce: <Buffer 07 46 e0 cd 64 39 96 61> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e6 22 52 d6 db 62 cb 62>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300537,
  cipherKeyVal: <Buffer 0d ca cd 6f 7d bb 56 e6 9a 54 9b 62 c7 17 1d de>,
  macKeyVal: <Buffer 3d 52 c7 41 0b ea e5 3a 24 2d fe 38 fe bf 1b 15 f2 df 65 89 76 f7 e0 9c 3c 83 76 bc 8d b0 3c 58>,
  absValidity: 2018-03-22T02:00:53.404Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.22',
  serverPort: 22100,
  sessionKey: 
   { id: 40300537,
     cipherKeyVal: <Buffer 0d ca cd 6f 7d bb 56 e6 9a 54 9b 62 c7 17 1d de>,
     macKeyVal: <Buffer 3d 52 c7 41 0b ea e5 3a 24 2d fe 38 fe bf 1b 15 f2 df 65 89 76 f7 e0 9c 3c 83 76 bc 8d b0 3c 58>,
     absValidity: 2018-03-22T02:00:53.404Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer e3 43 53 9b a8 a4 d3 40>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:00:54 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521597654895
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521597713260
connected to auth! from local port 35186
received auth hello!
{ authId: 403, nonce: <Buffer ef a1 08 7c 05 0c ea 24> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1c 5e e2 9c e9 c8 12 b8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300543,
  cipherKeyVal: <Buffer 62 2e 24 c3 b1 bd d2 17 7c 6b 0c b7 4f f2 96 6d>,
  macKeyVal: <Buffer 61 31 2e 4a e3 63 f9 bb d7 87 c4 fd 9b 53 3f 12 84 f9 50 3d 69 f8 4e a4 05 97 dc 38 fb ad c6 ad>,
  absValidity: 2018-03-22T02:01:53.483Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.22',
  serverPort: 22100,
  sessionKey: 
   { id: 40300543,
     cipherKeyVal: <Buffer 62 2e 24 c3 b1 bd d2 17 7c 6b 0c b7 4f f2 96 6d>,
     macKeyVal: <Buffer 61 31 2e 4a e3 63 f9 bb d7 87 c4 fd 9b 53 3f 12 84 f9 50 3d 69 f8 4e a4 05 97 dc 38 fb ad c6 ad>,
     absValidity: 2018-03-22T02:01:53.483Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 49 4b bd 8c 45 05 b5 eb>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:01:54 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521597714904
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521597773310
connected to auth! from local port 35456
received auth hello!
{ authId: 403, nonce: <Buffer ce 39 a4 4a bb 32 86 62> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8a 87 bc 7c 49 c3 f9 09>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300549,
  cipherKeyVal: <Buffer 23 a3 3f 1c 24 cc 9d 40 90 3f 62 cb 68 71 60 f9>,
  macKeyVal: <Buffer 1c ca c3 5c 39 7e 74 17 2e 0a 58 33 a1 c2 a9 21 a7 6b 92 91 2f 60 1f 53 ae cf 17 10 7c b2 dd 75>,
  absValidity: 2018-03-22T02:02:53.486Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.22',
  serverPort: 22100,
  sessionKey: 
   { id: 40300549,
     cipherKeyVal: <Buffer 23 a3 3f 1c 24 cc 9d 40 90 3f 62 cb 68 71 60 f9>,
     macKeyVal: <Buffer 1c ca c3 5c 39 7e 74 17 2e 0a 58 33 a1 c2 a9 21 a7 6b 92 91 2f 60 1f 53 ae cf 17 10 7c b2 dd 75>,
     absValidity: 2018-03-22T02:02:53.486Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 01 1d d7 9a b2 a7 3c 82>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:02:54 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521597775030
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521597833365
connected to auth! from local port 35728
received auth hello!
{ authId: 403, nonce: <Buffer c5 99 06 29 8d eb b5 f5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 94 41 de 56 ee a5 ba 41>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300555,
  cipherKeyVal: <Buffer c0 e8 f6 d4 24 83 4f 0d 95 42 94 87 a3 2d 1c 8d>,
  macKeyVal: <Buffer 56 6d 91 85 d4 4a b9 18 11 57 3f 61 e3 9b 4a ef ba 99 da 7f 64 9d 02 ab a6 19 fb 42 bb 5a 54 f7>,
  absValidity: 2018-03-22T02:03:53.618Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.22',
  serverPort: 22100,
  sessionKey: 
   { id: 40300555,
     cipherKeyVal: <Buffer c0 e8 f6 d4 24 83 4f 0d 95 42 94 87 a3 2d 1c 8d>,
     macKeyVal: <Buffer 56 6d 91 85 d4 4a b9 18 11 57 3f 61 e3 9b 4a ef ba 99 da 7f 64 9d 02 ab a6 19 fb 42 bb 5a 54 f7>,
     absValidity: 2018-03-22T02:03:53.618Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer d1 24 cc ef 87 f9 8c da>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:03:54 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521597835088
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521597893425
connected to auth! from local port 35996
received auth hello!
{ authId: 403, nonce: <Buffer 73 44 c0 a8 b5 a5 31 f3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 86 ad a0 6d e2 05 bb 23>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300561,
  cipherKeyVal: <Buffer 4d 89 9e 3b d5 69 4a 62 9b 11 b4 7d 18 73 78 cf>,
  macKeyVal: <Buffer c5 a2 d5 dc 93 21 81 ca 59 fc e9 3d e9 6f 11 24 b2 cd 52 e4 b1 fd 21 1d 7d c8 d4 b5 d0 4e a4 5f>,
  absValidity: 2018-03-22T02:04:53.616Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.22',
  serverPort: 22100,
  sessionKey: 
   { id: 40300561,
     cipherKeyVal: <Buffer 4d 89 9e 3b d5 69 4a 62 9b 11 b4 7d 18 73 78 cf>,
     macKeyVal: <Buffer c5 a2 d5 dc 93 21 81 ca 59 fc e9 3d e9 6f 11 24 b2 cd 52 e4 b1 fd 21 1d 7d c8 d4 b5 d0 4e a4 5f>,
     absValidity: 2018-03-22T02:04:53.616Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 9b 6b cb b2 7a 47 57 81>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:04:54 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521597895246
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521597953483
connected to auth! from local port 36264
received auth hello!
{ authId: 403, nonce: <Buffer 86 3d 85 45 dd d3 68 03> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3d 5e 14 db b2 ab 95 58>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300567,
  cipherKeyVal: <Buffer fc 43 de 4d d8 05 cf 6f 9f a3 4a 13 00 36 84 88>,
  macKeyVal: <Buffer e7 16 ba b3 79 5f c8 d4 d5 f1 5a 6e 25 48 ac 9a 2a 67 3e 75 bf cb 97 cd 7a 75 19 58 37 fc e1 1a>,
  absValidity: 2018-03-22T02:05:53.720Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.22',
  serverPort: 22100,
  sessionKey: 
   { id: 40300567,
     cipherKeyVal: <Buffer fc 43 de 4d d8 05 cf 6f 9f a3 4a 13 00 36 84 88>,
     macKeyVal: <Buffer e7 16 ba b3 79 5f c8 d4 d5 f1 5a 6e 25 48 ac 9a 2a 67 3e 75 bf cb 97 cd 7a 75 19 58 37 fc e1 1a>,
     absValidity: 2018-03-22T02:05:53.720Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 6a d0 3f 97 fa 3e b1 84>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:05:54 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 8 1 1521597955157
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 9 0.8888888888888888 1521598013542
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.3:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 10 0.8 1521598073551
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.3:21100
connected to auth! from local port 33364
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 11 0.7272727272727273 1521598133557
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.3:21100
connected to auth! from local port 33598
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 12 0.6666666666666666 1521598193565
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.3:21100
connected to auth! from local port 40678
/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902
            eventHandlers.onError('Error occurred in migration request: Disconnected from auth before getting migration response: ' + error);
                                                                                                                                      ^

ReferenceError: error is not defined
    at Socket.<anonymous> (/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902:135)
    at emitNone (events.js:91:20)
    at Socket.emit (events.js:188:7)
    at endReadableNT (_stream_readable.js:975:12)
    at _combinedTickCallback (internal/process/next_tick.js:80:11)
    at process._tickCallback (internal/process/next_tick.js:104:9)
