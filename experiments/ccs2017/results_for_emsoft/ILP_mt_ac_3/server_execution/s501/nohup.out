changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s501.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's501',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 78 42 ... > }
Handler: listening on port 22100
s501:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100482
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46790
received auth hello!
{ authId: 501, nonce: <Buffer 96 ac df 47 60 d1 46 02> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 11 f1 57 f0 30 ec 20 74>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 24 b3 d2 6b 0a 48 41 cd 1c 04 e0 d1 3d ce 81 a7>,
  macKeyVal: <Buffer e7 38 c4 9c 59 3b f8 62 82 1d 30 7a 29 82 75 95 5e 4b 18 8d 36 41 3d 82 9c b9 48 0f e9 60 a2 c2>,
  absValidity: 2018-03-21T06:47:57.691Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f1 81 52 51 d6 b7 c2 ef>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f1 81 52 51 d6 b7 c2 ef> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.62:57096',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100490
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47020
received auth hello!
{ authId: 501, nonce: <Buffer 6b 98 67 19 79 26 30 37> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d9 54 fc a7 fb 11 7c 78>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c3 ae 0b 15 2c 19 68 f3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c3 ae 0b 15 2c 19 68 f3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.62:57326',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100498
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47290
received auth hello!
{ authId: 501, nonce: <Buffer 35 de 55 34 c0 f2 01 9a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f0 4d 53 30 a6 f2 f4 ee>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 26 e2 9c 06 21 92 b5 96>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 26 e2 9c 06 21 92 b5 96> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.62:57596',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100506
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47560
received auth hello!
{ authId: 501, nonce: <Buffer d1 f6 2c fb f5 27 8b 13> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1e 7a 44 65 58 37 dc c4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 15 57 0b 18 b6 d5 42 ba>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 15 57 0b 18 b6 d5 42 ba> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.62:57866',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100514
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47830
received auth hello!
{ authId: 501, nonce: <Buffer e5 92 66 a5 39 22 88 d2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 49 1f be 77 9e 65 30 7e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5e d1 af 94 6f e2 66 5b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 5e d1 af 94 6f e2 66 5b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.62:58136',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100522
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48100
received auth hello!
{ authId: 501, nonce: <Buffer 67 bb 2d 40 61 2b ef 46> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ea 79 15 90 c1 b9 a5 6d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2d 37 8a ab 14 6c bf e9>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 2d 37 8a ab 14 6c bf e9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.62:58406',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100530
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48370
received auth hello!
{ authId: 501, nonce: <Buffer 0f fd b8 26 14 f5 96 d6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 16 c3 d4 5b 42 07 6a 45>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3a 3f f0 6d 7f c8 1e bb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3a 3f f0 6d 7f c8 1e bb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.62:58676',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200564
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200577
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 39132
received auth hello!
{ authId: 502, nonce: <Buffer ac 7a 1e 37 f0 84 9d ef> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '016247178CAE',
  notBefore: 2018-03-21T05:44:08.000Z,
  notAfter: 2018-03-22T05:45:48.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '38:5E:6C:BE:04:69:C4:55:9C:BC:0F:D4:85:3D:DE:73:9C:8B:82:CA',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'AEEAB02ACD0C32937DD84F3EB43F6189EAF089B04CE490F227FEC1E1A42FF33AACC957083F15D2CFEBF0E484D5D2BD03DD21587B3DF0ADCF1F273CEB6D3ADD0C5BD72406DA2D4A379546AD8D1C72FF3DB6ECF5D19A3A100B89C7B659A65778923B085EE02B29C23C0BF27314DEEC84CC61B318C930EC82C3B5DB050AD2527763CDCB5CEE65C7B2D7C1052512A2B08B2601CA1A4E32273B811E50FD7E40A702A19D8D7DB1E27E4C4E0A2F783C9AE1F654053799A646075FDCF3A86C68C654BCCA093F1A4B4044DAAFAB0E1FA7692D70BA1D4DBF798207A97EFFA87E7F6BE94B5E3D49438D87392AA382C0493F6F6E59A3B858B64877C59B95478C667FEE6CD71D',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
disconnected from auth
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJHF4yuMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDMy\nMTA1NDQwOFoXDTE4MDMyMjA1NDU0OFowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQCu6rAqzQwyk33YTz60P2GJ6vCJsEzkkPIn/sHhpC/zOqzJVwg/\nFdLP6/DkhNXSvQPdIVh7PfCtzx8nPOttOt0MW9ckBtotSjeVRq2NHHL/Pbbs9dGa\nOhALice2WaZXeJI7CF7gKynCPAvycxTe7ITMYbMYyTDsgsO12wUK0lJ3Y83LXO5l\nx7LXwQUlEqKwiyYByhpOMic7gR5Q/X5ApwKhnY19seJ+TE4KL3g8muH2VAU3maZG\nB1/c86hsaMZUvMoJPxpLQETar6sOH6dpLXC6HU2/eYIHqX7/qH5/a+lLXj1JQ42H\nOSqjgsBJP29uWaO4WLZId8WblUeMZn/ubNcdAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAJOdt3VTDFTavlKO9undoHc3GnfCQOFZ\nNYrh9aZVJup3R8oBPfF1dM0zOIFoGH+lT3jorWwcVFAQHQ+CX4RsQJKi6pRS6Ppp\nLGVHDWNWz1xJRsVUjmjlq+bLWBQzkHYnPAL5I6mLnlkYBuFI5hBRNbf5KCK8+b8D\nIcsUBU6uB+7IsdEtczbgqNwo7KFCqT7dCeaO2nbhENGNDofe9Jt8HY0RM+WQwY2x\n+p+5L4YK3aT+SH0eiIoC3r4Z8+sS8j5AjLchSwJJjbkz4Nucx02nisv4VQWuwrRx\nwxiQXtF8WmezD/RnRfHRWpe7luIyQm6yfZEHTSPcpM3w3BNU6XCjD6w=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200590
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39416
received auth hello!
{ authId: 502, nonce: <Buffer 38 98 30 73 5d dd b3 0f> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 6c db 71 46 bd 4e 7e 06>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 94 ee 88 97 bb 30 04 cb 23 68 ac 41 0a 49 eb 9b>,
  macKeyVal: <Buffer c3 17 4f 41 ce 73 ec 9c 61 e9 b6 ce d1 e0 27 bb 97 09 43 63 1f 51 50 9e 88 80 97 17 1b 22 2e 65>,
  absValidity: 2018-03-21T06:59:01.463Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1d f6 bf b1 56 ed 30 a8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1d f6 bf b1 56 ed 30 a8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.62:59932',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200603
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39680
received auth hello!
{ authId: 502, nonce: <Buffer 54 dc 92 31 dd c6 d0 2f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 66 3a ef 23 eb 92 65 6f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b3 59 53 b3 4a 04 37 46>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b3 59 53 b3 4a 04 37 46> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.62:60196',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200616
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39944
received auth hello!
{ authId: 502, nonce: <Buffer 45 a2 7b 01 d1 7f 35 23> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c2 c8 18 62 72 df c1 06>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fe 1f 3b fe 52 ae 1e 13>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer fe 1f 3b fe 52 ae 1e 13> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.62:60458',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200629
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40206
received auth hello!
{ authId: 502, nonce: <Buffer 63 ab d9 12 1f 21 be f4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fe 04 f1 b7 2e 4d d2 b1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b3 b0 fc 68 0d 88 b3 ce>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b3 b0 fc 68 0d 88 b3 ce> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.62:60724',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200642
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40486
received auth hello!
{ authId: 502, nonce: <Buffer 10 64 3c 82 f8 0e 1d 17> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ac 20 ca e5 a1 c6 ad 9c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 62 b9 ed 78 74 20 f5 9d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 62 b9 ed 78 74 20 f5 9d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.62:32772',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200655
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40756
received auth hello!
{ authId: 502, nonce: <Buffer d8 e4 ec 75 50 1e 14 ad> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 38 91 37 da 6e 7f f5 72>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ef 83 ac 40 59 eb ba 5e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ef 83 ac 40 59 eb ba 5e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.62:33042',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200668
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41022
received auth hello!
{ authId: 502, nonce: <Buffer 77 ff e1 18 23 16 11 4e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b8 dc 5c c9 fb bb 46 bb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b9 c8 f1 90 17 bf b7 76>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b9 c8 f1 90 17 bf b7 76> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.62:33308',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200681
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41272
received auth hello!
{ authId: 502, nonce: <Buffer 73 50 86 77 fe d8 3c c2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c9 1d f1 54 68 49 97 06>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a2 ea b2 e3 61 0b 95 24>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a2 ea b2 e3 61 0b 95 24> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.62:33556',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200694
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41536
received auth hello!
{ authId: 502, nonce: <Buffer 5f 3c 5f 32 39 10 e9 41> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fe 4b f7 3b 6b 91 c4 aa>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6d 5d a0 bb d5 65 51 3f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6d 5d a0 bb d5 65 51 3f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.62:33822',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200707
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41808
received auth hello!
{ authId: 502, nonce: <Buffer 34 36 d1 00 94 a7 64 2f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 16 aa 20 bb 78 5d 6d 0b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bb 16 a0 e5 71 6c 4a 61>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer bb 16 a0 e5 71 6c 4a 61> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.62:34092',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200720
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42076
received auth hello!
{ authId: 502, nonce: <Buffer 0b 94 2d 6f 47 ab 91 04> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b4 97 f0 bd dd f2 1b ed>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e9 84 e2 26 cc a3 0f 7c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e9 84 e2 26 cc a3 0f 7c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.62:34360',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200733
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42342
received auth hello!
{ authId: 502, nonce: <Buffer 74 98 46 d4 fd 36 b9 51> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 19 15 bf fc 54 05 9b bd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer dd f7 8d 2e 16 a9 0a 53>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer dd f7 8d 2e 16 a9 0a 53> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.62:34626',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200746
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42600
received auth hello!
{ authId: 502, nonce: <Buffer 4d 2a d6 d3 02 f2 0a a4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3b 84 d1 7c ff cf 14 ba>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 73 04 78 b6 0f 17 72 a1>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 73 04 78 b6 0f 17 72 a1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.62:34886',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200759
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42866
received auth hello!
{ authId: 502, nonce: <Buffer d2 af 6f fc bf 7a 1d 69> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f7 c8 5b 14 e2 ac 88 33>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 37 ca 45 3f 2a 5d 68 33>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 37 ca 45 3f 2a 5d 68 33> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.62:35152',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200772
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43132
received auth hello!
{ authId: 502, nonce: <Buffer 6c a9 e4 85 84 55 9f 51> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e5 05 bf c8 8d 62 6f 1b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 17 95 63 8e 8a 54 42 e9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 17 95 63 8e 8a 54 42 e9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.62:35418',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200785
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43398
received auth hello!
{ authId: 502, nonce: <Buffer b2 77 14 35 8c 5e 37 08> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 71 e6 04 66 63 24 86 30>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7e df 74 79 8d a5 51 6b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 7e df 74 79 8d a5 51 6b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.62:35684',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200798
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43658
received auth hello!
{ authId: 502, nonce: <Buffer 42 c2 c3 78 6a 51 76 51> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 93 11 b8 d0 f0 9a a5 d8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9d 6a 38 65 22 3d b2 30>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9d 6a 38 65 22 3d b2 30> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.62:35944',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
