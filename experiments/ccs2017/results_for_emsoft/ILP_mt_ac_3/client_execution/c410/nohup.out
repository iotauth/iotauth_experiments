changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c410.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c410',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 67 49 42 41 41 4b 43 41 51 45 41 36 70 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521611244371
connected to auth! from local port 49364
received auth hello!
{ authId: 402, nonce: <Buffer 22 f3 9e 14 90 62 1c c0> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer bf cd 67 e1 dc e8 0a 46>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 06 dd 67 10 10 17 10 a9 70 1c 66 69 98 15 95 dc>,
  macKeyVal: <Buffer d8 43 2d 47 77 73 ff ca 94 25 af c9 84 3a 2b a5 0f 5f fc ff 00 83 29 2f ba 9f c5 05 e7 14 30 f4>,
  absValidity: 2018-03-21T06:47:24.559Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200254,
  cipherKeyVal: <Buffer d3 15 8b 77 3a f7 39 0b 91 e7 7a 71 33 c4 f5 16>,
  macKeyVal: <Buffer 4c f9 89 46 6f db e0 72 bd 83 97 71 4a 14 28 4d 7c a3 4a 3d 24 dd ed 81 7c 46 6d 51 fd 92 80 93>,
  absValidity: 2018-03-22T05:47:24.559Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200254,
     cipherKeyVal: <Buffer d3 15 8b 77 3a f7 39 0b 91 e7 7a 71 33 c4 f5 16>,
     macKeyVal: <Buffer 4c f9 89 46 6f db e0 72 bd 83 97 71 4a 14 28 4d 7c a3 4a 3d 24 dd ed 81 7c 46 6d 51 fd 92 80 93>,
     absValidity: 2018-03-22T05:47:24.559Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 5f 9d 6d e1 ad f2 4b c7>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 05:47:25 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521611246144
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521611304430
connected to auth! from local port 49532
received auth hello!
{ authId: 402, nonce: <Buffer 6a b2 ae 53 fc f0 78 38> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 84 ee f9 68 dc 2e 0d dd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200261,
  cipherKeyVal: <Buffer a6 c5 83 54 a1 b9 91 c1 8d b6 a2 6b b6 44 83 e5>,
  macKeyVal: <Buffer 5e e7 fd 00 40 d0 a1 96 bd b1 80 6a 46 05 e5 90 a2 11 ce 37 5b c4 69 84 fe cb f9 18 02 3b 06 dc>,
  absValidity: 2018-03-22T05:48:24.546Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200261,
     cipherKeyVal: <Buffer a6 c5 83 54 a1 b9 91 c1 8d b6 a2 6b b6 44 83 e5>,
     macKeyVal: <Buffer 5e e7 fd 00 40 d0 a1 96 bd b1 80 6a 46 05 e5 90 a2 11 ce 37 5b c4 69 84 fe cb f9 18 02 3b 06 dc>,
     absValidity: 2018-03-22T05:48:24.546Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 75 56 b2 3d 92 54 39 13>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 05:48:25 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521611306188
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521611364488
connected to auth! from local port 49800
received auth hello!
{ authId: 402, nonce: <Buffer f6 9e 6b 53 1b 63 75 ca> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b7 41 e8 b7 ed fd 1e 31>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200268,
  cipherKeyVal: <Buffer 52 66 29 df cf 0d 94 55 f0 d0 68 1c 53 95 c2 16>,
  macKeyVal: <Buffer 55 6a 98 75 27 53 88 dc c2 ba a0 d9 fb a5 9c ad bb f4 4f d1 26 36 81 cc b4 72 76 20 74 8a b6 70>,
  absValidity: 2018-03-22T05:49:24.841Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200268,
     cipherKeyVal: <Buffer 52 66 29 df cf 0d 94 55 f0 d0 68 1c 53 95 c2 16>,
     macKeyVal: <Buffer 55 6a 98 75 27 53 88 dc c2 ba a0 d9 fb a5 9c ad bb f4 4f d1 26 36 81 cc b4 72 76 20 74 8a b6 70>,
     absValidity: 2018-03-22T05:49:24.841Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 88 f7 4e 3e 34 a0 dd 01>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 05:49:25 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521611366266
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521611424504
connected to auth! from local port 50072
received auth hello!
{ authId: 402, nonce: <Buffer d8 46 cb 54 cb b3 a8 d8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer aa 68 ae 6e 36 96 48 df>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200275,
  cipherKeyVal: <Buffer c7 d1 0e 66 db b7 a2 2d bc 86 9d 66 f1 a9 f2 81>,
  macKeyVal: <Buffer 39 c3 61 73 51 a9 e6 42 b2 e6 61 28 dd ee 00 4f 45 8f 51 76 d9 49 78 d2 8f 72 1a b3 6b 5c d8 68>,
  absValidity: 2018-03-22T05:50:24.768Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200275,
     cipherKeyVal: <Buffer c7 d1 0e 66 db b7 a2 2d bc 86 9d 66 f1 a9 f2 81>,
     macKeyVal: <Buffer 39 c3 61 73 51 a9 e6 42 b2 e6 61 28 dd ee 00 4f 45 8f 51 76 d9 49 78 d2 8f 72 1a b3 6b 5c d8 68>,
     absValidity: 2018-03-22T05:50:24.768Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 39 eb 37 c5 72 a3 e6 bd>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 05:50:25 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521611426236
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521611484563
connected to auth! from local port 50344
received auth hello!
{ authId: 402, nonce: <Buffer 2a ac 3c 07 c4 e5 5e 4c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 53 0f ea 9d 2b a9 ab 94>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200282,
  cipherKeyVal: <Buffer 37 49 c1 78 d2 c2 aa a0 16 4d 34 67 f7 a9 ca 06>,
  macKeyVal: <Buffer 15 6e 71 4c 13 8a 1d 59 cd 4b eb a2 c0 b7 a4 e7 cc ba c6 2b cb 2e c3 16 45 cd 8e 70 7e 03 98 6a>,
  absValidity: 2018-03-22T05:51:24.742Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200282,
     cipherKeyVal: <Buffer 37 49 c1 78 d2 c2 aa a0 16 4d 34 67 f7 a9 ca 06>,
     macKeyVal: <Buffer 15 6e 71 4c 13 8a 1d 59 cd 4b eb a2 c0 b7 a4 e7 cc ba c6 2b cb 2e c3 16 45 cd 8e 70 7e 03 98 6a>,
     absValidity: 2018-03-22T05:51:24.742Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 09 06 43 96 be cb 43 33>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 05:51:26 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521611486398
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521611544621
connected to auth! from local port 50614
received auth hello!
{ authId: 402, nonce: <Buffer 78 d7 3c 35 38 aa 28 2c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b8 16 3c b6 70 e2 66 e7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200289,
  cipherKeyVal: <Buffer c4 c4 b4 43 f6 c7 32 cf a3 3f e0 0c c7 99 48 39>,
  macKeyVal: <Buffer 6c 1a 49 d1 66 40 ea c3 ee d9 65 f5 3c a7 e1 eb dc 22 ff 6a 96 34 ab bc 13 e7 b1 30 fd c2 9c 71>,
  absValidity: 2018-03-22T05:52:24.813Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200289,
     cipherKeyVal: <Buffer c4 c4 b4 43 f6 c7 32 cf a3 3f e0 0c c7 99 48 39>,
     macKeyVal: <Buffer 6c 1a 49 d1 66 40 ea c3 ee d9 65 f5 3c a7 e1 eb dc 22 ff 6a 96 34 ab bc 13 e7 b1 30 fd c2 9c 71>,
     absValidity: 2018-03-22T05:52:24.813Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer b1 df be 0b a3 26 a8 85>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 05:52:26 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521611546340
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521611604680
connected to auth! from local port 50884
received auth hello!
{ authId: 402, nonce: <Buffer b9 27 fd e3 92 41 d9 2b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3a 42 d8 c7 ad 53 09 e2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200296,
  cipherKeyVal: <Buffer 7b e7 79 a6 14 b2 f7 2a 89 f9 d2 b6 7c f1 5b 6d>,
  macKeyVal: <Buffer e1 b4 fb b8 2a 39 6a f0 53 a6 a0 b6 25 ff 0d 43 57 d2 c2 59 75 8f 79 25 e7 4b 6d 73 a2 7a af da>,
  absValidity: 2018-03-22T05:53:25.005Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200296,
     cipherKeyVal: <Buffer 7b e7 79 a6 14 b2 f7 2a 89 f9 d2 b6 7c f1 5b 6d>,
     macKeyVal: <Buffer e1 b4 fb b8 2a 39 6a f0 53 a6 a0 b6 25 ff 0d 43 57 d2 c2 59 75 8f 79 25 e7 4b 6d 73 a2 7a af da>,
     absValidity: 2018-03-22T05:53:25.005Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 89 13 cf dd 80 00 ff a5>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 05:53:26 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521611606373
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521611664689
connected to auth! from local port 51154
received auth hello!
{ authId: 402, nonce: <Buffer c1 f0 cb 85 ac 5c b1 47> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 38 c7 78 29 9c f4 27 c7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200303,
  cipherKeyVal: <Buffer 34 44 41 ae b0 a2 6e ea 27 0f b8 09 cd ff 3b 0e>,
  macKeyVal: <Buffer f6 e8 22 4e 92 cb 33 97 a2 6f bd 65 de ca 0c 07 bd b3 c3 c0 71 84 bf f0 99 60 c6 79 9b 7e 9e 30>,
  absValidity: 2018-03-22T05:54:24.828Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200303,
     cipherKeyVal: <Buffer 34 44 41 ae b0 a2 6e ea 27 0f b8 09 cd ff 3b 0e>,
     macKeyVal: <Buffer f6 e8 22 4e 92 cb 33 97 a2 6f bd 65 de ca 0c 07 bd b3 c3 c0 71 84 bf f0 99 60 c6 79 9b 7e 9e 30>,
     absValidity: 2018-03-22T05:54:24.828Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer ff 81 eb ff ed 6a 90 6f>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 05:54:26 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 8 1 1521611666607
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 9 0.8888888888888888 1521611724748
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 10 0.8 1521611784758
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 60654
received auth hello!
{ authId: 503, nonce: <Buffer b8 7c 7e 84 86 a2 3f 32> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth503',
     commonName: '10.0.1.6' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth402',
     commonName: '10.0.0.2' },
  serial: '016247178A17',
  notBefore: 2018-03-21T05:44:07.000Z,
  notAfter: 2018-03-22T05:45:47.000Z,
  subjectHash: '5542437f',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '97:6A:EB:00:59:68:A7:AD:3E:4D:FE:A9:B6:2A:E9:0B:40:D1:1C:A5',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'E2C77ADB548D185210E7FA2988369325521D9CF6957B61D640674333307D4FC133154B2C56A9BBCE5655BEDE59A620D2F68A660E6DEB43308DBAFD7A396559B1C6BD0ED769D2F4066CEB2BFDB38188C4D295C06D196ECCC621767B060A3D3BCF3CF4458D7031B2D0AB66B8846DD9C1D4374DEB5D3E30D68FF926574682526527828E3BB232E36626859A826F5DA69748C9567F01930811E1C310842AAE799D7FAD1E9BE8B5D23DC0BC0D4537FC44D1FE7D84E57938DEE6D651DAEC8C897885315FE2797FFB87939E2A342186F4C566B1623BD369CC0226678E3A96E9092471F81CCC14C868DBEA8B6F0B2E5D566294136E91C2B3B101366D8A5B6642614F0CF5',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.6' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 503,
  host: '10.0.1.6',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJHF4oXMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDIxETAPBgNVBAMMCDEwLjAuMC4yMB4XDTE4MDMy\nMTA1NDQwN1oXDTE4MDMyMjA1NDU0N1owYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMzERMA8GA1UEAwwIMTAuMC4xLjYwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDix3rbVI0YUhDn+imINpMlUh2c9pV7YdZAZ0MzMH1PwTMVSyxW\nqbvOVlW+3lmmINL2imYObetDMI26/Xo5ZVmxxr0O12nS9AZs6yv9s4GIxNKVwG0Z\nbszGIXZ7Bgo9O8889EWNcDGy0KtmuIRt2cHUN03rXT4w1o/5JldGglJlJ4KOO7Iy\n42YmhZqCb12ml0jJVn8BkwgR4cMQhCqueZ1/rR6b6LXSPcC8DUU3/ETR/n2E5Xk4\n3ubWUdrsjIl4hTFf4nl/+4eTnio0IYb0xWaxYjvTacwCJmeOOpbpCSRx+BzMFMho\n2+qLbwsuXVZilBNukcKzsQE2bYpbZkJhTwz1AgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQYwDQYJKoZIhvcNAQELBQADggEBAA/U/UVNfOzcZdQ4pbV0bQtut9dEjxAx\ncBdXIcek+LysVIqObTpGi6pUEEF1P0V34ZeG779l+UhbUait5Cogb6R7lbHaKd7u\nM8gQ6aEZC2Q9zcTdgcFdipvEOp4/dq1np/uMCvOKzMVKLq1ULUzJDW+khQpSMtXS\n+loQUQ8u8mPCThX6qGCIxWql7Wy9hpilNrjpIllsor6/dMwxTDay34eFuQZpjdIh\nMFbZmrZsKpozITMxto06zaaghRZ3Arq+G3hYzBCTBMkj3Ux105DwofMTuwbFSmmo\nvIxq8zKdoF3wWT38DGdwfc9+Q4A5iMb6NdewuGVDngexeQST7xpSnZs=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 11 0.7272727272727273 1521611844765
connected to auth! from local port 60914
received auth hello!
{ authId: 503, nonce: <Buffer fc 60 f4 8a a7 83 8e ce> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 77 ea 65 6a c7 05 25 2c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer ba 4d ea cb 25 d3 fd f5 e8 6b f6 5e c0 8f c3 89>,
  macKeyVal: <Buffer bd cd 13 60 fa e3 f4 f9 cc 58 68 cc ab b6 7e 3b 7e 2f fa b0 ca f3 c2 70 67 f2 b2 37 3b 11 52 7b>,
  absValidity: 2018-03-21T06:57:24.927Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300418,
  cipherKeyVal: <Buffer 2b 8a 47 d8 b7 bc d3 98 e1 7b 89 ed cd 22 86 ac>,
  macKeyVal: <Buffer 43 e9 2a e4 84 c2 07 96 ea e2 eb 97 f9 f6 6c 17 19 59 22 a4 85 50 de b9 50 90 67 9a 66 3a 90 ad>,
  absValidity: 2018-03-22T05:57:24.927Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300418,
     cipherKeyVal: <Buffer 2b 8a 47 d8 b7 bc d3 98 e1 7b 89 ed cd 22 86 ac>,
     macKeyVal: <Buffer 43 e9 2a e4 84 c2 07 96 ea e2 eb 97 f9 f6 6c 17 19 59 22 a4 85 50 de b9 50 90 67 9a 66 3a 90 ad>,
     absValidity: 2018-03-22T05:57:24.927Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 13 71 58 5e 4f fd f3 27>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.15:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 12 0.6666666666666666 1521611904776
connected to auth! from local port 32966
received auth hello!
{ authId: 503, nonce: <Buffer 7c 36 84 e8 03 a6 6e 3f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 95 1e 06 29 40 41 42 ed>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300428,
  cipherKeyVal: <Buffer 33 fc dd e1 a5 b3 4d 99 1a 43 27 08 35 82 c2 a1>,
  macKeyVal: <Buffer 0e be ad bf ec a8 f6 dd fd 34 5a 9b 89 a7 20 30 fb 19 29 da 4d 45 83 8a 40 6a 37 b6 67 d8 53 d4>,
  absValidity: 2018-03-22T05:58:24.911Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300428,
     cipherKeyVal: <Buffer 33 fc dd e1 a5 b3 4d 99 1a 43 27 08 35 82 c2 a1>,
     macKeyVal: <Buffer 0e be ad bf ec a8 f6 dd fd 34 5a 9b 89 a7 20 30 fb 19 29 da 4d 45 83 8a 40 6a 37 b6 67 d8 53 d4>,
     absValidity: 2018-03-22T05:58:24.911Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 91 41 68 fb b1 27 94 49>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.15:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 13 0.6153846153846154 1521611964785
connected to auth! from local port 33246
received auth hello!
{ authId: 503, nonce: <Buffer 03 3c f2 d9 fd da 9f cf> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d1 b0 91 d9 94 dd 34 18>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300438,
  cipherKeyVal: <Buffer b2 2b f5 dd d2 d4 fe c2 8b f1 aa f1 84 bf 87 e5>,
  macKeyVal: <Buffer 26 33 f7 21 f8 3e a5 09 8a 74 f0 2a eb 5e ce 60 eb 70 60 be 07 43 d8 8d 78 5d b5 2d 28 89 01 ab>,
  absValidity: 2018-03-22T05:59:25.596Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300438,
     cipherKeyVal: <Buffer b2 2b f5 dd d2 d4 fe c2 8b f1 aa f1 84 bf 87 e5>,
     macKeyVal: <Buffer 26 33 f7 21 f8 3e a5 09 8a 74 f0 2a eb 5e ce 60 eb 70 60 be 07 43 d8 8d 78 5d b5 2d 28 89 01 ab>,
     absValidity: 2018-03-22T05:59:25.596Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 14 0.5714285714285714 1521612024845
connected to auth! from local port 33506
received auth hello!
{ authId: 503, nonce: <Buffer ca 23 e0 51 05 29 cd 3f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 05 70 15 6c d9 9c 5c cf>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300448,
  cipherKeyVal: <Buffer 15 94 af 4e 63 3c fe 16 ec 30 72 4d aa 1a ff d4>,
  macKeyVal: <Buffer 1c db 4f 3e 67 72 04 62 d0 57 54 67 d5 e6 f1 79 9a 94 ff f3 d9 c5 1e f5 ca 46 24 46 c4 eb d9 26>,
  absValidity: 2018-03-22T06:00:25.647Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300448,
     cipherKeyVal: <Buffer 15 94 af 4e 63 3c fe 16 ec 30 72 4d aa 1a ff d4>,
     macKeyVal: <Buffer 1c db 4f 3e 67 72 04 62 d0 57 54 67 d5 e6 f1 79 9a 94 ff f3 d9 c5 1e f5 ca 46 24 46 c4 eb d9 26>,
     absValidity: 2018-03-22T06:00:25.647Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 15 0.5333333333333333 1521612084901
connected to auth! from local port 33780
received auth hello!
{ authId: 503, nonce: <Buffer dc e4 24 37 2b b4 b3 01> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 16 fd 83 bc 30 df 20 e8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300458,
  cipherKeyVal: <Buffer 7f be 5c e1 2b 8d 37 e9 8c 42 b9 f3 36 2c f3 3a>,
  macKeyVal: <Buffer c5 a8 98 3c cb 31 0d 48 21 dd 0b 95 83 6d 51 34 5d 98 a5 0e eb 5d 0d b0 22 da 68 6f 8b 0b 18 6f>,
  absValidity: 2018-03-22T06:01:25.741Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300458,
     cipherKeyVal: <Buffer 7f be 5c e1 2b 8d 37 e9 8c 42 b9 f3 36 2c f3 3a>,
     macKeyVal: <Buffer c5 a8 98 3c cb 31 0d 48 21 dd 0b 95 83 6d 51 34 5d 98 a5 0e eb 5d 0d b0 22 da 68 6f 8b 0b 18 6f>,
     absValidity: 2018-03-22T06:01:25.741Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 16 0.5 1521612144957
connected to auth! from local port 34034
received auth hello!
{ authId: 503, nonce: <Buffer 28 3d 35 2f c7 75 87 75> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 54 db e5 84 93 37 d0 aa>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300468,
  cipherKeyVal: <Buffer 27 c8 68 19 37 38 24 23 62 bb 30 82 a1 ee 49 cd>,
  macKeyVal: <Buffer 46 c3 a8 36 40 3e af c2 72 eb 98 dd ca ad 75 7f 29 8e 25 e0 7f c0 7a e6 71 91 c1 ed 74 73 fd 8f>,
  absValidity: 2018-03-22T06:02:25.214Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300468,
     cipherKeyVal: <Buffer 27 c8 68 19 37 38 24 23 62 bb 30 82 a1 ee 49 cd>,
     macKeyVal: <Buffer 46 c3 a8 36 40 3e af c2 72 eb 98 dd ca ad 75 7f 29 8e 25 e0 7f c0 7a e6 71 91 c1 ed 74 73 fd 8f>,
     absValidity: 2018-03-22T06:02:25.214Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 17 0.47058823529411764 1521612205018
connected to auth! from local port 34300
received auth hello!
{ authId: 503, nonce: <Buffer 96 7f 86 63 67 d0 fd aa> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9e c5 f6 e2 59 3d e5 8d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300478,
  cipherKeyVal: <Buffer b0 f0 6b d9 55 91 2e 5c 2c 4d ed 9b ad 1c 12 e2>,
  macKeyVal: <Buffer 34 11 44 5d aa 76 27 33 76 dc 3d 9f b0 ca ce 47 fe be ab 45 e3 a7 06 49 12 70 64 bd 14 64 b3 7d>,
  absValidity: 2018-03-22T06:03:25.277Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300478,
     cipherKeyVal: <Buffer b0 f0 6b d9 55 91 2e 5c 2c 4d ed 9b ad 1c 12 e2>,
     macKeyVal: <Buffer 34 11 44 5d aa 76 27 33 76 dc 3d 9f b0 ca ce 47 fe be ab 45 e3 a7 06 49 12 70 64 bd 14 64 b3 7d>,
     absValidity: 2018-03-22T06:03:25.277Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 18 0.4444444444444444 1521612265077
connected to auth! from local port 34566
received auth hello!
{ authId: 503, nonce: <Buffer 9a 9c 30 dc 2a f9 9d 47> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 07 af 0e 68 a8 05 9a f2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300488,
  cipherKeyVal: <Buffer 00 2f f0 f1 36 e0 31 84 d0 6e 5a ad e3 1a d4 41>,
  macKeyVal: <Buffer 2a dc d5 02 0f 68 f7 c0 ce 3b e4 ac b9 67 3c 7b 78 ad d2 22 cb 38 e8 70 37 61 15 6c 79 7e 20 ff>,
  absValidity: 2018-03-22T06:04:25.322Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300488,
     cipherKeyVal: <Buffer 00 2f f0 f1 36 e0 31 84 d0 6e 5a ad e3 1a d4 41>,
     macKeyVal: <Buffer 2a dc d5 02 0f 68 f7 c0 ce 3b e4 ac b9 67 3c 7b 78 ad d2 22 cb 38 e8 70 37 61 15 6c 79 7e 20 ff>,
     absValidity: 2018-03-22T06:04:25.322Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 19 0.42105263157894735 1521612325126
connected to auth! from local port 34838
received auth hello!
{ authId: 503, nonce: <Buffer d8 fe 61 d8 c3 80 21 cb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bb c8 03 1e 01 cd 95 f1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300498,
  cipherKeyVal: <Buffer a4 44 66 93 c2 77 d3 51 3b a9 85 5d e6 6d 32 fc>,
  macKeyVal: <Buffer ac ff 42 93 d2 68 ff a4 47 d4 13 c2 e5 a2 b5 2e 7e ee 79 a5 aa 6b 6d ae 3f 7e 6e 0e 65 36 88 ef>,
  absValidity: 2018-03-22T06:05:25.359Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300498,
     cipherKeyVal: <Buffer a4 44 66 93 c2 77 d3 51 3b a9 85 5d e6 6d 32 fc>,
     macKeyVal: <Buffer ac ff 42 93 d2 68 ff a4 47 d4 13 c2 e5 a2 b5 2e 7e ee 79 a5 aa 6b 6d ae 3f 7e 6e 0e 65 36 88 ef>,
     absValidity: 2018-03-22T06:05:25.359Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 20 0.4 1521612385185
connected to auth! from local port 35110
received auth hello!
{ authId: 503, nonce: <Buffer 7d 4b 5d 50 a2 ef c2 1f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 71 e0 6a 86 d2 73 a8 d3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300508,
  cipherKeyVal: <Buffer 02 19 4f f5 00 b4 b7 19 b6 13 15 11 eb 59 60 bc>,
  macKeyVal: <Buffer cb 53 dd 0d b6 71 00 ca d2 67 75 61 9c 38 7c 1e 4a 13 93 48 00 e1 3d 19 34 7e 1e be 94 32 fb 98>,
  absValidity: 2018-03-22T06:06:26.027Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300508,
     cipherKeyVal: <Buffer 02 19 4f f5 00 b4 b7 19 b6 13 15 11 eb 59 60 bc>,
     macKeyVal: <Buffer cb 53 dd 0d b6 71 00 ca d2 67 75 61 9c 38 7c 1e 4a 13 93 48 00 e1 3d 19 34 7e 1e be 94 32 fb 98>,
     absValidity: 2018-03-22T06:06:26.027Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 21 0.38095238095238093 1521612445220
connected to auth! from local port 35370
received auth hello!
{ authId: 503, nonce: <Buffer 44 ad ba cd 2f 86 11 64> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2f 1c 66 5e bf 41 e0 c3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300518,
  cipherKeyVal: <Buffer f0 8b 93 6c a1 dd 27 f5 4d a8 e8 d6 f7 18 b8 eb>,
  macKeyVal: <Buffer de 92 a3 0b cb b5 5f 63 cd 9b c6 31 9e c9 11 e0 33 0e 86 80 72 91 7e 66 9b d3 81 14 66 7a 81 a5>,
  absValidity: 2018-03-22T06:07:25.586Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300518,
     cipherKeyVal: <Buffer f0 8b 93 6c a1 dd 27 f5 4d a8 e8 d6 f7 18 b8 eb>,
     macKeyVal: <Buffer de 92 a3 0b cb b5 5f 63 cd 9b c6 31 9e c9 11 e0 33 0e 86 80 72 91 7e 66 9b d3 81 14 66 7a 81 a5>,
     absValidity: 2018-03-22T06:07:25.586Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 22 0.36363636363636365 1521612505238
connected to auth! from local port 35636
received auth hello!
{ authId: 503, nonce: <Buffer 86 64 bd fa a5 36 28 75> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 97 9f 89 1a c7 e1 2b ff>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300528,
  cipherKeyVal: <Buffer 00 1d 3a 91 21 3c 52 63 04 5e ec e5 0f af 11 68>,
  macKeyVal: <Buffer ef f7 79 21 59 db 9c 72 a0 0a 4d 49 e0 18 46 83 3d 0a 8f 01 0e d9 7e 5c f3 e8 38 06 75 64 2c 8c>,
  absValidity: 2018-03-22T06:08:25.619Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300528,
     cipherKeyVal: <Buffer 00 1d 3a 91 21 3c 52 63 04 5e ec e5 0f af 11 68>,
     macKeyVal: <Buffer ef f7 79 21 59 db 9c 72 a0 0a 4d 49 e0 18 46 83 3d 0a 8f 01 0e d9 7e 5c f3 e8 38 06 75 64 2c 8c>,
     absValidity: 2018-03-22T06:08:25.619Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 23 0.34782608695652173 1521612565278
connected to auth! from local port 35902
received auth hello!
{ authId: 503, nonce: <Buffer f7 92 ac 9f b0 dc 32 9f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e0 74 b7 bc c4 75 45 48>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300538,
  cipherKeyVal: <Buffer 76 ee 2f 8b 66 da 93 f4 78 ca 8a 63 3d d6 dc 8e>,
  macKeyVal: <Buffer 58 03 24 03 da d2 74 23 69 4a 56 d8 44 cd 4b 3f 82 33 95 d3 fe 36 21 14 e2 87 6c cf fa c5 3b a2>,
  absValidity: 2018-03-22T06:09:25.659Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300538,
     cipherKeyVal: <Buffer 76 ee 2f 8b 66 da 93 f4 78 ca 8a 63 3d d6 dc 8e>,
     macKeyVal: <Buffer 58 03 24 03 da d2 74 23 69 4a 56 d8 44 cd 4b 3f 82 33 95 d3 fe 36 21 14 e2 87 6c cf fa c5 3b a2>,
     absValidity: 2018-03-22T06:09:25.659Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 24 0.3333333333333333 1521612625318
connected to auth! from local port 36174
received auth hello!
{ authId: 503, nonce: <Buffer 4c 76 d5 f6 0e 44 c9 12> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 09 e2 00 19 e4 6a 8f 93>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300548,
  cipherKeyVal: <Buffer 96 80 bf 29 17 f8 30 b5 e5 a3 52 a1 47 4d 19 bf>,
  macKeyVal: <Buffer 83 e9 7c 5d 60 61 4c 98 b0 b4 97 01 82 e5 62 42 f0 6f e2 cb 54 93 9f 69 32 24 23 cd f8 68 1c e0>,
  absValidity: 2018-03-22T06:10:26.220Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300548,
     cipherKeyVal: <Buffer 96 80 bf 29 17 f8 30 b5 e5 a3 52 a1 47 4d 19 bf>,
     macKeyVal: <Buffer 83 e9 7c 5d 60 61 4c 98 b0 b4 97 01 82 e5 62 42 f0 6f e2 cb 54 93 9f 69 32 24 23 cd f8 68 1c e0>,
     absValidity: 2018-03-22T06:10:26.220Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 25 0.32 1521612685373
connected to auth! from local port 36436
received auth hello!
{ authId: 503, nonce: <Buffer b6 bb 7b 61 db 5d fb a6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 05 ae e0 43 b8 26 5e 50>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300558,
  cipherKeyVal: <Buffer 2d 13 1d 7b 7e 57 67 bf fc 7a e6 f8 58 c0 7a e2>,
  macKeyVal: <Buffer cf 89 2f c4 77 d7 27 f8 a3 28 00 0e 71 f2 94 d8 8d 4b 57 02 13 73 8a 32 80 a3 30 58 cf 1a 3b a6>,
  absValidity: 2018-03-22T06:11:26.292Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300558,
     cipherKeyVal: <Buffer 2d 13 1d 7b 7e 57 67 bf fc 7a e6 f8 58 c0 7a e2>,
     macKeyVal: <Buffer cf 89 2f c4 77 d7 27 f8 a3 28 00 0e 71 f2 94 d8 8d 4b 57 02 13 73 8a 32 80 a3 30 58 cf 1a 3b a6>,
     absValidity: 2018-03-22T06:11:26.292Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 26 0.3076923076923077 1521612745385
connected to auth! from local port 36702
received auth hello!
{ authId: 503, nonce: <Buffer 21 53 97 98 94 b3 b0 2e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer df 7d 5d 91 07 19 b9 d5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300568,
  cipherKeyVal: <Buffer 8a 58 4e cb 68 0e 9f 18 65 db fd fd 83 db 24 ed>,
  macKeyVal: <Buffer 72 ec 63 5e 67 ba 78 bf 10 36 43 7b c4 5a 84 ee 18 53 e8 d6 76 a2 c4 eb e0 4c ee b6 57 2b 7b 4c>,
  absValidity: 2018-03-22T06:12:26.297Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300568,
     cipherKeyVal: <Buffer 8a 58 4e cb 68 0e 9f 18 65 db fd fd 83 db 24 ed>,
     macKeyVal: <Buffer 72 ec 63 5e 67 ba 78 bf 10 36 43 7b c4 5a 84 ee 18 53 e8 d6 76 a2 c4 eb e0 4c ee b6 57 2b 7b 4c>,
     absValidity: 2018-03-22T06:12:26.297Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 27 0.2962962962962963 1521612805445
connected to auth! from local port 36972
received auth hello!
{ authId: 503, nonce: <Buffer 84 dc 64 6a 58 18 ea 46> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c0 7e 1e ad 67 51 cc af>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300578,
  cipherKeyVal: <Buffer cf ae c3 91 34 b5 8a c6 5c 6b 21 d8 77 5e 6a ad>,
  macKeyVal: <Buffer 67 18 0c c1 81 0d b6 b2 65 fb 52 2f ab 28 ac da 64 a9 fc 6b b5 9c 52 81 cd 55 7a ea 5d af f9 1d>,
  absValidity: 2018-03-22T06:13:26.312Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300578,
     cipherKeyVal: <Buffer cf ae c3 91 34 b5 8a c6 5c 6b 21 d8 77 5e 6a ad>,
     macKeyVal: <Buffer 67 18 0c c1 81 0d b6 b2 65 fb 52 2f ab 28 ac da 64 a9 fc 6b b5 9c 52 81 cd 55 7a ea 5d af f9 1d>,
     absValidity: 2018-03-22T06:13:26.312Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 28 0.2857142857142857 1521612865496
connected to auth! from local port 37238
received auth hello!
{ authId: 503, nonce: <Buffer b8 1c 8b 86 b3 16 61 46> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5e c5 20 a6 d7 50 f9 c3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300588,
  cipherKeyVal: <Buffer 93 fd 1b 74 7e 5a 3f b4 d4 04 27 53 e0 f1 92 ef>,
  macKeyVal: <Buffer dc 00 5f 37 96 a1 46 00 5d 9f 12 4d 6c a8 d5 41 ca 4c 48 e1 94 ec 73 f8 21 b6 85 54 1a 4f 18 03>,
  absValidity: 2018-03-22T06:14:26.329Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300588,
     cipherKeyVal: <Buffer 93 fd 1b 74 7e 5a 3f b4 d4 04 27 53 e0 f1 92 ef>,
     macKeyVal: <Buffer dc 00 5f 37 96 a1 46 00 5d 9f 12 4d 6c a8 d5 41 ca 4c 48 e1 94 ec 73 f8 21 b6 85 54 1a 4f 18 03>,
     absValidity: 2018-03-22T06:14:26.329Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
