changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s406.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's406',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 7a 42 ... > }
Handler: listening on port 22100
s406:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200362
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52580
received auth hello!
{ authId: 402, nonce: <Buffer 30 36 02 31 d8 09 47 42> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 1e 26 4d 4a 6b 95 69 8b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 3f 19 50 24 4b 80 74 86 4c 65 13 ea 7b dd c5 4a>,
  macKeyVal: <Buffer 97 6a 2f 04 42 9a 81 10 77 38 68 3f 34 da c5 12 6d 1a 3a 97 da 9f 0e 9c 24 96 4e 2a 9a f6 36 14>,
  absValidity: 2018-03-20T22:29:28.007Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cc 18 35 26 9e e4 b8 49>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer cc 18 35 26 9e e4 b8 49> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.50:39196',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200369
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52736
received auth hello!
{ authId: 402, nonce: <Buffer 53 86 f2 32 9e d9 07 5a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cd 4f ea 1e cc af e4 dc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e9 9d 66 c0 76 b9 ea 52>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e9 9d 66 c0 76 b9 ea 52> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.50:39352',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200376
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52996
received auth hello!
{ authId: 402, nonce: <Buffer f7 86 b8 79 57 fe 6e 7f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 59 ab 59 4a 16 8d 0f a3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f7 42 f8 17 30 c5 5a 41>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f7 42 f8 17 30 c5 5a 41> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.50:39612',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200383
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53266
received auth hello!
{ authId: 402, nonce: <Buffer 29 91 c6 b2 11 0a 65 9d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6a a9 73 39 b2 44 ee 71>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 84 33 e2 1a 1b 9f fc eb>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 84 33 e2 1a 1b 9f fc eb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.50:39882',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200390
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53536
received auth hello!
{ authId: 402, nonce: <Buffer 37 ee 54 af c2 0b 47 e0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 07 4b 93 62 0c 3b 6b b5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 31 4c 8c 1e 4b f6 85 d0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 31 4c 8c 1e 4b f6 85 d0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.50:40152',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200397
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53806
received auth hello!
{ authId: 402, nonce: <Buffer b7 cf 27 73 5e 10 68 53> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f4 6e 9a e9 a8 24 6e bc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer de c3 80 e9 36 15 3b 42>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer de c3 80 e9 36 15 3b 42> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.50:40422',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200404
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54076
received auth hello!
{ authId: 402, nonce: <Buffer 4d da 52 dc 14 78 07 ea> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c9 e0 71 13 92 97 29 36>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9b 50 92 0a 12 78 3c 34>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9b 50 92 0a 12 78 3c 34> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.50:40692',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200411
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54346
received auth hello!
{ authId: 402, nonce: <Buffer 8a 41 5f 8e 86 19 b4 d0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4d 48 70 87 31 a8 b4 74>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 23 7d 6a f3 40 94 d0 90>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 23 7d 6a f3 40 94 d0 90> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.50:40962',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
