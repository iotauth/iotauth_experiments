changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s412.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's412',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 67 49 42 41 41 4b 43 41 51 45 41 77 76 ... > }
Handler: listening on port 22100
s412:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300553
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55910
received auth hello!
{ authId: 403, nonce: <Buffer ef e9 67 d7 f4 de c3 a9> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 58 7d ec db bb c3 f1 24>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer c7 a8 9f ce 2c 6b 61 18 52 1d 80 88 c7 00 46 d4>,
  macKeyVal: <Buffer 75 d9 7a 81 6f e2 fc b6 6d 5a 13 d1 20 57 8b b5 1b 62 99 ad 36 35 04 70 2a be 7b d4 fd bb 55 22>,
  absValidity: 2018-03-20T22:29:50.682Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b7 8f bb c3 1a 7c 63 f7>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b7 8f bb c3 1a 7c 63 f7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.57:36748',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300559
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56108
received auth hello!
{ authId: 403, nonce: <Buffer f0 c0 42 eb 01 a4 6e 44> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d2 6d f3 92 ba 96 60 ed>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f6 10 85 59 80 99 ff 9e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f6 10 85 59 80 99 ff 9e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.57:36946',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300565
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56378
received auth hello!
{ authId: 403, nonce: <Buffer 4e 1d aa 30 3b fc 72 0b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 81 c5 df d5 a3 c4 41 e9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 41 a7 56 95 c5 41 98 56>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 41 a7 56 95 c5 41 98 56> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.57:37216',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300571
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56648
received auth hello!
{ authId: 403, nonce: <Buffer ab cb c4 61 f5 dc 27 ee> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a3 b7 52 72 1f 7d 3c e1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 75 36 82 03 b3 e3 cf 27>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 75 36 82 03 b3 e3 cf 27> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.57:37486',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300577
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56918
received auth hello!
{ authId: 403, nonce: <Buffer ab 38 5f f1 5c b4 ce b7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7d ca 2a f6 1c 05 72 64>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6a 52 53 14 b9 77 fa f1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6a 52 53 14 b9 77 fa f1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.57:37756',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300583
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57188
received auth hello!
{ authId: 403, nonce: <Buffer eb e9 63 e7 cc ab 7f 7e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 13 58 6b 37 d8 d1 11 24>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 46 0d 64 e7 d9 a6 a4 ac>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 46 0d 64 e7 d9 a6 a4 ac> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.57:38026',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300589
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57458
received auth hello!
{ authId: 403, nonce: <Buffer ca 39 8d a7 58 34 f5 ee> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e1 f1 ea e6 d7 93 b6 69>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6d ec 78 9b ba 98 12 47>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6d ec 78 9b ba 98 12 47> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.57:38296',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300595
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57724
received auth hello!
{ authId: 403, nonce: <Buffer a2 b0 c9 a2 c2 d9 87 27> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 94 28 59 e5 d5 1a ee 9b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2e 3f 94 9f db 3a aa 61>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2e 3f 94 9f db 3a aa 61> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.57:38562',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
