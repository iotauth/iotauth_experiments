changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s405.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's405',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 76 55 ... > }
Handler: listening on port 22100
s405:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200361
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48400
received auth hello!
{ authId: 402, nonce: <Buffer a1 ac 4a 44 e5 35 fa 74> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer a3 f0 21 f3 32 b7 58 3b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer a7 56 cf 35 94 36 dd eb d1 2d e1 05 14 8d 52 db>,
  macKeyVal: <Buffer d3 7a 26 f1 e1 85 6e 9b d6 dd 64 75 ce 94 e6 2c 7f d4 36 b4 14 e4 85 83 64 6e b7 73 e8 40 a5 8d>,
  absValidity: 2018-03-20T22:29:24.828Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 48 f5 13 4c 72 a7 6e c4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 48 f5 13 4c 72 a7 6e c4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.49:59126',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200368
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48550
received auth hello!
{ authId: 402, nonce: <Buffer 3b 90 9e 4f 95 1d ad 3e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer dc 3a 36 5f bd a3 45 30>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 24 95 b7 2b eb 05 63 28>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 24 95 b7 2b eb 05 63 28> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.49:59276',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200375
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48804
received auth hello!
{ authId: 402, nonce: <Buffer af 18 71 d6 3b 8a 62 1c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 69 e2 16 c7 e1 4a f2 f2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0e b0 b9 44 35 c8 29 b8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0e b0 b9 44 35 c8 29 b8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.49:59530',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200382
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49074
received auth hello!
{ authId: 402, nonce: <Buffer 89 38 74 b3 cf 30 d9 ec> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer df 1a 35 c6 d5 56 9a 48>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ba 4f e8 f1 7d 27 39 d8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ba 4f e8 f1 7d 27 39 d8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.49:59800',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200389
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49344
received auth hello!
{ authId: 402, nonce: <Buffer d4 b0 0c 7c db 54 7d 19> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8e 10 70 f0 2e b8 d2 a4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7d ed b7 a6 74 0e 6a f0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 7d ed b7 a6 74 0e 6a f0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.49:60070',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200396
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49614
received auth hello!
{ authId: 402, nonce: <Buffer 9f a3 e0 06 2b 81 ea cf> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 03 fb dc aa bf 02 02 de>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f2 95 cd e4 ce 4b 9e 20>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f2 95 cd e4 ce 4b 9e 20> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.49:60340',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200403
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49884
received auth hello!
{ authId: 402, nonce: <Buffer 58 d0 0c 7d 04 e8 af 45> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer eb ca 25 4c e9 8f fa 9f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1a 3a fe ce 2c 08 c3 98>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1a 3a fe ce 2c 08 c3 98> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.49:60610',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200410
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50154
received auth hello!
{ authId: 402, nonce: <Buffer 2a f6 b2 c1 51 95 98 a6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2b dc 9d 67 f3 42 4d 0e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2f 6f fd b4 59 11 b3 c2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2f 6f fd b4 59 11 b3 c2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.49:60880',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
