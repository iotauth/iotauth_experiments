changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s414.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's414',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 6e 70 ... > }
Handler: listening on port 22100
s414:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300552
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59028
received auth hello!
{ authId: 403, nonce: <Buffer 93 e2 bd 18 e9 8a a8 8c> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 77 a2 c9 65 4e 26 69 ff>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer c3 77 df 9f f2 18 e2 35 ee 9a ca eb 87 3c cb 7f>,
  macKeyVal: <Buffer 21 bf db c6 5a d4 38 41 84 83 f0 c5 ab a0 77 85 a6 e8 81 16 80 89 73 7d 28 e1 92 55 00 6f 12 3d>,
  absValidity: 2018-03-20T22:29:47.654Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 77 d4 f8 1e 9b 29 a7 1d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 77 d4 f8 1e 9b 29 a7 1d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.56:59834',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300558
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59220
received auth hello!
{ authId: 403, nonce: <Buffer 74 8f 35 a5 84 c7 11 6d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 98 9a 3f 47 b5 9d 12 0d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ee 2d e6 3a 83 63 c3 3e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ee 2d e6 3a 83 63 c3 3e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.56:60026',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300564
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59490
received auth hello!
{ authId: 403, nonce: <Buffer 42 83 b4 19 eb dd 7c 20> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f5 10 2d 80 e5 0c fe a0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c5 29 c4 f6 a7 6f 20 b8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c5 29 c4 f6 a7 6f 20 b8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.56:60296',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300570
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59760
received auth hello!
{ authId: 403, nonce: <Buffer 2e 1a 70 b6 1b 0e 71 9a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8b 5b 36 9f 3a 2a 56 21>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0c 44 59 8d d4 64 83 d0>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 0c 44 59 8d d4 64 83 d0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.56:60566',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300576
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60030
received auth hello!
{ authId: 403, nonce: <Buffer 83 f9 69 f5 0f 25 b3 2b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a1 34 41 78 b5 d6 41 d2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3c 9b f8 2a c6 55 da 56>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3c 9b f8 2a c6 55 da 56> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.56:60836',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300582
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60300
received auth hello!
{ authId: 403, nonce: <Buffer 4a 37 d3 62 fb df e0 c1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7a d7 60 82 d8 ad 72 44>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 72 77 3a 58 37 63 16 6a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 72 77 3a 58 37 63 16 6a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.56:32874',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300588
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60570
received auth hello!
{ authId: 403, nonce: <Buffer 91 74 a0 01 27 60 02 c2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ce 11 9c 15 7a 49 1f 93>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 88 65 b1 8b 04 cc cd 3c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 88 65 b1 8b 04 cc cd 3c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.56:33144',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300594
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60836
received auth hello!
{ authId: 403, nonce: <Buffer d7 91 a8 b4 91 83 cf bb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ec c6 11 52 37 47 68 7d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 18 b8 f9 f3 aa 92 47 fa>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 18 b8 f9 f3 aa 92 47 fa> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.56:33410',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
