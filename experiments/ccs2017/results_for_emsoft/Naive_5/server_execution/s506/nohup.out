changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s506.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's506',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 36 62 ... > }
Handler: listening on port 22100
s506:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100560
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38410
received auth hello!
{ authId: 501, nonce: <Buffer 52 81 87 48 b0 cd ed dc> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer d7 6b dc 9e 13 b3 cf e1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 07 cd cd b0 de 55 0c b3 ec d3 97 26 03 62 c7 e7>,
  macKeyVal: <Buffer 47 f5 c1 e3 1a 1a e4 2f ac 96 fa 9c 44 7b 86 f3 54 e9 d2 1a df b4 32 38 17 7b f0 c6 70 50 48 49>,
  absValidity: 2018-03-20T22:30:33.778Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3d a4 a4 ef 67 78 4b d9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3d a4 a4 ef 67 78 4b d9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.70:48540',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100568
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38676
received auth hello!
{ authId: 501, nonce: <Buffer d1 83 25 6b 40 86 e0 25> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 74 b8 58 69 61 fd ca 9c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6c 3e 9b 2a 67 7f ce aa>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6c 3e 9b 2a 67 7f ce aa> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.70:48806',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100576
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38950
received auth hello!
{ authId: 501, nonce: <Buffer d8 e5 2a f2 89 a9 f4 63> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 86 61 d3 e1 8d 6d fb f2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer eb b9 eb 6b 87 c6 cf e1>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer eb b9 eb 6b 87 c6 cf e1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.70:49080',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100584
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39216
received auth hello!
{ authId: 501, nonce: <Buffer 85 35 63 6b 38 52 a5 2f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 02 de 51 49 c7 d6 f4 db>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d9 c5 e3 e1 b6 bd 45 9b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d9 c5 e3 e1 b6 bd 45 9b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.70:49346',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100592
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39490
received auth hello!
{ authId: 501, nonce: <Buffer b6 53 3e 94 c3 ed 28 c5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e3 b6 d9 fd 78 5a 9c 1a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 44 0f 5a 05 ad 80 0e 06>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 44 0f 5a 05 ad 80 0e 06> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.70:49620',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100600
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39760
received auth hello!
{ authId: 501, nonce: <Buffer 60 fb 35 19 2a ea 24 a1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3a ca d2 f8 5d 6e d7 02>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 43 0b ba 86 7e 41 85 cd>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 43 0b ba 86 7e 41 85 cd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.70:49890',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100608
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40030
received auth hello!
{ authId: 501, nonce: <Buffer d1 75 46 79 a2 5b b8 e5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 28 a0 e0 73 1b 94 e4 f0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4d f9 9d 0c 41 d3 f7 5c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4d f9 9d 0c 41 d3 f7 5c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.70:50158',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201069
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201079
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in server - details: handshake2 timed out...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in server - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in server - details: Error occurred in migration request: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201097
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 56144
received auth hello!
{ authId: 502, nonce: <Buffer 86 ab 78 1f 79 42 e9 fc> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '0162454FC332',
  notBefore: 2018-03-20T21:26:18.000Z,
  notAfter: 2018-03-21T21:27:58.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '6F:38:43:BC:D5:F1:13:C9:CD:90:C8:0E:87:9C:0A:B9:32:A6:32:49',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'E40B9EF20959AA49D02016EC2E9896074EE0818689EAD7319ECC8ED8C9557412ED46C95E67464598F6233ECEB8BF25A876F0D30B65CED2B1FED8D1F07CF9042FD7F86E3B637BE17FBFD7C9F0DB5850835170B354A52C175B769A37BA578F965436FF29BCFD54C5D4E939E02214503C8A69FFBBF0EC06657DF9498BE98DEB26B62E1453817F6DFAE9B50EE21C5A643FF0292539838A682562303CB77FC6028B22B30B78957E4F78E539103F991928681EBF3100D31960F43F8ECFC6C2F3063B353E92BFFEF77A49BBCBF417864AE8169AA061F590E5FB3393A4592EFA1100FC186B95B83724CA0B11D8BC02BC9BD4F9E08552DE2D1EB0EE0E866E41A520730E6F',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJFT8MyMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDMy\nMDIxMjYxOFoXDTE4MDMyMTIxMjc1OFowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDkC57yCVmqSdAgFuwumJYHTuCBhonq1zGezI7YyVV0Eu1GyV5n\nRkWY9iM+zri/Jah28NMLZc7Ssf7Y0fB8+QQv1/huO2N74X+/18nw21hQg1Fws1Sl\nLBdbdpo3ulePllQ2/ym8/VTF1Ok54CIUUDyKaf+78OwGZX35SYvpjesmti4UU4F/\nbfrptQ7iHFpkP/ApJTmDimglYjA8t3/GAosiswt4lX5PeOU5ED+ZGShoHr8xANMZ\nYPQ/js/GwvMGOzU+kr/+93pJu8v0F4ZK6BaaoGH1kOX7M5OkWS76EQD8GGuVuDck\nygsR2LwCvJvU+eCFUt4tHrDuDoZuQaUgcw5vAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAI4Fqq14qkynqQF4x8rvl6Aa72v4cuva\nj124l6jPCLm2Pdc3CEIgQMwLWIY5wXnZuQqRBMrHPmNmVCqEm72idk2/NXbhf54S\nefWH/9FWM8D9LJF5accBM2VvQngbc+lNl64wy9KoPiJjbxyzusmwEyTY/+pDU8r2\nUHEhcwyzMXoFDrep2JuGQ1QleBQgulS4ifavE8PuE1gXVLO1tuM4OfXqv9ceKHiv\ndiTyfiXQNS1ljy9U5IinZk4JQKUekXHA8y6GxDAuIab9Kj+cbHWARJn2yJo3kI66\nxLVVjricwUpyO2jNNHaQPGo5G+v5Ctw+nxcswZWdBcUDkMczo3peYkI=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 1
to: 2
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201115
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56378
received auth hello!
{ authId: 502, nonce: <Buffer c8 90 65 be 4a f8 d0 47> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 3d 9c f4 4d 00 f7 13 8c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 80 af 40 f2 99 e2 fb d7 6f 3a 48 68 23 c6 b0 1a>,
  macKeyVal: <Buffer d7 ba 81 8a 56 da ca 5b 20 75 f6 98 32 9f 02 18 d9 96 24 89 d3 bb 4f ce 9f bb 2b 8f 1e a2 91 d3>,
  absValidity: 2018-03-20T22:43:35.343Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6f 51 08 b3 1c e0 e8 a0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6f 51 08 b3 1c e0 e8 a0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.70:51662',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201134
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56620
received auth hello!
{ authId: 502, nonce: <Buffer 03 dd 4e d3 ae d8 2d 25> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4d 39 ef 01 49 84 c9 56>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d8 e9 98 ca de 3c 30 98>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d8 e9 98 ca de 3c 30 98> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.70:51904',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201150
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56864
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 86 38 c1 1b db 8e 8c 7f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8a 8d a6 a5 1c bc 43 4d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4d 16 df 23 72 aa 02 27>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4d 16 df 23 72 aa 02 27> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.70:52148',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201162
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57076
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 08 84 cc 6e 2d bc 3f 9e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 19 e9 14 39 b0 b4 71 dd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bf 15 72 96 ea 24 a8 81>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bf 15 72 96 ea 24 a8 81> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.70:52360',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201180
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57296
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
received auth hello!
{ authId: 502, nonce: <Buffer 8d 8c 7c f6 4a 4f 99 24> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: write after end
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201196
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57474
Handler: Error in server - details: handshake2 timed out...
disconnected from auth
Handler: Error in server - details: Connection with Auth timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201212
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57652
received auth hello!
{ authId: 502, nonce: <Buffer eb d0 fa f5 02 bd fd 23> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 00 e2 42 b8 ae 17 40 1d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c6 68 b9 6b 30 e9 69 d8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c6 68 b9 6b 30 e9 69 d8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.70:52936',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
received auth hello!
{ authId: 502, nonce: <Buffer dd 72 15 f4 8f 49 99 19> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: write after end
disconnected from auth
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201229
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57832
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: Connection with Auth timed out...
received auth hello!
{ authId: 502, nonce: <Buffer e9 7a 72 50 9e 39 81 49> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c9 09 e2 fa 7b ea 58 f5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 95 75 d1 12 e5 e4 f3 3a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 95 75 d1 12 e5 e4 f3 3a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.70:53116',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201250
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58054
received auth hello!
{ authId: 502, nonce: <Buffer b0 c3 70 55 1d 45 34 1a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e8 e9 06 30 15 21 90 e3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8f b9 97 d0 b9 e8 03 2a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8f b9 97 d0 b9 e8 03 2a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.70:53338',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201261
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58188
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 98 a8 a3 1f cc 46 e4 90> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 31 bc 9e f9 ec a2 dd 73>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 91 f6 3e 71 ad 08 d1 4d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 91 f6 3e 71 ad 08 d1 4d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.70:53472',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201276
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58366
received auth hello!
{ authId: 502, nonce: <Buffer c3 79 5b 81 07 f2 31 70> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 89 86 46 a8 06 d0 b3 58>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2c 3a 56 b9 cc e3 b9 45>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2c 3a 56 b9 cc e3 b9 45> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.70:53650',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201293
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58546
received auth hello!
{ authId: 502, nonce: <Buffer 95 7b ef 4e 92 04 a2 7e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 24 12 71 49 12 00 88 9a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cd 53 8a 45 52 b9 e0 3f>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer cd 53 8a 45 52 b9 e0 3f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.70:53830',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201307
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58710
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201324
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58892
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
received auth hello!
{ authId: 502, nonce: <Buffer 75 55 d5 6e d3 f5 ed d5> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: write after end
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201336
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59046
received auth hello!
{ authId: 502, nonce: <Buffer 1a 74 fe 47 77 fc b4 14> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7d 26 ee 81 94 52 f5 83>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 78 dd 53 1d 77 c7 41 88>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 78 dd 53 1d 77 c7 41 88> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.70:54328',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
disconnected from auth
Handler: Error in server - details: Connection with Auth timed out...
received auth hello!
{ authId: 502, nonce: <Buffer d5 b4 df 26 27 66 b3 4b> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: write after end
