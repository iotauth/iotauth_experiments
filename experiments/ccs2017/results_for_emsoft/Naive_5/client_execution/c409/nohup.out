changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c409.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c409',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 73 4d ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521581370557
connected to auth! from local port 44158
received auth hello!
{ authId: 402, nonce: <Buffer 73 65 15 f1 97 7b f8 1f> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer dd 8d 46 5a 04 bd ea 06>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 76 20 fe 7f f7 38 a4 b3 8d 57 11 9e c6 20 65 2d>,
  macKeyVal: <Buffer 54 93 9e 25 88 29 be 4d b0 9c d5 ad 1f 15 90 39 31 ba 1e 16 92 eb 1c 71 d6 16 f2 b0 38 bd 68 c1>,
  absValidity: 2018-03-20T22:29:30.720Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200363,
  cipherKeyVal: <Buffer ea 1a d4 8d 48 93 cd fb 97 bc c8 69 28 5c 28 0d>,
  macKeyVal: <Buffer 99 37 7b d9 d4 a0 1f 04 08 d9 35 14 af af c4 47 c3 56 ef 15 03 54 3c f0 16 b6 2b 6f 01 47 f5 b7>,
  absValidity: 2018-03-21T21:29:30.720Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40200363,
     cipherKeyVal: <Buffer ea 1a d4 8d 48 93 cd fb 97 bc c8 69 28 5c 28 0d>,
     macKeyVal: <Buffer 99 37 7b d9 d4 a0 1f 04 08 d9 35 14 af af c4 47 c3 56 ef 15 03 54 3c f0 16 b6 2b 6f 01 47 f5 b7>,
     absValidity: 2018-03-21T21:29:30.720Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer bd 43 25 e5 f6 8e 8b 64>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 21:29:31 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521581371721
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521581430586
connected to auth! from local port 44320
received auth hello!
{ authId: 402, nonce: <Buffer 88 7b e0 57 ef b2 63 42> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ba 55 0c 2e 1f 9d c5 2d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200370,
  cipherKeyVal: <Buffer a7 a1 b2 21 f4 30 e5 c8 92 88 84 fe 44 6b c1 8c>,
  macKeyVal: <Buffer ba e5 37 4a 65 1c 10 dd c1 21 36 8f ca 52 33 1c 3e 51 59 4a c3 86 b9 1f b5 3a e6 b4 d9 a0 e1 8a>,
  absValidity: 2018-03-21T21:30:30.707Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40200370,
     cipherKeyVal: <Buffer a7 a1 b2 21 f4 30 e5 c8 92 88 84 fe 44 6b c1 8c>,
     macKeyVal: <Buffer ba e5 37 4a 65 1c 10 dd c1 21 36 8f ca 52 33 1c 3e 51 59 4a c3 86 b9 1f b5 3a e6 b4 d9 a0 e1 8a>,
     absValidity: 2018-03-21T21:30:30.707Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 09 c9 05 a7 01 56 66 49>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 21:30:31 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521581431660
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521581490641
connected to auth! from local port 44586
received auth hello!
{ authId: 402, nonce: <Buffer 90 9f 62 e0 8b ce c8 59> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b9 90 b2 51 72 cf 11 b1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200377,
  cipherKeyVal: <Buffer 9e cd c5 48 34 d1 81 9f 6f b5 f0 84 35 97 48 19>,
  macKeyVal: <Buffer 51 44 6b f2 c7 44 6d 7e 01 6b 78 fe ea 47 b7 c7 f0 60 00 85 f9 ed 9f f0 4f 57 c3 34 82 4a da 93>,
  absValidity: 2018-03-21T21:31:30.885Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40200377,
     cipherKeyVal: <Buffer 9e cd c5 48 34 d1 81 9f 6f b5 f0 84 35 97 48 19>,
     macKeyVal: <Buffer 51 44 6b f2 c7 44 6d 7e 01 6b 78 fe ea 47 b7 c7 f0 60 00 85 f9 ed 9f f0 4f 57 c3 34 82 4a da 93>,
     absValidity: 2018-03-21T21:31:30.885Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer d5 1c 3c 44 7a 76 13 29>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 21:31:31 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521581491840
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521581550690
connected to auth! from local port 44856
received auth hello!
{ authId: 402, nonce: <Buffer 06 8b 8a 71 30 bc bd b0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 31 74 f3 50 81 7b 81 d2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200384,
  cipherKeyVal: <Buffer 54 fc 8f a2 fe 70 16 eb 86 5e 0f 85 78 c6 d1 c9>,
  macKeyVal: <Buffer 5b f4 04 ed 26 79 ec 1b 7e 6e 24 15 e5 3f dd a3 ce eb 3c 7f e5 11 21 54 77 bc 25 fc 88 1d 79 44>,
  absValidity: 2018-03-21T21:32:30.951Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40200384,
     cipherKeyVal: <Buffer 54 fc 8f a2 fe 70 16 eb 86 5e 0f 85 78 c6 d1 c9>,
     macKeyVal: <Buffer 5b f4 04 ed 26 79 ec 1b 7e 6e 24 15 e5 3f dd a3 ce eb 3c 7f e5 11 21 54 77 bc 25 fc 88 1d 79 44>,
     absValidity: 2018-03-21T21:32:30.951Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer e4 a1 58 84 9f 03 aa d8>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 21:32:31 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521581552039
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521581610705
connected to auth! from local port 45126
received auth hello!
{ authId: 402, nonce: <Buffer 97 44 be c0 ac 97 23 6b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f0 e2 2e b0 1a 5e 4a 42>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200391,
  cipherKeyVal: <Buffer 8b 39 76 f6 8a 34 5c 11 bd 8f 4c 76 f7 fe 65 4d>,
  macKeyVal: <Buffer c1 e2 e4 dc 78 09 cb 1a af fd f0 40 a8 8e d2 96 6f b2 0b 12 47 59 68 83 32 b6 0a e6 7b c2 65 2e>,
  absValidity: 2018-03-21T21:33:30.887Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40200391,
     cipherKeyVal: <Buffer 8b 39 76 f6 8a 34 5c 11 bd 8f 4c 76 f7 fe 65 4d>,
     macKeyVal: <Buffer c1 e2 e4 dc 78 09 cb 1a af fd f0 40 a8 8e d2 96 6f b2 0b 12 47 59 68 83 32 b6 0a e6 7b c2 65 2e>,
     absValidity: 2018-03-21T21:33:30.887Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 0c fb 04 ef f4 12 85 6f>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 21:33:31 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521581611792
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521581670764
connected to auth! from local port 45396
received auth hello!
{ authId: 402, nonce: <Buffer b9 35 1d 48 e1 a7 85 e9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0a 9f c8 64 82 21 62 c3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200398,
  cipherKeyVal: <Buffer 00 ea 33 cc ca 48 c5 0b c6 5f 13 fc 6e 2a 21 8f>,
  macKeyVal: <Buffer 85 f2 75 86 1c d0 0a 21 81 f5 82 ca 83 3e 2a 08 f6 9e 4a 52 5e b3 bd 54 41 38 b2 d7 ff 4c b1 26>,
  absValidity: 2018-03-21T21:34:30.917Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40200398,
     cipherKeyVal: <Buffer 00 ea 33 cc ca 48 c5 0b c6 5f 13 fc 6e 2a 21 8f>,
     macKeyVal: <Buffer 85 f2 75 86 1c d0 0a 21 81 f5 82 ca 83 3e 2a 08 f6 9e 4a 52 5e b3 bd 54 41 38 b2 d7 ff 4c b1 26>,
     absValidity: 2018-03-21T21:34:30.917Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer f3 3f 5f a1 a9 83 d6 47>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 21:34:31 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521581671992
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521581730771
connected to auth! from local port 45664
received auth hello!
{ authId: 402, nonce: <Buffer 7a 25 93 fc 08 59 b0 7a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2b 6c 18 3d 31 29 1f 61>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200405,
  cipherKeyVal: <Buffer 5f 82 ba a2 8b 0e f9 da fa 0f b5 7a 7c ef 3b 2d>,
  macKeyVal: <Buffer 42 14 e6 4a e8 36 0a 27 dd d6 27 42 34 4b 11 56 9d 43 07 5f 6a 1f 47 ea 66 fc e1 a1 7e fa 18 43>,
  absValidity: 2018-03-21T21:35:31.063Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40200405,
     cipherKeyVal: <Buffer 5f 82 ba a2 8b 0e f9 da fa 0f b5 7a 7c ef 3b 2d>,
     macKeyVal: <Buffer 42 14 e6 4a e8 36 0a 27 dd d6 27 42 34 4b 11 56 9d 43 07 5f 6a 1f 47 ea 66 fc e1 a1 7e fa 18 43>,
     absValidity: 2018-03-21T21:35:31.063Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 14 78 92 dd 9b 84 35 a3>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 21:35:31 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521581732183
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521581790813
connected to auth! from local port 45936
received auth hello!
{ authId: 402, nonce: <Buffer 84 11 0a a5 b4 91 7a 05> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a3 ae 5e bc c9 20 21 57>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200412,
  cipherKeyVal: <Buffer 44 0f 6d a5 a6 39 37 16 73 ac 3d 5f 4e 79 a9 59>,
  macKeyVal: <Buffer e7 cf 07 eb 46 1d 41 ff 76 01 05 54 1e 5b 89 29 76 7f 9f ff eb 79 72 51 79 71 69 1f 98 40 cd ef>,
  absValidity: 2018-03-21T21:36:30.965Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40200412,
     cipherKeyVal: <Buffer 44 0f 6d a5 a6 39 37 16 73 ac 3d 5f 4e 79 a9 59>,
     macKeyVal: <Buffer e7 cf 07 eb 46 1d 41 ff 76 01 05 54 1e 5b 89 29 76 7f 9f ff eb 79 72 51 79 71 69 1f 98 40 cd ef>,
     absValidity: 2018-03-21T21:36:30.965Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 90 a4 4f 05 53 fe c8 a7>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 21:36:31 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 8 1 1521581791941
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 9 0.8888888888888888 1521581850873
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 10 0.8 1521581910881
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 58488
received auth hello!
{ authId: 502, nonce: <Buffer 07 00 6c 7d 6e 72 63 97> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 11 0.7272727272727273 1521581970890
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 58698
received auth hello!
{ authId: 502, nonce: <Buffer cc e7 1b 34 15 c4 8d 15> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 12 0.6666666666666666 1521582030901
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 13 0.6153846153846154 1521582090907
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 38330
received auth hello!
{ authId: 401, nonce: <Buffer bd 5c 0a 7c 97 96 6e 71> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth401',
     commonName: '10.0.1.1' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth402',
     commonName: '10.0.0.2' },
  serial: '0162454FBF39',
  notBefore: 2018-03-20T21:26:16.000Z,
  notAfter: 2018-03-21T21:27:56.000Z,
  subjectHash: 'de555cae',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'FE:FD:D7:99:1F:78:2C:CB:28:B1:FD:1F:99:CD:6B:33:1C:77:78:FC',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'B95EF3029A4C4FAE066EFDE0A6119C37979EDB5A64C834CFDC68175183A2CCB6F817A6CEE1A9EF3E562CF75048E8894B6036030296F313DEBF7C1069E42825C46A5F1F6D69FFE10EE6D73B7805503AA7E6A4C2FF62C2E4D5BF7079FBED00C4B24480D5BC43B7B3B042025990D06DEE0A0388CF2AE7F4B313EF564F2EB3931C44FD1DBD6DFA6DA12843C6DBAAE1EFBC5E7EEDA9407AE6D78B6211169F194056CA6F9CD9F20F33FE469D35BCC944D43D2ECB947F73AF95BB5530BFF2A9B92CA16EB949D06EB8218BBBEC8EA009AC9F6C53C626A2796484448AEDAAB3D19834BA2A19D35D0E105AD47B9A6B3E1589517039E098E992676ED418010E608FA312B251',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.1' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 401,
  host: '10.0.1.1',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJFT785MA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDIxETAPBgNVBAMMCDEwLjAuMC4yMB4XDTE4MDMy\nMDIxMjYxNloXDTE4MDMyMTIxMjc1NlowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDQwMTERMA8GA1UEAwwIMTAuMC4xLjEwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQC5XvMCmkxPrgZu/eCmEZw3l57bWmTINM/caBdRg6LMtvgXps7h\nqe8+Viz3UEjoiUtgNgMClvMT3r98EGnkKCXEal8fbWn/4Q7m1zt4BVA6p+akwv9i\nwuTVv3B5++0AxLJEgNW8Q7ezsEICWZDQbe4KA4jPKuf0sxPvVk8us5McRP0dvW36\nbaEoQ8bbquHvvF5+7alAeubXi2IRFp8ZQFbKb5zZ8g8z/kadNbzJRNQ9LsuUf3Ov\nlbtVML/yqbksoW65SdBuuCGLu+yOoAmsn2xTxiaieWSERIrtqrPRmDS6KhnTXQ4Q\nWtR7mms+FYlRcDngmOmSZ27UGAEOYI+jErJRAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQEwDQYJKoZIhvcNAQELBQADggEBAJGql4M6RsX615fMFAmNdHqgwqFqAden\nHVLK+G1opS7GTHHf4Y5q/f5fvpg/131/QZefGEMnENp2yGodOGxSF9sdKHkIcCkU\nc3jGyCwPbEvuLqT4BPWB7TQ9DwuCrtiEHW2EEhTI36daNUbi8KA6sTXSk6I7zvxZ\nb7OSDx4119opuCk9vjOZhx1fw8LFV7bo3klbm9wwttES+2pJR8J4OsFl2NtamBMh\nAfQuqjxwqlLLphQXIUMUaPhLt8HFzy+ytir3huOe0s6CegI6+TFgdMrUJ2wVKpXH\nq3WMvDb1tl18ZL8QbkELhxZHfhCUXC09t0dHmOjAMAxrXfctKiZiHOE=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 2
to: 3
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 14 0.5714285714285714 1521582150918
connected to auth! from local port 38556
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 15 0.5333333333333333 1521582210928
connected to auth! from local port 38798
received auth hello!
{ authId: 401, nonce: <Buffer d7 41 2d bc 91 76 c3 e8> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 30 2c 4e c8 c9 fe 8f 40>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 4d 8f ea dd c0 94 a8 76 88 81 9b f3 ba 46 45 11>,
  macKeyVal: <Buffer 76 5e 13 bc 1c cb 79 23 40 1d 6f ce a9 e5 17 ac 42 75 5f 97 5a 2d a9 3a 10 e9 13 aa 8c ea 9b 82>,
  absValidity: 2018-03-20T22:43:31.091Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101133,
  cipherKeyVal: <Buffer 39 39 63 a8 82 e6 c0 63 cb 9b 63 e6 4f 38 36 ee>,
  macKeyVal: <Buffer fa f2 53 80 c7 ef c9 5b 3c 8d f2 d4 ff 3b 2d 62 3b 5a 6f 2d 2d 3c 1e 74 93 b2 73 4a 7c 4a 8f 7b>,
  absValidity: 2018-03-21T21:43:31.091Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40101133,
     cipherKeyVal: <Buffer 39 39 63 a8 82 e6 c0 63 cb 9b 63 e6 4f 38 36 ee>,
     macKeyVal: <Buffer fa f2 53 80 c7 ef c9 5b 3c 8d f2 d4 ff 3b 2d 62 3b 5a 6f 2d 2d 3c 1e 74 93 b2 73 4a 7c 4a 8f 7b>,
     absValidity: 2018-03-21T21:43:31.091Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 81 c5 12 b6 52 c9 b0 d3>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.14:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 16 0.5 1521582270929
connected to auth! from local port 39044
received auth hello!
{ authId: 401, nonce: <Buffer 67 32 c0 4f d0 9a 25 1c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5d 23 ac 4b 9c 7d cd f5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101143,
  cipherKeyVal: <Buffer d4 0b 15 d3 4c c4 b2 88 8b 6d 0c 54 4b 67 c3 c3>,
  macKeyVal: <Buffer 63 61 cc 75 17 b4 ce 83 d3 f5 aa 24 8a 84 b4 8e f7 16 a7 03 2b 4d 06 13 f4 ca 51 cf 66 7b f0 25>,
  absValidity: 2018-03-21T21:44:34.700Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40101143,
     cipherKeyVal: <Buffer d4 0b 15 d3 4c c4 b2 88 8b 6d 0c 54 4b 67 c3 c3>,
     macKeyVal: <Buffer 63 61 cc 75 17 b4 ce 83 d3 f5 aa 24 8a 84 b4 8e f7 16 a7 03 2b 4d 06 13 f4 ca 51 cf 66 7b f0 25>,
     absValidity: 2018-03-21T21:44:34.700Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer fc 09 bb 1a b4 fc e9 d7>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.14:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 17 0.47058823529411764 1521582330936
connected to auth! from local port 39270
received auth hello!
{ authId: 401, nonce: <Buffer e4 83 30 5b 61 06 bf 0b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 11 37 8c 8e 27 db 76 a7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101153,
  cipherKeyVal: <Buffer c5 27 89 a2 fa b9 d1 7f e0 6b c5 25 e6 cb 8c 66>,
  macKeyVal: <Buffer bc d6 2c e7 8c 7e 52 3a ea 7c 9c 22 00 f4 59 0e 7a 23 b9 45 53 ff 1a 46 e5 e9 46 f3 d8 31 e5 1b>,
  absValidity: 2018-03-21T21:45:34.037Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40101153,
     cipherKeyVal: <Buffer c5 27 89 a2 fa b9 d1 7f e0 6b c5 25 e6 cb 8c 66>,
     macKeyVal: <Buffer bc d6 2c e7 8c 7e 52 3a ea 7c 9c 22 00 f4 59 0e 7a 23 b9 45 53 ff 1a 46 e5 e9 46 f3 d8 31 e5 1b>,
     absValidity: 2018-03-21T21:45:34.037Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer c7 ec 54 1a a7 e3 05 ff>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.14:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 18 0.4444444444444444 1521582390943
connected to auth! from local port 39494
received auth hello!
{ authId: 401, nonce: <Buffer 72 c7 11 d1 45 ea 29 0b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 01 0e c2 10 a2 9c c4 c2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101165,
  cipherKeyVal: <Buffer db ae 5a 78 10 d6 38 9b 07 53 f1 92 d2 4b f6 a3>,
  macKeyVal: <Buffer f8 32 9b d0 cf 18 16 83 61 6d b9 b7 13 48 0f d3 f7 6e a8 ef 3c fc 42 5c 3e 24 0e 53 a3 1a cf ce>,
  absValidity: 2018-03-21T21:46:37.694Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40101165,
     cipherKeyVal: <Buffer db ae 5a 78 10 d6 38 9b 07 53 f1 92 d2 4b f6 a3>,
     macKeyVal: <Buffer f8 32 9b d0 cf 18 16 83 61 6d b9 b7 13 48 0f d3 f7 6e a8 ef 3c fc 42 5c 3e 24 0e 53 a3 1a cf ce>,
     absValidity: 2018-03-21T21:46:37.694Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer e6 09 56 93 3f c5 0d 50>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Disconnected from auth before getting session key response
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.14:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 19 0.42105263157894735 1521582450946
connected to auth! from local port 39716
received auth hello!
{ authId: 401, nonce: <Buffer 70 3a 4d ba 0a 8e 33 47> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6c e1 bf 17 2d 13 a1 37>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101177,
  cipherKeyVal: <Buffer 43 6e ed 58 39 ed 0b 4c af 1f 54 66 5e 22 73 58>,
  macKeyVal: <Buffer 15 99 08 52 d9 ee a2 1a 88 ac 13 ac 17 d5 e3 bb d7 d0 64 33 ca 21 ad 1b ec 6f ca 40 f7 ca cb 5f>,
  absValidity: 2018-03-21T21:47:37.656Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40101177,
     cipherKeyVal: <Buffer 43 6e ed 58 39 ed 0b 4c af 1f 54 66 5e 22 73 58>,
     macKeyVal: <Buffer 15 99 08 52 d9 ee a2 1a 88 ac 13 ac 17 d5 e3 bb d7 d0 64 33 ca 21 ad 1b ec 6f ca 40 f7 ca cb 5f>,
     absValidity: 2018-03-21T21:47:37.656Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer d2 67 de 2e 39 bb 54 fe>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.14:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 20 0.4 1521582510949
connected to auth! from local port 39892
received auth hello!
{ authId: 401, nonce: <Buffer 56 fd ee 8e ef fc 78 07> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cf 60 58 94 87 a2 1f 9f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101189,
  cipherKeyVal: <Buffer 1a 43 16 ad 0b d2 07 70 cb c6 86 43 a4 0b b6 83>,
  macKeyVal: <Buffer 78 a7 b7 3c af 29 da e2 e4 08 94 29 e8 b2 70 d9 5b 74 57 0f 58 c2 72 a9 f2 25 e4 16 e8 a2 75 7a>,
  absValidity: 2018-03-21T21:48:38.745Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40101189,
     cipherKeyVal: <Buffer 1a 43 16 ad 0b d2 07 70 cb c6 86 43 a4 0b b6 83>,
     macKeyVal: <Buffer 78 a7 b7 3c af 29 da e2 e4 08 94 29 e8 b2 70 d9 5b 74 57 0f 58 c2 72 a9 f2 25 e4 16 e8 a2 75 7a>,
     absValidity: 2018-03-21T21:48:38.745Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 8c 82 ce 6a d8 64 0b 2e>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.14:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 21 0.38095238095238093 1521582570951
connected to auth! from local port 40074
received auth hello!
{ authId: 401, nonce: <Buffer 67 2c 63 01 b4 42 b9 c8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c4 cc 8c 9c 42 e0 e0 97>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101201,
  cipherKeyVal: <Buffer 8c c3 6c 61 02 d0 31 28 1f d8 e2 08 8e a3 7a 12>,
  macKeyVal: <Buffer 72 84 a2 66 93 3d ab ac 34 25 2a 37 be 1e ab 95 5b c7 54 70 72 25 38 5f 74 2e 59 93 59 ed 62 0f>,
  absValidity: 2018-03-21T21:49:38.763Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40101201,
     cipherKeyVal: <Buffer 8c c3 6c 61 02 d0 31 28 1f d8 e2 08 8e a3 7a 12>,
     macKeyVal: <Buffer 72 84 a2 66 93 3d ab ac 34 25 2a 37 be 1e ab 95 5b c7 54 70 72 25 38 5f 74 2e 59 93 59 ed 62 0f>,
     absValidity: 2018-03-21T21:49:38.763Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 4b d1 63 75 7f b4 f9 e6>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.14:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 22 0.36363636363636365 1521582630954
connected to auth! from local port 40258
received auth hello!
{ authId: 401, nonce: <Buffer de 1b 2b 4d 8f 9a da 7b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cc 6c 74 5b ce be 22 51>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101213,
  cipherKeyVal: <Buffer d7 52 1d 1e d9 4c 3f 7d 04 08 10 e5 f0 d6 1f 21>,
  macKeyVal: <Buffer 5e 9f 84 5a 54 31 b4 70 34 b7 7b f3 2d 84 01 c5 46 95 7a 58 a3 40 b5 cf 4a 88 8e 42 77 d4 71 22>,
  absValidity: 2018-03-21T21:50:38.841Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40101213,
     cipherKeyVal: <Buffer d7 52 1d 1e d9 4c 3f 7d 04 08 10 e5 f0 d6 1f 21>,
     macKeyVal: <Buffer 5e 9f 84 5a 54 31 b4 70 34 b7 7b f3 2d 84 01 c5 46 95 7a 58 a3 40 b5 cf 4a 88 8e 42 77 d4 71 22>,
     absValidity: 2018-03-21T21:50:38.841Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer cb a7 11 39 c7 27 93 d6>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.14:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 23 0.34782608695652173 1521582690956
connected to auth! from local port 40434
received auth hello!
{ authId: 401, nonce: <Buffer 4f a3 0a 11 a2 fe 3a 9a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c3 fa 0b 32 fd 8a a0 dc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101222,
  cipherKeyVal: <Buffer b2 38 35 2c 0c 3e 96 e3 66 b6 af 80 30 ee 81 cc>,
  macKeyVal: <Buffer 41 2a 4f a9 29 a0 e8 1e 5f 17 19 2e 0c 61 4c 90 51 ae 0f 03 9e 8c 23 b1 5c 65 90 43 67 89 81 09>,
  absValidity: 2018-03-21T21:51:34.711Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40101222,
     cipherKeyVal: <Buffer b2 38 35 2c 0c 3e 96 e3 66 b6 af 80 30 ee 81 cc>,
     macKeyVal: <Buffer 41 2a 4f a9 29 a0 e8 1e 5f 17 19 2e 0c 61 4c 90 51 ae 0f 03 9e 8c 23 b1 5c 65 90 43 67 89 81 09>,
     absValidity: 2018-03-21T21:51:34.711Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 3f 17 2b 68 cc 89 bd d4>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.14:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 24 0.3333333333333333 1521582750963
connected to auth! from local port 40600
received auth hello!
{ authId: 401, nonce: <Buffer a1 0f 1c 75 d7 c2 34 d6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c7 05 0c 4d 1d 87 33 a1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101234,
  cipherKeyVal: <Buffer 9d 4b 3c 64 63 1b 0f e8 6a a9 01 4c 09 a8 a1 a3>,
  macKeyVal: <Buffer bf be 73 f9 5e bb a5 c7 21 88 4b bd 00 06 e2 09 34 d2 38 d0 ba 2b f6 f3 ad 20 53 8c 34 a2 2d b4>,
  absValidity: 2018-03-21T21:52:34.784Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40101234,
     cipherKeyVal: <Buffer 9d 4b 3c 64 63 1b 0f e8 6a a9 01 4c 09 a8 a1 a3>,
     macKeyVal: <Buffer bf be 73 f9 5e bb a5 c7 21 88 4b bd 00 06 e2 09 34 d2 38 d0 ba 2b f6 f3 ad 20 53 8c 34 a2 2d b4>,
     absValidity: 2018-03-21T21:52:34.784Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer c3 3d 88 8b 31 5c 93 70>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.14:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 25 0.32 1521582810969
connected to auth! from local port 40770
received auth hello!
{ authId: 401, nonce: <Buffer d9 73 00 a9 e9 a8 72 7c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d6 20 67 96 1c 62 84 cd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101247,
  cipherKeyVal: <Buffer 2d d9 31 b9 ed 3f 22 41 61 d9 83 73 a9 c0 77 9f>,
  macKeyVal: <Buffer a1 3b 95 80 63 08 2e b7 4a cf 4e dc b9 1c 98 2f 9e 34 b0 d9 39 bc c5 94 34 54 9e a4 90 0d 5c 12>,
  absValidity: 2018-03-21T21:53:35.353Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40101247,
     cipherKeyVal: <Buffer 2d d9 31 b9 ed 3f 22 41 61 d9 83 73 a9 c0 77 9f>,
     macKeyVal: <Buffer a1 3b 95 80 63 08 2e b7 4a cf 4e dc b9 1c 98 2f 9e 34 b0 d9 39 bc c5 94 34 54 9e a4 90 0d 5c 12>,
     absValidity: 2018-03-21T21:53:35.353Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 58 13 ed cf 2a 25 27 79>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.14:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 26 0.3076923076923077 1521582870973
connected to auth! from local port 40950
received auth hello!
{ authId: 401, nonce: <Buffer 08 68 93 c4 cc 1a 7f 40> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 73 5e da b8 bc ad 2e 39>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101259,
  cipherKeyVal: <Buffer 48 3c 13 9d 5e a5 fa fc e4 8e 69 b9 80 62 64 ef>,
  macKeyVal: <Buffer f5 8a ca 77 0e 7a 5b 53 04 1b 04 9b d1 ee 2f 8b 3c 37 74 8a ba 6c c2 cb 72 00 59 7b 61 c1 e2 49>,
  absValidity: 2018-03-21T21:54:34.721Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40101259,
     cipherKeyVal: <Buffer 48 3c 13 9d 5e a5 fa fc e4 8e 69 b9 80 62 64 ef>,
     macKeyVal: <Buffer f5 8a ca 77 0e 7a 5b 53 04 1b 04 9b d1 ee 2f 8b 3c 37 74 8a ba 6c c2 cb 72 00 59 7b 61 c1 e2 49>,
     absValidity: 2018-03-21T21:54:34.721Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer f8 1c 64 63 2c 30 ef 2a>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.14:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 27 0.2962962962962963 1521582930977
connected to auth! from local port 41122
received auth hello!
{ authId: 401, nonce: <Buffer 5d 30 d3 8d 1d 72 b7 46> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d0 e7 73 f1 6e 1f 20 14>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101271,
  cipherKeyVal: <Buffer c3 c7 8b 3e b9 d8 03 83 78 80 e5 bc 4e a9 6d 1b>,
  macKeyVal: <Buffer 20 74 3d 46 58 ff 98 7e 50 13 97 a5 6b 7e b4 8e b9 bd 96 f1 4e 1d 00 ca d7 5c 50 8e 4c 94 68 f3>,
  absValidity: 2018-03-21T21:55:34.711Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40101271,
     cipherKeyVal: <Buffer c3 c7 8b 3e b9 d8 03 83 78 80 e5 bc 4e a9 6d 1b>,
     macKeyVal: <Buffer 20 74 3d 46 58 ff 98 7e 50 13 97 a5 6b 7e b4 8e b9 bd 96 f1 4e 1d 00 ca d7 5c 50 8e 4c 94 68 f3>,
     absValidity: 2018-03-21T21:55:34.711Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 66 92 5f 28 56 e6 e0 a2>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.14:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 28 0.2857142857142857 1521582990984
connected to auth! from local port 41288
received auth hello!
{ authId: 401, nonce: <Buffer 8c 1c ce 3c 4c ee 91 db> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d4 73 60 29 16 b5 b1 a9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101285,
  cipherKeyVal: <Buffer eb 19 87 39 6d 96 1d 28 7b 2c 2c ef 18 f4 ee 08>,
  macKeyVal: <Buffer 2d b4 67 07 5a e0 80 70 6b 22 65 f6 78 87 54 53 b2 42 9a a0 a3 e0 07 19 41 8e 98 db 42 06 4d 3f>,
  absValidity: 2018-03-21T21:56:34.811Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40101285,
     cipherKeyVal: <Buffer eb 19 87 39 6d 96 1d 28 7b 2c 2c ef 18 f4 ee 08>,
     macKeyVal: <Buffer 2d b4 67 07 5a e0 80 70 6b 22 65 f6 78 87 54 53 b2 42 9a a0 a3 e0 07 19 41 8e 98 db 42 06 4d 3f>,
     absValidity: 2018-03-21T21:56:34.811Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 20 89 b9 42 c2 54 a9 19>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.14:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 29 0.27586206896551724 1521583050990
connected to auth! from local port 41466
received auth hello!
{ authId: 401, nonce: <Buffer dd 40 39 1c e1 3e b5 cd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f6 9b 49 8d 5b c3 ce 70>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101297,
  cipherKeyVal: <Buffer a4 ca 16 5e 6c f0 f3 e5 11 83 d0 76 fc 11 e0 16>,
  macKeyVal: <Buffer 17 97 62 7b e7 f6 4d 48 56 de cd 6d bd 01 7e 01 93 fb 69 9e 3f 5c 6a dc 3e 70 a5 87 1d 2f 74 e7>,
  absValidity: 2018-03-21T21:57:34.820Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40101297,
     cipherKeyVal: <Buffer a4 ca 16 5e 6c f0 f3 e5 11 83 d0 76 fc 11 e0 16>,
     macKeyVal: <Buffer 17 97 62 7b e7 f6 4d 48 56 de cd 6d bd 01 7e 01 93 fb 69 9e 3f 5c 6a dc 3e 70 a5 87 1d 2f 74 e7>,
     absValidity: 2018-03-21T21:57:34.820Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 96 53 35 f9 96 06 ef 9b>
switching to HANDSHAKE_1_SENT
disconnected from auth
