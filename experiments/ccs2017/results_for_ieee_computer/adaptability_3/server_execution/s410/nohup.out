changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s410.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's410',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 34 4f ... > }
Handler: listening on port 22100
s410:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200004
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58874
received auth hello!
{ authId: 402, nonce: <Buffer bc d2 d7 e3 16 38 c5 d7> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer fd b6 e7 a8 bc 4b df 43>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer d9 db 47 4c e8 8a 53 ba 6e 5f a8 d7 48 3c 05 e3>,
  macKeyVal: <Buffer 52 5d 67 a8 0a 66 79 ff 20 71 3b b2 e7 2c 79 cd 03 04 e4 33 31 3c 6e 8d b7 21 fc 95 8d 2d 6d 03>,
  absValidity: 2018-08-27T06:10:06.324Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6e cc 01 a8 e8 a4 cb d9>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 6e cc 01 a8 e8 a4 cb d9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.53:50302',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200011
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59048
received auth hello!
{ authId: 402, nonce: <Buffer ab 04 e7 12 12 af 91 c7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0e c9 cb 9f 87 98 5f 01>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7e 6d 5c 3d 4c b6 0a 3f>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 7e 6d 5c 3d 4c b6 0a 3f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.53:50476',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200018
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59320
received auth hello!
{ authId: 402, nonce: <Buffer 61 f9 40 84 a7 57 e7 54> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2e 82 fd db 58 7a 3c 35>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b0 35 33 58 e9 14 9b 43>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b0 35 33 58 e9 14 9b 43> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.53:50748',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200025
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59590
received auth hello!
{ authId: 402, nonce: <Buffer 06 a4 50 bb 3a ad a6 55> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f6 86 5d b9 36 18 67 ab>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 73 bf 5c 34 8b 03 a5 5b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 73 bf 5c 34 8b 03 a5 5b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.53:51018',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200032
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59860
received auth hello!
{ authId: 402, nonce: <Buffer 8f 58 30 6a 2e ec 00 68> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cf 17 18 b3 68 ad d0 de>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ee 68 9a 57 74 e4 70 bd>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ee 68 9a 57 74 e4 70 bd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.53:51288',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200039
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60130
received auth hello!
{ authId: 402, nonce: <Buffer 46 06 9f 27 87 e3 3f 51> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 68 0b a9 03 87 17 df 4a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f3 37 48 56 14 56 e4 7f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f3 37 48 56 14 56 e4 7f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.53:51558',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200046
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60400
received auth hello!
{ authId: 402, nonce: <Buffer 32 af 80 6a cf 03 12 e0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 97 d9 18 d1 13 38 2b 25>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a0 66 00 54 d4 f8 96 5d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a0 66 00 54 d4 f8 96 5d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.53:51828',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200053
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60670
received auth hello!
{ authId: 402, nonce: <Buffer 54 f5 96 58 db 33 cb 77> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5f c3 90 59 d2 b6 9c b2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 50 f6 71 6b aa bc b0 fc>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 50 f6 71 6b aa bc b0 fc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.53:52098',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300048
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300057
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 58350
received auth hello!
{ authId: 503, nonce: <Buffer 61 df 83 e7 ed 0a dd 99> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth503',
     commonName: '10.0.1.6' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth402',
     commonName: '10.0.0.2' },
  serial: '016579C87021',
  notBefore: 2018-08-27T05:06:43.000Z,
  notAfter: 2018-08-28T05:08:23.000Z,
  subjectHash: '5542437f',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '68:BF:36:07:2D:1C:30:91:BB:08:D4:49:25:FC:98:4F:3C:A8:48:FF',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'C063304DB50CD53E197DA75E4D40E26CDC5CD8A0B32AE61DE61F1B45D952A4AF504A623AA81A434BF3E719B4A8575E7DDC5B6CC79B91CF65119617906A6FA524F36EC3EAE0F3DABF0A5C0AF3124582FA817364EADACDA8D4A54541FE1D7273B13153904D7ABF1DD6A3BF9BFA47F7F69CD4C5F6151308FEBCE9EE63FDB48DE4B6C6978CC71151410FFAF44FDE861DF2EDC5F88548D16C40246200EED97C3B814BDC01DD1AFC3F60F99ABEBD64A0E24D8796B1FE22F89D53C7EB16B6B4F840F5DB2C5AEC1002EF2EA80C5AB75602301EFC5B3670EC56D96F7DE45F5A21269F4EDB30218677BC8AFCD1869D96E6E189BBBD3B0DD9515A937856DB9BE293411F4ACD',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.6' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 503,
  host: '10.0.1.6',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWV5yHAhMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDIxETAPBgNVBAMMCDEwLjAuMC4yMB4XDTE4MDgy\nNzA1MDY0M1oXDTE4MDgyODA1MDgyM1owYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMzERMA8GA1UEAwwIMTAuMC4xLjYwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDAYzBNtQzVPhl9p15NQOJs3FzYoLMq5h3mHxtF2VKkr1BKYjqo\nGkNL8+cZtKhXXn3cW2zHm5HPZRGWF5Bqb6Uk827D6uDz2r8KXArzEkWC+oFzZOra\nzajUpUVB/h1yc7ExU5BNer8d1qO/m/pH9/ac1MX2FRMI/rzp7mP9tI3ktsaXjMcR\nUUEP+vRP3oYd8u3F+IVI0WxAJGIA7tl8O4FL3AHdGvw/YPmavr1koOJNh5ax/iL4\nnVPH6xa2tPhA9dssWuwQAu8uqAxat1YCMB78WzZw7FbZb33kX1ohJp9O2zAhhne8\nivzRhp2W5uGJu707DdlRWpN4Vtub4pNBH0rNAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQYwDQYJKoZIhvcNAQELBQADggEBAJQJVCso9BPUDFxxRxRC9jep4WSd7pJu\nFGNZlXTPa6G3WGJ+rQv8Tg/cGYvN5j/xetGGyANHRKPg56/W+9wWW38uA2idktLM\nCk2K/OdbU1IDb7XJRQFl+n3iwSmgzwG+meBXrwOpc+RgP4x4E9SbG+iHwp63lw8C\nupKVukWvf6ruytFGKi68PiclmdiP+gzHF9JguW9Y5RRIFrCEJtrbjPigpIoaeYMX\nq9Ar9k1Gj5UoyAhpW10TneCZjc4WJV50rR6WsWRvMJ54GVZP5Iie64sTU5AgyW4t\ncRZHVy7DtUq1cUfOKpeeeZfWmp8EnB9PdETR8nmVuaDAYyHx+aAZWjU=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300066
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58606
received auth hello!
{ authId: 503, nonce: <Buffer 73 80 8f 7a 76 9b 10 8b> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 04 d6 61 d4 80 7d b1 23>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer f5 ed 80 b1 67 88 c6 08 b8 9c 3c ec 1a 01 20 8c>,
  macKeyVal: <Buffer f9 d6 e0 79 5f 7f 3e 70 b2 3f 14 08 c4 a6 16 52 86 ef ad 6f 79 88 38 f2 16 31 49 e4 16 70 11 ca>,
  absValidity: 2018-08-27T06:22:06.020Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer de 0f f7 e8 da 8a 57 bc>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer de 0f f7 e8 da 8a 57 bc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.53:53336',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300075
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58870
received auth hello!
{ authId: 503, nonce: <Buffer 96 d4 ed 5b 7d a2 06 bc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 75 cf 11 4d 40 27 89 5a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d9 df f9 0b 98 a1 d1 9e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d9 df f9 0b 98 a1 d1 9e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.53:53600',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300084
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59132
received auth hello!
{ authId: 503, nonce: <Buffer d7 20 d6 c4 3b b7 b7 58> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 32 7a a7 19 d7 59 4d 5e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 98 1d 0c dc 47 68 7e 1f>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 98 1d 0c dc 47 68 7e 1f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.53:53862',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300093
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59394
received auth hello!
{ authId: 503, nonce: <Buffer 6b 6a 72 d0 21 13 ed 15> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8f e6 4d c1 e7 cc 6d 34>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6b 4e 3d 99 d2 09 64 48>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6b 4e 3d 99 d2 09 64 48> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.53:54124',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300102
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59656
received auth hello!
{ authId: 503, nonce: <Buffer 6d 12 62 d1 bc 4d ce c9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 78 b3 64 4a 0d 2e a6 58>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ef 34 88 d1 08 9d 3a a7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ef 34 88 d1 08 9d 3a a7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.53:54386',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300111
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59918
received auth hello!
{ authId: 503, nonce: <Buffer a0 87 93 b4 b4 2d 00 5d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cd 7d 7b c9 b9 72 6c 27>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b2 ec 94 d3 72 f4 94 da>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b2 ec 94 d3 72 f4 94 da> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.53:54648',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300120
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60180
received auth hello!
{ authId: 503, nonce: <Buffer a7 c5 80 f9 26 e0 b5 be> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ba 57 46 3a f8 42 7c fe>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 99 22 40 80 a0 ac 0a 70>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 99 22 40 80 a0 ac 0a 70> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.53:54910',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300129
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60442
received auth hello!
{ authId: 503, nonce: <Buffer 59 fc 8f 9f e2 10 40 23> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8a 5a 49 5b cc 3a dc 51>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b7 b2 48 f5 ca 8c 17 7f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b7 b2 48 f5 ca 8c 17 7f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.53:55172',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300138
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60708
received auth hello!
{ authId: 503, nonce: <Buffer ac fe fe 92 5f 40 c0 12> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1a e0 81 15 b1 a4 76 c0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6d 45 47 6e 1a 9f 95 a1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6d 45 47 6e 1a 9f 95 a1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.53:55438',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300147
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60974
received auth hello!
{ authId: 503, nonce: <Buffer 9b 9f 6f 9c 15 bf fb 59> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 93 8e 6d 9c e3 6c 9d d5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3a ed 94 a8 8b c3 10 fb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3a ed 94 a8 8b c3 10 fb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.53:55704',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300156
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33008
received auth hello!
{ authId: 503, nonce: <Buffer 38 ed 81 dc 4e 47 19 9f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7b f0 80 14 b5 cd 1e dd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e7 6e ff 49 9e eb af bb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e7 6e ff 49 9e eb af bb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.53:55970',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300165
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33274
received auth hello!
{ authId: 503, nonce: <Buffer ae 99 b8 b6 07 b6 a3 49> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 29 23 7e fe 00 df df b5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4e a4 4c 69 53 5a d8 61>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4e a4 4c 69 53 5a d8 61> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.53:56236',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300174
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33540
received auth hello!
{ authId: 503, nonce: <Buffer ce 96 e3 9e 15 ea ca 2b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c3 4a 85 61 2e b0 e8 af>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bf ff 74 7b 25 97 e6 eb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bf ff 74 7b 25 97 e6 eb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.53:56502',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300183
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33806
received auth hello!
{ authId: 503, nonce: <Buffer ea 3f 35 e0 39 82 80 d8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b8 94 92 a8 8e 95 4e f4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f7 d4 2c c3 08 95 21 09>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f7 d4 2c c3 08 95 21 09> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.53:56768',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300192
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34072
received auth hello!
{ authId: 503, nonce: <Buffer cd 1c 39 2f 72 1f 86 63> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f5 64 c3 67 73 19 8e 35>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ba 2b 28 2e a0 53 95 28>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ba 2b 28 2e a0 53 95 28> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.53:57034',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300201
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34334
received auth hello!
{ authId: 503, nonce: <Buffer df 51 b7 bf 33 6e 55 5f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5c bd bb 67 51 5e dd 5e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5b 7b f0 ba 0d cd 8f a6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5b 7b f0 ba 0d cd 8f a6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.53:57296',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
