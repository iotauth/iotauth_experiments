changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s406.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's406',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 74 66 ... > }
Handler: listening on port 22100
s406:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200001
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53950
received auth hello!
{ authId: 402, nonce: <Buffer 1b 7e a2 92 c9 21 61 b4> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 4f dc d6 cb 98 49 b3 7c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer de 7a 36 f9 ba 69 7d 6a fa 9a 81 f9 c5 85 5a a5>,
  macKeyVal: <Buffer ef e5 09 7e a4 11 51 75 ce c5 2e c1 43 d5 91 51 fe 45 8b 00 02 46 0f 02 2d b7 a0 0a 55 a3 82 90>,
  absValidity: 2018-08-27T06:09:55.088Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b1 5f d9 b0 1e f3 5f 37>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b1 5f d9 b0 1e f3 5f 37> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.50:45150',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200008
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54106
received auth hello!
{ authId: 402, nonce: <Buffer 39 c6 27 81 b6 27 46 b6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 31 cc ab ee 95 04 67 b4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 45 d7 f5 3b f6 13 d7 d5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 45 d7 f5 3b f6 13 d7 d5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.50:45306',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200015
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54368
received auth hello!
{ authId: 402, nonce: <Buffer d0 11 45 fd 86 db 62 ea> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 54 58 c2 8a 50 31 d2 60>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 37 99 97 ff c8 16 ac b3>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 37 99 97 ff c8 16 ac b3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.50:45568',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200022
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54638
received auth hello!
{ authId: 402, nonce: <Buffer f7 52 52 2f f4 d0 13 dd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 72 5a 96 31 0b cb 17 40>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c8 67 31 cb ca da 5c f9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c8 67 31 cb ca da 5c f9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.50:45838',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200029
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54908
received auth hello!
{ authId: 402, nonce: <Buffer f5 bf 70 42 b1 47 cc 84> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7d 79 5f c1 57 58 28 d1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 54 61 5c 88 fc 13 02 ea>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 54 61 5c 88 fc 13 02 ea> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.50:46108',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200036
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55178
received auth hello!
{ authId: 402, nonce: <Buffer 90 38 d3 56 6a 62 34 78> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7a bd 03 31 24 de 3d b6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7c 9f 8a 1f 00 db bb c9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 7c 9f 8a 1f 00 db bb c9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.50:46378',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200043
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55448
received auth hello!
{ authId: 402, nonce: <Buffer 84 83 fc fc 5b 92 25 ac> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 94 76 cd ef c5 00 51 8c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cc b2 8a d6 6a a4 db dd>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer cc b2 8a d6 6a a4 db dd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.50:46648',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200050
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55718
received auth hello!
{ authId: 402, nonce: <Buffer 6c e3 52 27 c3 32 e2 b3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 25 b0 1a cc ad be c4 86>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d1 4a 67 5a 8f 67 58 c6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d1 4a 67 5a 8f 67 58 c6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.50:46918',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300045
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300054
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 50994
received auth hello!
{ authId: 503, nonce: <Buffer a9 50 c4 67 fa 4b 7d 04> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth503',
     commonName: '10.0.1.6' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth402',
     commonName: '10.0.0.2' },
  serial: '016579C87021',
  notBefore: 2018-08-27T05:06:43.000Z,
  notAfter: 2018-08-28T05:08:23.000Z,
  subjectHash: '5542437f',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '68:BF:36:07:2D:1C:30:91:BB:08:D4:49:25:FC:98:4F:3C:A8:48:FF',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'C063304DB50CD53E197DA75E4D40E26CDC5CD8A0B32AE61DE61F1B45D952A4AF504A623AA81A434BF3E719B4A8575E7DDC5B6CC79B91CF65119617906A6FA524F36EC3EAE0F3DABF0A5C0AF3124582FA817364EADACDA8D4A54541FE1D7273B13153904D7ABF1DD6A3BF9BFA47F7F69CD4C5F6151308FEBCE9EE63FDB48DE4B6C6978CC71151410FFAF44FDE861DF2EDC5F88548D16C40246200EED97C3B814BDC01DD1AFC3F60F99ABEBD64A0E24D8796B1FE22F89D53C7EB16B6B4F840F5DB2C5AEC1002EF2EA80C5AB75602301EFC5B3670EC56D96F7DE45F5A21269F4EDB30218677BC8AFCD1869D96E6E189BBBD3B0DD9515A937856DB9BE293411F4ACD',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.6' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 503,
  host: '10.0.1.6',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWV5yHAhMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDIxETAPBgNVBAMMCDEwLjAuMC4yMB4XDTE4MDgy\nNzA1MDY0M1oXDTE4MDgyODA1MDgyM1owYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMzERMA8GA1UEAwwIMTAuMC4xLjYwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDAYzBNtQzVPhl9p15NQOJs3FzYoLMq5h3mHxtF2VKkr1BKYjqo\nGkNL8+cZtKhXXn3cW2zHm5HPZRGWF5Bqb6Uk827D6uDz2r8KXArzEkWC+oFzZOra\nzajUpUVB/h1yc7ExU5BNer8d1qO/m/pH9/ac1MX2FRMI/rzp7mP9tI3ktsaXjMcR\nUUEP+vRP3oYd8u3F+IVI0WxAJGIA7tl8O4FL3AHdGvw/YPmavr1koOJNh5ax/iL4\nnVPH6xa2tPhA9dssWuwQAu8uqAxat1YCMB78WzZw7FbZb33kX1ohJp9O2zAhhne8\nivzRhp2W5uGJu707DdlRWpN4Vtub4pNBH0rNAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQYwDQYJKoZIhvcNAQELBQADggEBAJQJVCso9BPUDFxxRxRC9jep4WSd7pJu\nFGNZlXTPa6G3WGJ+rQv8Tg/cGYvN5j/xetGGyANHRKPg56/W+9wWW38uA2idktLM\nCk2K/OdbU1IDb7XJRQFl+n3iwSmgzwG+meBXrwOpc+RgP4x4E9SbG+iHwp63lw8C\nupKVukWvf6ruytFGKi68PiclmdiP+gzHF9JguW9Y5RRIFrCEJtrbjPigpIoaeYMX\nq9Ar9k1Gj5UoyAhpW10TneCZjc4WJV50rR6WsWRvMJ54GVZP5Iie64sTU5AgyW4t\ncRZHVy7DtUq1cUfOKpeeeZfWmp8EnB9PdETR8nmVuaDAYyHx+aAZWjU=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300063
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51240
received auth hello!
{ authId: 503, nonce: <Buffer 2f 59 90 19 c5 53 ed 38> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 85 78 9c 4d 51 1b 07 22>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 59 0a 3c 3f 81 8f 05 91 6f d3 9c 99 64 3c 79 74>,
  macKeyVal: <Buffer 94 29 a8 14 66 7b 79 f8 90 9a 24 1c e5 de ee 25 02 9a 38 48 7c 51 1d 9b 1d 30 f1 15 07 07 b4 19>,
  absValidity: 2018-08-27T06:21:55.633Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 82 ac f8 6f a5 f0 cf 97>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 82 ac f8 6f a5 f0 cf 97> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.50:48146',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300072
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51512
received auth hello!
{ authId: 503, nonce: <Buffer 03 85 2c b0 c4 4b c6 85> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 99 cb af ae 85 be c2 e6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b4 4a df 83 a9 b9 7f e0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b4 4a df 83 a9 b9 7f e0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.50:48418',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300081
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51774
received auth hello!
{ authId: 503, nonce: <Buffer 92 7b 79 d3 60 49 f0 68> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2d 19 ce 50 d9 3d b6 8d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d4 8a c0 5f e5 f7 42 47>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d4 8a c0 5f e5 f7 42 47> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.50:48680',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300090
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52034
received auth hello!
{ authId: 503, nonce: <Buffer 51 eb 91 f7 6d d4 20 74> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9a 6f 45 66 19 6b c3 bd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0e 38 5c 9b 6a ed 91 2e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0e 38 5c 9b 6a ed 91 2e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.50:48938',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300099
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52296
received auth hello!
{ authId: 503, nonce: <Buffer d5 24 37 e7 04 cb b6 a4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 17 9d 74 1d b2 98 a2 d0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f0 d4 28 40 c6 f8 c3 d9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f0 d4 28 40 c6 f8 c3 d9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.50:49200',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300108
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52560
received auth hello!
{ authId: 503, nonce: <Buffer ef 14 0d 2d 58 30 1a 42> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0f d5 16 26 64 f4 04 08>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 01 41 2c b0 42 33 5b 00>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 01 41 2c b0 42 33 5b 00> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.50:49462',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300117
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52820
received auth hello!
{ authId: 503, nonce: <Buffer f2 56 ae 59 db bb 09 29> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d3 f1 cf 22 18 2e 75 45>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 18 08 b9 39 81 53 f0 e1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 18 08 b9 39 81 53 f0 e1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.50:49724',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300126
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53084
received auth hello!
{ authId: 503, nonce: <Buffer 26 19 d0 4d 61 47 fb 4d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 40 13 7a ab a9 b5 e7 01>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 96 2d cb cf 31 24 2f 90>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 96 2d cb cf 31 24 2f 90> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.50:49986',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300135
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53344
received auth hello!
{ authId: 503, nonce: <Buffer ba 3e 9a 92 1e 81 bc 7d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3f dc 5d e8 5d d6 3e ba>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e5 de bd ba 83 e4 c7 de>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e5 de bd ba 83 e4 c7 de> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.50:50248',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300144
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53610
received auth hello!
{ authId: 503, nonce: <Buffer ae c9 64 e5 20 f2 0c 44> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 46 25 8f 44 99 7f 9d 2d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c1 da 66 5b 09 ea 8e fe>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c1 da 66 5b 09 ea 8e fe> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.50:50514',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300153
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53878
received auth hello!
{ authId: 503, nonce: <Buffer dc 09 0f 22 08 27 c6 36> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0d 5f 56 c1 d1 0b 48 35>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 62 49 26 68 55 8d db 13>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 62 49 26 68 55 8d db 13> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.50:50784',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300162
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54144
received auth hello!
{ authId: 503, nonce: <Buffer ae 46 ce 19 c9 bc 95 98> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 22 5e e8 c4 fb dd 8a 14>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 29 ed b7 61 25 f9 93 5a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 29 ed b7 61 25 f9 93 5a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.50:51050',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300171
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54410
received auth hello!
{ authId: 503, nonce: <Buffer 55 0b 77 1e 91 a3 a7 40> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b0 3d 52 bc 83 ae f3 46>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 25 74 b3 4f 37 d2 04 6a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 25 74 b3 4f 37 d2 04 6a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.50:51316',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300180
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54676
received auth hello!
{ authId: 503, nonce: <Buffer cd 31 c6 ec e1 00 39 fd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b8 eb 28 03 28 13 a2 d5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0d ae 90 ab a6 d0 16 70>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0d ae 90 ab a6 d0 16 70> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.50:51582',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300189
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54942
received auth hello!
{ authId: 503, nonce: <Buffer e9 7d b2 88 af 59 68 9a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 51 f8 00 71 7e 0d f2 7d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4e 9c 55 1d 7a cd 9d dd>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4e 9c 55 1d 7a cd 9d dd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.50:51848',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300198
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55212
received auth hello!
{ authId: 503, nonce: <Buffer cf 0a 53 43 94 15 34 ed> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 20 54 7d e9 c3 77 68 94>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e8 a7 d7 1a 59 16 35 32>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e8 a7 d7 1a 59 16 35 32> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.50:52118',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
