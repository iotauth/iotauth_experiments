changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s506.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's506',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 39 74 ... > }
Handler: listening on port 22100
s506:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100006
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49136
received auth hello!
{ authId: 501, nonce: <Buffer a0 fa 11 d4 9c fe fa 9e> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer b5 1f 25 75 20 9f 8c 6d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer d2 20 57 50 c4 62 c3 e0 9a 6e 3a a3 c5 be 87 b2>,
  macKeyVal: <Buffer 86 0b a2 d8 68 67 13 5d 63 36 59 0f 75 a8 c2 c0 43 05 bc 33 ac 75 b9 86 e0 e3 fe 75 66 2a 89 2a>,
  absValidity: 2018-08-27T06:11:01.060Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3d bd 66 7a 19 5e 82 7f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3d bd 66 7a 19 5e 82 7f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.70:48670',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100014
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49408
received auth hello!
{ authId: 501, nonce: <Buffer 38 01 37 09 1e 58 a3 e7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6b ae c8 6c 87 79 9c de>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 18 45 82 ed 7a 55 98 90>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 18 45 82 ed 7a 55 98 90> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.70:48940',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100022
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49678
received auth hello!
{ authId: 501, nonce: <Buffer 03 52 d0 cd 4e e2 e5 a4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer af 4c 84 4f fd 00 08 ff>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a7 f0 a7 8e 33 99 54 a1>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer a7 f0 a7 8e 33 99 54 a1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.70:49212',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100030
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49948
received auth hello!
{ authId: 501, nonce: <Buffer e8 ac 39 2d 56 05 2e a1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b4 37 e4 2d b6 d3 c8 0c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4c c0 01 fb cd 99 d1 b4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4c c0 01 fb cd 99 d1 b4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.70:49480',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100038
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50218
received auth hello!
{ authId: 501, nonce: <Buffer ab 2b 98 84 65 49 d5 f2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3e 53 d2 89 10 e5 9c 93>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 42 e0 6a 29 5c ba 45 5d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 42 e0 6a 29 5c ba 45 5d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.70:49750',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100046
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50488
received auth hello!
{ authId: 501, nonce: <Buffer 31 67 6e a2 c3 07 f6 27> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8f 51 e8 11 ea 79 f6 54>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 44 cb 2b 7e 40 6d 6d 16>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 44 cb 2b 7e 40 6d 6d 16> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.70:50022',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100054
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50758
received auth hello!
{ authId: 501, nonce: <Buffer 3d 3f 4f 25 80 c7 ec 00> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e8 41 d2 bf 17 51 21 ae>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fb da 40 ab 74 3d 86 3e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fb da 40 ab 74 3d 86 3e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.70:50290',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300064
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300075
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 42514
received auth hello!
{ authId: 403, nonce: <Buffer de 33 b0 ff 38 f8 ec f8> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth403',
     commonName: '10.0.1.3' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '016579C8728B',
  notBefore: 2018-08-27T05:06:44.000Z,
  notAfter: 2018-08-28T05:08:24.000Z,
  subjectHash: 'f6675d02',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '0E:BF:EC:49:D9:17:43:13:60:D1:02:46:26:B2:8C:E8:04:22:EE:5D',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'CC68FC5D29A9F82CF47D88E000BDB366FC4FAF64E73AF78482C683A11D8ECEE99E59F68CD5AE62D5325C44E0B29316EA552046B5281C9D391D565938B6E65BCB718154062B6F4EE28D9358C9CF9E8E23796306F9BE5E0A141C881A08A53A5B9FA766526E59797527F98FDEBABC76D560B05534DB566255BEA22EB5AF103DB91478A73B3882A8B377809377FCC744C3B2CED0117C0BD00A24D5790262D77AAFA3D074F1BCDF5927B5D662244D1250128A16BAB3030D522DCADF5DE7D0D73580ADB2A653BED5E53C27AF9695589DE4082675A1E7662297A571E06F69E6046808D43D189D2EF72AEE2AA7FA94ACA2D536A977DE781026A9C7EE26EFA7E5E424AA91',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.3' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 403,
  host: '10.0.1.3',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWV5yHKLMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDgy\nNzA1MDY0NFoXDTE4MDgyODA1MDgyNFowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDQwMzERMA8GA1UEAwwIMTAuMC4xLjMwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDMaPxdKan4LPR9iOAAvbNm/E+vZOc694SCxoOhHY7O6Z5Z9ozV\nrmLVMlxE4LKTFupVIEa1KBydOR1WWTi25lvLcYFUBitvTuKNk1jJz56OI3ljBvm+\nXgoUHIgaCKU6W5+nZlJuWXl1J/mP3rq8dtVgsFU021ZiVb6iLrWvED25FHinOziC\nqLN3gJN3/MdEw7LO0BF8C9AKJNV5AmLXeq+j0HTxvN9ZJ7XWYiRNElASiha6swMN\nUi3K313n0Nc1gK2yplO+1eU8J6+WlVid5AgmdaHnZiKXpXHgb2nmBGgI1D0YnS73\nKu4qp/qUrKLVNql33ngQJqnH7ibvp+XkJKqRAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQMwDQYJKoZIhvcNAQELBQADggEBAJ7rQbLlhoc8oKym84tCt1B4Qbf0tbgg\nY+n/Ptvvj5a2EENRzgbnGDtFjvNSNKtH99Y2rzhLQLNiy06X045HzIbHZvAnt1n7\nkOAZHfWZyv1VFI8ZdQ63H17KkJWi7qtsIrGB1Bv6ydzkZj2xK/uXqB/1QuKnjnAj\nCt3Pk/Jqp92NVtnRHrsHDuKCtZeNqLvPEHTSj5ib6ibaXxlNxYiJ1OfYyAAUfQsj\n2CApq7thhwk5WzGMN7P/an/bvGSOricUvPoa1Scr04I6pzzZxEPGr97ISl7sYYI9\nJYjCOtxDpsnlh3CfqbQZktku9MvRFwGMVFL5cQ7YnhtlmbMqf3VE/xE=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300086
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42774
received auth hello!
{ authId: 403, nonce: <Buffer 1a 36 dc f0 7e ac 2f b6> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 10 1f d4 47 d7 bc ce f5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 22 99 80 bc 15 19 52 d5 3d 36 79 af cf 28 a5 a7>,
  macKeyVal: <Buffer c3 0f e7 ae cf fa 21 0f 5a 16 cf 7e 76 1c 5a 6f d8 66 65 09 00 79 2c 19 b0 03 c8 6c ed 28 d1 84>,
  absValidity: 2018-08-27T06:22:00.938Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8b 18 1c 34 6c ff 8a c2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8b 18 1c 34 6c ff 8a c2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.70:51530',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300097
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43040
received auth hello!
{ authId: 403, nonce: <Buffer 32 5a a8 79 9d 81 3a 44> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1a a7 dd 6e 17 68 64 3e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 32 3d d5 2e 2f f9 e1 94>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 32 3d d5 2e 2f f9 e1 94> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.70:51796',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300108
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43302
received auth hello!
{ authId: 403, nonce: <Buffer ae 36 02 d8 0d f3 e5 4e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 11 dd ce c0 02 c1 62 ff>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d8 75 de f6 39 a8 34 76>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d8 75 de f6 39 a8 34 76> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.70:52058',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300119
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43564
received auth hello!
{ authId: 403, nonce: <Buffer d2 9e 19 be d7 da f3 44> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 05 03 8f f0 35 0c f6 e8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b2 e7 3b 6d 06 93 ca 72>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b2 e7 3b 6d 06 93 ca 72> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.70:52320',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300130
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43826
received auth hello!
{ authId: 403, nonce: <Buffer 32 f8 02 bc 23 15 80 d7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a9 ec a1 ed 33 3a f3 c8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 03 5e ca 33 18 3a 65 6e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 03 5e ca 33 18 3a 65 6e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.70:52582',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300141
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44088
received auth hello!
{ authId: 403, nonce: <Buffer 9f 62 b4 ab 17 00 54 35> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bb 06 ff 7d 80 f2 d8 fb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 35 fb 2c 20 fa f6 c5 51>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 35 fb 2c 20 fa f6 c5 51> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.70:52844',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300152
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44350
received auth hello!
{ authId: 403, nonce: <Buffer b8 21 64 b0 9b 58 34 32> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bb 6e 51 95 2d c0 c9 e1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 49 3b 33 67 09 5a 5e a3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 49 3b 33 67 09 5a 5e a3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.70:53106',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300163
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44612
received auth hello!
{ authId: 403, nonce: <Buffer 2d ac 93 51 c2 42 44 d4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 05 c9 21 1e f9 92 07 c4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1f 55 a0 b3 4d 32 ba 4e>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 1f 55 a0 b3 4d 32 ba 4e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.70:53368',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300174
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44878
received auth hello!
{ authId: 403, nonce: <Buffer 90 76 65 3f aa 98 88 e9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 86 98 7c d0 3e 56 2e 44>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 92 18 1d a7 6d 45 76 a5>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 92 18 1d a7 6d 45 76 a5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.70:53634',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300185
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45144
received auth hello!
{ authId: 403, nonce: <Buffer 8b 99 a9 5f e8 8a 29 19> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0c 0c 7c 38 a2 2b b6 3e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b3 d6 66 58 d2 5b 37 6c>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b3 d6 66 58 d2 5b 37 6c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.70:53900',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300196
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45410
received auth hello!
{ authId: 403, nonce: <Buffer 03 31 8b 01 d7 d8 26 b6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b5 5a b1 c2 ed ea 75 0e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer de b2 52 d8 5c b1 3f e4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer de b2 52 d8 5c b1 3f e4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.70:54166',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300207
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45676
received auth hello!
{ authId: 403, nonce: <Buffer a2 93 c4 ff 2d 32 27 2f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ba 1d 70 9b 9e f4 61 a2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ae 4f 69 c5 89 da 2c 2b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ae 4f 69 c5 89 da 2c 2b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.70:54432',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300218
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45942
received auth hello!
{ authId: 403, nonce: <Buffer 8e 54 43 18 68 c1 6d f6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer be 2a a6 49 db a3 3b aa>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6d 6a 0e d9 ac 76 c3 28>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6d 6a 0e d9 ac 76 c3 28> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.70:54698',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300229
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46208
received auth hello!
{ authId: 403, nonce: <Buffer 0b 02 6c 2f 01 8f 35 d5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 81 08 49 ed 36 12 bd ba>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f0 08 b7 b7 ae 69 22 85>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f0 08 b7 b7 ae 69 22 85> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.70:54964',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300240
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46474
received auth hello!
{ authId: 403, nonce: <Buffer 32 a0 c1 16 c8 fa 5a 37> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 86 fb 7d 3d 38 d8 61 4a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e2 db a0 d0 3e 4d 41 d3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e2 db a0 d0 3e 4d 41 d3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.70:55230',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300251
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46736
received auth hello!
{ authId: 403, nonce: <Buffer 55 c6 b1 41 5e 78 48 e9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ac 21 a2 b0 01 27 95 14>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cd 98 46 37 7e fb 4f 27>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer cd 98 46 37 7e fb 4f 27> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.70:55492',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300262
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46962
received auth hello!
{ authId: 403, nonce: <Buffer 29 75 6f 24 18 39 99 ef> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 74 3a 48 19 e4 0b a9 8f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c0 e4 66 81 53 71 f2 24>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c0 e4 66 81 53 71 f2 24> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.70:55718',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
