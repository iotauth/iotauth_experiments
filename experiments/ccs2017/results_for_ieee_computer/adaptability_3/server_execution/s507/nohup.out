changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s507.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's507',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 67 49 42 41 41 4b 43 41 51 45 41 35 54 ... > }
Handler: listening on port 22100
s507:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100007
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48548
received auth hello!
{ authId: 501, nonce: <Buffer 65 13 c3 60 a8 19 3d 5b> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 05 ff 80 68 02 f4 b0 e6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 86 83 6f 27 af d8 37 a3 8c ed a5 79 1f ec 17 02>,
  macKeyVal: <Buffer 68 b6 57 81 8f ab 2d 11 74 0a 6a 78 a0 c1 01 22 2a c4 3a 8c 78 f9 24 96 85 3b 1b 6d 39 a3 ff 40>,
  absValidity: 2018-08-27T06:11:05.032Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer af 10 28 20 39 c9 2b 67>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer af 10 28 20 39 c9 2b 67> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.71:47652',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100015
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48820
received auth hello!
{ authId: 501, nonce: <Buffer 9b 2f 12 2d d3 94 33 f2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c0 f5 1e cd fb 7a 6a 18>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5c ed 4d 77 4c 8b aa 4e>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 5c ed 4d 77 4c 8b aa 4e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.71:47924',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100023
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49090
received auth hello!
{ authId: 501, nonce: <Buffer f0 99 3f 84 1b a8 07 d8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6b 8c 80 4c bf 7d 17 c8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8e 3c 16 ec 07 09 4a 28>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 8e 3c 16 ec 07 09 4a 28> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.71:48194',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100031
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49360
received auth hello!
{ authId: 501, nonce: <Buffer 12 b5 ef 6c da a0 fa 9a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer be c6 ef 78 3d 96 f5 c9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fc cb d9 35 c2 e4 e8 b9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fc cb d9 35 c2 e4 e8 b9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.71:48464',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100039
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49630
received auth hello!
{ authId: 501, nonce: <Buffer 36 aa 76 de 28 18 94 d0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 14 66 1b 18 9d c1 6b 97>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer eb 11 36 0a d4 48 4e c0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer eb 11 36 0a d4 48 4e c0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.71:48734',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100047
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49900
received auth hello!
{ authId: 501, nonce: <Buffer 40 6d f2 5b cf 47 e3 3f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d4 65 9f e3 61 4a df f8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ec b4 23 ce 2d 52 93 a3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ec b4 23 ce 2d 52 93 a3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.71:49004',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100055
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50170
received auth hello!
{ authId: 501, nonce: <Buffer 5f 8a e8 0b 46 c8 87 d9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 87 02 b2 40 48 03 b0 6b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0b 90 f4 1a a6 ba 5c 2e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0b 90 f4 1a a6 ba 5c 2e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.71:49274',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200068
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200081
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 34744
received auth hello!
{ authId: 502, nonce: <Buffer af 23 de 81 5e d3 b4 82> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '016579C872E3',
  notBefore: 2018-08-27T05:06:44.000Z,
  notAfter: 2018-08-28T05:08:24.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '1C:7A:79:10:1B:B2:9A:9F:55:B3:BD:06:30:CC:41:43:1D:7F:B5:39',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'A31E9022457B05D056C9FDEDB58BC733BB1B97C16EF02448C451D7DA8BD15C69BDB461E2FD275C96206B77B283645D6BCD71B284A7AC0F1477E8D62ECAA762A3FA674E23957AED10D73D8ED8838AC41A47FAF8FB50BCB1B3A57C246D7D1861A3880C7CCFDEEB58259C62F656BDFDD4ABE6096C88FFA9EEEF3D32230BB86D8FF4C534038264055EB8B3972DC370931A0A38091A1287BFF40D2EF7D92570D86B1837F35A2EA3F7B96EA0870826501C88C4DC0639DA69AE419D997562C46AF20F50D09554213C3EE69AE5685E2446DC62A309CD065472D9BC7AD27221D047D12C6241DBDF5C65881B877D96358D4C273A9F3D8D02DEB84D0581B7EB28209680C6AD',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWV5yHLjMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDgy\nNzA1MDY0NFoXDTE4MDgyODA1MDgyNFowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQCjHpAiRXsF0FbJ/e21i8czuxuXwW7wJEjEUdfai9Fcab20YeL9\nJ1yWIGt3soNkXWvNcbKEp6wPFHfo1i7Kp2Kj+mdOI5V67RDXPY7Yg4rEGkf6+PtQ\nvLGzpXwkbX0YYaOIDHzP3utYJZxi9la9/dSr5glsiP+p7u89MiMLuG2P9MU0A4Jk\nBV64s5ctw3CTGgo4CRoSh7/0DS732SVw2GsYN/NaLqP3uW6ghwgmUByIxNwGOdpp\nrkGdmXVixGryD1DQlVQhPD7mmuVoXiRG3GKjCc0GVHLZvHrSciHQR9EsYkHb31xl\niBuHfZY1jUwnOp89jQLeuE0FgbfrKCCWgMatAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAEFyG39pFunA47uV9CJM5TWW40ixoytS\nWElW1LNPdQkcBcGKnLFOXk8NWRK1hI57Mf21ARU9eSKIv9GffevVArWIOhJJljzw\nEeAW0gbeXdTrKVSeW25k0BwuUwUvoYcWeA1ylXMIkW2C/PfuROSBC8iDqxvB1qPj\nHy6VecpZTKuLsnwQjG2wum/QiKvhu9Jj2XKAEjKpqh7IYBss9mXYhIydM3kCjU/0\n2X7ohkKhrArndMsrJz5XH4BUOBHjB9G1sA74l/srRdpvfu4uKWN9xc4tWOS2YOLJ\n7gwfrgISr0a0lUlki4N8XxwDx9i+P9efFgqsD8wYG4u3Wp+FxRzNM04=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200094
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35004
received auth hello!
{ authId: 502, nonce: <Buffer 45 06 9e a0 76 7e 0c 79> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 3f 41 9d 45 5b 1f 93 f4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer e6 12 da 10 a7 0f aa fd b4 62 be fe a9 7d 82 87>,
  macKeyVal: <Buffer e9 f8 c8 b3 9d bd ed c1 55 96 97 54 c7 4b 9c e8 9a d8 8f 1c eb 7d 02 7e 25 46 f6 67 b9 3a ad 31>,
  absValidity: 2018-08-27T06:22:04.057Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e1 f4 0f 21 66 e2 27 b6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e1 f4 0f 21 66 e2 27 b6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.71:50512',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200107
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35268
received auth hello!
{ authId: 502, nonce: <Buffer 1c 95 5e ef fc 8b 18 79> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cc fb 56 e5 7b ac b8 f4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5c df 63 0b fc 2b e5 21>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5c df 63 0b fc 2b e5 21> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.71:50776',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200120
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35530
received auth hello!
{ authId: 502, nonce: <Buffer 15 bd f0 e4 24 d0 75 4b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e6 bc 77 54 a8 d2 fb 44>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 70 13 37 21 f2 2f 97 f5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 70 13 37 21 f2 2f 97 f5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.71:51038',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200133
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35792
received auth hello!
{ authId: 502, nonce: <Buffer 07 62 94 84 d2 f1 ae ec> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0a 64 f7 ef f6 bd 5e bd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 07 59 f0 ad 9a 11 f1 7a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 07 59 f0 ad 9a 11 f1 7a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.71:51300',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200146
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36054
received auth hello!
{ authId: 502, nonce: <Buffer ae d2 fb 1a ae b3 15 0b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 33 27 8d c3 32 19 d7 f6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer aa a0 b7 42 5e 37 5f 6c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer aa a0 b7 42 5e 37 5f 6c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.71:51562',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200159
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36316
received auth hello!
{ authId: 502, nonce: <Buffer 8a d6 e2 c6 24 e3 91 71> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 38 92 21 ee 25 7c 5f 18>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8e fb 0b 59 25 44 5d e5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8e fb 0b 59 25 44 5d e5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.71:51824',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200172
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36578
received auth hello!
{ authId: 502, nonce: <Buffer 5b 2f 0d 91 69 3f bd 56> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 19 63 8c e3 f9 ac 55 88>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 95 07 80 cc ec d5 a2 59>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 95 07 80 cc ec d5 a2 59> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.71:52086',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200185
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36840
received auth hello!
{ authId: 502, nonce: <Buffer 66 c0 34 d9 72 5d e2 e2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c9 56 fb 3c fd f2 24 21>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a6 0c d6 b6 24 06 fe 87>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a6 0c d6 b6 24 06 fe 87> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.71:52348',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200198
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37106
received auth hello!
{ authId: 502, nonce: <Buffer f0 a0 c0 9f c7 16 de 67> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bd b3 76 14 eb a6 02 ec>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d9 fc 52 64 92 da 43 82>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d9 fc 52 64 92 da 43 82> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.71:52614',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200211
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37372
received auth hello!
{ authId: 502, nonce: <Buffer 21 81 8d b9 8d 76 3f 0c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4e 42 00 e2 b0 85 6d 15>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b4 f1 57 41 cb 35 88 d2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b4 f1 57 41 cb 35 88 d2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.71:52880',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200224
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37638
received auth hello!
{ authId: 502, nonce: <Buffer 5d 5d de 63 b0 b2 b2 48> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 32 27 72 a7 07 87 a0 15>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6a 1f bd 82 40 e5 07 2c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6a 1f bd 82 40 e5 07 2c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.71:53146',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200237
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37904
received auth hello!
{ authId: 502, nonce: <Buffer 5a 6a 75 03 3e a3 b7 e3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 02 a7 c3 b7 27 b2 5d 9a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1a 2d b9 84 3e 98 bb c3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1a 2d b9 84 3e 98 bb c3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.71:53412',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200250
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38170
received auth hello!
{ authId: 502, nonce: <Buffer cb d6 77 84 4e 41 67 22> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 15 4f 1f a8 9b 8f 22 4f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 91 ec a6 b6 f3 eb 29 c8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 91 ec a6 b6 f3 eb 29 c8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.71:53678',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200263
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38436
received auth hello!
{ authId: 502, nonce: <Buffer 34 5f e0 34 27 38 4d b8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 32 8a e7 c1 ba 3d a0 b1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 71 ff a8 ed 03 45 3d 9f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 71 ff a8 ed 03 45 3d 9f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.71:53944',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200276
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38702
received auth hello!
{ authId: 502, nonce: <Buffer 85 fd 5e 65 33 86 68 6f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d1 26 14 93 fe d1 7a 8f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c9 36 ba d7 1a aa 4d e6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c9 36 ba d7 1a aa 4d e6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.71:54210',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200289
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38964
received auth hello!
{ authId: 502, nonce: <Buffer 94 8f 7e 18 db b3 72 90> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 05 1f 68 6b b5 48 c6 3d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 79 85 c7 a4 dc 07 07 f0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 79 85 c7 a4 dc 07 07 f0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.71:54472',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200302
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39186
received auth hello!
{ authId: 502, nonce: <Buffer 7e a6 de 5f d6 c5 8f fd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 34 b5 9b 68 62 f6 c6 aa>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 61 11 3b 04 25 23 06 b6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 61 11 3b 04 25 23 06 b6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.71:54694',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
