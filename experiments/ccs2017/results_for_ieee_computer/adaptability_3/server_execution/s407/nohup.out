changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s407.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's407',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 78 63 ... > }
Handler: listening on port 22100
s407:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200002
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48074
received auth hello!
{ authId: 402, nonce: <Buffer 29 d7 62 69 e5 03 94 de> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer c5 d0 2c b1 c9 e5 8e 0a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer c2 fe 23 6b 6d 72 5d 3c 68 36 68 72 86 15 c7 46>,
  macKeyVal: <Buffer 1e 68 f8 5a f3 16 80 fe 7a ff a6 4d d5 d2 f1 93 74 6f 48 21 72 7c a2 9e 79 f6 94 3f 67 f7 a5 9d>,
  absValidity: 2018-08-27T06:09:58.334Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 78 15 3e 2b 63 3e fb 20>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 78 15 3e 2b 63 3e fb 20> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.51:40298',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200009
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48236
received auth hello!
{ authId: 402, nonce: <Buffer 04 54 cf 4a 77 6e c8 94> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cb 55 22 aa d6 ab 16 78>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9d 57 e1 b5 ab 19 8c a7>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 9d 57 e1 b5 ab 19 8c a7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.51:40460',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200016
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48504
received auth hello!
{ authId: 402, nonce: <Buffer 3c 98 45 60 cf 1a b0 ce> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 38 3d fe 97 d9 05 42 53>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 88 21 2a e2 51 d6 6b e6>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 88 21 2a e2 51 d6 6b e6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.51:40728',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200023
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48774
received auth hello!
{ authId: 402, nonce: <Buffer b5 a8 4e c2 cf 5e bc e0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6d a9 ac cc cd 34 58 e4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0e 16 48 07 90 7f 13 14>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 0e 16 48 07 90 7f 13 14> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.51:40998',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200030
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49044
received auth hello!
{ authId: 402, nonce: <Buffer d5 54 c5 0e 23 5b 82 62> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3a 2c 39 51 a0 df bb 83>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 70 c7 85 06 a0 21 bb 27>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 70 c7 85 06 a0 21 bb 27> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.51:41268',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200037
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49314
received auth hello!
{ authId: 402, nonce: <Buffer ec d9 39 2d a1 ba c0 80> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2e bd 8a 33 a7 8f aa d2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 27 4b 4a 6d 0a 79 bf 02>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 27 4b 4a 6d 0a 79 bf 02> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.51:41538',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200044
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49584
received auth hello!
{ authId: 402, nonce: <Buffer c4 7a f3 c6 bc 73 25 eb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a7 0d 70 95 b4 84 d8 83>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cc 1d 2c 82 79 6c e3 85>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer cc 1d 2c 82 79 6c e3 85> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.51:41808',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200051
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49854
received auth hello!
{ authId: 402, nonce: <Buffer 7d 57 fb 23 b0 8a 2b 70> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1c 9e 5e b9 73 64 33 ed>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b9 0a d5 7b 9e f2 ab 00>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b9 0a d5 7b 9e f2 ab 00> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.51:42078',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300046
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300055
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 38860
received auth hello!
{ authId: 503, nonce: <Buffer 01 50 d3 0c 54 d7 f6 b5> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth503',
     commonName: '10.0.1.6' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth402',
     commonName: '10.0.0.2' },
  serial: '016579C87021',
  notBefore: 2018-08-27T05:06:43.000Z,
  notAfter: 2018-08-28T05:08:23.000Z,
  subjectHash: '5542437f',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '68:BF:36:07:2D:1C:30:91:BB:08:D4:49:25:FC:98:4F:3C:A8:48:FF',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'C063304DB50CD53E197DA75E4D40E26CDC5CD8A0B32AE61DE61F1B45D952A4AF504A623AA81A434BF3E719B4A8575E7DDC5B6CC79B91CF65119617906A6FA524F36EC3EAE0F3DABF0A5C0AF3124582FA817364EADACDA8D4A54541FE1D7273B13153904D7ABF1DD6A3BF9BFA47F7F69CD4C5F6151308FEBCE9EE63FDB48DE4B6C6978CC71151410FFAF44FDE861DF2EDC5F88548D16C40246200EED97C3B814BDC01DD1AFC3F60F99ABEBD64A0E24D8796B1FE22F89D53C7EB16B6B4F840F5DB2C5AEC1002EF2EA80C5AB75602301EFC5B3670EC56D96F7DE45F5A21269F4EDB30218677BC8AFCD1869D96E6E189BBBD3B0DD9515A937856DB9BE293411F4ACD',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.6' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 503,
  host: '10.0.1.6',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWV5yHAhMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDIxETAPBgNVBAMMCDEwLjAuMC4yMB4XDTE4MDgy\nNzA1MDY0M1oXDTE4MDgyODA1MDgyM1owYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMzERMA8GA1UEAwwIMTAuMC4xLjYwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDAYzBNtQzVPhl9p15NQOJs3FzYoLMq5h3mHxtF2VKkr1BKYjqo\nGkNL8+cZtKhXXn3cW2zHm5HPZRGWF5Bqb6Uk827D6uDz2r8KXArzEkWC+oFzZOra\nzajUpUVB/h1yc7ExU5BNer8d1qO/m/pH9/ac1MX2FRMI/rzp7mP9tI3ktsaXjMcR\nUUEP+vRP3oYd8u3F+IVI0WxAJGIA7tl8O4FL3AHdGvw/YPmavr1koOJNh5ax/iL4\nnVPH6xa2tPhA9dssWuwQAu8uqAxat1YCMB78WzZw7FbZb33kX1ohJp9O2zAhhne8\nivzRhp2W5uGJu707DdlRWpN4Vtub4pNBH0rNAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQYwDQYJKoZIhvcNAQELBQADggEBAJQJVCso9BPUDFxxRxRC9jep4WSd7pJu\nFGNZlXTPa6G3WGJ+rQv8Tg/cGYvN5j/xetGGyANHRKPg56/W+9wWW38uA2idktLM\nCk2K/OdbU1IDb7XJRQFl+n3iwSmgzwG+meBXrwOpc+RgP4x4E9SbG+iHwp63lw8C\nupKVukWvf6ruytFGKi68PiclmdiP+gzHF9JguW9Y5RRIFrCEJtrbjPigpIoaeYMX\nq9Ar9k1Gj5UoyAhpW10TneCZjc4WJV50rR6WsWRvMJ54GVZP5Iie64sTU5AgyW4t\ncRZHVy7DtUq1cUfOKpeeeZfWmp8EnB9PdETR8nmVuaDAYyHx+aAZWjU=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300064
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39114
received auth hello!
{ authId: 503, nonce: <Buffer 45 90 6c 2b 75 79 73 65> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer ae 85 2c d3 ed 45 0f 21>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer b8 0e 0c ff 1c 27 f7 1f 61 a7 d5 00 1e 8e 63 ed>,
  macKeyVal: <Buffer 03 d4 8e 9d b0 4d 80 ac 0f 65 ad 3d aa b8 e5 5b 60 4a 4a 14 1e bd c8 06 6c f3 78 43 8d 5f 17 eb>,
  absValidity: 2018-08-27T06:21:59.223Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 95 71 d9 94 45 c6 c0 32>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 95 71 d9 94 45 c6 c0 32> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.51:43312',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300073
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39378
received auth hello!
{ authId: 503, nonce: <Buffer 80 58 d0 17 72 0c 8a 71> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2d 81 ef fa d9 00 b0 7a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 49 6f ab 2c f8 17 03 7a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 49 6f ab 2c f8 17 03 7a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.51:43578',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300082
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39640
received auth hello!
{ authId: 503, nonce: <Buffer 12 43 be 63 8c e5 52 a6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 43 ff b9 e8 70 f0 2b c2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 01 7b 1d c1 6c 8d 84 1b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 01 7b 1d c1 6c 8d 84 1b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.51:43840',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300091
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39910
received auth hello!
{ authId: 503, nonce: <Buffer 45 11 c0 c4 cc 6c 76 25> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 32 d7 de 18 8b 3e fb 98>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5b 2c ce bb f6 7f dc d4>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 5b 2c ce bb f6 7f dc d4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.51:44110',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300100
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40172
received auth hello!
{ authId: 503, nonce: <Buffer 23 fb 96 20 b4 d3 9b df> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 40 03 9e df 65 3c 72 0a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 63 31 ca 8c 7f 41 46 96>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 63 31 ca 8c 7f 41 46 96> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.51:44370',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300109
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40428
received auth hello!
{ authId: 503, nonce: <Buffer e8 f5 c7 ff c4 0c 9b 68> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 15 65 65 c8 40 8e bc 49>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 72 78 20 31 5f 7a 3c 8d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 72 78 20 31 5f 7a 3c 8d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.51:44628',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300118
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40696
received auth hello!
{ authId: 503, nonce: <Buffer 85 33 4c 3d 2f 25 49 63> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b3 55 3f b2 24 8f 94 c5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 91 91 12 0f 04 5d c9 df>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 91 91 12 0f 04 5d c9 df> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.51:44892',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300127
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40954
received auth hello!
{ authId: 503, nonce: <Buffer e5 f6 95 82 63 ba 0b 59> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f3 b0 63 d9 11 0b a0 3a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bf ba 61 d1 d2 ac 22 9c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bf ba 61 d1 d2 ac 22 9c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.51:45152',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300136
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41216
received auth hello!
{ authId: 503, nonce: <Buffer 5b a2 16 1b 9c a3 06 de> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1a 4b 42 27 dc 4d 20 14>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3c 9e 14 9d c9 da f7 6d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 3c 9e 14 9d c9 da f7 6d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.51:45416',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300145
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41486
received auth hello!
{ authId: 503, nonce: <Buffer 1d 9f c2 63 9c 3c ba 78> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 50 30 a5 2e a1 1f 66 0c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8b d8 2f 83 7f 45 64 9c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8b d8 2f 83 7f 45 64 9c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.51:45684',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300154
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41752
received auth hello!
{ authId: 503, nonce: <Buffer e6 cb 61 e3 29 86 42 6b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8c 69 49 fe 32 e5 9d 9a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 91 01 09 26 25 e2 05 2a>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 91 01 09 26 25 e2 05 2a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.51:45950',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300163
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42018
received auth hello!
{ authId: 503, nonce: <Buffer 35 6c c2 41 d3 0f 05 bc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5f 10 4d 5a ae 04 b0 6a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3a 3f c0 e0 09 86 e2 67>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3a 3f c0 e0 09 86 e2 67> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.51:46216',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300172
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42284
received auth hello!
{ authId: 503, nonce: <Buffer fe 68 eb a9 00 1b cc 58> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c4 e5 0f a9 fd d9 20 30>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 50 8c a0 61 06 ef ed a6>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 50 8c a0 61 06 ef ed a6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.51:46482',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300181
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42550
received auth hello!
{ authId: 503, nonce: <Buffer 71 48 10 fc 1c 40 c3 9b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ec ee e7 e2 ed 09 f3 3b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ce 8f b3 e9 85 90 43 3b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ce 8f b3 e9 85 90 43 3b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.51:46748',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300190
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42816
received auth hello!
{ authId: 503, nonce: <Buffer 7f 2c 2d 55 b2 9c 47 f9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c0 b7 75 15 0e 82 d6 76>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 02 f1 a3 fa 1e 7b db 03>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 02 f1 a3 fa 1e 7b db 03> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.51:47014',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300199
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43082
received auth hello!
{ authId: 503, nonce: <Buffer de a8 00 ef 49 e7 29 8c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 05 57 a5 f4 08 cc db 87>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9f 6d 17 a9 d9 fe c4 34>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 9f 6d 17 a9 d9 fe c4 34> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.51:47282',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
