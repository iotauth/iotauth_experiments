changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s502.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's502',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 67 49 42 41 41 4b 43 41 51 45 41 75 55 ... > }
Handler: listening on port 22100
s502:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100001
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47428
received auth hello!
{ authId: 501, nonce: <Buffer 55 19 b9 c5 07 ca 74 0c> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer a6 31 54 75 52 33 f9 50>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer c6 4e 7d 1a 9b 95 51 82 79 98 75 10 e6 6d c3 f4>,
  macKeyVal: <Buffer 79 c6 c9 f4 d7 bc c0 86 25 e2 7b 5e 78 b3 ca 20 e5 90 11 85 79 e8 50 1c a4 f4 11 18 a9 c4 64 11>,
  absValidity: 2018-08-27T06:10:37.187Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e1 74 ae 6d a6 0c 86 0a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e1 74 ae 6d a6 0c 86 0a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.63:45522',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100009
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47662
received auth hello!
{ authId: 501, nonce: <Buffer 10 eb 9e dc 26 1f 09 fe> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ea 28 59 6f 86 0f c0 39>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ce 7d 7e ed 54 cf 6b 92>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ce 7d 7e ed 54 cf 6b 92> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.63:45754',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100017
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47932
received auth hello!
{ authId: 501, nonce: <Buffer 60 18 56 bc 6c 0f e4 b4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 14 eb 62 a3 34 83 48 a0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c7 be 7f c0 1d af b2 e2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c7 be 7f c0 1d af b2 e2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.63:46024',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100025
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48202
received auth hello!
{ authId: 501, nonce: <Buffer 67 a8 c7 a8 72 b7 af 3c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ef 4a e5 f6 c9 87 5d 72>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ad b5 db 7e e5 e1 df dc>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ad b5 db 7e e5 e1 df dc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.63:46294',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100033
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48472
received auth hello!
{ authId: 501, nonce: <Buffer aa 86 b1 be f5 6f 80 b7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 20 72 11 24 40 2f 74 6e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 73 0c e0 97 96 04 5c 02>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 73 0c e0 97 96 04 5c 02> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.63:46564',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100041
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48742
received auth hello!
{ authId: 501, nonce: <Buffer 3e a9 05 d1 58 87 22 1d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fb 60 ad b2 8e 6c 9d 2e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fb d9 98 ad bd 83 42 29>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fb d9 98 ad bd 83 42 29> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.63:46834',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100049
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49012
received auth hello!
{ authId: 501, nonce: <Buffer ab 39 85 45 0b ad 3c f6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6f f5 cb 6f 59 3e 20 cd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 39 32 d0 a0 f6 b3 f1 b8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 39 32 d0 a0 f6 b3 f1 b8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.63:47104',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300060
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300071
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 57010
received auth hello!
{ authId: 403, nonce: <Buffer 2d 24 61 76 06 30 15 da> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth403',
     commonName: '10.0.1.3' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '016579C8728B',
  notBefore: 2018-08-27T05:06:44.000Z,
  notAfter: 2018-08-28T05:08:24.000Z,
  subjectHash: 'f6675d02',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '0E:BF:EC:49:D9:17:43:13:60:D1:02:46:26:B2:8C:E8:04:22:EE:5D',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'CC68FC5D29A9F82CF47D88E000BDB366FC4FAF64E73AF78482C683A11D8ECEE99E59F68CD5AE62D5325C44E0B29316EA552046B5281C9D391D565938B6E65BCB718154062B6F4EE28D9358C9CF9E8E23796306F9BE5E0A141C881A08A53A5B9FA766526E59797527F98FDEBABC76D560B05534DB566255BEA22EB5AF103DB91478A73B3882A8B377809377FCC744C3B2CED0117C0BD00A24D5790262D77AAFA3D074F1BCDF5927B5D662244D1250128A16BAB3030D522DCADF5DE7D0D73580ADB2A653BED5E53C27AF9695589DE4082675A1E7662297A571E06F69E6046808D43D189D2EF72AEE2AA7FA94ACA2D536A977DE781026A9C7EE26EFA7E5E424AA91',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.3' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 403,
  host: '10.0.1.3',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWV5yHKLMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDgy\nNzA1MDY0NFoXDTE4MDgyODA1MDgyNFowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDQwMzERMA8GA1UEAwwIMTAuMC4xLjMwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDMaPxdKan4LPR9iOAAvbNm/E+vZOc694SCxoOhHY7O6Z5Z9ozV\nrmLVMlxE4LKTFupVIEa1KBydOR1WWTi25lvLcYFUBitvTuKNk1jJz56OI3ljBvm+\nXgoUHIgaCKU6W5+nZlJuWXl1J/mP3rq8dtVgsFU021ZiVb6iLrWvED25FHinOziC\nqLN3gJN3/MdEw7LO0BF8C9AKJNV5AmLXeq+j0HTxvN9ZJ7XWYiRNElASiha6swMN\nUi3K313n0Nc1gK2yplO+1eU8J6+WlVid5AgmdaHnZiKXpXHgb2nmBGgI1D0YnS73\nKu4qp/qUrKLVNql33ngQJqnH7ibvp+XkJKqRAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQMwDQYJKoZIhvcNAQELBQADggEBAJ7rQbLlhoc8oKym84tCt1B4Qbf0tbgg\nY+n/Ptvvj5a2EENRzgbnGDtFjvNSNKtH99Y2rzhLQLNiy06X045HzIbHZvAnt1n7\nkOAZHfWZyv1VFI8ZdQ63H17KkJWi7qtsIrGB1Bv6ydzkZj2xK/uXqB/1QuKnjnAj\nCt3Pk/Jqp92NVtnRHrsHDuKCtZeNqLvPEHTSj5ib6ibaXxlNxYiJ1OfYyAAUfQsj\n2CApq7thhwk5WzGMN7P/an/bvGSOricUvPoa1Scr04I6pzzZxEPGr97ISl7sYYI9\nJYjCOtxDpsnlh3CfqbQZktku9MvRFwGMVFL5cQ7YnhtlmbMqf3VE/xE=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300082
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57284
received auth hello!
{ authId: 403, nonce: <Buffer c8 23 06 0e 70 ca 6e bf> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 6f 75 43 9d 2b 2c df e8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer a9 3c 5b 79 20 8b 54 05 41 49 e5 35 d1 9d 3c fc>,
  macKeyVal: <Buffer 87 72 72 4c dd 44 5f f6 84 a5 18 7d 20 59 47 19 78 67 b2 02 d4 66 a2 8a 7f 4f a8 e1 77 e6 e1 46>,
  absValidity: 2018-08-27T06:21:37.585Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 26 a3 96 cc 16 a9 01 c1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 26 a3 96 cc 16 a9 01 c1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.63:48342',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300093
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57550
received auth hello!
{ authId: 403, nonce: <Buffer c4 e6 d0 d2 d2 0b f5 fd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 25 e8 3a a9 3e 92 95 12>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4f 72 54 8d 06 15 26 b2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4f 72 54 8d 06 15 26 b2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.63:48610',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300104
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57814
received auth hello!
{ authId: 403, nonce: <Buffer 4a 9e 09 55 1c 4d 83 d1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 18 71 15 4a 17 92 08 7b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ad 5a c1 bc 4d 7f a7 86>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ad 5a c1 bc 4d 7f a7 86> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.63:48872',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300115
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58076
received auth hello!
{ authId: 403, nonce: <Buffer 0f 62 73 e3 7c 2f 0a e0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0d 3c 28 65 e8 ee 5b 5a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b8 91 28 26 6d b6 2e d9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b8 91 28 26 6d b6 2e d9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.63:49134',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300126
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58336
received auth hello!
{ authId: 403, nonce: <Buffer 26 90 8b dc 41 d7 29 57> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fb 33 fa 1d 9a 2c 5e b5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 22 50 2f 45 fd ce 61 d1>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 22 50 2f 45 fd ce 61 d1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.63:49396',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300137
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58600
received auth hello!
{ authId: 403, nonce: <Buffer 7e 8d 1a 14 4a f4 b2 d8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 26 ef 7c 90 69 4b 3f 02>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e8 6b 9d ad 1b fa c6 27>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e8 6b 9d ad 1b fa c6 27> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.63:49658',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300148
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58860
received auth hello!
{ authId: 403, nonce: <Buffer 98 f7 5a b2 5e 84 4c 1d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 91 de 1b 5f 1a d8 82 59>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9c 2d fa 1f 26 3f d3 40>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9c 2d fa 1f 26 3f d3 40> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.63:49920',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300159
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59122
received auth hello!
{ authId: 403, nonce: <Buffer ef e2 ac 92 80 9b 51 4e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 56 32 28 26 66 0b 87 05>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1f 02 79 87 5c 26 4c f1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1f 02 79 87 5c 26 4c f1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.63:50182',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300170
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59384
received auth hello!
{ authId: 403, nonce: <Buffer 1f ea fb b5 0b 1b 8a 78> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f8 8c 9e 16 61 dd 67 5f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 04 c0 d8 4f 05 f7 8e 22>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 04 c0 d8 4f 05 f7 8e 22> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.63:50446',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300181
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59650
received auth hello!
{ authId: 403, nonce: <Buffer b7 2d e8 a1 93 b2 ab 83> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 72 3f 02 86 11 89 b7 72>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 47 4b 60 3c a8 0d ff c6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 47 4b 60 3c a8 0d ff c6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.63:50710',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300192
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59918
received auth hello!
{ authId: 403, nonce: <Buffer 03 94 46 f1 b5 d0 38 0f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4c c8 52 97 18 d2 89 84>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0c 77 d9 a5 83 9c 25 3a>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 0c 77 d9 a5 83 9c 25 3a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.63:50978',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300203
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60184
received auth hello!
{ authId: 403, nonce: <Buffer 80 22 4e f5 88 1a 5e aa> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ee 8a 7b d3 9c 5d c0 70>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 27 c1 ca 27 c0 31 38 8d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 27 c1 ca 27 c0 31 38 8d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.63:51244',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300214
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60450
received auth hello!
{ authId: 403, nonce: <Buffer 5f c4 f8 10 7f 60 51 5b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 37 e3 fb 08 87 ab e5 f3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d5 80 01 bf b0 65 7c af>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer d5 80 01 bf b0 65 7c af> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.63:51510',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300225
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60716
received auth hello!
{ authId: 403, nonce: <Buffer ac 3e 94 2a 4e 89 e5 77> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 46 02 9e 33 ea b2 d5 dd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4d f0 fe 39 9e e7 57 78>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4d f0 fe 39 9e e7 57 78> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.63:51776',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300236
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60982
received auth hello!
{ authId: 403, nonce: <Buffer 7b 2b 19 5d 66 c7 78 9d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c8 cf 3d 62 b8 f6 8a 5c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 81 d6 52 cc 5d 65 46 bb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 81 d6 52 cc 5d 65 46 bb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.63:52042',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300247
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33016
received auth hello!
{ authId: 403, nonce: <Buffer 6a 28 e3 b5 8d cf d3 f8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 56 22 74 99 16 b6 f8 e6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b6 0b 7f 99 ce 79 39 63>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b6 0b 7f 99 ce 79 39 63> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.63:52308',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300258
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33272
received auth hello!
{ authId: 403, nonce: <Buffer c0 fe 96 92 84 72 e8 6f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1d 42 b9 45 2c 0b 3f c5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 51 01 ad ca db 3c af a8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 51 01 ad ca db 3c af a8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.63:52564',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
