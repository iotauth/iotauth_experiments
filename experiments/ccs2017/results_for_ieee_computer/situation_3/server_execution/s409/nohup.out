changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s409.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's409',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 7a 43 ... > }
Handler: listening on port 22100
s409:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200061
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57630
received auth hello!
{ authId: 402, nonce: <Buffer 63 36 f6 54 5b 36 a3 c9> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer d1 69 65 db b7 a9 bf 9d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 4a 8e ef fa 66 34 2e 88 ae ab 5f bb 7f 3f 34 9f>,
  macKeyVal: <Buffer 31 67 0b b5 e6 ef 09 a1 8d 62 4c 63 15 e3 7d b7 52 6e dc 7c 71 0c 2f fa 92 ea ac a8 e8 f6 65 ca>,
  absValidity: 2018-08-27T05:29:21.845Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0f ce 5b aa 9b 62 0b 48>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 0f ce 5b aa 9b 62 0b 48> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.55:55298',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200068
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57816
received auth hello!
{ authId: 402, nonce: <Buffer 22 82 57 27 a1 a8 d2 14> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0c c0 70 42 14 7e 93 4c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fb dd c4 1c 4a f8 47 c6>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer fb dd c4 1c 4a f8 47 c6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.55:55484',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200075
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58086
received auth hello!
{ authId: 402, nonce: <Buffer ce df c6 e1 47 7c 4f 86> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ef b5 bf cf be f0 6a 24>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f7 d0 89 dc 93 07 b7 31>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f7 d0 89 dc 93 07 b7 31> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.55:55754',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200082
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58356
received auth hello!
{ authId: 402, nonce: <Buffer bd 35 5b 2d b2 5a 98 0f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 08 ff ed fd c9 1a 51 25>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 64 47 78 05 38 75 72 b2>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 64 47 78 05 38 75 72 b2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.55:56024',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200089
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58626
received auth hello!
{ authId: 402, nonce: <Buffer e8 48 0a e5 3d 62 25 26> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fa 59 17 4a b0 6a 3d 5c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 31 9a 92 98 6e e7 2e 07>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 31 9a 92 98 6e e7 2e 07> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.55:56294',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200096
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58896
received auth hello!
{ authId: 402, nonce: <Buffer 0a 41 2c c8 7f 6d a4 f6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f3 c7 da d3 14 a2 58 a1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3a 22 19 10 c4 a9 50 c8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3a 22 19 10 c4 a9 50 c8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.55:56564',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200103
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59166
received auth hello!
{ authId: 402, nonce: <Buffer a6 fa b8 11 eb f1 37 55> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5a 53 66 74 27 43 3f 24>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ee 95 1f 45 52 fc 54 a1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ee 95 1f 45 52 fc 54 a1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.55:56834',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
