changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s506.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's506',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 67 49 42 41 41 4b 43 41 51 45 41 7a 50 ... > }
Handler: listening on port 22100
s506:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100062
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42678
received auth hello!
{ authId: 501, nonce: <Buffer 5b dd bd 0d ab 12 79 c7> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 54 10 40 e3 1d 17 6b 7e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer b8 a2 33 8b 6d fd 57 f7 23 a4 fc 7b 6e a0 c7 e8>,
  macKeyVal: <Buffer 4e 93 fe dc 67 08 42 14 95 78 48 b1 31 75 89 5e 9c b3 0a 7d 4d e1 3c 2e a8 63 50 80 86 35 2b af>,
  absValidity: 2018-08-27T05:30:08.667Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fa 43 b9 c6 30 00 1f ce>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer fa 43 b9 c6 30 00 1f ce> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.70:42212',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100070
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42948
received auth hello!
{ authId: 501, nonce: <Buffer 4b 33 75 50 1d 0a 7e 61> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f2 10 de b5 ed c5 ad 0e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 86 92 12 9d d0 ee 44 1f>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 86 92 12 9d d0 ee 44 1f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.70:42482',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100078
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43218
received auth hello!
{ authId: 501, nonce: <Buffer 7f ec 1b bb 23 3e d8 69> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 92 e5 66 4d b2 63 24 86>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c3 2b d9 22 fc 18 3c b8>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c3 2b d9 22 fc 18 3c b8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.70:42752',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100086
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43488
received auth hello!
{ authId: 501, nonce: <Buffer ff b6 dc dc f7 89 0e 0f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 17 d9 9c b6 66 b7 fa 2f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d4 7e 7c 16 58 30 ae c5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d4 7e 7c 16 58 30 ae c5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.70:43022',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100094
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43758
received auth hello!
{ authId: 501, nonce: <Buffer 5b c2 37 4a 8a 16 a3 31> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7c d6 9b a9 0d 68 f8 1b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c6 e0 2b cc 02 04 2f 9a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c6 e0 2b cc 02 04 2f 9a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.70:43292',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100102
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44028
received auth hello!
{ authId: 501, nonce: <Buffer ff 2c 01 1d b6 d3 be fc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 81 f1 41 09 db dc bc 32>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 06 92 39 42 ed 72 5f b8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 06 92 39 42 ed 72 5f b8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.70:43562',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100110
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44294
received auth hello!
{ authId: 501, nonce: <Buffer 2d a4 73 f9 5c 46 a7 a9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 75 1f 17 a8 72 0d 64 e5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 96 eb bc ad 0a ec 45 24>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 96 eb bc ad 0a ec 45 24> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.70:43828',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200388
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200397
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in server - details: handshake2 timed out...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in server - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in server - details: Error occurred in migration request: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200412
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 57444
received auth hello!
{ authId: 502, nonce: <Buffer 29 18 42 d9 bd 46 a9 72> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '016579A30A2F',
  notBefore: 2018-08-27T04:25:52.000Z,
  notAfter: 2018-08-28T04:27:32.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '33:51:DA:47:DD:99:6A:B3:5B:22:4E:07:B8:2F:40:3E:8A:A1:DF:0E',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'B138D36BE53FEF7A4EAFB969AC06E51234F04819636E9BD1C18A274EF509C20F60425ECB70D73DBE38728E4C8AE5C9A51F6B212017E83DB7265ADE4EB91743FF00E6384C91216C08E24F877D4756852A1A006533657C2AD970B6694EAA6074DD788860A9BBCCF0D830F5A7FED589C63785576A172E75E8EA5C2AFC1B8563D3B27BB7450A9659E288F607AA1643255BB6082A7AF57221C9DB5DDE2AFA6C5D86E13162450B4905BD4511BE1D82F1A3D32974AE25E6317777B2B45BA251A2511FFC8EF6FAE19E1CFC5BEEC19ADFE72E99C553F36401DCCA304F5C309892EE68C67986CBBFB67CEC5666ADDA8CD6487848CF2EDC5C68B7924C91D54BBEC322B2C309',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWV5owovMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDgy\nNzA0MjU1MloXDTE4MDgyODA0MjczMlowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQCxONNr5T/vek6vuWmsBuUSNPBIGWNum9HBiidO9QnCD2BCXstw\n1z2+OHKOTIrlyaUfayEgF+g9tyZa3k65F0P/AOY4TJEhbAjiT4d9R1aFKhoAZTNl\nfCrZcLZpTqpgdN14iGCpu8zw2DD1p/7VicY3hVdqFy516OpcKvwbhWPTsnu3RQqW\nWeKI9geqFkMlW7YIKnr1ciHJ213eKvpsXYbhMWJFC0kFvUURvh2C8aPTKXSuJeYx\nd3eytFuiUaJRH/yO9vrhnhz8W+7Bmt/nLpnFU/NkAdzKME9cMJiS7mjGeYbLv7Z8\n7FZmrdqM1kh4SM8u3Fxot5JMkdVLvsMissMJAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAG/nd26Nl8Rqyu/kvPaeeYPxmlno08ZD\nTxk0bODd0lbipQ79XMiN30hKPS3S0tP3KIIGxk7s4TSsYpskvSKU1RPCNgs7f0X/\nCSd0zcLiFlepnnaEEoNCSPhK1CyfRLu4fGxxx7+PLSLiuZkts65JOJRp9fgcdZ4Y\nwr5q7I/RDBHTlYPOdl2BCoDpe4tYwHg6FP6yzy06yf31WsTQXOJTP1rEccTBNjB2\nJI8MC1+Oy7+xxggC3lFV7M0/ESgJI+6L1bVacW7yToijbB9Gk8YTi3xnTQTYZBAo\nj0Zxc/94PXCTDu8aChhb5ZtyWwffMjbSSbU24BefKgeDneU5ZS1CuyY=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 1
to: 2
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200427
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57690
received auth hello!
{ authId: 502, nonce: <Buffer 9b 03 27 fe 0b 25 6e 9e> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer f7 43 6b ff e6 62 1e 13>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 21 c2 10 9e d0 cc 65 46 83 b6 8f ff c7 72 3a 28>,
  macKeyVal: <Buffer ec 05 26 78 58 d4 fc 0e 7e b1 eb 9e 0e 96 f7 86 32 00 b7 bc 36 43 54 a9 2a 40 26 bb 41 cb 86 28>,
  absValidity: 2018-08-27T05:43:08.651Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer df 2c 4f 52 91 25 7a 15>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer df 2c 4f 52 91 25 7a 15> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.70:45464',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200442
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57948
received auth hello!
{ authId: 502, nonce: <Buffer bf 97 43 01 23 72 92 e2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 58 fc 4a dd 27 a4 d6 3b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7c 07 9f d6 14 1c cf 93>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 7c 07 9f d6 14 1c cf 93> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.70:45722',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200457
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58218
received auth hello!
{ authId: 502, nonce: <Buffer 5e 19 5c f0 9c c0 d0 fd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cd 77 e5 a7 11 6a e7 b7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f0 07 93 01 de ea d9 30>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f0 07 93 01 de ea d9 30> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.70:45992',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200471
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58490
received auth hello!
{ authId: 502, nonce: <Buffer bd 47 7f a8 1b 33 2b be> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 15 26 40 f6 dd 10 a7 3c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a5 57 62 e4 0f e7 f6 af>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a5 57 62 e4 0f e7 f6 af> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.70:46264',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200485
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58692
received auth hello!
{ authId: 502, nonce: <Buffer 47 f6 16 49 9d 90 fd 94> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 46 38 9c 81 96 03 ca 71>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5a 6e e5 07 aa e2 dd 05>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5a 6e e5 07 aa e2 dd 05> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.70:46466',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200499
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58898
received auth hello!
{ authId: 502, nonce: <Buffer f4 8f 00 43 9f 06 0d d9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 91 91 6b a3 33 35 e4 d1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 60 b3 dd c9 93 ba ec 65>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 60 b3 dd c9 93 ba ec 65> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.70:46672',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200513
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59102
received auth hello!
{ authId: 502, nonce: <Buffer 15 af 46 01 97 4d ce f2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 24 09 74 7c 3a fa 02 34>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c0 e6 3e 22 c8 59 56 71>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c0 e6 3e 22 c8 59 56 71> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.70:46876',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200527
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59302
received auth hello!
{ authId: 502, nonce: <Buffer 3a a0 5c 21 8e c3 3a 92> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 27 8a 67 0c 79 e4 b2 da>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e4 af fc b1 e6 7a b1 79>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e4 af fc b1 e6 7a b1 79> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.70:47076',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200541
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59502
received auth hello!
{ authId: 502, nonce: <Buffer 60 fd ce 2f 33 cc fa cf> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4a 1e 2b f4 61 03 97 6c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer de be 65 f2 49 90 37 2d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer de be 65 f2 49 90 37 2d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.70:47276',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200555
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59702
received auth hello!
{ authId: 502, nonce: <Buffer 06 2f 72 af 07 96 7d d5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d8 bd dc 1b b8 2a 7c 1e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 65 39 8b 17 84 cc 24 c2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 65 39 8b 17 84 cc 24 c2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.70:47476',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200569
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59902
received auth hello!
{ authId: 502, nonce: <Buffer 70 1a 7e bc 95 3b 61 4f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7d 0c 65 37 1d 37 6f af>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 03 d4 63 bb 9a f9 05 e1>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 03 d4 63 bb 9a f9 05 e1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.70:47676',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200583
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60102
received auth hello!
{ authId: 502, nonce: <Buffer a6 29 ab d0 45 d1 57 5b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c8 d4 69 3d 97 29 6c a5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 45 1e c5 ef cd 9a b4 66>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 45 1e c5 ef cd 9a b4 66> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.70:47876',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200597
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60302
received auth hello!
{ authId: 502, nonce: <Buffer a7 8b db d7 fc 8d f5 22> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 21 74 c0 66 e4 b1 bb 92>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 79 3d 1b 68 55 58 e4 ef>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 79 3d 1b 68 55 58 e4 ef> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.70:48076',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200611
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60502
received auth hello!
{ authId: 502, nonce: <Buffer 01 0f 2f d0 8b b1 b1 7d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 44 93 6c be db 05 9f e7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 59 5d 5d 22 28 3b 4e 58>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 59 5d 5d 22 28 3b 4e 58> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.70:48276',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
