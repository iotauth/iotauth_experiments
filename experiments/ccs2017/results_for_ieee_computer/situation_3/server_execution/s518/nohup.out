changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s518.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's518',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 67 49 42 41 41 4b 43 41 51 45 41 6c 72 ... > }
Handler: listening on port 22100
s518:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400041
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33096
received auth hello!
{ authId: 504, nonce: <Buffer ed b3 b2 03 f8 46 d9 90> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer f4 4a 6c 31 34 64 d0 e2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 23 5b ce 73 92 2b b3 08 13 32 29 4b 25 d0 2b 12>,
  macKeyVal: <Buffer 31 fd 6d ef 61 c9 dc 18 bd b5 d8 8a 75 9e 90 50 0f f4 10 c7 e4 9a 2b cb be 55 f2 13 79 85 8b 0b>,
  absValidity: 2018-08-27T05:30:56.842Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8d 23 7b 3b 9d a8 14 b5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8d 23 7b 3b 9d a8 14 b5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.84:33664',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400043
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33122
received auth hello!
{ authId: 504, nonce: <Buffer d6 a3 89 9f 11 af f6 84> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 14 91 b5 62 39 1e 46 07>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a3 fd 28 15 8d 8f df b9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a3 fd 28 15 8d 8f df b9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.85:58042',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400047
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33364
received auth hello!
{ authId: 504, nonce: <Buffer 8d 91 db 9a de c9 a4 84> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 14 83 35 82 5b b9 4e 53>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 96 1b 37 5c a8 88 6e f4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 96 1b 37 5c a8 88 6e f4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.84:33934',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400049
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33392
received auth hello!
{ authId: 504, nonce: <Buffer 3d 2b f4 41 e5 41 db 39> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 80 51 f7 27 9b 3e a9 ba>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f6 c7 cb 58 34 03 c3 88>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f6 c7 cb 58 34 03 c3 88> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.85:58312',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400053
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33636
received auth hello!
{ authId: 504, nonce: <Buffer 5e 44 4c 76 24 70 ba 0b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9f 11 3e 83 3a cc f2 15>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 46 19 af be a5 d9 3b da>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 46 19 af be a5 d9 3b da> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.84:34204',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400055
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33662
received auth hello!
{ authId: 504, nonce: <Buffer 5a 35 c6 8f 87 5c 3b de> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d3 f1 b7 b5 5a 88 37 36>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3b f0 f9 32 34 65 bc a8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3b f0 f9 32 34 65 bc a8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.85:58582',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400059
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33904
received auth hello!
{ authId: 504, nonce: <Buffer 85 5c 58 2d f6 d6 04 69> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 51 3b 2c d4 36 e2 2d cd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 99 ec ed 66 1e c8 90 10>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 99 ec ed 66 1e c8 90 10> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.84:34474',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400061
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33932
received auth hello!
{ authId: 504, nonce: <Buffer 7f 11 e7 83 85 66 28 2a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ba dc 7a e1 61 b1 79 11>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer df 62 bb 7a bb 75 31 c4>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer df 62 bb 7a bb 75 31 c4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.85:58852',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400065
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34174
received auth hello!
{ authId: 504, nonce: <Buffer 06 22 a6 27 8b 4f 1d 73> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e9 63 7e fe 74 08 31 99>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 25 ac e5 fe 80 a0 fc 24>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 25 ac e5 fe 80 a0 fc 24> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.84:34744',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400067
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34202
received auth hello!
{ authId: 504, nonce: <Buffer 73 2f 3e 94 94 65 0b d2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 55 95 20 fe a9 cb ec ef>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 33 d2 fd e6 19 e7 95 2a>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 33 d2 fd e6 19 e7 95 2a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.85:59122',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400071
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34446
received auth hello!
{ authId: 504, nonce: <Buffer 6e 93 56 d9 83 72 c5 c3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b6 ac 2b 44 4b fb 4f 1a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9e 67 29 ee ce 68 a8 65>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 9e 67 29 ee ce 68 a8 65> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.84:35014',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400073
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34472
received auth hello!
{ authId: 504, nonce: <Buffer 78 54 2b 01 f4 f3 8c 69> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e5 08 ed 11 6d f5 2d e1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 55 bb ca 3d 00 a3 a9 7b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 55 bb ca 3d 00 a3 a9 7b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.85:59392',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100395
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100407
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 46582
received auth hello!
{ authId: 503, nonce: <Buffer f5 36 e6 fd 3f 76 a2 c2> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in server - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100419
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 46856
received auth hello!
{ authId: 503, nonce: <Buffer 20 17 33 6f 6c 87 08 2e> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in server - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Handler: Error in server - details: Auth hello timedout ...
