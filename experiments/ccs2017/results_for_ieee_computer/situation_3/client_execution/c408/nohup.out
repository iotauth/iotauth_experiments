changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c408.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c408',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 6f 43 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1535344141913
connected to auth! from local port 36652
received auth hello!
{ authId: 402, nonce: <Buffer 7d a4 6e b1 35 93 7c 93> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 57 5e 3d 15 cf 34 15 dd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 8b 8f 47 e0 da 24 c6 bf bd 64 9d 17 a4 48 9b 37>,
  macKeyVal: <Buffer 69 b2 d1 6b 37 0a 6d b3 2f 65 bf 52 a8 1d 36 44 e0 18 9c bf 41 75 57 66 c4 d6 11 1f ca db 8b 98>,
  absValidity: 2018-08-27T05:29:02.077Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200056,
  cipherKeyVal: <Buffer 33 fd 21 18 d1 e5 c3 60 e9 b2 0e b7 d5 a2 fd 53>,
  macKeyVal: <Buffer a0 42 78 57 7d 7a d4 a8 d8 4d ce 43 d2 f1 4c 00 87 aa 41 e4 2f d0 4b ec b5 c1 69 2d cd dc 32 fa>,
  absValidity: 2018-08-28T04:29:02.077Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40200056,
     cipherKeyVal: <Buffer 33 fd 21 18 d1 e5 c3 60 e9 b2 0e b7 d5 a2 fd 53>,
     macKeyVal: <Buffer a0 42 78 57 7d 7a d4 a8 d8 4d ce 43 d2 f1 4c 00 87 aa 41 e4 2f d0 4b ec b5 c1 69 2d cd dc 32 fa>,
     absValidity: 2018-08-28T04:29:02.077Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 01 27 1d 4d 10 b8 09 54>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 04:29:02 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1535344143007
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1535344201972
connected to auth! from local port 36808
received auth hello!
{ authId: 402, nonce: <Buffer 25 94 fd 85 88 10 c7 30> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6a 9b ca b0 aa 30 39 b3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200063,
  cipherKeyVal: <Buffer 84 bf 1d f2 32 1e b3 d6 ff da 54 03 8a 58 6f 02>,
  macKeyVal: <Buffer 51 60 05 29 4d 57 f6 3e c3 16 50 0c 6d 60 22 63 ae ef 59 45 e5 9f 6b c7 ab 3c 93 c1 0e db 26 40>,
  absValidity: 2018-08-28T04:30:02.111Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40200063,
     cipherKeyVal: <Buffer 84 bf 1d f2 32 1e b3 d6 ff da 54 03 8a 58 6f 02>,
     macKeyVal: <Buffer 51 60 05 29 4d 57 f6 3e c3 16 50 0c 6d 60 22 63 ae ef 59 45 e5 9f 6b c7 ab 3c 93 c1 0e db 26 40>,
     absValidity: 2018-08-28T04:30:02.111Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer cf e3 ae 9b 4c c4 13 5f>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 04:30:02 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1535344203001
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1535344262032
connected to auth! from local port 37068
received auth hello!
{ authId: 402, nonce: <Buffer 9a b9 17 d8 8a 99 39 f2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d8 f4 2a a0 1f cb 6e e5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200070,
  cipherKeyVal: <Buffer 8f 59 e6 c9 34 3e 80 a1 fa de 89 bc 38 45 04 ec>,
  macKeyVal: <Buffer 60 60 e0 50 64 b7 29 c6 57 80 e1 41 7a ae b3 d8 b2 9f 88 47 d7 cb 03 1f 93 99 5f ad 25 7a 2e d7>,
  absValidity: 2018-08-28T04:31:02.197Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40200070,
     cipherKeyVal: <Buffer 8f 59 e6 c9 34 3e 80 a1 fa de 89 bc 38 45 04 ec>,
     macKeyVal: <Buffer 60 60 e0 50 64 b7 29 c6 57 80 e1 41 7a ae b3 d8 b2 9f 88 47 d7 cb 03 1f 93 99 5f ad 25 7a 2e d7>,
     absValidity: 2018-08-28T04:31:02.197Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 66 81 a8 d5 0e 23 06 37>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 04:31:02 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1535344263143
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1535344322088
connected to auth! from local port 37338
received auth hello!
{ authId: 402, nonce: <Buffer fe d3 56 77 9f ab b1 d2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c1 c3 c0 b0 58 39 7a 9e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200077,
  cipherKeyVal: <Buffer 3b 74 a2 c9 da d8 f7 e8 dc 95 58 fd 99 3d 0c d4>,
  macKeyVal: <Buffer da 20 27 b1 e7 02 e8 5b 8b 97 40 0f bb 88 72 70 d4 bd fb a6 81 52 56 00 42 22 39 0b fa 51 4d f4>,
  absValidity: 2018-08-28T04:32:02.240Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40200077,
     cipherKeyVal: <Buffer 3b 74 a2 c9 da d8 f7 e8 dc 95 58 fd 99 3d 0c d4>,
     macKeyVal: <Buffer da 20 27 b1 e7 02 e8 5b 8b 97 40 0f bb 88 72 70 d4 bd fb a6 81 52 56 00 42 22 39 0b fa 51 4d f4>,
     absValidity: 2018-08-28T04:32:02.240Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 67 6b fb c8 5e b4 4a 96>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 04:32:02 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1535344323030
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1535344382144
connected to auth! from local port 37608
received auth hello!
{ authId: 402, nonce: <Buffer 3e 81 01 3b eb 8b 59 e3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b0 b4 26 08 be bb d4 ce>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200084,
  cipherKeyVal: <Buffer 72 c5 b7 89 35 53 da 9e 65 d9 02 c4 a3 1e 1c e2>,
  macKeyVal: <Buffer 1c ed 67 cb be b9 46 26 b6 f6 13 4a 67 ec 4d 83 c5 cd 06 c0 fa 45 fe 65 48 5c 32 45 41 91 bc f5>,
  absValidity: 2018-08-28T04:33:02.307Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40200084,
     cipherKeyVal: <Buffer 72 c5 b7 89 35 53 da 9e 65 d9 02 c4 a3 1e 1c e2>,
     macKeyVal: <Buffer 1c ed 67 cb be b9 46 26 b6 f6 13 4a 67 ec 4d 83 c5 cd 06 c0 fa 45 fe 65 48 5c 32 45 41 91 bc f5>,
     absValidity: 2018-08-28T04:33:02.307Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 30 dd 60 d6 ee d5 6f 50>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 04:33:02 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1535344383238
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1535344442200
connected to auth! from local port 37878
received auth hello!
{ authId: 402, nonce: <Buffer 91 06 ac c0 62 af 0a 80> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 25 fb 72 45 f7 9e 7f ed>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200091,
  cipherKeyVal: <Buffer 12 bc 9b f3 a7 27 6c 02 a5 70 26 dd d9 a8 36 db>,
  macKeyVal: <Buffer 82 aa d1 43 64 60 e4 22 4b 9d 50 85 8d f4 33 6d ef 0e 76 f4 74 a9 f6 ba 44 6d 17 a9 c2 84 c8 1a>,
  absValidity: 2018-08-28T04:34:02.340Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40200091,
     cipherKeyVal: <Buffer 12 bc 9b f3 a7 27 6c 02 a5 70 26 dd d9 a8 36 db>,
     macKeyVal: <Buffer 82 aa d1 43 64 60 e4 22 4b 9d 50 85 8d f4 33 6d ef 0e 76 f4 74 a9 f6 ba 44 6d 17 a9 c2 84 c8 1a>,
     absValidity: 2018-08-28T04:34:02.340Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 11 e6 39 04 99 2b 27 94>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 04:34:02 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1535344443218
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1535344502259
connected to auth! from local port 38148
received auth hello!
{ authId: 402, nonce: <Buffer 15 e4 3e c3 81 70 39 ba> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8b 6a ce 9e 99 2b 21 77>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200098,
  cipherKeyVal: <Buffer 16 2c 58 cd 86 6c ae 9b 72 52 94 f6 4f 0d 2e 18>,
  macKeyVal: <Buffer 11 82 82 e7 d1 7f 32 eb 42 85 43 cd c1 3c c9 1d f5 c5 30 1a bf 17 c8 53 99 d8 4b fb 23 1c 67 4d>,
  absValidity: 2018-08-28T04:35:02.407Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40200098,
     cipherKeyVal: <Buffer 16 2c 58 cd 86 6c ae 9b 72 52 94 f6 4f 0d 2e 18>,
     macKeyVal: <Buffer 11 82 82 e7 d1 7f 32 eb 42 85 43 cd c1 3c c9 1d f5 c5 30 1a bf 17 c8 53 99 d8 4b fb 23 1c 67 4d>,
     absValidity: 2018-08-28T04:35:02.407Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 1a 96 34 d4 fc 6e 2b 10>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 04:35:02 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1535344503334
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1535344562318
connected to auth! from local port 38418
received auth hello!
{ authId: 402, nonce: <Buffer d0 b1 b9 bd 80 72 80 92> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f5 6e f4 53 1b 23 ec 6c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200105,
  cipherKeyVal: <Buffer 7a b3 18 51 10 95 83 80 91 2b a2 b0 f0 28 1c 13>,
  macKeyVal: <Buffer b7 9a ff 16 44 62 ac a7 3a 0f 55 31 05 62 29 34 a4 62 bc 5c 8e 65 d2 9d a6 53 c1 06 e1 eb eb 2e>,
  absValidity: 2018-08-28T04:36:02.425Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40200105,
     cipherKeyVal: <Buffer 7a b3 18 51 10 95 83 80 91 2b a2 b0 f0 28 1c 13>,
     macKeyVal: <Buffer b7 9a ff 16 44 62 ac a7 3a 0f 55 31 05 62 29 34 a4 62 bc 5c 8e 65 d2 9d a6 53 c1 06 e1 eb eb 2e>,
     absValidity: 2018-08-28T04:36:02.425Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 07 57 54 e5 a2 dc 1e c5>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 04:36:02 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 8 1 1535344563314
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 9 0.8888888888888888 1535344622364
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 10 0.8 1535344682375
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 54362
received auth hello!
{ authId: 502, nonce: <Buffer e0 2a 4e 11 ce e8 40 3a> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 11 0.7272727272727273 1535344742384
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 54586
received auth hello!
{ authId: 502, nonce: <Buffer 02 b0 95 ab 65 21 6d ef> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 12 0.6666666666666666 1535344802394
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 13 0.6153846153846154 1535344862401
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 32932
received auth hello!
{ authId: 401, nonce: <Buffer 88 95 10 f2 a4 02 e5 bd> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth401',
     commonName: '10.0.1.1' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth402',
     commonName: '10.0.0.2' },
  serial: '016579A30508',
  notBefore: 2018-08-27T04:25:51.000Z,
  notAfter: 2018-08-28T04:27:31.000Z,
  subjectHash: 'de555cae',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '79:D7:F0:36:F5:63:C9:5F:2F:6C:10:F7:B5:4C:7F:0A:36:A9:97:CE',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'AF23BC17C526A7AFDABD10E11B69948936F06BDEC216730D0926F4729C3F53806C2812687248D00BE365D1DB11907B8C3441F9A9A7F0B913065F79BBEFB9605DD128C9B144B177076B7E46B92A3FA31511995B3D57F9BFA275EBEDA464AF403971A8925028BF43CC548AC9052D7E35AD851586AC0C4EA1FC7C755E22CB819A087D35C0E9C0DF733E9757F060E6AF797111A2B852A6191E6341A7CF678D8604077227A06289ADD8492928D5EECC3787C220575D0F755645359EFE007ECCC7BBCE9132761D1346C2B4F372E3F9A44DF760E0EDCCAC935454D03E6F2A22C1BFC15A4ABCAA38B7AB27FC12DF6127B9A5258B4BD00B1E6D28F03EEDEDAE39ABC5924F',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.1' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 401,
  host: '10.0.1.1',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWV5owUIMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDIxETAPBgNVBAMMCDEwLjAuMC4yMB4XDTE4MDgy\nNzA0MjU1MVoXDTE4MDgyODA0MjczMVowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDQwMTERMA8GA1UEAwwIMTAuMC4xLjEwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQCvI7wXxSanr9q9EOEbaZSJNvBr3sIWcw0JJvRynD9TgGwoEmhy\nSNAL42XR2xGQe4w0Qfmpp/C5EwZfebvvuWBd0SjJsUSxdwdrfka5Kj+jFRGZWz1X\n+b+idevtpGSvQDlxqJJQKL9DzFSKyQUtfjWthRWGrAxOofx8dV4iy4GaCH01wOnA\n33M+l1fwYOaveXERorhSphkeY0Gnz2eNhgQHciegYomt2EkpKNXuzDeHwiBXXQ91\nVkU1nv4AfszHu86RMnYdE0bCtPNy4/mkTfdg4O3MrJNUVNA+byoiwb/BWkq8qji3\nqyf8Et9hJ7mlJYtL0AsebSjwPu3trjmrxZJPAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQEwDQYJKoZIhvcNAQELBQADggEBAD1utwYa5+xnllujS5dNOdoosfgaJAEl\nlQNGOFbYHbYFwyjppfapHpodKI5w+ThXBhVDDp9ZfzMzSptRpO7i+b7t1fmocUdT\nTbBXZ+QdPnEFUVnDK3Nqko/Bitsroyfrh83XfNGni4hsWihfR1LTbasb6Z+oEpKT\n+SVOCbrulTjuzGTWwLh6gcomgh9RYgy3/6qh3sRadHEn9nhWqgBo+i64otcKtozN\nzFswSGMIe2L76I+gi2JSLAR5DQ1sIGTsh46EnbiViYCjcWCpNc2vpyC1uHBgwIBF\ns+8FN/dpf9fOzPqIS1BXjV2w/BSYhWnMpKEIjglpASpBjWVarQoxIes=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 2
to: 3
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 14 0.5714285714285714 1535344922412
connected to auth! from local port 33172
received auth hello!
{ authId: 401, nonce: <Buffer 94 84 fc 84 06 49 eb 06> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 62 e3 c6 9d 76 9f 8c 91>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 21 c7 1b b6 2c e4 44 7f 00 24 aa 61 cf fd 57 29>,
  macKeyVal: <Buffer 80 31 74 29 9f 61 01 cf 7d 8b 0b d6 78 20 66 a8 9f a0 b9 2a 5c 2e 81 40 a3 9b 65 e9 23 79 53 a2>,
  absValidity: 2018-08-27T05:42:06.200Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100381,
  cipherKeyVal: <Buffer 37 d8 51 bb 78 ed 6d ae de 39 78 56 07 0d 38 bc>,
  macKeyVal: <Buffer 0f 9e a8 78 c2 23 19 c2 ee 0c 3b bb 61 30 b5 1f 70 2e 93 3d 1e 51 52 4f d5 83 8e ab 16 42 e8 80>,
  absValidity: 2018-08-28T04:42:06.200Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40100381,
     cipherKeyVal: <Buffer 37 d8 51 bb 78 ed 6d ae de 39 78 56 07 0d 38 bc>,
     macKeyVal: <Buffer 0f 9e a8 78 c2 23 19 c2 ee 0c 3b bb 61 30 b5 1f 70 2e 93 3d 1e 51 52 4f d5 83 8e ab 16 42 e8 80>,
     absValidity: 2018-08-28T04:42:06.200Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 31 c8 70 2a 78 7c b6 17>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.13:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 15 0.5333333333333333 1535344982416
connected to auth! from local port 33430
received auth hello!
{ authId: 401, nonce: <Buffer 14 e3 2f d7 a5 09 79 57> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 14 54 d0 a1 c9 f5 d1 57>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100390,
  cipherKeyVal: <Buffer af c7 05 52 b4 2f 48 8d ae 9c f6 fd 40 41 36 76>,
  macKeyVal: <Buffer 19 ad 37 57 32 3e b8 76 90 0b 33 33 67 f9 6f 9c 70 0e 1e f1 7c 36 d9 cc 05 a0 15 85 8f b9 43 97>,
  absValidity: 2018-08-28T04:43:09.294Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40100390,
     cipherKeyVal: <Buffer af c7 05 52 b4 2f 48 8d ae 9c f6 fd 40 41 36 76>,
     macKeyVal: <Buffer 19 ad 37 57 32 3e b8 76 90 0b 33 33 67 f9 6f 9c 70 0e 1e f1 7c 36 d9 cc 05 a0 15 85 8f b9 43 97>,
     absValidity: 2018-08-28T04:43:09.294Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 9f c3 df 07 8a d5 62 16>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.13:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 16 0.5 1535345042419
connected to auth! from local port 33682
received auth hello!
{ authId: 401, nonce: <Buffer 46 85 35 9c 83 67 a7 04> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 86 57 e7 5f 29 eb c5 c3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100398,
  cipherKeyVal: <Buffer 11 1a 0e c4 66 86 19 40 f9 39 79 66 8b bd d2 98>,
  macKeyVal: <Buffer 7d 07 85 f6 b3 88 8c 79 c4 c8 fc 8d 2a 35 a0 b6 05 a1 bb 5f 12 f5 d5 f4 f9 35 7f 35 92 d2 f2 3c>,
  absValidity: 2018-08-28T04:44:06.249Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40100398,
     cipherKeyVal: <Buffer 11 1a 0e c4 66 86 19 40 f9 39 79 66 8b bd d2 98>,
     macKeyVal: <Buffer 7d 07 85 f6 b3 88 8c 79 c4 c8 fc 8d 2a 35 a0 b6 05 a1 bb 5f 12 f5 d5 f4 f9 35 7f 35 92 d2 f2 3c>,
     absValidity: 2018-08-28T04:44:06.249Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer dc e0 bc 3b 83 39 9d 11>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.13:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 17 0.47058823529411764 1535345102425
connected to auth! from local port 33944
received auth hello!
{ authId: 401, nonce: <Buffer 23 fa 3c 23 cc ec 41 05> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bb 70 56 fd f5 de f8 b5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100410,
  cipherKeyVal: <Buffer 36 34 7e 3e c4 e1 0a d6 27 42 bc fc cb f1 96 34>,
  macKeyVal: <Buffer 55 7b ae 7d 9f 54 a1 f9 1d 20 7a ec a3 f5 4a bc f0 3f c9 db 40 1f 36 42 00 eb 98 e4 ea 7e bd 53>,
  absValidity: 2018-08-28T04:45:06.269Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40100410,
     cipherKeyVal: <Buffer 36 34 7e 3e c4 e1 0a d6 27 42 bc fc cb f1 96 34>,
     macKeyVal: <Buffer 55 7b ae 7d 9f 54 a1 f9 1d 20 7a ec a3 f5 4a bc f0 3f c9 db 40 1f 36 42 00 eb 98 e4 ea 7e bd 53>,
     absValidity: 2018-08-28T04:45:06.269Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 2d cb 6a 08 2e 25 72 1b>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.13:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 18 0.4444444444444444 1535345162431
connected to auth! from local port 34214
received auth hello!
{ authId: 401, nonce: <Buffer 22 13 6f 0f 74 13 fc dd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ba 2e 05 04 8d 5b bd e9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100423,
  cipherKeyVal: <Buffer 4d 58 2b 5c aa 41 7c e5 54 15 65 7b 68 4f 4c f7>,
  macKeyVal: <Buffer f5 a4 e4 7b fa 54 9c 59 a5 90 db a7 cc f7 68 35 2f b9 a3 50 c9 fd 6c 24 86 d3 02 74 ce 3a fd ce>,
  absValidity: 2018-08-28T04:46:06.842Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40100423,
     cipherKeyVal: <Buffer 4d 58 2b 5c aa 41 7c e5 54 15 65 7b 68 4f 4c f7>,
     macKeyVal: <Buffer f5 a4 e4 7b fa 54 9c 59 a5 90 db a7 cc f7 68 35 2f b9 a3 50 c9 fd 6c 24 86 d3 02 74 ce 3a fd ce>,
     absValidity: 2018-08-28T04:46:06.842Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer d5 6d 6e 8e a8 c3 5a 69>
switching to HANDSHAKE_1_SENT
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.13:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 19 0.42105263157894735 1535345222437
connected to auth! from local port 34440
received auth hello!
{ authId: 401, nonce: <Buffer da ab 3c 96 1a 7a 0a 42> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b7 76 31 3a 2e 48 58 c7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100435,
  cipherKeyVal: <Buffer ff 48 65 37 3c 7c 99 55 8a 9a e2 db b3 43 28 21>,
  macKeyVal: <Buffer 3e e1 70 74 7e 8d 1c 18 91 48 10 fe 01 33 9b 62 12 f8 1e 3e 9a e8 58 7a a0 7d a2 d9 33 c9 bc db>,
  absValidity: 2018-08-28T04:47:04.857Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40100435,
     cipherKeyVal: <Buffer ff 48 65 37 3c 7c 99 55 8a 9a e2 db b3 43 28 21>,
     macKeyVal: <Buffer 3e e1 70 74 7e 8d 1c 18 91 48 10 fe 01 33 9b 62 12 f8 1e 3e 9a e8 58 7a a0 7d a2 d9 33 c9 bc db>,
     absValidity: 2018-08-28T04:47:04.857Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 9a de bf 78 42 31 a1 d8>
switching to HANDSHAKE_1_SENT
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 04:47:07 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 9 19 0.47368421052631576 1535345228232
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 20 0.45 1535345282492
connected to auth! from local port 34646
received auth hello!
{ authId: 401, nonce: <Buffer a0 5a e3 21 33 d8 5c 71> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b1 e1 e3 59 cc 83 bb 5e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100446,
  cipherKeyVal: <Buffer 70 4f 61 a3 77 bd 60 7e 36 45 a3 d4 9c 88 de c2>,
  macKeyVal: <Buffer 80 8a cf ab aa c5 4e ec 1a 29 bf b5 20 86 3c be 59 d8 25 94 35 11 5b 5e 9c af 77 df 54 8d 7f d9>,
  absValidity: 2018-08-28T04:48:05.163Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40100446,
     cipherKeyVal: <Buffer 70 4f 61 a3 77 bd 60 7e 36 45 a3 d4 9c 88 de c2>,
     macKeyVal: <Buffer 80 8a cf ab aa c5 4e ec 1a 29 bf b5 20 86 3c be 59 d8 25 94 35 11 5b 5e 9c af 77 df 54 8d 7f d9>,
     absValidity: 2018-08-28T04:48:05.163Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 4b 53 81 fe 05 b1 05 f6>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 04:48:08 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 10 20 0.5 1535345289346
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 10 21 0.47619047619047616 1535345342545
connected to auth! from local port 34850
received auth hello!
{ authId: 401, nonce: <Buffer 97 7c 7c af fc fb d8 ac> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 20 6b a1 e4 ad 81 54 e3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100457,
  cipherKeyVal: <Buffer 21 97 0b 0f 2c be be e8 80 69 f6 ef 6d ab 77 71>,
  macKeyVal: <Buffer 2c 25 8b 7c ea 5a 68 cf 8a f7 b0 30 21 0e 58 91 26 ac 2b ec a8 70 a9 1f 3a d3 e4 d8 3c e0 eb b8>,
  absValidity: 2018-08-28T04:49:05.211Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40100457,
     cipherKeyVal: <Buffer 21 97 0b 0f 2c be be e8 80 69 f6 ef 6d ab 77 71>,
     macKeyVal: <Buffer 2c 25 8b 7c ea 5a 68 cf 8a f7 b0 30 21 0e 58 91 26 ac 2b ec a8 70 a9 1f 3a d3 e4 d8 3c e0 eb b8>,
     absValidity: 2018-08-28T04:49:05.211Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 6f 8d 93 f4 8f ef 84 e8>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 04:49:08 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 11 21 0.5238095238095238 1535345349296
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 11 22 0.5 1535345402582
connected to auth! from local port 35054
received auth hello!
{ authId: 401, nonce: <Buffer 45 4e 3c 8a 8c b9 d0 1b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b9 c3 d1 d3 4a fe 61 8e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100468,
  cipherKeyVal: <Buffer ed 34 32 8e 12 2a 6d f8 d2 ef 5a 64 d8 47 7e 4e>,
  macKeyVal: <Buffer 8a 69 9d 95 ff f1 bf a8 55 38 a7 56 f9 e0 16 65 69 7b 33 a4 27 d0 05 7b 3f ad 49 97 27 42 7b ce>,
  absValidity: 2018-08-28T04:50:05.283Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40100468,
     cipherKeyVal: <Buffer ed 34 32 8e 12 2a 6d f8 d2 ef 5a 64 d8 47 7e 4e>,
     macKeyVal: <Buffer 8a 69 9d 95 ff f1 bf a8 55 38 a7 56 f9 e0 16 65 69 7b 33 a4 27 d0 05 7b 3f ad 49 97 27 42 7b ce>,
     absValidity: 2018-08-28T04:50:05.283Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 78 1d d5 64 57 53 67 ce>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 04:50:08 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 12 22 0.5454545454545454 1535345409432
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 12 23 0.5217391304347826 1535345462588
connected to auth! from local port 35254
received auth hello!
{ authId: 401, nonce: <Buffer 76 35 2f 38 79 2e f2 a7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 41 63 b4 a6 b1 93 ea 6c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100479,
  cipherKeyVal: <Buffer fc ed 42 c7 d0 88 f8 88 b7 77 bc 46 05 f5 aa 53>,
  macKeyVal: <Buffer 4c 29 20 c4 2b e9 0f 4f ff 1a f8 cf 3c 32 b4 b8 07 47 16 13 4e d9 5b 38 8a e1 03 e2 f2 ef 26 41>,
  absValidity: 2018-08-28T04:51:05.290Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40100479,
     cipherKeyVal: <Buffer fc ed 42 c7 d0 88 f8 88 b7 77 bc 46 05 f5 aa 53>,
     macKeyVal: <Buffer 4c 29 20 c4 2b e9 0f 4f ff 1a f8 cf 3c 32 b4 b8 07 47 16 13 4e d9 5b 38 8a e1 03 e2 f2 ef 26 41>,
     absValidity: 2018-08-28T04:51:05.290Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 86 7e a4 c9 05 4d 04 14>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 04:51:08 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 13 23 0.5652173913043478 1535345469385
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 13 24 0.5416666666666666 1535345522642
connected to auth! from local port 35454
received auth hello!
{ authId: 401, nonce: <Buffer 67 e0 51 10 cb 35 39 7e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 60 69 1c 0a 5c 91 5b b4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100490,
  cipherKeyVal: <Buffer af 50 97 17 b1 db 5a f7 b7 97 a0 5a 84 4f 5a 3a>,
  macKeyVal: <Buffer 4a 84 ec 51 1a 68 2b 6d a8 55 1d b4 d6 96 48 23 27 2a c0 67 06 27 60 d7 be 54 2d ac 54 a9 17 8f>,
  absValidity: 2018-08-28T04:52:05.347Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40100490,
     cipherKeyVal: <Buffer af 50 97 17 b1 db 5a f7 b7 97 a0 5a 84 4f 5a 3a>,
     macKeyVal: <Buffer 4a 84 ec 51 1a 68 2b 6d a8 55 1d b4 d6 96 48 23 27 2a c0 67 06 27 60 d7 be 54 2d ac 54 a9 17 8f>,
     absValidity: 2018-08-28T04:52:05.347Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 5a 15 ac 4b 0c cb f1 12>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 04:52:08 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 14 24 0.5833333333333334 1535345529506
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 14 25 0.56 1535345582695
connected to auth! from local port 35654
received auth hello!
{ authId: 401, nonce: <Buffer 09 9a f7 6d 8f 3e 81 9c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 39 e0 b8 ca 2a e8 00 88>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100501,
  cipherKeyVal: <Buffer 26 62 3f 8e fd 8b 89 0f 21 65 ed ff 4e b7 e5 35>,
  macKeyVal: <Buffer 85 cc f2 f2 5f 49 40 a8 21 c0 93 64 59 69 5a 51 a5 15 61 56 1a ea 7c 2c 9e 4d d5 a1 14 a1 31 14>,
  absValidity: 2018-08-28T04:53:05.390Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40100501,
     cipherKeyVal: <Buffer 26 62 3f 8e fd 8b 89 0f 21 65 ed ff 4e b7 e5 35>,
     macKeyVal: <Buffer 85 cc f2 f2 5f 49 40 a8 21 c0 93 64 59 69 5a 51 a5 15 61 56 1a ea 7c 2c 9e 4d d5 a1 14 a1 31 14>,
     absValidity: 2018-08-28T04:53:05.390Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 47 27 3a 1a 94 b4 b7 7f>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 04:53:09 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 15 25 0.6 1535345589407
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 15 26 0.5769230769230769 1535345642749
connected to auth! from local port 35854
received auth hello!
{ authId: 401, nonce: <Buffer 7c 31 0b cd fc 86 11 b7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ca 14 4a 3d 89 fa 00 56>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100512,
  cipherKeyVal: <Buffer c3 90 5b 95 a6 74 cb 62 15 8f 40 57 f3 fc eb 31>,
  macKeyVal: <Buffer 7d 97 8d 77 df 2f 50 6a 50 85 d8 99 f0 78 d6 19 0f 8f a9 09 64 d9 6f d5 2e d4 99 d7 34 b4 80 cc>,
  absValidity: 2018-08-28T04:54:05.464Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40100512,
     cipherKeyVal: <Buffer c3 90 5b 95 a6 74 cb 62 15 8f 40 57 f3 fc eb 31>,
     macKeyVal: <Buffer 7d 97 8d 77 df 2f 50 6a 50 85 d8 99 f0 78 d6 19 0f 8f a9 09 64 d9 6f d5 2e d4 99 d7 34 b4 80 cc>,
     absValidity: 2018-08-28T04:54:05.464Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer c9 a9 f3 a8 ad ea 8e ad>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 04:54:09 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 16 26 0.6153846153846154 1535345649594
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 16 27 0.5925925925925926 1535345702800
connected to auth! from local port 36054
received auth hello!
{ authId: 401, nonce: <Buffer 1e 33 4f e6 b2 f4 54 d7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3f 30 ec 34 2f 93 8a da>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100523,
  cipherKeyVal: <Buffer 52 9b ba fb 85 6b 81 2b 83 f5 40 13 bf 5a b1 96>,
  macKeyVal: <Buffer d1 3f 70 9e b2 9f a4 33 dc 20 77 ba 86 50 8d 1e 5e 21 b9 a3 00 3a 4c ec d7 5f 3d de 2e d5 1d 32>,
  absValidity: 2018-08-28T04:55:05.266Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40100523,
     cipherKeyVal: <Buffer 52 9b ba fb 85 6b 81 2b 83 f5 40 13 bf 5a b1 96>,
     macKeyVal: <Buffer d1 3f 70 9e b2 9f a4 33 dc 20 77 ba 86 50 8d 1e 5e 21 b9 a3 00 3a 4c ec d7 5f 3d de 2e d5 1d 32>,
     absValidity: 2018-08-28T04:55:05.266Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer c3 02 b2 6b 8a 98 b1 fd>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 04:55:08 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 17 27 0.6296296296296297 1535345709251
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 17 28 0.6071428571428571 1535345762854
connected to auth! from local port 36254
received auth hello!
{ authId: 401, nonce: <Buffer 68 05 26 92 7d 16 71 75> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c7 9a 75 63 6e 0a fa c2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100534,
  cipherKeyVal: <Buffer 68 50 9f 0c b1 1b 4f 6b ee 68 a5 8f eb 97 25 a7>,
  macKeyVal: <Buffer 47 f5 60 52 e9 cb 59 d7 b9 3d 5d 6f a0 a0 98 64 54 a9 4d a4 ca a8 09 6a b6 91 97 d3 97 db 4a 2d>,
  absValidity: 2018-08-28T04:56:05.467Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40100534,
     cipherKeyVal: <Buffer 68 50 9f 0c b1 1b 4f 6b ee 68 a5 8f eb 97 25 a7>,
     macKeyVal: <Buffer 47 f5 60 52 e9 cb 59 d7 b9 3d 5d 6f a0 a0 98 64 54 a9 4d a4 ca a8 09 6a b6 91 97 d3 97 db 4a 2d>,
     absValidity: 2018-08-28T04:56:05.467Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer ea 7a a3 c7 7f de 93 48>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 04:56:09 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 18 28 0.6428571428571429 1535345769411
