changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c526.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c526',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 72 4b ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1535344264067
connected to auth! from local port 53374
received auth hello!
{ authId: 504, nonce: <Buffer 5f bf e2 c8 53 29 ed 99> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer d6 89 1f ea ed 7a e5 b2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer b7 d2 14 db 9b a1 17 1b 26 1c ac cc 97 6c 9a 17>,
  macKeyVal: <Buffer 37 8c d1 47 86 7e 3c f8 ea 5b 74 61 80 11 16 9d 27 fe 1f fd ba c3 95 b6 0d 80 fc c7 58 cc b3 58>,
  absValidity: 2018-08-27T05:31:07.305Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400045,
  cipherKeyVal: <Buffer c2 1c 90 b1 85 d2 d0 ad b3 f3 16 18 d3 51 4a 17>,
  macKeyVal: <Buffer 29 ae 42 d7 1b 5a fa 74 a0 52 13 08 e3 04 28 c2 c1 ed 99 92 d8 4d ac 50 90 2e b0 27 b5 15 85 9a>,
  absValidity: 2018-08-28T04:31:07.305Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50400045,
     cipherKeyVal: <Buffer c2 1c 90 b1 85 d2 d0 ad b3 f3 16 18 d3 51 4a 17>,
     macKeyVal: <Buffer 29 ae 42 d7 1b 5a fa 74 a0 52 13 08 e3 04 28 c2 c1 ed 99 92 d8 4d ac 50 90 2e b0 27 b5 15 85 9a>,
     absValidity: 2018-08-28T04:31:07.305Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 94 0d 3a 4a 15 3f d0 ef>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 04:31:10 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1535344270725
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1535344324121
connected to auth! from local port 53644
received auth hello!
{ authId: 504, nonce: <Buffer 04 1a 5e f3 43 33 7c 3d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d5 96 72 86 8b 4a fc 7f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400051,
  cipherKeyVal: <Buffer 0b 45 03 4a 05 9a b3 96 c6 ad 74 da c3 cc eb 19>,
  macKeyVal: <Buffer fb 1a f2 9b 78 82 d5 03 c0 d2 f7 87 5d d2 ff e5 76 09 75 86 dc f5 9d ce a3 27 62 da a1 b0 4d a3>,
  absValidity: 2018-08-28T04:32:07.069Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50400051,
     cipherKeyVal: <Buffer 0b 45 03 4a 05 9a b3 96 c6 ad 74 da c3 cc eb 19>,
     macKeyVal: <Buffer fb 1a f2 9b 78 82 d5 03 c0 d2 f7 87 5d d2 ff e5 76 09 75 86 dc f5 9d ce a3 27 62 da a1 b0 4d a3>,
     absValidity: 2018-08-28T04:32:07.069Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 5b cf 7f 9d 21 8d 65 7f>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 04:32:10 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1535344330600
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1535344384165
connected to auth! from local port 53914
received auth hello!
{ authId: 504, nonce: <Buffer 03 49 49 bd bf 82 34 74> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9b ed 8c ef b3 cb fe 88>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400057,
  cipherKeyVal: <Buffer 0b 83 2b 64 87 03 72 2d d3 c2 f9 9e a3 86 51 a8>,
  macKeyVal: <Buffer 77 48 3a 04 f3 79 58 29 cb ea 36 99 cf 1d 49 be f6 77 57 30 37 51 87 6d 9a 1f 12 cb 08 d9 41 99>,
  absValidity: 2018-08-28T04:33:07.663Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50400057,
     cipherKeyVal: <Buffer 0b 83 2b 64 87 03 72 2d d3 c2 f9 9e a3 86 51 a8>,
     macKeyVal: <Buffer 77 48 3a 04 f3 79 58 29 cb ea 36 99 cf 1d 49 be f6 77 57 30 37 51 87 6d 9a 1f 12 cb 08 d9 41 99>,
     absValidity: 2018-08-28T04:33:07.663Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer cd fc 24 52 94 ea de c8>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 04:33:10 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1535344390639
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1535344444214
connected to auth! from local port 54184
received auth hello!
{ authId: 504, nonce: <Buffer 65 90 03 f0 3c 00 62 06> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 63 ef 9e 83 dd 77 59 cf>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400063,
  cipherKeyVal: <Buffer 10 6a d0 1d 0d 7f 84 52 05 86 69 0a cb 47 71 ab>,
  macKeyVal: <Buffer 38 21 a4 0c 3a 4f f9 3f e9 fd 07 f3 da fd be 4b bb 83 15 9f db 53 30 44 df 74 7c 15 29 78 4c c8>,
  absValidity: 2018-08-28T04:34:07.691Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50400063,
     cipherKeyVal: <Buffer 10 6a d0 1d 0d 7f 84 52 05 86 69 0a cb 47 71 ab>,
     macKeyVal: <Buffer 38 21 a4 0c 3a 4f f9 3f e9 fd 07 f3 da fd be 4b bb 83 15 9f db 53 30 44 df 74 7c 15 29 78 4c c8>,
     absValidity: 2018-08-28T04:34:07.691Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 7f 0d 37 e3 35 54 c4 27>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 04:34:10 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1535344450733
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1535344504268
connected to auth! from local port 54454
received auth hello!
{ authId: 504, nonce: <Buffer ef 68 0f bb e2 01 57 ab> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ba a0 f0 5d cd a1 21 9d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400069,
  cipherKeyVal: <Buffer 0b 87 ec 2b 23 08 0c e2 32 64 a1 21 79 60 bc 89>,
  macKeyVal: <Buffer 47 92 af 50 2f 7c 0e af 2b e4 6b 56 fc 07 af 17 29 d3 f5 c4 8f 21 1d 8a 70 c2 29 3d af ab b9 54>,
  absValidity: 2018-08-28T04:35:07.752Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50400069,
     cipherKeyVal: <Buffer 0b 87 ec 2b 23 08 0c e2 32 64 a1 21 79 60 bc 89>,
     macKeyVal: <Buffer 47 92 af 50 2f 7c 0e af 2b e4 6b 56 fc 07 af 17 29 d3 f5 c4 8f 21 1d 8a 70 c2 29 3d af ab b9 54>,
     absValidity: 2018-08-28T04:35:07.752Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 8f a9 12 47 74 00 b1 75>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 04:35:10 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1535344510786
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1535344564321
connected to auth! from local port 54724
Handler: Error in secure comm - details: Disconnected from auth before getting session key response
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 7 0.7142857142857143 1535344624331
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 8 0.625 1535344684342
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 44768
received auth hello!
{ authId: 503, nonce: <Buffer 49 53 44 8b bd 32 c0 12> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 9 0.5555555555555556 1535344744352
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 44996
received auth hello!
{ authId: 503, nonce: <Buffer 05 31 04 85 4b 5b ba c4> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 10 0.5 1535344804362
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 51200
received auth hello!
{ authId: 403, nonce: <Buffer 11 4d bf b8 ac 66 2a 29> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 11 0.45454545454545453 1535344864370
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 51436
received auth hello!
{ authId: 403, nonce: <Buffer 91 c8 be ec 95 ab c9 bc> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 12 0.4166666666666667 1535344924380
failure in connection with Auth : authFailureCount: 6
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 58784
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 13 0.38461538461538464 1535344984387
failure in connection with Auth : authFailureCount: 7
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 59042
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 14 0.35714285714285715 1535345044394
failure in connection with Auth : authFailureCount: 8
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 2
to: 3
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 15 0.3333333333333333 1535345104401
failure in connection with Auth : authFailureCount: 9
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 3
to: 4
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 16 0.3125 1535345164408
/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902
            eventHandlers.onError('Error occurred in migration request: Disconnected from auth before getting migration response: ' + error);
                                                                                                                                      ^

ReferenceError: error is not defined
    at Socket.<anonymous> (/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902:135)
    at emitNone (events.js:91:20)
    at Socket.emit (events.js:188:7)
    at endReadableNT (_stream_readable.js:975:12)
    at _combinedTickCallback (internal/process/next_tick.js:80:11)
    at process._tickCallback (internal/process/next_tick.js:104:9)
