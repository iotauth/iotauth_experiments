changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c507.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c507',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 34 41 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1535344200901
connected to auth! from local port 56380
received auth hello!
{ authId: 501, nonce: <Buffer 2e 60 a8 93 82 21 dd 65> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 81 57 86 5e 4c 8f 8e 71>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 68 5a 95 be 83 a3 ca bd 8d 65 96 39 a4 ea 31 f4>,
  macKeyVal: <Buffer 98 3a f6 af 7b 26 8f 8f c0 08 7f c2 a5 0e 18 7d 07 33 19 c7 86 1b 7c 82 5b 16 c7 e3 4a b1 fd 3b>,
  absValidity: 2018-08-27T05:30:01.047Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100060,
  cipherKeyVal: <Buffer c4 fc b7 1a 79 5f 5a 28 cf 8d 2f bb 3f d5 d6 42>,
  macKeyVal: <Buffer 83 07 a2 f7 0d 3f 31 85 88 ad 54 12 25 40 c2 e1 17 e2 17 3b 34 36 7c 74 b9 16 4a 6f 70 80 4e 65>,
  absValidity: 2018-08-28T04:30:01.047Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100060,
     cipherKeyVal: <Buffer c4 fc b7 1a 79 5f 5a 28 cf 8d 2f bb 3f d5 d6 42>,
     macKeyVal: <Buffer 83 07 a2 f7 0d 3f 31 85 88 ad 54 12 25 40 c2 e1 17 e2 17 3b 34 36 7c 74 b9 16 4a 6f 70 80 4e 65>,
     absValidity: 2018-08-28T04:30:01.047Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 32 79 d6 9b 17 ec 1c f4>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 04:30:01 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1535344201911
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1535344260960
connected to auth! from local port 56640
received auth hello!
{ authId: 501, nonce: <Buffer e8 d3 57 00 e6 ce 1c 1c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 64 84 9b ce 29 6d 2f 47>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100068,
  cipherKeyVal: <Buffer 54 18 ed d9 db 73 d5 aa 93 20 51 95 05 c7 92 3f>,
  macKeyVal: <Buffer 53 0d 41 0c ae dc 87 17 3a ef c0 01 49 89 6b ef e7 ee d2 e8 96 1e 9c a2 4d c8 29 d0 cd 7c 78 98>,
  absValidity: 2018-08-28T04:31:01.126Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100068,
     cipherKeyVal: <Buffer 54 18 ed d9 db 73 d5 aa 93 20 51 95 05 c7 92 3f>,
     macKeyVal: <Buffer 53 0d 41 0c ae dc 87 17 3a ef c0 01 49 89 6b ef e7 ee d2 e8 96 1e 9c a2 4d c8 29 d0 cd 7c 78 98>,
     absValidity: 2018-08-28T04:31:01.126Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer f6 f5 c8 75 7f 0a d1 8b>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 04:31:01 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1535344261949
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1535344321020
connected to auth! from local port 56910
received auth hello!
{ authId: 501, nonce: <Buffer f7 d6 ee c2 34 1f 9f 54> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2b a5 09 bf a9 dc 12 04>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100076,
  cipherKeyVal: <Buffer 77 e0 f1 87 f0 f2 33 15 ff 2c fc 95 48 32 14 33>,
  macKeyVal: <Buffer 67 8a e6 37 3b ea 76 bd ac 43 6d 7c a2 13 9b cb 25 a9 b9 31 d5 95 60 07 44 0c 11 29 39 a9 57 90>,
  absValidity: 2018-08-28T04:32:01.186Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100076,
     cipherKeyVal: <Buffer 77 e0 f1 87 f0 f2 33 15 ff 2c fc 95 48 32 14 33>,
     macKeyVal: <Buffer 67 8a e6 37 3b ea 76 bd ac 43 6d 7c a2 13 9b cb 25 a9 b9 31 d5 95 60 07 44 0c 11 29 39 a9 57 90>,
     absValidity: 2018-08-28T04:32:01.186Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer ae f2 58 b6 6f 4f 89 6b>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 04:32:01 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1535344322110
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1535344381076
connected to auth! from local port 57180
received auth hello!
{ authId: 501, nonce: <Buffer 25 db ba 5f 6c 00 ef 3d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 22 44 f8 aa 76 5f ed 7c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100084,
  cipherKeyVal: <Buffer da 5b 67 cd aa b7 94 dc 7f c7 a9 dc e4 fd 0a 00>,
  macKeyVal: <Buffer 6a c1 ba 57 ae eb 76 9d 31 0e 4e 1a d6 de c4 7a 4b d7 c2 ad d3 f0 8c 8d 30 dc 6d d2 f0 84 ae 99>,
  absValidity: 2018-08-28T04:33:01.242Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100084,
     cipherKeyVal: <Buffer da 5b 67 cd aa b7 94 dc 7f c7 a9 dc e4 fd 0a 00>,
     macKeyVal: <Buffer 6a c1 ba 57 ae eb 76 9d 31 0e 4e 1a d6 de c4 7a 4b d7 c2 ad d3 f0 8c 8d 30 dc 6d d2 f0 84 ae 99>,
     absValidity: 2018-08-28T04:33:01.242Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer fe d3 5b 3c 01 b4 59 fe>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 04:33:01 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1535344382172
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1535344441127
connected to auth! from local port 57450
received auth hello!
{ authId: 501, nonce: <Buffer c0 cd 29 58 3b 66 38 e8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 41 6d 4e 50 59 e4 d0 99>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100092,
  cipherKeyVal: <Buffer 76 bf 17 2f ae 5d 3f 67 21 3e e2 c1 5a 48 d1 5c>,
  macKeyVal: <Buffer 5f 7d 39 99 91 5e 12 a8 f0 f1 c0 7e 98 21 73 66 49 35 ae 9b 5b 48 6a d8 f0 70 7a 3f 50 70 49 50>,
  absValidity: 2018-08-28T04:34:01.252Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100092,
     cipherKeyVal: <Buffer 76 bf 17 2f ae 5d 3f 67 21 3e e2 c1 5a 48 d1 5c>,
     macKeyVal: <Buffer 5f 7d 39 99 91 5e 12 a8 f0 f1 c0 7e 98 21 73 66 49 35 ae 9b 5b 48 6a d8 f0 70 7a 3f 50 70 49 50>,
     absValidity: 2018-08-28T04:34:01.252Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 07 67 b5 5a 78 be a5 8a>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 04:34:01 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1535344442076
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1535344501184
connected to auth! from local port 57720
received auth hello!
{ authId: 501, nonce: <Buffer 00 e5 91 9f b9 4f fb bf> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8a df f9 56 ab f9 1f 67>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100100,
  cipherKeyVal: <Buffer 79 96 93 f8 0b 73 6c 7d 4c ff 47 a1 09 e4 32 86>,
  macKeyVal: <Buffer 0e 88 63 17 f9 cc 66 df bb 1c b4 c5 00 82 57 ce 6f f4 06 44 99 6d 1b b4 87 eb d1 be d1 f6 6b 2c>,
  absValidity: 2018-08-28T04:35:01.338Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100100,
     cipherKeyVal: <Buffer 79 96 93 f8 0b 73 6c 7d 4c ff 47 a1 09 e4 32 86>,
     macKeyVal: <Buffer 0e 88 63 17 f9 cc 66 df bb 1c b4 c5 00 82 57 ce 6f f4 06 44 99 6d 1b b4 87 eb d1 be d1 f6 6b 2c>,
     absValidity: 2018-08-28T04:35:01.338Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 1d bf 7b c2 f1 b9 a1 64>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 04:35:01 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1535344502277
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1535344561217
connected to auth! from local port 57990
received auth hello!
{ authId: 501, nonce: <Buffer ee 45 71 fa 33 7f 79 54> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4f 63 21 ef 40 72 6f 1a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100108,
  cipherKeyVal: <Buffer 5d a3 37 5f 8b 0f f2 20 d0 ac bf 5c c0 a2 a8 c7>,
  macKeyVal: <Buffer 7d ea 4f 30 af e8 34 67 94 a1 21 a6 1d e9 22 24 42 07 70 0e 90 08 c0 c6 db ea 89 b8 8a 25 34 a6>,
  absValidity: 2018-08-28T04:36:01.376Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100108,
     cipherKeyVal: <Buffer 5d a3 37 5f 8b 0f f2 20 d0 ac bf 5c c0 a2 a8 c7>,
     macKeyVal: <Buffer 7d ea 4f 30 af e8 34 67 94 a1 21 a6 1d e9 22 24 42 07 70 0e 90 08 c0 c6 db ea 89 b8 8a 25 34 a6>,
     absValidity: 2018-08-28T04:36:01.376Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer c3 e5 75 ae 67 a6 53 76>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 04:36:01 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1535344562245
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1535344621262
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 9 0.7777777777777778 1535344681273
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 50048
received auth hello!
{ authId: 401, nonce: <Buffer e4 67 5b 4b dc fe a3 a3> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 10 0.7 1535344741284
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 50270
received auth hello!
{ authId: 401, nonce: <Buffer cf 24 a6 27 6e a5 b3 fa> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 11 0.6363636363636364 1535344801294
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 12 0.5833333333333334 1535344861300
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 55192
received auth hello!
{ authId: 502, nonce: <Buffer fb d5 8c b4 f8 0a a3 31> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '016579A30A2F',
  notBefore: 2018-08-27T04:25:52.000Z,
  notAfter: 2018-08-28T04:27:32.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '33:51:DA:47:DD:99:6A:B3:5B:22:4E:07:B8:2F:40:3E:8A:A1:DF:0E',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'B138D36BE53FEF7A4EAFB969AC06E51234F04819636E9BD1C18A274EF509C20F60425ECB70D73DBE38728E4C8AE5C9A51F6B212017E83DB7265ADE4EB91743FF00E6384C91216C08E24F877D4756852A1A006533657C2AD970B6694EAA6074DD788860A9BBCCF0D830F5A7FED589C63785576A172E75E8EA5C2AFC1B8563D3B27BB7450A9659E288F607AA1643255BB6082A7AF57221C9DB5DDE2AFA6C5D86E13162450B4905BD4511BE1D82F1A3D32974AE25E6317777B2B45BA251A2511FFC8EF6FAE19E1CFC5BEEC19ADFE72E99C553F36401DCCA304F5C309892EE68C67986CBBFB67CEC5666ADDA8CD6487848CF2EDC5C68B7924C91D54BBEC322B2C309',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWV5owovMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDgy\nNzA0MjU1MloXDTE4MDgyODA0MjczMlowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQCxONNr5T/vek6vuWmsBuUSNPBIGWNum9HBiidO9QnCD2BCXstw\n1z2+OHKOTIrlyaUfayEgF+g9tyZa3k65F0P/AOY4TJEhbAjiT4d9R1aFKhoAZTNl\nfCrZcLZpTqpgdN14iGCpu8zw2DD1p/7VicY3hVdqFy516OpcKvwbhWPTsnu3RQqW\nWeKI9geqFkMlW7YIKnr1ciHJ213eKvpsXYbhMWJFC0kFvUURvh2C8aPTKXSuJeYx\nd3eytFuiUaJRH/yO9vrhnhz8W+7Bmt/nLpnFU/NkAdzKME9cMJiS7mjGeYbLv7Z8\n7FZmrdqM1kh4SM8u3Fxot5JMkdVLvsMissMJAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAG/nd26Nl8Rqyu/kvPaeeYPxmlno08ZD\nTxk0bODd0lbipQ79XMiN30hKPS3S0tP3KIIGxk7s4TSsYpskvSKU1RPCNgs7f0X/\nCSd0zcLiFlepnnaEEoNCSPhK1CyfRLu4fGxxx7+PLSLiuZkts65JOJRp9fgcdZ4Y\nwr5q7I/RDBHTlYPOdl2BCoDpe4tYwHg6FP6yzy06yf31WsTQXOJTP1rEccTBNjB2\nJI8MC1+Oy7+xxggC3lFV7M0/ESgJI+6L1bVacW7yToijbB9Gk8YTi3xnTQTYZBAo\nj0Zxc/94PXCTDu8aChhb5ZtyWwffMjbSSbU24BefKgeDneU5ZS1CuyY=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 2
to: 3
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 13 0.5384615384615384 1535344921310
connected to auth! from local port 55426
received auth hello!
{ authId: 502, nonce: <Buffer 8f d7 cc b5 9d dc 02 b5> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 20 72 fb 0d b3 62 b5 0a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 20 88 3d f9 51 c8 a6 58 9e e8 d7 cb 39 e5 e5 20>,
  macKeyVal: <Buffer 93 20 a8 8d 6b 36 0b 29 7b 46 f9 19 34 8d 07 df 15 be 95 28 8f 59 ca 31 96 26 0b 45 08 7d 48 4d>,
  absValidity: 2018-08-27T05:42:01.490Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200410,
  cipherKeyVal: <Buffer 8c 49 78 b7 61 ed 1f 2d c8 84 3b a4 80 91 4a 0b>,
  macKeyVal: <Buffer 66 44 c1 98 a8 27 8b 28 cb 71 28 11 85 11 90 8c 43 17 f0 88 30 d0 c4 78 0f d2 9e a7 86 57 51 e6>,
  absValidity: 2018-08-28T04:42:01.490Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200410,
     cipherKeyVal: <Buffer 8c 49 78 b7 61 ed 1f 2d c8 84 3b a4 80 91 4a 0b>,
     macKeyVal: <Buffer 66 44 c1 98 a8 27 8b 28 cb 71 28 11 85 11 90 8c 43 17 f0 88 30 d0 c4 78 0f d2 9e a7 86 57 51 e6>,
     absValidity: 2018-08-28T04:42:01.490Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 7a c9 20 05 cc 45 6e 82>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.28:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 14 0.5 1535344981320
connected to auth! from local port 55686
received auth hello!
{ authId: 502, nonce: <Buffer c0 15 f0 69 43 06 e0 00> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c8 4a 6c 95 a9 9e 71 3d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200425,
  cipherKeyVal: <Buffer d8 0f b3 b0 2d 10 d7 0e 75 45 d4 17 7e 99 ee a1>,
  macKeyVal: <Buffer 2b 1d 5c 1e de 58 b0 88 b3 b7 ee a7 16 a1 80 7d fa 9b 18 cd 29 ea 5b 6b 4e 6d 3b 3c 8d 61 f9 d5>,
  absValidity: 2018-08-28T04:43:01.585Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200425,
     cipherKeyVal: <Buffer d8 0f b3 b0 2d 10 d7 0e 75 45 d4 17 7e 99 ee a1>,
     macKeyVal: <Buffer 2b 1d 5c 1e de 58 b0 88 b3 b7 ee a7 16 a1 80 7d fa 9b 18 cd 29 ea 5b 6b 4e 6d 3b 3c 8d 61 f9 d5>,
     absValidity: 2018-08-28T04:43:01.585Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 22 d3 48 2c 5a aa 76 62>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.28:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 15 0.4666666666666667 1535345041323
connected to auth! from local port 55936
received auth hello!
{ authId: 502, nonce: <Buffer 23 b7 6a 1f 69 e6 e1 f6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer df 96 b2 60 ab c5 fd 35>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200440,
  cipherKeyVal: <Buffer 83 2a f8 0c 25 d4 a9 47 2c 56 ac a3 e0 f9 c1 6d>,
  macKeyVal: <Buffer 8a 8c f6 09 a2 a1 f2 30 19 88 27 d7 8e 49 d3 1d 54 90 ea 29 ac b5 48 91 0e 92 33 d2 b7 25 af 4d>,
  absValidity: 2018-08-28T04:44:01.467Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200440,
     cipherKeyVal: <Buffer 83 2a f8 0c 25 d4 a9 47 2c 56 ac a3 e0 f9 c1 6d>,
     macKeyVal: <Buffer 8a 8c f6 09 a2 a1 f2 30 19 88 27 d7 8e 49 d3 1d 54 90 ea 29 ac b5 48 91 0e 92 33 d2 b7 25 af 4d>,
     absValidity: 2018-08-28T04:44:01.467Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer c2 69 9a 2c 66 7f d6 42>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.28:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 16 0.4375 1535345101333
connected to auth! from local port 56200
received auth hello!
{ authId: 502, nonce: <Buffer 85 a8 bb 65 4e 25 9a 51> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 60 7c d4 7e bd 38 b6 51>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200455,
  cipherKeyVal: <Buffer bd 41 ea a7 32 7f 16 9a 11 7d 91 56 13 3f 2c 2b>,
  macKeyVal: <Buffer 87 0e 76 41 ea e1 a9 5b f5 60 a5 16 ea 10 e1 af 53 88 ef 0e de f0 3a e0 d7 5d b6 17 b2 f2 78 d1>,
  absValidity: 2018-08-28T04:45:01.560Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200455,
     cipherKeyVal: <Buffer bd 41 ea a7 32 7f 16 9a 11 7d 91 56 13 3f 2c 2b>,
     macKeyVal: <Buffer 87 0e 76 41 ea e1 a9 5b f5 60 a5 16 ea 10 e1 af 53 88 ef 0e de f0 3a e0 d7 5d b6 17 b2 f2 78 d1>,
     absValidity: 2018-08-28T04:45:01.560Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 3a cc 4e 1b ee cc 0b 7a>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.28:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 17 0.4117647058823529 1535345161343
connected to auth! from local port 56474
received auth hello!
{ authId: 502, nonce: <Buffer 34 50 1a 88 27 70 3f df> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1b ae 39 55 56 d0 e8 0e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200470,
  cipherKeyVal: <Buffer 5a 43 12 71 26 09 b1 fc 22 ff c6 d4 43 47 7a 09>,
  macKeyVal: <Buffer 0a 13 a2 40 42 f7 fd 83 af 1e bc 34 5a 24 ec 22 da 43 2e 9e 6d 31 c1 a5 6c 83 28 be bb 56 fc 70>,
  absValidity: 2018-08-28T04:46:03.789Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200470,
     cipherKeyVal: <Buffer 5a 43 12 71 26 09 b1 fc 22 ff c6 d4 43 47 7a 09>,
     macKeyVal: <Buffer 0a 13 a2 40 42 f7 fd 83 af 1e bc 34 5a 24 ec 22 da 43 2e 9e 6d 31 c1 a5 6c 83 28 be bb 56 fc 70>,
     absValidity: 2018-08-28T04:46:03.789Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 17 bc 46 70 8a 68 71 a0>
switching to HANDSHAKE_1_SENT
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 04:46:07 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 17 0.47058823529411764 1535345167907
Handler: secure connection with the server closed.
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 18 0.4444444444444444 1535345221392
connected to auth! from local port 56700
received auth hello!
{ authId: 502, nonce: <Buffer bd d3 49 7e b4 e7 89 b4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 19 c7 97 50 b7 62 de 77>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200484,
  cipherKeyVal: <Buffer 7a 1a 32 bb 84 05 0d 37 c7 52 93 4f 02 48 bd 59>,
  macKeyVal: <Buffer 13 8e 61 98 98 27 80 b1 1f 1c 41 b0 b7 6a 1c 1a b9 32 57 51 82 e2 2c ac 54 7a 40 32 95 21 f6 64>,
  absValidity: 2018-08-28T04:47:01.522Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200484,
     cipherKeyVal: <Buffer 7a 1a 32 bb 84 05 0d 37 c7 52 93 4f 02 48 bd 59>,
     macKeyVal: <Buffer 13 8e 61 98 98 27 80 b1 1f 1c 41 b0 b7 6a 1c 1a b9 32 57 51 82 e2 2c ac 54 7a 40 32 95 21 f6 64>,
     absValidity: 2018-08-28T04:47:01.522Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 19 0.42105263157894735 1535345281411
connected to auth! from local port 56906
received auth hello!
{ authId: 502, nonce: <Buffer 43 36 39 d0 cb e5 3e 0f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1e 8d df 08 0e 65 a9 39>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200498,
  cipherKeyVal: <Buffer 28 ba b5 4b 5e 65 5f 53 80 88 54 98 75 61 78 3c>,
  macKeyVal: <Buffer 81 a3 27 94 36 16 f5 65 46 2f 00 0a e8 21 1f e7 31 d8 e4 02 55 fe bc f9 e8 4f f0 6f 32 1f c8 6d>,
  absValidity: 2018-08-28T04:48:01.560Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200498,
     cipherKeyVal: <Buffer 28 ba b5 4b 5e 65 5f 53 80 88 54 98 75 61 78 3c>,
     macKeyVal: <Buffer 81 a3 27 94 36 16 f5 65 46 2f 00 0a e8 21 1f e7 31 d8 e4 02 55 fe bc f9 e8 4f f0 6f 32 1f c8 6d>,
     absValidity: 2018-08-28T04:48:01.560Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 20 0.4 1535345341458
connected to auth! from local port 57110
received auth hello!
{ authId: 502, nonce: <Buffer e8 37 8a 64 d0 b0 34 b1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0f 3d 54 1c f9 f1 b0 c2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200512,
  cipherKeyVal: <Buffer 19 d1 3a 32 50 77 f5 91 c0 7d b4 f3 b5 48 60 73>,
  macKeyVal: <Buffer 09 3a 26 0c bb 71 64 ee c4 18 f1 93 9a 0f 76 b0 ac 61 71 d8 55 80 ca 70 a2 23 b4 76 89 6e 4a b3>,
  absValidity: 2018-08-28T04:49:01.595Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200512,
     cipherKeyVal: <Buffer 19 d1 3a 32 50 77 f5 91 c0 7d b4 f3 b5 48 60 73>,
     macKeyVal: <Buffer 09 3a 26 0c bb 71 64 ee c4 18 f1 93 9a 0f 76 b0 ac 61 71 d8 55 80 ca 70 a2 23 b4 76 89 6e 4a b3>,
     absValidity: 2018-08-28T04:49:01.595Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 21 0.38095238095238093 1535345401510
connected to auth! from local port 57314
received auth hello!
{ authId: 502, nonce: <Buffer ea 94 42 ba 79 4b 1a 83> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fb 63 23 c9 d2 43 2e e3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200526,
  cipherKeyVal: <Buffer be 6e b2 a8 16 e4 e0 df 57 ed cb dc 02 14 1a 8a>,
  macKeyVal: <Buffer 4b 54 a6 b0 29 9e 46 5a 6b a6 ee 49 49 f1 01 08 4a 26 52 5d 6a 6f 19 c0 19 bd fd a2 59 1f 3d 51>,
  absValidity: 2018-08-28T04:50:01.664Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200526,
     cipherKeyVal: <Buffer be 6e b2 a8 16 e4 e0 df 57 ed cb dc 02 14 1a 8a>,
     macKeyVal: <Buffer 4b 54 a6 b0 29 9e 46 5a 6b a6 ee 49 49 f1 01 08 4a 26 52 5d 6a 6f 19 c0 19 bd fd a2 59 1f 3d 51>,
     absValidity: 2018-08-28T04:50:01.664Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 22 0.36363636363636365 1535345461568
connected to auth! from local port 57514
received auth hello!
{ authId: 502, nonce: <Buffer ce 09 fd 5a da 93 0d b8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer dc 10 e7 ad 2a b3 79 c3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200540,
  cipherKeyVal: <Buffer 4f 5e 83 77 be 11 be 53 35 8a d0 71 32 d2 72 34>,
  macKeyVal: <Buffer 9a 29 50 86 48 66 8c ae e7 b8 e1 b5 65 a9 ab 96 4e 20 cc af 50 49 1f a0 77 34 ba 0f 22 62 44 2b>,
  absValidity: 2018-08-28T04:51:01.705Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200540,
     cipherKeyVal: <Buffer 4f 5e 83 77 be 11 be 53 35 8a d0 71 32 d2 72 34>,
     macKeyVal: <Buffer 9a 29 50 86 48 66 8c ae e7 b8 e1 b5 65 a9 ab 96 4e 20 cc af 50 49 1f a0 77 34 ba 0f 22 62 44 2b>,
     absValidity: 2018-08-28T04:51:01.705Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 23 0.34782608695652173 1535345521615
connected to auth! from local port 57714
received auth hello!
{ authId: 502, nonce: <Buffer fc c2 e4 d0 4e 45 2e 44> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 70 08 7e f6 41 af a5 1a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200554,
  cipherKeyVal: <Buffer 23 31 a3 a9 6b f6 9e 2c d2 0f db 69 8d 76 dc 23>,
  macKeyVal: <Buffer 20 cc 96 bd a0 55 29 9b 49 c1 c8 1b 4b a6 40 a5 04 33 a8 ec c8 7a 77 5f c9 ad 85 e0 b4 ab c5 66>,
  absValidity: 2018-08-28T04:52:01.791Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200554,
     cipherKeyVal: <Buffer 23 31 a3 a9 6b f6 9e 2c d2 0f db 69 8d 76 dc 23>,
     macKeyVal: <Buffer 20 cc 96 bd a0 55 29 9b 49 c1 c8 1b 4b a6 40 a5 04 33 a8 ec c8 7a 77 5f c9 ad 85 e0 b4 ab c5 66>,
     absValidity: 2018-08-28T04:52:01.791Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 24 0.3333333333333333 1535345581638
connected to auth! from local port 57914
received auth hello!
{ authId: 502, nonce: <Buffer 2a d8 95 e8 58 36 98 42> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 20 64 d3 09 71 0d fb b1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200568,
  cipherKeyVal: <Buffer 69 89 7c 67 88 3f 8c aa a3 9a 94 72 fa 88 e1 56>,
  macKeyVal: <Buffer cc 86 2e d1 15 1a 34 1b 42 f3 74 7d ae f2 06 db a4 a5 0f df c3 c0 88 68 f6 cc e8 22 e6 5f c3 a5>,
  absValidity: 2018-08-28T04:53:01.772Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200568,
     cipherKeyVal: <Buffer 69 89 7c 67 88 3f 8c aa a3 9a 94 72 fa 88 e1 56>,
     macKeyVal: <Buffer cc 86 2e d1 15 1a 34 1b 42 f3 74 7d ae f2 06 db a4 a5 0f df c3 c0 88 68 f6 cc e8 22 e6 5f c3 a5>,
     absValidity: 2018-08-28T04:53:01.772Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 25 0.32 1535345641678
connected to auth! from local port 58114
received auth hello!
{ authId: 502, nonce: <Buffer ab 3e b1 97 9c 4a 8a e3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d8 da 2b 51 61 f0 d2 80>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200582,
  cipherKeyVal: <Buffer 0f 03 07 6c ed 66 09 bb be 06 2d 05 ce 47 ef ec>,
  macKeyVal: <Buffer 37 da d5 3a 0f 26 af f9 8f 33 97 4d 39 37 61 03 d5 9a 16 3d 5f e3 24 bc db c2 7f 37 14 c2 0d ea>,
  absValidity: 2018-08-28T04:54:01.826Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200582,
     cipherKeyVal: <Buffer 0f 03 07 6c ed 66 09 bb be 06 2d 05 ce 47 ef ec>,
     macKeyVal: <Buffer 37 da d5 3a 0f 26 af f9 8f 33 97 4d 39 37 61 03 d5 9a 16 3d 5f e3 24 bc db c2 7f 37 14 c2 0d ea>,
     absValidity: 2018-08-28T04:54:01.826Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 26 0.3076923076923077 1535345701738
connected to auth! from local port 58314
received auth hello!
{ authId: 502, nonce: <Buffer f5 56 6b 76 88 03 f1 65> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a2 40 27 26 35 04 f6 cb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200596,
  cipherKeyVal: <Buffer a1 56 13 c8 a4 79 9e 94 e4 71 32 5c 36 a7 e0 a0>,
  macKeyVal: <Buffer d4 c4 28 53 a0 97 40 ef da dd 9a fc 0a 4c 7b 12 1e b1 4f 47 0e bc 37 83 d6 38 04 92 c1 ba 28 2d>,
  absValidity: 2018-08-28T04:55:01.870Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200596,
     cipherKeyVal: <Buffer a1 56 13 c8 a4 79 9e 94 e4 71 32 5c 36 a7 e0 a0>,
     macKeyVal: <Buffer d4 c4 28 53 a0 97 40 ef da dd 9a fc 0a 4c 7b 12 1e b1 4f 47 0e bc 37 83 d6 38 04 92 c1 ba 28 2d>,
     absValidity: 2018-08-28T04:55:01.870Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 27 0.2962962962962963 1535345761798
connected to auth! from local port 58514
received auth hello!
{ authId: 502, nonce: <Buffer 80 cb 2a 52 d1 d5 b9 72> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 03 5e a3 25 94 a1 4a c9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200610,
  cipherKeyVal: <Buffer e8 c9 ee a5 02 87 9a 10 f6 9c 30 27 b5 74 a2 d1>,
  macKeyVal: <Buffer df 06 81 74 ed 7a 1a 32 bd dc 71 76 fe 80 cc 58 a4 26 c2 92 a4 f9 00 27 6a cc 2a 10 18 79 ba 4b>,
  absValidity: 2018-08-28T04:56:01.944Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200610,
     cipherKeyVal: <Buffer e8 c9 ee a5 02 87 9a 10 f6 9c 30 27 b5 74 a2 d1>,
     macKeyVal: <Buffer df 06 81 74 ed 7a 1a 32 bd dc 71 76 fe 80 cc 58 a4 26 c2 92 a4 f9 00 27 6a cc 2a 10 18 79 ba 4b>,
     absValidity: 2018-08-28T04:56:01.944Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
