changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s415.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's415',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 76 65 ... > }
Handler: listening on port 22100
s415:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300003
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48160
received auth hello!
{ authId: 403, nonce: <Buffer 1d 97 2a 19 88 7d af 6e> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 86 a5 71 77 ef a2 e7 72>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer e5 9c 15 ff ae 74 c1 30 60 ff 6b d0 50 84 94 52>,
  macKeyVal: <Buffer d7 fe c6 71 45 48 62 7c 57 72 f0 d8 82 0f ae 67 2e 9a e1 0c c8 a9 a7 de ee 7d 04 16 09 69 ae aa>,
  absValidity: 2018-08-27T07:49:38.568Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 54 a2 d2 24 b9 55 6f 6d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 54 a2 d2 24 b9 55 6f 6d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.59:36260',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300009
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48370
received auth hello!
{ authId: 403, nonce: <Buffer 0b d5 62 7a c8 06 64 6f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 10 ce 20 90 16 c7 b2 94>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1f 74 5d 64 11 b6 00 9e>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 1f 74 5d 64 11 b6 00 9e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.59:36468',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300015
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48642
received auth hello!
{ authId: 403, nonce: <Buffer 59 fe 73 37 80 4e a3 14> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3a 90 a6 5c 1d 27 d2 70>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bd 09 ee b1 95 5b 82 aa>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bd 09 ee b1 95 5b 82 aa> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.59:36740',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300021
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48912
received auth hello!
{ authId: 403, nonce: <Buffer 66 6e ad ea d8 43 1b f7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 20 5c 5b be ec 9b 31 ed>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e4 b7 d9 00 86 70 c3 c0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e4 b7 d9 00 86 70 c3 c0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.59:37010',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300027
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49182
received auth hello!
{ authId: 403, nonce: <Buffer f2 6e f7 09 ce 86 90 cf> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 35 3a 29 79 1e 71 48 45>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0b c8 8b 86 f4 73 e4 35>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 0b c8 8b 86 f4 73 e4 35> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.59:37280',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300033
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49452
received auth hello!
{ authId: 403, nonce: <Buffer 0e 5a 0a ef 2a bd 95 09> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer eb 3a ea fe 0e c2 5b 46>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2b 43 ef d3 5f ee fc c9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2b 43 ef d3 5f ee fc c9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.59:37550',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300039
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49720
received auth hello!
{ authId: 403, nonce: <Buffer 5e e5 aa bb e9 61 b1 6f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a1 7c cf a5 a6 33 ca 76>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 23 5b ba ae 65 6f 81 19>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 23 5b ba ae 65 6f 81 19> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.59:37818',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300045
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49984
received auth hello!
{ authId: 403, nonce: <Buffer 15 f4 ba bc 97 ea f5 b1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a4 e5 6d c4 dd e7 ee db>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a4 c9 fb 83 17 fc c1 f2>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer a4 c9 fb 83 17 fc c1 f2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.59:38082',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
