changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s407.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's407',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 77 48 ... > }
Handler: listening on port 22100
s407:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200002
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33924
received auth hello!
{ authId: 402, nonce: <Buffer 12 e1 62 86 d7 72 6a d0> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer c7 67 65 dd dc 0d c9 4d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 2f 0f 0a 85 ff 19 eb f5 7e 95 19 23 7e 92 90 a6>,
  macKeyVal: <Buffer 23 16 29 f2 dc 18 7a 15 0d 02 ec ef 04 cc f9 d4 db 6b a2 37 0c eb 17 b2 b7 e9 1e 57 8f 14 4e bf>,
  absValidity: 2018-08-27T07:49:12.188Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bc 10 fb 34 20 ca a1 83>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer bc 10 fb 34 20 ca a1 83> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.51:54380',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200009
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34086
received auth hello!
{ authId: 402, nonce: <Buffer c4 d8 24 2e f0 c8 b7 d7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 31 11 05 a9 e2 d3 3b 44>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 81 28 c8 cf 31 33 cb b4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 81 28 c8 cf 31 33 cb b4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.51:54542',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200016
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34354
received auth hello!
{ authId: 402, nonce: <Buffer 50 a4 c8 5f 3b 22 d2 27> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 85 24 bc c8 39 3e 66 64>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6a 87 18 cc c9 25 40 d4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6a 87 18 cc c9 25 40 d4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.51:54810',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200023
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34624
received auth hello!
{ authId: 402, nonce: <Buffer ee 5d 8a 2b e1 08 24 34> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 08 13 4c f4 bd ce 12 56>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8f d5 09 94 94 93 eb 2d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8f d5 09 94 94 93 eb 2d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.51:55080',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200030
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34894
received auth hello!
{ authId: 402, nonce: <Buffer 94 e7 d3 cb d6 6a 5a 19> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 74 e7 b9 9e e5 0b dd 38>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fa e8 96 cc 41 e8 ad 03>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fa e8 96 cc 41 e8 ad 03> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.51:55350',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200037
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35164
received auth hello!
{ authId: 402, nonce: <Buffer c0 22 07 9e 45 f7 3d 1b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d4 2c 76 4f 2b ec b0 09>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ec ab fd 51 d9 dd c4 14>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ec ab fd 51 d9 dd c4 14> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.51:55620',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200044
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35434
received auth hello!
{ authId: 402, nonce: <Buffer e7 39 ae 3d 55 72 27 2b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 03 46 bf e7 c3 50 c9 24>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a1 19 7c d9 1e 7f f4 6b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a1 19 7c d9 1e 7f f4 6b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.51:55890',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200051
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35704
received auth hello!
{ authId: 402, nonce: <Buffer 6e 87 15 ec 8f a2 a7 78> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b6 9c 14 05 90 3b e0 9d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3a 9e b0 a0 0f d1 bc 5c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3a 9e b0 a0 0f d1 bc 5c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.51:56160',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300046
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300056
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 52832
received auth hello!
{ authId: 503, nonce: <Buffer 5f f6 70 d6 59 a9 01 bc> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth503',
     commonName: '10.0.1.6' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth402',
     commonName: '10.0.0.2' },
  serial: '01657A23471C',
  notBefore: 2018-08-27T06:45:56.000Z,
  notAfter: 2018-08-28T06:47:36.000Z,
  subjectHash: '5542437f',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'CB:2C:9F:98:99:4E:1A:2B:8E:63:3C:1F:E1:0E:82:FE:36:DF:F8:7C',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'BC5D33480D8E7016713911F6B0F0A9131DC7B60A8CB9E1A10BD7543A76CF24678BCCDEF96EAE9DEBCABF978E7789E6CA0C84927254FA399F63769AE55F612D6596ED8937A047D141B0D94354445A0E25D81DE385B8957F9947FECEBCDBC6998D6544DD90F3D3ED8804119CBEF9AD775F3F63F7F6C01396688740867299DD55D2F05ED7417633969B004111F87931929D7463F27FD75E378152650127AE67180E37BB11DC459BB1B15A8A91A3EC4E9A4F409BAB5AD5C90FB833EA0A8D966FFEA0CC1054B7557DF4DC8B1152F7CC89313B4089920237B6D064F37CDE972831ADFD6643D155A4CDB156DC70EE29EC7CAE2C434B3120E75B3A239E854968A41D6A23',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.6' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 503,
  host: '10.0.1.6',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWV6I0ccMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDIxETAPBgNVBAMMCDEwLjAuMC4yMB4XDTE4MDgy\nNzA2NDU1NloXDTE4MDgyODA2NDczNlowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMzERMA8GA1UEAwwIMTAuMC4xLjYwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQC8XTNIDY5wFnE5Efaw8KkTHce2Coy54aEL11Q6ds8kZ4vM3vlu\nrp3ryr+XjneJ5soMhJJyVPo5n2N2muVfYS1llu2JN6BH0UGw2UNURFoOJdgd44W4\nlX+ZR/7OvNvGmY1lRN2Q89PtiAQRnL75rXdfP2P39sATlmiHQIZymd1V0vBe10F2\nM5abAEER+Hkxkp10Y/J/1143gVJlASeuZxgON7sR3EWbsbFaipGj7E6aT0Cbq1rV\nyQ+4M+oKjZZv/qDMEFS3VX303IsRUvfMiTE7QImSAje20GTzfN6XKDGt/WZD0VWk\nzbFW3HDuKex8rixDSzEg51s6I56FSWikHWojAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQYwDQYJKoZIhvcNAQELBQADggEBAKWo18E79zWY3nEnAgwXcHI0s33viYBb\nqun+UJWLyXjrMQCvfmINGPbR4UniF2t3b1aBl9QOZAIzVvqcxbKLNnxPWWFibMPn\nfHQmPEU1irUJ4xjjZzrq/iLX4Qw9TuMihVH/TCaPXQAAeaddGvYJZxeR2YxbJ25k\nzTIf9GDBZNENe48j+M/aYUx9zke42OBoF6LTK4567LOmYsLBsTs3w18Zd/gsSWEt\neSOFiv/FXhbB/ndB/pvd+8rmSoCuzo2SXQqQuUS6jS1yXHKA6YlYNGdTMRqp4eHc\nHIbxcUn98Tlia1I0KMK6H0v1uTSF8RgOrFZO288taqy0E5VShUyD0kA=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300066
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53054
received auth hello!
{ authId: 503, nonce: <Buffer ec 70 bc 95 85 77 b3 6e> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 1d 7b 0a aa 71 8f 58 07>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 33 f8 83 69 84 25 47 5a 37 25 b4 19 cf ce 92 e8>,
  macKeyVal: <Buffer 0b a5 0e bc b0 d3 5f 0d 8d cc 1c 9f 34 e6 6a 0e d5 c6 47 5e 75 67 59 f3 a4 f5 bb 84 fa 61 21 67>,
  absValidity: 2018-08-27T08:01:13.836Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 17 d0 72 ee 49 2f 80 30>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 17 d0 72 ee 49 2f 80 30> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.51:57254',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300076
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53280
received auth hello!
{ authId: 503, nonce: <Buffer 7c 2e d6 5f 48 c3 ba 90> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 43 cf 08 cd 7b b0 95 77>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fb 8b 02 8b 3b 50 02 64>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer fb 8b 02 8b 3b 50 02 64> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.51:57478',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300086
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53504
received auth hello!
{ authId: 503, nonce: <Buffer 83 62 a6 7e 04 4f 01 29> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ac 29 8a cb f0 5e d9 cf>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 92 de 5d 15 45 2b 3f db>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 92 de 5d 15 45 2b 3f db> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.51:57702',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300096
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53722
received auth hello!
{ authId: 503, nonce: <Buffer 88 1e 59 c4 be 83 68 f9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9c 3d f0 dd d3 ed 83 9e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a1 8d 6d 9a 21 2d 91 c3>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer a1 8d 6d 9a 21 2d 91 c3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.51:57922',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300106
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53940
received auth hello!
{ authId: 503, nonce: <Buffer 6d e0 20 2e fc 89 83 54> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5d d2 6e f7 ea da 04 29>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 21 03 a1 a7 49 3a 34 05>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 21 03 a1 a7 49 3a 34 05> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.51:58140',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300116
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54166
received auth hello!
{ authId: 503, nonce: <Buffer 72 eb ad 74 64 50 5a b9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7b 02 71 93 7c 8c f2 3c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 15 76 f8 ba cb 46 f5 96>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 15 76 f8 ba cb 46 f5 96> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.51:58366',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300126
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54388
received auth hello!
{ authId: 503, nonce: <Buffer 66 e3 4f 97 23 38 ac 2c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 79 23 5c ef 07 e5 65 02>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fb ad e3 92 f2 c2 3d 48>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fb ad e3 92 f2 c2 3d 48> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.51:58586',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300136
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54606
received auth hello!
{ authId: 503, nonce: <Buffer 1d fd 25 ed af a5 b4 65> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d5 33 2b cd 1b 03 92 ef>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 49 74 21 9e d9 f7 b3 af>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 49 74 21 9e d9 f7 b3 af> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.51:58806',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300146
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54824
received auth hello!
{ authId: 503, nonce: <Buffer e9 04 0b 56 e4 a9 9b b1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 12 f6 df 22 aa 99 c9 0f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e3 08 e6 1a f7 17 05 13>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e3 08 e6 1a f7 17 05 13> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.51:59024',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300156
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55054
received auth hello!
{ authId: 503, nonce: <Buffer 5f f9 52 09 0f db 17 c0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b9 77 1c 28 0a 4f 4e 5d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 78 89 84 34 48 7a ec 89>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 78 89 84 34 48 7a ec 89> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.51:59254',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300166
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55272
received auth hello!
{ authId: 503, nonce: <Buffer e7 3a b1 bb 56 87 34 a6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bc 87 44 c8 c6 dd 94 40>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8b d4 c2 62 38 be 59 1b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 8b d4 c2 62 38 be 59 1b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.51:59472',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300176
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55494
received auth hello!
{ authId: 503, nonce: <Buffer 7e ad 64 db 84 3f 17 1e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d8 d0 db d4 de 06 f8 61>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 91 0a f8 84 fd ac c8 6a>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 91 0a f8 84 fd ac c8 6a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.51:59694',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300186
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55720
received auth hello!
{ authId: 503, nonce: <Buffer f8 6c ac 41 03 9b b0 ec> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6a 7b 8c 02 b4 d7 20 87>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d6 53 69 a9 ad 2b ff 22>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d6 53 69 a9 ad 2b ff 22> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.51:59918',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300196
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55938
received auth hello!
{ authId: 503, nonce: <Buffer c8 10 43 7b 49 65 77 09> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e3 dd c5 fd f8 a7 9b 36>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a6 f0 8e c6 78 f6 e0 c8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a6 f0 8e c6 78 f6 e0 c8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.51:60138',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300206
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56164
received auth hello!
{ authId: 503, nonce: <Buffer 23 57 69 ea 51 c9 36 0c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 34 3d 4d eb d5 cf df 66>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5c c3 a4 79 dd 72 ef d4>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 5c c3 a4 79 dd 72 ef d4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.51:60364',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300216
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56390
received auth hello!
{ authId: 503, nonce: <Buffer e9 da 11 f4 ab 5b d7 a7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0d c0 4f 11 38 0c 03 bb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ac ac a9 4d ab 83 ab 54>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ac ac a9 4d ab 83 ab 54> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.51:60588',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
