changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s412.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's412',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 2f 37 ... > }
Handler: listening on port 22100
s412:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300001
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52036
received auth hello!
{ authId: 403, nonce: <Buffer d6 21 81 cf 64 bf 4b 94> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer db 43 9f 34 73 44 de 8a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer e8 9c 20 c2 c7 54 06 93 a5 6f 61 19 c4 09 99 d5>,
  macKeyVal: <Buffer 28 8b b3 67 8c ed 95 52 e0 14 4f eb 9b cc 1a 09 f5 d7 11 a2 ce c0 c2 5a 9b b9 e1 ab 88 c7 3d 24>,
  absValidity: 2018-08-27T07:49:31.564Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 33 33 b8 04 94 24 de 08>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 33 33 b8 04 94 24 de 08> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.57:41036',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300007
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52234
received auth hello!
{ authId: 403, nonce: <Buffer 38 31 b5 74 e3 52 b3 4a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 01 f9 57 ba 20 5b ed 38>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b2 6e 49 d8 e4 4f 87 67>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b2 6e 49 d8 e4 4f 87 67> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.57:41234',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300013
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52506
received auth hello!
{ authId: 403, nonce: <Buffer 01 4b 7e 0d ca 77 3c 36> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f1 d9 df 18 97 ea df e1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 21 12 5b 38 f3 76 2f 7e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 21 12 5b 38 f3 76 2f 7e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.57:41506',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300019
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52776
received auth hello!
{ authId: 403, nonce: <Buffer d0 25 66 44 09 6c 0a 9f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 01 9b 78 ea 6b 34 bb 30>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bf 5c 27 f0 8a 76 e8 f6>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer bf 5c 27 f0 8a 76 e8 f6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.57:41776',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300025
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53046
received auth hello!
{ authId: 403, nonce: <Buffer 0b 4c 61 ad 42 d4 e5 5e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8d 8e 94 83 5f 17 b4 58>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f8 6a 75 cc 1d 52 17 05>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f8 6a 75 cc 1d 52 17 05> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.57:42046',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300031
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53316
received auth hello!
{ authId: 403, nonce: <Buffer 39 05 74 04 4b de a6 fa> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7b b8 e4 7b 4d 02 f4 a0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5f 2b 31 0d e4 f0 db 88>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5f 2b 31 0d e4 f0 db 88> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.57:42316',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300037
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53586
received auth hello!
{ authId: 403, nonce: <Buffer b6 ed 65 be 77 3c 3b 88> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6c c3 42 b4 f1 08 ac ac>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 37 30 67 83 b9 d8 7f 35>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 37 30 67 83 b9 d8 7f 35> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.57:42586',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300043
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53848
received auth hello!
{ authId: 403, nonce: <Buffer d9 a6 ff bc c1 b9 1f cb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 21 67 44 27 8e eb 87 d8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 94 99 94 28 8b d2 d9 9a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 94 99 94 28 8b d2 d9 9a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.57:42848',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
