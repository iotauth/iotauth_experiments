changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s416.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's416',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 51 49 42 41 41 4b 43 41 51 45 41 76 4b ... > }
Handler: listening on port 22100
s416:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300004
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49474
received auth hello!
{ authId: 403, nonce: <Buffer 16 68 ea 72 4b c1 e2 c2> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer bb 8d 74 03 45 5e b0 ae>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer ab f2 0f e1 97 51 07 96 6a 61 cb 7f 15 a9 31 35>,
  macKeyVal: <Buffer ae dc 24 ea 5b d7 45 5f 73 f9 cd fa af d6 3d 83 ff 2f e0 37 6a ea 36 dd c3 c2 6b bc b9 d2 ec e7>,
  absValidity: 2018-08-27T07:49:42.560Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cb fc 1f bf 3a a0 cf b8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer cb fc 1f bf 3a a0 cf b8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.60:55150',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300005
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49480
received auth hello!
{ authId: 403, nonce: <Buffer d2 2d 11 c9 9a 53 ac 7e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 64 a7 f6 3d 96 0c 58 4a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer dc 3f f5 79 38 d6 5e 14>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer dc 3f f5 79 38 d6 5e 14> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.61:35960',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300010
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49686
received auth hello!
{ authId: 403, nonce: <Buffer 9e 4c 63 12 f7 61 7c ed> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5d 3a 55 8c 36 90 d1 b3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 70 f4 5d 11 06 d5 4d a7>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 70 f4 5d 11 06 d5 4d a7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.60:55362',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300011
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49702
received auth hello!
{ authId: 403, nonce: <Buffer 60 9c ff 98 58 9b 19 25> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 79 e0 1c fb 44 df f1 1e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 84 d8 a8 bd 43 4f ab 32>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 84 d8 a8 bd 43 4f ab 32> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.61:36182',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300016
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49958
received auth hello!
{ authId: 403, nonce: <Buffer 25 89 d2 42 29 84 ac 3b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 54 18 0a c2 ea 67 43 26>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 54 9c cb 32 79 cf fa 9b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 54 9c cb 32 79 cf fa 9b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.60:55634',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300017
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49974
received auth hello!
{ authId: 403, nonce: <Buffer 1e 3c d4 11 53 d3 2c 74> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 76 b3 4a 9a 06 4f 30 2c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer af de 9b 95 4a a8 d8 ba>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer af de 9b 95 4a a8 d8 ba> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.61:36454',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300022
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50228
received auth hello!
{ authId: 403, nonce: <Buffer 9b 23 c0 d3 1b e9 ae ff> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ac 22 47 ef 4d 63 87 f2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fd 0e 4e fb 38 14 82 a7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fd 0e 4e fb 38 14 82 a7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.60:55904',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300023
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50244
received auth hello!
{ authId: 403, nonce: <Buffer fd 7f de 43 49 6e d2 70> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 08 a5 1e de d2 fb 9b 01>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d7 a6 9c f2 27 8c e0 fe>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer d7 a6 9c f2 27 8c e0 fe> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.61:36724',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300028
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50498
received auth hello!
{ authId: 403, nonce: <Buffer 54 a6 c5 17 19 5d a6 14> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 22 a0 03 50 0a b7 0a 7e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d3 17 94 1a 6c b8 d2 06>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer d3 17 94 1a 6c b8 d2 06> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.60:56174',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300029
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50514
received auth hello!
{ authId: 403, nonce: <Buffer 33 60 a9 00 58 bd 85 41> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4b 6e 74 d6 14 ab ed 51>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer eb c3 d6 02 cf aa ad fa>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer eb c3 d6 02 cf aa ad fa> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.61:36994',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300034
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50768
received auth hello!
{ authId: 403, nonce: <Buffer 44 d1 55 57 8d 15 24 6c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer af 85 21 2b 6b 47 10 5a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 51 e8 44 5b e2 1a 6b ec>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 51 e8 44 5b e2 1a 6b ec> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.60:56444',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300035
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50784
received auth hello!
{ authId: 403, nonce: <Buffer 08 eb 01 58 99 ef f7 87> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c5 20 f2 68 dd 0a 9a fb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9e aa 6b b8 56 ac 02 21>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9e aa 6b b8 56 ac 02 21> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.61:37264',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300040
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51038
received auth hello!
{ authId: 403, nonce: <Buffer 7c 77 5a 10 9d c4 1e 03> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 22 23 12 b6 21 e2 49 ff>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b3 94 46 d5 36 ed 74 49>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b3 94 46 d5 36 ed 74 49> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.60:56714',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300041
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51054
received auth hello!
{ authId: 403, nonce: <Buffer d4 0d 49 e8 ac 6e 7c b5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b3 f7 14 bc 01 45 57 99>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 58 1d bc 4f 61 e6 0b 3e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 58 1d bc 4f 61 e6 0b 3e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.61:37534',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300046
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51300
received auth hello!
{ authId: 403, nonce: <Buffer 44 22 b0 7f f2 92 f2 9a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fb 8b 0d 0b 15 be 7d 19>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 27 1a 5b ba 48 4c be 90>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 27 1a 5b ba 48 4c be 90> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.60:56976',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300047
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51316
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
