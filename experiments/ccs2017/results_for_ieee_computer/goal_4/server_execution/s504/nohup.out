changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s504.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's504',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 79 6f ... > }
Handler: listening on port 22100
s504:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100003
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46446
received auth hello!
{ authId: 501, nonce: <Buffer 8d 80 60 8e 6a 21 de 5c> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 54 b2 07 03 95 10 2a 7a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 56 4f 38 23 95 f8 98 c1 ad ae eb d2 71 6f f0 ac>,
  macKeyVal: <Buffer 78 c1 d8 cc d8 07 47 59 76 45 3a 08 32 10 28 1a b1 d9 ad 2e c0 26 fe bc 66 f1 e4 a4 a3 50 74 07>,
  absValidity: 2018-08-27T07:50:04.395Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a9 e3 5a b4 2b 6c 13 06>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a9 e3 5a b4 2b 6c 13 06> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.67:50520',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100011
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46702
received auth hello!
{ authId: 501, nonce: <Buffer 5f 11 98 81 03 bd 86 9f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 79 63 7e 31 e5 ca cc 28>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 96 a7 11 bd 1b d9 21 59>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 96 a7 11 bd 1b d9 21 59> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.67:50776',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100019
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46972
received auth hello!
{ authId: 501, nonce: <Buffer b3 5f 3c 12 a3 94 61 55> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 12 f8 3a bc fe 14 d6 11>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9a 83 67 42 b7 dd ca e6>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 9a 83 67 42 b7 dd ca e6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.67:51046',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100027
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47242
received auth hello!
{ authId: 501, nonce: <Buffer 77 1a a5 fa e2 1d 05 90> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 14 7d d4 f4 27 bb 9a b9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8e 74 f0 8c 3d a3 c2 d0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8e 74 f0 8c 3d a3 c2 d0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.67:51316',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100035
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47512
received auth hello!
{ authId: 501, nonce: <Buffer 2a 59 04 70 77 bb bc c7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 12 57 01 be 19 7a 4a 5e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 69 10 56 97 f4 90 c0 f5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 69 10 56 97 f4 90 c0 f5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.67:51586',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100043
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47782
received auth hello!
{ authId: 501, nonce: <Buffer 8d b0 60 c8 4d ae 5e 2e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1c ba d3 49 f5 a5 9c 1b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5f 1c 9a 0d 9d 6d 88 8f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5f 1c 9a 0d 9d 6d 88 8f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.67:51856',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100051
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48052
received auth hello!
{ authId: 501, nonce: <Buffer ca db f9 3d a0 4d ea 06> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7c a8 b8 6b 40 37 17 26>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 67 13 8a cb fc 12 0e 7e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 67 13 8a cb fc 12 0e 7e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.67:52126',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200067
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200080
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 42776
received auth hello!
{ authId: 502, nonce: <Buffer ea 12 8b 64 eb d7 46 55> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '01657A234AEA',
  notBefore: 2018-08-27T06:45:57.000Z,
  notAfter: 2018-08-28T06:47:37.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'A7:B6:57:69:93:F1:74:B8:2F:84:21:C0:E9:FE:BB:EC:DE:C7:AC:73',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'E67D8D8DE1FDDD2C2465EAD2E2C8469468E30C862129741C44CD759698CE97A1EBFCBA21D764D410591EE7063D4A632FD29AD3449C9B0DFBC9FF499E509A0969E40EA76C3AE2863ACBBC992A983F178890D4B1E505497F0A52900EFB38BDD51ED38CC446055817F90C1C892D25C947EE3AE8A8349A59E52B167953D94E0FB0082EE1A41137CB068ACD59E4752201F98ECA9664AD60B18C32213DF2545F63BF81939F78FABD925C71CDEE8114C56A96C1A70FD25E90066AB4026471D8372D30665DAC9B54EC472D58F09A4903599BC5D9C556B25898BAB963E93DFAC900B67CF7D3E060D71817CE9CF36D42A16F7BA93CBD3440B1A754DA038A8AD0D4430E66E7',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWV6I0rqMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDgy\nNzA2NDU1N1oXDTE4MDgyODA2NDczN1owYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDmfY2N4f3dLCRl6tLiyEaUaOMMhiEpdBxEzXWWmM6Xoev8uiHX\nZNQQWR7nBj1KYy/SmtNEnJsN+8n/SZ5Qmglp5A6nbDrihjrLvJkqmD8XiJDUseUF\nSX8KUpAO+zi91R7TjMRGBVgX+QwciS0lyUfuOuioNJpZ5SsWeVPZTg+wCC7hpBE3\nywaKzVnkdSIB+Y7KlmStYLGMMiE98lRfY7+Bk594+r2SXHHN7oEUxWqWwacP0l6Q\nBmq0AmRx2DctMGZdrJtU7EctWPCaSQNZm8XZxVayWJi6uWPpPfrJALZ899PgYNcY\nF86c821CoW97qTy9NECxp1TaA4qK0NRDDmbnAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBADkNhcSp+RRg8Syi3B///rYO3Xa3x0P3\n3udQis0gykrPKfgpwJeo70xDRVpmE4VwMeb2g9XAiG5edfVR0hMhNvsMXVgMw39y\nBmbeL6rjGvfeNYmvOuX+adZ7Mbe69nwzMF18lcmywFmXR7+LD/haBZ5u0YVX+XYY\nHZ5mJ+5jgCUifecPUbDLxB4R0KQciWvMMwOrnN9Uj0TnX9rkXcQfxQjV8IhLq9IA\ntZNJ7K1iEXZFzT+3GYqF0BmoDcdiI2WX+bgmPmvkSgvDQaGMBghQEd/aZnRqLuhh\n2mGracqP+MGIHvFq7rv/DayVc5XQsb5Fp0YWMFwCmfNVHv5jGsTEbPc=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200093
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43016
received auth hello!
{ authId: 502, nonce: <Buffer df 4c 49 1d c7 0a e0 b6> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 01 86 57 a6 98 db 57 b4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 98 9c f2 22 75 30 f5 77 83 48 9f e2 f1 59 1e 3d>,
  macKeyVal: <Buffer 1d 85 65 f1 5f c1 64 c5 3b aa 95 36 5f 2c 7c c5 3e 48 11 ba 87 7c d5 65 f9 43 bb 92 18 26 3a 90>,
  absValidity: 2018-08-27T08:01:05.595Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7a 42 62 a8 a6 9b 11 f7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 7a 42 62 a8 a6 9b 11 f7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.67:53228',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200106
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43238
received auth hello!
{ authId: 502, nonce: <Buffer 87 15 e0 23 c8 b5 35 6a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b7 31 7b d7 dc 29 66 0c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b6 78 ca 70 e4 99 ec 2f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b6 78 ca 70 e4 99 ec 2f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.67:53450',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200119
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43462
received auth hello!
{ authId: 502, nonce: <Buffer f8 96 c9 3b 39 80 0b de> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 76 55 a1 0d 0e 6c 49 1f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0c a5 66 e4 24 a1 0c ae>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0c a5 66 e4 24 a1 0c ae> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.67:53674',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200132
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43684
received auth hello!
{ authId: 502, nonce: <Buffer 00 e8 2b e9 cd 42 13 ff> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c0 85 22 7f 2d 40 e4 a9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5a 46 96 7f 1c 1a 6f 21>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5a 46 96 7f 1c 1a 6f 21> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.67:53896',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200145
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43902
received auth hello!
{ authId: 502, nonce: <Buffer 4d 95 db 08 41 33 d2 e1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f6 b1 7f 6a 87 5e 36 aa>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 28 5f ea 1c e1 df 58 d6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 28 5f ea 1c e1 df 58 d6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.67:54114',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200158
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44124
received auth hello!
{ authId: 502, nonce: <Buffer d7 a2 42 61 40 49 fe 07> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 25 c7 78 74 47 bc dc cd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c0 5e 5a 96 db 60 c3 e7>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c0 5e 5a 96 db 60 c3 e7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.67:54336',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200171
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44346
received auth hello!
{ authId: 502, nonce: <Buffer e6 8c 0b d7 b1 1e c9 db> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e4 21 a4 e4 65 1c 8a 08>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6d 14 7c 01 bd ab eb 6d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6d 14 7c 01 bd ab eb 6d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.67:54558',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200184
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44568
received auth hello!
{ authId: 502, nonce: <Buffer 25 17 94 fe 86 1e 2f c0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b0 82 8d df 98 15 68 a6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9d 38 fa 6c 91 1e 87 1d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9d 38 fa 6c 91 1e 87 1d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.67:54780',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200197
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44790
received auth hello!
{ authId: 502, nonce: <Buffer 6a 41 4e 23 e8 04 8a 62> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4e 3b e0 b8 26 43 92 64>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ff 33 00 5d 68 2d f1 c5>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ff 33 00 5d 68 2d f1 c5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.67:55002',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200210
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45016
received auth hello!
{ authId: 502, nonce: <Buffer d7 06 2a 7c 59 c0 9a ac> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0f 0e 6b 85 66 10 40 9b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 18 c1 ab df c1 41 9d c8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 18 c1 ab df c1 41 9d c8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.67:55228',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200223
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45234
received auth hello!
{ authId: 502, nonce: <Buffer 68 03 77 bd 27 69 91 fe> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6b fb c7 df a9 11 05 8d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 74 f4 63 a7 c5 2b 25 ff>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 74 f4 63 a7 c5 2b 25 ff> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.67:55446',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200236
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45456
received auth hello!
{ authId: 502, nonce: <Buffer 74 97 d7 77 bc 75 d4 d2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 89 33 59 67 59 d5 4c 35>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e8 82 11 1f 38 d0 58 2f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e8 82 11 1f 38 d0 58 2f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.67:55668',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200249
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45682
received auth hello!
{ authId: 502, nonce: <Buffer 6b c8 58 cb c3 f1 5d 7b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8a 99 43 96 c4 3a 00 f8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 45 5d f6 00 0d e2 47 e7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 45 5d f6 00 0d e2 47 e7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.67:55894',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200262
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45900
received auth hello!
{ authId: 502, nonce: <Buffer fb ac 11 24 bc 5f d9 92> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer de 4a 80 fb a3 89 7d 37>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5e 25 71 1a 3b 9f d7 60>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5e 25 71 1a 3b 9f d7 60> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.67:56112',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200275
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46126
received auth hello!
{ authId: 502, nonce: <Buffer 67 fd cc 4e e1 b3 ff 20> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a9 1b f1 1c 07 e6 4c cf>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3d b6 fa e2 61 85 a1 28>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 3d b6 fa e2 61 85 a1 28> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.67:56338',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200288
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46348
received auth hello!
{ authId: 502, nonce: <Buffer f3 d6 33 89 36 30 61 a4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 30 c0 1f bc 78 fe ec af>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6b 9d 1a f3 96 41 68 fb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6b 9d 1a f3 96 41 68 fb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.67:56560',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200301
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46566
received auth hello!
{ authId: 502, nonce: <Buffer 0a 17 43 4a 18 3f ce cf> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e1 d0 11 08 3c 19 7c bb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fb 12 13 99 4c e9 4f 85>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fb 12 13 99 4c e9 4f 85> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.67:56776',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200313
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46692
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
received auth hello!
{ authId: 502, nonce: <Buffer 41 71 9f 1d 2e 91 66 3b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f4 85 7b d5 8c bb 88 b7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1d e9 b0 46 11 f3 11 72>
Handler: Error in server - details: Error during comm init, details: Error: This socket has been ended by the other party
switching to HANDSHAKE_2_SENT
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
