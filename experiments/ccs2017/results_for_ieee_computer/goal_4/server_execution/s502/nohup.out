changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s502.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's502',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 77 5a ... > }
Handler: listening on port 22100
s502:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100001
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33278
received auth hello!
{ authId: 501, nonce: <Buffer eb 88 96 e6 b1 d7 13 d3> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 05 62 1e 7e 9f 08 16 16>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 58 40 86 11 79 58 58 64 f7 8e 4e 0a 80 96 dc 0d>,
  macKeyVal: <Buffer a4 ed 85 b4 b7 38 5a 9c 18 3e 7c 4a b4 46 b9 d8 0c e4 3f a7 25 19 0b 9b 39 87 a8 a2 db 54 7b 5f>,
  absValidity: 2018-08-27T07:49:51.153Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c3 fa 0b 05 bf 07 29 4f>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c3 fa 0b 05 bf 07 29 4f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.63:59604',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100009
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33514
received auth hello!
{ authId: 501, nonce: <Buffer b1 ad 27 4d 60 21 23 92> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 82 f8 6b 41 2d 7a 46 2d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d4 94 28 63 fb 85 e0 54>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d4 94 28 63 fb 85 e0 54> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.63:59838',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100017
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33784
received auth hello!
{ authId: 501, nonce: <Buffer d8 9c e0 1e b3 b1 65 f2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f2 9b fb 7d 0f 06 ce 0f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c3 2a 39 ef 1f 23 c6 41>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c3 2a 39 ef 1f 23 c6 41> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.63:60110',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100025
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34054
received auth hello!
{ authId: 501, nonce: <Buffer cb 16 e4 9e a3 6c d6 6c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 54 7d a9 b1 a8 b9 60 bb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3c 7a 91 0e 63 35 a7 fa>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3c 7a 91 0e 63 35 a7 fa> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.63:60378',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100033
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34324
received auth hello!
{ authId: 501, nonce: <Buffer 1a 1a af 28 83 a5 22 27> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 50 ae c6 4d cf 1a 07 42>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2a 62 e1 01 5c 4f 5a f5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2a 62 e1 01 5c 4f 5a f5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.63:60650',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100041
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34594
received auth hello!
{ authId: 501, nonce: <Buffer 8a 27 64 c9 a4 a2 2f 2c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8e fc c2 cb 9e 61 87 3a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 95 7f 7f b1 60 9f c1 18>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 95 7f 7f b1 60 9f c1 18> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.63:60918',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100049
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34864
received auth hello!
{ authId: 501, nonce: <Buffer be 9f 5e cc 29 25 10 a2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ef 66 0c 1a af 91 f5 43>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cd be 3f b9 a3 3b b8 66>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer cd be 3f b9 a3 3b b8 66> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.63:32958',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
