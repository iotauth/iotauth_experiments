changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c410.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c410',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 75 50 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1535355326234
connected to auth! from local port 52328
received auth hello!
{ authId: 402, nonce: <Buffer 14 8c fa ad 41 e7 49 ae> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer af 7d bf ba d9 8c e3 3f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 7a 5f 92 93 43 51 58 d1 c7 98 8b 3a e7 0a c6 b5>,
  macKeyVal: <Buffer d1 4f 40 64 6b 0c f6 de 4a b6 2e ea ba b0 23 31 0e c1 e9 15 e4 10 d0 17 31 9f cd a5 1c 6d 10 aa>,
  absValidity: 2018-08-27T08:35:26.402Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200058,
  cipherKeyVal: <Buffer a3 00 53 ce 03 96 52 cb 16 06 fb 8b 59 b4 5c 2a>,
  macKeyVal: <Buffer 63 07 d3 f7 ad a1 08 47 dc cd 5e f8 92 7d 35 a2 48 49 d4 6a 8a f4 e6 c3 7b 35 8f aa dc 4f 55 13>,
  absValidity: 2018-08-28T07:35:26.401Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200058,
     cipherKeyVal: <Buffer a3 00 53 ce 03 96 52 cb 16 06 fb 8b 59 b4 5c 2a>,
     macKeyVal: <Buffer 63 07 d3 f7 ad a1 08 47 dc cd 5e f8 92 7d 35 a2 48 49 d4 6a 8a f4 e6 c3 7b 35 8f aa dc 4f 55 13>,
     absValidity: 2018-08-28T07:35:26.401Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 8d b3 6b 78 c1 79 ce ce>
switching to HANDSHAKE_1_SENT
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 07:35:27 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1535355328140
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1535355386293
connected to auth! from local port 52496
received auth hello!
{ authId: 402, nonce: <Buffer 29 1f 59 f1 91 cc 0c 02> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 16 54 4c 93 13 10 b0 7a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200065,
  cipherKeyVal: <Buffer 8c e9 7a 58 6f 64 34 1b f3 eb 3c f4 0f 1d 72 7c>,
  macKeyVal: <Buffer e1 a1 e8 bf 9f fe 2b ed be 82 f8 a9 b6 d2 ba dc f9 ca a9 4a 20 aa a1 45 fa 9c 97 2a e2 62 4e 87>,
  absValidity: 2018-08-28T07:36:26.508Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200065,
     cipherKeyVal: <Buffer 8c e9 7a 58 6f 64 34 1b f3 eb 3c f4 0f 1d 72 7c>,
     macKeyVal: <Buffer e1 a1 e8 bf 9f fe 2b ed be 82 f8 a9 b6 d2 ba dc f9 ca a9 4a 20 aa a1 45 fa 9c 97 2a e2 62 4e 87>,
     absValidity: 2018-08-28T07:36:26.508Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 81 0d 66 09 96 94 de 04>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 07:36:27 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1535355388174
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1535355446334
connected to auth! from local port 52768
received auth hello!
{ authId: 402, nonce: <Buffer 17 1a 78 05 5b 95 1b d2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f5 f6 8a 49 f0 f3 61 90>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200072,
  cipherKeyVal: <Buffer ee 80 a4 e4 e4 4f ad a6 af fa 0a 53 82 1f 7b 9d>,
  macKeyVal: <Buffer 51 7d aa b4 84 fd cd 46 d7 68 19 36 37 d0 69 82 10 0d 9b be bf 2e b6 71 f9 ed 0d 6b 91 0f e8 7f>,
  absValidity: 2018-08-28T07:37:26.583Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200072,
     cipherKeyVal: <Buffer ee 80 a4 e4 e4 4f ad a6 af fa 0a 53 82 1f 7b 9d>,
     macKeyVal: <Buffer 51 7d aa b4 84 fd cd 46 d7 68 19 36 37 d0 69 82 10 0d 9b be bf 2e b6 71 f9 ed 0d 6b 91 0f e8 7f>,
     absValidity: 2018-08-28T07:37:26.583Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer c0 32 53 6e 7f 44 b5 09>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 07:37:28 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1535355448563
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1535355506392
connected to auth! from local port 53038
received auth hello!
{ authId: 402, nonce: <Buffer ff 21 95 af 3a f5 9c 43> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 57 37 38 ab 91 a5 c7 88>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200079,
  cipherKeyVal: <Buffer 3b 5a 7d ae 07 3e b5 5e 9c 42 71 a0 19 e2 13 c5>,
  macKeyVal: <Buffer 3f 8e f4 6f 19 78 49 47 05 72 2e 9c 7b 3c 45 e9 de 20 90 57 09 25 8a 59 e9 c1 0e df d0 1a 6c 13>,
  absValidity: 2018-08-28T07:38:26.573Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200079,
     cipherKeyVal: <Buffer 3b 5a 7d ae 07 3e b5 5e 9c 42 71 a0 19 e2 13 c5>,
     macKeyVal: <Buffer 3f 8e f4 6f 19 78 49 47 05 72 2e 9c 7b 3c 45 e9 de 20 90 57 09 25 8a 59 e9 c1 0e df d0 1a 6c 13>,
     absValidity: 2018-08-28T07:38:26.573Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer e9 38 04 76 2b 87 ba 1e>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 07:38:28 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1535355508443
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1535355566406
connected to auth! from local port 53308
received auth hello!
{ authId: 402, nonce: <Buffer df 40 8a ce 52 bd a6 f8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bc 5f 48 92 83 ea a7 87>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200086,
  cipherKeyVal: <Buffer b0 a4 d7 f7 2d 2f de 2d db 7e 66 d2 db c0 a5 ba>,
  macKeyVal: <Buffer 44 bb 7c e8 74 8d 75 02 d9 3e 23 70 56 56 3c 83 99 ba a6 36 be b0 4e 21 8d 0b 48 b4 44 14 b5 35>,
  absValidity: 2018-08-28T07:39:26.653Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200086,
     cipherKeyVal: <Buffer b0 a4 d7 f7 2d 2f de 2d db 7e 66 d2 db c0 a5 ba>,
     macKeyVal: <Buffer 44 bb 7c e8 74 8d 75 02 d9 3e 23 70 56 56 3c 83 99 ba a6 36 be b0 4e 21 8d 0b 48 b4 44 14 b5 35>,
     absValidity: 2018-08-28T07:39:26.653Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 4f 3a 4b 06 ca cf 0b 74>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 07:39:28 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1535355568514
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1535355626464
connected to auth! from local port 53578
received auth hello!
{ authId: 402, nonce: <Buffer ac 36 02 6f eb 24 10 6f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3a 5e 83 77 27 9f 60 82>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200093,
  cipherKeyVal: <Buffer ac 4a d3 64 49 98 e0 9f ce 0a 83 40 e3 94 c2 04>,
  macKeyVal: <Buffer b3 ed 23 70 c0 e7 93 48 93 6b 41 ed fd 63 1c 48 e8 bb 5b df 2d b1 b5 50 55 16 fc 96 a9 40 58 85>,
  absValidity: 2018-08-28T07:40:26.766Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200093,
     cipherKeyVal: <Buffer ac 4a d3 64 49 98 e0 9f ce 0a 83 40 e3 94 c2 04>,
     macKeyVal: <Buffer b3 ed 23 70 c0 e7 93 48 93 6b 41 ed fd 63 1c 48 e8 bb 5b df 2d b1 b5 50 55 16 fc 96 a9 40 58 85>,
     absValidity: 2018-08-28T07:40:26.766Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer b5 32 03 ed 0e 37 c3 4e>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 07:40:28 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1535355628558
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1535355686520
connected to auth! from local port 53848
received auth hello!
{ authId: 402, nonce: <Buffer 2e 0f 04 d5 7d 10 e9 7c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2e 4d 91 65 46 8a 22 25>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200100,
  cipherKeyVal: <Buffer 9c c2 b4 31 1f 9c 2c ec 94 2c d9 a3 a7 4e aa bb>,
  macKeyVal: <Buffer b8 75 54 7f df 3e 29 15 d1 71 51 19 92 31 7b 3e 53 f5 fb 91 db f3 3c 60 af 54 29 84 00 af be 04>,
  absValidity: 2018-08-28T07:41:26.745Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200100,
     cipherKeyVal: <Buffer 9c c2 b4 31 1f 9c 2c ec 94 2c d9 a3 a7 4e aa bb>,
     macKeyVal: <Buffer b8 75 54 7f df 3e 29 15 d1 71 51 19 92 31 7b 3e 53 f5 fb 91 db f3 3c 60 af 54 29 84 00 af be 04>,
     absValidity: 2018-08-28T07:41:26.745Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 8f 5f 62 be 0b 85 95 5e>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 07:41:28 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1535355688565
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1535355746522
connected to auth! from local port 54114
received auth hello!
{ authId: 402, nonce: <Buffer c5 d2 a1 88 6c a9 d1 c4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 88 f5 e1 9e 82 8b fc 64>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200107,
  cipherKeyVal: <Buffer 3a d2 07 8d d7 68 9d e7 18 b5 0b e5 86 3a 6f d7>,
  macKeyVal: <Buffer 73 85 59 52 bb d9 2b eb b3 6d 30 10 6c a3 16 03 39 e2 c1 71 22 1d 7e 48 46 87 8e eb 34 5c 10 27>,
  absValidity: 2018-08-28T07:42:26.806Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200107,
     cipherKeyVal: <Buffer 3a d2 07 8d d7 68 9d e7 18 b5 0b e5 86 3a 6f d7>,
     macKeyVal: <Buffer 73 85 59 52 bb d9 2b eb b3 6d 30 10 6c a3 16 03 39 e2 c1 71 22 1d 7e 48 46 87 8e eb 34 5c 10 27>,
     absValidity: 2018-08-28T07:42:26.806Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 96 d7 a8 e2 77 28 39 e4>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 07:42:28 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 8 1 1535355748372
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 9 0.8888888888888888 1535355806564
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 10 0.8 1535355866575
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 46050
received auth hello!
{ authId: 503, nonce: <Buffer 7e a9 ca ca 6b 9d d8 3e> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth503',
     commonName: '10.0.1.6' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth402',
     commonName: '10.0.0.2' },
  serial: '01657A4D921F',
  notBefore: 2018-08-27T07:32:08.000Z,
  notAfter: 2018-08-28T07:33:48.000Z,
  subjectHash: '5542437f',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '57:A2:A5:44:F9:8B:AC:E9:1C:D3:1D:81:61:B8:C9:50:57:07:4E:2E',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'BC5D33480D8E7016713911F6B0F0A9131DC7B60A8CB9E1A10BD7543A76CF24678BCCDEF96EAE9DEBCABF978E7789E6CA0C84927254FA399F63769AE55F612D6596ED8937A047D141B0D94354445A0E25D81DE385B8957F9947FECEBCDBC6998D6544DD90F3D3ED8804119CBEF9AD775F3F63F7F6C01396688740867299DD55D2F05ED7417633969B004111F87931929D7463F27FD75E378152650127AE67180E37BB11DC459BB1B15A8A91A3EC4E9A4F409BAB5AD5C90FB833EA0A8D966FFEA0CC1054B7557DF4DC8B1152F7CC89313B4089920237B6D064F37CDE972831ADFD6643D155A4CDB156DC70EE29EC7CAE2C434B3120E75B3A239E854968A41D6A23',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.6' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 503,
  host: '10.0.1.6',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWV6TZIfMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDIxETAPBgNVBAMMCDEwLjAuMC4yMB4XDTE4MDgy\nNzA3MzIwOFoXDTE4MDgyODA3MzM0OFowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMzERMA8GA1UEAwwIMTAuMC4xLjYwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQC8XTNIDY5wFnE5Efaw8KkTHce2Coy54aEL11Q6ds8kZ4vM3vlu\nrp3ryr+XjneJ5soMhJJyVPo5n2N2muVfYS1llu2JN6BH0UGw2UNURFoOJdgd44W4\nlX+ZR/7OvNvGmY1lRN2Q89PtiAQRnL75rXdfP2P39sATlmiHQIZymd1V0vBe10F2\nM5abAEER+Hkxkp10Y/J/1143gVJlASeuZxgON7sR3EWbsbFaipGj7E6aT0Cbq1rV\nyQ+4M+oKjZZv/qDMEFS3VX303IsRUvfMiTE7QImSAje20GTzfN6XKDGt/WZD0VWk\nzbFW3HDuKex8rixDSzEg51s6I56FSWikHWojAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQYwDQYJKoZIhvcNAQELBQADggEBAI88N4Mj21NZsJLhiycfEB9jzdK844n4\nq93aLcb5pgGMbXeEJchupnYCvQ8c4TM778yZ8eXMrII1MgYjFbp45noPxZCSCM/K\n59pISG3gLy+KknKbDNABh0DgUMUXowBnpua2PbOaktLSiHeQLKFqV4kBMGrrpSd5\nEwVzGrYE9PKKnRiLy6JUyVpUZQ2dV8dev31R6c1KH18pIrVJpGV95dpoAWw4dZGD\nicL/vTa9EhjkG9jkg1ur0S3jiYR/j7N15tbi1Vxn8zy90LgQXXrjwo+hmnN0JEn/\nz/NaggrMlFlXj0O/hcqxun/9+NWpu+nctSRAhZM5e1mPrXxKGQAiyyY=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 11 0.7272727272727273 1535355926585
connected to auth! from local port 46312
received auth hello!
{ authId: 503, nonce: <Buffer 7f 97 a4 75 6a e1 d5 a6> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 6a 9c b5 46 87 9d a2 9f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer d1 b3 e6 68 69 2d 05 d2 b3 e8 a5 e1 72 aa f6 54>,
  macKeyVal: <Buffer 0e 17 0a 41 f3 f1 ef 7e 53 de 37 83 44 d9 4b 32 ba d3 d5 99 7b e3 33 f2 bf 24 ae 1c 7e e5 53 18>,
  absValidity: 2018-08-27T08:45:26.747Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300282,
  cipherKeyVal: <Buffer 07 dc 85 1d c7 32 c4 93 9b 0d 09 cf bb 25 a7 e8>,
  macKeyVal: <Buffer e5 24 12 e4 89 cb c2 fe 81 47 d6 b7 70 24 19 9f 74 f8 c6 76 3f a7 34 dd 9c 54 e2 a5 b7 81 54 49>,
  absValidity: 2018-08-28T07:45:26.746Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300282,
     cipherKeyVal: <Buffer 07 dc 85 1d c7 32 c4 93 9b 0d 09 cf bb 25 a7 e8>,
     macKeyVal: <Buffer e5 24 12 e4 89 cb c2 fe 81 47 d6 b7 70 24 19 9f 74 f8 c6 76 3f a7 34 dd 9c 54 e2 a5 b7 81 54 49>,
     absValidity: 2018-08-28T07:45:26.746Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 26 9c 1d 52 21 3a 0a 41>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.15:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 12 0.6666666666666666 1535355986596
connected to auth! from local port 46590
received auth hello!
{ authId: 503, nonce: <Buffer ca af 30 92 72 b4 21 36> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ac 27 73 83 eb fa c4 8b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300292,
  cipherKeyVal: <Buffer d3 1c 74 17 c6 35 f8 64 03 ed 6e 4d 57 08 7a 3e>,
  macKeyVal: <Buffer ed 0a 0c f8 b8 c0 7e 10 88 eb 03 12 be dd 00 77 96 39 99 9c a3 57 4c 3b 09 33 fa 3a ae c4 4b 08>,
  absValidity: 2018-08-28T07:46:26.741Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300292,
     cipherKeyVal: <Buffer d3 1c 74 17 c6 35 f8 64 03 ed 6e 4d 57 08 7a 3e>,
     macKeyVal: <Buffer ed 0a 0c f8 b8 c0 7e 10 88 eb 03 12 be dd 00 77 96 39 99 9c a3 57 4c 3b 09 33 fa 3a ae c4 4b 08>,
     absValidity: 2018-08-28T07:46:26.741Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 4d 19 b7 a5 f4 d7 d5 32>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.15:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 13 0.6153846153846154 1535356046606
connected to auth! from local port 46864
received auth hello!
{ authId: 503, nonce: <Buffer 4a cf c8 54 da 64 46 18> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d7 76 4b d1 1a 3c ff de>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300302,
  cipherKeyVal: <Buffer 1a 65 c2 11 85 e3 36 56 1a 30 93 76 71 b8 41 5a>,
  macKeyVal: <Buffer 27 89 a6 11 66 87 7a d4 c8 6d a2 ca e0 10 d9 d9 91 f3 85 db 30 eb 66 ab 50 e7 6a c6 b3 e5 97 91>,
  absValidity: 2018-08-28T07:47:27.417Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300302,
     cipherKeyVal: <Buffer 1a 65 c2 11 85 e3 36 56 1a 30 93 76 71 b8 41 5a>,
     macKeyVal: <Buffer 27 89 a6 11 66 87 7a d4 c8 6d a2 ca e0 10 d9 d9 91 f3 85 db 30 eb 66 ab 50 e7 6a c6 b3 e5 97 91>,
     absValidity: 2018-08-28T07:47:27.417Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 14 0.5714285714285714 1535356106665
connected to auth! from local port 47126
received auth hello!
{ authId: 503, nonce: <Buffer 7d e4 1b 2d b8 0a 05 80> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 50 60 c4 f2 0d ac 6c c4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300312,
  cipherKeyVal: <Buffer 0c 0f 01 a8 ed 1b 30 33 80 33 f3 39 2d 3d 78 b3>,
  macKeyVal: <Buffer 5d 4f ac a9 6b 8a 7e 29 33 90 b6 bb 48 94 65 00 36 e5 89 a4 c8 57 95 6d 9d b4 7a 35 68 c9 02 47>,
  absValidity: 2018-08-28T07:48:27.454Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300312,
     cipherKeyVal: <Buffer 0c 0f 01 a8 ed 1b 30 33 80 33 f3 39 2d 3d 78 b3>,
     macKeyVal: <Buffer 5d 4f ac a9 6b 8a 7e 29 33 90 b6 bb 48 94 65 00 36 e5 89 a4 c8 57 95 6d 9d b4 7a 35 68 c9 02 47>,
     absValidity: 2018-08-28T07:48:27.454Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 15 0.5333333333333333 1535356166724
connected to auth! from local port 47396
received auth hello!
{ authId: 503, nonce: <Buffer 0b b0 c5 dd 58 59 21 2a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4c d4 68 82 ea 4c 68 f2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300322,
  cipherKeyVal: <Buffer de 40 c3 2d da 7a be 2d 63 b1 7f 8b 35 40 17 ae>,
  macKeyVal: <Buffer f2 68 8c 60 f8 21 8a 9e b3 47 ba 0e be a2 c7 db 97 a1 51 d9 c7 c5 ca a1 3c 05 43 e6 50 d8 d7 9d>,
  absValidity: 2018-08-28T07:49:27.597Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300322,
     cipherKeyVal: <Buffer de 40 c3 2d da 7a be 2d 63 b1 7f 8b 35 40 17 ae>,
     macKeyVal: <Buffer f2 68 8c 60 f8 21 8a 9e b3 47 ba 0e be a2 c7 db 97 a1 51 d9 c7 c5 ca a1 3c 05 43 e6 50 d8 d7 9d>,
     absValidity: 2018-08-28T07:49:27.597Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 16 0.5 1535356226783
connected to auth! from local port 47666
received auth hello!
{ authId: 503, nonce: <Buffer f6 77 ce 3f 22 7c 75 25> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5a 03 80 39 2a ee 1c 17>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300332,
  cipherKeyVal: <Buffer d0 17 1a c0 8a 5d 72 96 aa 16 9f 72 48 92 19 fe>,
  macKeyVal: <Buffer 0d b2 7f a3 eb 21 a3 91 90 f8 ae 68 ee 7d fe ad 0e c8 fa 24 4c a6 aa a4 81 c3 80 2b 68 55 89 37>,
  absValidity: 2018-08-28T07:50:27.546Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300332,
     cipherKeyVal: <Buffer d0 17 1a c0 8a 5d 72 96 aa 16 9f 72 48 92 19 fe>,
     macKeyVal: <Buffer 0d b2 7f a3 eb 21 a3 91 90 f8 ae 68 ee 7d fe ad 0e c8 fa 24 4c a6 aa a4 81 c3 80 2b 68 55 89 37>,
     absValidity: 2018-08-28T07:50:27.546Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 17 0.47058823529411764 1535356286841
connected to auth! from local port 47936
received auth hello!
{ authId: 503, nonce: <Buffer 92 19 f4 d3 06 d6 85 0f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bd 70 00 12 f1 9d 38 6d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300342,
  cipherKeyVal: <Buffer e5 fb b2 98 2a c7 29 3c 40 fa 4d e9 22 a7 be 2a>,
  macKeyVal: <Buffer a8 bb 18 00 d2 6e b9 72 00 39 d2 7c 60 73 f2 56 2a 07 8f 74 55 e0 e4 45 aa 9b 5f 1e ea 6d b2 02>,
  absValidity: 2018-08-28T07:51:27.566Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300342,
     cipherKeyVal: <Buffer e5 fb b2 98 2a c7 29 3c 40 fa 4d e9 22 a7 be 2a>,
     macKeyVal: <Buffer a8 bb 18 00 d2 6e b9 72 00 39 d2 7c 60 73 f2 56 2a 07 8f 74 55 e0 e4 45 aa 9b 5f 1e ea 6d b2 02>,
     absValidity: 2018-08-28T07:51:27.566Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 18 0.4444444444444444 1535356346864
connected to auth! from local port 48198
received auth hello!
{ authId: 503, nonce: <Buffer 27 82 1a 1a d9 ca c0 dc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e1 67 f4 13 df b8 75 08>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300352,
  cipherKeyVal: <Buffer 38 4d bf a3 0c 87 f9 84 c4 4e 15 0b 9a 59 ec fe>,
  macKeyVal: <Buffer 4b 9e 20 11 ac 10 2b d3 1d 10 31 62 7b 2d 60 31 7e 4d df 4c 88 e1 1b 18 f1 7f 15 d5 15 12 f0 7e>,
  absValidity: 2018-08-28T07:52:27.616Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300352,
     cipherKeyVal: <Buffer 38 4d bf a3 0c 87 f9 84 c4 4e 15 0b 9a 59 ec fe>,
     macKeyVal: <Buffer 4b 9e 20 11 ac 10 2b d3 1d 10 31 62 7b 2d 60 31 7e 4d df 4c 88 e1 1b 18 f1 7f 15 d5 15 12 f0 7e>,
     absValidity: 2018-08-28T07:52:27.616Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 19 0.42105263157894735 1535356406922
connected to auth! from local port 48458
received auth hello!
{ authId: 503, nonce: <Buffer a7 8a 26 56 b0 61 25 9f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 57 d4 79 4a 6c 4c d0 6b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300362,
  cipherKeyVal: <Buffer 06 57 ee 66 7f f5 0d 5b 2b 89 1b d7 fe f2 9d 0d>,
  macKeyVal: <Buffer 3d d4 4d 62 1b e0 0e 98 f9 29 c6 8b ec 60 99 ca 2c 2b 68 c4 66 98 4e 63 05 b3 be c8 f0 e6 fb 13>,
  absValidity: 2018-08-28T07:53:27.791Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300362,
     cipherKeyVal: <Buffer 06 57 ee 66 7f f5 0d 5b 2b 89 1b d7 fe f2 9d 0d>,
     macKeyVal: <Buffer 3d d4 4d 62 1b e0 0e 98 f9 29 c6 8b ec 60 99 ca 2c 2b 68 c4 66 98 4e 63 05 b3 be c8 f0 e6 fb 13>,
     absValidity: 2018-08-28T07:53:27.791Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 20 0.4 1535356466955
connected to auth! from local port 48730
received auth hello!
{ authId: 503, nonce: <Buffer a9 29 0d a5 61 16 09 2c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a2 e9 2b 26 c3 cd 3b 9c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300372,
  cipherKeyVal: <Buffer ab bd 06 2f 65 6c d4 21 ae d1 f2 24 88 e2 91 96>,
  macKeyVal: <Buffer f7 f1 e2 ee f8 74 f9 f9 a1 1a 00 e6 5e b2 d9 9f 88 21 bd 9e 78 14 8e c2 64 30 fc b6 78 94 6c d1>,
  absValidity: 2018-08-28T07:54:27.755Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300372,
     cipherKeyVal: <Buffer ab bd 06 2f 65 6c d4 21 ae d1 f2 24 88 e2 91 96>,
     macKeyVal: <Buffer f7 f1 e2 ee f8 74 f9 f9 a1 1a 00 e6 5e b2 d9 9f 88 21 bd 9e 78 14 8e c2 64 30 fc b6 78 94 6c d1>,
     absValidity: 2018-08-28T07:54:27.755Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 21 0.38095238095238093 1535356527012
connected to auth! from local port 48986
received auth hello!
{ authId: 503, nonce: <Buffer f4 e5 df 3e 95 73 1e 16> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3b fd e6 a4 f2 c5 6b e9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300382,
  cipherKeyVal: <Buffer 35 e4 2b 0a 0b 58 18 b1 d2 51 5a 61 79 18 51 4a>,
  macKeyVal: <Buffer d4 2e 44 75 d2 fa 2d 1a 01 7d cb cb 5a 14 9d 9a 97 c5 35 4f a3 58 27 14 10 62 ba 40 bb f7 8c 53>,
  absValidity: 2018-08-28T07:55:27.361Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300382,
     cipherKeyVal: <Buffer 35 e4 2b 0a 0b 58 18 b1 d2 51 5a 61 79 18 51 4a>,
     macKeyVal: <Buffer d4 2e 44 75 d2 fa 2d 1a 01 7d cb cb 5a 14 9d 9a 97 c5 35 4f a3 58 27 14 10 62 ba 40 bb f7 8c 53>,
     absValidity: 2018-08-28T07:55:27.361Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 22 0.36363636363636365 1535356587071
connected to auth! from local port 49250
received auth hello!
{ authId: 503, nonce: <Buffer 63 67 78 46 ee 2a 68 9b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f6 1e 72 32 a3 4f 5d 4d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300392,
  cipherKeyVal: <Buffer 20 cc b3 b8 9e d6 e4 96 34 7f 9e 24 a5 d1 96 72>,
  macKeyVal: <Buffer d1 98 4f aa 09 ea 5b 89 d1 1f 4b f2 8a 9c 90 09 85 47 6b 24 e4 74 ac 58 33 6f 55 be a7 31 98 c0>,
  absValidity: 2018-08-28T07:56:27.825Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300392,
     cipherKeyVal: <Buffer 20 cc b3 b8 9e d6 e4 96 34 7f 9e 24 a5 d1 96 72>,
     macKeyVal: <Buffer d1 98 4f aa 09 ea 5b 89 d1 1f 4b f2 8a 9c 90 09 85 47 6b 24 e4 74 ac 58 33 6f 55 be a7 31 98 c0>,
     absValidity: 2018-08-28T07:56:27.825Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 23 0.34782608695652173 1535356647117
connected to auth! from local port 49510
received auth hello!
{ authId: 503, nonce: <Buffer 9d cb b2 4b 6b 0d ca 41> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d3 9d be f9 ae c6 81 1d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300402,
  cipherKeyVal: <Buffer e5 2e a2 41 c7 db e3 84 6f 6d da 6b d8 0f 91 77>,
  macKeyVal: <Buffer 9e 57 a9 79 59 37 9a bc 26 f6 fe e0 a3 94 fe cf 25 4b e0 2b 2e dc af 0d c4 a5 e6 42 87 e6 dc f7>,
  absValidity: 2018-08-28T07:57:27.881Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300402,
     cipherKeyVal: <Buffer e5 2e a2 41 c7 db e3 84 6f 6d da 6b d8 0f 91 77>,
     macKeyVal: <Buffer 9e 57 a9 79 59 37 9a bc 26 f6 fe e0 a3 94 fe cf 25 4b e0 2b 2e dc af 0d c4 a5 e6 42 87 e6 dc f7>,
     absValidity: 2018-08-28T07:57:27.881Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 24 0.3333333333333333 1535356707135
connected to auth! from local port 49786
received auth hello!
{ authId: 503, nonce: <Buffer 33 80 b9 d6 4d 7a 95 da> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 51 1a 46 d1 24 91 df 75>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300412,
  cipherKeyVal: <Buffer f9 a4 50 25 4e 8f 7d 91 49 16 6b aa 6e 22 8c d4>,
  macKeyVal: <Buffer 9f 35 d6 e6 f8 8c ba 94 e9 3f 38 6c 0d 64 a9 b6 6e d5 fd 50 55 3c 68 66 f8 1f 30 3b ab 3e 51 df>,
  absValidity: 2018-08-28T07:58:27.933Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300412,
     cipherKeyVal: <Buffer f9 a4 50 25 4e 8f 7d 91 49 16 6b aa 6e 22 8c d4>,
     macKeyVal: <Buffer 9f 35 d6 e6 f8 8c ba 94 e9 3f 38 6c 0d 64 a9 b6 6e d5 fd 50 55 3c 68 66 f8 1f 30 3b ab 3e 51 df>,
     absValidity: 2018-08-28T07:58:27.933Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 25 0.32 1535356767192
connected to auth! from local port 50044
received auth hello!
{ authId: 503, nonce: <Buffer eb 11 eb 3d 5b 53 4f 13> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c0 76 4e d2 b3 5a 80 d8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300422,
  cipherKeyVal: <Buffer ed e9 83 c4 99 b9 5d 99 13 6f b9 bd 25 e0 c6 c7>,
  macKeyVal: <Buffer f8 1b 69 be 7c 31 f4 1c 75 ef 18 af fd a4 df 2d 4b 36 7e d3 70 06 c3 4a 16 25 ed 1e ae 25 99 0d>,
  absValidity: 2018-08-28T07:59:27.964Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300422,
     cipherKeyVal: <Buffer ed e9 83 c4 99 b9 5d 99 13 6f b9 bd 25 e0 c6 c7>,
     macKeyVal: <Buffer f8 1b 69 be 7c 31 f4 1c 75 ef 18 af fd a4 df 2d 4b 36 7e d3 70 06 c3 4a 16 25 ed 1e ae 25 99 0d>,
     absValidity: 2018-08-28T07:59:27.964Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 26 0.3076923076923077 1535356827251
connected to auth! from local port 50314
received auth hello!
{ authId: 503, nonce: <Buffer 75 47 d1 ef 13 24 90 24> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 08 90 0f b0 7a e7 6a a4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300432,
  cipherKeyVal: <Buffer d2 9c 00 cc d1 49 2f ab fa 45 3d f7 65 b3 95 d0>,
  macKeyVal: <Buffer a6 ef 5e dc 88 89 ee 67 2f 11 de 41 59 24 60 08 ff 7c e2 3b 7a 4d ed 7a 7e 02 5d 51 32 b6 a8 82>,
  absValidity: 2018-08-28T08:00:27.995Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300432,
     cipherKeyVal: <Buffer d2 9c 00 cc d1 49 2f ab fa 45 3d f7 65 b3 95 d0>,
     macKeyVal: <Buffer a6 ef 5e dc 88 89 ee 67 2f 11 de 41 59 24 60 08 ff 7c e2 3b 7a 4d ed 7a 7e 02 5d 51 32 b6 a8 82>,
     absValidity: 2018-08-28T08:00:27.995Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 27 0.2962962962962963 1535356887308
connected to auth! from local port 50580
received auth hello!
{ authId: 503, nonce: <Buffer 74 fc 1f 14 ea 5c db a0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 08 91 f8 4d a5 6b 3b fa>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300442,
  cipherKeyVal: <Buffer b2 81 ab 2c 87 55 b9 cb 52 bd a4 fd 87 0e b5 27>,
  macKeyVal: <Buffer 8c d5 32 8a 89 5a b7 87 ed d7 55 19 cc 19 fb 85 bf 88 fa 9a 77 e5 22 63 07 f4 fb e5 da 20 c7 5a>,
  absValidity: 2018-08-28T08:01:28.057Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300442,
     cipherKeyVal: <Buffer b2 81 ab 2c 87 55 b9 cb 52 bd a4 fd 87 0e b5 27>,
     macKeyVal: <Buffer 8c d5 32 8a 89 5a b7 87 ed d7 55 19 cc 19 fb 85 bf 88 fa 9a 77 e5 22 63 07 f4 fb e5 da 20 c7 5a>,
     absValidity: 2018-08-28T08:01:28.057Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 28 0.2857142857142857 1535356947368
connected to auth! from local port 50846
received auth hello!
{ authId: 503, nonce: <Buffer f5 7c 43 fd 68 ee 60 3a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer eb fb ef 18 01 05 e7 c0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300452,
  cipherKeyVal: <Buffer 89 b1 e6 04 ce d3 08 ab a7 6d 28 6a 95 6d c4 93>,
  macKeyVal: <Buffer 52 b2 57 45 59 93 ff 67 86 78 ba 83 33 4b 37 da d5 91 c9 fe e8 f2 17 e9 76 53 ee 7d 6c fe be 0c>,
  absValidity: 2018-08-28T08:02:28.113Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300452,
     cipherKeyVal: <Buffer 89 b1 e6 04 ce d3 08 ab a7 6d 28 6a 95 6d c4 93>,
     macKeyVal: <Buffer 52 b2 57 45 59 93 ff 67 86 78 ba 83 33 4b 37 da d5 91 c9 fe e8 f2 17 e9 76 53 ee 7d 6c fe be 0c>,
     absValidity: 2018-08-28T08:02:28.113Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
