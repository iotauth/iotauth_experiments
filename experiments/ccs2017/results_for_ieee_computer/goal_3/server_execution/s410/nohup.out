changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s410.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's410',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 41 49 42 41 41 4b 43 41 51 45 41 39 63 ... > }
Handler: listening on port 22100
s410:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200059
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51474
received auth hello!
{ authId: 402, nonce: <Buffer 6f 36 f2 83 e8 66 80 55> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 15 39 66 b4 6b 58 31 80>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 9b 28 1b df 70 81 0d 15 0c a1 80 88 f6 14 cb b0>,
  macKeyVal: <Buffer 65 23 bb 58 f6 84 7f b0 60 7d 6f 77 71 43 3e 4e 4c 1e 0c c3 0b 76 31 a7 da 2b 8a a5 b5 ed 5d 5e>,
  absValidity: 2018-08-27T08:35:31.760Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 25 03 f8 98 32 e6 44 02>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 25 03 f8 98 32 e6 44 02> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.53:42902',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200066
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51648
received auth hello!
{ authId: 402, nonce: <Buffer 5d dd e5 13 fc 0f a7 56> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 42 ab 75 fe d7 10 65 8a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7d 49 e0 a5 1b 76 12 3b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 7d 49 e0 a5 1b 76 12 3b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.53:43076',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200073
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51920
received auth hello!
{ authId: 402, nonce: <Buffer 59 a5 42 eb 5e 02 69 be> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6a ff 94 96 62 46 c0 f9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bc 7b b6 54 6d 60 79 aa>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer bc 7b b6 54 6d 60 79 aa> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.53:43348',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200080
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52190
received auth hello!
{ authId: 402, nonce: <Buffer 08 ac a5 af 4c 56 e5 32> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6e c0 ba 12 4f c3 ac 79>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 05 3a d8 10 61 ce 60 cf>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 05 3a d8 10 61 ce 60 cf> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.53:43618',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200087
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52460
received auth hello!
{ authId: 402, nonce: <Buffer e1 dd d9 4c d0 a3 16 c3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2a ee aa 4d 80 cc 0a 61>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ff db 3a e5 2a e2 ce 5e>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ff db 3a e5 2a e2 ce 5e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.53:43888',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200094
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52730
received auth hello!
{ authId: 402, nonce: <Buffer b6 1d c1 03 35 54 e5 70> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ca 4d ea dd a9 eb 0a 2e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0c ea 05 e9 3c 0e ad 21>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0c ea 05 e9 3c 0e ad 21> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.53:44158',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200101
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53000
received auth hello!
{ authId: 402, nonce: <Buffer 4c 74 e7 71 cd fe 3a 85> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e9 10 11 6c ad 24 e9 a0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 07 ec a0 12 a5 b5 e3 e7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 07 ec a0 12 a5 b5 e3 e7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.53:44428',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200108
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53266
received auth hello!
{ authId: 402, nonce: <Buffer 04 d0 ca 1b ca cf 64 05> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f4 41 75 f5 c2 bd 6b 49>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer db 1f b0 d8 a5 71 71 87>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer db 1f b0 d8 a5 71 71 87> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.53:44694',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300283
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300293
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 50952
received auth hello!
{ authId: 503, nonce: <Buffer c1 37 da 22 f0 24 f7 f4> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth503',
     commonName: '10.0.1.6' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth402',
     commonName: '10.0.0.2' },
  serial: '01657A4D921F',
  notBefore: 2018-08-27T07:32:08.000Z,
  notAfter: 2018-08-28T07:33:48.000Z,
  subjectHash: '5542437f',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '57:A2:A5:44:F9:8B:AC:E9:1C:D3:1D:81:61:B8:C9:50:57:07:4E:2E',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'BC5D33480D8E7016713911F6B0F0A9131DC7B60A8CB9E1A10BD7543A76CF24678BCCDEF96EAE9DEBCABF978E7789E6CA0C84927254FA399F63769AE55F612D6596ED8937A047D141B0D94354445A0E25D81DE385B8957F9947FECEBCDBC6998D6544DD90F3D3ED8804119CBEF9AD775F3F63F7F6C01396688740867299DD55D2F05ED7417633969B004111F87931929D7463F27FD75E378152650127AE67180E37BB11DC459BB1B15A8A91A3EC4E9A4F409BAB5AD5C90FB833EA0A8D966FFEA0CC1054B7557DF4DC8B1152F7CC89313B4089920237B6D064F37CDE972831ADFD6643D155A4CDB156DC70EE29EC7CAE2C434B3120E75B3A239E854968A41D6A23',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.6' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 503,
  host: '10.0.1.6',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWV6TZIfMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDIxETAPBgNVBAMMCDEwLjAuMC4yMB4XDTE4MDgy\nNzA3MzIwOFoXDTE4MDgyODA3MzM0OFowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMzERMA8GA1UEAwwIMTAuMC4xLjYwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQC8XTNIDY5wFnE5Efaw8KkTHce2Coy54aEL11Q6ds8kZ4vM3vlu\nrp3ryr+XjneJ5soMhJJyVPo5n2N2muVfYS1llu2JN6BH0UGw2UNURFoOJdgd44W4\nlX+ZR/7OvNvGmY1lRN2Q89PtiAQRnL75rXdfP2P39sATlmiHQIZymd1V0vBe10F2\nM5abAEER+Hkxkp10Y/J/1143gVJlASeuZxgON7sR3EWbsbFaipGj7E6aT0Cbq1rV\nyQ+4M+oKjZZv/qDMEFS3VX303IsRUvfMiTE7QImSAje20GTzfN6XKDGt/WZD0VWk\nzbFW3HDuKex8rixDSzEg51s6I56FSWikHWojAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQYwDQYJKoZIhvcNAQELBQADggEBAI88N4Mj21NZsJLhiycfEB9jzdK844n4\nq93aLcb5pgGMbXeEJchupnYCvQ8c4TM778yZ8eXMrII1MgYjFbp45noPxZCSCM/K\n59pISG3gLy+KknKbDNABh0DgUMUXowBnpua2PbOaktLSiHeQLKFqV4kBMGrrpSd5\nEwVzGrYE9PKKnRiLy6JUyVpUZQ2dV8dev31R6c1KH18pIrVJpGV95dpoAWw4dZGD\nicL/vTa9EhjkG9jkg1ur0S3jiYR/j7N15tbi1Vxn8zy90LgQXXrjwo+hmnN0JEn/\nz/NaggrMlFlXj0O/hcqxun/9+NWpu+nctSRAhZM5e1mPrXxKGQAiyyY=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300303
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51204
received auth hello!
{ authId: 503, nonce: <Buffer cc 83 0b 95 d2 e0 79 45> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 48 4f 9f 4e a9 99 f3 a4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 01 91 cc 81 e1 05 8f 2a 70 5b 75 c8 cf 57 c6 67>,
  macKeyVal: <Buffer c2 31 fd d9 c1 ab 8a dd 3a 19 56 08 2f 6c 64 0d 1a 2c 7b 03 5e 81 3c fe d8 dd 1f bd 75 95 0b 5b>,
  absValidity: 2018-08-27T08:47:31.439Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3e 4e 3d 3d 02 6f 3c 6a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3e 4e 3d 3d 02 6f 3c 6a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.53:45934',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300313
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51472
received auth hello!
{ authId: 503, nonce: <Buffer 22 2b 86 9e a7 c8 c2 a4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 18 49 41 73 44 db fd ca>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f9 a6 1d 16 16 55 e8 4d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f9 a6 1d 16 16 55 e8 4d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.53:46202',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300323
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51740
received auth hello!
{ authId: 503, nonce: <Buffer eb 7b 20 35 bf eb 64 ca> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 35 27 e4 fa 4d 5a 46 e9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9c 22 65 36 8f 78 68 f0>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 9c 22 65 36 8f 78 68 f0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.53:46470',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300333
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52006
received auth hello!
{ authId: 503, nonce: <Buffer b1 3f 7d 74 79 c8 79 ef> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7e 34 b2 58 2f 2b 0d e5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ed 39 6b c7 f6 14 a9 a8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ed 39 6b c7 f6 14 a9 a8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.53:46736',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300343
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52272
received auth hello!
{ authId: 503, nonce: <Buffer a8 b7 dc 3f 7d 60 8b e1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3c 61 63 e8 ab 9e a9 81>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fc a7 4c 43 f3 d8 a8 ed>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fc a7 4c 43 f3 d8 a8 ed> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.53:47002',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300353
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52534
received auth hello!
{ authId: 503, nonce: <Buffer f7 a6 27 eb d4 fb 19 20> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 66 aa d3 64 4c 15 a1 0b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2c 55 73 c6 79 78 19 5f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2c 55 73 c6 79 78 19 5f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.53:47264',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300363
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52800
received auth hello!
{ authId: 503, nonce: <Buffer 07 c1 b6 ca 23 79 e4 7b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e3 8e cd 90 b1 dd 20 e0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c7 df 32 23 a2 ed d1 42>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c7 df 32 23 a2 ed d1 42> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.53:47530',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300373
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53066
received auth hello!
{ authId: 503, nonce: <Buffer eb 62 2c fc 50 60 af 92> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 79 47 59 a2 f2 92 53 c6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8a c8 f6 7c fb 2f 2f 2b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8a c8 f6 7c fb 2f 2f 2b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.53:47796',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300383
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53328
received auth hello!
{ authId: 503, nonce: <Buffer 1d c1 72 08 f4 82 8e 74> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 41 e6 57 5e 7e f1 e1 41>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 59 4e 70 da 8d f5 65 2c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 59 4e 70 da 8d f5 65 2c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.53:48058',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300393
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53590
received auth hello!
{ authId: 503, nonce: <Buffer 72 28 ef af 08 92 8c bc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 38 12 98 7f ec bf f4 a6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9f fb bd 8c 3f d8 d9 02>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9f fb bd 8c 3f d8 d9 02> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.53:48320',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300403
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53856
received auth hello!
{ authId: 503, nonce: <Buffer 7e a4 27 c3 a5 bc 76 bb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 76 fd 43 19 92 14 0e cf>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c4 07 34 03 ff 5d cd 58>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c4 07 34 03 ff 5d cd 58> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.53:48586',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300413
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54122
received auth hello!
{ authId: 503, nonce: <Buffer e1 64 d1 57 2d de 7a 64> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7c 25 9b e6 e6 1f d4 aa>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 27 03 9d a0 bc 42 5e 81>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 27 03 9d a0 bc 42 5e 81> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.53:48852',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300423
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54388
received auth hello!
{ authId: 503, nonce: <Buffer dc c4 cb 9c 7a 4a 09 6c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d8 8c 90 b0 b3 d4 dc 84>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ad b5 e4 52 50 03 e6 09>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ad b5 e4 52 50 03 e6 09> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.53:49118',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300433
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54654
received auth hello!
{ authId: 503, nonce: <Buffer 59 46 fa ec 99 e0 8c f1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 92 11 d3 fc d6 da 34 9b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a4 4c e0 35 6f 99 db f0>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer a4 4c e0 35 6f 99 db f0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.53:49384',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300443
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54920
received auth hello!
{ authId: 503, nonce: <Buffer 97 e9 12 3a 5c 11 82 22> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2e a1 9e 80 6a 66 3a 28>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 11 e3 17 b6 38 59 d5 32>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 11 e3 17 b6 38 59 d5 32> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.53:49650',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300453
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55186
received auth hello!
{ authId: 503, nonce: <Buffer d8 4d 46 21 93 74 79 ed> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3d 18 ec e7 8b 95 01 54>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5c 47 06 ab 22 39 45 96>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5c 47 06 ab 22 39 45 96> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.53:49916',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
