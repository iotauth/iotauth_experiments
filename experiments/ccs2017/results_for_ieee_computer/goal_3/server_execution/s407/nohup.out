changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s407.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's407',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 77 48 ... > }
Handler: listening on port 22100
s407:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200057
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40674
received auth hello!
{ authId: 402, nonce: <Buffer 87 67 e1 ae 0d b2 e4 de> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 21 58 c6 dd 3b 96 20 b2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 90 1d c3 c6 b7 32 8f 70 65 50 8a 46 73 48 a7 da>,
  macKeyVal: <Buffer 6a 2d 31 2b 44 e4 f3 c5 05 86 d2 f0 e1 c2 c8 26 af 0e 2e c3 bd 10 8c 44 98 6c b0 27 d7 e4 b7 fc>,
  absValidity: 2018-08-27T08:35:23.762Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 78 5a 55 4a dc f4 5e 4b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 78 5a 55 4a dc f4 5e 4b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.51:32898',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200064
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40836
received auth hello!
{ authId: 402, nonce: <Buffer cb 19 3b 51 4d 2f 36 48> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f1 3d 06 ff 23 25 f3 20>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 64 a7 61 82 27 4a 5f 5d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 64 a7 61 82 27 4a 5f 5d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.51:33060',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200071
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41104
received auth hello!
{ authId: 402, nonce: <Buffer c5 1d 8c c8 a3 72 a4 1a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 08 8e a5 23 a3 68 dd 0e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fe c9 c6 d4 85 32 98 69>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer fe c9 c6 d4 85 32 98 69> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.51:33328',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200078
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41374
received auth hello!
{ authId: 402, nonce: <Buffer 90 d5 d0 bd 48 90 91 1a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 08 bb 60 18 ec 77 64 ca>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 45 e9 c8 82 e4 09 23 15>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 45 e9 c8 82 e4 09 23 15> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.51:33598',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200085
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41644
received auth hello!
{ authId: 402, nonce: <Buffer c7 a0 e1 86 ff cf 63 a9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 43 42 36 df d9 c6 46 03>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1a cc 34 bb 86 f3 24 25>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1a cc 34 bb 86 f3 24 25> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.51:33868',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200092
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41914
received auth hello!
{ authId: 402, nonce: <Buffer 14 66 ff ff 75 70 21 6c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 79 08 d0 75 28 65 8f 9d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 59 5a d8 a9 b7 43 c4 ce>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 59 5a d8 a9 b7 43 c4 ce> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.51:34138',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200099
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42184
received auth hello!
{ authId: 402, nonce: <Buffer 99 44 36 4f fd 2c ed d0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0e 20 01 80 c0 41 36 a9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 72 ce 7f 3a 7f 74 41 49>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 72 ce 7f 3a 7f 74 41 49> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.51:34408',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200106
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42454
received auth hello!
{ authId: 402, nonce: <Buffer 1c bd 7d e1 12 d8 10 9d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 85 13 48 2b c3 3d 5b b0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 18 2b 16 bd 2f 20 34 2d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 18 2b 16 bd 2f 20 34 2d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.51:34678',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300281
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300291
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 59688
received auth hello!
{ authId: 503, nonce: <Buffer 60 1a 7a 4c 41 54 c6 32> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth503',
     commonName: '10.0.1.6' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth402',
     commonName: '10.0.0.2' },
  serial: '01657A4D921F',
  notBefore: 2018-08-27T07:32:08.000Z,
  notAfter: 2018-08-28T07:33:48.000Z,
  subjectHash: '5542437f',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '57:A2:A5:44:F9:8B:AC:E9:1C:D3:1D:81:61:B8:C9:50:57:07:4E:2E',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'BC5D33480D8E7016713911F6B0F0A9131DC7B60A8CB9E1A10BD7543A76CF24678BCCDEF96EAE9DEBCABF978E7789E6CA0C84927254FA399F63769AE55F612D6596ED8937A047D141B0D94354445A0E25D81DE385B8957F9947FECEBCDBC6998D6544DD90F3D3ED8804119CBEF9AD775F3F63F7F6C01396688740867299DD55D2F05ED7417633969B004111F87931929D7463F27FD75E378152650127AE67180E37BB11DC459BB1B15A8A91A3EC4E9A4F409BAB5AD5C90FB833EA0A8D966FFEA0CC1054B7557DF4DC8B1152F7CC89313B4089920237B6D064F37CDE972831ADFD6643D155A4CDB156DC70EE29EC7CAE2C434B3120E75B3A239E854968A41D6A23',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.6' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 503,
  host: '10.0.1.6',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWV6TZIfMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDIxETAPBgNVBAMMCDEwLjAuMC4yMB4XDTE4MDgy\nNzA3MzIwOFoXDTE4MDgyODA3MzM0OFowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMzERMA8GA1UEAwwIMTAuMC4xLjYwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQC8XTNIDY5wFnE5Efaw8KkTHce2Coy54aEL11Q6ds8kZ4vM3vlu\nrp3ryr+XjneJ5soMhJJyVPo5n2N2muVfYS1llu2JN6BH0UGw2UNURFoOJdgd44W4\nlX+ZR/7OvNvGmY1lRN2Q89PtiAQRnL75rXdfP2P39sATlmiHQIZymd1V0vBe10F2\nM5abAEER+Hkxkp10Y/J/1143gVJlASeuZxgON7sR3EWbsbFaipGj7E6aT0Cbq1rV\nyQ+4M+oKjZZv/qDMEFS3VX303IsRUvfMiTE7QImSAje20GTzfN6XKDGt/WZD0VWk\nzbFW3HDuKex8rixDSzEg51s6I56FSWikHWojAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQYwDQYJKoZIhvcNAQELBQADggEBAI88N4Mj21NZsJLhiycfEB9jzdK844n4\nq93aLcb5pgGMbXeEJchupnYCvQ8c4TM778yZ8eXMrII1MgYjFbp45noPxZCSCM/K\n59pISG3gLy+KknKbDNABh0DgUMUXowBnpua2PbOaktLSiHeQLKFqV4kBMGrrpSd5\nEwVzGrYE9PKKnRiLy6JUyVpUZQ2dV8dev31R6c1KH18pIrVJpGV95dpoAWw4dZGD\nicL/vTa9EhjkG9jkg1ur0S3jiYR/j7N15tbi1Vxn8zy90LgQXXrjwo+hmnN0JEn/\nz/NaggrMlFlXj0O/hcqxun/9+NWpu+nctSRAhZM5e1mPrXxKGQAiyyY=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300301
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59942
received auth hello!
{ authId: 503, nonce: <Buffer 34 e6 bb 56 a1 f7 a4 4e> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer ca c6 c8 b8 80 76 8f 9d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 8f 11 89 5d b2 1a 2e 8b 48 75 cf fc 99 2a ad f7>,
  macKeyVal: <Buffer 42 ac 0c a3 8a 39 4f b1 b8 57 5e dc 72 51 55 91 9b 93 61 99 d2 16 aa 51 b8 22 2d 3d 49 e5 23 13>,
  absValidity: 2018-08-27T08:47:25.416Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d5 a8 0f 59 24 37 18 90>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer d5 a8 0f 59 24 37 18 90> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.51:35908',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300311
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60206
received auth hello!
{ authId: 503, nonce: <Buffer ba 77 70 d6 94 a4 9c 86> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 16 c6 aa fe 26 a7 6f bf>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 83 c5 12 7b 10 ba 8c 82>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 83 c5 12 7b 10 ba 8c 82> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.51:36174',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300321
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60476
received auth hello!
{ authId: 503, nonce: <Buffer 56 59 66 8f a4 68 cd 7f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2b 99 84 46 ec ce 8e 5d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ae 5d 55 3f e1 0e bb cf>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ae 5d 55 3f e1 0e bb cf> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.51:36444',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300331
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60746
received auth hello!
{ authId: 503, nonce: <Buffer 89 fe 3d 66 57 64 27 4e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e0 4f 5c 41 03 e4 8d 3d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4f 2a fa 4e f1 61 f5 31>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4f 2a fa 4e f1 61 f5 31> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.51:36712',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300341
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 32782
received auth hello!
{ authId: 503, nonce: <Buffer 76 18 c2 df 30 68 0d 35> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 83 8e 16 b8 aa a2 6e bd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 72 ad 91 11 08 ab 44 00>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 72 ad 91 11 08 ab 44 00> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.51:36980',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300351
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33046
received auth hello!
{ authId: 503, nonce: <Buffer 3c 0a 0e f5 ff fa 8c 95> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8b 21 06 f7 95 73 b6 2e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c8 d1 b9 93 4b b1 56 b6>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c8 d1 b9 93 4b b1 56 b6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.51:37244',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300361
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33304
received auth hello!
{ authId: 503, nonce: <Buffer ad 02 a6 a6 84 23 af 5c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 62 fe c6 40 8c d4 83 7a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c5 3b 06 23 19 12 4d 4a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c5 3b 06 23 19 12 4d 4a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.51:37504',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300371
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33578
received auth hello!
{ authId: 503, nonce: <Buffer 50 4e af c5 d0 bf 9a a3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 02 1a 0c b3 c1 a3 08 8e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b5 44 37 43 c6 b1 0b a6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b5 44 37 43 c6 b1 0b a6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.51:37778',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300381
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33832
received auth hello!
{ authId: 503, nonce: <Buffer c0 82 d8 a4 f8 6f cd 91> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0f 4c bc 81 c4 fc 7d 8b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b6 bb f3 4c 87 f7 d0 20>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b6 bb f3 4c 87 f7 d0 20> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.51:38032',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300391
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34094
received auth hello!
{ authId: 503, nonce: <Buffer 20 e6 97 99 cb d6 b7 78> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f2 c5 a8 8d 07 84 1f af>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer dc 44 94 15 64 ee d0 b9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer dc 44 94 15 64 ee d0 b9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.51:38294',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300401
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34356
received auth hello!
{ authId: 503, nonce: <Buffer 60 0a 0d 32 d6 bf 03 2f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c0 33 7b 5f 20 fb 4a f3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e8 6e 3e f5 34 18 c5 ed>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e8 6e 3e f5 34 18 c5 ed> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.51:38556',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300411
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34630
received auth hello!
{ authId: 503, nonce: <Buffer e7 3e 9d f8 3d 10 42 32> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5b 4f a9 9c 85 ab 29 8c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3d 52 da 7f 1b 09 46 ba>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3d 52 da 7f 1b 09 46 ba> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.51:38830',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300421
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34888
received auth hello!
{ authId: 503, nonce: <Buffer 31 e7 69 10 a5 0e b4 a7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 34 f7 f2 0a 4f 5a c1 17>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f5 b2 c2 43 04 bb 7b 71>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f5 b2 c2 43 04 bb 7b 71> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.51:39088',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300431
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35162
received auth hello!
{ authId: 503, nonce: <Buffer 94 f7 65 c1 85 8d 1f 94> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 49 f1 02 21 e4 4d 65 ad>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 63 28 39 b9 3a b5 6d 15>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 63 28 39 b9 3a b5 6d 15> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.51:39362',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300441
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35432
received auth hello!
{ authId: 503, nonce: <Buffer 11 89 d3 64 f4 d7 43 78> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9a 77 6e c8 e5 56 d3 a9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e4 a2 91 67 99 d5 4f 9f>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e4 a2 91 67 99 d5 4f 9f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.51:39630',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300451
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35694
received auth hello!
{ authId: 503, nonce: <Buffer 4e b9 d4 1e f3 6a 4f 1a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 26 75 c4 7f c4 a3 1f cb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b4 07 4a 22 84 b5 4e 0d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b4 07 4a 22 84 b5 4e 0d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.51:39892',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
