changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s501.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's501',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 71 50 ... > }
Handler: listening on port 22100
s501:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100056
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50492
received auth hello!
{ authId: 501, nonce: <Buffer fc bd a7 74 9c aa 9d f3> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer fb d4 a6 e4 6d e4 98 53>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer db f9 ab 12 b2 5f 4b 7b 6f 47 91 58 57 8a 06 47>,
  macKeyVal: <Buffer 1e 35 68 a0 f4 a3 ae c4 1d fd 84 1c 61 2d f1 9e e8 cf 3e 83 b3 27 0c 9b 7b db 1e 98 99 83 9e 0a>,
  absValidity: 2018-08-27T08:35:59.511Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e7 27 ab e6 82 35 fa ed>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e7 27 ab e6 82 35 fa ed> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.62:58118',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100064
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50722
received auth hello!
{ authId: 501, nonce: <Buffer a6 56 5e 1d 47 35 fd 70> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 51 10 41 fd 45 93 c8 43>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 17 b5 9a 3c 55 25 36 46>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 17 b5 9a 3c 55 25 36 46> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.62:58348',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100072
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50992
received auth hello!
{ authId: 501, nonce: <Buffer 1a e3 0b 0c cd f6 a7 80> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 44 c2 b6 77 7a ed 4c ab>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1c 40 ba 62 15 1c 3f 34>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1c 40 ba 62 15 1c 3f 34> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.62:58618',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100080
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51262
received auth hello!
{ authId: 501, nonce: <Buffer cb b2 8d 44 eb b5 cc d2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d1 1f 06 b1 7c 83 09 27>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6d 51 10 72 e3 d7 c1 87>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6d 51 10 72 e3 d7 c1 87> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.62:58888',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100088
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51532
received auth hello!
{ authId: 501, nonce: <Buffer 14 69 fe c4 db bd 91 e4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9d 09 31 ad 08 7a a5 fd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f9 b8 1a 1b 1f d8 81 21>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f9 b8 1a 1b 1f d8 81 21> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.62:59156',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100096
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51802
received auth hello!
{ authId: 501, nonce: <Buffer 47 50 65 f8 f0 aa 9a 18> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a6 ab 67 bb c4 a1 bc ac>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8e 41 7d db e9 9b 40 ea>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8e 41 7d db e9 9b 40 ea> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.62:59426',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100104
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52072
received auth hello!
{ authId: 501, nonce: <Buffer 7a f0 3f 8a 76 fa de bd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f2 af b6 83 98 92 9f 63>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0e 2c d8 ed 12 f2 a6 aa>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0e 2c d8 ed 12 f2 a6 aa> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.62:59696',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200386
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200399
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 47208
received auth hello!
{ authId: 502, nonce: <Buffer 76 d3 f5 51 05 4b de ed> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '01657A4D9544',
  notBefore: 2018-08-27T07:32:09.000Z,
  notAfter: 2018-08-28T07:33:49.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'B2:55:63:B2:CE:CE:BC:2B:E5:03:A0:2E:DE:CD:0F:1B:08:28:38:82',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'E67D8D8DE1FDDD2C2465EAD2E2C8469468E30C862129741C44CD759698CE97A1EBFCBA21D764D410591EE7063D4A632FD29AD3449C9B0DFBC9FF499E509A0969E40EA76C3AE2863ACBBC992A983F178890D4B1E505497F0A52900EFB38BDD51ED38CC446055817F90C1C892D25C947EE3AE8A8349A59E52B167953D94E0FB0082EE1A41137CB068ACD59E4752201F98ECA9664AD60B18C32213DF2545F63BF81939F78FABD925C71CDEE8114C56A96C1A70FD25E90066AB4026471D8372D30665DAC9B54EC472D58F09A4903599BC5D9C556B25898BAB963E93DFAC900B67CF7D3E060D71817CE9CF36D42A16F7BA93CBD3440B1A754DA038A8AD0D4430E66E7',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWV6TZVEMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDgy\nNzA3MzIwOVoXDTE4MDgyODA3MzM0OVowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDmfY2N4f3dLCRl6tLiyEaUaOMMhiEpdBxEzXWWmM6Xoev8uiHX\nZNQQWR7nBj1KYy/SmtNEnJsN+8n/SZ5Qmglp5A6nbDrihjrLvJkqmD8XiJDUseUF\nSX8KUpAO+zi91R7TjMRGBVgX+QwciS0lyUfuOuioNJpZ5SsWeVPZTg+wCC7hpBE3\nywaKzVnkdSIB+Y7KlmStYLGMMiE98lRfY7+Bk594+r2SXHHN7oEUxWqWwacP0l6Q\nBmq0AmRx2DctMGZdrJtU7EctWPCaSQNZm8XZxVayWJi6uWPpPfrJALZ899PgYNcY\nF86c821CoW97qTy9NECxp1TaA4qK0NRDDmbnAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAHbnTxSYqKT1lp2E4+P5twSR17jQjT8t\n9p7Fial6P8NhPiEIU67pO2RSLTESTiHGtYU1kIRxWxFp3KUxbrkdUeluUluYkmwL\nqHilSf3rVR8oNt0gxn8TcWSqkFag9lsj1T/1rB/m5gRrA7Jy+GxX1RTvwGlAnkIu\nlG1j9GFg1x6JB5kwB6ibzz7nA+ibA8PX08CcKHRD2BRnYbmnNJp9JX7TbQBWXGHT\nV6jPBxsO6ogkPRLjgHn9+RrqX6OS+Sz112CTa+FfyG+97tu7m46TYKmN6+1cVLpl\nhxf26RTDcnD/p1+sBSmGeeHO2IbsSkRMvdqGQpaK7NfL4uYEikMQs2w=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200412
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47482
received auth hello!
{ authId: 502, nonce: <Buffer 5e de f6 46 15 e6 b5 6d> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer ea 8d 92 d5 c5 4f 45 35>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer a9 3a 94 b5 40 b5 07 ae 3b 64 e4 3f 9a 08 3f 9b>,
  macKeyVal: <Buffer da 28 dd c3 da 5e 37 80 3c 83 a9 20 14 1f 25 16 d0 3f e8 97 02 d3 42 2c dd d8 8c 29 13 ee ce 3e>,
  absValidity: 2018-08-27T08:47:03.411Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b7 e3 1d 2f 32 74 f1 b0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b7 e3 1d 2f 32 74 f1 b0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.62:60938',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200425
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47762
received auth hello!
{ authId: 502, nonce: <Buffer 4f 26 97 99 80 d6 bb 0f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0b c3 9f b0 f7 0a a4 5c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2b 42 ef 4b 19 68 10 1b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 2b 42 ef 4b 19 68 10 1b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.62:32986',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200438
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48030
received auth hello!
{ authId: 502, nonce: <Buffer 76 b3 8b 64 e9 dc 12 e9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8b 48 5d 37 46 05 87 70>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2c 31 ee 63 af 2a a4 4a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2c 31 ee 63 af 2a a4 4a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.62:33252',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200451
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48298
received auth hello!
{ authId: 502, nonce: <Buffer 02 5e 91 63 91 84 5f 6e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d4 c3 6d 86 96 01 cb a1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 95 18 fe 26 ff 41 65 28>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 95 18 fe 26 ff 41 65 28> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.62:33524',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200464
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48548
received auth hello!
{ authId: 502, nonce: <Buffer cd 7a a9 b6 c5 0f 81 78> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fe 1d 03 87 0d 1b 54 ea>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 79 ae 6b 9a b9 3d 1f d9>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 79 ae 6b 9a b9 3d 1f d9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.62:33772',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200477
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48812
received auth hello!
{ authId: 502, nonce: <Buffer 07 04 5c 04 d6 30 b5 6a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 20 34 67 d8 e7 f9 43 a4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c4 70 7f 2c b8 77 cd 3e>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c4 70 7f 2c b8 77 cd 3e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.62:34038',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200490
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49074
received auth hello!
{ authId: 502, nonce: <Buffer 3e 0c c3 69 0a 78 4c 7b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f0 ed 51 79 e4 a2 e6 4d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 85 77 38 1a 5f 07 b3 40>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 85 77 38 1a 5f 07 b3 40> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.62:34300',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200503
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49340
received auth hello!
{ authId: 502, nonce: <Buffer 6a fd 60 72 94 ab 15 94> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 44 8b 92 6c e1 cc 90 42>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 62 3f fe 69 fa de 51 c6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 62 3f fe 69 fa de 51 c6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.62:34566',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200516
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49606
received auth hello!
{ authId: 502, nonce: <Buffer f3 4e 83 45 17 fb c1 f4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f1 f5 52 c5 48 ba 30 1b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 93 a2 1e 4d 83 9d 51 96>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 93 a2 1e 4d 83 9d 51 96> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.62:34832',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200529
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49872
received auth hello!
{ authId: 502, nonce: <Buffer 02 5c 26 21 cc 60 fc 18> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 18 f9 b3 8d eb de 7d 9d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f5 c2 47 67 7f 59 a4 2d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f5 c2 47 67 7f 59 a4 2d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.62:35094',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200542
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50138
received auth hello!
{ authId: 502, nonce: <Buffer d0 d7 72 27 d7 25 e9 ac> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 12 d7 2c 17 f2 ee 7d cf>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f3 df 31 b1 4c 0a 60 31>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f3 df 31 b1 4c 0a 60 31> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.62:35362',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200555
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50412
received auth hello!
{ authId: 502, nonce: <Buffer d9 6e 33 a7 84 2a 99 f0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6b 35 a3 48 df f1 57 fe>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f4 7f a0 f5 47 a4 f3 26>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f4 7f a0 f5 47 a4 f3 26> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.62:35636',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200568
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50662
received auth hello!
{ authId: 502, nonce: <Buffer c5 6b 98 7b 21 9a ae b7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 57 4f 5d 85 b6 05 91 4f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0e cc fd 7f 5d f2 60 e0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0e cc fd 7f 5d f2 60 e0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.62:35888',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200581
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50944
received auth hello!
{ authId: 502, nonce: <Buffer 53 a6 fc a8 f2 9f a7 13> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ba dc 76 94 9a aa 8c 6b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 71 5a e6 11 48 15 ce 11>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 71 5a e6 11 48 15 ce 11> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.62:36168',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200594
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51194
received auth hello!
{ authId: 502, nonce: <Buffer 68 5c 8c 9e 0d 4a 31 68> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0d 32 e7 53 e7 0f 3c 58>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 06 91 c4 fb 57 f5 01 8b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 06 91 c4 fb 57 f5 01 8b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.62:36420',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200607
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51460
received auth hello!
{ authId: 502, nonce: <Buffer d6 fe b8 d9 f8 b2 2c 34> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6e 3e 54 fe 52 1b 23 c0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 66 69 f6 91 f4 ca 32 13>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 66 69 f6 91 f4 ca 32 13> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.62:36686',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200620
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51720
received auth hello!
{ authId: 502, nonce: <Buffer 09 e2 57 a3 f5 a4 e1 09> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5f 6d ea 9c 37 15 8c dd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ff 39 dd 8e 41 6d ec e9>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ff 39 dd 8e 41 6d ec e9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.62:36946',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
