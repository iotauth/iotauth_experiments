changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s506.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's506',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 72 75 ... > }
Handler: listening on port 22100
s506:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100062
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41736
received auth hello!
{ authId: 501, nonce: <Buffer f9 a6 9d a1 ac b7 8d 0a> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 96 d7 ae dc d3 07 cd 1a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 9d bb 97 15 b6 9f 6b 3d 53 6b 7a d6 ee 02 04 4f>,
  macKeyVal: <Buffer b5 0b 73 78 85 52 02 44 4a f0 03 4e ef 92 40 1d cd 51 72 07 88 93 67 63 0c 62 b2 70 ae 1a d1 43>,
  absValidity: 2018-08-27T08:36:26.292Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c6 a3 f2 d4 86 18 94 52>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c6 a3 f2 d4 86 18 94 52> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.70:41270',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100070
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42008
received auth hello!
{ authId: 501, nonce: <Buffer d0 2b 38 05 1a ee 87 9b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1d 66 47 c9 ca 0d 87 09>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cf da 19 22 cb a2 f6 8f>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer cf da 19 22 cb a2 f6 8f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.70:41540',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100078
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42278
received auth hello!
{ authId: 501, nonce: <Buffer e3 f1 33 9e d7 5b 7f 1a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 96 6f 62 95 14 ce 11 c3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 02 4e 8a b8 cc d9 26 df>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 02 4e 8a b8 cc d9 26 df> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.70:41812',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100086
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42546
received auth hello!
{ authId: 501, nonce: <Buffer eb ae d3 01 9d a2 9d a1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 46 a6 be 18 1e ad 85 ed>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c9 67 b4 6f 4b 08 ce 68>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c9 67 b4 6f 4b 08 ce 68> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.70:42078',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100094
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42816
received auth hello!
{ authId: 501, nonce: <Buffer 9d e3 65 3e 52 d7 df 4a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 92 19 04 b3 e8 e0 2e 58>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 38 2b 86 3e 6d 76 1c f8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 38 2b 86 3e 6d 76 1c f8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.70:42348',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100102
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43086
received auth hello!
{ authId: 501, nonce: <Buffer 3a ee 33 cd 5f a7 8b 33> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 45 b3 92 f0 06 01 7b 60>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6b 14 ec 21 01 d3 95 c0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6b 14 ec 21 01 d3 95 c0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.70:42618',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100110
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43354
received auth hello!
{ authId: 501, nonce: <Buffer 39 39 dd 32 da 86 80 8a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f6 88 9d 3f 15 ee 36 9c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 56 68 b7 5b cb a0 42 38>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 56 68 b7 5b cb a0 42 38> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.70:42888',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300112
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300123
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 35110
received auth hello!
{ authId: 403, nonce: <Buffer 3a 55 1f dc 98 91 9b 4d> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth403',
     commonName: '10.0.1.3' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '01657A4D94D2',
  notBefore: 2018-08-27T07:32:09.000Z,
  notAfter: 2018-08-28T07:33:49.000Z,
  subjectHash: 'f6675d02',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'CB:14:80:5C:D2:62:15:8E:E8:3E:DE:4E:36:BC:B2:2C:48:1E:1C:74',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'EFEF26346AAE5741ADEB124056A798E491B6F7B2450C6EBF522745B81E49BD02A1DF7AA4AE58436E10AA9F4D23985C66AEACFEB6030BCFF3A0C72DCCAC56F6C5E0AE27704A80B4F8BDCE397C0EEC9A07440CDD94EF23BC321CBF42C6CD25B32EB798DE6D40436227E0667853330D7F11311F7F84A32AF2BA5DA4029EFE5D0EAF0736A7A12AEB9AD3C61626E6D77C7393E0EF13C574BD5865E07C83E9DD923500CE16F7DCD607050FB3495B3A5C86A82228B13659761B9F62EDE09F010AB0A2CF51700A9397A73AFCDCAEEF706314D72FF4A1883111DB69179CE487901E9935AB12BB80FDAD7879275724DA3BBD67CB2F51382B08255FDAB105553C066A1CE3B1',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.3' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 403,
  host: '10.0.1.3',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWV6TZTSMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDgy\nNzA3MzIwOVoXDTE4MDgyODA3MzM0OVowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDQwMzERMA8GA1UEAwwIMTAuMC4xLjMwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDv7yY0aq5XQa3rEkBWp5jkkbb3skUMbr9SJ0W4Hkm9AqHfeqSu\nWENuEKqfTSOYXGaurP62AwvP86DHLcysVvbF4K4ncEqAtPi9zjl8DuyaB0QM3ZTv\nI7wyHL9Cxs0lsy63mN5tQENiJ+BmeFMzDX8RMR9/hKMq8rpdpAKe/l0Orwc2p6Eq\n65rTxhYm5td8c5Pg7xPFdL1YZeB8g+ndkjUAzhb33NYHBQ+zSVs6XIaoIiixNll2\nG59i7eCfAQqwos9RcAqTl6c6/Nyu73BjFNcv9KGIMRHbaRec5IeQHpk1qxK7gP2t\neHknVyTaO71nyy9ROCsIJV/asQVVPAZqHOOxAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQMwDQYJKoZIhvcNAQELBQADggEBADhqpxFFJp1BLJsEjn8rYDZn5BQ4llof\njA4NOhP+07R0k3q222oNM12hm+6/q/DuomWsXBGCQSSCOoSI8KOcuAyDHk+QCaAl\nL/pgxHbIaKlwKx/WAX5RBB94aS/wLL3YiWhZ02HTnxjFNCTExBF6HouxxYWs42PB\nK8WVqwqRANe0LbtXqDHthSMSlP+aUy+nk1TtBXh83dmEMqr6117UympLuihvnfP7\n0c81wCLwtyc98Gqynz4MwJHKIxd8hjTxfNUtdR/VN4FSneWvKBlyVgyx0hwvmDyw\nJ/91c7DEv1/ewTYtRgwOlySd1jkQRgEugeMnRSVKG+UofF4cnkFGaX0=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300134
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35370
received auth hello!
{ authId: 403, nonce: <Buffer 7f e1 91 b1 22 5a 1c f5> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 3e fa a0 0c 58 f6 8d 56>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 68 a1 5c 2f 36 e8 99 ec 56 ad 51 9a 90 90 27 19>,
  macKeyVal: <Buffer 59 6f 7e ea f4 61 2d a5 a8 56 f6 0d ee ea 59 97 43 a6 2e 07 fc 24 67 36 e7 93 ae 78 e4 e2 49 c0>,
  absValidity: 2018-08-27T08:47:26.289Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 01 36 66 47 44 44 9d 48>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 01 36 66 47 44 44 9d 48> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.70:44126',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300145
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35630
received auth hello!
{ authId: 403, nonce: <Buffer 15 56 8b 6d 68 8a 2d 3f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a3 25 26 cc 9d a3 cf e5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d7 b9 bc 44 31 2b aa 4c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d7 b9 bc 44 31 2b aa 4c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.70:44384',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300156
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35900
received auth hello!
{ authId: 403, nonce: <Buffer 28 c4 d7 d0 8d da 21 fd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b1 6f 0f e7 cc c4 1a 32>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b6 89 0d 0d 9b d4 bf 23>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b6 89 0d 0d 9b d4 bf 23> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.70:44654',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300167
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36172
received auth hello!
{ authId: 403, nonce: <Buffer 66 7c 5d 8a 9a 45 11 fb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 10 af 72 8e 89 ef a5 a6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 82 44 53 6a 32 85 ee 04>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 82 44 53 6a 32 85 ee 04> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.70:44928',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300178
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36442
received auth hello!
{ authId: 403, nonce: <Buffer d7 c5 c3 ec 8d 3c 39 e4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 66 e7 c2 07 d1 7a 08 2c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 59 43 1e 5a d2 79 d7 c6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 59 43 1e 5a d2 79 d7 c6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.70:45198',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300189
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36704
received auth hello!
{ authId: 403, nonce: <Buffer 57 06 80 bf eb 04 35 b6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 68 90 b8 49 b8 e3 7a a0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 83 2b 51 5a 34 e6 cb 9d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 83 2b 51 5a 34 e6 cb 9d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.70:45460',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300200
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36964
received auth hello!
{ authId: 403, nonce: <Buffer 0c b2 75 62 1e 89 ee 51> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1b 9d 68 17 d0 f1 a1 81>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9a 58 80 f5 b5 53 d7 7f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9a 58 80 f5 b5 53 d7 7f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.70:45718',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300211
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37234
received auth hello!
{ authId: 403, nonce: <Buffer ac 66 d9 c6 87 74 17 2a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 71 09 98 ff 63 10 5e c3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c1 92 b0 70 8e b6 80 60>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c1 92 b0 70 8e b6 80 60> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.70:45988',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300222
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37488
received auth hello!
{ authId: 403, nonce: <Buffer 92 ee 71 9e 4e 35 6e 07> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3a 89 73 39 7f c0 7c 98>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fd 34 ad 83 f2 d8 a6 10>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fd 34 ad 83 f2 d8 a6 10> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.70:46242',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300233
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37752
received auth hello!
{ authId: 403, nonce: <Buffer de fe f8 a0 3c 5f 5c e3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e3 25 4c d9 bc 0c fb b2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 64 24 8b 1d 22 b5 a8 4f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 64 24 8b 1d 22 b5 a8 4f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.70:46508',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300244
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38010
received auth hello!
{ authId: 403, nonce: <Buffer 11 6a f0 e9 7e 1e a5 99> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a0 3f 08 2e 8e b7 ec 1b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 11 26 e0 48 71 a5 09 90>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 11 26 e0 48 71 a5 09 90> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.70:46766',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300255
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38288
received auth hello!
{ authId: 403, nonce: <Buffer d3 5a c5 30 b7 99 c4 f4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer df fe d0 dd 6a 34 93 4f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ec 87 94 5f 25 28 82 d7>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ec 87 94 5f 25 28 82 d7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.70:47044',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300266
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38548
received auth hello!
{ authId: 403, nonce: <Buffer 8c 39 85 e0 7c 29 81 99> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4d 2b 90 08 97 f5 73 81>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 02 09 6f 47 da f1 99 71>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 02 09 6f 47 da f1 99 71> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.70:47302',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300277
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38816
received auth hello!
{ authId: 403, nonce: <Buffer 3f 75 1c 97 76 19 a7 64> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 00 af 88 3d ea 87 1a 00>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 69 bb 6b 6f 29 7c af 2f>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 69 bb 6b 6f 29 7c af 2f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.70:47572',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300288
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39086
received auth hello!
{ authId: 403, nonce: <Buffer dd 58 dc de 35 17 08 90> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 96 9c 2b f9 48 ad dd af>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2f 79 02 2b 06 c9 fa 5a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2f 79 02 2b 06 c9 fa 5a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.70:47842',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300299
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39352
received auth hello!
{ authId: 403, nonce: <Buffer df e0 eb 21 19 b4 8f 70> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 40 79 e1 3f 21 70 3b cb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d4 46 c0 cf 71 d1 2a c4>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer d4 46 c0 cf 71 d1 2a c4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.70:48108',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300310
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39568
received auth hello!
{ authId: 403, nonce: <Buffer 57 40 56 36 bb 32 59 0b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6f 9e d8 b4 d6 6e 22 73>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fc 7e f0 fd 1a 26 9f db>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fc 7e f0 fd 1a 26 9f db> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.70:48324',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
