changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s413.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's413',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 6c 32 ... > }
Handler: listening on port 22100
s413:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300265
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43222
received auth hello!
{ authId: 403, nonce: <Buffer 2c 2a de 28 4e 04 22 63> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 3e f3 1a e5 40 70 65 1a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 4e 37 12 15 ea 49 8f d2 93 3d 9b d8 c0 48 35 65>,
  macKeyVal: <Buffer 78 11 48 1a bb 6c bd 06 10 b7 7c 63 f9 f7 84 94 c0 69 c7 b7 37 02 34 a2 41 5c f4 c4 66 71 3c b2>,
  absValidity: 2018-08-27T06:58:16.296Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b5 ca fb b6 fa 26 9f 1d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b5 ca fb b6 fa 26 9f 1d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.58:36002',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300271
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43426
received auth hello!
{ authId: 403, nonce: <Buffer 6c bf 3e 41 c5 c5 2e 4f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e9 98 d2 d6 c8 ff 0a ee>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 19 47 77 0a 99 18 e8 34>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 19 47 77 0a 99 18 e8 34> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.58:36206',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300277
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43698
received auth hello!
{ authId: 403, nonce: <Buffer 68 4a 8a 14 55 e3 fc 4a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 23 0c 0d 5d 8a b1 da 1a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 39 d3 73 84 dd de 90 bf>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 39 d3 73 84 dd de 90 bf> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.58:36478',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300283
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43968
received auth hello!
{ authId: 403, nonce: <Buffer dd 3c e6 78 f9 c6 cd b0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c6 48 7a 23 38 b1 f4 8b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c6 14 0d 75 89 95 bf 56>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c6 14 0d 75 89 95 bf 56> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.58:36748',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300289
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44238
received auth hello!
{ authId: 403, nonce: <Buffer 41 57 dd 06 a7 6b 95 a1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 49 bc 17 d7 db f1 48 26>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0a 44 95 ec df d4 7e fb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0a 44 95 ec df d4 7e fb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.58:37018',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300295
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44512
received auth hello!
{ authId: 403, nonce: <Buffer 4f aa ee 2b a4 bc e3 c4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a0 78 34 40 44 e6 4b 93>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 12 af fb ca bb 05 00 47>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 12 af fb ca bb 05 00 47> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.58:37288',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300301
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44812
received auth hello!
{ authId: 403, nonce: <Buffer a0 3e 26 7b fd 36 ca 19> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ac b9 cf 9e 18 83 44 e5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 78 6a ff 3d ac 55 0e e8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 78 6a ff 3d ac 55 0e e8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.58:37592',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300307
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45074
received auth hello!
{ authId: 403, nonce: <Buffer 75 2c 89 51 d2 0f c6 df> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 18 4b b7 31 45 9f ac 1b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 28 89 a2 10 ca 1c e0 aa>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 28 89 a2 10 ca 1c e0 aa> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.58:37854',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
