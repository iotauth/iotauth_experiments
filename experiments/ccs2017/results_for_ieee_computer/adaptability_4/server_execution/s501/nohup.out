changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s501.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's501',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 78 35 ... > }
Handler: listening on port 22100
s501:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100056
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37058
received auth hello!
{ authId: 501, nonce: <Buffer de 76 6a 6b b1 99 24 b8> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer a7 ed 52 ed 23 0b 29 3b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 6d 5f 4c 4d 54 8a 0e 5b 5b 6c 37 ae 1c d6 b0 58>,
  macKeyVal: <Buffer b1 a1 c7 78 d5 66 d1 61 ab 22 65 85 18 a0 4d 14 dc 27 b7 2d d7 09 30 2e b0 e1 69 56 3c 75 62 c1>,
  absValidity: 2018-08-27T06:58:29.406Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1c 9c e7 de a8 be 67 f8>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 1c 9c e7 de a8 be 67 f8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.62:44684',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100064
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37288
received auth hello!
{ authId: 501, nonce: <Buffer 8c a3 7f ab 92 2c 20 1c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 05 2c 68 f7 eb c8 3f 82>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f5 48 b2 33 99 e6 fd f7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f5 48 b2 33 99 e6 fd f7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.62:44912',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100072
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37558
received auth hello!
{ authId: 501, nonce: <Buffer 0c b9 6d b5 21 36 cc ce> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9f e7 56 8d 98 eb 20 a6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 32 40 bb 62 36 65 ad 5c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 32 40 bb 62 36 65 ad 5c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.62:45182',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100080
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37828
received auth hello!
{ authId: 501, nonce: <Buffer 45 59 a9 36 69 57 f5 fb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b7 b2 1d 1f cb c2 20 4c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 08 a0 84 33 26 df 6b 37>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 08 a0 84 33 26 df 6b 37> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.62:45452',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100088
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38098
received auth hello!
{ authId: 501, nonce: <Buffer b3 40 3b 56 aa ee 7e 80> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2e a8 f5 23 5b 68 e6 b4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 32 8b 26 5a b7 90 ab 8f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 32 8b 26 5a b7 90 ab 8f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.62:45722',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100096
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38402
received auth hello!
{ authId: 501, nonce: <Buffer d6 4b 2c e3 77 f5 0f 5c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 44 49 e9 5f 9e 2f 77 ee>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cf e8 fa 61 c6 3c ec c3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer cf e8 fa 61 c6 3c ec c3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.62:46028',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100104
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38672
received auth hello!
{ authId: 501, nonce: <Buffer 34 ce 05 3f 9c a9 93 b4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d2 0b 61 fe d7 fb a8 72>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e9 71 44 e8 94 0f bf 21>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e9 71 44 e8 94 0f bf 21> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.62:46296',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200374
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200387
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 33744
received auth hello!
{ authId: 502, nonce: <Buffer c5 00 c3 1e cb 8e fd a8> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '016579F45321',
  notBefore: 2018-08-27T05:54:39.000Z,
  notAfter: 2018-08-28T05:56:19.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'C5:B5:0D:4B:A2:32:14:F7:83:03:42:7A:0D:9B:9A:99:50:82:BA:B2',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'A31E9022457B05D056C9FDEDB58BC733BB1B97C16EF02448C451D7DA8BD15C69BDB461E2FD275C96206B77B283645D6BCD71B284A7AC0F1477E8D62ECAA762A3FA674E23957AED10D73D8ED8838AC41A47FAF8FB50BCB1B3A57C246D7D1861A3880C7CCFDEEB58259C62F656BDFDD4ABE6096C88FFA9EEEF3D32230BB86D8FF4C534038264055EB8B3972DC370931A0A38091A1287BFF40D2EF7D92570D86B1837F35A2EA3F7B96EA0870826501C88C4DC0639DA69AE419D997562C46AF20F50D09554213C3EE69AE5685E2446DC62A309CD065472D9BC7AD27221D047D12C6241DBDF5C65881B877D96358D4C273A9F3D8D02DEB84D0581B7EB28209680C6AD',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWV59FMhMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDgy\nNzA1NTQzOVoXDTE4MDgyODA1NTYxOVowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQCjHpAiRXsF0FbJ/e21i8czuxuXwW7wJEjEUdfai9Fcab20YeL9\nJ1yWIGt3soNkXWvNcbKEp6wPFHfo1i7Kp2Kj+mdOI5V67RDXPY7Yg4rEGkf6+PtQ\nvLGzpXwkbX0YYaOIDHzP3utYJZxi9la9/dSr5glsiP+p7u89MiMLuG2P9MU0A4Jk\nBV64s5ctw3CTGgo4CRoSh7/0DS732SVw2GsYN/NaLqP3uW6ghwgmUByIxNwGOdpp\nrkGdmXVixGryD1DQlVQhPD7mmuVoXiRG3GKjCc0GVHLZvHrSciHQR9EsYkHb31xl\niBuHfZY1jUwnOp89jQLeuE0FgbfrKCCWgMatAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBABnwgP6upwjSVwQ+8rJAKHvbXZEKwiZJ\nMDbUo7tMGyXalN421P7YyEAel7wgZiWOWQ0TUe6eVA/RkJuBZjGmli9cS08h2NId\noZrTCDWsbSmFowLc8160KBezS1TA20DGOashAJKl53uAZ9P82HApDNed+97DXNM/\npDTsWXYm3c15QQgrP20uoCVdSJevnym3XKPIawRU2dMARONeAqMl27K8HgrEy3lG\nPuQZbCZcZwnNrGLrQ24pLWj6iyNNTXMRDNacouHJLmlsJAEgr7+fW1XwyLFrxhzY\nCGp4ackWUgZNoVTJi/JcA481M0pCqUvbEugwMHG0uS4IW56V+YH5XFw=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200405
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33980
received auth hello!
{ authId: 502, nonce: <Buffer d3 cf 05 52 93 5b 17 95> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 88 61 90 e6 4f 81 ce 28>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer fe 4b 6a 7c 26 09 03 bc 5a 88 f1 a6 52 9a f5 ee>,
  macKeyVal: <Buffer 0e fb db ab 26 07 e3 05 5e 81 92 55 1d 8b 6d c8 66 a8 3d e1 86 c1 c4 f9 62 18 21 de d4 8e 3d 0c>,
  absValidity: 2018-08-27T07:09:34.126Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5b e8 3d 58 6a a8 b4 de>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5b e8 3d 58 6a a8 b4 de> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.62:47438',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200423
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34256
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200435
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34446
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 22 d7 c9 52 df fe a5 8b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 16 1c ca 55 1f b2 1a 2e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3d 37 03 c6 53 c4 ef f2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3d 37 03 c6 53 c4 ef f2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.62:47904',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
received auth hello!
{ authId: 502, nonce: <Buffer b9 0d c6 23 c1 da 48 76> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: write after end
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200448
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34666
received auth hello!
{ authId: 502, nonce: <Buffer 47 74 d0 91 29 17 97 07> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer eb 29 2d 0d 9e 10 4a 57>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 60 7d 5f 20 6a 74 21 e9>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 60 7d 5f 20 6a 74 21 e9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.62:48122',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
disconnected from auth
Handler: Error in server - details: Connection with Auth timed out...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200462
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34896
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 7b 37 25 dd 05 d8 e1 04> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c2 c1 49 88 6f a1 e5 a5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 25 ac 62 31 7b 14 86 81>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 25 ac 62 31 7b 14 86 81> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.62:48354',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200476
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35128
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 41 ef 2a 8c 44 5f 8a 83> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 23 e7 04 1b 3f ad c1 d5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 28 97 7c d5 90 93 9d 53>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 28 97 7c d5 90 93 9d 53> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.62:48586',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200488
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35302
received auth hello!
{ authId: 502, nonce: <Buffer 92 64 56 e7 00 ef d8 2b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ff fc bf 9c 86 d1 2e 39>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0b 62 1d f9 ad 66 c0 71>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0b 62 1d f9 ad 66 c0 71> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.62:48758',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200502
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35522
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200521
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35826
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer de 62 e4 09 2a 1b 84 7c> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: write after end
disconnected from auth
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200533
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36014
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: Connection with Auth timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 0f 57 a6 89 74 b4 2e e4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 12 c0 fd 16 a2 ce 36 d3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c9 a1 d5 79 89 1a 9c 2e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c9 a1 d5 79 89 1a 9c 2e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.62:49468',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200546
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36184
received auth hello!
{ authId: 502, nonce: <Buffer f3 42 63 90 87 32 81 2d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f7 2d c6 3b 74 2b 23 a8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fc 6b 66 de c9 6b 72 02>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer fc 6b 66 de c9 6b 72 02> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.62:49640',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200559
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36394
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200574
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36610
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer fe f3 63 45 d7 50 a4 6b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2a e0 f4 36 52 e3 dc 45>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ef c0 20 52 6e bb fd 9e>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ef c0 20 52 6e bb fd 9e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.62:50066',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
received auth hello!
{ authId: 502, nonce: <Buffer 8e 1b a2 c9 2d 92 58 85> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: write after end
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200589
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36844
received auth hello!
{ authId: 502, nonce: <Buffer a8 eb 2a e0 84 c6 5a b9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 52 68 0f 3b e0 75 d0 80>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a0 b0 fa d3 6a b0 24 db>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer a0 b0 fa d3 6a b0 24 db> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.62:50286',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
disconnected from auth
Handler: Error in server - details: Connection with Auth timed out...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200603
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37084
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 37 8f 1d 8c 3c 2b 2e b2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 33 35 b4 62 dc 4d cc b9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 98 8e d7 e4 9e d5 6a 10>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 98 8e d7 e4 9e d5 6a 10> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.62:50542',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200616
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37298
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 9d b0 90 7d 85 64 ea 36> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d9 68 9f ff 7a 74 83 1d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 59 38 c5 b2 e7 04 0c 44>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 59 38 c5 b2 e7 04 0c 44> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.62:50756',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200628
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37508
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
received auth hello!
{ authId: 502, nonce: <Buffer 7e a0 20 53 7f c3 e1 31> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: write after end
received auth hello!
{ authId: 502, nonce: <Buffer fb 2e 30 bb 3a 8f 21 2f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a4 28 cc ae 9f 59 60 8c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 19 f7 13 8a 53 be 91 9d>
Handler: Error in server - details: Error during comm init, details: Error: This socket has been ended by the other party
switching to HANDSHAKE_2_SENT
disconnected from auth
disconnected from auth
