changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s503.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's503',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 30 7a ... > }
Handler: listening on port 22100
s503:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100058
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53314
received auth hello!
{ authId: 504, nonce: <Buffer b2 77 68 69 95 e1 6e de> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 26 96 30 05 33 06 bc 0e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 89 4b aa e2 1a 4a 8a 54 6e 3d d0 72 45 d3 38 f8>,
  macKeyVal: <Buffer 70 57 6b 83 75 a0 ab 26 c0 c5 39 78 43 d5 ec 9a 02 11 93 e4 f1 1a da f2 6b fd 1e fd 82 ba 61 79>,
  absValidity: 2018-08-27T06:58:36.178Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f5 e4 b3 71 be c1 f1 95>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f5 e4 b3 71 be c1 f1 95> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.64:55262',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400038
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53326
received auth hello!
{ authId: 504, nonce: <Buffer 72 85 af ff de 86 da 0b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 48 5a c0 1e d3 99 ac 24>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 83 15 1e 98 03 cd 18 d8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 83 15 1e 98 03 cd 18 d8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.65:36988',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400039
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53338
received auth hello!
{ authId: 504, nonce: <Buffer b6 27 f5 7e 79 7a 40 97> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 95 74 4e 8f b5 90 81 7e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer be 71 8f 55 cf 6e 65 7c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer be 71 8f 55 cf 6e 65 7c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.66:50188',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100066
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53556
received auth hello!
{ authId: 504, nonce: <Buffer fc 86 20 1d 49 da 65 2a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3d 0a 82 d5 a0 6f d3 ce>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b1 84 bc 32 e0 a3 15 7e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b1 84 bc 32 e0 a3 15 7e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.64:55502',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400040
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53574
received auth hello!
{ authId: 504, nonce: <Buffer 66 9c db ed 02 68 5f f9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9a 4c 4d a9 d3 35 85 bd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 66 54 90 b7 37 e0 3b 6b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 66 54 90 b7 37 e0 3b 6b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.65:37236',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400042
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53592
received auth hello!
{ authId: 504, nonce: <Buffer d0 26 53 af 02 20 13 ea> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a0 8e 5d 9b ae 33 36 11>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8d 1c 53 59 2d ef 16 67>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8d 1c 53 59 2d ef 16 67> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.66:50442',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100074
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53826
received auth hello!
{ authId: 504, nonce: <Buffer 79 80 ad 7b 63 7f ce 23> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1f e6 21 43 77 79 8b c2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 92 da d1 9c 4e 25 89 8b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 92 da d1 9c 4e 25 89 8b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.64:55772',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400046
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53844
received auth hello!
{ authId: 504, nonce: <Buffer 80 f9 ca c8 16 2d 8c 8e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a9 5f d5 ca 07 bd 9e 65>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1c a7 24 16 fa 96 74 81>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1c a7 24 16 fa 96 74 81> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.65:37506',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400048
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53862
received auth hello!
{ authId: 504, nonce: <Buffer 7e c5 9c 1f 1a 04 e7 1e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f0 21 40 f2 7e 90 31 ec>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 14 a1 f6 23 e0 93 ba 41>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 14 a1 f6 23 e0 93 ba 41> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.66:50712',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100082
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54096
received auth hello!
{ authId: 504, nonce: <Buffer 4c fc f7 de dc 6d ae 7c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer db 87 d2 f0 bb d3 e3 a2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 26 5b a2 21 61 1d db 44>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 26 5b a2 21 61 1d db 44> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.64:56042',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400052
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54114
received auth hello!
{ authId: 504, nonce: <Buffer 56 78 5f 2b 1f 6f 93 be> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer aa 53 53 62 8a c8 dd 11>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bd f7 aa c2 e2 2b 16 8b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bd f7 aa c2 e2 2b 16 8b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.65:37776',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400054
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54132
received auth hello!
{ authId: 504, nonce: <Buffer e8 74 a7 f8 ec 03 6f 87> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0f 6f a5 fb 02 1a a5 ca>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cc ad 4e 1b 48 56 1d c4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer cc ad 4e 1b 48 56 1d c4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.66:50982',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100090
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54366
received auth hello!
{ authId: 504, nonce: <Buffer b7 9c 6d b0 89 2d 89 44> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a4 e6 f1 ce 3f 62 9c f1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7d 95 16 88 26 df c2 cd>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 7d 95 16 88 26 df c2 cd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.64:56314',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400058
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54384
received auth hello!
{ authId: 504, nonce: <Buffer e2 74 4b a4 15 f2 6c 21> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1c 17 3c b8 a3 66 2d 59>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 74 b2 f6 79 51 a2 83 75>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 74 b2 f6 79 51 a2 83 75> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.65:38046',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400060
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54402
received auth hello!
{ authId: 504, nonce: <Buffer c9 5b b8 44 b8 81 9f c9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a3 d0 f1 18 87 cf 2e 1f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer dc 3d b8 37 88 3a 97 7d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer dc 3d b8 37 88 3a 97 7d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.66:51252',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100098
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54670
received auth hello!
{ authId: 504, nonce: <Buffer 3f 89 66 fc a6 85 ac d3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fb de 38 8c f8 29 10 cb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fe da e4 a5 d2 1f 94 e5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fe da e4 a5 d2 1f 94 e5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.64:56618',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400064
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54688
received auth hello!
{ authId: 504, nonce: <Buffer 6b a4 44 25 19 fc 68 a8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ed e4 70 8f 12 82 dc 72>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8b a0 9b e5 9c d8 71 a3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8b a0 9b e5 9c d8 71 a3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.65:38350',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400066
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54706
received auth hello!
{ authId: 504, nonce: <Buffer 42 5b f5 57 22 36 96 34> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4a 1e 9b 26 d2 8f 03 bd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f8 c4 ff cf fb 50 39 52>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f8 c4 ff cf fb 50 39 52> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.66:51556',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100106
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54940
received auth hello!
{ authId: 504, nonce: <Buffer 99 8c 03 25 61 57 a4 a3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ce d2 38 1e 24 71 c5 7d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 15 7a 45 2f 19 07 5d ca>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 15 7a 45 2f 19 07 5d ca> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.64:56888',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400070
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54958
received auth hello!
{ authId: 504, nonce: <Buffer 44 a9 83 d8 16 22 53 d2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 73 6c 62 36 f0 ce d0 46>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5e 96 6e 72 ba 5b db a3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5e 96 6e 72 ba 5b db a3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.65:38620',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400072
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54976
received auth hello!
{ authId: 504, nonce: <Buffer b8 1b 3c 0d 1c 2b 41 7f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ec e2 1e af 0b 7a 41 ae>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a2 a0 73 53 d8 f4 42 ef>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a2 a0 73 53 d8 f4 42 ef> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.66:51826',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200375
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200377
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 58066
received auth hello!
{ authId: 401, nonce: <Buffer 9a 36 38 ed 58 0c a1 24> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth401',
     commonName: '10.0.1.1' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth504',
     commonName: '10.0.0.7' },
  serial: '016579F45A7B',
  notBefore: 2018-08-27T05:54:41.000Z,
  notAfter: 2018-08-28T05:56:21.000Z,
  subjectHash: 'de555cae',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'AF:78:15:66:98:5B:17:9B:64:0E:4A:30:48:A9:7B:3D:B7:65:4E:39',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'B530B62681E49BA3C59D023490C8FA22CDFCBEFE3C82DDC2EB20C54A7635E97FA277CACAAFFA4C4DBEC0E2EA6A350C5F49F73EAEBB61D517626C1FA825652FB0A97551D2651617F0C6167998928AE18186E89F69062E5E8569B20C127B9042FA49ECA2FAB22ED2362B41A9B317571C989813E9206F9938B6C8292AF7D26C0B7C22AED2002E379FD7C162E804A6EB39BFBAA4070586BEFFCBD2C6013FFA793744F966D931AF04263D6DC1FE3581000CB938A918CB88E7B7578C43239586252B1B7EEC2CF99B24518FC88A87396CBAD7990A8942E64846F37F40959504D5D6CD39533AB9898B84BA00BDBF0D4350CB87DCACD5B4C13EFF5795D7433B531062172F',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.1' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 401,
  host: '10.0.1.1',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWV59Fp7MA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDQxETAPBgNVBAMMCDEwLjAuMC43MB4XDTE4MDgy\nNzA1NTQ0MVoXDTE4MDgyODA1NTYyMVowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDQwMTERMA8GA1UEAwwIMTAuMC4xLjEwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQC1MLYmgeSbo8WdAjSQyPoizfy+/jyC3cLrIMVKdjXpf6J3ysqv\n+kxNvsDi6mo1DF9J9z6uu2HVF2JsH6glZS+wqXVR0mUWF/DGFnmYkorhgYbon2kG\nLl6FabIMEnuQQvpJ7KL6si7SNitBqbMXVxyYmBPpIG+ZOLbIKSr30mwLfCKu0gAu\nN5/XwWLoBKbrOb+6pAcFhr7/y9LGAT/6eTdE+WbZMa8EJj1twf41gQAMuTipGMuI\n57dXjEMjlYYlKxt+7Cz5myRRj8iKhzlsuteZColC5khG839AlZUE1dbNOVM6uYmL\nhLoAvb8NQ1DLh9ys1bTBPv9XlddDO1MQYhcvAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQEwDQYJKoZIhvcNAQELBQADggEBADce2A1FVXgaWojY/xq9ZQWKh5T6TQYt\nGGfH2OpRl2g/+4HI78UgXMgJhhgjjzipPhVirBD9EcbkKNv2SN1mnfg8HYdBWdA+\nVpRJoGCqQBfYsDrOsWqNsx0iWrNe+rtTDE6rmlpl04+jsZ2f1Eo+GEXG+m43FJTz\nGQAHm1k2oo8ewRXs8CchtbWeTJA6A+wo7LqanZi4Z+/jS73g8N45Nyst04cA+3Pr\nWPxXOsY5lrM1nxvmiGGaI0uV/5l9akZAjfhPwU4GNKlk7+8Ocpk3XuJgjmszctGo\nsomnlui5zQDyN7Wz2AlaYT/ximPYURbHyuuIoR5dcmkepLK4h7WQsGs=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200389
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58278
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200390
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58296
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: handshake2 timed out...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200392
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58314
received auth hello!
{ authId: 401, nonce: <Buffer af 69 99 e8 e5 5c 1b d2> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 9b e3 39 da fb 6a 88 e1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer a4 81 0c b9 c4 ae 6f 96 97 c0 24 37 fa bc df ff>,
  macKeyVal: <Buffer 9b 0c 0b 11 bf 29 2d c5 8c 86 7c 3e b5 8c cb 60 73 74 a5 ca 77 1f 55 72 3a f8 ec fe 60 0f 05 2f>,
  absValidity: 2018-08-27T07:08:43.690Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer de 8b 2a e4 e7 e1 de 66>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer de 8b 2a e4 e7 e1 de 66> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.66:52712',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200407
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58528
received auth hello!
{ authId: 401, nonce: <Buffer 57 7b 45 3b a2 67 f8 4e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 14 01 85 d4 fa bc f3 6e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 87 c6 44 77 47 9a 20 85>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 87 c6 44 77 47 9a 20 85> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.64:58024',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200408
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58544
received auth hello!
{ authId: 401, nonce: <Buffer fd 1f 0d 3e 0b ca 3c 2e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0a 30 7b 1b 37 9b e9 40>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 57 f1 9f 35 9a 9f e8 ae>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 57 f1 9f 35 9a 9f e8 ae> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.65:39754',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200410
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58562
received auth hello!
{ authId: 401, nonce: <Buffer 5e 6f b3 74 fa 82 db 5f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cd cd cc 18 dd d8 40 11>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fa ba 6c 78 52 c7 30 6f>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer fa ba 6c 78 52 c7 30 6f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 24,
  remoteAddress: '::ffff:10.0.1.66:52960',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 24 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 24 }
specified socketID: 24
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #24 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200424
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58790
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 401, nonce: <Buffer 1d c1 81 a4 bb 0f c8 01> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 22 de c3 42 2a 33 ae 10>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d7 38 89 93 1e 4b 14 14>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d7 38 89 93 1e 4b 14 14> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 25,
  remoteAddress: '::ffff:10.0.1.66:53190',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 25 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 25 }
specified socketID: 25
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #25 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200439
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59048
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200445
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59112
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200451
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59254
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200452
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59260
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
Handler: Error in server - details: handshake2 timed out...
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200453
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59272
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200460
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59400
received auth hello!
{ authId: 401, nonce: <Buffer f6 81 67 52 9b 71 2b f5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 29 70 2f ca b2 a8 8a f8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8a 92 d7 61 6f f9 59 a6>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 8a 92 d7 61 6f f9 59 a6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 26,
  remoteAddress: '::ffff:10.0.1.64:58898',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 26 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 26 }
specified socketID: 26
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200465
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59480
Handler: Error in server - details: handshake2 timed out...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200472
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59552
received auth hello!
{ authId: 401, nonce: <Buffer 58 8a e5 bf 93 e6 63 b6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f2 b3 18 15 93 1c f5 a0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b2 a3 9a 46 5e 40 f9 5c>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b2 a3 9a 46 5e 40 f9 5c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 27,
  remoteAddress: '::ffff:10.0.1.65:40764',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 27 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 27 }
specified socketID: 27
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #26 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200474
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59612
received auth hello!
{ authId: 401, nonce: <Buffer 46 bc a3 e3 11 95 17 ba> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 19 fe a5 d1 af d6 b9 c7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9a 7e c0 d7 37 3f ce 1e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9a 7e c0 d7 37 3f ce 1e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 28,
  remoteAddress: '::ffff:10.0.1.64:59110',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 28 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 28 }
specified socketID: 28
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200480
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59730
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #27 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200486
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59768
received auth hello!
{ authId: 401, nonce: <Buffer 07 10 1b 42 72 de a4 56> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 17 f9 8f 07 f8 76 26 a4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9e 7a 57 38 fc a1 57 45>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9e 7a 57 38 fc a1 57 45> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 29,
  remoteAddress: '::ffff:10.0.1.65:40980',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 29 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 29 }
specified socketID: 29
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200489
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59854
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #29 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200491
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59900
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #28 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200503
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60064
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
received auth hello!
{ authId: 401, nonce: <Buffer 16 03 27 42 57 86 48 ae> }
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200505
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a8 10 46 7d 23 7c 60 d8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 37 b7 97 11 fa c3 d2 d5>
switching to HANDSHAKE_2_SENT
disconnected from auth
connected to auth! from local port 60082
received session key handshake3!
{ replyNonce: <Buffer 37 b7 97 11 fa c3 d2 d5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 30,
  remoteAddress: '::ffff:10.0.1.64:59560',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 30 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 30 }
specified socketID: 30
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #30 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200516
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60268
received auth hello!
{ authId: 401, nonce: <Buffer 86 c1 db 86 f3 42 5f d3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 43 42 6f e7 86 8d 77 d3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 46 d3 36 24 38 a0 6d 37>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 46 d3 36 24 38 a0 6d 37> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 31,
  remoteAddress: '::ffff:10.0.1.64:59766',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 31 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 31 }
specified socketID: 31
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200518
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60298
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: Disconnected from auth before getting session key response
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200519
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: Disconnected from auth before getting session key response
connected to auth! from local port 60316
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #31 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200530
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60490
received auth hello!
{ authId: 401, nonce: <Buffer 26 b3 1c 0b ea 8b 13 01> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 91 d5 00 7d df 1f 0f 40>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a4 f2 bf 9a 35 4e eb 8b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a4 f2 bf 9a 35 4e eb 8b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 32,
  remoteAddress: '::ffff:10.0.1.64:59988',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 32 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 32 }
specified socketID: 32
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200531
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60516
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200532
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60520
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200547
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60736
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200548
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60740
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200562
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60954
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200577
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 32938
Handler: Error in server - details: handshake2 timed out...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200583
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33018
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #32 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200586
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33046
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200590
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33174
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200591
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33178
received auth hello!
{ authId: 401, nonce: <Buffer 97 f3 13 3f 75 f4 da b9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 71 3c ee be ed 9f 69 c5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8a 0e 0f 11 92 6f b5 ac>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8a 0e 0f 11 92 6f b5 ac> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 33,
  remoteAddress: '::ffff:10.0.1.66:55804',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 33 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 33 }
specified socketID: 33
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200604
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33394
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #33 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200618
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33624
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200629
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33832
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200630
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33836
received auth hello!
{ authId: 401, nonce: <Buffer 67 32 76 5c e6 d6 38 ce> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5c ab c4 a8 37 a1 9a 75>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 96 98 76 a9 a9 e1 6a 4b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 96 98 76 a9 a9 e1 6a 4b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 34,
  remoteAddress: '::ffff:10.0.1.66:56462',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 34 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 34 }
specified socketID: 34
Handler: Error in server - details: handshake2 timed out...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200633
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33862
received auth hello!
{ authId: 401, nonce: <Buffer c1 55 d1 ce 79 e0 95 e2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e5 7b 21 82 4d 6d 34 cf>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8f aa 8e 95 ac 85 52 29>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8f aa 8e 95 ac 85 52 29> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 35,
  remoteAddress: '::ffff:10.0.1.64:33358',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 35 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 35 }
specified socketID: 35
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #35 closed
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #34 closed
Handler: Error in server - details: Auth hello timedout ...
