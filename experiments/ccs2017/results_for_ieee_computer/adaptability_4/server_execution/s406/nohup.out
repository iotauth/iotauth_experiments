changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s406.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's406',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 74 66 ... > }
Handler: listening on port 22100
s406:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200056
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33116
received auth hello!
{ authId: 402, nonce: <Buffer 67 82 3b c8 8d ff 5f 06> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 3b e2 6c ce 39 a2 fb f6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 0b 30 db 8c 6c 00 43 39 87 6a ac 9c da 63 4f d7>,
  macKeyVal: <Buffer e9 f5 3d ce 8a 84 a8 b1 88 49 14 31 02 16 53 e2 7d 70 79 2c 29 e4 c6 9c 86 47 75 88 37 02 04 ae>,
  absValidity: 2018-08-27T06:57:50.445Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 97 62 84 2c 3a dd 67 03>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 97 62 84 2c 3a dd 67 03> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.50:52548',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200063
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33272
received auth hello!
{ authId: 402, nonce: <Buffer 35 63 85 13 16 c9 60 34> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2f ec d0 eb e1 96 be ec>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer dd c5 2a 33 95 50 33 3b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer dd c5 2a 33 95 50 33 3b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.50:52704',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200070
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33534
received auth hello!
{ authId: 402, nonce: <Buffer c5 3b 05 79 bc 9c 6e 60> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 63 f5 3c 2a b7 20 c9 7d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 69 d2 af e7 b9 9e f6 2a>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 69 d2 af e7 b9 9e f6 2a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.50:52966',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200077
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33804
received auth hello!
{ authId: 402, nonce: <Buffer 97 5a 18 c5 70 7a 6a 86> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e8 1a fa e3 4f 65 51 c9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 31 53 05 54 b3 ec 2b 75>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 31 53 05 54 b3 ec 2b 75> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.50:53236',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200084
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34074
received auth hello!
{ authId: 402, nonce: <Buffer d7 2b ee 6d 91 7a a7 50> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 75 60 97 ed 7b 00 b8 f0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 92 fb 89 87 fc e9 a1 e5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 92 fb 89 87 fc e9 a1 e5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.50:53506',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200091
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34344
received auth hello!
{ authId: 402, nonce: <Buffer 6a 03 d4 61 25 d3 33 07> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 15 31 16 b7 37 bd 07 da>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2e a1 11 83 3e 13 d7 83>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2e a1 11 83 3e 13 d7 83> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.50:53776',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200098
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34648
received auth hello!
{ authId: 402, nonce: <Buffer 1b 16 19 e9 fe 7a eb 10> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f8 0e e1 c3 b7 36 c9 da>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 90 56 da 34 8b 79 ba 1e>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 90 56 da 34 8b 79 ba 1e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.50:54080',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200105
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34918
received auth hello!
{ authId: 402, nonce: <Buffer b9 a3 8c ab 87 82 d1 eb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 92 6f 63 1f 78 60 e9 57>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a3 cd 68 0f cf e0 4b 9e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a3 cd 68 0f cf e0 4b 9e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.50:54350',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300257
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300266
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 58350
received auth hello!
{ authId: 503, nonce: <Buffer 54 17 4b 80 67 98 93 4c> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth503',
     commonName: '10.0.1.6' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth402',
     commonName: '10.0.0.2' },
  serial: '016579F4504F',
  notBefore: 2018-08-27T05:54:39.000Z,
  notAfter: 2018-08-28T05:56:19.000Z,
  subjectHash: '5542437f',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'AC:D1:85:E5:F5:A6:99:63:A4:B4:8B:7C:65:46:18:6D:63:1D:40:62',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'C063304DB50CD53E197DA75E4D40E26CDC5CD8A0B32AE61DE61F1B45D952A4AF504A623AA81A434BF3E719B4A8575E7DDC5B6CC79B91CF65119617906A6FA524F36EC3EAE0F3DABF0A5C0AF3124582FA817364EADACDA8D4A54541FE1D7273B13153904D7ABF1DD6A3BF9BFA47F7F69CD4C5F6151308FEBCE9EE63FDB48DE4B6C6978CC71151410FFAF44FDE861DF2EDC5F88548D16C40246200EED97C3B814BDC01DD1AFC3F60F99ABEBD64A0E24D8796B1FE22F89D53C7EB16B6B4F840F5DB2C5AEC1002EF2EA80C5AB75602301EFC5B3670EC56D96F7DE45F5A21269F4EDB30218677BC8AFCD1869D96E6E189BBBD3B0DD9515A937856DB9BE293411F4ACD',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.6' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 503,
  host: '10.0.1.6',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWV59FBPMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDIxETAPBgNVBAMMCDEwLjAuMC4yMB4XDTE4MDgy\nNzA1NTQzOVoXDTE4MDgyODA1NTYxOVowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMzERMA8GA1UEAwwIMTAuMC4xLjYwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDAYzBNtQzVPhl9p15NQOJs3FzYoLMq5h3mHxtF2VKkr1BKYjqo\nGkNL8+cZtKhXXn3cW2zHm5HPZRGWF5Bqb6Uk827D6uDz2r8KXArzEkWC+oFzZOra\nzajUpUVB/h1yc7ExU5BNer8d1qO/m/pH9/ac1MX2FRMI/rzp7mP9tI3ktsaXjMcR\nUUEP+vRP3oYd8u3F+IVI0WxAJGIA7tl8O4FL3AHdGvw/YPmavr1koOJNh5ax/iL4\nnVPH6xa2tPhA9dssWuwQAu8uqAxat1YCMB78WzZw7FbZb33kX1ohJp9O2zAhhne8\nivzRhp2W5uGJu707DdlRWpN4Vtub4pNBH0rNAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQYwDQYJKoZIhvcNAQELBQADggEBAANQqLtJhdfLybN25JD0l5SSrH681V5Z\nTd5ldQ96FrIpNBx2e8N8Fdh94E+pGmFPH7Y1L/qpZ90Y/9YvBrOciURRxHe0cwE0\nOFCugfV/qguiBj3uiEdiWcRH1S9kHh+yh96jzt+Jao4FXmYJjYF5ArfQkV8HCpPv\npiKOlgQOXNxNJPpz/8GCokEia7stTge2lF3O2s0s0tonex2LlAJzj1fw5dkEDfEw\nlk+3+cdRCR6AITJio+PeTJwpFq5iv2QM1EoQUaP7AM9gBEb0RQDl1lMQ0TfSf3Ab\nYnc2eIKzny1muJvzMEYuDRBn2PKKcgICHeQcY5rOuR0DWDwaAmXqhpg=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300275
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58568
received auth hello!
{ authId: 503, nonce: <Buffer d7 93 db 7d 70 96 a0 e4> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer a8 e6 55 39 66 73 af 19>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 2f b0 a9 7c e5 12 78 fb 3f 42 27 78 12 c8 51 16>,
  macKeyVal: <Buffer 6e c8 39 f2 d4 86 92 d9 72 64 ec 24 3a 85 e0 a1 8c 12 02 89 e1 18 b1 4a fc 44 2c 9b d5 ea 44 a4>,
  absValidity: 2018-08-27T07:09:50.950Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 98 7c 8c b2 9e aa 41 35>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 98 7c 8c b2 9e aa 41 35> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.50:55474',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300284
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58792
received auth hello!
{ authId: 503, nonce: <Buffer de 0b 18 29 c2 60 41 21> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a4 a0 be 1e 1c b6 32 58>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 82 84 64 52 95 72 bb 88>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 82 84 64 52 95 72 bb 88> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.50:55696',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300293
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58994
received auth hello!
{ authId: 503, nonce: <Buffer 03 6c 3b eb fe 95 38 cf> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 98 ee b8 00 95 7f 26 18>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a9 f9 1e 21 ec 3f 64 b2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a9 f9 1e 21 ec 3f 64 b2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.50:55898',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300302
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59208
received auth hello!
{ authId: 503, nonce: <Buffer fc 84 30 b8 b4 eb c2 4c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d1 ed db 15 41 54 51 00>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer df 33 85 4e c5 90 53 ac>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer df 33 85 4e c5 90 53 ac> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.50:56114',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300311
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59428
received auth hello!
{ authId: 503, nonce: <Buffer 5c 9f 81 86 4d 3f 0b 57> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 72 e2 41 0e 96 04 44 62>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bc c1 3b cc d1 20 b2 61>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bc c1 3b cc d1 20 b2 61> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.50:56334',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300320
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59636
received auth hello!
{ authId: 503, nonce: <Buffer ca 71 d2 e4 c7 d2 fd c0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4f 80 7c c4 a3 e3 79 26>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 77 87 c6 90 d4 67 f4 32>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 77 87 c6 90 d4 67 f4 32> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.50:56538',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300329
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59848
received auth hello!
{ authId: 503, nonce: <Buffer 71 02 8f ee b2 da c8 a7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c2 42 ef ab 92 15 94 e6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bf 30 04 a9 e3 34 04 c2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bf 30 04 a9 e3 34 04 c2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.50:56754',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300338
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60080
received auth hello!
{ authId: 503, nonce: <Buffer 46 c2 95 ab 56 ce ab d9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8e 22 31 00 47 1d f3 13>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e4 1a 99 08 41 18 74 d3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e4 1a 99 08 41 18 74 d3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.50:56986',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300347
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60292
received auth hello!
{ authId: 503, nonce: <Buffer 37 c8 69 cd 1f 56 c0 2c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b9 81 28 bc af f8 c7 c8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 36 49 e9 34 64 02 e3 a3>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 36 49 e9 34 64 02 e3 a3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.50:57198',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300356
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60522
received auth hello!
{ authId: 503, nonce: <Buffer dd 94 aa ca 6e c2 28 1b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3a 8d 66 60 c6 bf 2f 82>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 06 d6 14 bd 2e 5d c0 8a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 06 d6 14 bd 2e 5d c0 8a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.50:57428',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300365
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60738
received auth hello!
{ authId: 503, nonce: <Buffer 03 f1 ac 4e eb 70 19 58> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 56 52 6d 81 1d 7d 97 e7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ec c0 b0 76 34 9c b2 13>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ec c0 b0 76 34 9c b2 13> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.50:57642',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300374
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60952
received auth hello!
{ authId: 503, nonce: <Buffer a4 c6 d9 a8 3e 57 e9 df> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 40 74 c8 b7 50 36 8f 93>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1c 8d d4 9f 30 f1 86 8c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1c 8d d4 9f 30 f1 86 8c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.50:57856',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300383
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 32936
received auth hello!
{ authId: 503, nonce: <Buffer 87 d9 d8 36 a8 08 0e 71> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e0 b9 ff 76 d1 66 15 36>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fc 35 59 df 6f fc cf 93>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fc 35 59 df 6f fc cf 93> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.50:58074',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300392
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33176
received auth hello!
{ authId: 503, nonce: <Buffer 0e 63 cc 1c c2 4e 0d c6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3e df f4 50 4b 6f f7 42>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 03 43 2f d7 53 28 85 97>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 03 43 2f d7 53 28 85 97> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.50:58314',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300401
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33410
received auth hello!
{ authId: 503, nonce: <Buffer 08 47 cc c5 d0 93 af 88> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 39 8e 73 62 fa ed 89 5c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f3 36 f7 be c4 8c bc 87>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f3 36 f7 be c4 8c bc 87> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.50:58548',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300410
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33626
received auth hello!
{ authId: 503, nonce: <Buffer 74 d0 b5 5e 67 08 2f 52> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 51 31 7b 01 cb e2 64 fd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8d 27 fd 7e e3 df 56 71>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8d 27 fd 7e e3 df 56 71> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.50:58762',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300419
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33836
received auth hello!
{ authId: 503, nonce: <Buffer b5 c1 5b f3 7f c2 4c 59> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e8 81 1e 9b 1f 5b 97 b9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b8 17 0f 00 45 97 9d 35>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b8 17 0f 00 45 97 9d 35> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 24,
  remoteAddress: '::ffff:10.0.1.50:58970',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 24 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 24 }
specified socketID: 24
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #24 closed
