changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s411.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's411',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 76 75 ... > }
Handler: listening on port 22100
s411:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100273
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58808
received auth hello!
{ authId: 403, nonce: <Buffer 9d 22 22 c9 be b2 ea 8d> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 78 98 fa 2d 56 45 1a f6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 12 3d 80 ac 29 7c 28 ee d0 ec b2 47 84 01 3d ce>,
  macKeyVal: <Buffer b9 47 7c 93 8e 82 61 ef ef f6 e3 29 32 94 a0 12 8d b1 b2 26 f0 33 83 9d ee 80 87 a3 5c 5a 87 72>,
  absValidity: 2018-08-27T06:57:34.124Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer de 63 74 3d 7d fa 68 65>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer de 63 74 3d 7d fa 68 65> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.45:60336',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100279
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58934
received auth hello!
{ authId: 403, nonce: <Buffer 51 2f 80 b3 c9 20 fc aa> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ae 53 28 b6 c4 e0 f9 39>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e3 b1 82 76 fb 1a 19 47>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e3 b1 82 76 fb 1a 19 47> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.45:60462',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100285
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59170
received auth hello!
{ authId: 403, nonce: <Buffer 83 81 04 89 f7 4d a0 f3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 87 df 6a 20 41 2c 43 bd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 90 d5 4d 8f 18 1e ce 9d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 90 d5 4d 8f 18 1e ce 9d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.45:60698',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100291
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59440
received auth hello!
{ authId: 403, nonce: <Buffer f2 17 4d 44 0a 0a 20 fd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 00 25 dd b7 78 aa 59 c7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 46 b8 d1 32 df 0b 11 e3>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 46 b8 d1 32 df 0b 11 e3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.45:60968',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100297
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59710
received auth hello!
{ authId: 403, nonce: <Buffer 06 98 1d fd a0 59 fb 7b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 86 6d a8 8d b4 62 02 2d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 29 04 26 75 e3 49 3f c6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 29 04 26 75 e3 49 3f c6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.45:33006',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100303
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59980
received auth hello!
{ authId: 403, nonce: <Buffer 77 0f 79 46 45 1a 10 5f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5e 0d 4e 1d 04 de a3 10>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f5 08 03 5d e4 9f d6 c5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f5 08 03 5d e4 9f d6 c5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.45:33276',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100309
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60284
received auth hello!
{ authId: 403, nonce: <Buffer 7e 97 9f 0b 39 f0 1d ce> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cd 2e 3a 24 42 ab b3 b3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 37 b4 7f 8e 99 1f fd e2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 37 b4 7f 8e 99 1f fd e2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.45:33580',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100315
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60554
received auth hello!
{ authId: 403, nonce: <Buffer 3c c1 1e 5f f9 20 75 a7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 97 2a 2b ee f4 6b 44 6b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 73 bb 64 e3 3a 14 5d 84>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 73 bb 64 e3 3a 14 5d 84> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.45:33850',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100321
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect ECONNREFUSED 10.0.1.3:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100327
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.3:21100
connected to auth! from local port 39630
received auth hello!
{ authId: 401, nonce: <Buffer 41 4c 03 f1 2c 99 0c f3> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth401',
     commonName: '10.0.1.1' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth403',
     commonName: '10.0.0.3' },
  serial: '016579F450E2',
  notBefore: 2018-08-27T05:54:39.000Z,
  notAfter: 2018-08-28T05:56:19.000Z,
  subjectHash: 'de555cae',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '4E:41:84:27:D3:7A:FB:E5:9C:1A:71:66:34:14:A9:7E:4E:BB:BB:45',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'B530B62681E49BA3C59D023490C8FA22CDFCBEFE3C82DDC2EB20C54A7635E97FA277CACAAFFA4C4DBEC0E2EA6A350C5F49F73EAEBB61D517626C1FA825652FB0A97551D2651617F0C6167998928AE18186E89F69062E5E8569B20C127B9042FA49ECA2FAB22ED2362B41A9B317571C989813E9206F9938B6C8292AF7D26C0B7C22AED2002E379FD7C162E804A6EB39BFBAA4070586BEFFCBD2C6013FFA793744F966D931AF04263D6DC1FE3581000CB938A918CB88E7B7578C43239586252B1B7EEC2CF99B24518FC88A87396CBAD7990A8942E64846F37F40959504D5D6CD39533AB9898B84BA00BDBF0D4350CB87DCACD5B4C13EFF5795D7433B531062172F',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.1' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 401,
  host: '10.0.1.1',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWV59FDiMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDMxETAPBgNVBAMMCDEwLjAuMC4zMB4XDTE4MDgy\nNzA1NTQzOVoXDTE4MDgyODA1NTYxOVowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDQwMTERMA8GA1UEAwwIMTAuMC4xLjEwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQC1MLYmgeSbo8WdAjSQyPoizfy+/jyC3cLrIMVKdjXpf6J3ysqv\n+kxNvsDi6mo1DF9J9z6uu2HVF2JsH6glZS+wqXVR0mUWF/DGFnmYkorhgYbon2kG\nLl6FabIMEnuQQvpJ7KL6si7SNitBqbMXVxyYmBPpIG+ZOLbIKSr30mwLfCKu0gAu\nN5/XwWLoBKbrOb+6pAcFhr7/y9LGAT/6eTdE+WbZMa8EJj1twf41gQAMuTipGMuI\n57dXjEMjlYYlKxt+7Cz5myRRj8iKhzlsuteZColC5khG839AlZUE1dbNOVM6uYmL\nhLoAvb8NQ1DLh9ys1bTBPv9XlddDO1MQYhcvAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQEwDQYJKoZIhvcNAQELBQADggEBAGPZEB9yxeX6ADqbNbjSkSG6wHJPzsOW\nS0ttSEzcmtnC704Kqf8Mjjdaf74cQoXA/cSyt41G/T7j2WbjRakXCNfgaJSt3JaI\nrV05UB4vHEFmyI6ZekgJtMMcZ6QA4vD0R4npcPefeX3cReKE8NStR5cLCs77jxDI\n/eAQPE0Za69Gc2VSmT+B5BNTo7ar7ga4qEVpPW2RVD8MBSt6j+9OBcVlUWtaLICY\nEeMEPNGkwwINhovpz1TgQBM9w6lUKq/yftuXm6fMBKZjb0oQOS8UA6N9I0pmE3+I\nyWbmK0ZZYR764A2yxxOphpyQ+Q9hsCkbLaVo/mHQOM6gTBkuhcOCgzM=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100333
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39836
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100343
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40086
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: Disconnected from auth before getting session key response
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100353
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40328
received auth hello!
{ authId: 401, nonce: <Buffer f0 5c 7d b0 dd 47 d4 6d> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 98 ef df d1 e8 c0 f9 f8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer c6 d8 3c fc e9 10 41 30 2b 74 c2 c7 dc d4 be a1>,
  macKeyVal: <Buffer 8b 2c cb 30 28 e8 1b 37 f7 b0 5f 95 78 b5 80 73 f1 6d a5 71 83 e9 cf 6f 35 e8 20 09 38 18 ba 6a>,
  absValidity: 2018-08-27T07:09:34.744Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f1 72 75 a0 1e df 11 f3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f1 72 75 a0 1e df 11 f3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.45:34980',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100363
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40550
received auth hello!
{ authId: 401, nonce: <Buffer 51 f6 34 fc cb fa bd b6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 89 c5 51 7b 47 ca 93 a7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 40 2c 03 20 cc f1 a7 3c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 40 2c 03 20 cc f1 a7 3c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.45:35202',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100374
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40762
received auth hello!
{ authId: 401, nonce: <Buffer 33 4d 00 4e 37 3e c0 03> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cd 9a 0d b6 d0 ac cb 9e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3c f2 98 0e e5 82 94 ad>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3c f2 98 0e e5 82 94 ad> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.45:35414',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100386
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40976
received auth hello!
{ authId: 401, nonce: <Buffer f8 ae 35 09 07 03 75 8e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ac 42 1e e6 e3 46 56 73>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cb 47 f7 36 bc e8 06 aa>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer cb 47 f7 36 bc e8 06 aa> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.45:35628',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100398
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41194
received auth hello!
{ authId: 401, nonce: <Buffer 63 77 5c f6 01 48 9c 52> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 95 fe 54 3e dd bb a3 97>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 16 91 6f b8 59 0d 69 cc>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 16 91 6f b8 59 0d 69 cc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.45:35846',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100409
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41406
received auth hello!
{ authId: 401, nonce: <Buffer 98 e0 9f e2 f3 0d 7e 82> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1f 50 88 e6 62 73 d8 ea>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bc c8 fa bf eb d0 a7 dc>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bc c8 fa bf eb d0 a7 dc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.45:36058',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100421
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41618
received auth hello!
{ authId: 401, nonce: <Buffer a2 6d 4b 25 65 6b fc bc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d8 1f 62 a7 9e fb 53 51>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e6 53 0c 49 37 f0 fe 01>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e6 53 0c 49 37 f0 fe 01> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.45:36270',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100434
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41838
received auth hello!
{ authId: 401, nonce: <Buffer 3b c2 99 04 55 6b ae 71> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5d 31 93 f4 16 09 31 66>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9a 91 95 5e 67 06 d6 5b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9a 91 95 5e 67 06 d6 5b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.45:36490',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100447
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42058
received auth hello!
{ authId: 401, nonce: <Buffer 08 11 7d ba e4 b2 f1 73> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0d 38 84 c3 8f d3 c0 a4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 33 98 a9 69 4c ea 01 49>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 33 98 a9 69 4c ea 01 49> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.45:36710',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100460
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42284
received auth hello!
{ authId: 401, nonce: <Buffer 1a 71 83 40 08 0a 9b 64> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0a 1e a4 a3 dc 3b e4 65>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 47 24 93 bc d6 2d 15 ca>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 47 24 93 bc d6 2d 15 ca> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.45:36936',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100472
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42500
received auth hello!
{ authId: 401, nonce: <Buffer 26 62 00 02 f2 2d 18 08> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 08 14 01 d3 f8 42 9c 1c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cb ce 43 a8 16 15 70 9d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer cb ce 43 a8 16 15 70 9d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.45:37152',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100484
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42710
received auth hello!
{ authId: 401, nonce: <Buffer 94 34 23 59 ad d1 3b 38> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 38 29 75 dc d1 24 83 61>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5c 04 dd a2 92 86 bb b4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5c 04 dd a2 92 86 bb b4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.45:37362',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100496
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42926
received auth hello!
{ authId: 401, nonce: <Buffer 73 b1 47 9a fe 35 e3 2e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e4 b8 de 82 7a 89 87 e8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9e 33 2d 02 1d 7d 6c 5b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 9e 33 2d 02 1d 7d 6c 5b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.45:37578',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100508
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43144
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100520
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43400
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100533
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43616
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100546
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43826
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
