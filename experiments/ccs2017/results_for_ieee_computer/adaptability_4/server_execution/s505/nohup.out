changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s505.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's505',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 51 49 42 41 41 4b 43 41 51 45 41 36 6e ... > }
Handler: listening on port 22100
s505:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100060
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47980
received auth hello!
{ authId: 501, nonce: <Buffer 8f c0 4c 13 a4 e7 62 f8> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer f8 04 71 1a bc 1d a0 fc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer bd 78 b2 08 05 d8 ce b2 e3 55 5b 3e 59 79 65 96>,
  macKeyVal: <Buffer 1f 8d bc 2f 36 0f 9d 34 01 44 b8 78 31 c4 a9 c6 9a 2f 94 69 06 38 ab 6c b3 b4 8f 71 77 3a a7 ed>,
  absValidity: 2018-08-27T06:58:49.451Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f3 31 47 f0 0f 7d 64 6c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f3 31 47 f0 0f 7d 64 6c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.68:34580',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100061
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47992
received auth hello!
{ authId: 501, nonce: <Buffer 57 10 52 ba 10 ba 07 81> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 72 2c 03 f4 df 98 50 ad>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 57 33 48 03 ff 9b 80 e2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 57 33 48 03 ff 9b 80 e2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.69:42932',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100068
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48242
received auth hello!
{ authId: 501, nonce: <Buffer 55 e3 03 d5 e8 ba e1 a5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5c 92 bb 56 6c ed 66 62>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 23 be 02 64 45 be a7 4c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 23 be 02 64 45 be a7 4c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.68:34842',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100069
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48260
received auth hello!
{ authId: 501, nonce: <Buffer 12 c7 46 c5 9f 1e 6e 14> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 85 02 82 6a 87 88 c3 95>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c2 00 c6 72 6b 92 f1 a2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c2 00 c6 72 6b 92 f1 a2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.69:43198',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100076
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48512
received auth hello!
{ authId: 501, nonce: <Buffer 98 ea e7 67 64 a6 ee fe> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 07 6d c6 3e c8 d9 5e 4f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a9 6b 76 56 46 32 20 13>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a9 6b 76 56 46 32 20 13> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.68:35112',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100077
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48530
received auth hello!
{ authId: 501, nonce: <Buffer 4e 16 0a a5 37 f1 07 12> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 24 b5 53 64 cf c1 bf d4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 46 72 ec 87 dd 16 c5 e3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 46 72 ec 87 dd 16 c5 e3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.69:43468',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100084
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48782
received auth hello!
{ authId: 501, nonce: <Buffer ee 07 8e b5 d3 bb c1 3a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b4 7d 41 37 75 7b 3c 67>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 35 6e 7a 2c 3e 56 7a d7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 35 6e 7a 2c 3e 56 7a d7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.68:35382',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100085
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48800
received auth hello!
{ authId: 501, nonce: <Buffer 1d 66 e6 2c 06 f1 61 ab> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 46 94 77 ec c1 ed ab a8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d7 97 71 31 be ee 36 d8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d7 97 71 31 be ee 36 d8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.69:43738',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100092
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49052
received auth hello!
{ authId: 501, nonce: <Buffer b2 d1 25 32 bb ee ba 95> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a8 b9 0d 3b e0 e9 84 c9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8d d8 12 29 cb 33 4a df>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8d d8 12 29 cb 33 4a df> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.68:35652',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100093
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49070
received auth hello!
{ authId: 501, nonce: <Buffer 4e 87 1b df 84 b6 d7 28> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 72 b9 16 9d 51 cb 09 f8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e2 13 6a d5 a4 7d a2 a3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e2 13 6a d5 a4 7d a2 a3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.69:44008',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100100
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49356
received auth hello!
{ authId: 501, nonce: <Buffer 6a f9 10 4d a6 10 3b 61> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 29 ae c4 04 59 73 7e 56>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b7 16 bf 64 34 ee b8 b2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b7 16 bf 64 34 ee b8 b2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.68:35956',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100101
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49374
received auth hello!
{ authId: 501, nonce: <Buffer 65 2c a7 50 86 d9 e9 16> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f8 38 71 b9 3f ae 3f 64>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 92 cf d4 80 36 e0 98 7a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 92 cf d4 80 36 e0 98 7a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.69:44312',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100108
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49626
received auth hello!
{ authId: 501, nonce: <Buffer a6 97 30 89 ac e0 7e 8a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c8 78 af 72 9d c6 f0 2d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 99 45 57 2e 72 69 c2 da>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 99 45 57 2e 72 69 c2 da> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.68:36226',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100109
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49644
received auth hello!
{ authId: 501, nonce: <Buffer 83 7b 92 b1 39 11 34 b4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c4 eb 9d d1 2d c0 e2 2c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f2 e3 55 d6 51 fb 60 51>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f2 e3 55 d6 51 fb 60 51> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.69:44582',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200394
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200395
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
Handler: Error in server - details: handshake2 timed out...
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in server - details: handshake2 timed out...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in server - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.3:21100
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in server - details: Error occurred in migration request: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200412
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 42814
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 69 bf 74 a1 07 16 41 0c> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '016579F45321',
  notBefore: 2018-08-27T05:54:39.000Z,
  notAfter: 2018-08-28T05:56:19.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'C5:B5:0D:4B:A2:32:14:F7:83:03:42:7A:0D:9B:9A:99:50:82:BA:B2',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'A31E9022457B05D056C9FDEDB58BC733BB1B97C16EF02448C451D7DA8BD15C69BDB461E2FD275C96206B77B283645D6BCD71B284A7AC0F1477E8D62ECAA762A3FA674E23957AED10D73D8ED8838AC41A47FAF8FB50BCB1B3A57C246D7D1861A3880C7CCFDEEB58259C62F656BDFDD4ABE6096C88FFA9EEEF3D32230BB86D8FF4C534038264055EB8B3972DC370931A0A38091A1287BFF40D2EF7D92570D86B1837F35A2EA3F7B96EA0870826501C88C4DC0639DA69AE419D997562C46AF20F50D09554213C3EE69AE5685E2446DC62A309CD065472D9BC7AD27221D047D12C6241DBDF5C65881B877D96358D4C273A9F3D8D02DEB84D0581B7EB28209680C6AD',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWV59FMhMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDgy\nNzA1NTQzOVoXDTE4MDgyODA1NTYxOVowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQCjHpAiRXsF0FbJ/e21i8czuxuXwW7wJEjEUdfai9Fcab20YeL9\nJ1yWIGt3soNkXWvNcbKEp6wPFHfo1i7Kp2Kj+mdOI5V67RDXPY7Yg4rEGkf6+PtQ\nvLGzpXwkbX0YYaOIDHzP3utYJZxi9la9/dSr5glsiP+p7u89MiMLuG2P9MU0A4Jk\nBV64s5ctw3CTGgo4CRoSh7/0DS732SVw2GsYN/NaLqP3uW6ghwgmUByIxNwGOdpp\nrkGdmXVixGryD1DQlVQhPD7mmuVoXiRG3GKjCc0GVHLZvHrSciHQR9EsYkHb31xl\niBuHfZY1jUwnOp89jQLeuE0FgbfrKCCWgMatAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBABnwgP6upwjSVwQ+8rJAKHvbXZEKwiZJ\nMDbUo7tMGyXalN421P7YyEAel7wgZiWOWQ0TUe6eVA/RkJuBZjGmli9cS08h2NId\noZrTCDWsbSmFowLc8160KBezS1TA20DGOashAJKl53uAZ9P82HApDNed+97DXNM/\npDTsWXYm3c15QQgrP20uoCVdSJevnym3XKPIawRU2dMARONeAqMl27K8HgrEy3lG\nPuQZbCZcZwnNrGLrQ24pLWj6iyNNTXMRDNacouHJLmlsJAEgr7+fW1XwyLFrxhzY\nCGp4ackWUgZNoVTJi/JcA481M0pCqUvbEugwMHG0uS4IW56V+YH5XFw=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 1
to: 2
disconnected from auth
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200414
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42840
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 98 27 0a 03 5c 1f af ea> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 0d 9e da 18 64 2b e2 7f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 83 e5 af d4 e2 2f 0a a2 4e 96 80 df d2 26 1b 9f>,
  macKeyVal: <Buffer 0c 74 d1 3e 98 fb cd 8d 58 e2 53 dd 84 a6 ff d6 7f 31 11 a9 ab b7 7f aa 5e 31 35 47 99 a9 b5 88>,
  absValidity: 2018-08-27T07:10:25.084Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e7 cb 4f 3c ab 9f 40 87>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e7 cb 4f 3c ab 9f 40 87> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.69:45748',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200428
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43050
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer be 8a 43 d1 f4 dc e8 58> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 85 36 79 21 f7 f1 1a d9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d9 07 e1 68 80 2c ad 5c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d9 07 e1 68 80 2c ad 5c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.68:37618',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200431
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43088
received auth hello!
{ authId: 502, nonce: <Buffer 67 f8 6d 03 11 11 74 f2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 45 02 51 48 1f f1 3d 30>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b0 c0 d6 8d fd af 52 3d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b0 c0 d6 8d fd af 52 3d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.69:45994',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200438
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43240
received auth hello!
{ authId: 502, nonce: <Buffer 2b 87 2a 7d 48 e4 27 53> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3a 54 27 28 c6 99 f7 22>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d2 33 74 1b 4a 67 ec e0>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer d2 33 74 1b 4a 67 ec e0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.69:46148',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200464
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43664
Handler: Error in server - details: handshake2 timed out...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200473
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43772
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
received auth hello!
{ authId: 502, nonce: <Buffer 2c bd 0c ba 3a 2a 57 b8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 55 08 b0 72 63 05 56 3a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 73 19 d0 59 c8 a4 fb f9>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 73 19 d0 59 c8 a4 fb f9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.68:38340',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200477
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43896
received auth hello!
{ authId: 502, nonce: <Buffer a9 8a 71 27 8f 44 05 fa> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c9 39 bd 4d 34 c3 62 a5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2a e7 8b 87 4e 1b f5 75>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 2a e7 8b 87 4e 1b f5 75> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.68:38464',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200497
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44164
Handler: Error in server - details: handshake2 timed out...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200507
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44328
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 7b 51 46 4b 17 f7 ff 69> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c0 96 d7 6b 60 2a b1 a4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bd 5a ce e8 7d 16 db 94>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bd 5a ce e8 7d 16 db 94> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.69:47236',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
received auth hello!
{ authId: 502, nonce: <Buffer 1c 8f 89 85 fc c2 d6 35> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: write after end
disconnected from auth
Handler: Error in server - details: Connection with Auth timed out...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200539
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44816
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200544
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44852
received auth hello!
{ authId: 502, nonce: <Buffer 43 8a f4 6b 5f 08 33 34> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9c 21 2c 69 10 24 a1 c9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d1 18 be ef 94 02 0b b6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d1 18 be ef 94 02 0b b6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.69:47760',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200550
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44980
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
received auth hello!
{ authId: 502, nonce: <Buffer 47 9e 84 ce 90 a6 65 8c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6c ed 10 ba 4a 25 0e 7c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c3 d8 60 44 aa 48 05 ed>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c3 d8 60 44 aa 48 05 ed> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.69:47888',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200564
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45194
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 65 a2 f7 1d 83 ee fb 37> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 70 41 06 64 cd 30 82 84>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 05 c7 2a 92 0c db fc 80>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 05 c7 2a 92 0c db fc 80> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.69:48102',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200580
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45412
received auth hello!
{ authId: 502, nonce: <Buffer 7a f8 ab 89 71 b3 f6 18> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c7 52 fa ec 9c 07 6e d3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 71 44 82 a3 a7 23 d7 57>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 71 44 82 a3 a7 23 d7 57> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 24,
  remoteAddress: '::ffff:10.0.1.69:48320',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 24 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 24 }
specified socketID: 24
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200593
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45646
received auth hello!
{ authId: 502, nonce: <Buffer 0d 51 00 7a f3 57 f4 5e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1c 5f 81 a3 a5 8b c5 93>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d8 45 ca 4d fe e7 bd 48>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer d8 45 ca 4d fe e7 bd 48> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 25,
  remoteAddress: '::ffff:10.0.1.68:40212',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 25 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 25 }
specified socketID: 25
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #24 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200597
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45718
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 3c e4 d6 e1 c2 f8 d5 bb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7d 0a 9c 94 c9 9f 29 69>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7c b8 2b 69 4c e9 c8 c6>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 7c b8 2b 69 4c e9 c8 c6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 26,
  remoteAddress: '::ffff:10.0.1.69:48626',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 26 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 26 }
specified socketID: 26
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #25 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200607
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45878
received auth hello!
{ authId: 502, nonce: <Buffer 50 05 09 e7 5e 2c 3c bf> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c2 00 25 8c 3d b1 76 20>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 22 96 0f 87 87 ae 01 88>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 22 96 0f 87 87 ae 01 88> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 27,
  remoteAddress: '::ffff:10.0.1.68:40444',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 27 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 27 }
specified socketID: 27
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #27 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200620
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46092
received auth hello!
{ authId: 502, nonce: <Buffer 00 c6 48 6c 41 40 25 e6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3e a8 f6 f1 96 24 3c 62>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e7 9d d0 55 ac ba 52 df>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e7 9d d0 55 ac ba 52 df> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 28,
  remoteAddress: '::ffff:10.0.1.68:40656',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 28 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 28 }
specified socketID: 28
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #26 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200624
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46154
received auth hello!
{ authId: 502, nonce: <Buffer 07 fc 7e 57 9d ac 32 07> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 12 39 81 dd cd fb ef dd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8d 6c fc 5e 40 24 77 b7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8d 6c fc 5e 40 24 77 b7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 29,
  remoteAddress: '::ffff:10.0.1.69:49062',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 29 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 29 }
specified socketID: 29
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #28 closed
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #29 closed
received auth hello!
{ authId: 502, nonce: <Buffer 2e 16 7d 25 cc 7a aa a4> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: write after end
received auth hello!
{ authId: 502, nonce: <Buffer 97 74 2b 6b 66 39 61 db> }
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: write after end
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in server - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.4:21100
