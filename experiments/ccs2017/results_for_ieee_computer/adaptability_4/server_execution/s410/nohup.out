changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s410.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's410',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 34 4f ... > }
Handler: listening on port 22100
s410:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200059
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38040
received auth hello!
{ authId: 402, nonce: <Buffer 73 28 4c 05 b4 ed f4 00> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 40 07 0c d8 5c 76 1a 60>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 7e 2a 19 6d 77 e2 9d 56 e6 24 5b c3 f2 84 e1 1b>,
  macKeyVal: <Buffer 64 88 29 d7 a6 7f 38 8e bc 54 d5 8d 5f e8 54 aa a8 70 d9 fe f5 af 7d 8a f5 06 37 9c 38 f8 3f 01>,
  absValidity: 2018-08-27T06:58:01.540Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c6 e9 ff 9a 13 d2 34 25>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c6 e9 ff 9a 13 d2 34 25> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.53:57700',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200066
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38214
received auth hello!
{ authId: 402, nonce: <Buffer 0e 0d f7 71 5c 92 04 46> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer db 99 c8 c5 2a b4 b9 5a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f3 cb fb fc 56 fa 5e 00>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f3 cb fb fc 56 fa 5e 00> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.53:57874',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200073
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38486
received auth hello!
{ authId: 402, nonce: <Buffer 0a 94 2a 3e f6 e4 de 40> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d6 d8 09 30 36 89 f7 98>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e9 3d d6 af 59 63 d7 67>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e9 3d d6 af 59 63 d7 67> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.53:58146',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200080
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38756
received auth hello!
{ authId: 402, nonce: <Buffer 9b 47 da 37 bb 49 ca 82> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1c 72 01 86 3c a3 88 06>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4c ad c0 a0 f2 cd d1 cb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4c ad c0 a0 f2 cd d1 cb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.53:58416',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200087
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39026
received auth hello!
{ authId: 402, nonce: <Buffer 6e 42 8c 34 32 c7 41 46> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d5 8e 06 e6 9e a1 10 d3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5f ef 65 20 e5 34 37 30>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5f ef 65 20 e5 34 37 30> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.53:58686',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200094
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39296
received auth hello!
{ authId: 402, nonce: <Buffer ce 3d c2 3b 81 1c ab 7c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2b 3f 22 53 6c 24 e8 36>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8a ab cf 84 a9 3f e0 2b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8a ab cf 84 a9 3f e0 2b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.53:58956',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200101
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39600
received auth hello!
{ authId: 402, nonce: <Buffer 07 1b 7e 24 2d 89 d2 c9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ca 1f 3e 91 be 65 5e 86>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 33 ec 5d bb 3a f0 96 19>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 33 ec 5d bb 3a f0 96 19> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.53:59260',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200108
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39866
received auth hello!
{ authId: 402, nonce: <Buffer f3 db fd e2 35 fd a7 b8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c5 b9 6a 4e 4b 28 ad b6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4c 1e 5d b0 06 2c 41 37>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4c 1e 5d b0 06 2c 41 37> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.53:59526',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300260
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300269
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 37468
received auth hello!
{ authId: 503, nonce: <Buffer 1b 95 1e a8 5f 04 18 3e> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth503',
     commonName: '10.0.1.6' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth402',
     commonName: '10.0.0.2' },
  serial: '016579F4504F',
  notBefore: 2018-08-27T05:54:39.000Z,
  notAfter: 2018-08-28T05:56:19.000Z,
  subjectHash: '5542437f',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'AC:D1:85:E5:F5:A6:99:63:A4:B4:8B:7C:65:46:18:6D:63:1D:40:62',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'C063304DB50CD53E197DA75E4D40E26CDC5CD8A0B32AE61DE61F1B45D952A4AF504A623AA81A434BF3E719B4A8575E7DDC5B6CC79B91CF65119617906A6FA524F36EC3EAE0F3DABF0A5C0AF3124582FA817364EADACDA8D4A54541FE1D7273B13153904D7ABF1DD6A3BF9BFA47F7F69CD4C5F6151308FEBCE9EE63FDB48DE4B6C6978CC71151410FFAF44FDE861DF2EDC5F88548D16C40246200EED97C3B814BDC01DD1AFC3F60F99ABEBD64A0E24D8796B1FE22F89D53C7EB16B6B4F840F5DB2C5AEC1002EF2EA80C5AB75602301EFC5B3670EC56D96F7DE45F5A21269F4EDB30218677BC8AFCD1869D96E6E189BBBD3B0DD9515A937856DB9BE293411F4ACD',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.6' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 503,
  host: '10.0.1.6',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWV59FBPMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDIxETAPBgNVBAMMCDEwLjAuMC4yMB4XDTE4MDgy\nNzA1NTQzOVoXDTE4MDgyODA1NTYxOVowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMzERMA8GA1UEAwwIMTAuMC4xLjYwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDAYzBNtQzVPhl9p15NQOJs3FzYoLMq5h3mHxtF2VKkr1BKYjqo\nGkNL8+cZtKhXXn3cW2zHm5HPZRGWF5Bqb6Uk827D6uDz2r8KXArzEkWC+oFzZOra\nzajUpUVB/h1yc7ExU5BNer8d1qO/m/pH9/ac1MX2FRMI/rzp7mP9tI3ktsaXjMcR\nUUEP+vRP3oYd8u3F+IVI0WxAJGIA7tl8O4FL3AHdGvw/YPmavr1koOJNh5ax/iL4\nnVPH6xa2tPhA9dssWuwQAu8uqAxat1YCMB78WzZw7FbZb33kX1ohJp9O2zAhhne8\nivzRhp2W5uGJu707DdlRWpN4Vtub4pNBH0rNAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQYwDQYJKoZIhvcNAQELBQADggEBAANQqLtJhdfLybN25JD0l5SSrH681V5Z\nTd5ldQ96FrIpNBx2e8N8Fdh94E+pGmFPH7Y1L/qpZ90Y/9YvBrOciURRxHe0cwE0\nOFCugfV/qguiBj3uiEdiWcRH1S9kHh+yh96jzt+Jao4FXmYJjYF5ArfQkV8HCpPv\npiKOlgQOXNxNJPpz/8GCokEia7stTge2lF3O2s0s0tonex2LlAJzj1fw5dkEDfEw\nlk+3+cdRCR6AITJio+PeTJwpFq5iv2QM1EoQUaP7AM9gBEb0RQDl1lMQ0TfSf3Ab\nYnc2eIKzny1muJvzMEYuDRBn2PKKcgICHeQcY5rOuR0DWDwaAmXqhpg=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300278
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37684
received auth hello!
{ authId: 503, nonce: <Buffer 9b 30 f2 e0 88 67 16 18> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 6e 6d 71 32 7e cb 79 2d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 88 e7 7d 8f 5d 27 b1 8e 34 52 7d 19 f6 f4 2f 2b>,
  macKeyVal: <Buffer 4f af ba 2d c4 ee 4b 0e ca 48 21 0c e2 2d 6c 77 6d d3 99 82 6e 7d ae 0e 1d 79 d8 9c 72 30 a0 d0>,
  absValidity: 2018-08-27T07:10:00.694Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 61 65 99 e7 9a 38 ac 51>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 61 65 99 e7 9a 38 ac 51> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.53:60646',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300287
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37904
received auth hello!
{ authId: 503, nonce: <Buffer a9 68 dd fc f8 19 78 7d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 54 08 a6 2d 28 69 3e a8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fa 61 0c 52 dc 82 cc 50>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fa 61 0c 52 dc 82 cc 50> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.53:60866',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300296
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38114
received auth hello!
{ authId: 503, nonce: <Buffer d0 8e 9b 11 af 69 ab c6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3b 06 4a be 48 a0 db 80>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ea 03 e5 24 0d 91 97 e4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ea 03 e5 24 0d 91 97 e4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.53:32844',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300305
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38336
received auth hello!
{ authId: 503, nonce: <Buffer 71 b2 ad 23 8d 2d 4f 5c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7b d1 2d b5 be a3 97 72>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1a a2 67 9a 0b ad c4 50>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 1a a2 67 9a 0b ad c4 50> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.53:33066',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300314
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38546
received auth hello!
{ authId: 503, nonce: <Buffer 2b 88 ec c8 d4 a1 12 ef> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cf 45 9a 92 7a 60 f5 30>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 78 b5 ec 37 bf 46 06 5b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 78 b5 ec 37 bf 46 06 5b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.53:33276',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300323
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38750
received auth hello!
{ authId: 503, nonce: <Buffer d5 b2 ac f8 f1 a3 4b 16> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3b da e6 12 69 39 bf 24>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 17 a7 66 63 45 91 22 b5>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 17 a7 66 63 45 91 22 b5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.53:33480',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300332
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38978
received auth hello!
{ authId: 503, nonce: <Buffer f9 91 05 6c f7 ea 85 5c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 54 13 6c f5 d8 24 c4 7b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d5 b4 57 5c a6 b9 15 1c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d5 b4 57 5c a6 b9 15 1c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.53:33706',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300341
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39202
received auth hello!
{ authId: 503, nonce: <Buffer d6 66 e0 d5 bb 60 f4 4f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer aa f2 8c 0c 7e 09 31 4e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 04 59 00 b3 78 d3 bf a3>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 04 59 00 b3 78 d3 bf a3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.53:33932',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300350
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39424
received auth hello!
{ authId: 503, nonce: <Buffer b3 34 74 76 84 ac e6 04> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 62 e6 b6 bb e8 d0 b6 36>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c8 31 d7 f7 4c b3 4e 3c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c8 31 d7 f7 4c b3 4e 3c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.53:34154',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300359
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39636
received auth hello!
{ authId: 503, nonce: <Buffer 55 02 61 76 7b 63 e6 58> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f0 d5 34 73 33 cb 5c 6f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 09 0a eb b8 6f c8 61 78>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 09 0a eb b8 6f c8 61 78> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.53:34366',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300368
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39854
received auth hello!
{ authId: 503, nonce: <Buffer f8 2c e4 e7 2d 19 55 31> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7c 0f 89 73 8d 4c 33 7f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e0 25 8f 06 73 61 e2 11>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e0 25 8f 06 73 61 e2 11> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.53:34584',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300377
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40068
received auth hello!
{ authId: 503, nonce: <Buffer 50 d2 c9 bc 69 a0 6e 5a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 32 81 7d 9f 79 90 e7 a9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5a 98 a0 bc 3d a6 6f 5a>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 5a 98 a0 bc 3d a6 6f 5a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.53:34798',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300386
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40282
received auth hello!
{ authId: 503, nonce: <Buffer e9 a0 ee 11 90 03 70 e1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4c d0 8a 18 ec 8e 71 ea>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 88 50 6d cc 93 ce 2d 96>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 88 50 6d cc 93 ce 2d 96> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.53:35012',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300395
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40542
received auth hello!
{ authId: 503, nonce: <Buffer d9 91 d4 f9 0b 64 a5 57> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer de e8 6b cf 76 b2 2a ac>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer dd ea 35 58 f2 72 28 b4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer dd ea 35 58 f2 72 28 b4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.53:35266',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300404
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40756
received auth hello!
{ authId: 503, nonce: <Buffer aa 78 ac 0e ff 3f ee e2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5b 33 0d 0c 0c 15 64 b0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c2 6d a9 2b 44 60 f6 dd>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c2 6d a9 2b 44 60 f6 dd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.53:35486',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300413
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40970
received auth hello!
{ authId: 503, nonce: <Buffer 47 7a 85 54 df 1e 6b 92> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b0 61 7f a8 a2 6f b4 75>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b1 6f d6 c7 76 93 3d 7d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b1 6f d6 c7 76 93 3d 7d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.53:35700',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300422
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41182
received auth hello!
{ authId: 503, nonce: <Buffer 03 31 68 01 a8 98 ef 8b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ee 6d ae cd 08 44 07 33>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f3 b5 17 4f 15 7e 2a 7f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f3 b5 17 4f 15 7e 2a 7f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 24,
  remoteAddress: '::ffff:10.0.1.53:35912',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 24 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 24 }
specified socketID: 24
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #24 closed
