changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s504.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's504',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 67 49 42 41 41 4b 43 41 51 45 41 33 38 ... > }
Handler: listening on port 22100
s504:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100059
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39762
received auth hello!
{ authId: 501, nonce: <Buffer db 7f 7d d8 fb 55 c4 07> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 42 02 54 1f 25 86 b7 58>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 77 c5 63 65 a8 11 6d 01 bc 47 54 a0 3d be 2b 73>,
  macKeyVal: <Buffer 03 eb 09 3c fe 5b 8b 73 8a a9 2c 6b 49 80 de 9a 26 3b 7d 01 af 6c c5 81 f5 8d 45 44 b3 d7 0b 5f>,
  absValidity: 2018-08-27T06:58:46.195Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1a 2f e8 53 49 34 68 a1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1a 2f e8 53 49 34 68 a1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.67:43836',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100067
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40018
received auth hello!
{ authId: 501, nonce: <Buffer 88 e0 5c 2b 1c 8c fc a8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 65 46 78 c5 86 44 00 c8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 43 ed 34 48 78 b3 3b da>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 43 ed 34 48 78 b3 3b da> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.67:44092',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100075
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40288
received auth hello!
{ authId: 501, nonce: <Buffer 50 33 ec 17 26 1a 46 0f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 42 44 0c e9 8f 16 70 cd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0d bf 9e e7 fd d9 3a c8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0d bf 9e e7 fd d9 3a c8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.67:44362',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100083
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40558
received auth hello!
{ authId: 501, nonce: <Buffer 84 00 50 fa 4b f0 0d d9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 47 4a 31 76 69 b5 3a fa>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c1 a2 8a 81 4b 05 4f 2b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c1 a2 8a 81 4b 05 4f 2b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.67:44632',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100091
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40828
received auth hello!
{ authId: 501, nonce: <Buffer ba b0 d4 92 34 bf e8 b2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 56 0e 61 df 7a 41 ce 3c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b7 24 19 48 73 0e 18 d9>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b7 24 19 48 73 0e 18 d9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.67:44902',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100099
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41132
received auth hello!
{ authId: 501, nonce: <Buffer 4d 11 c5 30 d7 c1 b7 87> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 54 8c 70 65 e8 33 62 ec>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f2 ba 3d 4d c3 4b aa b6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f2 ba 3d 4d c3 4b aa b6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.67:45206',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100107
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41402
received auth hello!
{ authId: 501, nonce: <Buffer 7d 31 e9 5c ca 5d ca a0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fb 63 e9 f0 a5 13 58 e0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 69 bf a8 13 8e f7 6b b1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 69 bf a8 13 8e f7 6b b1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.67:45476',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200378
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200393
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 36166
received auth hello!
{ authId: 502, nonce: <Buffer 6f f1 c2 c8 65 bb 51 b1> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '016579F45321',
  notBefore: 2018-08-27T05:54:39.000Z,
  notAfter: 2018-08-28T05:56:19.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'C5:B5:0D:4B:A2:32:14:F7:83:03:42:7A:0D:9B:9A:99:50:82:BA:B2',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'A31E9022457B05D056C9FDEDB58BC733BB1B97C16EF02448C451D7DA8BD15C69BDB461E2FD275C96206B77B283645D6BCD71B284A7AC0F1477E8D62ECAA762A3FA674E23957AED10D73D8ED8838AC41A47FAF8FB50BCB1B3A57C246D7D1861A3880C7CCFDEEB58259C62F656BDFDD4ABE6096C88FFA9EEEF3D32230BB86D8FF4C534038264055EB8B3972DC370931A0A38091A1287BFF40D2EF7D92570D86B1837F35A2EA3F7B96EA0870826501C88C4DC0639DA69AE419D997562C46AF20F50D09554213C3EE69AE5685E2446DC62A309CD065472D9BC7AD27221D047D12C6241DBDF5C65881B877D96358D4C273A9F3D8D02DEB84D0581B7EB28209680C6AD',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWV59FMhMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDgy\nNzA1NTQzOVoXDTE4MDgyODA1NTYxOVowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQCjHpAiRXsF0FbJ/e21i8czuxuXwW7wJEjEUdfai9Fcab20YeL9\nJ1yWIGt3soNkXWvNcbKEp6wPFHfo1i7Kp2Kj+mdOI5V67RDXPY7Yg4rEGkf6+PtQ\nvLGzpXwkbX0YYaOIDHzP3utYJZxi9la9/dSr5glsiP+p7u89MiMLuG2P9MU0A4Jk\nBV64s5ctw3CTGgo4CRoSh7/0DS732SVw2GsYN/NaLqP3uW6ghwgmUByIxNwGOdpp\nrkGdmXVixGryD1DQlVQhPD7mmuVoXiRG3GKjCc0GVHLZvHrSciHQR9EsYkHb31xl\niBuHfZY1jUwnOp89jQLeuE0FgbfrKCCWgMatAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBABnwgP6upwjSVwQ+8rJAKHvbXZEKwiZJ\nMDbUo7tMGyXalN421P7YyEAel7wgZiWOWQ0TUe6eVA/RkJuBZjGmli9cS08h2NId\noZrTCDWsbSmFowLc8160KBezS1TA20DGOashAJKl53uAZ9P82HApDNed+97DXNM/\npDTsWXYm3c15QQgrP20uoCVdSJevnym3XKPIawRU2dMARONeAqMl27K8HgrEy3lG\nPuQZbCZcZwnNrGLrQ24pLWj6iyNNTXMRDNacouHJLmlsJAEgr7+fW1XwyLFrxhzY\nCGp4ackWUgZNoVTJi/JcA481M0pCqUvbEugwMHG0uS4IW56V+YH5XFw=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200411
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36398
received auth hello!
{ authId: 502, nonce: <Buffer c7 03 eb bc 0a c2 26 11> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 4e eb db 04 c8 24 f0 be>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 17 8f fd f2 35 65 e0 51 6b 58 3f ed 3a 3a 19 53>,
  macKeyVal: <Buffer c8 af 7e 8a 97 9c 91 91 35 52 9b 66 20 0a 18 97 eb 32 24 47 ee 68 fa 21 a6 09 c0 bc f1 dc c9 47>,
  absValidity: 2018-08-27T07:09:49.581Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 68 29 82 0f 14 be 23 91>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 68 29 82 0f 14 be 23 91> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.67:46610',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200426
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36628
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 5a 77 9c ba 95 68 0a 66> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d7 db 2b f2 07 81 08 36>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c7 55 49 2e be 5e 89 f3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c7 55 49 2e be 5e 89 f3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.67:46840',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200437
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36830
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer c2 2e a9 5e 79 69 b4 95> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ef 83 02 ed c5 5b b1 fb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0b 91 b0 fd bc a8 b3 e0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0b 91 b0 fd bc a8 b3 e0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.67:47042',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200450
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37046
received auth hello!
{ authId: 502, nonce: <Buffer bf 89 10 d3 61 ea 7e c2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b5 46 af bd 9a fc 85 1f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6f 91 b5 4c c6 b9 4e a2>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 6f 91 b5 4c c6 b9 4e a2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.67:47258',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200478
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37524
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 5e 2f f1 9c c1 90 94 bc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0b c1 f2 97 c0 82 4a bb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5a db 9d 45 29 f2 18 b1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5a db 9d 45 29 f2 18 b1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.67:47736',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200534
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38358
received auth hello!
{ authId: 502, nonce: <Buffer 32 59 88 25 da ee 75 4e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cf b5 23 09 6f 04 39 0d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9d 96 81 5f b6 d4 d0 38>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 9d 96 81 5f b6 d4 d0 38> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.67:48570',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200549
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38572
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 95 09 f9 31 0d 7b e9 3c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0c bb 56 91 14 72 c3 9f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8b 43 64 42 3a 87 d8 5d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8b 43 64 42 3a 87 d8 5d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.67:48784',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200563
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38786
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer c9 c1 f6 0c 51 49 16 75> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ca 43 dd a1 fb 20 5a a7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 95 49 db d0 f4 32 63 0f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 95 49 db d0 f4 32 63 0f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.67:48998',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200578
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39004
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200592
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39244
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 2b de 0f 78 73 d6 00 47> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e6 fe de 32 b1 0e c1 02>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cb ef 43 a5 b0 56 49 a1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer cb ef 43 a5 b0 56 49 a1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.67:49456',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200619
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39694
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 7f 4d 6d a9 76 e5 72 ad> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0c a0 d2 a3 dd f1 0c 08>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ee cb 23 09 5b 15 80 0f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ee cb 23 09 5b 15 80 0f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.67:49906',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200631
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39900
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
received auth hello!
{ authId: 502, nonce: <Buffer 97 5e f1 bc 50 49 7d ed> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: write after end
disconnected from auth
received auth hello!
{ authId: 502, nonce: <Buffer c3 ca 11 9b f2 91 a8 48> }
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: write after end
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in server - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.4:21100
disconnected from auth
Handler: Error in server - details: Connection with Auth timed out...
