changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c417.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c417',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 32 62 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1535349498834
connected to auth! from local port 59262
received auth hello!
{ authId: 403, nonce: <Buffer 4e ee f6 7d 4d 80 2a 53> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer c6 99 1d d3 d6 76 f8 21>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 86 e0 85 e9 a7 e2 ac c2 f3 0a 8d 39 70 ad 20 33>,
  macKeyVal: <Buffer 01 aa bb 56 93 1e 77 e9 80 d7 8f 53 b2 f0 6a a6 d2 d7 a4 36 4d 43 3a 59 d7 96 6b ec 08 4a b1 e2>,
  absValidity: 2018-08-27T06:58:19.014Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300266,
  cipherKeyVal: <Buffer 4c 35 3c 2b 4d dc 45 30 07 b8 c3 43 42 be c2 55>,
  macKeyVal: <Buffer 55 e7 f1 57 15 5f ac 12 83 77 b7 d0 a8 4b ee 6f f9 46 a8 a0 62 ab 6e 5c 45 56 b0 ed 92 6c 7b 1b>,
  absValidity: 2018-08-28T05:58:19.014Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.22',
  serverPort: 22100,
  sessionKey: 
   { id: 40300266,
     cipherKeyVal: <Buffer 4c 35 3c 2b 4d dc 45 30 07 b8 c3 43 42 be c2 55>,
     macKeyVal: <Buffer 55 e7 f1 57 15 5f ac 12 83 77 b7 d0 a8 4b ee 6f f9 46 a8 a0 62 ab 6e 5c 45 56 b0 ed 92 6c 7b 1b>,
     absValidity: 2018-08-28T05:58:19.014Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 61 3f e9 af 7a ad 3f 0f>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 05:58:20 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1535349500681
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1535349558893
connected to auth! from local port 59468
received auth hello!
{ authId: 403, nonce: <Buffer eb 68 59 b5 51 7a c6 a2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5d e3 17 07 d3 ac 58 64>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300272,
  cipherKeyVal: <Buffer 88 e1 5e 61 ac 98 82 ff bd 63 2a 56 41 6d ae c4>,
  macKeyVal: <Buffer 4b 5a ff 6a 5c a7 cf 1a e3 be 98 31 01 cc a2 3c 8c 9c ab 9c c7 ae 31 8c 33 8a fd 6d 73 1a f1 a3>,
  absValidity: 2018-08-28T05:59:19.149Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.22',
  serverPort: 22100,
  sessionKey: 
   { id: 40300272,
     cipherKeyVal: <Buffer 88 e1 5e 61 ac 98 82 ff bd 63 2a 56 41 6d ae c4>,
     macKeyVal: <Buffer 4b 5a ff 6a 5c a7 cf 1a e3 be 98 31 01 cc a2 3c 8c 9c ab 9c c7 ae 31 8c 33 8a fd 6d 73 1a f1 a3>,
     absValidity: 2018-08-28T05:59:19.149Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer ec 1a 4f b5 8f 59 eb ab>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 05:59:20 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1535349560759
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1535349618952
connected to auth! from local port 59740
received auth hello!
{ authId: 403, nonce: <Buffer 17 34 ea dd 05 65 90 e9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 19 ad 0b 0b f3 c0 bb c6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300278,
  cipherKeyVal: <Buffer 5f 02 4c 96 3d 41 3b ce 85 ce d4 75 75 e3 22 2f>,
  macKeyVal: <Buffer f7 cd 4a b5 de d0 13 5f ca d0 7e 14 cd 4a f2 79 cc 13 cd e1 f9 14 09 2d ac 6f 6d 57 ac 55 40 ea>,
  absValidity: 2018-08-28T06:00:19.153Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.22',
  serverPort: 22100,
  sessionKey: 
   { id: 40300278,
     cipherKeyVal: <Buffer 5f 02 4c 96 3d 41 3b ce 85 ce d4 75 75 e3 22 2f>,
     macKeyVal: <Buffer f7 cd 4a b5 de d0 13 5f ca d0 7e 14 cd 4a f2 79 cc 13 cd e1 f9 14 09 2d ac 6f 6d 57 ac 55 40 ea>,
     absValidity: 2018-08-28T06:00:19.153Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer e2 c7 b7 4f 36 21 a5 36>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 06:00:20 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1535349620810
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1535349678996
connected to auth! from local port 60010
received auth hello!
{ authId: 403, nonce: <Buffer 79 a0 67 bd 16 2d 50 d5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 89 69 d8 d1 05 fa 2b 18>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300284,
  cipherKeyVal: <Buffer 81 98 ed 3b ea 5d 12 47 3f fc 2e 21 c7 29 7f f0>,
  macKeyVal: <Buffer 62 a8 90 bd 40 94 02 6d a7 87 a7 5e 55 c5 d2 39 ed 5f f9 72 81 79 fc 38 d5 01 6d c7 7d f4 bb be>,
  absValidity: 2018-08-28T06:01:19.195Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.22',
  serverPort: 22100,
  sessionKey: 
   { id: 40300284,
     cipherKeyVal: <Buffer 81 98 ed 3b ea 5d 12 47 3f fc 2e 21 c7 29 7f f0>,
     macKeyVal: <Buffer 62 a8 90 bd 40 94 02 6d a7 87 a7 5e 55 c5 d2 39 ed 5f f9 72 81 79 fc 38 d5 01 6d c7 7d f4 bb be>,
     absValidity: 2018-08-28T06:01:19.195Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 5a e1 98 87 d8 9e 56 e0>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 06:01:20 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1535349680827
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1535349739055
connected to auth! from local port 60280
received auth hello!
{ authId: 403, nonce: <Buffer 5a a0 1b af d3 24 74 e3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4e a0 5d 5b 69 b4 87 7e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300290,
  cipherKeyVal: <Buffer f9 1f 2e c4 4a be 50 a5 c8 f8 be 9e 23 89 a7 cc>,
  macKeyVal: <Buffer 05 fe c2 05 c7 52 89 5a ce 53 59 29 c9 eb b5 0a e2 54 5c e1 a7 dc 42 20 3c d0 8a 9f 26 f4 1a cc>,
  absValidity: 2018-08-28T06:02:19.273Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.22',
  serverPort: 22100,
  sessionKey: 
   { id: 40300290,
     cipherKeyVal: <Buffer f9 1f 2e c4 4a be 50 a5 c8 f8 be 9e 23 89 a7 cc>,
     macKeyVal: <Buffer 05 fe c2 05 c7 52 89 5a ce 53 59 29 c9 eb b5 0a e2 54 5c e1 a7 dc 42 20 3c d0 8a 9f 26 f4 1a cc>,
     absValidity: 2018-08-28T06:02:19.273Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer fd 72 a0 aa c7 5e 07 06>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 06:02:20 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1535349740896
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1535349799078
connected to auth! from local port 60554
received auth hello!
{ authId: 403, nonce: <Buffer c2 72 01 06 5c dd 20 09> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 62 4b b0 8e a3 3f 7d 64>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300296,
  cipherKeyVal: <Buffer 07 ac d7 1d 8e 8c bd cf bb af c2 6b 19 4c 35 1d>,
  macKeyVal: <Buffer a7 88 0e 9b a6 db 09 c6 25 e1 8f 07 b5 51 9d 5c 28 3c 60 d3 80 7f 40 76 2a 87 fd f8 3c 93 2f 72>,
  absValidity: 2018-08-28T06:03:19.302Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.22',
  serverPort: 22100,
  sessionKey: 
   { id: 40300296,
     cipherKeyVal: <Buffer 07 ac d7 1d 8e 8c bd cf bb af c2 6b 19 4c 35 1d>,
     macKeyVal: <Buffer a7 88 0e 9b a6 db 09 c6 25 e1 8f 07 b5 51 9d 5c 28 3c 60 d3 80 7f 40 76 2a 87 fd f8 3c 93 2f 72>,
     absValidity: 2018-08-28T06:03:19.302Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 7e 1c 0e f3 02 0b a5 a6>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 06:03:20 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1535349800937
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1535349859084
connected to auth! from local port 60854
received auth hello!
{ authId: 403, nonce: <Buffer 6b 5b 04 c6 79 de b8 a0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 21 b4 14 8b 2b 73 80 53>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300302,
  cipherKeyVal: <Buffer f7 d9 27 13 3c 85 7d 8a 54 4f f2 01 08 00 c4 66>,
  macKeyVal: <Buffer a3 70 51 d0 dd 48 14 95 6e ae 1d 29 0c 4a 29 25 52 4c d6 fe 18 00 f6 03 8a 7a c5 9a dc 8d 31 ca>,
  absValidity: 2018-08-28T06:04:19.288Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.22',
  serverPort: 22100,
  sessionKey: 
   { id: 40300302,
     cipherKeyVal: <Buffer f7 d9 27 13 3c 85 7d 8a 54 4f f2 01 08 00 c4 66>,
     macKeyVal: <Buffer a3 70 51 d0 dd 48 14 95 6e ae 1d 29 0c 4a 29 25 52 4c d6 fe 18 00 f6 03 8a 7a c5 9a dc 8d 31 ca>,
     absValidity: 2018-08-28T06:04:19.288Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer e9 fa 09 32 c4 c7 19 27>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 06:04:20 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1535349860955
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1535349919101
connected to auth! from local port 32884
received auth hello!
{ authId: 403, nonce: <Buffer ee 31 06 26 8a a6 e2 29> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f6 25 46 db c9 f6 3f 64>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300308,
  cipherKeyVal: <Buffer d5 94 96 50 3e 56 8d b6 1e fe 8d ba 16 e2 55 7d>,
  macKeyVal: <Buffer 7c 1a dd f3 79 e3 e7 ce b3 a9 98 56 41 43 31 10 d1 42 b3 8e 95 2f 3b b4 f6 e7 a8 c7 5a 23 9b 56>,
  absValidity: 2018-08-28T06:05:19.346Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.22',
  serverPort: 22100,
  sessionKey: 
   { id: 40300308,
     cipherKeyVal: <Buffer d5 94 96 50 3e 56 8d b6 1e fe 8d ba 16 e2 55 7d>,
     macKeyVal: <Buffer 7c 1a dd f3 79 e3 e7 ce b3 a9 98 56 41 43 31 10 d1 42 b3 8e 95 2f 3b b4 f6 e7 a8 c7 5a 23 9b 56>,
     absValidity: 2018-08-28T06:05:19.346Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer e1 f5 6d 57 7c c9 dc f9>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 06:05:20 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 8 1 1535349920994
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 9 0.8888888888888888 1535349979159
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.3:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 10 0.8 1535350039169
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.3:21100
connected to auth! from local port 48106
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 11 0.7272727272727273 1535350099177
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.3:21100
connected to auth! from local port 48350
/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902
            eventHandlers.onError('Error occurred in migration request: Disconnected from auth before getting migration response: ' + error);
                                                                                                                                      ^

ReferenceError: error is not defined
    at Socket.<anonymous> (/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902:135)
    at emitNone (events.js:91:20)
    at Socket.emit (events.js:188:7)
    at endReadableNT (_stream_readable.js:975:12)
    at _combinedTickCallback (internal/process/next_tick.js:80:11)
    at process._tickCallback (internal/process/next_tick.js:104:9)
