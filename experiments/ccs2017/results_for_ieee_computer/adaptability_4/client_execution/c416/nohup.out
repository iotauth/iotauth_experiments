changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c416.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c416',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 7a 64 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1535349495591
connected to auth! from local port 45676
received auth hello!
{ authId: 403, nonce: <Buffer 0f b7 85 15 1c 87 c9 31> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 25 39 0f df ed 0b a2 bf>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer f9 ae 20 47 bb c7 4b 1f 54 18 fb ce b3 ee ad e8>,
  macKeyVal: <Buffer 09 10 7b 65 fc 4d e0 e7 a5 1e 10 8a 48 f3 14 20 9d a7 42 a9 f6 8e fa f9 d3 61 dd 84 61 f7 c7 c8>,
  absValidity: 2018-08-27T06:58:15.765Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300265,
  cipherKeyVal: <Buffer de ce 64 8c c3 e4 b1 1a a1 f4 6a 4f 6a 92 f1 52>,
  macKeyVal: <Buffer de 08 26 43 7e 81 e7 44 f2 b0 1d a7 a7 fc c4 61 80 27 b9 f9 82 6f 94 2e dc 43 86 a1 9e 81 c9 0b>,
  absValidity: 2018-08-28T05:58:15.765Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.20',
  serverPort: 22100,
  sessionKey: 
   { id: 40300265,
     cipherKeyVal: <Buffer de ce 64 8c c3 e4 b1 1a a1 f4 6a 4f 6a 92 f1 52>,
     macKeyVal: <Buffer de 08 26 43 7e 81 e7 44 f2 b0 1d a7 a7 fc c4 61 80 27 b9 f9 82 6f 94 2e dc 43 86 a1 9e 81 c9 0b>,
     absValidity: 2018-08-28T05:58:15.765Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer a3 ba 4e 6a e9 15 79 c1>
switching to HANDSHAKE_1_SENT
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 05:58:16 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1535349496738
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1535349555648
connected to auth! from local port 45880
received auth hello!
{ authId: 403, nonce: <Buffer 58 76 5f f8 e7 61 69 00> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f3 16 a4 4e 7d eb 5d 01>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300271,
  cipherKeyVal: <Buffer 27 db 9a 31 ed e3 02 b4 d7 34 9c c7 f9 69 5f 26>,
  macKeyVal: <Buffer 8b 69 2e ed 9f f4 26 cd 5b 32 fb 4c 20 1c 77 e5 9e 30 1f ad 71 c0 9b af ba 82 83 94 2c d4 df 89>,
  absValidity: 2018-08-28T05:59:15.875Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.20',
  serverPort: 22100,
  sessionKey: 
   { id: 40300271,
     cipherKeyVal: <Buffer 27 db 9a 31 ed e3 02 b4 d7 34 9c c7 f9 69 5f 26>,
     macKeyVal: <Buffer 8b 69 2e ed 9f f4 26 cd 5b 32 fb 4c 20 1c 77 e5 9e 30 1f ad 71 c0 9b af ba 82 83 94 2c d4 df 89>,
     absValidity: 2018-08-28T05:59:15.875Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 15 89 c8 3a b7 48 0b 49>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 05:59:16 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1535349556806
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1535349615676
connected to auth! from local port 46152
received auth hello!
{ authId: 403, nonce: <Buffer 3b 4f 21 fd f1 e3 0f 39> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 23 6f 82 82 29 15 df d9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300277,
  cipherKeyVal: <Buffer 68 80 bb ad 30 52 0b ab 4d 65 f7 76 d8 73 dd b0>,
  macKeyVal: <Buffer 41 ec 10 c8 e3 74 b4 e9 f9 18 ad 55 19 14 7f f9 b5 c5 a4 15 93 9d af 4f 4f 51 3a 10 b2 2b e6 93>,
  absValidity: 2018-08-28T06:00:15.849Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.20',
  serverPort: 22100,
  sessionKey: 
   { id: 40300277,
     cipherKeyVal: <Buffer 68 80 bb ad 30 52 0b ab 4d 65 f7 76 d8 73 dd b0>,
     macKeyVal: <Buffer 41 ec 10 c8 e3 74 b4 e9 f9 18 ad 55 19 14 7f f9 b5 c5 a4 15 93 9d af 4f 4f 51 3a 10 b2 2b e6 93>,
     absValidity: 2018-08-28T06:00:15.849Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer fe fd 0e ad c8 9e 14 98>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 06:00:16 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1535349616852
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1535349675702
connected to auth! from local port 46422
received auth hello!
{ authId: 403, nonce: <Buffer 3b 4b a9 0d 26 17 ff d6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 81 28 b8 b6 bd e7 0a a3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300283,
  cipherKeyVal: <Buffer f0 ca fc 19 70 d8 b3 49 62 f7 b1 a6 9d 16 6c 00>,
  macKeyVal: <Buffer 17 41 63 0b a2 61 3d 91 ee 17 db c5 9f 82 24 d0 5e f0 75 b5 f1 ea 6a 82 09 85 1e be 97 a7 bc b3>,
  absValidity: 2018-08-28T06:01:15.867Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.20',
  serverPort: 22100,
  sessionKey: 
   { id: 40300283,
     cipherKeyVal: <Buffer f0 ca fc 19 70 d8 b3 49 62 f7 b1 a6 9d 16 6c 00>,
     macKeyVal: <Buffer 17 41 63 0b a2 61 3d 91 ee 17 db c5 9f 82 24 d0 5e f0 75 b5 f1 ea 6a 82 09 85 1e be 97 a7 bc b3>,
     absValidity: 2018-08-28T06:01:15.867Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer db 87 4d f3 25 64 17 81>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 06:01:16 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1535349676844
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1535349735760
connected to auth! from local port 46692
received auth hello!
{ authId: 403, nonce: <Buffer e1 a6 83 36 d9 b6 d6 af> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4e 93 82 49 56 8e fe 30>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300289,
  cipherKeyVal: <Buffer 15 ab 01 75 b6 22 6c dc 54 f4 b6 ab 0a d4 ae 55>,
  macKeyVal: <Buffer c9 3d 10 58 dc a5 ae d5 23 82 dd cb d7 ad 49 b7 5a f1 dc c0 6f 23 64 2c 98 5c a6 be 12 bd 23 c9>,
  absValidity: 2018-08-28T06:02:15.936Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.20',
  serverPort: 22100,
  sessionKey: 
   { id: 40300289,
     cipherKeyVal: <Buffer 15 ab 01 75 b6 22 6c dc 54 f4 b6 ab 0a d4 ae 55>,
     macKeyVal: <Buffer c9 3d 10 58 dc a5 ae d5 23 82 dd cb d7 ad 49 b7 5a f1 dc c0 6f 23 64 2c 98 5c a6 be 12 bd 23 c9>,
     absValidity: 2018-08-28T06:02:15.936Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 46 98 1c cd 36 04 ca 00>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 06:02:16 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1535349736886
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1535349795819
connected to auth! from local port 46962
received auth hello!
{ authId: 403, nonce: <Buffer 03 cc 42 42 db f5 e0 05> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 96 25 bf 11 57 f9 80 78>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300295,
  cipherKeyVal: <Buffer 17 f3 b4 e1 8e 2e ec b6 1f 44 af 9a 3c db dc 1a>,
  macKeyVal: <Buffer 2e 7d ed f7 58 21 3b 3d 78 f1 0c 9b 9e 4f f9 5d d9 66 66 6b ba 1f 64 10 13 5b ab e4 ef 10 5f 67>,
  absValidity: 2018-08-28T06:03:15.981Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.20',
  serverPort: 22100,
  sessionKey: 
   { id: 40300295,
     cipherKeyVal: <Buffer 17 f3 b4 e1 8e 2e ec b6 1f 44 af 9a 3c db dc 1a>,
     macKeyVal: <Buffer 2e 7d ed f7 58 21 3b 3d 78 f1 0c 9b 9e 4f f9 5d d9 66 66 6b ba 1f 64 10 13 5b ab e4 ef 10 5f 67>,
     absValidity: 2018-08-28T06:03:15.981Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 1a 86 c2 0c 01 39 02 00>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 06:03:16 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1535349796989
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1535349855849
connected to auth! from local port 47266
received auth hello!
{ authId: 403, nonce: <Buffer 06 32 2b 04 1a 8f e2 24> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0c 78 78 98 d9 0e fa 66>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300301,
  cipherKeyVal: <Buffer 70 21 c7 48 1c 68 e2 7d 8c 67 30 22 52 13 f2 09>,
  macKeyVal: <Buffer de c2 f5 8c 35 5e c1 0b 6a c5 c2 bf cb f7 41 72 cf a5 71 4c 43 9c 9c 63 e2 79 54 da cd 93 25 af>,
  absValidity: 2018-08-28T06:04:15.988Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.20',
  serverPort: 22100,
  sessionKey: 
   { id: 40300301,
     cipherKeyVal: <Buffer 70 21 c7 48 1c 68 e2 7d 8c 67 30 22 52 13 f2 09>,
     macKeyVal: <Buffer de c2 f5 8c 35 5e c1 0b 6a c5 c2 bf cb f7 41 72 cf a5 71 4c 43 9c 9c 63 e2 79 54 da cd 93 25 af>,
     absValidity: 2018-08-28T06:04:15.988Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer c6 66 6c a8 b2 b3 f0 2f>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 06:04:16 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1535349856942
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1535349915908
connected to auth! from local port 47528
received auth hello!
{ authId: 403, nonce: <Buffer 7e f1 d8 8f db 14 58 38> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 77 4c fe ec cb 57 77 7a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300307,
  cipherKeyVal: <Buffer 3a 82 3b c8 bf d6 a8 5a 87 17 aa a0 c3 9c 43 f6>,
  macKeyVal: <Buffer b8 45 25 9d 1c 97 1b bc 8f 27 5b e2 f4 be 6c 2c da b1 a2 11 b7 72 d5 bd 68 2b fc 7d 9c 82 b0 4c>,
  absValidity: 2018-08-28T06:05:16.094Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.20',
  serverPort: 22100,
  sessionKey: 
   { id: 40300307,
     cipherKeyVal: <Buffer 3a 82 3b c8 bf d6 a8 5a 87 17 aa a0 c3 9c 43 f6>,
     macKeyVal: <Buffer b8 45 25 9d 1c 97 1b bc 8f 27 5b e2 f4 be 6c 2c da b1 a2 11 b7 72 d5 bd 68 2b fc 7d 9c 82 b0 4c>,
     absValidity: 2018-08-28T06:05:16.094Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer a6 08 a1 fc c2 5a 04 cf>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 06:05:16 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 8 1 1535349916931
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 9 0.8888888888888888 1535349975932
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.3:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 10 0.8 1535350035940
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.3:21100
connected to auth! from local port 39902
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 11 0.7272727272727273 1535350095944
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.3:21100
connected to auth! from local port 40146
/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902
            eventHandlers.onError('Error occurred in migration request: Disconnected from auth before getting migration response: ' + error);
                                                                                                                                      ^

ReferenceError: error is not defined
    at Socket.<anonymous> (/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902:135)
    at emitNone (events.js:91:20)
    at Socket.emit (events.js:188:7)
    at endReadableNT (_stream_readable.js:975:12)
    at _combinedTickCallback (internal/process/next_tick.js:80:11)
    at process._tickCallback (internal/process/next_tick.js:104:9)
