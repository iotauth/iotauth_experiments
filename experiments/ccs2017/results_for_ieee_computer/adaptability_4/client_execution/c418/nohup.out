changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c418.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c418',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 76 47 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1535349502094
connected to auth! from local port 37104
received auth hello!
{ authId: 403, nonce: <Buffer 8b 02 28 45 48 d2 e9 9e> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer c9 20 a7 7a d5 ad ec 49>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 33 d0 c4 e7 af c0 1e cd f3 fe ff 16 02 d2 52 c0>,
  macKeyVal: <Buffer b1 eb b8 c4 c6 29 48 a2 f7 83 66 1e 7b 39 08 4e b5 c4 7a 67 03 7a 1f b6 2d 13 37 e4 35 09 b0 9b>,
  absValidity: 2018-08-27T06:58:22.260Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300267,
  cipherKeyVal: <Buffer dc 22 53 1b 94 10 92 69 77 2d d6 56 b0 d7 99 2a>,
  macKeyVal: <Buffer 0f 9b b6 fd f0 8c ec de 78 54 b3 5c 28 18 88 c3 a2 78 f6 5c 19 26 36 63 e2 86 19 dd 3d b3 76 0e>,
  absValidity: 2018-08-28T05:58:22.260Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.23',
  serverPort: 22100,
  sessionKey: 
   { id: 40300267,
     cipherKeyVal: <Buffer dc 22 53 1b 94 10 92 69 77 2d d6 56 b0 d7 99 2a>,
     macKeyVal: <Buffer 0f 9b b6 fd f0 8c ec de 78 54 b3 5c 28 18 88 c3 a2 78 f6 5c 19 26 36 63 e2 86 19 dd 3d b3 76 0e>,
     absValidity: 2018-08-28T05:58:22.260Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer f5 51 16 16 bc f0 b8 aa>
switching to HANDSHAKE_1_SENT
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 05:58:24 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1535349504607
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1535349562137
connected to auth! from local port 37316
received auth hello!
{ authId: 403, nonce: <Buffer 29 04 7e ec b2 fe d2 f2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 15 3f eb d8 ca 8a 25 66>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300273,
  cipherKeyVal: <Buffer b4 37 15 3b 26 e6 90 3e 15 c3 ec 7a f9 a1 76 c5>,
  macKeyVal: <Buffer bf 5b a9 11 0a 1b 33 a4 ea 45 23 73 77 77 68 27 59 08 70 bf 83 11 8a 01 bd cf 34 68 45 a3 c9 ab>,
  absValidity: 2018-08-28T05:59:22.365Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.23',
  serverPort: 22100,
  sessionKey: 
   { id: 40300273,
     cipherKeyVal: <Buffer b4 37 15 3b 26 e6 90 3e 15 c3 ec 7a f9 a1 76 c5>,
     macKeyVal: <Buffer bf 5b a9 11 0a 1b 33 a4 ea 45 23 73 77 77 68 27 59 08 70 bf 83 11 8a 01 bd cf 34 68 45 a3 c9 ab>,
     absValidity: 2018-08-28T05:59:22.365Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer b4 c4 48 a0 5c 06 4e 81>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 05:59:24 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1535349564710
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1535349622192
connected to auth! from local port 37588
received auth hello!
{ authId: 403, nonce: <Buffer d9 26 d5 d2 4e 23 76 7d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3b 94 5c 31 ac 84 c5 0b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300279,
  cipherKeyVal: <Buffer 46 d4 5d 3c a8 96 36 31 fa d7 20 97 7b 60 25 1f>,
  macKeyVal: <Buffer 8c 43 7d af 4f bd 5b 3f 38 24 74 ad f4 e7 9c 35 51 45 92 f5 1b c7 ee 17 54 03 bb 56 82 87 2a c3>,
  absValidity: 2018-08-28T06:00:22.403Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.23',
  serverPort: 22100,
  sessionKey: 
   { id: 40300279,
     cipherKeyVal: <Buffer 46 d4 5d 3c a8 96 36 31 fa d7 20 97 7b 60 25 1f>,
     macKeyVal: <Buffer 8c 43 7d af 4f bd 5b 3f 38 24 74 ad f4 e7 9c 35 51 45 92 f5 1b c7 ee 17 54 03 bb 56 82 87 2a c3>,
     absValidity: 2018-08-28T06:00:22.403Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 9d 09 8b f1 ef 4d 5a 0e>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 06:00:24 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1535349624744
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1535349682246
connected to auth! from local port 37858
received auth hello!
{ authId: 403, nonce: <Buffer af 4d ac 88 1a 76 11 ac> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 39 cf 89 21 14 6d d7 66>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300285,
  cipherKeyVal: <Buffer df 8e e3 05 f2 97 02 31 b6 15 e4 a5 0d 14 b4 59>,
  macKeyVal: <Buffer f9 22 38 2e 45 a1 72 ce ac 06 69 a5 8d 00 a9 d9 94 7b bd 68 f6 ad 7e ef dc 64 73 ec 9e 72 d3 34>,
  absValidity: 2018-08-28T06:01:22.425Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.23',
  serverPort: 22100,
  sessionKey: 
   { id: 40300285,
     cipherKeyVal: <Buffer df 8e e3 05 f2 97 02 31 b6 15 e4 a5 0d 14 b4 59>,
     macKeyVal: <Buffer f9 22 38 2e 45 a1 72 ce ac 06 69 a5 8d 00 a9 d9 94 7b bd 68 f6 ad 7e ef dc 64 73 ec 9e 72 d3 34>,
     absValidity: 2018-08-28T06:01:22.425Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 4d ba 24 05 94 09 07 b0>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 06:01:24 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1535349684812
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1535349742305
connected to auth! from local port 38128
received auth hello!
{ authId: 403, nonce: <Buffer 79 8d 42 b3 94 5a 1b f6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 61 e8 30 96 61 b2 42 02>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300291,
  cipherKeyVal: <Buffer 43 73 a3 2d 02 f6 64 af a5 a9 2e e4 3e a7 0d 58>,
  macKeyVal: <Buffer 1a 95 67 7d 15 04 d5 95 b1 08 e6 b9 4d 23 67 58 d6 42 4c 14 77 63 a9 cb b9 ce cb ec ea 26 aa 68>,
  absValidity: 2018-08-28T06:02:22.503Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.23',
  serverPort: 22100,
  sessionKey: 
   { id: 40300291,
     cipherKeyVal: <Buffer 43 73 a3 2d 02 f6 64 af a5 a9 2e e4 3e a7 0d 58>,
     macKeyVal: <Buffer 1a 95 67 7d 15 04 d5 95 b1 08 e6 b9 4d 23 67 58 d6 42 4c 14 77 63 a9 cb b9 ce cb ec ea 26 aa 68>,
     absValidity: 2018-08-28T06:02:22.503Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 6a 86 0c af 17 e2 53 65>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 06:02:24 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1535349744866
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1535349802363
connected to auth! from local port 38402
received auth hello!
{ authId: 403, nonce: <Buffer 96 dd b8 10 67 f7 39 50> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 17 81 68 f2 04 15 3b 46>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300297,
  cipherKeyVal: <Buffer 93 ac 28 32 cc 66 82 18 12 88 1a 17 92 a4 d3 30>,
  macKeyVal: <Buffer 3f 59 a4 a3 e5 77 53 89 34 c8 22 ec ed 4b 62 74 ff 2c 1e 1f f8 0f ff 69 0e a5 17 cf a4 98 d8 7b>,
  absValidity: 2018-08-28T06:03:22.550Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.23',
  serverPort: 22100,
  sessionKey: 
   { id: 40300297,
     cipherKeyVal: <Buffer 93 ac 28 32 cc 66 82 18 12 88 1a 17 92 a4 d3 30>,
     macKeyVal: <Buffer 3f 59 a4 a3 e5 77 53 89 34 c8 22 ec ed 4b 62 74 ff 2c 1e 1f f8 0f ff 69 0e a5 17 cf a4 98 d8 7b>,
     absValidity: 2018-08-28T06:03:22.550Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer e9 1d ba 4e ed cf 94 09>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 06:03:24 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1535349804931
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1535349862421
connected to auth! from local port 38702
received auth hello!
{ authId: 403, nonce: <Buffer 0e dc 50 39 ee 9b dd 55> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e4 02 3f 19 2b 61 76 2c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300303,
  cipherKeyVal: <Buffer 58 4e 95 0b 56 8f 26 17 76 39 b4 79 77 cd 96 2d>,
  macKeyVal: <Buffer c6 fd 3a b5 84 a5 43 62 62 d4 cc e2 d2 92 b8 24 ac 04 97 ed e8 8b a2 cb 57 64 52 4d 86 24 bf 9e>,
  absValidity: 2018-08-28T06:04:22.590Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.23',
  serverPort: 22100,
  sessionKey: 
   { id: 40300303,
     cipherKeyVal: <Buffer 58 4e 95 0b 56 8f 26 17 76 39 b4 79 77 cd 96 2d>,
     macKeyVal: <Buffer c6 fd 3a b5 84 a5 43 62 62 d4 cc e2 d2 92 b8 24 ac 04 97 ed e8 8b a2 cb 57 64 52 4d 86 24 bf 9e>,
     absValidity: 2018-08-28T06:04:22.590Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 0c 17 ae 85 cf 7b 47 90>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 06:04:24 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1535349865008
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1535349922479
connected to auth! from local port 38964
received auth hello!
{ authId: 403, nonce: <Buffer 50 4b 81 d8 02 8d cf 77> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6f b3 e4 48 ab 90 47 48>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300309,
  cipherKeyVal: <Buffer d5 01 2b 39 d9 82 3e 2b 98 d6 c9 6f 34 c1 9a 11>,
  macKeyVal: <Buffer 9e e9 fd 1a 11 84 f1 09 bd 90 f4 42 bb 3a df 35 b5 f0 81 31 c5 1c 11 8b c4 74 5a 98 77 08 e1 09>,
  absValidity: 2018-08-28T06:05:22.622Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.23',
  serverPort: 22100,
  sessionKey: 
   { id: 40300309,
     cipherKeyVal: <Buffer d5 01 2b 39 d9 82 3e 2b 98 d6 c9 6f 34 c1 9a 11>,
     macKeyVal: <Buffer 9e e9 fd 1a 11 84 f1 09 bd 90 f4 42 bb 3a df 35 b5 f0 81 31 c5 1c 11 8b c4 74 5a 98 77 08 e1 09>,
     absValidity: 2018-08-28T06:05:22.622Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 29 ea 69 3a bd 42 f9 af>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 06:05:24 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 8 1 1535349925029
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 9 0.8888888888888888 1535349982537
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.3:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 10 0.8 1535350042547
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.3:21100
connected to auth! from local port 41286
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 11 0.7272727272727273 1535350102554
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.3:21100
connected to auth! from local port 41530
/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902
            eventHandlers.onError('Error occurred in migration request: Disconnected from auth before getting migration response: ' + error);
                                                                                                                                      ^

ReferenceError: error is not defined
    at Socket.<anonymous> (/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902:135)
    at emitNone (events.js:91:20)
    at Socket.emit (events.js:188:7)
    at endReadableNT (_stream_readable.js:975:12)
    at _combinedTickCallback (internal/process/next_tick.js:80:11)
    at process._tickCallback (internal/process/next_tick.js:104:9)
