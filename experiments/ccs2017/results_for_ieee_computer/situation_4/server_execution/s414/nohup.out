changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s414.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's414',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 76 66 ... > }
Handler: listening on port 22100
s414:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300000
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51502
received auth hello!
{ authId: 403, nonce: <Buffer 68 eb a8 de 35 b7 c4 a1> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 08 4e d5 d2 9f cd 34 e8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 22 25 4f 24 5e 8f bf 6d 63 c3 87 b0 af 83 ed 21>,
  macKeyVal: <Buffer 1c 45 5b 91 82 2d 0e 6e 55 14 af ba d6 da d4 dc ce 2f 70 25 4b 2b b6 81 7f f5 5b df 08 eb 7c e2>,
  absValidity: 2018-08-27T04:33:15.248Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 31 c4 25 8f bf af fb 06>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 31 c4 25 8f bf af fb 06> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.56:42858',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300006
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51732
received auth hello!
{ authId: 403, nonce: <Buffer 06 be e0 df 35 76 7a 5a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cb 50 ec a6 38 ed 02 15>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cb 75 37 af ff a7 ea 0b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer cb 75 37 af ff a7 ea 0b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.56:43088',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300012
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52002
received auth hello!
{ authId: 403, nonce: <Buffer f2 e0 c5 1f bd 9b 0a e2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cb 59 41 cf 3f ce bc 5b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3d 77 de f4 26 02 7b fc>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3d 77 de f4 26 02 7b fc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.56:43358',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300018
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52272
received auth hello!
{ authId: 403, nonce: <Buffer 8b f4 fa 76 b2 ae cb 54> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 83 1a db 7d 99 8a ac 06>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ff 44 bd 12 b4 ea cc b5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ff 44 bd 12 b4 ea cc b5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.56:43628',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300024
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52542
received auth hello!
{ authId: 403, nonce: <Buffer ee 88 65 ae b1 cb e1 c4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 37 f6 91 d1 89 8a 1e b7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 08 76 38 62 e8 7b 50 2b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 08 76 38 62 e8 7b 50 2b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.56:43898',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300030
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52812
received auth hello!
{ authId: 403, nonce: <Buffer fd cc 98 9c 9a 4c 77 47> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b3 06 a1 43 eb 2b 02 aa>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bd 77 e7 34 1a dd 1d 5e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bd 77 e7 34 1a dd 1d 5e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.56:44168',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300036
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53082
received auth hello!
{ authId: 403, nonce: <Buffer 94 7f b0 46 10 3f e7 f0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a9 b4 f5 50 0c 4b 5c 1c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0f fe c9 ab cf 52 66 6c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0f fe c9 ab cf 52 66 6c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.56:44438',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300042
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53348
received auth hello!
{ authId: 403, nonce: <Buffer 0e 88 8e 61 08 16 8f be> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 06 f3 3a 4f 98 ba da 2c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3c a2 8a e8 95 16 5b 9b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3c a2 8a e8 95 16 5b 9b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.56:44704',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
