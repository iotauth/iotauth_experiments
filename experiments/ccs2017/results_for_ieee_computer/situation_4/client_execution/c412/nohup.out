changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c412.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c412',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 51 49 42 41 41 4b 43 41 51 45 41 35 44 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1535340787985
connected to auth! from local port 33276
received auth hello!
{ authId: 402, nonce: <Buffer 9b 94 c3 f4 eb 9f 1e db> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer d7 47 b5 97 6b a3 70 c2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer b5 86 e1 3a c1 f5 46 35 75 f4 cd d5 d5 4c 11 d0>,
  macKeyVal: <Buffer 6e 5e 10 45 af 1f e3 1e 80 da 63 dd a3 cb c3 34 c4 68 d5 a9 67 53 ed ce 7a 33 f0 60 4b 0f 1d 2b>,
  absValidity: 2018-08-27T04:33:08.972Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200005,
  cipherKeyVal: <Buffer 88 0c 70 4a 88 ba e9 a7 e1 5e 29 bb 04 6d 61 9b>,
  macKeyVal: <Buffer 34 08 c1 be 2f 11 22 99 3e fd 05 dd da d0 d9 37 c4 b1 73 f6 6e 26 e7 76 7c 82 34 3d ef 26 a6 d5>,
  absValidity: 2018-08-28T03:33:08.971Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200005,
     cipherKeyVal: <Buffer 88 0c 70 4a 88 ba e9 a7 e1 5e 29 bb 04 6d 61 9b>,
     macKeyVal: <Buffer 34 08 c1 be 2f 11 22 99 3e fd 05 dd da d0 d9 37 c4 b1 73 f6 6e 26 e7 76 7c 82 34 3d ef 26 a6 d5>,
     absValidity: 2018-08-28T03:33:08.971Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 77 6a 2d e2 8b 7b 9d 11>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 03:33:11 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1535340791300
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1535340848040
connected to auth! from local port 33494
received auth hello!
{ authId: 402, nonce: <Buffer ac 76 7e 72 e7 05 3f ab> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5b 56 e5 14 89 3a eb 79>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200012,
  cipherKeyVal: <Buffer a7 c7 30 47 1c 50 62 11 78 c1 95 4e da 6b f4 b8>,
  macKeyVal: <Buffer d0 6e 16 05 f2 7f 2f ae 98 df 08 aa 48 4e a5 97 81 9c ec 1e 87 88 df 14 0d 1a d7 b0 c8 52 2c 26>,
  absValidity: 2018-08-28T03:34:08.993Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200012,
     cipherKeyVal: <Buffer a7 c7 30 47 1c 50 62 11 78 c1 95 4e da 6b f4 b8>,
     macKeyVal: <Buffer d0 6e 16 05 f2 7f 2f ae 98 df 08 aa 48 4e a5 97 81 9c ec 1e 87 88 df 14 0d 1a d7 b0 c8 52 2c 26>,
     absValidity: 2018-08-28T03:34:08.993Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer b8 b9 7d 3b ab 05 aa 95>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 03:34:11 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1535340851537
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1535340908096
connected to auth! from local port 33764
received auth hello!
{ authId: 402, nonce: <Buffer c7 79 85 c4 30 27 01 ed> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b6 92 da c8 7b 6f 83 86>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200019,
  cipherKeyVal: <Buffer a8 96 84 2a ec b4 dd fc fe f7 21 4b 62 e8 95 67>,
  macKeyVal: <Buffer b2 c9 9f a0 ae 16 dd c1 b6 86 54 83 db c7 71 ff 45 37 e8 f4 85 e6 0b 4f 91 8f 26 9e 0c 48 51 da>,
  absValidity: 2018-08-28T03:35:09.043Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200019,
     cipherKeyVal: <Buffer a8 96 84 2a ec b4 dd fc fe f7 21 4b 62 e8 95 67>,
     macKeyVal: <Buffer b2 c9 9f a0 ae 16 dd c1 b6 86 54 83 db c7 71 ff 45 37 e8 f4 85 e6 0b 4f 91 8f 26 9e 0c 48 51 da>,
     absValidity: 2018-08-28T03:35:09.043Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 78 69 ed eb 79 79 e5 05>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 03:35:11 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1535340911775
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1535340968152
connected to auth! from local port 34034
received auth hello!
{ authId: 402, nonce: <Buffer 54 ef 97 18 f5 02 42 7d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8c f6 13 d0 4a 41 e9 ac>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200026,
  cipherKeyVal: <Buffer 7c 22 de 24 e3 f2 cb 70 43 f8 b6 74 0b a0 b6 eb>,
  macKeyVal: <Buffer e7 8b ca f8 d8 eb b9 44 ba 8a b8 58 15 04 6b 73 9c 36 16 c1 cd 2a 5e 6d ac 5d 01 1f 33 6f dd e1>,
  absValidity: 2018-08-28T03:36:09.050Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200026,
     cipherKeyVal: <Buffer 7c 22 de 24 e3 f2 cb 70 43 f8 b6 74 0b a0 b6 eb>,
     macKeyVal: <Buffer e7 8b ca f8 d8 eb b9 44 ba 8a b8 58 15 04 6b 73 9c 36 16 c1 cd 2a 5e 6d ac 5d 01 1f 33 6f dd e1>,
     absValidity: 2018-08-28T03:36:09.050Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 5d 82 d1 99 16 4c 1d ec>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 03:36:11 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1535340971728
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1535341028209
connected to auth! from local port 34304
received auth hello!
{ authId: 402, nonce: <Buffer 99 f1 01 4c 8d b0 04 46> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4a fa dd c2 52 6c 62 f2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200033,
  cipherKeyVal: <Buffer 2d d3 23 75 91 c5 c6 ad 7d 46 bb b9 5e 4a 0e 2a>,
  macKeyVal: <Buffer e1 a8 11 51 55 dd 46 7b 82 c1 f7 fa 99 90 35 10 ce f9 70 ca 1e 69 aa ab 96 1c 88 d2 d8 2e e8 c1>,
  absValidity: 2018-08-28T03:37:09.100Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200033,
     cipherKeyVal: <Buffer 2d d3 23 75 91 c5 c6 ad 7d 46 bb b9 5e 4a 0e 2a>,
     macKeyVal: <Buffer e1 a8 11 51 55 dd 46 7b 82 c1 f7 fa 99 90 35 10 ce f9 70 ca 1e 69 aa ab 96 1c 88 d2 d8 2e e8 c1>,
     absValidity: 2018-08-28T03:37:09.100Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 0b 62 e7 d1 ed 3a 83 4a>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 03:37:11 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1535341031616
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1535341088264
connected to auth! from local port 34574
received auth hello!
{ authId: 402, nonce: <Buffer ff 94 33 47 16 36 b0 6a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 23 d4 b6 0c fb f5 be a5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200040,
  cipherKeyVal: <Buffer 5a b0 36 43 d3 6c 18 e9 1d 47 43 0b 1a ff 24 93>,
  macKeyVal: <Buffer 64 94 1a a0 92 7b 9d e6 f3 11 28 57 cd 85 47 5a 33 63 14 69 44 c7 ff 30 f1 31 cb 2c 69 9e 7f 68>,
  absValidity: 2018-08-28T03:38:09.141Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200040,
     cipherKeyVal: <Buffer 5a b0 36 43 d3 6c 18 e9 1d 47 43 0b 1a ff 24 93>,
     macKeyVal: <Buffer 64 94 1a a0 92 7b 9d e6 f3 11 28 57 cd 85 47 5a 33 63 14 69 44 c7 ff 30 f1 31 cb 2c 69 9e 7f 68>,
     absValidity: 2018-08-28T03:38:09.141Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 0b d0 4d d6 9f e8 83 83>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 03:38:11 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1535341091636
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1535341148320
connected to auth! from local port 34844
received auth hello!
{ authId: 402, nonce: <Buffer 1c a3 d2 87 21 57 0d 5b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ae 24 e0 b8 92 97 3a ba>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200047,
  cipherKeyVal: <Buffer 1e b6 a8 8f 22 4c a8 33 fd d0 90 e8 a6 89 80 b4>,
  macKeyVal: <Buffer 49 81 6d 1f 6c ac 83 10 97 61 07 0a ad bd d9 c4 a5 95 0a 0c 24 5b 04 7d c6 a1 08 e9 4f 6f be 89>,
  absValidity: 2018-08-28T03:39:09.111Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200047,
     cipherKeyVal: <Buffer 1e b6 a8 8f 22 4c a8 33 fd d0 90 e8 a6 89 80 b4>,
     macKeyVal: <Buffer 49 81 6d 1f 6c ac 83 10 97 61 07 0a ad bd d9 c4 a5 95 0a 0c 24 5b 04 7d c6 a1 08 e9 4f 6f be 89>,
     absValidity: 2018-08-28T03:39:09.111Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer ce ff d5 38 5e 4d 01 48>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 03:39:11 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1535341151814
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1535341208343
connected to auth! from local port 35114
received auth hello!
{ authId: 402, nonce: <Buffer c0 70 62 41 bb d3 c5 98> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b5 99 73 11 c7 eb 42 a4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200054,
  cipherKeyVal: <Buffer 92 97 87 91 f5 3a c1 96 d5 b4 ec a7 f1 88 74 9d>,
  macKeyVal: <Buffer e5 b7 a5 8a ac 28 2f 3a 77 7c 74 bd ef 8a 5c bb c3 ff 24 90 75 ef 7f bc 01 76 b9 1f 65 23 de e4>,
  absValidity: 2018-08-28T03:40:09.115Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200054,
     cipherKeyVal: <Buffer 92 97 87 91 f5 3a c1 96 d5 b4 ec a7 f1 88 74 9d>,
     macKeyVal: <Buffer e5 b7 a5 8a ac 28 2f 3a 77 7c 74 bd ef 8a 5c bb c3 ff 24 90 75 ef 7f bc 01 76 b9 1f 65 23 de e4>,
     absValidity: 2018-08-28T03:40:09.115Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 68 64 dc df b0 38 7e 5b>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Mon Aug 27 2018 03:40:11 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 8 1 1535341211906
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 9 0.8888888888888888 1535341268396
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 10 0.8 1535341328406
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 58934
received auth hello!
{ authId: 502, nonce: <Buffer df 00 de d9 81 3b 98 3e> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 11 0.7272727272727273 1535341388416
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 59156
received auth hello!
{ authId: 502, nonce: <Buffer 6b 3d 90 b0 b8 ee a1 65> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 12 0.6666666666666666 1535341448426
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 13 0.6153846153846154 1535341508427
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 44380
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 14 0.5714285714285714 1535341568435
failure in connection with Auth : authFailureCount: 6
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 44616
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 15 0.5333333333333333 1535341628442
failure in connection with Auth : authFailureCount: 7
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 2
to: 3
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.3:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 16 0.5 1535341688448
failure in connection with Auth : authFailureCount: 8
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 3
to: 4
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 51438
received auth hello!
{ authId: 503, nonce: <Buffer b8 68 ee b4 92 82 93 a9> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth503',
     commonName: '10.0.1.6' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth402',
     commonName: '10.0.0.2' },
  serial: '0165796FA46B',
  notBefore: 2018-08-27T03:29:44.000Z,
  notAfter: 2018-08-28T03:31:24.000Z,
  subjectHash: '5542437f',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'B0:E4:E5:5F:9E:CB:06:62:C1:1C:04:D2:03:C0:0F:F3:08:57:F8:E6',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'B23F6093C850A1F776C6B25A211F3D5D8785C0DAD492C4DE461DA15D8F9B6101A99371495C8D7E30C245C7CC7E2E192E5B5EB588DBBBDBA927B35EDD2BAE5D8C5C65824B855A9221C4466C8784616AD037B77C8AADC6EF39D05015670368020871C42CAC357EA02550E2A7B413707218579A29BD6E3766CDC96E0C38274B71EADD932F983948893BE88DFCA5822A49F903804459FF6A6BE5F8D58602F470CF3B3720B509B13C86CB937B7103FB5BB709F3236962F0A80B162386009C70550963F281A68E509BD7FD3B899E2D99BBF01E7FAD284D2AA9766FC563E437A20FC2DB9E924A4047450953A3342A8380752168F1038EC6A4763C6E85566CE28AE879E7',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.6' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 503,
  host: '10.0.1.6',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWV5b6RrMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDIxETAPBgNVBAMMCDEwLjAuMC4yMB4XDTE4MDgy\nNzAzMjk0NFoXDTE4MDgyODAzMzEyNFowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMzERMA8GA1UEAwwIMTAuMC4xLjYwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQCyP2CTyFCh93bGslohHz1dh4XA2tSSxN5GHaFdj5thAamTcUlc\njX4wwkXHzH4uGS5bXrWI27vbqSezXt0rrl2MXGWCS4VakiHERmyHhGFq0De3fIqt\nxu850FAVZwNoAghxxCysNX6gJVDip7QTcHIYV5opvW43Zs3Jbgw4J0tx6t2TL5g5\nSIk76I38pYIqSfkDgERZ/2pr5fjVhgL0cM87NyC1CbE8hsuTe3ED+1u3CfMjaWLw\nqAsWI4YAnHBVCWPygaaOUJvX/TuJni2Zu/Aef60oTSqpdm/FY+Q3og/C256SSkBH\nRQlTozQqg4B1IWjxA47GpHY8boVWbOKK6HnnAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQYwDQYJKoZIhvcNAQELBQADggEBAHimGYeBFTk1nGO26iqikUZTSdUKpnDK\n1wAqZWF59AYw4GIh8K8hwY89yfxiEPdadTHuHhROS2TNmi5Qhmjm2T9LeoVfXDFp\nvlnxCk14MXmYJPtVM/f+auUcudUgffLF4JpR6AsA2Loke6FxQHTkZgrPFByluQHu\n6KN55vWS7t1zlXLQLx5UFjSHeulMjTdnZ9Ev+zKxzZVnbK1rIsedCi15tiqIDtqE\n7moQ/RLtqDYKe83XIvg/NsV3wK0FiOTEFo5Pd5LKrcUUxcpnGQNGti5A8XSxQ4tR\ngI9dbZudraBvrMOB1eFFyunFPks8RVIs6shkmXxXg5MkMTdGXf3VWKo=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 4
to: 5
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 17 0.47058823529411764 1535341748458
connected to auth! from local port 51688
received auth hello!
{ authId: 503, nonce: <Buffer b6 e1 29 95 46 3d 21 07> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer ce a5 9a 96 f0 2f de 6e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 58 c0 fa e4 3c c9 cd 51 21 77 0a 2a 52 5d 12 db>,
  macKeyVal: <Buffer 19 1a 8a 4f 3e 56 54 61 65 01 7d 1e b6 fe a0 fe 5f 2d 7b 32 87 fd 43 b2 18 46 af 6d c7 94 3b a7>,
  absValidity: 2018-08-27T04:49:08.693Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300078,
  cipherKeyVal: <Buffer fe 70 d4 d2 19 4e c8 f6 d3 40 6c b9 5b ad 63 15>,
  macKeyVal: <Buffer 69 a5 7d 28 bd f1 e6 0e 88 9c 19 a3 40 e1 be 9a f2 fe 8d 25 32 31 f1 6e 3d a5 39 8b 1c 9c 5b 0a>,
  absValidity: 2018-08-28T03:49:08.693Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300078,
     cipherKeyVal: <Buffer fe 70 d4 d2 19 4e c8 f6 d3 40 6c b9 5b ad 63 15>,
     macKeyVal: <Buffer 69 a5 7d 28 bd f1 e6 0e 88 9c 19 a3 40 e1 be 9a f2 fe 8d 25 32 31 f1 6e 3d a5 39 8b 1c 9c 5b 0a>,
     absValidity: 2018-08-28T03:49:08.693Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 36 7a 77 c4 9f 56 ed 7f>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.15:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 18 0.4444444444444444 1535341808468
connected to auth! from local port 51948
received auth hello!
{ authId: 503, nonce: <Buffer 05 33 a2 66 12 02 c7 39> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5d 68 98 31 45 1b a5 03>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300088,
  cipherKeyVal: <Buffer bd 19 00 56 a8 84 ea 55 1b 45 3e 89 c1 2b 2f f5>,
  macKeyVal: <Buffer 1c 7e 78 93 05 10 20 96 41 8c 5c ec b6 77 72 eb 18 8d 9a 59 7f b5 68 60 67 37 98 37 e3 0c 59 bf>,
  absValidity: 2018-08-28T03:50:08.630Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300088,
     cipherKeyVal: <Buffer bd 19 00 56 a8 84 ea 55 1b 45 3e 89 c1 2b 2f f5>,
     macKeyVal: <Buffer 1c 7e 78 93 05 10 20 96 41 8c 5c ec b6 77 72 eb 18 8d 9a 59 7f b5 68 60 67 37 98 37 e3 0c 59 bf>,
     absValidity: 2018-08-28T03:50:08.630Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 5a a5 c6 ce cd 90 61 1e>
switching to HANDSHAKE_1_SENT
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.15:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 19 0.42105263157894735 1535341868476
connected to auth! from local port 52200
received auth hello!
{ authId: 503, nonce: <Buffer 7c 8e 73 cc 90 db 32 b7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8a d0 73 63 cc a6 16 71>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300098,
  cipherKeyVal: <Buffer 1a 89 72 8c 60 f1 98 67 bd a2 c1 cf fe ac c2 30>,
  macKeyVal: <Buffer 74 f6 50 f3 2f 19 a8 17 f6 40 f9 3b 14 c5 cf 63 70 cf ce 06 a4 21 e0 4a a7 ce a7 80 98 c2 b5 eb>,
  absValidity: 2018-08-28T03:51:08.603Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300098,
     cipherKeyVal: <Buffer 1a 89 72 8c 60 f1 98 67 bd a2 c1 cf fe ac c2 30>,
     macKeyVal: <Buffer 74 f6 50 f3 2f 19 a8 17 f6 40 f9 3b 14 c5 cf 63 70 cf ce 06 a4 21 e0 4a a7 ce a7 80 98 c2 b5 eb>,
     absValidity: 2018-08-28T03:51:08.603Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer b6 f0 1f 9e 81 ed 67 0c>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.15:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 20 0.4 1535341928487
connected to auth! from local port 52452
received auth hello!
{ authId: 503, nonce: <Buffer 12 21 85 01 9b b5 43 71> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8c 09 4b 26 7f 9d af 20>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300108,
  cipherKeyVal: <Buffer 7e 8c af d3 59 8d ca fd 27 47 74 86 a3 c3 67 11>,
  macKeyVal: <Buffer 8c 78 9a fe c7 67 d6 e2 56 9e 68 f4 d4 2f 83 d3 f0 1a 0d 07 a5 d6 6b 9c 7c 4c 9f 86 a2 2b ec db>,
  absValidity: 2018-08-28T03:52:08.740Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300108,
     cipherKeyVal: <Buffer 7e 8c af d3 59 8d ca fd 27 47 74 86 a3 c3 67 11>,
     macKeyVal: <Buffer 8c 78 9a fe c7 67 d6 e2 56 9e 68 f4 d4 2f 83 d3 f0 1a 0d 07 a5 d6 6b 9c 7c 4c 9f 86 a2 2b ec db>,
     absValidity: 2018-08-28T03:52:08.740Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 97 21 e4 dd 65 b3 b5 e5>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.15:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 21 0.38095238095238093 1535341988498
connected to auth! from local port 52718
received auth hello!
{ authId: 503, nonce: <Buffer bb 3f e1 a3 29 be b6 aa> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a3 78 cb 23 24 45 0e c9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300118,
  cipherKeyVal: <Buffer bd 75 6c fc e3 be 2e fc 70 6e b4 8b f5 0d 3a dc>,
  macKeyVal: <Buffer 7e e9 7a 09 0a 5e 38 61 af b7 e7 b9 e9 5c 73 20 5a 69 e1 70 19 b0 83 32 f9 a5 58 05 90 f5 5b 27>,
  absValidity: 2018-08-28T03:53:08.617Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300118,
     cipherKeyVal: <Buffer bd 75 6c fc e3 be 2e fc 70 6e b4 8b f5 0d 3a dc>,
     macKeyVal: <Buffer 7e e9 7a 09 0a 5e 38 61 af b7 e7 b9 e9 5c 73 20 5a 69 e1 70 19 b0 83 32 f9 a5 58 05 90 f5 5b 27>,
     absValidity: 2018-08-28T03:53:08.617Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer f4 e9 1d f6 12 ca 04 b7>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.15:undefined
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902
            eventHandlers.onError('Error occurred in migration request: Disconnected from auth before getting migration response: ' + error);
                                                                                                                                      ^

ReferenceError: error is not defined
    at Socket.<anonymous> (/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902:135)
    at emitNone (events.js:91:20)
    at Socket.emit (events.js:188:7)
    at endReadableNT (_stream_readable.js:975:12)
    at _combinedTickCallback (internal/process/next_tick.js:80:11)
    at process._tickCallback (internal/process/next_tick.js:104:9)
