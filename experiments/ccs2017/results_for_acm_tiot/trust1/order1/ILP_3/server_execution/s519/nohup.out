changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s519.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's519',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 73 6b ... > }
Handler: listening on port 22100
s519:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400081
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58464
Unidentified client connected
received auth hello!
{ authId: 504, nonce: <Buffer 65 de e1 d9 e4 de 20 b1> }
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400082
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 4d 75 66 e4 00 96 ff 9f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer a9 df 44 10 e2 26 a4 49 ff ed 85 92 53 09 56 4d>,
  macKeyVal: <Buffer bf 16 3e 7c 50 7c 3c be b1 25 48 32 27 2e 0b 96 ed 80 d3 83 fe 85 53 62 44 41 47 3e 67 cd 8f 67>,
  absValidity: 2018-03-21T02:23:16.031Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1d 5c 42 14 c0 68 aa ea>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1d 5c 42 14 c0 68 aa ea> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.86:38758',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Handler: Error in server - details: handshake2 timed out...
connected to auth! from local port 58486
received auth hello!
{ authId: 504, nonce: <Buffer 64 e7 43 26 d8 99 f1 15> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer eb 34 58 cf 6a f1 70 27>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer a8 5f dd bb 8b 72 d1 7f 7b 86 2b c8 d1 13 6e 59>,
  macKeyVal: <Buffer de c1 a6 d5 d9 4a 70 9c f7 4e f8 f7 b5 01 10 ad 75 18 49 c9 1c d0 e1 33 19 bf aa 20 5f 2a da 24>,
  absValidity: 2018-03-21T02:23:18.005Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f2 5a 90 2f df 4c c0 7d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f2 5a 90 2f df 4c c0 7d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.87:40044',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400087
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58734
received auth hello!
{ authId: 504, nonce: <Buffer d9 39 57 35 e4 34 9c 4c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 50 fd f5 11 71 ec 7c 77>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ce 6f 26 15 23 e5 45 3e>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ce 6f 26 15 23 e5 45 3e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.86:39028',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400088
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58756
received auth hello!
{ authId: 504, nonce: <Buffer 6e 29 44 88 e7 74 bb cd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 45 6e 6d 86 71 a4 e0 8b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 69 d3 21 c3 50 69 ac 20>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 69 d3 21 c3 50 69 ac 20> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.87:40316',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400093
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59004
received auth hello!
{ authId: 504, nonce: <Buffer b5 c6 7b 0a 50 f9 00 79> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ea 15 0b 0e ef c6 44 4a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7b dc f2 81 ea 63 f6 73>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 7b dc f2 81 ea 63 f6 73> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.86:39298',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400094
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59026
received auth hello!
{ authId: 504, nonce: <Buffer fb b6 ad b5 55 d2 e6 c4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 79 69 70 2b 96 18 76 bf>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8a 1a 77 3b e2 8d dd 70>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8a 1a 77 3b e2 8d dd 70> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.87:40586',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400099
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59274
received auth hello!
{ authId: 504, nonce: <Buffer 76 fa 66 83 7c a5 df ab> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a9 aa b5 52 65 1b ec 72>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 61 2a 9b 0d e8 30 be 38>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 61 2a 9b 0d e8 30 be 38> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.86:39568',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400100
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59298
received auth hello!
{ authId: 504, nonce: <Buffer c7 8d 92 1d c5 d7 11 9f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6d 86 92 6b 15 f5 27 be>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e5 9e c3 0d 57 db 53 6c>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e5 9e c3 0d 57 db 53 6c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.87:40856',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400105
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59544
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
received auth hello!
{ authId: 504, nonce: <Buffer 80 67 49 b4 a5 b9 71 68> }
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400106
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 60 7a 7f e6 f8 0c d9 e0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 62 56 03 af 1c 11 20 6c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 62 56 03 af 1c 11 20 6c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.86:39838',
  status: 'open' }
connected to auth! from local port 59562
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer a6 1a dc ca ed 9b 61 1e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 66 b3 fc 2f 6b 9e 93 93>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ff 93 79 69 fb fa 74 49>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ff 93 79 69 fb fa 74 49> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.87:41120',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400111
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59814
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400112
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59832
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer f9 31 02 29 db 18 fb 9b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 25 b1 2a 23 a1 25 27 34>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a0 e4 3c 7a fd 7a aa a5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a0 e4 3c 7a fd 7a aa a5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.86:40108',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100626
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100636
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100637
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in server - details: handshake2 timed out...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in server - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.2:21100
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in server - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 3
Handler: Error in server - details: Error occurred in migration request: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 4
Handler: Error in server - details: Error occurred in migration request: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100647
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100648
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 40758
connected to auth! from local port 40760
received auth hello!
{ authId: 502, nonce: <Buffer 9a a2 0b a6 ee 6c da 44> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth504',
     commonName: '10.0.0.7' },
  serial: '01624623EB9F',
  notBefore: 2018-03-21T01:18:01.000Z,
  notAfter: 2018-03-22T01:19:41.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'C6:32:A0:24:4C:29:3D:1D:8B:39:46:E3:FE:D0:75:F3:FC:77:1A:B0',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'FF6CB5202497CC77AF28EFDE774858E4FEF04355E5228E378962DF4235BE3683DAF9E38A7E22621D66B3B50166D897E97BF911F9E8FC09D686961AA39679014E5DDD27EA0F02DE853A41537DB5E37F33395E249F355C0D074419572E9856D1D598CAB2CD6951013DDCB0A163B943DFCD2694BE18B9B3892695B3052EBD9115D447293C83AF24A008794B842E4F0A6C2A8D0189612A600AA40A592603E43713C0ECCA681024E5EC429FAD09484B824919DF59C8BD488E0D372D2A3D8B99B6068E24BBBDA8F0BCDDBA806010E4A7181736DF08D4D1CFC16E26507C360EDCBFF1B5F4288CE304DE62E9696665C5108489AD7232658356998FF47C4F7E8A04225423',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJGI+ufMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDQxETAPBgNVBAMMCDEwLjAuMC43MB4XDTE4MDMy\nMTAxMTgwMVoXDTE4MDMyMjAxMTk0MVowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQD/bLUgJJfMd68o7953SFjk/vBDVeUijjeJYt9CNb42g9r544p+\nImIdZrO1AWbYl+l7+RH56PwJ1oaWGqOWeQFOXd0n6g8C3oU6QVN9teN/MzleJJ81\nXA0HRBlXLphW0dWYyrLNaVEBPdywoWO5Q9/NJpS+GLmziSaVswUuvZEV1EcpPIOv\nJKAIeUuELk8KbCqNAYlhKmAKpApZJgPkNxPA7MpoECTl7EKfrQlIS4JJGd9ZyL1I\njg03LSo9i5m2Bo4ku72o8LzduoBgEOSnGBc23wjU0c/BbiZQfDYO3L/xtfQojOME\n3mLpaWZlxRCEia1yMmWDVpmP9HxPfooEIlQjAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAK3yuDW7US+1TTqbZ9IzcRsugyKjW3eF\nZ+ICuR46YrXW5VzHNWodZbDFCiNV0Bo1ZzL+dXDEmJVn71jKThgUDz7ENFbf3mS5\ngkrY38lRykAzitvOTlk828IcC8B0qxGqAV2sB8YAzMwdGgCAKJXwH4dPI7AUTXx9\njqYF1HGLtRqs21mUbjY66163HCXkgjSud7hIvGV/etIvWIGypyuGrNObT8Cegd9K\nrJtqzjTtWMuoUSbZwNmr9jS9fGLD1cWb8lgnjfdFkjtKNG0PUu9iL6rsptye3iXm\n4rd3P8mgoFauizjDlzaDA48yqr6bcs6KyQrnKl+9jgAQvgvJDgCETKg=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 1
to: 2
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 69 88 71 32 d9 14 dd bc> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth504',
     commonName: '10.0.0.7' },
  serial: '01624623EB9F',
  notBefore: 2018-03-21T01:18:01.000Z,
  notAfter: 2018-03-22T01:19:41.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'C6:32:A0:24:4C:29:3D:1D:8B:39:46:E3:FE:D0:75:F3:FC:77:1A:B0',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'FF6CB5202497CC77AF28EFDE774858E4FEF04355E5228E378962DF4235BE3683DAF9E38A7E22621D66B3B50166D897E97BF911F9E8FC09D686961AA39679014E5DDD27EA0F02DE853A41537DB5E37F33395E249F355C0D074419572E9856D1D598CAB2CD6951013DDCB0A163B943DFCD2694BE18B9B3892695B3052EBD9115D447293C83AF24A008794B842E4F0A6C2A8D0189612A600AA40A592603E43713C0ECCA681024E5EC429FAD09484B824919DF59C8BD488E0D372D2A3D8B99B6068E24BBBDA8F0BCDDBA806010E4A7181736DF08D4D1CFC16E26507C360EDCBFF1B5F4288CE304DE62E9696665C5108489AD7232658356998FF47C4F7E8A04225423',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.1',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJGI+ufMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDQxETAPBgNVBAMMCDEwLjAuMC43MB4XDTE4MDMy\nMTAxMTgwMVoXDTE4MDMyMjAxMTk0MVowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQD/bLUgJJfMd68o7953SFjk/vBDVeUijjeJYt9CNb42g9r544p+\nImIdZrO1AWbYl+l7+RH56PwJ1oaWGqOWeQFOXd0n6g8C3oU6QVN9teN/MzleJJ81\nXA0HRBlXLphW0dWYyrLNaVEBPdywoWO5Q9/NJpS+GLmziSaVswUuvZEV1EcpPIOv\nJKAIeUuELk8KbCqNAYlhKmAKpApZJgPkNxPA7MpoECTl7EKfrQlIS4JJGd9ZyL1I\njg03LSo9i5m2Bo4ku72o8LzduoBgEOSnGBc23wjU0c/BbiZQfDYO3L/xtfQojOME\n3mLpaWZlxRCEia1yMmWDVpmP9HxPfooEIlQjAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAK3yuDW7US+1TTqbZ9IzcRsugyKjW3eF\nZ+ICuR46YrXW5VzHNWodZbDFCiNV0Bo1ZzL+dXDEmJVn71jKThgUDz7ENFbf3mS5\ngkrY38lRykAzitvOTlk828IcC8B0qxGqAV2sB8YAzMwdGgCAKJXwH4dPI7AUTXx9\njqYF1HGLtRqs21mUbjY66163HCXkgjSud7hIvGV/etIvWIGypyuGrNObT8Cegd9K\nrJtqzjTtWMuoUSbZwNmr9jS9fGLD1cWb8lgnjfdFkjtKNG0PUu9iL6rsptye3iXm\n4rd3P8mgoFauizjDlzaDA48yqr6bcs6KyQrnKl+9jgAQvgvJDgCETKg=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 2
to: 3
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in server - details: Error occurred in migration request: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100658
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46588
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100659
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46600
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100670
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46842
received auth hello!
{ authId: 401, nonce: <Buffer 8c 30 23 1d 15 09 56 3d> }
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Connection with Auth timed out...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100681
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47096
received auth hello!
{ authId: 401, nonce: <Buffer 2c 82 4f 64 b6 4a e7 32> }
disconnected from auth
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100682
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47110
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Connection with Auth timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100693
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47348
received auth hello!
{ authId: 401, nonce: <Buffer e8 02 05 e3 5b 51 f5 90> }
disconnected from auth
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100694
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47362
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Connection with Auth timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100705
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47606
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100714
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47832
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100715
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47844
received auth hello!
{ authId: 401, nonce: <Buffer 8a cd 01 86 c6 87 27 9b> }
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Connection with Auth timed out...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100728
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48092
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100729
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48100
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100741
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48340
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100742
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48348
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: Disconnected from auth before getting session key response
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100754
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
Handler: Error in server - details: Disconnected from auth before getting session key response
connected to auth! from local port 48590
Handler: Error in server - details: Disconnected from auth before getting session key response
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100755
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48600
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100766
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48820
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100778
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49058
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100788
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49288
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100800
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49526
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100813
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49772
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100823
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49996
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100831
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50188
received auth hello!
{ authId: 401, nonce: <Buffer 43 f4 24 47 c7 10 60 0f> }
disconnected from auth
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100832
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50194
received auth hello!
{ authId: 401, nonce: <Buffer 1c 1a 85 e2 ec b7 2c fc> }
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Connection with Auth timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Connection with Auth timed out...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100835
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50248
received auth hello!
{ authId: 401, nonce: <Buffer a0 53 13 2c 25 83 a0 aa> }
disconnected from auth
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100836
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50254
received auth hello!
{ authId: 401, nonce: <Buffer ee 7d ae 60 cb 50 24 89> }
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: Connection with Auth timed out...
Handler: Error in server - details: Connection with Auth timed out...
