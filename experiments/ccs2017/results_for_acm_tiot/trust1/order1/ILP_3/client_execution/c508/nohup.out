changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c508.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c508',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 35 31 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521595331932
connected to auth! from local port 38226
received auth hello!
{ authId: 501, nonce: <Buffer c5 bb 7e 46 a5 aa b6 82> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer a8 c7 95 b3 ec 5e 90 25>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer be 38 a8 83 d8 44 e7 d5 17 be 19 22 46 fa 49 19>,
  macKeyVal: <Buffer 87 0c 59 21 fa 91 2b 99 54 48 f7 36 74 02 17 f7 3a 13 fc 61 3e 9f f9 c2 e6 0d 4d 28 79 ba ca e4>,
  absValidity: 2018-03-21T02:22:12.083Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100480,
  cipherKeyVal: <Buffer b0 e5 43 10 0e 52 6e 8b 8e b6 0d 25 1f 81 75 e8>,
  macKeyVal: <Buffer b7 f6 08 f1 dd ae e7 b0 1a 13 2b b1 54 81 38 1e 2f ae 92 1e df af 8f 19 8e d2 8d 0b 94 47 8d 43>,
  absValidity: 2018-03-22T01:22:12.083Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100480,
     cipherKeyVal: <Buffer b0 e5 43 10 0e 52 6e 8b 8e b6 0d 25 1f 81 75 e8>,
     macKeyVal: <Buffer b7 f6 08 f1 dd ae e7 b0 1a 13 2b b1 54 81 38 1e 2f ae 92 1e df af 8f 19 8e d2 8d 0b 94 47 8d 43>,
     absValidity: 2018-03-22T01:22:12.083Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 32 ca 33 1e f2 81 c5 35>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 01:22:12 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521595333023
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521595391990
connected to auth! from local port 38494
received auth hello!
{ authId: 501, nonce: <Buffer e9 bf c5 f8 5b 9a ca 39> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3c 54 6e e7 f5 40 9a ee>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100488,
  cipherKeyVal: <Buffer 44 b8 93 b1 e3 83 99 71 23 7a 7d 3c 31 e7 07 87>,
  macKeyVal: <Buffer cf 7f 7f 91 e2 83 a5 40 4c d3 23 c3 e6 26 ce ce 06 33 b0 c4 18 f0 69 5d 2f 88 2a 26 c2 20 c9 76>,
  absValidity: 2018-03-22T01:23:12.137Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100488,
     cipherKeyVal: <Buffer 44 b8 93 b1 e3 83 99 71 23 7a 7d 3c 31 e7 07 87>,
     macKeyVal: <Buffer cf 7f 7f 91 e2 83 a5 40 4c d3 23 c3 e6 26 ce ce 06 33 b0 c4 18 f0 69 5d 2f 88 2a 26 c2 20 c9 76>,
     absValidity: 2018-03-22T01:23:12.137Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer ef 9b eb e5 9b d8 da 8d>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 01:23:12 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521595393051
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521595452045
connected to auth! from local port 38764
received auth hello!
{ authId: 501, nonce: <Buffer a1 c8 f0 67 28 0f 81 75> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 41 2b e2 2c 78 81 92 11>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100496,
  cipherKeyVal: <Buffer 82 52 f0 97 0e 42 dc 87 d6 60 99 37 69 71 ef 15>,
  macKeyVal: <Buffer c6 8c e3 e5 d2 25 ae a1 02 6e 57 92 38 39 59 d7 1c d8 b0 cc 3d 94 fd 38 7f 2b bf 39 fa 6c 04 f0>,
  absValidity: 2018-03-22T01:24:12.188Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100496,
     cipherKeyVal: <Buffer 82 52 f0 97 0e 42 dc 87 d6 60 99 37 69 71 ef 15>,
     macKeyVal: <Buffer c6 8c e3 e5 d2 25 ae a1 02 6e 57 92 38 39 59 d7 1c d8 b0 cc 3d 94 fd 38 7f 2b bf 39 fa 6c 04 f0>,
     absValidity: 2018-03-22T01:24:12.188Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 7c 6b b2 29 2b 1f f3 bf>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 01:24:13 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521595453615
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521595512101
connected to auth! from local port 39034
received auth hello!
{ authId: 501, nonce: <Buffer 4e 78 5f 84 98 9a d7 cf> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b0 95 dc ef 97 ff 44 c6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100504,
  cipherKeyVal: <Buffer 2b 7c cc 9c 5c 90 38 d9 8d a3 4e e2 43 a5 3d bc>,
  macKeyVal: <Buffer cf bb c9 0d a3 81 a9 59 d5 38 47 c6 fd 12 14 26 ad 1a bf 1f 7c 52 c4 19 aa 1a 89 21 f0 61 ee d5>,
  absValidity: 2018-03-22T01:25:12.235Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100504,
     cipherKeyVal: <Buffer 2b 7c cc 9c 5c 90 38 d9 8d a3 4e e2 43 a5 3d bc>,
     macKeyVal: <Buffer cf bb c9 0d a3 81 a9 59 d5 38 47 c6 fd 12 14 26 ad 1a bf 1f 7c 52 c4 19 aa 1a 89 21 f0 61 ee d5>,
     absValidity: 2018-03-22T01:25:12.235Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 4f fe b7 cf 4c dd e3 82>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 01:25:13 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521595513439
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521595572104
connected to auth! from local port 39304
received auth hello!
{ authId: 501, nonce: <Buffer 06 b5 a8 9a ce 57 10 7a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ad d4 32 52 46 3a 72 4a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100512,
  cipherKeyVal: <Buffer 94 bc dd 2a ca 20 4a c9 2d 5d b6 d1 80 61 a7 fd>,
  macKeyVal: <Buffer b0 28 ec a7 b0 4d 1e 1f b9 fc 92 b2 85 66 e9 22 88 3b bd 32 da 28 cc 27 ec ea 83 ae 14 67 8a c4>,
  absValidity: 2018-03-22T01:26:12.285Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100512,
     cipherKeyVal: <Buffer 94 bc dd 2a ca 20 4a c9 2d 5d b6 d1 80 61 a7 fd>,
     macKeyVal: <Buffer b0 28 ec a7 b0 4d 1e 1f b9 fc 92 b2 85 66 e9 22 88 3b bd 32 da 28 cc 27 ec ea 83 ae 14 67 8a c4>,
     absValidity: 2018-03-22T01:26:12.285Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 6a a5 99 22 6a a5 c8 18>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 01:26:13 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521595573342
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521595632161
connected to auth! from local port 39574
received auth hello!
{ authId: 501, nonce: <Buffer 41 40 18 d7 57 9d 70 94> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2c e2 4b bb 9d 62 d6 c4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100520,
  cipherKeyVal: <Buffer 51 6a a5 30 41 45 f4 6b a3 89 66 7a 3c 9a af 1c>,
  macKeyVal: <Buffer dd 30 d2 9e dd bd 33 ee 0c 03 2f 80 9f ec 6f 29 93 19 04 06 9d aa ca 7e 28 a5 a0 37 b9 28 ad 3e>,
  absValidity: 2018-03-22T01:27:12.310Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100520,
     cipherKeyVal: <Buffer 51 6a a5 30 41 45 f4 6b a3 89 66 7a 3c 9a af 1c>,
     macKeyVal: <Buffer dd 30 d2 9e dd bd 33 ee 0c 03 2f 80 9f ec 6f 29 93 19 04 06 9d aa ca 7e 28 a5 a0 37 b9 28 ad 3e>,
     absValidity: 2018-03-22T01:27:12.310Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 0f ba 5a 62 15 91 3f fb>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 01:27:12 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521595633194
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521595692221
connected to auth! from local port 39844
received auth hello!
{ authId: 501, nonce: <Buffer ed c3 5a ea 50 57 c9 98> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 21 ca 90 1f ba 5b 1f d8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100528,
  cipherKeyVal: <Buffer 3d fa 66 a4 ca 62 66 01 16 07 a2 98 f9 a8 5c dc>,
  macKeyVal: <Buffer ed 2b 30 7d 78 54 e1 72 93 7d e7 fa db 87 38 69 f3 9d dc 2a 0a ec 45 d4 5f 20 e7 49 49 e0 02 0f>,
  absValidity: 2018-03-22T01:28:12.386Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100528,
     cipherKeyVal: <Buffer 3d fa 66 a4 ca 62 66 01 16 07 a2 98 f9 a8 5c dc>,
     macKeyVal: <Buffer ed 2b 30 7d 78 54 e1 72 93 7d e7 fa db 87 38 69 f3 9d dc 2a 0a ec 45 d4 5f 20 e7 49 49 e0 02 0f>,
     absValidity: 2018-03-22T01:28:12.386Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 9c 3c ed 21 a3 8f 07 a4>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 01:28:13 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521595693327
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521595752253
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 9 0.7777777777777778 1521595812262
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 54246
received auth hello!
{ authId: 503, nonce: <Buffer 79 9e 39 7d 2a 00 eb 24> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 10 0.7 1521595872269
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 54476
received auth hello!
{ authId: 503, nonce: <Buffer 7d b4 0c 0c bb 9e f4 10> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 11 0.6363636363636364 1521595932279
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 45412
received auth hello!
{ authId: 502, nonce: <Buffer 9a 9a 6f 77 0b 74 24 1d> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '01624623E601',
  notBefore: 2018-03-21T01:18:00.000Z,
  notAfter: 2018-03-22T01:19:40.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'D6:19:40:AB:3E:00:B6:23:CE:36:36:45:7E:4D:2F:62:1F:9D:05:08',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'FF6CB5202497CC77AF28EFDE774858E4FEF04355E5228E378962DF4235BE3683DAF9E38A7E22621D66B3B50166D897E97BF911F9E8FC09D686961AA39679014E5DDD27EA0F02DE853A41537DB5E37F33395E249F355C0D074419572E9856D1D598CAB2CD6951013DDCB0A163B943DFCD2694BE18B9B3892695B3052EBD9115D447293C83AF24A008794B842E4F0A6C2A8D0189612A600AA40A592603E43713C0ECCA681024E5EC429FAD09484B824919DF59C8BD488E0D372D2A3D8B99B6068E24BBBDA8F0BCDDBA806010E4A7181736DF08D4D1CFC16E26507C360EDCBFF1B5F4288CE304DE62E9696665C5108489AD7232658356998FF47C4F7E8A04225423',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJGI+YBMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDMy\nMTAxMTgwMFoXDTE4MDMyMjAxMTk0MFowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQD/bLUgJJfMd68o7953SFjk/vBDVeUijjeJYt9CNb42g9r544p+\nImIdZrO1AWbYl+l7+RH56PwJ1oaWGqOWeQFOXd0n6g8C3oU6QVN9teN/MzleJJ81\nXA0HRBlXLphW0dWYyrLNaVEBPdywoWO5Q9/NJpS+GLmziSaVswUuvZEV1EcpPIOv\nJKAIeUuELk8KbCqNAYlhKmAKpApZJgPkNxPA7MpoECTl7EKfrQlIS4JJGd9ZyL1I\njg03LSo9i5m2Bo4ku72o8LzduoBgEOSnGBc23wjU0c/BbiZQfDYO3L/xtfQojOME\n3mLpaWZlxRCEia1yMmWDVpmP9HxPfooEIlQjAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBACYAxx/1Plb2s1TKvTv9hQ1ZUaSaDEMr\nAKRqeJ3b5eFj96Z4Pw1N90OPnPwVN3MRQ86jnT9ogyArLPAfsy6+rZ4hBjuaAFBv\n1ZaaSylRiY6OZty9VXfBbBDXRDYbgT2neLYqBzlKyydStphAkSeaBBm+bcA6+Alr\n06bGwFmPzaYXCfzo6TZC1F38lvhHp4cPw+7VThcDfx5c3QJpC+KmF7C8wMr5uW5R\n/kEXER4og0NE5F15Pc6EM/4qeMnBPQuXO4NHRcsdAyHZUMpb0Rl8lZHZ7ZJ0cdiO\ns9Gmyq1Ae6EM7au/hlF2MnyfoaPzZsBOkujJD07p4aY8Elc/gbsUtGQ=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 1
to: 2
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Handler: secure connection with the server closed.
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 12 0.5833333333333334 1521595992283
connected to auth! from local port 45664
received auth hello!
{ authId: 502, nonce: <Buffer 15 5c 71 f9 8d 12 91 bc> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer a4 bd 88 85 da ab d3 7b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 81 2a 97 1a 6f 3f de 63 6d 66 c0 d2 30 11 ad de>,
  macKeyVal: <Buffer c0 cd ff d8 b0 39 0e d5 35 65 d7 49 25 df 3a a3 48 53 3d 19 63 36 67 07 21 c4 1f b8 31 01 86 86>,
  absValidity: 2018-03-21T02:33:12.462Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200469,
  cipherKeyVal: <Buffer ed 3c de 24 95 87 7e c2 cb 83 54 82 b1 36 76 d7>,
  macKeyVal: <Buffer 49 40 8a b8 73 ac 02 7a cc 4f 0d 76 07 f1 1c cf 0e 05 48 73 95 ab 48 cb 6f b7 79 5b c5 eb ff a1>,
  absValidity: 2018-03-22T01:33:12.462Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200469,
     cipherKeyVal: <Buffer ed 3c de 24 95 87 7e c2 cb 83 54 82 b1 36 76 d7>,
     macKeyVal: <Buffer 49 40 8a b8 73 ac 02 7a cc 4f 0d 76 07 f1 1c cf 0e 05 48 73 95 ab 48 cb 6f b7 79 5b c5 eb ff a1>,
     absValidity: 2018-03-22T01:33:12.462Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 13 0.5384615384615384 1521596052341
connected to auth! from local port 45914
received auth hello!
{ authId: 502, nonce: <Buffer 46 2b 79 dd 44 11 b7 d7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b1 32 82 7f a1 1a 96 8a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200483,
  cipherKeyVal: <Buffer fb 66 ab 96 07 47 36 62 5d 14 88 e1 a1 b8 db c6>,
  macKeyVal: <Buffer 5a 4c f5 78 6c 49 0e 81 31 91 13 55 44 f4 3f 72 6e ee ad 5e b6 be f6 e5 4f 9f c3 8f 19 1d c3 bd>,
  absValidity: 2018-03-22T01:34:12.462Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200483,
     cipherKeyVal: <Buffer fb 66 ab 96 07 47 36 62 5d 14 88 e1 a1 b8 db c6>,
     macKeyVal: <Buffer 5a 4c f5 78 6c 49 0e 81 31 91 13 55 44 f4 3f 72 6e ee ad 5e b6 be f6 e5 4f 9f c3 8f 19 1d c3 bd>,
     absValidity: 2018-03-22T01:34:12.462Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 14 0.5 1521596112401
connected to auth! from local port 46170
received auth hello!
{ authId: 502, nonce: <Buffer e4 c4 99 74 19 97 d1 ba> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8a c9 93 19 80 b4 bd 2f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200498,
  cipherKeyVal: <Buffer fc 68 9a ca a2 0d 13 7a fa 79 46 8e 20 14 1c 61>,
  macKeyVal: <Buffer dc a8 93 14 7d 37 64 44 ef 9b db 67 37 c5 f2 7c aa 96 99 0d b1 7c 79 79 6a 3b 13 32 7a d0 bc 74>,
  absValidity: 2018-03-22T01:35:12.532Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200498,
     cipherKeyVal: <Buffer fc 68 9a ca a2 0d 13 7a fa 79 46 8e 20 14 1c 61>,
     macKeyVal: <Buffer dc a8 93 14 7d 37 64 44 ef 9b db 67 37 c5 f2 7c aa 96 99 0d b1 7c 79 79 6a 3b 13 32 7a d0 bc 74>,
     absValidity: 2018-03-22T01:35:12.532Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 15 0.4666666666666667 1521596172450
connected to auth! from local port 46424
received auth hello!
{ authId: 502, nonce: <Buffer be 5c 79 85 b8 54 65 f9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b2 e3 ae d9 6d d5 0b 72>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200513,
  cipherKeyVal: <Buffer b9 27 2c 36 8a 13 0d 47 c2 f3 f0 f4 4f 58 f4 68>,
  macKeyVal: <Buffer f4 42 7e 09 95 aa ac 02 1a fe 9d f0 da 79 6f e2 0e bb 52 d4 2b a5 e0 e3 c4 89 3c f2 83 b4 1d 76>,
  absValidity: 2018-03-22T01:36:12.825Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200513,
     cipherKeyVal: <Buffer b9 27 2c 36 8a 13 0d 47 c2 f3 f0 f4 4f 58 f4 68>,
     macKeyVal: <Buffer f4 42 7e 09 95 aa ac 02 1a fe 9d f0 da 79 6f e2 0e bb 52 d4 2b a5 e0 e3 c4 89 3c f2 83 b4 1d 76>,
     absValidity: 2018-03-22T01:36:12.825Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 16 0.4375 1521596232493
connected to auth! from local port 46676
received auth hello!
{ authId: 502, nonce: <Buffer 1a f3 cd 55 89 48 9c 90> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 97 32 d1 2b 7b 42 c7 31>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200528,
  cipherKeyVal: <Buffer 93 9d b4 4b 78 d0 21 d5 be 95 e5 79 d5 e3 a4 b8>,
  macKeyVal: <Buffer 16 25 24 a5 f4 93 1f 1f 31 bc 00 bb 17 06 52 46 c8 b5 97 23 ce 44 1c a7 a3 ee f6 54 b8 e1 4e 21>,
  absValidity: 2018-03-22T01:37:12.828Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200528,
     cipherKeyVal: <Buffer 93 9d b4 4b 78 d0 21 d5 be 95 e5 79 d5 e3 a4 b8>,
     macKeyVal: <Buffer 16 25 24 a5 f4 93 1f 1f 31 bc 00 bb 17 06 52 46 c8 b5 97 23 ce 44 1c a7 a3 ee f6 54 b8 e1 4e 21>,
     absValidity: 2018-03-22T01:37:12.828Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 17 0.4117647058823529 1521596292554
connected to auth! from local port 46920
received auth hello!
{ authId: 502, nonce: <Buffer 2f 51 26 5f b7 1c 24 46> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c8 83 bd d0 df ad 81 5a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200543,
  cipherKeyVal: <Buffer 46 2c a9 1d 11 98 d8 08 bd fd d0 62 f2 04 b0 be>,
  macKeyVal: <Buffer f4 89 0a fe 56 9d 17 c2 c7 fb 1e 3f ad 0d 18 c8 39 3d 68 41 dd b5 3e a9 49 34 73 f0 e7 4b 1b ac>,
  absValidity: 2018-03-22T01:38:12.912Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200543,
     cipherKeyVal: <Buffer 46 2c a9 1d 11 98 d8 08 bd fd d0 62 f2 04 b0 be>,
     macKeyVal: <Buffer f4 89 0a fe 56 9d 17 c2 c7 fb 1e 3f ad 0d 18 c8 39 3d 68 41 dd b5 3e a9 49 34 73 f0 e7 4b 1b ac>,
     absValidity: 2018-03-22T01:38:12.912Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 18 0.3888888888888889 1521596352615
connected to auth! from local port 47158
received auth hello!
{ authId: 502, nonce: <Buffer 02 e9 44 51 91 77 57 62> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7b 5a cb a2 68 a2 72 3a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200558,
  cipherKeyVal: <Buffer ea 34 e1 88 72 e9 e4 a9 ae fb 1d 35 99 49 11 85>,
  macKeyVal: <Buffer 4f 53 6c 23 ac 9b 2c 04 a8 8d d6 16 57 4e 07 53 35 83 05 02 07 e5 1a fc ce 57 f3 40 aa 77 14 9f>,
  absValidity: 2018-03-22T01:39:12.752Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200558,
     cipherKeyVal: <Buffer ea 34 e1 88 72 e9 e4 a9 ae fb 1d 35 99 49 11 85>,
     macKeyVal: <Buffer 4f 53 6c 23 ac 9b 2c 04 a8 8d d6 16 57 4e 07 53 35 83 05 02 07 e5 1a fc ce 57 f3 40 aa 77 14 9f>,
     absValidity: 2018-03-22T01:39:12.752Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 19 0.3684210526315789 1521596412621
connected to auth! from local port 47408
received auth hello!
{ authId: 502, nonce: <Buffer ad d6 01 fe 2b 92 55 66> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c3 95 95 1d 7c 89 7d 9a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200573,
  cipherKeyVal: <Buffer 7f 2c f2 b9 16 a9 de 7d e9 24 38 94 8b bd b1 96>,
  macKeyVal: <Buffer 4a ff 98 41 81 01 d3 5f e7 5f ef ec 2e 29 07 5f 88 dd 6d e1 c3 c3 5d 0a 8c fb 3c d3 3d 0b a3 11>,
  absValidity: 2018-03-22T01:40:12.983Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200573,
     cipherKeyVal: <Buffer 7f 2c f2 b9 16 a9 de 7d e9 24 38 94 8b bd b1 96>,
     macKeyVal: <Buffer 4a ff 98 41 81 01 d3 5f e7 5f ef ec 2e 29 07 5f 88 dd 6d e1 c3 c3 5d 0a 8c fb 3c d3 3d 0b a3 11>,
     absValidity: 2018-03-22T01:40:12.983Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 20 0.35 1521596472628
connected to auth! from local port 47656
received auth hello!
{ authId: 502, nonce: <Buffer 3c 5e 21 4e 62 ce a3 6c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8f 09 c0 8d 13 4b d5 bb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200588,
  cipherKeyVal: <Buffer f1 55 aa b0 75 6f 7a 06 84 fe b9 1a 88 12 be f9>,
  macKeyVal: <Buffer e4 89 9d c2 f4 a7 4c b3 14 2e 33 0b fd 72 37 bb 83 b7 15 a7 11 0a 1b 9f cb 54 1f e4 1e e2 a6 2d>,
  absValidity: 2018-03-22T01:41:13.071Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200588,
     cipherKeyVal: <Buffer f1 55 aa b0 75 6f 7a 06 84 fe b9 1a 88 12 be f9>,
     macKeyVal: <Buffer e4 89 9d c2 f4 a7 4c b3 14 2e 33 0b fd 72 37 bb 83 b7 15 a7 11 0a 1b 9f cb 54 1f e4 1e e2 a6 2d>,
     absValidity: 2018-03-22T01:41:13.071Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 21 0.3333333333333333 1521596532646
connected to auth! from local port 47906
received auth hello!
{ authId: 502, nonce: <Buffer ff 96 b1 da 07 16 fe 89> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e3 4d 11 c1 20 ff 1c b8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200603,
  cipherKeyVal: <Buffer 5d f4 95 6d a5 ad 0d 86 1a ea d2 f1 1a f8 31 be>,
  macKeyVal: <Buffer b6 c3 20 67 c4 35 0d 9f 68 21 5a 0d 5f 18 ff 94 86 1f 04 7e 44 2b 01 3a d4 8a 03 dc 85 a3 a6 a9>,
  absValidity: 2018-03-22T01:42:13.092Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200603,
     cipherKeyVal: <Buffer 5d f4 95 6d a5 ad 0d 86 1a ea d2 f1 1a f8 31 be>,
     macKeyVal: <Buffer b6 c3 20 67 c4 35 0d 9f 68 21 5a 0d 5f 18 ff 94 86 1f 04 7e 44 2b 01 3a d4 8a 03 dc 85 a3 a6 a9>,
     absValidity: 2018-03-22T01:42:13.092Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 22 0.3181818181818182 1521596592701
connected to auth! from local port 48146
received auth hello!
{ authId: 502, nonce: <Buffer 27 b9 38 0e 4f 07 e5 dd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7f 31 64 6e 15 7f 1d a6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200618,
  cipherKeyVal: <Buffer e9 1b 02 4a 69 7d 50 29 ed 77 82 89 0b d6 47 fb>,
  macKeyVal: <Buffer 20 6d 7e ee 31 9d 35 1e 97 4b df 62 06 a9 ae d3 6d bb 8e 81 86 3c ac 68 5d d1 b5 23 ef 02 37 77>,
  absValidity: 2018-03-22T01:43:13.076Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200618,
     cipherKeyVal: <Buffer e9 1b 02 4a 69 7d 50 29 ed 77 82 89 0b d6 47 fb>,
     macKeyVal: <Buffer 20 6d 7e ee 31 9d 35 1e 97 4b df 62 06 a9 ae d3 6d bb 8e 81 86 3c ac 68 5d d1 b5 23 ef 02 37 77>,
     absValidity: 2018-03-22T01:43:13.076Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 23 0.30434782608695654 1521596652761
connected to auth! from local port 48384
received auth hello!
{ authId: 502, nonce: <Buffer 8a 7e 2f ee c7 65 a1 82> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2e 32 26 ab 42 76 b2 52>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200633,
  cipherKeyVal: <Buffer 43 1d fa a9 ef e1 fa 9a c7 d0 26 76 c7 c0 25 30>,
  macKeyVal: <Buffer e3 c5 56 fa 0f 26 9e c6 59 01 b1 54 49 e0 2f d5 53 30 2b 98 ae 0c ce 77 69 64 f5 53 3b 5c 76 f7>,
  absValidity: 2018-03-22T01:44:13.098Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200633,
     cipherKeyVal: <Buffer 43 1d fa a9 ef e1 fa 9a c7 d0 26 76 c7 c0 25 30>,
     macKeyVal: <Buffer e3 c5 56 fa 0f 26 9e c6 59 01 b1 54 49 e0 2f d5 53 30 2b 98 ae 0c ce 77 69 64 f5 53 3b 5c 76 f7>,
     absValidity: 2018-03-22T01:44:13.098Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 24 0.2916666666666667 1521596712821
connected to auth! from local port 48614
received auth hello!
{ authId: 502, nonce: <Buffer 03 b7 37 3d 8a 06 23 56> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 72 e2 0c ed 39 9e c6 58>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200648,
  cipherKeyVal: <Buffer c1 10 ed 88 67 59 1b 84 3e 65 8b 36 ac 6d 8c fd>,
  macKeyVal: <Buffer de 2b 16 50 c5 4c 6d 3d 82 25 b5 2b 48 1f f7 80 74 85 ee ba 86 d4 5f 9e 5a 94 25 14 92 54 d0 01>,
  absValidity: 2018-03-22T01:45:13.019Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200648,
     cipherKeyVal: <Buffer c1 10 ed 88 67 59 1b 84 3e 65 8b 36 ac 6d 8c fd>,
     macKeyVal: <Buffer de 2b 16 50 c5 4c 6d 3d 82 25 b5 2b 48 1f f7 80 74 85 ee ba 86 d4 5f 9e 5a 94 25 14 92 54 d0 01>,
     absValidity: 2018-03-22T01:45:13.019Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 25 0.28 1521596772881
connected to auth! from local port 48852
received auth hello!
{ authId: 502, nonce: <Buffer 5d 0f 9e 0d 67 cf f2 d3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 13 1c fa 74 dd 15 97 0c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200663,
  cipherKeyVal: <Buffer 00 64 3c 2b 11 e5 16 6e e9 19 b4 55 a3 1a af 11>,
  macKeyVal: <Buffer ee 24 59 ff 2b b0 dc 29 55 bd ea b1 14 35 21 8a e2 68 fd 0c 89 27 88 b5 a4 27 77 35 99 ba 5b 43>,
  absValidity: 2018-03-22T01:46:13.022Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200663,
     cipherKeyVal: <Buffer 00 64 3c 2b 11 e5 16 6e e9 19 b4 55 a3 1a af 11>,
     macKeyVal: <Buffer ee 24 59 ff 2b b0 dc 29 55 bd ea b1 14 35 21 8a e2 68 fd 0c 89 27 88 b5 a4 27 77 35 99 ba 5b 43>,
     absValidity: 2018-03-22T01:46:13.022Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 26 0.2692307692307692 1521596832942
connected to auth! from local port 49088
received auth hello!
{ authId: 502, nonce: <Buffer 97 ee 1a e9 9e 09 e1 1e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3b c7 1a 9f 14 58 56 4f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200678,
  cipherKeyVal: <Buffer 10 94 50 15 19 44 ac d6 e5 a4 70 13 e2 5b 00 e4>,
  macKeyVal: <Buffer 12 7d 45 f6 76 59 2f b2 bd 89 88 e4 22 10 75 a9 eb 4d 81 9d a2 fc 93 e8 c8 6c c2 8b 4c 61 36 63>,
  absValidity: 2018-03-22T01:47:13.256Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200678,
     cipherKeyVal: <Buffer 10 94 50 15 19 44 ac d6 e5 a4 70 13 e2 5b 00 e4>,
     macKeyVal: <Buffer 12 7d 45 f6 76 59 2f b2 bd 89 88 e4 22 10 75 a9 eb 4d 81 9d a2 fc 93 e8 c8 6c c2 8b 4c 61 36 63>,
     absValidity: 2018-03-22T01:47:13.256Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 27 0.25925925925925924 1521596892960
connected to auth! from local port 49322
received auth hello!
{ authId: 502, nonce: <Buffer fa 89 05 4e 75 41 b3 7a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 62 7a e1 2f 3d 1f dd 08>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200693,
  cipherKeyVal: <Buffer 81 e8 14 01 56 83 8d 43 f2 e0 c2 97 a9 83 a2 95>,
  macKeyVal: <Buffer 36 38 e9 64 93 23 c4 46 f4 e8 23 31 c8 73 de 54 d1 a6 bf b2 4b 9e d1 b5 81 53 87 12 9e cd e2 42>,
  absValidity: 2018-03-22T01:48:13.167Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200693,
     cipherKeyVal: <Buffer 81 e8 14 01 56 83 8d 43 f2 e0 c2 97 a9 83 a2 95>,
     macKeyVal: <Buffer 36 38 e9 64 93 23 c4 46 f4 e8 23 31 c8 73 de 54 d1 a6 bf b2 4b 9e d1 b5 81 53 87 12 9e cd e2 42>,
     absValidity: 2018-03-22T01:48:13.167Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
