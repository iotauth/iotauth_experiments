changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c525.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c525',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 67 49 42 41 41 4b 43 41 51 45 41 74 74 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521572534196
connected to auth! from local port 51148
received auth hello!
{ authId: 504, nonce: <Buffer 87 f8 c7 6f f0 c4 ac 0a> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 42 63 0b 88 58 a7 df f5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer a5 5e e2 f1 b8 07 a5 22 0a 55 8a a6 cd a4 8a 0d>,
  macKeyVal: <Buffer 61 47 73 4c 2e 83 f4 a6 6d a1 ff ea 0b 65 ed cc 55 57 83 5a 75 23 07 64 78 ec 38 29 7e ca 7d 9c>,
  absValidity: 2018-03-20T20:02:19.125Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400080,
  cipherKeyVal: <Buffer 26 48 c1 1e 9b 4e 1b 3d 59 d1 2c 95 f1 bc 21 67>,
  macKeyVal: <Buffer 61 db 98 4f e4 97 72 39 00 72 c6 29 da fa b9 09 d8 b1 95 7f a5 d4 65 a1 c2 63 3a b2 90 e0 be 53>,
  absValidity: 2018-03-21T19:02:19.125Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50400080,
     cipherKeyVal: <Buffer 26 48 c1 1e 9b 4e 1b 3d 59 d1 2c 95 f1 bc 21 67>,
     macKeyVal: <Buffer 61 db 98 4f e4 97 72 39 00 72 c6 29 da fa b9 09 d8 b1 95 7f a5 d4 65 a1 c2 63 3a b2 90 e0 be 53>,
     absValidity: 2018-03-21T19:02:19.125Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 66 71 c2 f6 1c 02 ad 02>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:02:23 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521572544020
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521572594246
connected to auth! from local port 51418
received auth hello!
{ authId: 504, nonce: <Buffer 52 c3 56 aa c1 55 1b 5f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer dd a3 be a4 27 44 a2 b1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400086,
  cipherKeyVal: <Buffer 15 77 f5 70 72 b6 64 7b b8 20 73 d1 87 c2 ac ad>,
  macKeyVal: <Buffer c7 50 52 1c 4c 9a 1d 7c d0 aa 83 9d 49 77 7e 37 d3 e2 77 f0 cc 7d 77 4a ff c7 30 de 0f af f8 96>,
  absValidity: 2018-03-21T19:03:19.421Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50400086,
     cipherKeyVal: <Buffer 15 77 f5 70 72 b6 64 7b b8 20 73 d1 87 c2 ac ad>,
     macKeyVal: <Buffer c7 50 52 1c 4c 9a 1d 7c d0 aa 83 9d 49 77 7e 37 d3 e2 77 f0 cc 7d 77 4a ff c7 30 de 0f af f8 96>,
     absValidity: 2018-03-21T19:03:19.421Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer b7 d9 94 84 7e 09 db bc>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:03:23 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521572603945
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521572654293
connected to auth! from local port 51690
received auth hello!
{ authId: 504, nonce: <Buffer 0d 25 03 de 0a 77 4d b3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 36 38 aa d9 58 62 c2 56>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400092,
  cipherKeyVal: <Buffer b7 e3 9e a8 43 b6 18 ed 4a c5 21 5a 19 65 33 41>,
  macKeyVal: <Buffer ef 6c 36 99 61 98 45 53 17 83 30 6f 25 34 d4 f6 31 d2 5d 23 db c8 71 33 35 67 d9 b7 c6 d8 a5 98>,
  absValidity: 2018-03-21T19:04:19.488Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50400092,
     cipherKeyVal: <Buffer b7 e3 9e a8 43 b6 18 ed 4a c5 21 5a 19 65 33 41>,
     macKeyVal: <Buffer ef 6c 36 99 61 98 45 53 17 83 30 6f 25 34 d4 f6 31 d2 5d 23 db c8 71 33 35 67 d9 b7 c6 d8 a5 98>,
     absValidity: 2018-03-21T19:04:19.488Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 75 20 a5 68 34 d3 c1 0a>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:04:23 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521572664006
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521572714335
connected to auth! from local port 51958
received auth hello!
{ authId: 504, nonce: <Buffer 78 6f de 49 24 d4 f4 3e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 07 64 42 0d 45 5b a7 6e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400098,
  cipherKeyVal: <Buffer 06 b9 ce b2 b9 f0 47 7d f0 fe ce 77 54 75 35 56>,
  macKeyVal: <Buffer e9 cb 2d 8d ab 98 01 5f 95 a0 53 89 95 a2 2d ed 81 86 e8 a1 f4 45 df 21 5f 84 ad 04 53 90 b1 c1>,
  absValidity: 2018-03-21T19:05:19.187Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50400098,
     cipherKeyVal: <Buffer 06 b9 ce b2 b9 f0 47 7d f0 fe ce 77 54 75 35 56>,
     macKeyVal: <Buffer e9 cb 2d 8d ab 98 01 5f 95 a0 53 89 95 a2 2d ed 81 86 e8 a1 f4 45 df 21 5f 84 ad 04 53 90 b1 c1>,
     absValidity: 2018-03-21T19:05:19.187Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 1c 3d 59 2e ad 02 28 11>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:05:23 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521572724125
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521572774363
connected to auth! from local port 52228
received auth hello!
{ authId: 504, nonce: <Buffer 72 80 dc 57 56 df 5f f0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ca cb fa 92 76 b0 0d 4e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400104,
  cipherKeyVal: <Buffer be 5b bb fa ab a6 44 84 f8 a7 00 3d 32 98 dc 04>,
  macKeyVal: <Buffer 0e 71 d3 5c 86 fd fb 35 2c 67 df 62 ed a8 15 0e 7f 11 43 0a 46 aa 4a 72 ed ab 98 e1 25 c2 5b f4>,
  absValidity: 2018-03-21T19:06:19.629Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50400104,
     cipherKeyVal: <Buffer be 5b bb fa ab a6 44 84 f8 a7 00 3d 32 98 dc 04>,
     macKeyVal: <Buffer 0e 71 d3 5c 86 fd fb 35 2c 67 df 62 ed a8 15 0e 7f 11 43 0a 46 aa 4a 72 ed ab 98 e1 25 c2 5b f4>,
     absValidity: 2018-03-21T19:06:19.629Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer da e4 0c b7 37 d3 84 b3>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:06:23 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521572784035
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521572834409
connected to auth! from local port 52498
received auth hello!
{ authId: 504, nonce: <Buffer 34 6e f6 ef e1 e0 e4 40> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 69 da 57 d7 ac 09 05 02>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400110,
  cipherKeyVal: <Buffer 7e a1 eb 23 f9 7a a5 22 61 d2 62 d9 a3 4e 3d 65>,
  macKeyVal: <Buffer ea 2b dd f7 c7 a1 61 4f a9 38 ce a7 6c 5a 8b 7e f5 89 b0 21 18 6b f7 d2 92 c8 10 b2 b6 08 74 8f>,
  absValidity: 2018-03-21T19:07:18.097Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50400110,
     cipherKeyVal: <Buffer 7e a1 eb 23 f9 7a a5 22 61 d2 62 d9 a3 4e 3d 65>,
     macKeyVal: <Buffer ea 2b dd f7 c7 a1 61 4f a9 38 ce a7 6c 5a 8b 7e f5 89 b0 21 18 6b f7 d2 92 c8 10 b2 b6 08 74 8f>,
     absValidity: 2018-03-21T19:07:18.097Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 08 33 8d 3d 36 25 e3 71>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:07:25 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521572845668
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521572894417
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 8 0.75 1521572954418
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 59010
received auth hello!
{ authId: 503, nonce: <Buffer 09 42 80 a3 7f f6 55 6d> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 9 0.6666666666666666 1521573014429
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 59238
received auth hello!
{ authId: 503, nonce: <Buffer 06 8f 17 38 9f 90 63 10> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 10 0.6 1521573074439
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 47362
received auth hello!
{ authId: 403, nonce: <Buffer bb f8 2f 8b 23 b1 92 27> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 11 0.5454545454545454 1521573134450
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 47600
received auth hello!
{ authId: 403, nonce: <Buffer d6 79 c4 05 f9 42 12 c0> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 12 0.5 1521573194456
failure in connection with Auth : authFailureCount: 6
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 42118
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 13 0.46153846153846156 1521573254463
failure in connection with Auth : authFailureCount: 7
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 42384
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 14 0.42857142857142855 1521573314469
failure in connection with Auth : authFailureCount: 8
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 2
to: 3
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 15 0.4 1521573374477
failure in connection with Auth : authFailureCount: 9
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 3
to: 4
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.2:21100
/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902
            eventHandlers.onError('Error occurred in migration request: Disconnected from auth before getting migration response: ' + error);
                                                                                                                                      ^

ReferenceError: error is not defined
    at Socket.<anonymous> (/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902:135)
    at emitNone (events.js:91:20)
    at Socket.emit (events.js:188:7)
    at endReadableNT (_stream_readable.js:975:12)
    at _combinedTickCallback (internal/process/next_tick.js:80:11)
    at process._tickCallback (internal/process/next_tick.js:104:9)
