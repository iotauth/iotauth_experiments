changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c501.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c501',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 76 4e ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521572455296
connected to auth! from local port 55928
received auth hello!
{ authId: 501, nonce: <Buffer 28 4a 5b b0 52 f0 bb ce> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 28 73 f6 97 ad 95 a8 d6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 07 4a 69 98 26 11 f1 16 29 6d 2b df 14 e4 3e 23>,
  macKeyVal: <Buffer af f0 e9 7b f6 93 51 76 48 21 10 74 66 f1 1d 2a 2c 68 aa 4b d6 11 b7 5c c1 7c 69 19 64 8a cc 0d>,
  absValidity: 2018-03-20T20:00:55.535Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100442,
  cipherKeyVal: <Buffer b2 f0 f9 65 e9 93 42 03 8a 31 31 16 bc ee 74 49>,
  macKeyVal: <Buffer 74 28 b4 6d 4e 5e 09 c2 41 dd b9 8c 2e 07 48 59 43 7b 4e e1 3f 30 63 a1 a1 37 b7 a1 90 15 66 8b>,
  absValidity: 2018-03-21T19:00:55.532Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50100442,
     cipherKeyVal: <Buffer b2 f0 f9 65 e9 93 42 03 8a 31 31 16 bc ee 74 49>,
     macKeyVal: <Buffer 74 28 b4 6d 4e 5e 09 c2 41 dd b9 8c 2e 07 48 59 43 7b 4e e1 3f 30 63 a1 a1 37 b7 a1 90 15 66 8b>,
     absValidity: 2018-03-21T19:00:55.532Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 02 7a 2c 85 8b 36 fb 50>
switching to HANDSHAKE_1_SENT
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:00:56 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521572456551
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521572515354
connected to auth! from local port 56156
received auth hello!
{ authId: 501, nonce: <Buffer 10 8c 43 64 32 f2 07 f7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6e 13 04 00 0d b2 55 30>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100450,
  cipherKeyVal: <Buffer ab b2 b4 26 6e 6b b0 ee 8a 19 9c 13 bc fb e6 82>,
  macKeyVal: <Buffer 39 0b 3f c9 b7 53 1f 52 89 2f 66 67 da d9 f0 98 21 4e 1a 16 34 b9 aa 2d 4d fb 75 d2 c2 99 04 b8>,
  absValidity: 2018-03-21T19:01:55.674Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50100450,
     cipherKeyVal: <Buffer ab b2 b4 26 6e 6b b0 ee 8a 19 9c 13 bc fb e6 82>,
     macKeyVal: <Buffer 39 0b 3f c9 b7 53 1f 52 89 2f 66 67 da d9 f0 98 21 4e 1a 16 34 b9 aa 2d 4d fb 75 d2 c2 99 04 b8>,
     absValidity: 2018-03-21T19:01:55.674Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 69 3a 21 9d a1 fd 8c cf>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:01:56 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521572517005
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521572575413
connected to auth! from local port 56426
received auth hello!
{ authId: 501, nonce: <Buffer 76 3d 3b 0b e6 65 25 7b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fd 1f bc 43 70 2e 35 51>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100458,
  cipherKeyVal: <Buffer 54 f6 a1 54 48 dd 63 a3 87 5d 86 7f a0 30 4e 42>,
  macKeyVal: <Buffer 21 82 92 84 11 15 e4 4b 37 bb 62 66 64 16 30 bd cc fd 18 59 e3 58 b1 50 c5 d1 06 3e f7 13 29 58>,
  absValidity: 2018-03-21T19:02:55.736Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50100458,
     cipherKeyVal: <Buffer 54 f6 a1 54 48 dd 63 a3 87 5d 86 7f a0 30 4e 42>,
     macKeyVal: <Buffer 21 82 92 84 11 15 e4 4b 37 bb 62 66 64 16 30 bd cc fd 18 59 e3 58 b1 50 c5 d1 06 3e f7 13 29 58>,
     absValidity: 2018-03-21T19:02:55.736Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 11 51 30 ed 92 4e 2a e4>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:02:56 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521572577025
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521572635444
connected to auth! from local port 56696
received auth hello!
{ authId: 501, nonce: <Buffer 03 a7 fe 44 ff ae ac fd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d0 c5 be ea fd 02 b1 9e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100466,
  cipherKeyVal: <Buffer 0f bd 57 23 1f a5 af 7e 3f b3 b4 10 2c a0 0f 39>,
  macKeyVal: <Buffer 56 92 d8 c6 63 a6 67 73 7a 13 22 28 e0 14 b9 9d 15 9a 36 2d 7a 5c 0f be 07 4a 5e 90 3b 4f ad 8e>,
  absValidity: 2018-03-21T19:03:55.744Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50100466,
     cipherKeyVal: <Buffer 0f bd 57 23 1f a5 af 7e 3f b3 b4 10 2c a0 0f 39>,
     macKeyVal: <Buffer 56 92 d8 c6 63 a6 67 73 7a 13 22 28 e0 14 b9 9d 15 9a 36 2d 7a 5c 0f be 07 4a 5e 90 3b 4f ad 8e>,
     absValidity: 2018-03-21T19:03:55.744Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 3c 2b 33 1b c8 6f 7d c5>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:03:56 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521572636954
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521572695501
connected to auth! from local port 56966
received auth hello!
{ authId: 501, nonce: <Buffer de 56 0a 7e 6d e7 00 78> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 25 d4 23 67 60 8b 80 a7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100474,
  cipherKeyVal: <Buffer 79 a8 f8 79 9d a4 31 cc b2 12 96 e3 ef 75 e8 79>,
  macKeyVal: <Buffer b2 5e f6 14 db 3b d0 df 62 25 b9 da f1 81 03 43 74 3e 46 20 71 2b a9 eb 2d 75 db 7e c4 f2 fb b1>,
  absValidity: 2018-03-21T19:04:55.800Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50100474,
     cipherKeyVal: <Buffer 79 a8 f8 79 9d a4 31 cc b2 12 96 e3 ef 75 e8 79>,
     macKeyVal: <Buffer b2 5e f6 14 db 3b d0 df 62 25 b9 da f1 81 03 43 74 3e 46 20 71 2b a9 eb 2d 75 db 7e c4 f2 fb b1>,
     absValidity: 2018-03-21T19:04:55.800Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 26 02 2d 78 38 a5 30 f7>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:04:56 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521572696981
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521572755557
connected to auth! from local port 57236
received auth hello!
{ authId: 501, nonce: <Buffer 6f af 43 1f ba 10 92 c3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 29 56 6f 61 14 d3 08 be>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100482,
  cipherKeyVal: <Buffer d1 99 a4 da d4 7e c8 9c 6f d4 8e 06 ac b5 34 6f>,
  macKeyVal: <Buffer 83 63 5b c0 9a 85 b9 54 cd b6 ab 72 a0 8b 74 e9 e6 82 88 eb 02 d8 73 9c 3a 30 87 91 7e e2 8d f7>,
  absValidity: 2018-03-21T19:05:55.845Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50100482,
     cipherKeyVal: <Buffer d1 99 a4 da d4 7e c8 9c 6f d4 8e 06 ac b5 34 6f>,
     macKeyVal: <Buffer 83 63 5b c0 9a 85 b9 54 cd b6 ab 72 a0 8b 74 e9 e6 82 88 eb 02 d8 73 9c 3a 30 87 91 7e e2 8d f7>,
     absValidity: 2018-03-21T19:05:55.845Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 39 ea 95 21 69 5e 73 2a>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:05:56 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521572757060
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521572815605
connected to auth! from local port 57506
received auth hello!
{ authId: 501, nonce: <Buffer 47 e7 4e 78 bd aa eb fa> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 84 00 c5 75 60 8c 2a 33>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100490,
  cipherKeyVal: <Buffer f6 6e ec 8e 90 5d 6a 3e d9 0f 3b b5 2c f3 1d df>,
  macKeyVal: <Buffer c3 c3 89 93 b3 b4 ad 19 59 5e 84 90 03 a8 81 56 df 11 95 64 17 d3 c0 6d fd 20 80 b7 d4 cb de 4a>,
  absValidity: 2018-03-21T19:06:55.892Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50100490,
     cipherKeyVal: <Buffer f6 6e ec 8e 90 5d 6a 3e d9 0f 3b b5 2c f3 1d df>,
     macKeyVal: <Buffer c3 c3 89 93 b3 b4 ad 19 59 5e 84 90 03 a8 81 56 df 11 95 64 17 d3 c0 6d fd 20 80 b7 d4 cb de 4a>,
     absValidity: 2018-03-21T19:06:55.892Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer ef 76 25 d5 5a d8 30 d3>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:06:56 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521572817029
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521572875642
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 9 0.7777777777777778 1521572935649
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 41534
received auth hello!
{ authId: 401, nonce: <Buffer 93 21 e6 67 77 1a 08 26> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 10 0.7 1521572995660
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 41760
received auth hello!
{ authId: 401, nonce: <Buffer 58 fc 80 95 54 9a 22 de> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 11 0.6363636363636364 1521573055662
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 12 0.5833333333333334 1521573115669
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 38318
received auth hello!
{ authId: 502, nonce: <Buffer 6d 2d d6 43 56 64 07 70> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '016244C731B0',
  notBefore: 2018-03-20T18:57:07.000Z,
  notAfter: 2018-03-21T18:58:47.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '93:7A:A1:94:F3:58:54:82:C2:CB:99:F0:13:9C:F6:6B:66:B8:99:CC',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'E40B9EF20959AA49D02016EC2E9896074EE0818689EAD7319ECC8ED8C9557412ED46C95E67464598F6233ECEB8BF25A876F0D30B65CED2B1FED8D1F07CF9042FD7F86E3B637BE17FBFD7C9F0DB5850835170B354A52C175B769A37BA578F965436FF29BCFD54C5D4E939E02214503C8A69FFBBF0EC06657DF9498BE98DEB26B62E1453817F6DFAE9B50EE21C5A643FF0292539838A682562303CB77FC6028B22B30B78957E4F78E539103F991928681EBF3100D31960F43F8ECFC6C2F3063B353E92BFFEF77A49BBCBF417864AE8169AA061F590E5FB3393A4592EFA1100FC186B95B83724CA0B11D8BC02BC9BD4F9E08552DE2D1EB0EE0E866E41A520730E6F',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJExzGwMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDMy\nMDE4NTcwN1oXDTE4MDMyMTE4NTg0N1owYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDkC57yCVmqSdAgFuwumJYHTuCBhonq1zGezI7YyVV0Eu1GyV5n\nRkWY9iM+zri/Jah28NMLZc7Ssf7Y0fB8+QQv1/huO2N74X+/18nw21hQg1Fws1Sl\nLBdbdpo3ulePllQ2/ym8/VTF1Ok54CIUUDyKaf+78OwGZX35SYvpjesmti4UU4F/\nbfrptQ7iHFpkP/ApJTmDimglYjA8t3/GAosiswt4lX5PeOU5ED+ZGShoHr8xANMZ\nYPQ/js/GwvMGOzU+kr/+93pJu8v0F4ZK6BaaoGH1kOX7M5OkWS76EQD8GGuVuDck\nygsR2LwCvJvU+eCFUt4tHrDuDoZuQaUgcw5vAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAIpAd3VKIQtsOp7Gd/n+U5dQGb1TbSuD\nNQk/HKl8/HzsGeRYEr03C8HMvU65HMRGtBcvzOn2KwcEgiT/9coa+YDtK1xJybhH\nPIloSWRq7NaoE4bYMp+gpRLUhZsV1RmMwFkEgfdjdkzZhQvtC11azkYH1d9yofSK\nAMxR5ZIFMXeAjAqYWVVQZUbCBD+RI7C4tf9TN22n7l8a+LemH6KutXlo2GAcWQVL\ng0GYJeMdzdZd09xIAX5ufxOwpz3QVVJ7nADmjQyVvdhsMoWseoRVmIEVNZ4KF2ow\n+L8v+Z191H3ur6zYAo38yWRpih+c8FR93Izsktw3ACeFXHA5Oyh9k+o=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 2
to: 3
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 13 0.5384615384615384 1521573175677
connected to auth! from local port 38544
received auth hello!
{ authId: 502, nonce: <Buffer 45 c6 bc ef 26 25 5c 46> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 90 8e 04 0a 28 d4 65 92>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 9f 7d e0 fb 7d e0 37 88 02 7a 34 b6 40 e7 79 3b>,
  macKeyVal: <Buffer 59 4f 6b 08 e4 2b 8e f1 81 55 cd 44 1f e5 67 08 cc 6d 86 6d dc 23 f2 e7 76 11 72 c3 b0 66 55 5c>,
  absValidity: 2018-03-20T20:12:55.999Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200477,
  cipherKeyVal: <Buffer 04 41 fb f0 45 98 dd 89 26 3b 2f f3 02 7d de 72>,
  macKeyVal: <Buffer 1b b0 f5 31 4d 78 32 25 89 04 ef 86 60 47 f1 1c cc 8a e0 5f 4b 87 2d d2 70 38 86 46 ad 0f a2 bd>,
  absValidity: 2018-03-21T19:12:55.999Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50200477,
     cipherKeyVal: <Buffer 04 41 fb f0 45 98 dd 89 26 3b 2f f3 02 7d de 72>,
     macKeyVal: <Buffer 1b b0 f5 31 4d 78 32 25 89 04 ef 86 60 47 f1 1c cc 8a e0 5f 4b 87 2d d2 70 38 86 46 ad 0f a2 bd>,
     absValidity: 2018-03-21T19:12:55.999Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 03 2f b0 f3 d6 da 10 0f>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.24:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 14 0.5 1521573235685
connected to auth! from local port 38806
received auth hello!
{ authId: 502, nonce: <Buffer 50 f0 ab f8 b5 36 5f 6c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b4 7a 20 66 c0 81 ae e5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200492,
  cipherKeyVal: <Buffer 8e 58 04 a5 d3 db 24 da df 62 23 04 ed b2 0c b3>,
  macKeyVal: <Buffer ac cf 56 c3 30 eb 0f fa 10 1a 25 f9 48 9a 3e f4 58 8d a8 f7 bc 64 8f 11 28 97 09 37 7b 35 6f b8>,
  absValidity: 2018-03-21T19:13:58.160Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50200492,
     cipherKeyVal: <Buffer 8e 58 04 a5 d3 db 24 da df 62 23 04 ed b2 0c b3>,
     macKeyVal: <Buffer ac cf 56 c3 30 eb 0f fa 10 1a 25 f9 48 9a 3e f4 58 8d a8 f7 bc 64 8f 11 28 97 09 37 7b 35 6f b8>,
     absValidity: 2018-03-21T19:13:58.160Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 2c 03 c9 3a e8 37 3c 31>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.24:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 15 0.4666666666666667 1521573295686
connected to auth! from local port 39078
received auth hello!
{ authId: 502, nonce: <Buffer bb ae 8d bc 49 44 d7 17> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e4 d0 94 3a 55 09 e6 ca>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200507,
  cipherKeyVal: <Buffer e2 e3 8c 1b 78 28 a1 cb e7 eb 8f ea 77 b5 f5 a6>,
  macKeyVal: <Buffer 36 a8 33 08 bb d6 85 c6 9c 19 95 8a cf 36 dd 78 51 11 af 7e dc cf b2 a8 70 55 d0 db a7 27 a0 e8>,
  absValidity: 2018-03-21T19:14:59.685Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50200507,
     cipherKeyVal: <Buffer e2 e3 8c 1b 78 28 a1 cb e7 eb 8f ea 77 b5 f5 a6>,
     macKeyVal: <Buffer 36 a8 33 08 bb d6 85 c6 9c 19 95 8a cf 36 dd 78 51 11 af 7e dc cf b2 a8 70 55 d0 db a7 27 a0 e8>,
     absValidity: 2018-03-21T19:14:59.685Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 89 cb b9 96 66 30 76 15>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.24:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 16 0.4375 1521573355689
connected to auth! from local port 39348
received auth hello!
{ authId: 502, nonce: <Buffer 07 8e 23 5c fd 56 07 c2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 08 b5 08 7c 6f 86 bf 07>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200522,
  cipherKeyVal: <Buffer d8 49 fd d8 c5 bf d9 72 45 e2 88 45 fa bf 88 2a>,
  macKeyVal: <Buffer 4d cb 4c 71 b7 0e ac c8 d0 cd e2 26 e7 8d 3a 6e 36 2a 7d ca 30 bf 22 c7 2d bb d3 16 43 e0 17 56>,
  absValidity: 2018-03-21T19:15:59.536Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50200522,
     cipherKeyVal: <Buffer d8 49 fd d8 c5 bf d9 72 45 e2 88 45 fa bf 88 2a>,
     macKeyVal: <Buffer 4d cb 4c 71 b7 0e ac c8 d0 cd e2 26 e7 8d 3a 6e 36 2a 7d ca 30 bf 22 c7 2d bb d3 16 43 e0 17 56>,
     absValidity: 2018-03-21T19:15:59.536Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 38 af 60 e8 20 8f 8e 38>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.24:undefined
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 17 0.4117647058823529 1521573415696
connected to auth! from local port 39614
received auth hello!
{ authId: 502, nonce: <Buffer 0c e7 bc b2 b1 8b f2 f0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 94 39 f4 3d e4 0b 97 21>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200538,
  cipherKeyVal: <Buffer 2d 8b 87 9e 69 82 24 0e 5b f2 1d cc 38 54 7c 99>,
  macKeyVal: <Buffer fa e2 42 56 e4 b8 29 09 60 2d 25 b5 5b a9 bf 8f f4 9c 83 8a ff a9 48 e5 a1 77 39 d5 8e 2e 36 2b>,
  absValidity: 2018-03-21T19:17:05.283Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50200538,
     cipherKeyVal: <Buffer 2d 8b 87 9e 69 82 24 0e 5b f2 1d cc 38 54 7c 99>,
     macKeyVal: <Buffer fa e2 42 56 e4 b8 29 09 60 2d 25 b5 5b a9 bf 8f f4 9c 83 8a ff a9 48 e5 a1 77 39 d5 8e 2e 36 2b>,
     absValidity: 2018-03-21T19:17:05.283Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.24:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 18 0.3888888888888889 1521573475744
connected to auth! from local port 39858
received auth hello!
{ authId: 502, nonce: <Buffer d3 a8 b8 8a c1 96 02 71> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 15 36 c4 7d 07 34 0b 57>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200552,
  cipherKeyVal: <Buffer b0 75 63 da b8 3f 89 15 9a f9 73 99 ae b4 cf 0e>,
  macKeyVal: <Buffer 3a b2 94 0e 66 d2 82 93 55 21 7c bc 2a b4 6b 98 8d f5 d0 1e 5a e7 b6 cc 2e b3 fa eb a1 c1 96 5f>,
  absValidity: 2018-03-21T19:17:57.044Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50200552,
     cipherKeyVal: <Buffer b0 75 63 da b8 3f 89 15 9a f9 73 99 ae b4 cf 0e>,
     macKeyVal: <Buffer 3a b2 94 0e 66 d2 82 93 55 21 7c bc 2a b4 6b 98 8d f5 d0 1e 5a e7 b6 cc 2e b3 fa eb a1 c1 96 5f>,
     absValidity: 2018-03-21T19:17:57.044Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.24:22100
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 19 0.3684210526315789 1521573535801
connected to auth! from local port 40088
received auth hello!
{ authId: 502, nonce: <Buffer d5 11 e8 1a 95 98 9b d3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c4 d5 b5 99 cf 13 a8 ae>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200567,
  cipherKeyVal: <Buffer 13 dd a1 26 d5 08 1e e8 a8 7a 3f 1f b7 5d a4 c9>,
  macKeyVal: <Buffer 54 13 f2 9a 26 e8 7b 1c cf bf 7f 9f 73 b1 2d 62 6d 86 00 93 a3 cb a9 07 95 ad 2c e2 0d 14 cd 74>,
  absValidity: 2018-03-21T19:18:57.053Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50200567,
     cipherKeyVal: <Buffer 13 dd a1 26 d5 08 1e e8 a8 7a 3f 1f b7 5d a4 c9>,
     macKeyVal: <Buffer 54 13 f2 9a 26 e8 7b 1c cf bf 7f 9f 73 b1 2d 62 6d 86 00 93 a3 cb a9 07 95 ad 2c e2 0d 14 cd 74>,
     absValidity: 2018-03-21T19:18:57.053Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.24:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 20 0.35 1521573595839
connected to auth! from local port 40312
received auth hello!
{ authId: 502, nonce: <Buffer be 4c 76 f2 31 fb 29 3f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ae d7 9b 70 46 6b 3e b4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200582,
  cipherKeyVal: <Buffer e6 5d f2 2b 34 0b 9b be 91 76 ff 24 ed 68 c4 1d>,
  macKeyVal: <Buffer b0 45 e8 1c 33 b9 1c 60 a3 01 94 e9 00 c3 b9 44 68 d9 a2 5c 89 c9 47 24 f3 a0 e1 c9 b5 53 fa 75>,
  absValidity: 2018-03-21T19:19:57.151Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50200582,
     cipherKeyVal: <Buffer e6 5d f2 2b 34 0b 9b be 91 76 ff 24 ed 68 c4 1d>,
     macKeyVal: <Buffer b0 45 e8 1c 33 b9 1c 60 a3 01 94 e9 00 c3 b9 44 68 d9 a2 5c 89 c9 47 24 f3 a0 e1 c9 b5 53 fa 75>,
     absValidity: 2018-03-21T19:19:57.151Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.24:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 21 0.3333333333333333 1521573655897
connected to auth! from local port 40536
received auth hello!
{ authId: 502, nonce: <Buffer b4 65 f6 6b b4 ea 57 af> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e4 fa 12 f6 77 d5 35 1c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200597,
  cipherKeyVal: <Buffer 21 bc 0d 42 ae 92 f7 7f 92 b1 f5 b4 be 50 7c 41>,
  macKeyVal: <Buffer a4 85 89 93 f2 28 09 f9 e9 da 42 19 1b 45 09 20 10 5a 40 d5 9e 88 fd 68 41 fc c5 2f 3c 14 12 58>,
  absValidity: 2018-03-21T19:20:57.117Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50200597,
     cipherKeyVal: <Buffer 21 bc 0d 42 ae 92 f7 7f 92 b1 f5 b4 be 50 7c 41>,
     macKeyVal: <Buffer a4 85 89 93 f2 28 09 f9 e9 da 42 19 1b 45 09 20 10 5a 40 d5 9e 88 fd 68 41 fc c5 2f 3c 14 12 58>,
     absValidity: 2018-03-21T19:20:57.117Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.24:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 22 0.3181818181818182 1521573715947
connected to auth! from local port 40766
received auth hello!
{ authId: 502, nonce: <Buffer d7 0c 34 2f 63 71 82 16> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e3 9d 64 38 89 0d 16 36>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200612,
  cipherKeyVal: <Buffer 0e 40 52 c4 2c b9 30 a3 fd 98 38 11 ff 84 6f 38>,
  macKeyVal: <Buffer 55 c9 8c 0a 04 aa a9 d9 dd 80 f5 a3 cc 04 68 50 ce 56 18 4d 6e 23 7d 47 0f 15 a9 82 b4 42 6b 3e>,
  absValidity: 2018-03-21T19:21:57.173Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50200612,
     cipherKeyVal: <Buffer 0e 40 52 c4 2c b9 30 a3 fd 98 38 11 ff 84 6f 38>,
     macKeyVal: <Buffer 55 c9 8c 0a 04 aa a9 d9 dd 80 f5 a3 cc 04 68 50 ce 56 18 4d 6e 23 7d 47 0f 15 a9 82 b4 42 6b 3e>,
     absValidity: 2018-03-21T19:21:57.173Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.24:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 23 0.30434782608695654 1521573775950
connected to auth! from local port 41002
received auth hello!
{ authId: 502, nonce: <Buffer 41 f2 c4 5b 56 02 cf a9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9b ad 63 b6 2e 47 b0 99>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200627,
  cipherKeyVal: <Buffer da 15 4c 8c 2c 12 05 51 62 71 27 41 c0 bc 90 cc>,
  macKeyVal: <Buffer 0b 46 3c 1c bb eb de ac 2e ce ae 1e c8 ef 85 2d f3 46 7b 7c df c7 a9 e4 86 c7 99 ec 40 f3 67 3d>,
  absValidity: 2018-03-21T19:22:57.254Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50200627,
     cipherKeyVal: <Buffer da 15 4c 8c 2c 12 05 51 62 71 27 41 c0 bc 90 cc>,
     macKeyVal: <Buffer 0b 46 3c 1c bb eb de ac 2e ce ae 1e c8 ef 85 2d f3 46 7b 7c df c7 a9 e4 86 c7 99 ec 40 f3 67 3d>,
     absValidity: 2018-03-21T19:22:57.254Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.24:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 24 0.2916666666666667 1521573835962
connected to auth! from local port 41238
received auth hello!
{ authId: 502, nonce: <Buffer 0e 6d 87 b1 4f c0 c3 1a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9b 77 dd db 21 d4 58 00>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200642,
  cipherKeyVal: <Buffer 45 f0 65 66 d8 f1 55 cf c3 be 64 f0 f7 48 54 73>,
  macKeyVal: <Buffer 7e 19 6c 57 a4 f8 96 0d 04 e8 5c db db 8a 4b 30 fe ad 6d 99 0d 5e f5 a0 d5 b5 64 3f 09 f8 77 0f>,
  absValidity: 2018-03-21T19:23:59.331Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50200642,
     cipherKeyVal: <Buffer 45 f0 65 66 d8 f1 55 cf c3 be 64 f0 f7 48 54 73>,
     macKeyVal: <Buffer 7e 19 6c 57 a4 f8 96 0d 04 e8 5c db db 8a 4b 30 fe ad 6d 99 0d 5e f5 a0 d5 b5 64 3f 09 f8 77 0f>,
     absValidity: 2018-03-21T19:23:59.331Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.24:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 25 0.28 1521573896017
connected to auth! from local port 41472
received auth hello!
{ authId: 502, nonce: <Buffer f5 7e 6b a6 9b 33 d3 69> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a3 c4 e0 3f 38 af 25 62>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200657,
  cipherKeyVal: <Buffer f0 1d 24 b4 e9 1b 17 42 c8 f5 e6 b9 ce c7 ec 4f>,
  macKeyVal: <Buffer 68 9a 7f 3f cb 07 64 a4 16 5a 2a 49 49 72 58 33 ee 1c cc e1 d7 94 4d ba 34 0a 97 28 0e e8 2d 3a>,
  absValidity: 2018-03-21T19:24:59.349Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50200657,
     cipherKeyVal: <Buffer f0 1d 24 b4 e9 1b 17 42 c8 f5 e6 b9 ce c7 ec 4f>,
     macKeyVal: <Buffer 68 9a 7f 3f cb 07 64 a4 16 5a 2a 49 49 72 58 33 ee 1c cc e1 d7 94 4d ba 34 0a 97 28 0e e8 2d 3a>,
     absValidity: 2018-03-21T19:24:59.349Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.24:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 26 0.2692307692307692 1521573956059
connected to auth! from local port 41698
received auth hello!
{ authId: 502, nonce: <Buffer 1c 2a 2b 2b 36 e9 b5 be> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 25 a4 46 06 33 31 e4 35>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200672,
  cipherKeyVal: <Buffer 52 a3 9a 21 4a 49 0b c1 21 02 e9 52 ec 55 9d 98>,
  macKeyVal: <Buffer a6 f6 c8 76 76 04 f9 d5 7e 9b 9c c8 1a 25 85 4c 20 22 37 ea 04 f8 43 85 15 9c 73 fd ba a0 4d d8>,
  absValidity: 2018-03-21T19:25:57.365Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50200672,
     cipherKeyVal: <Buffer 52 a3 9a 21 4a 49 0b c1 21 02 e9 52 ec 55 9d 98>,
     macKeyVal: <Buffer a6 f6 c8 76 76 04 f9 d5 7e 9b 9c c8 1a 25 85 4c 20 22 37 ea 04 f8 43 85 15 9c 73 fd ba a0 4d d8>,
     absValidity: 2018-03-21T19:25:57.365Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.24:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 27 0.25925925925925924 1521574016113
connected to auth! from local port 41924
received auth hello!
{ authId: 502, nonce: <Buffer 7d e4 81 df b9 e0 ce 06> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 69 f9 58 69 57 1f e2 c7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200687,
  cipherKeyVal: <Buffer cb 7a 31 03 92 3e ae 7e fb 92 b5 fd 64 a2 f2 4e>,
  macKeyVal: <Buffer a4 a5 2e 37 20 5e 8d 42 21 5d 14 ea 4a fd e6 01 4f 25 b2 4e 2b ba 77 05 aa 3a 9a e2 ce 55 4a 88>,
  absValidity: 2018-03-21T19:26:57.410Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50200687,
     cipherKeyVal: <Buffer cb 7a 31 03 92 3e ae 7e fb 92 b5 fd 64 a2 f2 4e>,
     macKeyVal: <Buffer a4 a5 2e 37 20 5e 8d 42 21 5d 14 ea 4a fd e6 01 4f 25 b2 4e 2b ba 77 05 aa 3a 9a e2 ce 55 4a 88>,
     absValidity: 2018-03-21T19:26:57.410Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.24:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 28 0.25 1521574076170
connected to auth! from local port 42148
received auth hello!
{ authId: 502, nonce: <Buffer b9 e3 da 6b 47 50 93 80> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 02 5e 3e b5 a8 e6 22 62>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200702,
  cipherKeyVal: <Buffer 9f 76 0e 46 e5 99 3b 51 1c a3 9f 12 e4 e7 7e 66>,
  macKeyVal: <Buffer b2 5b 75 4a c8 29 c3 44 1a 28 d3 88 f2 1f d3 75 70 67 4e f0 32 6c c0 71 63 30 36 0b dd 3d 04 8d>,
  absValidity: 2018-03-21T19:27:57.463Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50200702,
     cipherKeyVal: <Buffer 9f 76 0e 46 e5 99 3b 51 1c a3 9f 12 e4 e7 7e 66>,
     macKeyVal: <Buffer b2 5b 75 4a c8 29 c3 44 1a 28 d3 88 f2 1f d3 75 70 67 4e f0 32 6c c0 71 63 30 36 0b dd 3d 04 8d>,
     absValidity: 2018-03-21T19:27:57.463Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.24:22100
disconnected from auth
