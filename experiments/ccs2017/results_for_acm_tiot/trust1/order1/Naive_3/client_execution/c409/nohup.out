changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c409.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c409',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 73 4d ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521572419775
connected to auth! from local port 59550
received auth hello!
{ authId: 402, nonce: <Buffer 29 90 4d 3a 2d be 39 c6> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer bd 38 cc c8 93 e7 5a 32>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 1b d8 bc 87 9d 4a 28 86 ae 48 b0 3f 47 1f c1 29>,
  macKeyVal: <Buffer fe 68 cb 1a 32 e9 30 a4 9d 6d c3 40 25 4f b4 90 a0 b5 d3 ba ba 7b 2b 51 04 52 1c a7 30 1d 39 7f>,
  absValidity: 2018-03-20T20:00:19.969Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200253,
  cipherKeyVal: <Buffer 81 8d 67 d0 51 46 08 ef 51 a1 f9 f9 62 ae 71 73>,
  macKeyVal: <Buffer 1e 8d 4e 02 42 04 d1 59 3e 93 67 21 6d e4 c8 fb 93 20 10 58 62 fb 24 8a 51 76 52 d7 05 87 38 d3>,
  absValidity: 2018-03-21T19:00:19.968Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40200253,
     cipherKeyVal: <Buffer 81 8d 67 d0 51 46 08 ef 51 a1 f9 f9 62 ae 71 73>,
     macKeyVal: <Buffer 1e 8d 4e 02 42 04 d1 59 3e 93 67 21 6d e4 c8 fb 93 20 10 58 62 fb 24 8a 51 76 52 d7 05 87 38 d3>,
     absValidity: 2018-03-21T19:00:19.968Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 11 86 62 16 fb 64 9a 71>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:00:20 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521572420906
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521572479835
connected to auth! from local port 59712
received auth hello!
{ authId: 402, nonce: <Buffer 51 ca b4 bc 6f b2 27 ec> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9c 71 d1 3f ba 01 af a2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200260,
  cipherKeyVal: <Buffer e0 4a fc 5d 49 5e ee ea 50 93 ce 7b 5f 32 4e b4>,
  macKeyVal: <Buffer 53 1c 67 a7 cc f0 b5 f2 1a cf 8d d8 a8 f1 6b 9f ab 86 b4 fe 7c 29 8f 0b 4e 85 04 be 1b b8 e3 2e>,
  absValidity: 2018-03-21T19:01:19.956Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40200260,
     cipherKeyVal: <Buffer e0 4a fc 5d 49 5e ee ea 50 93 ce 7b 5f 32 4e b4>,
     macKeyVal: <Buffer 53 1c 67 a7 cc f0 b5 f2 1a cf 8d d8 a8 f1 6b 9f ab 86 b4 fe 7c 29 8f 0b 4e 85 04 be 1b b8 e3 2e>,
     absValidity: 2018-03-21T19:01:19.956Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer b2 5a f2 38 8b db 52 e9>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:01:20 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521572480869
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521572539893
connected to auth! from local port 59978
received auth hello!
{ authId: 402, nonce: <Buffer ed 75 e0 88 be ac 26 15> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3c 83 78 5a 8f d2 17 c2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200267,
  cipherKeyVal: <Buffer 51 44 41 b1 9a 12 dd aa 44 a9 2f ff b7 bf 68 3c>,
  macKeyVal: <Buffer 1a 93 15 66 06 d9 e6 88 46 02 b2 15 0c 7e dc 18 9e 12 a0 79 f0 16 75 a2 95 52 1b 89 43 79 8f c1>,
  absValidity: 2018-03-21T19:02:20.055Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40200267,
     cipherKeyVal: <Buffer 51 44 41 b1 9a 12 dd aa 44 a9 2f ff b7 bf 68 3c>,
     macKeyVal: <Buffer 1a 93 15 66 06 d9 e6 88 46 02 b2 15 0c 7e dc 18 9e 12 a0 79 f0 16 75 a2 95 52 1b 89 43 79 8f c1>,
     absValidity: 2018-03-21T19:02:20.055Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 53 eb 63 28 91 72 69 bf>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:02:20 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521572541110
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521572599949
connected to auth! from local port 60248
received auth hello!
{ authId: 402, nonce: <Buffer 70 e4 73 b6 8b 69 87 3b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer dd 21 66 fb dd 62 ee 80>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200274,
  cipherKeyVal: <Buffer 5c 2a 85 46 8f c5 68 21 4a c2 bb b6 16 21 9e 12>,
  macKeyVal: <Buffer 3c 2e 5c 0e 8f 51 03 bd e9 44 1b 55 38 72 43 34 3c 01 f6 b6 95 5a f9 0e 3a 00 7c 8e 33 bf a3 1b>,
  absValidity: 2018-03-21T19:03:20.125Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40200274,
     cipherKeyVal: <Buffer 5c 2a 85 46 8f c5 68 21 4a c2 bb b6 16 21 9e 12>,
     macKeyVal: <Buffer 3c 2e 5c 0e 8f 51 03 bd e9 44 1b 55 38 72 43 34 3c 01 f6 b6 95 5a f9 0e 3a 00 7c 8e 33 bf a3 1b>,
     absValidity: 2018-03-21T19:03:20.125Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 5f 36 61 45 7a f6 fd 47>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:03:20 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521572601081
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521572660005
connected to auth! from local port 60518
received auth hello!
{ authId: 402, nonce: <Buffer e6 c9 48 94 6f 29 7e 42> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8d 6c 34 95 4f 6f 42 f4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200281,
  cipherKeyVal: <Buffer da 22 e9 67 9f b1 60 ec 98 b6 c0 e1 aa 76 a1 6b>,
  macKeyVal: <Buffer f3 22 a3 a0 10 b5 d6 48 2c 6e 0d 05 5f 92 d9 f9 4c ad 67 9e 09 78 41 d4 d4 21 5d 27 1a 0b a4 0b>,
  absValidity: 2018-03-21T19:04:20.155Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40200281,
     cipherKeyVal: <Buffer da 22 e9 67 9f b1 60 ec 98 b6 c0 e1 aa 76 a1 6b>,
     macKeyVal: <Buffer f3 22 a3 a0 10 b5 d6 48 2c 6e 0d 05 5f 92 d9 f9 4c ad 67 9e 09 78 41 d4 d4 21 5d 27 1a 0b a4 0b>,
     absValidity: 2018-03-21T19:04:20.155Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 93 46 a8 37 3e 9b 99 6a>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:04:20 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521572661098
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521572720019
connected to auth! from local port 60788
received auth hello!
{ authId: 402, nonce: <Buffer c6 e7 56 ce 50 23 43 48> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5d 1a 31 a5 99 6d d4 29>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200288,
  cipherKeyVal: <Buffer 18 d1 05 fe 9c 77 6e 89 78 23 87 89 5c 62 50 21>,
  macKeyVal: <Buffer 3c 6a 4c 41 36 45 ad ab 40 62 ad 10 32 a0 d5 19 02 93 42 e3 68 4c 27 c3 8a 3c 5a cf d5 94 fb f4>,
  absValidity: 2018-03-21T19:05:20.205Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40200288,
     cipherKeyVal: <Buffer 18 d1 05 fe 9c 77 6e 89 78 23 87 89 5c 62 50 21>,
     macKeyVal: <Buffer 3c 6a 4c 41 36 45 ad ab 40 62 ad 10 32 a0 d5 19 02 93 42 e3 68 4c 27 c3 8a 3c 5a cf d5 94 fb f4>,
     absValidity: 2018-03-21T19:05:20.205Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 30 df d0 99 ca ce 80 6a>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:05:20 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521572721219
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521572780062
connected to auth! from local port 32826
received auth hello!
{ authId: 402, nonce: <Buffer d6 78 1a a8 dd 91 80 ab> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f9 86 1d 49 82 f4 e7 ce>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200295,
  cipherKeyVal: <Buffer 06 72 d6 ce 64 ca ae 32 09 df b2 52 55 e3 48 2b>,
  macKeyVal: <Buffer 36 b7 0b 7e 50 db 3c 30 f4 71 ad 5d e9 ca 8b 68 04 b4 73 9a 99 76 a8 cd 72 e3 9f 55 96 11 b9 6f>,
  absValidity: 2018-03-21T19:06:20.275Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40200295,
     cipherKeyVal: <Buffer 06 72 d6 ce 64 ca ae 32 09 df b2 52 55 e3 48 2b>,
     macKeyVal: <Buffer 36 b7 0b 7e 50 db 3c 30 f4 71 ad 5d e9 ca 8b 68 04 b4 73 9a 99 76 a8 cd 72 e3 9f 55 96 11 b9 6f>,
     absValidity: 2018-03-21T19:06:20.275Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 80 de 24 23 fe a5 37 87>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:06:20 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521572781286
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521572840121
connected to auth! from local port 33096
received auth hello!
{ authId: 402, nonce: <Buffer a6 a2 a8 e1 7f e3 9e f4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 09 46 e0 06 52 dc db 92>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200302,
  cipherKeyVal: <Buffer 43 5e 45 c8 95 61 d6 55 07 6c 15 a4 60 c3 e9 e7>,
  macKeyVal: <Buffer 3b 63 c0 ad 65 ab 27 44 d1 49 eb 0e 39 04 1f 8b a8 1f dc ba ce da d8 91 fd 83 95 48 77 16 96 01>,
  absValidity: 2018-03-21T19:07:20.272Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40200302,
     cipherKeyVal: <Buffer 43 5e 45 c8 95 61 d6 55 07 6c 15 a4 60 c3 e9 e7>,
     macKeyVal: <Buffer 3b 63 c0 ad 65 ab 27 44 d1 49 eb 0e 39 04 1f 8b a8 1f dc ba ce da d8 91 fd 83 95 48 77 16 96 01>,
     absValidity: 2018-03-21T19:07:20.272Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 38 2b da 3f 1c 6c 34 55>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:07:20 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 8 1 1521572841153
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 9 0.8888888888888888 1521572900135
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 10 0.8 1521572960136
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 45696
received auth hello!
{ authId: 502, nonce: <Buffer c1 68 72 f6 0a e4 87 9e> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 11 0.7272727272727273 1521573020146
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 45924
received auth hello!
{ authId: 502, nonce: <Buffer fc 4b 04 e3 aa 56 11 35> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 12 0.6666666666666666 1521573080157
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 13 0.6153846153846154 1521573140161
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 53834
received auth hello!
{ authId: 401, nonce: <Buffer 92 3e cc 35 98 b6 fc f3> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth401',
     commonName: '10.0.1.1' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth402',
     commonName: '10.0.0.2' },
  serial: '016244C72DA0',
  notBefore: 2018-03-20T18:57:06.000Z,
  notAfter: 2018-03-21T18:58:46.000Z,
  subjectHash: 'de555cae',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '95:CD:E4:15:B9:6C:17:54:BE:65:78:27:97:BD:A5:22:95:F7:27:04',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'B95EF3029A4C4FAE066EFDE0A6119C37979EDB5A64C834CFDC68175183A2CCB6F817A6CEE1A9EF3E562CF75048E8894B6036030296F313DEBF7C1069E42825C46A5F1F6D69FFE10EE6D73B7805503AA7E6A4C2FF62C2E4D5BF7079FBED00C4B24480D5BC43B7B3B042025990D06DEE0A0388CF2AE7F4B313EF564F2EB3931C44FD1DBD6DFA6DA12843C6DBAAE1EFBC5E7EEDA9407AE6D78B6211169F194056CA6F9CD9F20F33FE469D35BCC944D43D2ECB947F73AF95BB5530BFF2A9B92CA16EB949D06EB8218BBBEC8EA009AC9F6C53C626A2796484448AEDAAB3D19834BA2A19D35D0E105AD47B9A6B3E1589517039E098E992676ED418010E608FA312B251',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.1' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 401,
  host: '10.0.1.1',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJExy2gMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDIxETAPBgNVBAMMCDEwLjAuMC4yMB4XDTE4MDMy\nMDE4NTcwNloXDTE4MDMyMTE4NTg0NlowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDQwMTERMA8GA1UEAwwIMTAuMC4xLjEwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQC5XvMCmkxPrgZu/eCmEZw3l57bWmTINM/caBdRg6LMtvgXps7h\nqe8+Viz3UEjoiUtgNgMClvMT3r98EGnkKCXEal8fbWn/4Q7m1zt4BVA6p+akwv9i\nwuTVv3B5++0AxLJEgNW8Q7ezsEICWZDQbe4KA4jPKuf0sxPvVk8us5McRP0dvW36\nbaEoQ8bbquHvvF5+7alAeubXi2IRFp8ZQFbKb5zZ8g8z/kadNbzJRNQ9LsuUf3Ov\nlbtVML/yqbksoW65SdBuuCGLu+yOoAmsn2xTxiaieWSERIrtqrPRmDS6KhnTXQ4Q\nWtR7mms+FYlRcDngmOmSZ27UGAEOYI+jErJRAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQEwDQYJKoZIhvcNAQELBQADggEBAL1++4YVQ8b1jHzb8TObsFDOpugdFIHP\n8D83P3/hBYNvo26azw58Lw9t8YqRHKITUxufoCgBUH3y21qm3F0YosKz6QvvZoe5\n3g7/62TAIQgnTxrDnCjXfbRhRSIfAPLBmDtGkUEd887I2dkPxIZfuF18NvR3gwTF\n03Bb3djQAvbBYA7zLYUCwJAvhsw3A9zhL2Kp/ELaorh9AG64nz4oN6nq9RwHd7Tp\nPcaaLV03zuCAonUvDRMcUlkr0k6Jfrxjc9FFhCBbzF+BnQaClUbLnYes7KnuceAD\nFuOsFNCOd0nJwkzHVkexCgTK9F/EsZh2Wtqq6/1/fTstrQXfVdbyDFg=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 2
to: 3
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 14 0.5714285714285714 1521573200172
connected to auth! from local port 54082
received auth hello!
{ authId: 401, nonce: <Buffer 88 16 b0 bc 3d e8 5f 89> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer e7 26 4e 1d fd 15 d7 fe>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer c7 ae 12 dd f6 02 85 64 d2 c5 79 af fc 7e cc 33>,
  macKeyVal: <Buffer 58 eb ad fb 58 b8 18 b4 64 cf b1 ef d6 90 c4 09 23 60 26 e0 b2 fb df 32 32 f8 c4 0d af c6 35 81>,
  absValidity: 2018-03-20T20:13:21.566Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100594,
  cipherKeyVal: <Buffer 7b 71 d4 e4 5f b7 7f 74 7c 3f 5b 85 f4 58 54 ce>,
  macKeyVal: <Buffer d6 40 5f ba 58 3d 72 a4 25 f0 3e 04 52 fc 90 91 84 db 06 af 11 7b 23 e6 b1 87 94 e6 c6 72 02 6e>,
  absValidity: 2018-03-21T19:13:21.566Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40100594,
     cipherKeyVal: <Buffer 7b 71 d4 e4 5f b7 7f 74 7c 3f 5b 85 f4 58 54 ce>,
     macKeyVal: <Buffer d6 40 5f ba 58 3d 72 a4 25 f0 3e 04 52 fc 90 91 84 db 06 af 11 7b 23 e6 b1 87 94 e6 c6 72 02 6e>,
     absValidity: 2018-03-21T19:13:21.566Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 6d 16 c4 1f af 02 98 03>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.14:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 15 0.5333333333333333 1521573260180
connected to auth! from local port 54348
received auth hello!
{ authId: 401, nonce: <Buffer 4c 58 64 12 ff b1 22 51> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e0 72 39 c5 b4 1d a0 08>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100606,
  cipherKeyVal: <Buffer b3 3d 26 10 4f be 87 17 fc b4 e0 32 19 17 b1 b6>,
  macKeyVal: <Buffer 14 ff 4e 51 bf d8 e1 5e f4 f0 11 62 ac 97 5c 83 b0 e2 dd 66 32 ba 7f e9 b7 e0 dd 86 4c 87 e7 10>,
  absValidity: 2018-03-21T19:14:21.604Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40100606,
     cipherKeyVal: <Buffer b3 3d 26 10 4f be 87 17 fc b4 e0 32 19 17 b1 b6>,
     macKeyVal: <Buffer 14 ff 4e 51 bf d8 e1 5e f4 f0 11 62 ac 97 5c 83 b0 e2 dd 66 32 ba 7f e9 b7 e0 dd 86 4c 87 e7 10>,
     absValidity: 2018-03-21T19:14:21.604Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer dd 1e a0 93 8f d6 ec f8>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.14:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 16 0.5 1521573320189
connected to auth! from local port 54620
received auth hello!
{ authId: 401, nonce: <Buffer e4 f8 fb cb 96 1e f7 b0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c9 94 4f 06 fe 12 65 17>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100618,
  cipherKeyVal: <Buffer b4 2e bd 78 18 ae 6c 0a 14 8c 76 a6 ca 33 6f 3c>,
  macKeyVal: <Buffer 26 4d e0 9e 08 61 97 70 fc bd 0b 4e 7c 14 a8 6d 71 2d ab 06 e9 58 85 60 72 e5 20 34 fa f7 fe 57>,
  absValidity: 2018-03-21T19:15:21.701Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40100618,
     cipherKeyVal: <Buffer b4 2e bd 78 18 ae 6c 0a 14 8c 76 a6 ca 33 6f 3c>,
     macKeyVal: <Buffer 26 4d e0 9e 08 61 97 70 fc bd 0b 4e 7c 14 a8 6d 71 2d ab 06 e9 58 85 60 72 e5 20 34 fa f7 fe 57>,
     absValidity: 2018-03-21T19:15:21.701Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 34 4b a8 16 ae 6b 89 97>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.14:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 17 0.47058823529411764 1521573380198
connected to auth! from local port 54896
received auth hello!
{ authId: 401, nonce: <Buffer 57 bc 1f cc e4 6b 58 9f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 99 78 9e 11 a8 bb 51 7b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100631,
  cipherKeyVal: <Buffer 69 59 e8 f2 ee e2 6b 37 66 07 4a fa 6f de 98 f1>,
  macKeyVal: <Buffer 04 bf 38 1c b6 85 c4 98 d6 4b b0 a4 c7 a1 44 1d d9 ea c2 16 8d ac b4 9c 4a a7 c4 a7 18 60 71 b2>,
  absValidity: 2018-03-21T19:16:20.365Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40100631,
     cipherKeyVal: <Buffer 69 59 e8 f2 ee e2 6b 37 66 07 4a fa 6f de 98 f1>,
     macKeyVal: <Buffer 04 bf 38 1c b6 85 c4 98 d6 4b b0 a4 c7 a1 44 1d d9 ea c2 16 8d ac b4 9c 4a a7 c4 a7 18 60 71 b2>,
     absValidity: 2018-03-21T19:16:20.365Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 33 8d 34 72 ba 86 83 90>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.14:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 18 0.4444444444444444 1521573440208
connected to auth! from local port 55138
received auth hello!
{ authId: 401, nonce: <Buffer 4f 9f d5 12 91 03 a8 99> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 92 b6 2d 7b 5c 92 81 32>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100645,
  cipherKeyVal: <Buffer e5 45 da f9 80 2f d1 17 85 3d 16 88 a4 86 c0 2c>,
  macKeyVal: <Buffer d6 6e 35 34 10 f1 0c 1a 74 0e 69 0b c0 12 6f 45 5e dc b8 cc e5 d1 8e 07 6e 62 89 95 0d 69 b0 d1>,
  absValidity: 2018-03-21T19:17:20.364Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40100645,
     cipherKeyVal: <Buffer e5 45 da f9 80 2f d1 17 85 3d 16 88 a4 86 c0 2c>,
     macKeyVal: <Buffer d6 6e 35 34 10 f1 0c 1a 74 0e 69 0b c0 12 6f 45 5e dc b8 cc e5 d1 8e 07 6e 62 89 95 0d 69 b0 d1>,
     absValidity: 2018-03-21T19:17:20.364Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 09 43 9e f0 0d 1d 0a 09>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.14:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 19 0.42105263157894735 1521573500220
connected to auth! from local port 55374
received auth hello!
{ authId: 401, nonce: <Buffer 94 03 08 be 76 f5 f9 63> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2e 32 5f a5 26 67 11 34>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100658,
  cipherKeyVal: <Buffer 8d b5 38 0e 0b a9 35 e6 86 34 df 4e 3a b1 bd 60>,
  macKeyVal: <Buffer 59 48 6f c7 7e d8 fc 82 41 82 92 52 c1 af bd 42 a2 51 20 1a 30 bf 24 6b 99 bb 21 81 7a 26 b5 f9>,
  absValidity: 2018-03-21T19:18:21.747Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40100658,
     cipherKeyVal: <Buffer 8d b5 38 0e 0b a9 35 e6 86 34 df 4e 3a b1 bd 60>,
     macKeyVal: <Buffer 59 48 6f c7 7e d8 fc 82 41 82 92 52 c1 af bd 42 a2 51 20 1a 30 bf 24 6b 99 bb 21 81 7a 26 b5 f9>,
     absValidity: 2018-03-21T19:18:21.747Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 66 90 3f 29 7f b7 d9 28>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.14:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 20 0.4 1521573560225
connected to auth! from local port 55604
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 21 0.38095238095238093 1521573620233
connected to auth! from local port 55828
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 22 0.36363636363636365 1521573680244
connected to auth! from local port 56052
received auth hello!
{ authId: 401, nonce: <Buffer 91 e2 4a 7b 5c 27 b8 5c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 99 a3 04 9c 88 0c 78 11>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100694,
  cipherKeyVal: <Buffer 2a 14 9d 8b 4a 83 51 bd 4b c3 45 41 01 f6 6f aa>,
  macKeyVal: <Buffer 02 84 21 ad 68 28 eb 83 39 9d 33 05 de 5b cc 5e 69 d8 46 30 04 b7 e0 5a 3b bc cf 14 3f 90 65 12>,
  absValidity: 2018-03-21T19:21:21.901Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40100694,
     cipherKeyVal: <Buffer 2a 14 9d 8b 4a 83 51 bd 4b c3 45 41 01 f6 6f aa>,
     macKeyVal: <Buffer 02 84 21 ad 68 28 eb 83 39 9d 33 05 de 5b cc 5e 69 d8 46 30 04 b7 e0 5a 3b bc cf 14 3f 90 65 12>,
     absValidity: 2018-03-21T19:21:21.901Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer db b5 d6 d7 25 49 87 72>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.14:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 23 0.34782608695652173 1521573740253
connected to auth! from local port 56268
received auth hello!
{ authId: 401, nonce: <Buffer 66 7b f7 15 b0 1e 82 d3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ce 14 a0 4c 95 a5 9d 4c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100707,
  cipherKeyVal: <Buffer 06 1f 50 1a 64 38 63 a1 24 d6 de 5f c3 28 c6 c6>,
  macKeyVal: <Buffer ce 67 5f dc 2f 99 4d 4b 7f 10 0b 42 85 6b ce 59 71 64 65 8b de fd 31 b6 a9 b6 1e 21 50 7f cf 53>,
  absValidity: 2018-03-21T19:22:23.950Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40100707,
     cipherKeyVal: <Buffer 06 1f 50 1a 64 38 63 a1 24 d6 de 5f c3 28 c6 c6>,
     macKeyVal: <Buffer ce 67 5f dc 2f 99 4d 4b 7f 10 0b 42 85 6b ce 59 71 64 65 8b de fd 31 b6 a9 b6 1e 21 50 7f cf 53>,
     absValidity: 2018-03-21T19:22:23.950Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 61 6e b3 60 28 b2 f2 fa>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.14:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 24 0.3333333333333333 1521573800259
connected to auth! from local port 56504
received auth hello!
{ authId: 401, nonce: <Buffer d8 e1 5c 31 19 b8 5b 24> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0c 70 ec a4 b5 72 f4 c6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100721,
  cipherKeyVal: <Buffer 63 6f 44 0e e7 6e 0a 27 65 e3 88 ef 0f b4 40 41>,
  macKeyVal: <Buffer de 12 e6 d4 81 d7 26 52 55 44 48 ca 87 aa 04 0e 2e 0a cf 4a b6 d0 c1 91 f0 93 33 a3 40 17 4a 4d>,
  absValidity: 2018-03-21T19:23:24.025Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40100721,
     cipherKeyVal: <Buffer 63 6f 44 0e e7 6e 0a 27 65 e3 88 ef 0f b4 40 41>,
     macKeyVal: <Buffer de 12 e6 d4 81 d7 26 52 55 44 48 ca 87 aa 04 0e 2e 0a cf 4a b6 d0 c1 91 f0 93 33 a3 40 17 4a 4d>,
     absValidity: 2018-03-21T19:23:24.025Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer a4 29 53 8f 45 74 c9 27>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.14:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 25 0.32 1521573860261
connected to auth! from local port 56740
received auth hello!
{ authId: 401, nonce: <Buffer c3 82 ba 8c c3 c3 a6 34> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 70 d1 a1 3b 6b 9c 38 25>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100735,
  cipherKeyVal: <Buffer 0a 62 30 3f 1e 7d a2 f6 4b 43 de 8c fb 0f f3 64>,
  macKeyVal: <Buffer 00 69 5d d4 14 ff ba 2b 7f 44 ec 79 e4 96 9c 72 cf 85 0a ec 9c 57 8e f5 fd 00 08 4c 38 ed ed 06>,
  absValidity: 2018-03-21T19:24:24.032Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40100735,
     cipherKeyVal: <Buffer 0a 62 30 3f 1e 7d a2 f6 4b 43 de 8c fb 0f f3 64>,
     macKeyVal: <Buffer 00 69 5d d4 14 ff ba 2b 7f 44 ec 79 e4 96 9c 72 cf 85 0a ec 9c 57 8e f5 fd 00 08 4c 38 ed ed 06>,
     absValidity: 2018-03-21T19:24:24.032Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 54 2b c4 29 40 23 b2 75>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.14:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 26 0.3076923076923077 1521573920268
connected to auth! from local port 56984
received auth hello!
{ authId: 401, nonce: <Buffer cb 8c 4e ab 46 18 d6 b4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 26 28 12 35 f5 1c b4 f0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100749,
  cipherKeyVal: <Buffer a5 c5 e7 b8 86 5f 52 4e 2a 34 88 47 95 0c 57 9f>,
  macKeyVal: <Buffer b8 4c c2 e3 45 dc c8 8d 36 60 c7 4f f9 b0 b0 92 ad 6e 2f 17 22 af 0a d8 d8 70 54 4f 24 7e 4f d9>,
  absValidity: 2018-03-21T19:25:23.817Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40100749,
     cipherKeyVal: <Buffer a5 c5 e7 b8 86 5f 52 4e 2a 34 88 47 95 0c 57 9f>,
     macKeyVal: <Buffer b8 4c c2 e3 45 dc c8 8d 36 60 c7 4f f9 b0 b0 92 ad 6e 2f 17 22 af 0a d8 d8 70 54 4f 24 7e 4f d9>,
     absValidity: 2018-03-21T19:25:23.817Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 55 c2 90 51 67 07 64 8f>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.14:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 27 0.2962962962962963 1521573980268
connected to auth! from local port 57210
received auth hello!
{ authId: 401, nonce: <Buffer 6c 78 f1 12 a3 0f 2e 3a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c7 e0 67 dd 76 53 13 ed>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100762,
  cipherKeyVal: <Buffer 72 7d d9 07 3b aa c5 eb a4 d5 0b 8a 06 24 e5 cc>,
  macKeyVal: <Buffer 42 b4 bc 12 5e 0e e9 48 bb 29 18 e5 5d 4d 85 8c 9a c8 63 b5 66 69 40 a1 d4 8e a1 54 2d cc 64 1e>,
  absValidity: 2018-03-21T19:26:23.919Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40100762,
     cipherKeyVal: <Buffer 72 7d d9 07 3b aa c5 eb a4 d5 0b 8a 06 24 e5 cc>,
     macKeyVal: <Buffer 42 b4 bc 12 5e 0e e9 48 bb 29 18 e5 5d 4d 85 8c 9a c8 63 b5 66 69 40 a1 d4 8e a1 54 2d cc 64 1e>,
     absValidity: 2018-03-21T19:26:23.919Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 8a 8f e8 89 75 b8 5c a2>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.14:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 28 0.2857142857142857 1521574040275
connected to auth! from local port 57440
received auth hello!
{ authId: 401, nonce: <Buffer 17 33 35 6c bb 87 0e 00> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1d e9 18 6f 84 bd 1f 21>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100775,
  cipherKeyVal: <Buffer 5b be 17 cd db ef fd c7 01 0d e5 46 d2 a5 e0 6a>,
  macKeyVal: <Buffer fd 64 43 74 ef b9 ce 70 07 50 4b 6f f3 29 59 7c 21 8c e5 27 0c 26 38 a5 5e 67 03 1f e3 fa 9b f8>,
  absValidity: 2018-03-21T19:27:22.235Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.14',
  serverPort: 22100,
  sessionKey: 
   { id: 40100775,
     cipherKeyVal: <Buffer 5b be 17 cd db ef fd c7 01 0d e5 46 d2 a5 e0 6a>,
     macKeyVal: <Buffer fd 64 43 74 ef b9 ce 70 07 50 4b 6f f3 29 59 7c 21 8c e5 27 0c 26 38 a5 5e 67 03 1f e3 fa 9b f8>,
     absValidity: 2018-03-21T19:27:22.235Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 21 7e c3 39 07 a2 62 32>
switching to HANDSHAKE_1_SENT
disconnected from auth
