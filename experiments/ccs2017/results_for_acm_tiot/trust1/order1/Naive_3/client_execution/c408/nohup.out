changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c408.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c408',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 51 49 42 41 41 4b 43 41 51 45 41 75 4c ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521572416554
connected to auth! from local port 60898
received auth hello!
{ authId: 402, nonce: <Buffer de 82 35 16 f1 0f 37 cc> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 2b 3f 60 9c cb 41 f4 d7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer a0 09 ea 9b 8f 62 71 f9 90 d1 7f b1 b2 9a 61 7b>,
  macKeyVal: <Buffer 34 11 5a f3 05 67 99 d1 ca be b7 af 25 70 20 56 9a e1 22 52 e2 fe d1 31 e5 9e a0 8f 54 9c 2c 21>,
  absValidity: 2018-03-20T20:00:16.732Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200252,
  cipherKeyVal: <Buffer 38 ca a8 4c ac 3e e6 14 29 f0 aa 82 19 75 c4 8b>,
  macKeyVal: <Buffer c2 d8 3c b2 40 48 ee 50 e8 6d 2a ef 80 fa f3 ba f6 ca 9e 66 f6 07 fc 98 26 2f b5 f3 79 de 35 1c>,
  absValidity: 2018-03-21T19:00:16.731Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40200252,
     cipherKeyVal: <Buffer 38 ca a8 4c ac 3e e6 14 29 f0 aa 82 19 75 c4 8b>,
     macKeyVal: <Buffer c2 d8 3c b2 40 48 ee 50 e8 6d 2a ef 80 fa f3 ba f6 ca 9e 66 f6 07 fc 98 26 2f b5 f3 79 de 35 1c>,
     absValidity: 2018-03-21T19:00:16.731Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 1a b4 04 a4 6a 03 c6 32>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:00:17 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521572417620
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521572476612
connected to auth! from local port 32822
received auth hello!
{ authId: 402, nonce: <Buffer 01 d4 a2 f9 cb 15 0d f3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 76 c3 8a 3e 6e c6 c5 3c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200259,
  cipherKeyVal: <Buffer 5f 71 5c bd 36 6a 2f 50 a4 18 5f d5 c3 b3 1b 4e>,
  macKeyVal: <Buffer 56 c3 4c b8 96 7f c4 1c 28 b3 6f 31 06 0d 5a 8b 10 99 29 0f 9b dc cb 8f a8 e3 72 9b ed 03 f4 f7>,
  absValidity: 2018-03-21T19:01:16.746Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40200259,
     cipherKeyVal: <Buffer 5f 71 5c bd 36 6a 2f 50 a4 18 5f d5 c3 b3 1b 4e>,
     macKeyVal: <Buffer 56 c3 4c b8 96 7f c4 1c 28 b3 6f 31 06 0d 5a 8b 10 99 29 0f 9b dc cb 8f a8 e3 72 9b ed 03 f4 f7>,
     absValidity: 2018-03-21T19:01:16.746Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer b9 ee fc cd 31 66 45 17>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:01:17 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521572477669
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521572536617
connected to auth! from local port 33082
received auth hello!
{ authId: 402, nonce: <Buffer 1c 7b 1b b8 c9 80 ef 9c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fe a4 2c 81 56 54 d0 02>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200266,
  cipherKeyVal: <Buffer b5 f3 67 25 75 81 08 8c 3f ec 19 2c d4 5b 5b 5d>,
  macKeyVal: <Buffer 43 55 80 0d ab 5f d6 75 8a b0 1b ea 81 2e 5b 77 a0 7b 61 a3 06 b9 db e0 0b 5d b2 0e ec 08 06 70>,
  absValidity: 2018-03-21T19:02:16.771Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40200266,
     cipherKeyVal: <Buffer b5 f3 67 25 75 81 08 8c 3f ec 19 2c d4 5b 5b 5d>,
     macKeyVal: <Buffer 43 55 80 0d ab 5f d6 75 8a b0 1b ea 81 2e 5b 77 a0 7b 61 a3 06 b9 db e0 0b 5d b2 0e ec 08 06 70>,
     absValidity: 2018-03-21T19:02:16.771Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 41 e9 ad bd 62 47 34 8f>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:02:17 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521572537657
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521572596676
connected to auth! from local port 33352
received auth hello!
{ authId: 402, nonce: <Buffer f1 55 d3 a8 cc df 32 f9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5f d5 30 81 a4 e3 89 33>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200273,
  cipherKeyVal: <Buffer a6 36 7c bd df d2 6f dd 38 85 ca 98 d8 36 fe b5>,
  macKeyVal: <Buffer e1 11 ea ea 13 df 1b b8 6d 41 5f 4a fa 3a fa 51 de 16 d1 e4 e3 47 a0 93 b0 30 d1 56 51 88 99 70>,
  absValidity: 2018-03-21T19:03:16.807Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40200273,
     cipherKeyVal: <Buffer a6 36 7c bd df d2 6f dd 38 85 ca 98 d8 36 fe b5>,
     macKeyVal: <Buffer e1 11 ea ea 13 df 1b b8 6d 41 5f 4a fa 3a fa 51 de 16 d1 e4 e3 47 a0 93 b0 30 d1 56 51 88 99 70>,
     absValidity: 2018-03-21T19:03:16.807Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 4e 25 1f 86 89 09 b6 e4>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:03:17 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521572597748
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521572656733
connected to auth! from local port 33622
received auth hello!
{ authId: 402, nonce: <Buffer 01 81 68 a2 d6 ca 75 3e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 06 14 a3 52 48 57 81 0d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200280,
  cipherKeyVal: <Buffer fa 06 66 9f 64 20 51 ed b5 07 91 be a9 26 5e 1e>,
  macKeyVal: <Buffer a4 f8 ad aa 6f 44 60 fc 15 7e 9e 9b 3e 64 ae ba a3 a1 86 76 5d 9b 56 df f8 93 6c 64 2f a7 3a 2d>,
  absValidity: 2018-03-21T19:04:16.869Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40200280,
     cipherKeyVal: <Buffer fa 06 66 9f 64 20 51 ed b5 07 91 be a9 26 5e 1e>,
     macKeyVal: <Buffer a4 f8 ad aa 6f 44 60 fc 15 7e 9e 9b 3e 64 ae ba a3 a1 86 76 5d 9b 56 df f8 93 6c 64 2f a7 3a 2d>,
     absValidity: 2018-03-21T19:04:16.869Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 91 b9 25 b1 1c f8 f3 2e>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:04:17 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521572657820
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521572716789
connected to auth! from local port 33892
received auth hello!
{ authId: 402, nonce: <Buffer 9b 29 4b f3 c7 4f 9a 92> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d0 e4 06 3d 05 53 08 5c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200287,
  cipherKeyVal: <Buffer da f4 52 3f 81 a5 11 e2 bd b7 c8 9b 95 a4 be 51>,
  macKeyVal: <Buffer d7 2b 44 d5 73 37 ce 63 65 91 42 5d 0b 3d e8 35 72 23 d5 d7 fe 9b 9a 54 a0 c5 35 53 ac ff fd 25>,
  absValidity: 2018-03-21T19:05:16.931Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40200287,
     cipherKeyVal: <Buffer da f4 52 3f 81 a5 11 e2 bd b7 c8 9b 95 a4 be 51>,
     macKeyVal: <Buffer d7 2b 44 d5 73 37 ce 63 65 91 42 5d 0b 3d e8 35 72 23 d5 d7 fe 9b 9a 54 a0 c5 35 53 ac ff fd 25>,
     absValidity: 2018-03-21T19:05:16.931Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 1c f9 7f 7b 79 cd 5b e7>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:05:17 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521572717782
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521572776846
connected to auth! from local port 34162
received auth hello!
{ authId: 402, nonce: <Buffer 7c ef 71 ce 63 b1 d8 77> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f9 0f b4 cf a2 39 26 08>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200294,
  cipherKeyVal: <Buffer d8 b6 97 37 3d fc cb 57 60 eb 21 fd 1a 04 61 88>,
  macKeyVal: <Buffer a7 be 75 07 b7 ae 77 96 a9 11 58 d9 fa 5f 96 27 9b d4 d4 14 51 5f 02 8d 1b 65 f7 c4 70 0a f0 f3>,
  absValidity: 2018-03-21T19:06:16.979Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40200294,
     cipherKeyVal: <Buffer d8 b6 97 37 3d fc cb 57 60 eb 21 fd 1a 04 61 88>,
     macKeyVal: <Buffer a7 be 75 07 b7 ae 77 96 a9 11 58 d9 fa 5f 96 27 9b d4 d4 14 51 5f 02 8d 1b 65 f7 c4 70 0a f0 f3>,
     absValidity: 2018-03-21T19:06:16.979Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 0d 94 74 bc 67 2f 4b a8>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:06:17 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521572777981
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521572836860
connected to auth! from local port 34432
received auth hello!
{ authId: 402, nonce: <Buffer 28 a9 9f d6 43 e2 86 59> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 51 fa 9d f2 71 b3 13 f4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200301,
  cipherKeyVal: <Buffer 3a 1f 2b d0 ad 15 93 2a ba 44 a8 74 45 87 c6 65>,
  macKeyVal: <Buffer a4 4e dc ee 6b 60 15 44 cf 35 a0 09 55 39 7f fe eb da 5f 0b b2 b9 8c 65 8b 51 6b 0c 58 dc 85 2f>,
  absValidity: 2018-03-21T19:07:16.969Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40200301,
     cipherKeyVal: <Buffer 3a 1f 2b d0 ad 15 93 2a ba 44 a8 74 45 87 c6 65>,
     macKeyVal: <Buffer a4 4e dc ee 6b 60 15 44 cf 35 a0 09 55 39 7f fe eb da 5f 0b b2 b9 8c 65 8b 51 6b 0c 58 dc 85 2f>,
     absValidity: 2018-03-21T19:07:16.969Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 26 19 d4 79 56 61 6c 66>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:07:17 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 8 1 1521572837876
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 9 0.8888888888888888 1521572896861
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 10 0.8 1521572956872
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 53826
received auth hello!
{ authId: 502, nonce: <Buffer c1 77 e5 f0 48 49 da 86> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 11 0.7272727272727273 1521573016882
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 54058
received auth hello!
{ authId: 502, nonce: <Buffer 18 c7 89 c4 ae 09 72 ce> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 12 0.6666666666666666 1521573076892
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 13 0.6153846153846154 1521573136900
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 48462
received auth hello!
{ authId: 401, nonce: <Buffer 43 78 1f 93 eb c4 3c 46> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth401',
     commonName: '10.0.1.1' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth402',
     commonName: '10.0.0.2' },
  serial: '016244C72DA0',
  notBefore: 2018-03-20T18:57:06.000Z,
  notAfter: 2018-03-21T18:58:46.000Z,
  subjectHash: 'de555cae',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '95:CD:E4:15:B9:6C:17:54:BE:65:78:27:97:BD:A5:22:95:F7:27:04',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'B95EF3029A4C4FAE066EFDE0A6119C37979EDB5A64C834CFDC68175183A2CCB6F817A6CEE1A9EF3E562CF75048E8894B6036030296F313DEBF7C1069E42825C46A5F1F6D69FFE10EE6D73B7805503AA7E6A4C2FF62C2E4D5BF7079FBED00C4B24480D5BC43B7B3B042025990D06DEE0A0388CF2AE7F4B313EF564F2EB3931C44FD1DBD6DFA6DA12843C6DBAAE1EFBC5E7EEDA9407AE6D78B6211169F194056CA6F9CD9F20F33FE469D35BCC944D43D2ECB947F73AF95BB5530BFF2A9B92CA16EB949D06EB8218BBBEC8EA009AC9F6C53C626A2796484448AEDAAB3D19834BA2A19D35D0E105AD47B9A6B3E1589517039E098E992676ED418010E608FA312B251',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.1' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 401,
  host: '10.0.1.1',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJExy2gMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDIxETAPBgNVBAMMCDEwLjAuMC4yMB4XDTE4MDMy\nMDE4NTcwNloXDTE4MDMyMTE4NTg0NlowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDQwMTERMA8GA1UEAwwIMTAuMC4xLjEwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQC5XvMCmkxPrgZu/eCmEZw3l57bWmTINM/caBdRg6LMtvgXps7h\nqe8+Viz3UEjoiUtgNgMClvMT3r98EGnkKCXEal8fbWn/4Q7m1zt4BVA6p+akwv9i\nwuTVv3B5++0AxLJEgNW8Q7ezsEICWZDQbe4KA4jPKuf0sxPvVk8us5McRP0dvW36\nbaEoQ8bbquHvvF5+7alAeubXi2IRFp8ZQFbKb5zZ8g8z/kadNbzJRNQ9LsuUf3Ov\nlbtVML/yqbksoW65SdBuuCGLu+yOoAmsn2xTxiaieWSERIrtqrPRmDS6KhnTXQ4Q\nWtR7mms+FYlRcDngmOmSZ27UGAEOYI+jErJRAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQEwDQYJKoZIhvcNAQELBQADggEBAL1++4YVQ8b1jHzb8TObsFDOpugdFIHP\n8D83P3/hBYNvo26azw58Lw9t8YqRHKITUxufoCgBUH3y21qm3F0YosKz6QvvZoe5\n3g7/62TAIQgnTxrDnCjXfbRhRSIfAPLBmDtGkUEd887I2dkPxIZfuF18NvR3gwTF\n03Bb3djQAvbBYA7zLYUCwJAvhsw3A9zhL2Kp/ELaorh9AG64nz4oN6nq9RwHd7Tp\nPcaaLV03zuCAonUvDRMcUlkr0k6Jfrxjc9FFhCBbzF+BnQaClUbLnYes7KnuceAD\nFuOsFNCOd0nJwkzHVkexCgTK9F/EsZh2Wtqq6/1/fTstrQXfVdbyDFg=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 2
to: 3
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 14 0.5714285714285714 1521573196910
connected to auth! from local port 48700
received auth hello!
{ authId: 401, nonce: <Buffer 28 66 b9 39 c7 f0 7b 20> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 27 ac a5 0c bc b5 78 0b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer e8 c0 eb 0a 72 a6 4c 5a 8b 91 98 99 c2 41 8f 0f>,
  macKeyVal: <Buffer aa 94 77 05 f1 2b 16 3c c3 63 b4 22 fe 03 4c 5c 1e 9e 8f ff 34 58 85 d7 b0 dd fa f6 2a a4 62 a8>,
  absValidity: 2018-03-20T20:13:19.566Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100593,
  cipherKeyVal: <Buffer b2 3e b8 8c 71 fa 90 46 f4 15 29 7a 93 89 02 36>,
  macKeyVal: <Buffer f2 a3 e2 b9 ca 36 83 82 df 97 37 8d b1 6a 50 1c ce 97 1e af a7 36 89 6e 41 60 60 95 21 74 33 74>,
  absValidity: 2018-03-21T19:13:19.566Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40100593,
     cipherKeyVal: <Buffer b2 3e b8 8c 71 fa 90 46 f4 15 29 7a 93 89 02 36>,
     macKeyVal: <Buffer f2 a3 e2 b9 ca 36 83 82 df 97 37 8d b1 6a 50 1c ce 97 1e af a7 36 89 6e 41 60 60 95 21 74 33 74>,
     absValidity: 2018-03-21T19:13:19.566Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 76 b3 c3 74 b3 ed 3a c8>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.13:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 15 0.5333333333333333 1521573256913
connected to auth! from local port 48968
received auth hello!
{ authId: 401, nonce: <Buffer 44 c4 7f 59 b8 a2 e6 a3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer aa ef 5e a6 e7 74 7e bc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100605,
  cipherKeyVal: <Buffer 0f 88 0e fe 01 89 94 16 e8 e1 7b 2c d6 ed 7c 44>,
  macKeyVal: <Buffer 66 cd 26 de 09 45 d8 c5 da 8d e4 b6 2c 4d 1d bb c5 0f 08 bd 66 6b 2d 65 52 ae cf ef 03 87 bd 6e>,
  absValidity: 2018-03-21T19:14:19.603Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40100605,
     cipherKeyVal: <Buffer 0f 88 0e fe 01 89 94 16 e8 e1 7b 2c d6 ed 7c 44>,
     macKeyVal: <Buffer 66 cd 26 de 09 45 d8 c5 da 8d e4 b6 2c 4d 1d bb c5 0f 08 bd 66 6b 2d 65 52 ae cf ef 03 87 bd 6e>,
     absValidity: 2018-03-21T19:14:19.603Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 10 6b aa 30 51 a8 92 c6>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.13:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 16 0.5 1521573316921
connected to auth! from local port 49242
received auth hello!
{ authId: 401, nonce: <Buffer 2c 82 8c 8f 06 56 fd f1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 32 ca 47 b1 8a ec 00 f3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100617,
  cipherKeyVal: <Buffer f7 f5 34 fe 66 ea ad d9 8a 97 cc cd de e1 d8 df>,
  macKeyVal: <Buffer 81 3a 06 ab 78 67 56 bf 29 e1 09 e1 9f f9 74 6f 86 00 a8 be af af dd a4 8a 8c ed 0c 37 4d 97 ee>,
  absValidity: 2018-03-21T19:15:19.693Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40100617,
     cipherKeyVal: <Buffer f7 f5 34 fe 66 ea ad d9 8a 97 cc cd de e1 d8 df>,
     macKeyVal: <Buffer 81 3a 06 ab 78 67 56 bf 29 e1 09 e1 9f f9 74 6f 86 00 a8 be af af dd a4 8a 8c ed 0c 37 4d 97 ee>,
     absValidity: 2018-03-21T19:15:19.693Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 50 46 dc e2 3c bf ae 17>
switching to HANDSHAKE_1_SENT
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.13:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 17 0.47058823529411764 1521573376928
connected to auth! from local port 49516
received auth hello!
{ authId: 401, nonce: <Buffer f6 13 97 67 36 31 c1 f6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e6 a8 0c 96 b5 9c 08 eb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100630,
  cipherKeyVal: <Buffer 66 d3 71 68 d7 a0 cb 85 18 91 04 b2 b7 50 aa c3>,
  macKeyVal: <Buffer f2 46 d4 31 57 69 7d 51 43 84 f2 ca bc 69 e1 14 c3 5f 77 c0 60 43 bc ed 60 04 9a ac 9a 26 29 5c>,
  absValidity: 2018-03-21T19:16:17.724Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40100630,
     cipherKeyVal: <Buffer 66 d3 71 68 d7 a0 cb 85 18 91 04 b2 b7 50 aa c3>,
     macKeyVal: <Buffer f2 46 d4 31 57 69 7d 51 43 84 f2 ca bc 69 e1 14 c3 5f 77 c0 60 43 bc ed 60 04 9a ac 9a 26 29 5c>,
     absValidity: 2018-03-21T19:16:17.724Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 00 50 c0 d5 d5 b7 6d dc>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.13:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 18 0.4444444444444444 1521573436938
connected to auth! from local port 49768
received auth hello!
{ authId: 401, nonce: <Buffer 2d 36 1c 1c 54 5d 74 b0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 27 01 77 78 bd cc 2a 9c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100644,
  cipherKeyVal: <Buffer 58 35 d1 87 61 2e 98 e7 bb e5 5c fd b9 5a 47 5b>,
  macKeyVal: <Buffer f2 0d 7b 8f 1d 1b 3a 87 6d 1c 2c f0 5d d8 88 76 41 ed 76 ad d0 33 29 a4 eb 4a 0a a6 28 6e 67 7d>,
  absValidity: 2018-03-21T19:17:17.758Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40100644,
     cipherKeyVal: <Buffer 58 35 d1 87 61 2e 98 e7 bb e5 5c fd b9 5a 47 5b>,
     macKeyVal: <Buffer f2 0d 7b 8f 1d 1b 3a 87 6d 1c 2c f0 5d d8 88 76 41 ed 76 ad d0 33 29 a4 eb 4a 0a a6 28 6e 67 7d>,
     absValidity: 2018-03-21T19:17:17.758Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer b2 58 7c a8 99 40 fe a0>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.13:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 19 0.42105263157894735 1521573496947
connected to auth! from local port 50004
received auth hello!
{ authId: 401, nonce: <Buffer 65 91 f0 1b 37 e5 37 1c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 06 e2 15 fc 91 94 1a b4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100657,
  cipherKeyVal: <Buffer d9 d4 36 eb e2 47 21 0f 25 86 fe 87 fd d2 0d 97>,
  macKeyVal: <Buffer ce ed 6e 47 e8 91 bc 7d 22 8d 4e 55 a4 fc b2 d7 16 f5 7d cf 43 9f 97 06 3b a1 14 b5 a6 6b be 0b>,
  absValidity: 2018-03-21T19:18:19.782Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40100657,
     cipherKeyVal: <Buffer d9 d4 36 eb e2 47 21 0f 25 86 fe 87 fd d2 0d 97>,
     macKeyVal: <Buffer ce ed 6e 47 e8 91 bc 7d 22 8d 4e 55 a4 fc b2 d7 16 f5 7d cf 43 9f 97 06 3b a1 14 b5 a6 6b be 0b>,
     absValidity: 2018-03-21T19:18:19.782Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 42 df d8 46 a6 1c d7 3f>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.13:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 20 0.4 1521573556953
connected to auth! from local port 50234
received auth hello!
{ authId: 401, nonce: <Buffer c9 4f 92 8b fd 13 85 26> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f8 ed cd 5d f1 7e 99 26>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100669,
  cipherKeyVal: <Buffer 11 2b 6a 22 ae 49 c8 8f b1 d3 1d 14 1c 25 d9 78>,
  macKeyVal: <Buffer 8e 1c d3 60 03 30 f7 ea a2 04 d9 90 87 44 4d 45 65 97 f7 f4 c8 2f 35 37 ff 5c 0e 7f ac 00 6d e3>,
  absValidity: 2018-03-21T19:19:19.751Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40100669,
     cipherKeyVal: <Buffer 11 2b 6a 22 ae 49 c8 8f b1 d3 1d 14 1c 25 d9 78>,
     macKeyVal: <Buffer 8e 1c d3 60 03 30 f7 ea a2 04 d9 90 87 44 4d 45 65 97 f7 f4 c8 2f 35 37 ff 5c 0e 7f ac 00 6d e3>,
     absValidity: 2018-03-21T19:19:19.751Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer a8 87 e4 5d a3 fc 0e 1b>
switching to HANDSHAKE_1_SENT
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:19:21 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 9 20 0.45 1521573562243
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 21 0.42857142857142855 1521573617009
connected to auth! from local port 50458
received auth hello!
{ authId: 401, nonce: <Buffer 2f 09 25 0d a3 7c 81 b3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f7 86 bc b2 0c 90 b6 fa>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100681,
  cipherKeyVal: <Buffer 42 b6 0e f6 40 23 60 e8 07 e3 86 05 27 dd 07 08>,
  macKeyVal: <Buffer 09 1d cc b2 d2 47 87 e2 9f 73 29 2e 30 d9 00 c0 17 7c 39 d2 56 7d b1 e1 af d9 45 ae db 88 d4 13>,
  absValidity: 2018-03-21T19:20:19.873Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40100681,
     cipherKeyVal: <Buffer 42 b6 0e f6 40 23 60 e8 07 e3 86 05 27 dd 07 08>,
     macKeyVal: <Buffer 09 1d cc b2 d2 47 87 e2 9f 73 29 2e 30 d9 00 c0 17 7c 39 d2 56 7d b1 e1 af d9 45 ae db 88 d4 13>,
     absValidity: 2018-03-21T19:20:19.873Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 2d fb d2 81 d9 1f 08 8c>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:20:21 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 10 21 0.47619047619047616 1521573622373
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 10 22 0.45454545454545453 1521573677061
connected to auth! from local port 50682
received auth hello!
{ authId: 401, nonce: <Buffer 31 0d 36 8f 25 8c 05 41> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ae 7a e5 05 49 a6 8a 2b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100693,
  cipherKeyVal: <Buffer c0 e0 84 82 02 c3 5a a0 13 19 47 b8 b0 57 c6 3e>,
  macKeyVal: <Buffer 0f 95 1c 14 4c 25 2e 8f 5e 8b 23 9b 0c 97 f3 38 31 b0 0a 8b 20 58 21 98 97 a2 85 90 31 3f a6 01>,
  absValidity: 2018-03-21T19:21:19.906Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40100693,
     cipherKeyVal: <Buffer c0 e0 84 82 02 c3 5a a0 13 19 47 b8 b0 57 c6 3e>,
     macKeyVal: <Buffer 0f 95 1c 14 4c 25 2e 8f 5e 8b 23 9b 0c 97 f3 38 31 b0 0a 8b 20 58 21 98 97 a2 85 90 31 3f a6 01>,
     absValidity: 2018-03-21T19:21:19.906Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 0b 34 72 d7 b6 1e 80 77>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.13:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 10 23 0.43478260869565216 1521573737067
connected to auth! from local port 50904
received auth hello!
{ authId: 401, nonce: <Buffer cf fb 6a 0f e3 dd 26 b7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 49 e2 44 c1 80 3b 95 d1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100704,
  cipherKeyVal: <Buffer ca 02 33 11 4c 08 cd 5e ac c5 85 83 95 d8 02 cc>,
  macKeyVal: <Buffer b5 08 b4 28 1c a0 5d d6 25 4a 25 34 11 53 d6 a6 5c 11 ae 91 a7 26 3c 2d f6 1e 98 59 91 11 8b 63>,
  absValidity: 2018-03-21T19:22:20.702Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40100704,
     cipherKeyVal: <Buffer ca 02 33 11 4c 08 cd 5e ac c5 85 83 95 d8 02 cc>,
     macKeyVal: <Buffer b5 08 b4 28 1c a0 5d d6 25 4a 25 34 11 53 d6 a6 5c 11 ae 91 a7 26 3c 2d f6 1e 98 59 91 11 8b 63>,
     absValidity: 2018-03-21T19:22:20.702Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 12 4f 19 8f 39 4a ab 14>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.13:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 10 24 0.4166666666666667 1521573797074
connected to auth! from local port 51140
received auth hello!
{ authId: 401, nonce: <Buffer 86 96 9b 70 6a a3 df ee> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c6 95 61 4e 93 68 07 2b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100718,
  cipherKeyVal: <Buffer 83 fa e0 f8 46 8b 0c 4b db 3a 88 90 e7 e0 b3 eb>,
  macKeyVal: <Buffer 21 39 a5 50 a9 ee 13 73 ab 30 03 f5 50 ee dc 50 5e a0 61 3a 6a d8 71 f4 2d 43 3f e7 f2 65 11 02>,
  absValidity: 2018-03-21T19:23:20.771Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40100718,
     cipherKeyVal: <Buffer 83 fa e0 f8 46 8b 0c 4b db 3a 88 90 e7 e0 b3 eb>,
     macKeyVal: <Buffer 21 39 a5 50 a9 ee 13 73 ab 30 03 f5 50 ee dc 50 5e a0 61 3a 6a d8 71 f4 2d 43 3f e7 f2 65 11 02>,
     absValidity: 2018-03-21T19:23:20.771Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer dd 32 98 49 cd e6 03 b9>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.13:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 10 25 0.4 1521573857080
connected to auth! from local port 51376
received auth hello!
{ authId: 401, nonce: <Buffer bf 53 de af 3b ca 26 be> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7d db 1b 06 ea ca a8 a5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100732,
  cipherKeyVal: <Buffer 87 f4 a6 84 8b ba cb 22 9a 20 8a 1c 1d fc 82 f7>,
  macKeyVal: <Buffer 35 2d 83 11 e3 d5 ca 8d 0b 4b e2 96 79 7c 74 98 e3 ed 15 07 cf f1 61 ca c4 68 fe 2d b6 81 58 b6>,
  absValidity: 2018-03-21T19:24:20.797Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40100732,
     cipherKeyVal: <Buffer 87 f4 a6 84 8b ba cb 22 9a 20 8a 1c 1d fc 82 f7>,
     macKeyVal: <Buffer 35 2d 83 11 e3 d5 ca 8d 0b 4b e2 96 79 7c 74 98 e3 ed 15 07 cf f1 61 ca c4 68 fe 2d b6 81 58 b6>,
     absValidity: 2018-03-21T19:24:20.797Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 67 f2 7f c4 a7 0b 2d 07>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.13:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 10 26 0.38461538461538464 1521573917085
connected to auth! from local port 51618
received auth hello!
{ authId: 401, nonce: <Buffer ae 83 c4 e9 2a 78 93 8b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d3 9e 1a ab f5 4a 81 9c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100748,
  cipherKeyVal: <Buffer 78 a2 ef c9 01 1a 4a a3 80 9a 81 68 bd 51 d7 a3>,
  macKeyVal: <Buffer 36 e9 ec 31 fc a7 80 3f 00 49 20 d4 2f c4 e6 70 a1 ac ef 11 46 7a 8c 21 6b ad 15 e4 3a cb ba ce>,
  absValidity: 2018-03-21T19:25:20.096Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40100748,
     cipherKeyVal: <Buffer 78 a2 ef c9 01 1a 4a a3 80 9a 81 68 bd 51 d7 a3>,
     macKeyVal: <Buffer 36 e9 ec 31 fc a7 80 3f 00 49 20 d4 2f c4 e6 70 a1 ac ef 11 46 7a 8c 21 6b ad 15 e4 3a cb ba ce>,
     absValidity: 2018-03-21T19:25:20.096Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 89 32 d0 d6 b8 86 50 e0>
switching to HANDSHAKE_1_SENT
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:25:24 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 11 26 0.4230769230769231 1521573925163
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 11 27 0.4074074074074074 1521573977138
connected to auth! from local port 51844
received auth hello!
{ authId: 401, nonce: <Buffer 5c 64 18 d4 bd 9f df c0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5c bf be 85 a4 00 8c 7f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100761,
  cipherKeyVal: <Buffer 8e ee cd ca a2 ad b3 50 10 c8 9d af 0d 5a c3 88>,
  macKeyVal: <Buffer 7c 78 7d b6 6e 2b ba 95 e7 84 bc 37 5a e8 9b 1c dd bc 68 c8 3a f1 ca 73 70 ef 94 d0 9f 55 2e c3>,
  absValidity: 2018-03-21T19:26:20.156Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40100761,
     cipherKeyVal: <Buffer 8e ee cd ca a2 ad b3 50 10 c8 9d af 0d 5a c3 88>,
     macKeyVal: <Buffer 7c 78 7d b6 6e 2b ba 95 e7 84 bc 37 5a e8 9b 1c dd bc 68 c8 3a f1 ca 73 70 ef 94 d0 9f 55 2e c3>,
     absValidity: 2018-03-21T19:26:20.156Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 40 56 12 e6 52 e1 3b 71>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:26:25 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 12 27 0.4444444444444444 1521573985245
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 12 28 0.42857142857142855 1521574037191
connected to auth! from local port 52070
received auth hello!
{ authId: 401, nonce: <Buffer 63 ff 3d 3a ca fc be fa> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7b f1 fc a1 8c 7d 93 7d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100774,
  cipherKeyVal: <Buffer b7 f5 d3 e3 d2 53 b7 3a 89 dd 06 66 b8 84 b4 13>,
  macKeyVal: <Buffer 3d c4 e4 82 2b 3d 1a 9b 3f 77 7c 19 67 e0 a4 10 23 fc af 2b 28 9a cb 40 22 ad 00 1c 48 b7 17 60>,
  absValidity: 2018-03-21T19:27:18.235Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40100774,
     cipherKeyVal: <Buffer b7 f5 d3 e3 d2 53 b7 3a 89 dd 06 66 b8 84 b4 13>,
     macKeyVal: <Buffer 3d c4 e4 82 2b 3d 1a 9b 3f 77 7c 19 67 e0 a4 10 23 fc af 2b 28 9a cb 40 22 ad 00 1c 48 b7 17 60>,
     absValidity: 2018-03-21T19:27:18.235Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer ea 58 d5 3e fe dc 49 c1>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:27:20 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 13 28 0.4642857142857143 1521574040535
