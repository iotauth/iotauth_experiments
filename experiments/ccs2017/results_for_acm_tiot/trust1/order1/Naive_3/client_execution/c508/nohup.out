changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c508.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c508',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 76 6a ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521572478220
connected to auth! from local port 55484
received auth hello!
{ authId: 501, nonce: <Buffer 70 9f 56 17 bf 3e 00 b8> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 49 c8 70 55 e0 d3 58 81>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer e6 ef 23 fe 4b b6 b8 6c 4c 92 91 23 74 20 82 d1>,
  macKeyVal: <Buffer 70 0f 51 2c 8e d5 5a fb 2f bd 96 d5 9d 70 5c b6 d0 d8 0b 8a 75 b3 d4 47 2d 0d c6 fb bd 6e 3b 0d>,
  absValidity: 2018-03-20T20:01:18.387Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100447,
  cipherKeyVal: <Buffer f1 1d 6d 80 ae 2a ad 98 bf db e3 06 58 19 b5 62>,
  macKeyVal: <Buffer 71 c9 ac d7 d6 3e ec aa e0 95 6e b8 bb 0d 88 bb 6b e1 ec f6 25 43 67 f9 ae f5 dc f6 b3 a1 62 40>,
  absValidity: 2018-03-21T19:01:18.387Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100447,
     cipherKeyVal: <Buffer f1 1d 6d 80 ae 2a ad 98 bf db e3 06 58 19 b5 62>,
     macKeyVal: <Buffer 71 c9 ac d7 d6 3e ec aa e0 95 6e b8 bb 0d 88 bb 6b e1 ec f6 25 43 67 f9 ae f5 dc f6 b3 a1 62 40>,
     absValidity: 2018-03-21T19:01:18.387Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer ff 92 24 29 35 4b ba 53>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:01:18 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521572479339
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521572538278
connected to auth! from local port 55746
received auth hello!
{ authId: 501, nonce: <Buffer 1c 1d 40 f7 b0 98 c3 af> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e8 f9 dc 19 52 1d df f0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100455,
  cipherKeyVal: <Buffer b5 b4 d6 ee 06 64 dc 8a 35 f6 b0 2b 87 5b da 5a>,
  macKeyVal: <Buffer 9c 1b f6 90 d9 53 d1 b5 04 22 3c 6e 06 ba 53 65 44 db 5d 46 65 72 43 f3 6c 94 2d b9 fb 92 f0 b0>,
  absValidity: 2018-03-21T19:02:18.419Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100455,
     cipherKeyVal: <Buffer b5 b4 d6 ee 06 64 dc 8a 35 f6 b0 2b 87 5b da 5a>,
     macKeyVal: <Buffer 9c 1b f6 90 d9 53 d1 b5 04 22 3c 6e 06 ba 53 65 44 db 5d 46 65 72 43 f3 6c 94 2d b9 fb 92 f0 b0>,
     absValidity: 2018-03-21T19:02:18.419Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 59 d8 9d 0b 92 f0 9d 7b>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:02:19 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521572539913
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521572598335
connected to auth! from local port 56016
received auth hello!
{ authId: 501, nonce: <Buffer 9f fc 18 15 8a 53 04 12> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0c 3e fe f8 38 b7 1e ef>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100463,
  cipherKeyVal: <Buffer 65 a9 ff b1 00 b2 9a 42 7d ca 3d f0 f3 d8 ff 4b>,
  macKeyVal: <Buffer d9 4f 1d 11 d8 2c 1d 42 b7 c3 48 02 69 5d 6a df 66 c0 47 18 f9 8b 6a f0 79 6e a2 d8 b1 04 92 eb>,
  absValidity: 2018-03-21T19:03:18.489Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100463,
     cipherKeyVal: <Buffer 65 a9 ff b1 00 b2 9a 42 7d ca 3d f0 f3 d8 ff 4b>,
     macKeyVal: <Buffer d9 4f 1d 11 d8 2c 1d 42 b7 c3 48 02 69 5d 6a df 66 c0 47 18 f9 8b 6a f0 79 6e a2 d8 b1 04 92 eb>,
     absValidity: 2018-03-21T19:03:18.489Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 4e e5 c2 a9 3b 03 a7 68>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:03:19 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521572599814
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521572658393
connected to auth! from local port 56286
received auth hello!
{ authId: 501, nonce: <Buffer 0c d2 a5 88 3a b7 f7 30> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 69 67 b5 27 cc 2b f7 dd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100471,
  cipherKeyVal: <Buffer 62 c4 d5 fa aa 62 8b 0d 08 60 00 15 0d be 04 5b>,
  macKeyVal: <Buffer 60 12 27 e5 82 b1 99 ea 8c 9e 55 29 3c ea 6a ae f2 81 e8 7f 40 d7 14 6f 80 d3 83 9a 78 5a 22 5c>,
  absValidity: 2018-03-21T19:04:18.666Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100471,
     cipherKeyVal: <Buffer 62 c4 d5 fa aa 62 8b 0d 08 60 00 15 0d be 04 5b>,
     macKeyVal: <Buffer 60 12 27 e5 82 b1 99 ea 8c 9e 55 29 3c ea 6a ae f2 81 e8 7f 40 d7 14 6f 80 d3 83 9a 78 5a 22 5c>,
     absValidity: 2018-03-21T19:04:18.666Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 6e 6c 64 96 0f 7a 5d 69>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:04:19 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521572659701
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521572718449
connected to auth! from local port 56556
received auth hello!
{ authId: 501, nonce: <Buffer 7a 5e ec 8b 2d f8 d0 8a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 40 6e 7d b5 9b dc f8 4d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100479,
  cipherKeyVal: <Buffer 25 a5 f9 30 9b ff 72 03 0e 54 5c 03 f2 41 f1 42>,
  macKeyVal: <Buffer b4 2b ba f6 de c3 98 88 dd 6c f9 8c 9d 8b 2c d0 1d c1 71 08 cb e4 d7 de 85 bf f6 49 4e 51 3a dd>,
  absValidity: 2018-03-21T19:05:18.618Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100479,
     cipherKeyVal: <Buffer 25 a5 f9 30 9b ff 72 03 0e 54 5c 03 f2 41 f1 42>,
     macKeyVal: <Buffer b4 2b ba f6 de c3 98 88 dd 6c f9 8c 9d 8b 2c d0 1d c1 71 08 cb e4 d7 de 85 bf f6 49 4e 51 3a dd>,
     absValidity: 2018-03-21T19:05:18.618Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 34 eb 1a 5c 5b 0c 69 97>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:05:19 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521572720235
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521572778507
connected to auth! from local port 56826
received auth hello!
{ authId: 501, nonce: <Buffer 01 2d b8 a1 3c 04 26 d9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2e f2 2d 65 b8 f2 0f 31>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100487,
  cipherKeyVal: <Buffer d5 b8 60 3e 77 19 7b 07 c4 5b 7c 0c 98 2a ba 5f>,
  macKeyVal: <Buffer c6 57 1c c5 36 ea 72 e8 c6 0c 94 9e 15 cf b5 82 02 7e bd b5 6e a1 8c d0 57 52 15 b5 90 81 3d d0>,
  absValidity: 2018-03-21T19:06:18.659Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100487,
     cipherKeyVal: <Buffer d5 b8 60 3e 77 19 7b 07 c4 5b 7c 0c 98 2a ba 5f>,
     macKeyVal: <Buffer c6 57 1c c5 36 ea 72 e8 c6 0c 94 9e 15 cf b5 82 02 7e bd b5 6e a1 8c d0 57 52 15 b5 90 81 3d d0>,
     absValidity: 2018-03-21T19:06:18.659Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 6a d5 95 57 28 69 7e 5d>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:06:19 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521572780030
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521572838508
connected to auth! from local port 57100
received auth hello!
{ authId: 501, nonce: <Buffer 1a 38 ec 9f a8 cd e8 ec> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 01 88 a9 5c 84 b4 6d b5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100495,
  cipherKeyVal: <Buffer e7 a1 9b 94 65 6f 19 19 94 24 71 e6 df 89 c0 1f>,
  macKeyVal: <Buffer 7e 25 a4 cd 3c 5a 22 b7 b8 3c e7 96 12 98 76 89 19 08 d6 8a d5 cf 97 03 2a 97 16 db 5f 40 57 fc>,
  absValidity: 2018-03-21T19:07:18.686Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100495,
     cipherKeyVal: <Buffer e7 a1 9b 94 65 6f 19 19 94 24 71 e6 df 89 c0 1f>,
     macKeyVal: <Buffer 7e 25 a4 cd 3c 5a 22 b7 b8 3c e7 96 12 98 76 89 19 08 d6 8a d5 cf 97 03 2a 97 16 db 5f 40 57 fc>,
     absValidity: 2018-03-21T19:07:18.686Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer fe 30 ad 89 45 81 b5 dc>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:07:19 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521572839546
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521572898513
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 9 0.7777777777777778 1521572958524
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 59338
received auth hello!
{ authId: 401, nonce: <Buffer a3 69 eb e2 ff 8e 47 fa> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 10 0.7 1521573018534
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 59570
received auth hello!
{ authId: 401, nonce: <Buffer 7c 83 5b 63 e4 cf 3a 54> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 11 0.6363636363636364 1521573078544
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 12 0.5833333333333334 1521573138551
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 34656
received auth hello!
{ authId: 502, nonce: <Buffer b7 0a 36 22 1d 3c 11 5b> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '016244C731B0',
  notBefore: 2018-03-20T18:57:07.000Z,
  notAfter: 2018-03-21T18:58:47.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '93:7A:A1:94:F3:58:54:82:C2:CB:99:F0:13:9C:F6:6B:66:B8:99:CC',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'E40B9EF20959AA49D02016EC2E9896074EE0818689EAD7319ECC8ED8C9557412ED46C95E67464598F6233ECEB8BF25A876F0D30B65CED2B1FED8D1F07CF9042FD7F86E3B637BE17FBFD7C9F0DB5850835170B354A52C175B769A37BA578F965436FF29BCFD54C5D4E939E02214503C8A69FFBBF0EC06657DF9498BE98DEB26B62E1453817F6DFAE9B50EE21C5A643FF0292539838A682562303CB77FC6028B22B30B78957E4F78E539103F991928681EBF3100D31960F43F8ECFC6C2F3063B353E92BFFEF77A49BBCBF417864AE8169AA061F590E5FB3393A4592EFA1100FC186B95B83724CA0B11D8BC02BC9BD4F9E08552DE2D1EB0EE0E866E41A520730E6F',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJExzGwMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDMy\nMDE4NTcwN1oXDTE4MDMyMTE4NTg0N1owYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDkC57yCVmqSdAgFuwumJYHTuCBhonq1zGezI7YyVV0Eu1GyV5n\nRkWY9iM+zri/Jah28NMLZc7Ssf7Y0fB8+QQv1/huO2N74X+/18nw21hQg1Fws1Sl\nLBdbdpo3ulePllQ2/ym8/VTF1Ok54CIUUDyKaf+78OwGZX35SYvpjesmti4UU4F/\nbfrptQ7iHFpkP/ApJTmDimglYjA8t3/GAosiswt4lX5PeOU5ED+ZGShoHr8xANMZ\nYPQ/js/GwvMGOzU+kr/+93pJu8v0F4ZK6BaaoGH1kOX7M5OkWS76EQD8GGuVuDck\nygsR2LwCvJvU+eCFUt4tHrDuDoZuQaUgcw5vAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAIpAd3VKIQtsOp7Gd/n+U5dQGb1TbSuD\nNQk/HKl8/HzsGeRYEr03C8HMvU65HMRGtBcvzOn2KwcEgiT/9coa+YDtK1xJybhH\nPIloSWRq7NaoE4bYMp+gpRLUhZsV1RmMwFkEgfdjdkzZhQvtC11azkYH1d9yofSK\nAMxR5ZIFMXeAjAqYWVVQZUbCBD+RI7C4tf9TN22n7l8a+LemH6KutXlo2GAcWQVL\ng0GYJeMdzdZd09xIAX5ufxOwpz3QVVJ7nADmjQyVvdhsMoWseoRVmIEVNZ4KF2ow\n+L8v+Z191H3ur6zYAo38yWRpih+c8FR93Izsktw3ACeFXHA5Oyh9k+o=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 2
to: 3
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 13 0.5384615384615384 1521573198554
connected to auth! from local port 34900
received auth hello!
{ authId: 502, nonce: <Buffer 1a ff 5a cc d3 d4 37 c3> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer a2 fa cf 5d 0f 82 91 14>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 08 c6 63 4a c9 c8 0e 19 65 40 a6 ee bc 63 54 90>,
  macKeyVal: <Buffer 0a cf 43 a9 2e 4f 93 2d 75 48 79 f2 35 e8 f9 83 3b 2c 86 bb 9d 70 78 41 ed a2 86 e9 90 57 49 f1>,
  absValidity: 2018-03-20T20:13:18.761Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200482,
  cipherKeyVal: <Buffer c6 c8 64 4f cf e4 15 76 91 b3 b4 55 96 e6 b2 79>,
  macKeyVal: <Buffer a8 15 0c c8 02 59 06 7a e3 9c 23 b0 b3 09 fd 74 cb 31 f6 68 ad d3 04 dc 94 a7 20 bb 45 5c 30 45>,
  absValidity: 2018-03-21T19:13:18.760Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200482,
     cipherKeyVal: <Buffer c6 c8 64 4f cf e4 15 76 91 b3 b4 55 96 e6 b2 79>,
     macKeyVal: <Buffer a8 15 0c c8 02 59 06 7a e3 9c 23 b0 b3 09 fd 74 cb 31 f6 68 ad d3 04 dc 94 a7 20 bb 45 5c 30 45>,
     absValidity: 2018-03-21T19:13:18.760Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer ab 5f 04 42 01 a3 7a 38>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.28:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 14 0.5 1521573258564
connected to auth! from local port 35164
received auth hello!
{ authId: 502, nonce: <Buffer c3 1f e5 af ff ac 7d b2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 22 b3 3c cb bc a6 8d d7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200497,
  cipherKeyVal: <Buffer c3 cd de 39 46 d6 e4 d8 6d df e0 03 39 0a a1 4d>,
  macKeyVal: <Buffer 90 b3 19 d6 5c ce 03 27 33 1f 2d ad 6e 06 fe 31 16 99 1f 4b e2 c6 78 d7 87 3a 50 c7 b8 2e 46 de>,
  absValidity: 2018-03-21T19:14:18.744Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200497,
     cipherKeyVal: <Buffer c3 cd de 39 46 d6 e4 d8 6d df e0 03 39 0a a1 4d>,
     macKeyVal: <Buffer 90 b3 19 d6 5c ce 03 27 33 1f 2d ad 6e 06 fe 31 16 99 1f 4b e2 c6 78 d7 87 3a 50 c7 b8 2e 46 de>,
     absValidity: 2018-03-21T19:14:18.744Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 19 8c 4c a4 21 9e 04 bf>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.28:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 15 0.4666666666666667 1521573318575
connected to auth! from local port 35436
received auth hello!
{ authId: 502, nonce: <Buffer 0d ee 93 e0 f5 22 37 63> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7e 5a e8 01 90 c6 6d c2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200512,
  cipherKeyVal: <Buffer dc a4 51 3b ba 87 b4 0c dc 5f d9 c0 0a d5 7f df>,
  macKeyVal: <Buffer e2 41 89 7e 55 d5 0c a7 c6 a2 e0 0f 1d 3c 84 08 35 82 8b ad 67 18 f8 7c 7a 1e 4d 8a 3f 2e 7a e6>,
  absValidity: 2018-03-21T19:15:18.736Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200512,
     cipherKeyVal: <Buffer dc a4 51 3b ba 87 b4 0c dc 5f d9 c0 0a d5 7f df>,
     macKeyVal: <Buffer e2 41 89 7e 55 d5 0c a7 c6 a2 e0 0f 1d 3c 84 08 35 82 8b ad 67 18 f8 7c 7a 1e 4d 8a 3f 2e 7a e6>,
     absValidity: 2018-03-21T19:15:18.736Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer b1 ba ff ed 22 e7 27 61>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.28:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 16 0.4375 1521573378585
connected to auth! from local port 35714
received auth hello!
{ authId: 502, nonce: <Buffer eb a2 2a 45 da 9f f9 c0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ac 81 5a c5 e7 a9 20 81>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200527,
  cipherKeyVal: <Buffer 0b b8 43 bb 69 90 bc 1b e9 87 b2 14 73 bb 71 7e>,
  macKeyVal: <Buffer 51 70 5c 50 7c 7e c2 8f c4 b4 74 21 07 a6 7a e8 fe 77 af cf 74 f9 9f 3a ec 7d 51 d2 51 c5 91 ef>,
  absValidity: 2018-03-21T19:16:18.731Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200527,
     cipherKeyVal: <Buffer 0b b8 43 bb 69 90 bc 1b e9 87 b2 14 73 bb 71 7e>,
     macKeyVal: <Buffer 51 70 5c 50 7c 7e c2 8f c4 b4 74 21 07 a6 7a e8 fe 77 af cf 74 f9 9f 3a ec 7d 51 d2 51 c5 91 ef>,
     absValidity: 2018-03-21T19:16:18.731Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 29 3a 3c 13 1c 00 6c 48>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.28:undefined
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 17 0.4117647058823529 1521573438596
connected to auth! from local port 35962
received auth hello!
{ authId: 502, nonce: <Buffer 16 79 e8 2d ac f8 c9 3a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4c ba f7 53 c9 61 1a 95>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200542,
  cipherKeyVal: <Buffer e8 1e 1d 21 b6 93 2e e6 1e 5a 5e 59 35 f0 33 e4>,
  macKeyVal: <Buffer 51 01 bd 5b b9 07 3f f0 e9 d0 96 09 59 41 d1 78 48 c3 33 b3 a1 75 72 7d 09 af da 19 6c c3 a1 f5>,
  absValidity: 2018-03-21T19:17:18.759Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200542,
     cipherKeyVal: <Buffer e8 1e 1d 21 b6 93 2e e6 1e 5a 5e 59 35 f0 33 e4>,
     macKeyVal: <Buffer 51 01 bd 5b b9 07 3f f0 e9 d0 96 09 59 41 d1 78 48 c3 33 b3 a1 75 72 7d 09 af da 19 6c c3 a1 f5>,
     absValidity: 2018-03-21T19:17:18.759Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 18 0.3888888888888889 1521573498653
connected to auth! from local port 36194
received auth hello!
{ authId: 502, nonce: <Buffer 90 d4 1e f8 5d e0 20 1c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5f 9a 4f 8a 79 15 25 1d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200557,
  cipherKeyVal: <Buffer 10 b2 ed 96 d9 8d 1c 7d 93 7f 02 75 25 00 41 1e>,
  macKeyVal: <Buffer e0 1b a9 c7 c2 6c 85 8d 1d 27 9e 6b be a4 ef 79 87 be 4b f4 8e 15 0e fb 3e dd 87 3a a1 bd 66 60>,
  absValidity: 2018-03-21T19:18:18.820Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200557,
     cipherKeyVal: <Buffer 10 b2 ed 96 d9 8d 1c 7d 93 7f 02 75 25 00 41 1e>,
     macKeyVal: <Buffer e0 1b a9 c7 c2 6c 85 8d 1d 27 9e 6b be a4 ef 79 87 be 4b f4 8e 15 0e fb 3e dd 87 3a a1 bd 66 60>,
     absValidity: 2018-03-21T19:18:18.820Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 19 0.3684210526315789 1521573558709
connected to auth! from local port 36426
received auth hello!
{ authId: 502, nonce: <Buffer 61 75 5e 09 36 82 04 fd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 04 da 2b 7d b2 81 30 46>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200572,
  cipherKeyVal: <Buffer 17 3a 95 db 06 44 21 0b a2 1f 85 93 64 b7 83 13>,
  macKeyVal: <Buffer 8e a5 6b cb fb 9e 65 57 11 37 2b ac a7 c7 1b 9d dd 68 37 39 50 d4 eb 92 5a dc a7 d5 24 0a 9b cc>,
  absValidity: 2018-03-21T19:19:18.941Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200572,
     cipherKeyVal: <Buffer 17 3a 95 db 06 44 21 0b a2 1f 85 93 64 b7 83 13>,
     macKeyVal: <Buffer 8e a5 6b cb fb 9e 65 57 11 37 2b ac a7 c7 1b 9d dd 68 37 39 50 d4 eb 92 5a dc a7 d5 24 0a 9b cc>,
     absValidity: 2018-03-21T19:19:18.941Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 20 0.35 1521573618770
connected to auth! from local port 36650
received auth hello!
{ authId: 502, nonce: <Buffer 58 b8 67 80 34 fe 58 1d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2e 32 b6 52 67 3d 17 83>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200587,
  cipherKeyVal: <Buffer f7 36 35 3c 93 67 18 6d 11 9e 2d a1 a4 50 21 32>,
  macKeyVal: <Buffer 6b 61 a6 88 48 97 ca 5d 0b 06 ed 50 f9 d9 24 95 44 1d 43 72 7c 99 6a 58 38 5d d7 cb a2 93 53 e0>,
  absValidity: 2018-03-21T19:20:19.060Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200587,
     cipherKeyVal: <Buffer f7 36 35 3c 93 67 18 6d 11 9e 2d a1 a4 50 21 32>,
     macKeyVal: <Buffer 6b 61 a6 88 48 97 ca 5d 0b 06 ed 50 f9 d9 24 95 44 1d 43 72 7c 99 6a 58 38 5d d7 cb a2 93 53 e0>,
     absValidity: 2018-03-21T19:20:19.060Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 21 0.3333333333333333 1521573678829
connected to auth! from local port 36874
received auth hello!
{ authId: 502, nonce: <Buffer 9a fc 31 54 72 70 55 0c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f2 ab 63 f1 cf 52 6f 07>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200602,
  cipherKeyVal: <Buffer 98 da 28 85 e8 69 d6 78 ad 3f d9 cd fa 2d 8b b0>,
  macKeyVal: <Buffer f9 08 f7 54 24 bb a4 17 0f 9c 97 9e cf 6e 4a 04 6a bd ab 58 cd fe b3 86 ec b0 16 8e 65 b6 85 fe>,
  absValidity: 2018-03-21T19:21:19.063Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200602,
     cipherKeyVal: <Buffer 98 da 28 85 e8 69 d6 78 ad 3f d9 cd fa 2d 8b b0>,
     macKeyVal: <Buffer f9 08 f7 54 24 bb a4 17 0f 9c 97 9e cf 6e 4a 04 6a bd ab 58 cd fe b3 86 ec b0 16 8e 65 b6 85 fe>,
     absValidity: 2018-03-21T19:21:19.063Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 22 0.3181818181818182 1521573738889
connected to auth! from local port 37094
received auth hello!
{ authId: 502, nonce: <Buffer 07 8a 2c ec 26 6d 0d 4b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 16 da bd 7a 68 e2 f0 7d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200617,
  cipherKeyVal: <Buffer ef 7f d8 08 f1 43 ed a8 12 be 5a 3c 3b 90 7a 33>,
  macKeyVal: <Buffer bc 2c ea b4 a1 18 1a a4 6c cf ce 4b 21 6c 9c 11 c2 0d b4 46 70 56 3f 0d 5d f5 36 6a 3a ae 70 a7>,
  absValidity: 2018-03-21T19:22:19.098Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200617,
     cipherKeyVal: <Buffer ef 7f d8 08 f1 43 ed a8 12 be 5a 3c 3b 90 7a 33>,
     macKeyVal: <Buffer bc 2c ea b4 a1 18 1a a4 6c cf ce 4b 21 6c 9c 11 c2 0d b4 46 70 56 3f 0d 5d f5 36 6a 3a ae 70 a7>,
     absValidity: 2018-03-21T19:22:19.098Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 23 0.30434782608695654 1521573798950
connected to auth! from local port 37330
received auth hello!
{ authId: 502, nonce: <Buffer ec 0e a9 a1 d3 c7 55 01> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 00 4a 4f 0d 64 94 11 22>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200632,
  cipherKeyVal: <Buffer 44 ac 5d cd 28 0c 2b 98 88 3f 94 19 5f 1b c6 40>,
  macKeyVal: <Buffer 92 8e 58 2c 88 8e d7 90 61 3d 09 6e 19 3a f7 69 4f 28 b2 d9 1f e4 04 c9 52 97 15 d1 83 a3 85 f4>,
  absValidity: 2018-03-21T19:23:19.215Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200632,
     cipherKeyVal: <Buffer 44 ac 5d cd 28 0c 2b 98 88 3f 94 19 5f 1b c6 40>,
     macKeyVal: <Buffer 92 8e 58 2c 88 8e d7 90 61 3d 09 6e 19 3a f7 69 4f 28 b2 d9 1f e4 04 c9 52 97 15 d1 83 a3 85 f4>,
     absValidity: 2018-03-21T19:23:19.215Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 24 0.2916666666666667 1521573859005
connected to auth! from local port 37566
received auth hello!
{ authId: 502, nonce: <Buffer f4 8b 12 5b ce 35 3f 16> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer be d3 22 b2 d6 ec bd d2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200647,
  cipherKeyVal: <Buffer e2 ee 93 eb 85 79 61 c6 bd 8d 9a 24 1f 7a fb 4c>,
  macKeyVal: <Buffer d9 b9 f0 46 15 86 08 c7 e1 77 b3 ed aa 1c fe dd 7b 6c 0b 01 bb 73 36 7d a5 9e 51 fe 8f c6 88 99>,
  absValidity: 2018-03-21T19:24:19.186Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200647,
     cipherKeyVal: <Buffer e2 ee 93 eb 85 79 61 c6 bd 8d 9a 24 1f 7a fb 4c>,
     macKeyVal: <Buffer d9 b9 f0 46 15 86 08 c7 e1 77 b3 ed aa 1c fe dd 7b 6c 0b 01 bb 73 36 7d a5 9e 51 fe 8f c6 88 99>,
     absValidity: 2018-03-21T19:24:19.186Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 25 0.28 1521573919037
connected to auth! from local port 37808
received auth hello!
{ authId: 502, nonce: <Buffer 11 58 64 7f 91 92 87 52> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ca c2 9d a8 f6 5c d5 ff>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200662,
  cipherKeyVal: <Buffer ed 76 71 47 86 bd d7 ad 3c 23 6a 7b 54 da 10 ce>,
  macKeyVal: <Buffer 96 45 9f 57 9c 4e 8e a3 a0 d2 cd 8f 6d d6 f8 a5 5e 6f c5 9f dc 69 28 e1 96 6d eb ba 19 6f 2d d0>,
  absValidity: 2018-03-21T19:25:19.239Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200662,
     cipherKeyVal: <Buffer ed 76 71 47 86 bd d7 ad 3c 23 6a 7b 54 da 10 ce>,
     macKeyVal: <Buffer 96 45 9f 57 9c 4e 8e a3 a0 d2 cd 8f 6d d6 f8 a5 5e 6f c5 9f dc 69 28 e1 96 6d eb ba 19 6f 2d d0>,
     absValidity: 2018-03-21T19:25:19.239Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 26 0.2692307692307692 1521573979096
connected to auth! from local port 38034
received auth hello!
{ authId: 502, nonce: <Buffer 42 d6 5d 11 06 d7 3f a5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer da 14 e5 c5 4c 0b 84 e6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200677,
  cipherKeyVal: <Buffer 12 47 68 eb 65 5c 93 26 7f cc 34 f1 aa ec 85 fa>,
  macKeyVal: <Buffer e4 b0 1d 82 c0 c4 71 18 b4 8a 52 aa 60 76 1a 35 11 88 b0 e4 79 36 1e 41 84 8c 15 f6 e5 b7 2b 01>,
  absValidity: 2018-03-21T19:26:19.370Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200677,
     cipherKeyVal: <Buffer 12 47 68 eb 65 5c 93 26 7f cc 34 f1 aa ec 85 fa>,
     macKeyVal: <Buffer e4 b0 1d 82 c0 c4 71 18 b4 8a 52 aa 60 76 1a 35 11 88 b0 e4 79 36 1e 41 84 8c 15 f6 e5 b7 2b 01>,
     absValidity: 2018-03-21T19:26:19.370Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 27 0.25925925925925924 1521574039156
connected to auth! from local port 38264
received auth hello!
{ authId: 502, nonce: <Buffer a6 af 52 ae ff ca 24 b6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 98 30 50 32 57 35 d2 af>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200692,
  cipherKeyVal: <Buffer 16 ad d7 40 01 d0 4b 08 1a e3 2a cb 4f 3a 2e c8>,
  macKeyVal: <Buffer 88 dd aa d0 60 45 d5 d1 58 f5 42 ad 05 51 70 df c9 71 5b 25 26 23 6f 90 9c 6c 17 60 4b 3d 7c f3>,
  absValidity: 2018-03-21T19:27:19.312Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200692,
     cipherKeyVal: <Buffer 16 ad d7 40 01 d0 4b 08 1a e3 2a cb 4f 3a 2e c8>,
     macKeyVal: <Buffer 88 dd aa d0 60 45 d5 d1 58 f5 42 ad 05 51 70 df c9 71 5b 25 26 23 6f 90 9c 6c 17 60 4b 3d 7c f3>,
     absValidity: 2018-03-21T19:27:19.312Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
