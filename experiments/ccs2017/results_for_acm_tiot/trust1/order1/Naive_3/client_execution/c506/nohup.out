changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c506.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c506',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 79 53 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521572471666
connected to auth! from local port 44544
received auth hello!
{ authId: 501, nonce: <Buffer 9d c0 a5 1e d6 0e ee c5> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 36 8c 46 c8 95 08 24 99>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 13 a0 c7 28 e8 51 f3 bd dd 2d e7 b8 51 90 ef 3c>,
  macKeyVal: <Buffer 8a 2f 82 d8 74 39 cc a8 93 30 f7 2a c4 be eb 0f 97 60 b5 5c 9e a7 38 27 d1 f9 94 73 3b 73 12 dc>,
  absValidity: 2018-03-20T20:01:11.854Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100445,
  cipherKeyVal: <Buffer 3a f0 2e f2 a0 06 d6 b3 2b 06 1c 2e b7 18 f4 49>,
  macKeyVal: <Buffer 20 13 20 2d 33 31 a8 ad 34 f7 6f b1 a6 56 22 43 89 eb 6f fd 88 e2 1d 92 1e 79 09 5a 3d 93 8e 69>,
  absValidity: 2018-03-21T19:01:11.854Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.27',
  serverPort: 22100,
  sessionKey: 
   { id: 50100445,
     cipherKeyVal: <Buffer 3a f0 2e f2 a0 06 d6 b3 2b 06 1c 2e b7 18 f4 49>,
     macKeyVal: <Buffer 20 13 20 2d 33 31 a8 ad 34 f7 6f b1 a6 56 22 43 89 eb 6f fd 88 e2 1d 92 1e 79 09 5a 3d 93 8e 69>,
     absValidity: 2018-03-21T19:01:11.854Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 1d 4d dc 02 85 0f 69 ac>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:01:12 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521572472823
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521572531725
connected to auth! from local port 44798
received auth hello!
{ authId: 501, nonce: <Buffer de b3 e6 b3 92 a2 08 09> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6c a8 0c a6 b2 5a 44 6e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100453,
  cipherKeyVal: <Buffer 91 84 0a ac d7 6a 6b 59 19 22 44 ae be 56 48 cd>,
  macKeyVal: <Buffer ef ed cf 99 db 17 fa 02 7b 83 b4 9f 5a 6a d3 f2 c5 5d e4 e7 9c d7 da b9 01 35 b4 e3 90 b9 10 31>,
  absValidity: 2018-03-21T19:02:11.856Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.27',
  serverPort: 22100,
  sessionKey: 
   { id: 50100453,
     cipherKeyVal: <Buffer 91 84 0a ac d7 6a 6b 59 19 22 44 ae be 56 48 cd>,
     macKeyVal: <Buffer ef ed cf 99 db 17 fa 02 7b 83 b4 9f 5a 6a d3 f2 c5 5d e4 e7 9c d7 da b9 01 35 b4 e3 90 b9 10 31>,
     absValidity: 2018-03-21T19:02:11.856Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer e6 35 7d 32 a2 33 42 84>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:02:12 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521572532619
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521572591785
connected to auth! from local port 45068
received auth hello!
{ authId: 501, nonce: <Buffer 9d 1c 57 99 d6 d8 0b 79> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 71 a4 97 51 fb 12 06 74>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100461,
  cipherKeyVal: <Buffer 9d a1 f9 15 39 f6 ae e0 7d db fc 17 c4 4d d4 91>,
  macKeyVal: <Buffer d6 15 8d a9 38 5a fa d0 c1 6a 7c 1b 82 00 0c db 6f 53 53 7a 48 f3 cd 87 55 68 ca a7 49 6c 35 82>,
  absValidity: 2018-03-21T19:03:11.941Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.27',
  serverPort: 22100,
  sessionKey: 
   { id: 50100461,
     cipherKeyVal: <Buffer 9d a1 f9 15 39 f6 ae e0 7d db fc 17 c4 4d d4 91>,
     macKeyVal: <Buffer d6 15 8d a9 38 5a fa d0 c1 6a 7c 1b 82 00 0c db 6f 53 53 7a 48 f3 cd 87 55 68 ca a7 49 6c 35 82>,
     absValidity: 2018-03-21T19:03:11.941Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 88 d4 e5 0a f0 f3 8f bc>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:03:12 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521572592919
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521572651835
connected to auth! from local port 45338
received auth hello!
{ authId: 501, nonce: <Buffer 18 cc 14 15 8c b1 dd 7e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 23 fa 7f 11 9b 8c 78 bc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100469,
  cipherKeyVal: <Buffer ae d3 d4 33 e9 b6 41 85 7e b1 be a0 23 89 a0 67>,
  macKeyVal: <Buffer d5 df 53 a2 94 ca c2 86 c3 93 3c c7 66 6b 14 40 67 d0 ad 10 9c e9 c2 b0 18 28 9c b8 fb 47 0b 72>,
  absValidity: 2018-03-21T19:04:11.953Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.27',
  serverPort: 22100,
  sessionKey: 
   { id: 50100469,
     cipherKeyVal: <Buffer ae d3 d4 33 e9 b6 41 85 7e b1 be a0 23 89 a0 67>,
     macKeyVal: <Buffer d5 df 53 a2 94 ca c2 86 c3 93 3c c7 66 6b 14 40 67 d0 ad 10 9c e9 c2 b0 18 28 9c b8 fb 47 0b 72>,
     absValidity: 2018-03-21T19:04:11.953Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 0d f5 37 d7 27 f6 97 e6>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:04:12 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521572652931
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521572711893
connected to auth! from local port 45608
received auth hello!
{ authId: 501, nonce: <Buffer 9c 95 8b 6d 20 c6 46 8f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 06 d1 ad 53 ba 47 c6 9b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100477,
  cipherKeyVal: <Buffer 3b 2c 36 53 de f1 c9 2e c7 40 6d 32 36 ea 8b 76>,
  macKeyVal: <Buffer 98 13 61 45 cf ee 28 54 62 e2 6e 9d 5a 32 b3 3a 2a 5e ff f4 27 c2 10 3d 98 62 c9 d3 8d 7a b5 35>,
  absValidity: 2018-03-21T19:05:12.047Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.27',
  serverPort: 22100,
  sessionKey: 
   { id: 50100477,
     cipherKeyVal: <Buffer 3b 2c 36 53 de f1 c9 2e c7 40 6d 32 36 ea 8b 76>,
     macKeyVal: <Buffer 98 13 61 45 cf ee 28 54 62 e2 6e 9d 5a 32 b3 3a 2a 5e ff f4 27 c2 10 3d 98 62 c9 d3 8d 7a b5 35>,
     absValidity: 2018-03-21T19:05:12.047Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 0d 71 13 2b 72 ce ed d3>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:05:12 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521572712870
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521572771951
connected to auth! from local port 45878
received auth hello!
{ authId: 501, nonce: <Buffer 3f a8 f8 c5 ea 1c 06 6e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b6 9a 44 de 52 9d 96 e1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100485,
  cipherKeyVal: <Buffer 93 89 ee cb 2b 1d cc cd ac e6 d1 57 eb e0 de 46>,
  macKeyVal: <Buffer a2 bc 9b c3 20 51 4b b3 e8 54 28 b5 17 1c 6c 99 9a e9 8a 37 48 b6 76 30 ed dc 79 26 bb 8e a5 da>,
  absValidity: 2018-03-21T19:06:12.096Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.27',
  serverPort: 22100,
  sessionKey: 
   { id: 50100485,
     cipherKeyVal: <Buffer 93 89 ee cb 2b 1d cc cd ac e6 d1 57 eb e0 de 46>,
     macKeyVal: <Buffer a2 bc 9b c3 20 51 4b b3 e8 54 28 b5 17 1c 6c 99 9a e9 8a 37 48 b6 76 30 ed dc 79 26 bb 8e a5 da>,
     absValidity: 2018-03-21T19:06:12.096Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 7a 1e 25 07 87 bf cc 17>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:06:12 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521572772907
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521572831955
connected to auth! from local port 46148
received auth hello!
{ authId: 501, nonce: <Buffer ac bd a8 68 10 14 a0 02> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4a 5a 39 88 81 16 fb c8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100493,
  cipherKeyVal: <Buffer 5a eb 52 49 ce 5b 73 dd d8 21 1a ad eb 70 5a 64>,
  macKeyVal: <Buffer 91 e1 ec ba bb 31 f9 9d d2 0c e3 9d 29 30 e6 dd dd e8 21 05 91 0b 8c 24 96 df b9 8d 93 8e bd 81>,
  absValidity: 2018-03-21T19:07:12.200Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.27',
  serverPort: 22100,
  sessionKey: 
   { id: 50100493,
     cipherKeyVal: <Buffer 5a eb 52 49 ce 5b 73 dd d8 21 1a ad eb 70 5a 64>,
     macKeyVal: <Buffer 91 e1 ec ba bb 31 f9 9d d2 0c e3 9d 29 30 e6 dd dd e8 21 05 91 0b 8c 24 96 df b9 8d 93 8e bd 81>,
     absValidity: 2018-03-21T19:07:12.200Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 31 dc 76 33 c0 a2 5f 5b>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:07:13 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521572833325
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521572892014
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 9 0.7777777777777778 1521572952025
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 41196
received auth hello!
{ authId: 401, nonce: <Buffer d6 b1 0f 73 f9 5e 1c 0b> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 10 0.7 1521573012037
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 41420
received auth hello!
{ authId: 401, nonce: <Buffer 76 74 16 41 45 41 83 90> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 11 0.6363636363636364 1521573072047
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 12 0.5833333333333334 1521573132053
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 43150
received auth hello!
{ authId: 502, nonce: <Buffer 86 ea 3a 7f 97 d3 4f 96> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '016244C731B0',
  notBefore: 2018-03-20T18:57:07.000Z,
  notAfter: 2018-03-21T18:58:47.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '93:7A:A1:94:F3:58:54:82:C2:CB:99:F0:13:9C:F6:6B:66:B8:99:CC',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'E40B9EF20959AA49D02016EC2E9896074EE0818689EAD7319ECC8ED8C9557412ED46C95E67464598F6233ECEB8BF25A876F0D30B65CED2B1FED8D1F07CF9042FD7F86E3B637BE17FBFD7C9F0DB5850835170B354A52C175B769A37BA578F965436FF29BCFD54C5D4E939E02214503C8A69FFBBF0EC06657DF9498BE98DEB26B62E1453817F6DFAE9B50EE21C5A643FF0292539838A682562303CB77FC6028B22B30B78957E4F78E539103F991928681EBF3100D31960F43F8ECFC6C2F3063B353E92BFFEF77A49BBCBF417864AE8169AA061F590E5FB3393A4592EFA1100FC186B95B83724CA0B11D8BC02BC9BD4F9E08552DE2D1EB0EE0E866E41A520730E6F',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJExzGwMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDMy\nMDE4NTcwN1oXDTE4MDMyMTE4NTg0N1owYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDkC57yCVmqSdAgFuwumJYHTuCBhonq1zGezI7YyVV0Eu1GyV5n\nRkWY9iM+zri/Jah28NMLZc7Ssf7Y0fB8+QQv1/huO2N74X+/18nw21hQg1Fws1Sl\nLBdbdpo3ulePllQ2/ym8/VTF1Ok54CIUUDyKaf+78OwGZX35SYvpjesmti4UU4F/\nbfrptQ7iHFpkP/ApJTmDimglYjA8t3/GAosiswt4lX5PeOU5ED+ZGShoHr8xANMZ\nYPQ/js/GwvMGOzU+kr/+93pJu8v0F4ZK6BaaoGH1kOX7M5OkWS76EQD8GGuVuDck\nygsR2LwCvJvU+eCFUt4tHrDuDoZuQaUgcw5vAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAIpAd3VKIQtsOp7Gd/n+U5dQGb1TbSuD\nNQk/HKl8/HzsGeRYEr03C8HMvU65HMRGtBcvzOn2KwcEgiT/9coa+YDtK1xJybhH\nPIloSWRq7NaoE4bYMp+gpRLUhZsV1RmMwFkEgfdjdkzZhQvtC11azkYH1d9yofSK\nAMxR5ZIFMXeAjAqYWVVQZUbCBD+RI7C4tf9TN22n7l8a+LemH6KutXlo2GAcWQVL\ng0GYJeMdzdZd09xIAX5ufxOwpz3QVVJ7nADmjQyVvdhsMoWseoRVmIEVNZ4KF2ow\n+L8v+Z191H3ur6zYAo38yWRpih+c8FR93Izsktw3ACeFXHA5Oyh9k+o=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 2
to: 3
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 13 0.5384615384615384 1521573192064
connected to auth! from local port 43382
received auth hello!
{ authId: 502, nonce: <Buffer bc af 48 ae 02 7b 38 4d> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer f0 95 39 2d 39 6b 20 1e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 8d c2 21 66 41 d4 b1 d2 bc 55 70 f3 8e b7 68 d2>,
  macKeyVal: <Buffer c5 46 bc c7 77 84 0b dc fd 7d d5 86 4a 2f 1a 7f 1b 59 e5 e6 92 9a 21 bf 02 09 ec 27 36 f9 db 38>,
  absValidity: 2018-03-20T20:13:12.223Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200480,
  cipherKeyVal: <Buffer aa 03 9c c1 a0 cb ef b1 35 1f 2b dd fc 05 fd 09>,
  macKeyVal: <Buffer da 8e fe 46 72 5d ab 49 b3 39 db dc 46 f0 d4 c2 b3 a5 a3 74 9c 2f 4e b6 62 18 c7 2f a8 2b 0a d7>,
  absValidity: 2018-03-21T19:13:12.223Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.27',
  serverPort: 22100,
  sessionKey: 
   { id: 50200480,
     cipherKeyVal: <Buffer aa 03 9c c1 a0 cb ef b1 35 1f 2b dd fc 05 fd 09>,
     macKeyVal: <Buffer da 8e fe 46 72 5d ab 49 b3 39 db dc 46 f0 d4 c2 b3 a5 a3 74 9c 2f 4e b6 62 18 c7 2f a8 2b 0a d7>,
     absValidity: 2018-03-21T19:13:12.223Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 8b 1a 1e 2d 55 e0 65 e3>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.27:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 14 0.5 1521573252075
connected to auth! from local port 43644
received auth hello!
{ authId: 502, nonce: <Buffer 72 75 73 47 2c 4a 63 70> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bd cf 3a b9 05 e5 5e 9a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200495,
  cipherKeyVal: <Buffer fb 6d c4 3a a3 fd 9d f2 a9 7d 3c 76 06 6c 07 6e>,
  macKeyVal: <Buffer a8 42 07 60 78 2a f7 c1 66 b0 ba 5a a1 f3 82 0b 2a 0e 8c 2a b8 16 42 80 10 a8 9d b1 af 2b 4c ed>,
  absValidity: 2018-03-21T19:14:12.290Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.27',
  serverPort: 22100,
  sessionKey: 
   { id: 50200495,
     cipherKeyVal: <Buffer fb 6d c4 3a a3 fd 9d f2 a9 7d 3c 76 06 6c 07 6e>,
     macKeyVal: <Buffer a8 42 07 60 78 2a f7 c1 66 b0 ba 5a a1 f3 82 0b 2a 0e 8c 2a b8 16 42 80 10 a8 9d b1 af 2b 4c ed>,
     absValidity: 2018-03-21T19:14:12.290Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 8f b0 e8 05 06 cd 3d 7e>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.27:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 15 0.4666666666666667 1521573312085
connected to auth! from local port 43920
received auth hello!
{ authId: 502, nonce: <Buffer 6d 62 f3 92 9c 15 7c 8e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ea 9d 32 8e 0e be a5 27>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200510,
  cipherKeyVal: <Buffer fc 24 53 5f 3c 9d d6 ce 3e b9 be 79 1e df 07 18>,
  macKeyVal: <Buffer c4 92 11 cc 4e cf b5 36 42 f0 af 61 7e 78 43 4d 8a 37 59 46 9b 33 4c 12 66 8d 8c fb 4a 5c 0c a5>,
  absValidity: 2018-03-21T19:15:12.243Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.27',
  serverPort: 22100,
  sessionKey: 
   { id: 50200510,
     cipherKeyVal: <Buffer fc 24 53 5f 3c 9d d6 ce 3e b9 be 79 1e df 07 18>,
     macKeyVal: <Buffer c4 92 11 cc 4e cf b5 36 42 f0 af 61 7e 78 43 4d 8a 37 59 46 9b 33 4c 12 66 8d 8c fb 4a 5c 0c a5>,
     absValidity: 2018-03-21T19:15:12.243Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer ef fe 70 6f 6e 31 ee 6d>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.27:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 16 0.4375 1521573372096
connected to auth! from local port 44186
received auth hello!
{ authId: 502, nonce: <Buffer 5e c1 25 8d 8e ec 18 9c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 71 1b d5 d8 09 5f 79 41>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200525,
  cipherKeyVal: <Buffer 67 4e 24 29 04 51 2f dc 61 6f 25 0f 56 6c c6 a4>,
  macKeyVal: <Buffer a1 a8 40 b9 85 5e 04 bc 2b 11 8d 1f 09 09 5a 15 2d 59 b8 87 80 02 d5 d7 da 29 f9 cf 1c 92 b6 8b>,
  absValidity: 2018-03-21T19:16:12.322Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.27',
  serverPort: 22100,
  sessionKey: 
   { id: 50200525,
     cipherKeyVal: <Buffer 67 4e 24 29 04 51 2f dc 61 6f 25 0f 56 6c c6 a4>,
     macKeyVal: <Buffer a1 a8 40 b9 85 5e 04 bc 2b 11 8d 1f 09 09 5a 15 2d 59 b8 87 80 02 d5 d7 da 29 f9 cf 1c 92 b6 8b>,
     absValidity: 2018-03-21T19:16:12.322Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer e7 50 5d 0e 33 10 84 90>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.27:undefined
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 17 0.4117647058823529 1521573432105
connected to auth! from local port 44452
received auth hello!
{ authId: 502, nonce: <Buffer d0 fc dd f7 28 15 67 e5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5b 90 90 55 4c ec e1 e7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200540,
  cipherKeyVal: <Buffer fc 2c 07 85 f2 de 17 0a b2 f4 e5 d8 8d bb 48 92>,
  macKeyVal: <Buffer 4e 85 b7 b2 f2 0a a3 55 44 b9 7d 51 ff fe 1a 92 2b ec 2f d7 a7 91 5a cf 84 ce 8a 6c ba 72 4a 31>,
  absValidity: 2018-03-21T19:17:12.230Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.27',
  serverPort: 22100,
  sessionKey: 
   { id: 50200540,
     cipherKeyVal: <Buffer fc 2c 07 85 f2 de 17 0a b2 f4 e5 d8 8d bb 48 92>,
     macKeyVal: <Buffer 4e 85 b7 b2 f2 0a a3 55 44 b9 7d 51 ff fe 1a 92 2b ec 2f d7 a7 91 5a cf 84 ce 8a 6c ba 72 4a 31>,
     absValidity: 2018-03-21T19:17:12.230Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.27:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 18 0.3888888888888889 1521573492166
connected to auth! from local port 44686
received auth hello!
{ authId: 502, nonce: <Buffer d2 7b 62 d5 9c 7d e3 c0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 45 ec e2 aa bf 05 54 35>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200555,
  cipherKeyVal: <Buffer fa 96 2c d2 57 f4 4e 82 78 8e e9 9d a1 5c fc 43>,
  macKeyVal: <Buffer 37 2c 01 33 32 5d d0 e0 f7 80 e6 e3 33 f0 48 87 05 87 25 12 62 b7 7d 63 58 c7 58 0a a6 ff ee de>,
  absValidity: 2018-03-21T19:18:12.302Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.27',
  serverPort: 22100,
  sessionKey: 
   { id: 50200555,
     cipherKeyVal: <Buffer fa 96 2c d2 57 f4 4e 82 78 8e e9 9d a1 5c fc 43>,
     macKeyVal: <Buffer 37 2c 01 33 32 5d d0 e0 f7 80 e6 e3 33 f0 48 87 05 87 25 12 62 b7 7d 63 58 c7 58 0a a6 ff ee de>,
     absValidity: 2018-03-21T19:18:12.302Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.27:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 19 0.3684210526315789 1521573552214
connected to auth! from local port 44916
received auth hello!
{ authId: 502, nonce: <Buffer b9 d9 1e 29 b5 f5 c2 36> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 84 51 44 a1 74 21 29 89>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200570,
  cipherKeyVal: <Buffer 5b d0 bc 12 8c e2 f4 d7 31 e7 c4 c8 4d 3a a1 f3>,
  macKeyVal: <Buffer 76 9c aa cc 47 d2 98 f7 08 60 91 69 39 79 a5 3b 31 df 8e f3 8d 1d 4b 81 87 4b 9f 80 e7 9b c5 23>,
  absValidity: 2018-03-21T19:19:12.357Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.27',
  serverPort: 22100,
  sessionKey: 
   { id: 50200570,
     cipherKeyVal: <Buffer 5b d0 bc 12 8c e2 f4 d7 31 e7 c4 c8 4d 3a a1 f3>,
     macKeyVal: <Buffer 76 9c aa cc 47 d2 98 f7 08 60 91 69 39 79 a5 3b 31 df 8e f3 8d 1d 4b 81 87 4b 9f 80 e7 9b c5 23>,
     absValidity: 2018-03-21T19:19:12.357Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.27:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 20 0.35 1521573612273
connected to auth! from local port 45140
received auth hello!
{ authId: 502, nonce: <Buffer ab 3b 57 c9 ac f1 11 3b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f3 13 dd 20 b4 bd 7a a1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200585,
  cipherKeyVal: <Buffer 01 41 25 29 36 3a 76 27 c2 19 42 44 64 1b a8 3f>,
  macKeyVal: <Buffer 66 40 94 35 f5 74 6b 65 0a bb ab 0b f2 54 39 9d 31 b2 d9 09 08 f0 ce 05 31 8f 9c ca 67 33 5e c4>,
  absValidity: 2018-03-21T19:20:12.476Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.27',
  serverPort: 22100,
  sessionKey: 
   { id: 50200585,
     cipherKeyVal: <Buffer 01 41 25 29 36 3a 76 27 c2 19 42 44 64 1b a8 3f>,
     macKeyVal: <Buffer 66 40 94 35 f5 74 6b 65 0a bb ab 0b f2 54 39 9d 31 b2 d9 09 08 f0 ce 05 31 8f 9c ca 67 33 5e c4>,
     absValidity: 2018-03-21T19:20:12.476Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.27:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 21 0.3333333333333333 1521573672302
connected to auth! from local port 45364
received auth hello!
{ authId: 502, nonce: <Buffer bb 02 62 ea 58 bb 76 a6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3f c5 41 f8 70 db 65 a2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200600,
  cipherKeyVal: <Buffer d4 d0 f3 49 67 8f a0 44 d2 6e 18 ec e2 2e 0f 91>,
  macKeyVal: <Buffer ff d9 7e 36 14 71 ac 4a f9 e5 a2 9b 0d 38 62 c5 ab 1b b3 51 7f 06 0a a9 24 62 99 e4 ad 5e 3c 94>,
  absValidity: 2018-03-21T19:21:12.525Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.27',
  serverPort: 22100,
  sessionKey: 
   { id: 50200600,
     cipherKeyVal: <Buffer d4 d0 f3 49 67 8f a0 44 d2 6e 18 ec e2 2e 0f 91>,
     macKeyVal: <Buffer ff d9 7e 36 14 71 ac 4a f9 e5 a2 9b 0d 38 62 c5 ab 1b b3 51 7f 06 0a a9 24 62 99 e4 ad 5e 3c 94>,
     absValidity: 2018-03-21T19:21:12.525Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.27:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 22 0.3181818181818182 1521573732362
connected to auth! from local port 45594
received auth hello!
{ authId: 502, nonce: <Buffer c8 8e 75 91 36 8b c7 19> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1e 3d 1e 1b c5 a0 9f 18>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200615,
  cipherKeyVal: <Buffer 5a 8d 45 c0 73 29 75 72 98 b3 61 b1 89 73 56 55>,
  macKeyVal: <Buffer c0 06 ff b5 e7 b5 31 93 ce ee 33 3d 9c 3f 59 d8 99 cb 2e c2 cf cf 61 30 4b f5 d7 da 21 14 3a fb>,
  absValidity: 2018-03-21T19:22:12.599Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.27',
  serverPort: 22100,
  sessionKey: 
   { id: 50200615,
     cipherKeyVal: <Buffer 5a 8d 45 c0 73 29 75 72 98 b3 61 b1 89 73 56 55>,
     macKeyVal: <Buffer c0 06 ff b5 e7 b5 31 93 ce ee 33 3d 9c 3f 59 d8 99 cb 2e c2 cf cf 61 30 4b f5 d7 da 21 14 3a fb>,
     absValidity: 2018-03-21T19:22:12.599Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.27:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 23 0.30434782608695654 1521573792417
connected to auth! from local port 45830
received auth hello!
{ authId: 502, nonce: <Buffer 22 90 ee 85 32 b9 b7 1a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7c a0 1d 1a ce fc 49 4b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200630,
  cipherKeyVal: <Buffer 72 f9 06 02 fd 3a af 72 3e a6 e3 6e a8 8d f2 df>,
  macKeyVal: <Buffer 87 3f 5d 5d cc 2c c0 69 38 67 b2 d6 94 43 56 89 89 e1 f4 f2 88 e8 d2 1a da 1e 66 a7 60 fc 0a b6>,
  absValidity: 2018-03-21T19:23:12.635Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.27',
  serverPort: 22100,
  sessionKey: 
   { id: 50200630,
     cipherKeyVal: <Buffer 72 f9 06 02 fd 3a af 72 3e a6 e3 6e a8 8d f2 df>,
     macKeyVal: <Buffer 87 3f 5d 5d cc 2c c0 69 38 67 b2 d6 94 43 56 89 89 e1 f4 f2 88 e8 d2 1a da 1e 66 a7 60 fc 0a b6>,
     absValidity: 2018-03-21T19:23:12.635Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.27:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 24 0.2916666666666667 1521573852477
connected to auth! from local port 46066
received auth hello!
{ authId: 502, nonce: <Buffer c9 c7 ca 4a 4c 5d a4 54> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6b af 69 fd a7 81 3f 71>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200645,
  cipherKeyVal: <Buffer 76 ea dd 6c 03 f0 86 a1 79 d6 d7 9d b0 6a 06 a9>,
  macKeyVal: <Buffer af f1 76 ed 41 97 7e af ce 01 f5 50 34 73 37 a3 f1 12 d1 7c 5a 9c 5c bd 21 3f 9c 4c 7c 74 5d 8a>,
  absValidity: 2018-03-21T19:24:12.663Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.27',
  serverPort: 22100,
  sessionKey: 
   { id: 50200645,
     cipherKeyVal: <Buffer 76 ea dd 6c 03 f0 86 a1 79 d6 d7 9d b0 6a 06 a9>,
     macKeyVal: <Buffer af f1 76 ed 41 97 7e af ce 01 f5 50 34 73 37 a3 f1 12 d1 7c 5a 9c 5c bd 21 3f 9c 4c 7c 74 5d 8a>,
     absValidity: 2018-03-21T19:24:12.663Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.27:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 25 0.28 1521573912478
connected to auth! from local port 46300
received auth hello!
{ authId: 502, nonce: <Buffer 5d 21 1c 90 9d 99 a2 60> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ee 99 90 dc dd cf aa 66>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200660,
  cipherKeyVal: <Buffer 87 16 4a 7b c3 e2 a6 e5 30 70 af 8f 41 e2 f3 08>,
  macKeyVal: <Buffer 5b 5b ec 91 01 98 63 0e 26 d3 13 bf 6b fb 24 50 f4 82 12 cb a3 6d d1 ec 00 47 84 a4 ed d8 4c 6f>,
  absValidity: 2018-03-21T19:25:12.701Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.27',
  serverPort: 22100,
  sessionKey: 
   { id: 50200660,
     cipherKeyVal: <Buffer 87 16 4a 7b c3 e2 a6 e5 30 70 af 8f 41 e2 f3 08>,
     macKeyVal: <Buffer 5b 5b ec 91 01 98 63 0e 26 d3 13 bf 6b fb 24 50 f4 82 12 cb a3 6d d1 ec 00 47 84 a4 ed d8 4c 6f>,
     absValidity: 2018-03-21T19:25:12.701Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.27:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 26 0.2692307692307692 1521573972538
connected to auth! from local port 46530
received auth hello!
{ authId: 502, nonce: <Buffer b4 6d 11 63 c2 04 4c 67> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e9 5b a1 cc 65 ed e9 af>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200675,
  cipherKeyVal: <Buffer e0 4b 98 1f 98 c7 56 ae f4 0e 22 9e f0 a6 02 9c>,
  macKeyVal: <Buffer f3 bd e4 85 dc bb fb e5 70 c6 44 66 1d 38 06 e7 53 98 45 41 a3 77 68 16 a2 c1 23 d4 c8 48 8a ff>,
  absValidity: 2018-03-21T19:26:12.669Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.27',
  serverPort: 22100,
  sessionKey: 
   { id: 50200675,
     cipherKeyVal: <Buffer e0 4b 98 1f 98 c7 56 ae f4 0e 22 9e f0 a6 02 9c>,
     macKeyVal: <Buffer f3 bd e4 85 dc bb fb e5 70 c6 44 66 1d 38 06 e7 53 98 45 41 a3 77 68 16 a2 c1 23 d4 c8 48 8a ff>,
     absValidity: 2018-03-21T19:26:12.669Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.27:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 27 0.25925925925925924 1521574032589
connected to auth! from local port 46752
received auth hello!
{ authId: 502, nonce: <Buffer 51 20 de ba d6 ae f3 65> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f2 db 7e e7 11 70 8c d9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200690,
  cipherKeyVal: <Buffer fb 8a 67 3b d9 42 d6 3a 27 a0 8d 1f 90 fc 6e d1>,
  macKeyVal: <Buffer 71 5c da 6f 59 f2 be c9 db 6c 1f 45 24 a7 78 38 b0 a7 d9 26 2b 9a 51 09 51 c4 7e 91 89 2c 97 f1>,
  absValidity: 2018-03-21T19:27:12.823Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.27',
  serverPort: 22100,
  sessionKey: 
   { id: 50200690,
     cipherKeyVal: <Buffer fb 8a 67 3b d9 42 d6 3a 27 a0 8d 1f 90 fc 6e d1>,
     macKeyVal: <Buffer 71 5c da 6f 59 f2 be c9 db 6c 1f 45 24 a7 78 38 b0 a7 d9 26 2b 9a 51 09 51 c4 7e 91 89 2c 97 f1>,
     absValidity: 2018-03-21T19:27:12.823Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.27:22100
disconnected from auth
