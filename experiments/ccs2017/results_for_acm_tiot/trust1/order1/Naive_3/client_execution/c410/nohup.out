changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c410.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c410',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 78 44 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521572422965
connected to auth! from local port 55622
received auth hello!
{ authId: 402, nonce: <Buffer 61 07 ca fd 09 7c 4d c9> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer ed 07 47 0f 18 99 51 88>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 20 2f 00 db 76 55 af b4 fd 77 01 2c d6 9f f8 fc>,
  macKeyVal: <Buffer b4 2c bd e1 20 78 fe b4 a6 17 8e ad 95 0b e1 b0 56 6a 86 4b 27 c0 d2 51 95 b3 30 be a1 ec 04 eb>,
  absValidity: 2018-03-20T20:00:23.136Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200254,
  cipherKeyVal: <Buffer 07 44 e6 d1 c0 8c ec 12 c9 45 1f b6 bd 1b e1 71>,
  macKeyVal: <Buffer c7 d9 cf 60 4a 2a 3c c7 f1 08 cf dd 21 4d dd 52 54 57 d5 ed f6 0a 25 cb 9b cd d7 f8 1d 42 d3 f1>,
  absValidity: 2018-03-21T19:00:23.135Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200254,
     cipherKeyVal: <Buffer 07 44 e6 d1 c0 8c ec 12 c9 45 1f b6 bd 1b e1 71>,
     macKeyVal: <Buffer c7 d9 cf 60 4a 2a 3c c7 f1 08 cf dd 21 4d dd 52 54 57 d5 ed f6 0a 25 cb 9b cd d7 f8 1d 42 d3 f1>,
     absValidity: 2018-03-21T19:00:23.135Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer bb 37 dd 7f f5 89 31 12>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:00:24 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521572424830
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521572483023
connected to auth! from local port 55790
received auth hello!
{ authId: 402, nonce: <Buffer 7e 9e 44 b9 7a e4 73 05> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 67 d8 ca 8a ed 07 e2 0b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200261,
  cipherKeyVal: <Buffer eb 18 f8 f0 ef f1 8d a7 87 a8 3b 88 a0 9c d3 6d>,
  macKeyVal: <Buffer b5 05 9e d1 90 cc 99 c9 fd be 7b 55 19 0a 69 74 52 5e 44 91 9b 02 68 be 90 52 5f 1e e3 bf 98 e0>,
  absValidity: 2018-03-21T19:01:23.188Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200261,
     cipherKeyVal: <Buffer eb 18 f8 f0 ef f1 8d a7 87 a8 3b 88 a0 9c d3 6d>,
     macKeyVal: <Buffer b5 05 9e d1 90 cc 99 c9 fd be 7b 55 19 0a 69 74 52 5e 44 91 9b 02 68 be 90 52 5f 1e e3 bf 98 e0>,
     absValidity: 2018-03-21T19:01:23.188Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 3a f1 2d 14 cc b7 99 2d>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:01:24 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521572485110
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521572543073
connected to auth! from local port 56060
received auth hello!
{ authId: 402, nonce: <Buffer 8e 9c 33 e4 b3 2b 5e 93> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7e 3c 19 72 d1 a8 94 a9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200268,
  cipherKeyVal: <Buffer 49 73 89 8a d6 2a ea d9 27 1b b1 9a 04 b6 85 6f>,
  macKeyVal: <Buffer fd 74 b7 9c a7 1f 5a eb 85 67 dc b0 96 1a ad be 92 21 a2 72 42 31 d2 ae c6 0d 4e 39 9b 10 a1 56>,
  absValidity: 2018-03-21T19:02:23.322Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200268,
     cipherKeyVal: <Buffer 49 73 89 8a d6 2a ea d9 27 1b b1 9a 04 b6 85 6f>,
     macKeyVal: <Buffer fd 74 b7 9c a7 1f 5a eb 85 67 dc b0 96 1a ad be 92 21 a2 72 42 31 d2 ae c6 0d 4e 39 9b 10 a1 56>,
     absValidity: 2018-03-21T19:02:23.322Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 79 2d 81 58 a2 b8 17 2a>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:02:24 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521572545188
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521572603113
connected to auth! from local port 56330
received auth hello!
{ authId: 402, nonce: <Buffer 8f 1d 3e 46 06 2f 5a 86> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7a 70 39 df fa 48 ef be>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200275,
  cipherKeyVal: <Buffer 88 01 ee 38 cc ba bf 00 e2 04 d0 a7 c5 a9 ab 6e>,
  macKeyVal: <Buffer 47 5b 3f 21 cb 53 e7 f4 10 42 ba 8e 61 e3 be a1 3b 17 bb 8c 6c cc 06 03 66 f5 68 de ad f9 c4 a9>,
  absValidity: 2018-03-21T19:03:23.334Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200275,
     cipherKeyVal: <Buffer 88 01 ee 38 cc ba bf 00 e2 04 d0 a7 c5 a9 ab 6e>,
     macKeyVal: <Buffer 47 5b 3f 21 cb 53 e7 f4 10 42 ba 8e 61 e3 be a1 3b 17 bb 8c 6c cc 06 03 66 f5 68 de ad f9 c4 a9>,
     absValidity: 2018-03-21T19:03:23.334Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 6a 7b 1d a7 99 81 20 de>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:03:24 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521572605133
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521572663169
connected to auth! from local port 56600
received auth hello!
{ authId: 402, nonce: <Buffer 14 44 fb 68 b3 da a8 5f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 39 6e 71 b2 56 b7 2c cc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200282,
  cipherKeyVal: <Buffer ca 8a 81 ad f4 12 38 22 3b 97 73 65 e1 a2 c1 7f>,
  macKeyVal: <Buffer 1f 31 67 58 2e 38 86 12 27 87 69 e5 4f 78 21 e0 c5 47 89 29 de 6c 88 e9 fa b7 6c fa 1c 78 f7 61>,
  absValidity: 2018-03-21T19:04:23.322Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200282,
     cipherKeyVal: <Buffer ca 8a 81 ad f4 12 38 22 3b 97 73 65 e1 a2 c1 7f>,
     macKeyVal: <Buffer 1f 31 67 58 2e 38 86 12 27 87 69 e5 4f 78 21 e0 c5 47 89 29 de 6c 88 e9 fa b7 6c fa 1c 78 f7 61>,
     absValidity: 2018-03-21T19:04:23.322Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer e4 16 06 85 90 88 c2 41>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:04:24 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521572665333
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521572723225
connected to auth! from local port 56870
received auth hello!
{ authId: 402, nonce: <Buffer 52 1c 1a 9d e5 86 6b eb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 78 3d ed 1e 54 4b 8f 76>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200289,
  cipherKeyVal: <Buffer 00 2b d7 0d 58 20 c7 47 0f f7 f8 ac 95 aa 4d b3>,
  macKeyVal: <Buffer ef 35 43 8f 46 9c 31 a1 60 b4 0c f7 ac ac 25 de e9 5f 5e 05 d4 39 8b 87 bf 40 a1 dd 4d c9 e5 ce>,
  absValidity: 2018-03-21T19:05:23.406Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200289,
     cipherKeyVal: <Buffer 00 2b d7 0d 58 20 c7 47 0f f7 f8 ac 95 aa 4d b3>,
     macKeyVal: <Buffer ef 35 43 8f 46 9c 31 a1 60 b4 0c f7 ac ac 25 de e9 5f 5e 05 d4 39 8b 87 bf 40 a1 dd 4d c9 e5 ce>,
     absValidity: 2018-03-21T19:05:23.406Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 35 71 ef ee 96 3c bf 4e>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:05:24 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521572725302
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521572783269
connected to auth! from local port 57140
received auth hello!
{ authId: 402, nonce: <Buffer ba cb 22 d6 09 83 45 98> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer da b0 bd 67 7a db 09 cf>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200296,
  cipherKeyVal: <Buffer 55 66 6a 30 af ad 77 38 9a 92 f7 b9 91 c9 b1 6d>,
  macKeyVal: <Buffer b7 e5 25 f7 a3 35 9c 33 36 d5 81 70 b5 8d f5 e0 e8 fc d5 37 df 99 11 76 e9 fa 12 7b b3 bf 5d a6>,
  absValidity: 2018-03-21T19:06:23.445Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200296,
     cipherKeyVal: <Buffer 55 66 6a 30 af ad 77 38 9a 92 f7 b9 91 c9 b1 6d>,
     macKeyVal: <Buffer b7 e5 25 f7 a3 35 9c 33 36 d5 81 70 b5 8d f5 e0 e8 fc d5 37 df 99 11 76 e9 fa 12 7b b3 bf 5d a6>,
     absValidity: 2018-03-21T19:06:23.445Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 43 e1 89 88 1a 39 be cd>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:06:24 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521572785352
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521572843290
connected to auth! from local port 57410
received auth hello!
{ authId: 402, nonce: <Buffer ce d6 e3 ce 04 04 75 89> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 73 ad 19 e5 4d ad 42 58>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200303,
  cipherKeyVal: <Buffer d1 3a 2d 18 40 46 8c 0c 89 54 b4 68 46 85 12 05>,
  macKeyVal: <Buffer 37 00 5d c9 b7 e2 12 e3 31 28 7f 61 d9 93 01 7e 93 8c dd c3 61 39 da 38 37 1c 0b 9c 57 4e b9 6e>,
  absValidity: 2018-03-21T19:07:23.525Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200303,
     cipherKeyVal: <Buffer d1 3a 2d 18 40 46 8c 0c 89 54 b4 68 46 85 12 05>,
     macKeyVal: <Buffer 37 00 5d c9 b7 e2 12 e3 31 28 7f 61 d9 93 01 7e 93 8c dd c3 61 39 da 38 37 1c 0b 9c 57 4e b9 6e>,
     absValidity: 2018-03-21T19:07:23.525Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer e5 08 ce 53 89 90 9b ca>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:07:24 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 8 1 1521572845640
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 9 0.8888888888888888 1521572903349
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 10 0.8 1521572963350
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 52570
received auth hello!
{ authId: 502, nonce: <Buffer a3 a6 6b a7 56 87 64 a6> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 11 0.7272727272727273 1521573023357
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 52798
received auth hello!
{ authId: 502, nonce: <Buffer f9 c0 ec 81 45 96 29 47> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 12 0.6666666666666666 1521573083365
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 13 0.6153846153846154 1521573143373
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 55804
received auth hello!
{ authId: 401, nonce: <Buffer c4 3f cd ba ec 80 4a 46> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth401',
     commonName: '10.0.1.1' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth402',
     commonName: '10.0.0.2' },
  serial: '016244C72DA0',
  notBefore: 2018-03-20T18:57:06.000Z,
  notAfter: 2018-03-21T18:58:46.000Z,
  subjectHash: 'de555cae',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '95:CD:E4:15:B9:6C:17:54:BE:65:78:27:97:BD:A5:22:95:F7:27:04',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'B95EF3029A4C4FAE066EFDE0A6119C37979EDB5A64C834CFDC68175183A2CCB6F817A6CEE1A9EF3E562CF75048E8894B6036030296F313DEBF7C1069E42825C46A5F1F6D69FFE10EE6D73B7805503AA7E6A4C2FF62C2E4D5BF7079FBED00C4B24480D5BC43B7B3B042025990D06DEE0A0388CF2AE7F4B313EF564F2EB3931C44FD1DBD6DFA6DA12843C6DBAAE1EFBC5E7EEDA9407AE6D78B6211169F194056CA6F9CD9F20F33FE469D35BCC944D43D2ECB947F73AF95BB5530BFF2A9B92CA16EB949D06EB8218BBBEC8EA009AC9F6C53C626A2796484448AEDAAB3D19834BA2A19D35D0E105AD47B9A6B3E1589517039E098E992676ED418010E608FA312B251',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.1' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 401,
  host: '10.0.1.1',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJExy2gMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDIxETAPBgNVBAMMCDEwLjAuMC4yMB4XDTE4MDMy\nMDE4NTcwNloXDTE4MDMyMTE4NTg0NlowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDQwMTERMA8GA1UEAwwIMTAuMC4xLjEwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQC5XvMCmkxPrgZu/eCmEZw3l57bWmTINM/caBdRg6LMtvgXps7h\nqe8+Viz3UEjoiUtgNgMClvMT3r98EGnkKCXEal8fbWn/4Q7m1zt4BVA6p+akwv9i\nwuTVv3B5++0AxLJEgNW8Q7ezsEICWZDQbe4KA4jPKuf0sxPvVk8us5McRP0dvW36\nbaEoQ8bbquHvvF5+7alAeubXi2IRFp8ZQFbKb5zZ8g8z/kadNbzJRNQ9LsuUf3Ov\nlbtVML/yqbksoW65SdBuuCGLu+yOoAmsn2xTxiaieWSERIrtqrPRmDS6KhnTXQ4Q\nWtR7mms+FYlRcDngmOmSZ27UGAEOYI+jErJRAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQEwDQYJKoZIhvcNAQELBQADggEBAL1++4YVQ8b1jHzb8TObsFDOpugdFIHP\n8D83P3/hBYNvo26azw58Lw9t8YqRHKITUxufoCgBUH3y21qm3F0YosKz6QvvZoe5\n3g7/62TAIQgnTxrDnCjXfbRhRSIfAPLBmDtGkUEd887I2dkPxIZfuF18NvR3gwTF\n03Bb3djQAvbBYA7zLYUCwJAvhsw3A9zhL2Kp/ELaorh9AG64nz4oN6nq9RwHd7Tp\nPcaaLV03zuCAonUvDRMcUlkr0k6Jfrxjc9FFhCBbzF+BnQaClUbLnYes7KnuceAD\nFuOsFNCOd0nJwkzHVkexCgTK9F/EsZh2Wtqq6/1/fTstrQXfVdbyDFg=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 2
to: 3
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 14 0.5714285714285714 1521573203384
connected to auth! from local port 56056
received auth hello!
{ authId: 401, nonce: <Buffer ca 26 5f fd 28 63 0d 92> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 7a 78 c7 d6 13 f8 36 35>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer f9 3d 6f 56 e3 bd ef 49 bc 38 eb 94 05 69 84 fe>,
  macKeyVal: <Buffer 40 d2 c9 6e f1 ae 2e 6b 12 5b 59 7e ae 5c d7 b1 0a 79 34 52 7c f5 4c 15 9e aa 38 5f 4a 36 a6 cd>,
  absValidity: 2018-03-20T20:13:23.556Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100595,
  cipherKeyVal: <Buffer 9a b3 9f be 0b e1 b6 22 9d c4 b7 1c 16 46 a3 8a>,
  macKeyVal: <Buffer c5 5c 82 f6 7f 5e 49 ac 64 6b c0 97 6a 30 c0 12 9c 7f 14 03 57 e0 6e c4 07 bb 80 09 80 99 69 27>,
  absValidity: 2018-03-21T19:13:23.555Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40100595,
     cipherKeyVal: <Buffer 9a b3 9f be 0b e1 b6 22 9d c4 b7 1c 16 46 a3 8a>,
     macKeyVal: <Buffer c5 5c 82 f6 7f 5e 49 ac 64 6b c0 97 6a 30 c0 12 9c 7f 14 03 57 e0 6e c4 07 bb 80 09 80 99 69 27>,
     absValidity: 2018-03-21T19:13:23.555Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer d3 10 29 5e aa 08 b8 48>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.15:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 15 0.5333333333333333 1521573263394
connected to auth! from local port 56326
received auth hello!
{ authId: 401, nonce: <Buffer 37 10 2b 38 75 d0 81 5e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 26 5e 2f 65 c4 e1 04 ba>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100607,
  cipherKeyVal: <Buffer 6e 17 70 28 49 75 5a c8 a5 5c bd 3a 36 5c d9 c6>,
  macKeyVal: <Buffer 98 d1 1b 2b 1e a4 2c 99 10 e8 0d dd b4 dc 01 a4 21 e9 f6 38 84 7b 88 0a cd ab 3b 34 f3 f5 0e b0>,
  absValidity: 2018-03-21T19:14:23.600Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40100607,
     cipherKeyVal: <Buffer 6e 17 70 28 49 75 5a c8 a5 5c bd 3a 36 5c d9 c6>,
     macKeyVal: <Buffer 98 d1 1b 2b 1e a4 2c 99 10 e8 0d dd b4 dc 01 a4 21 e9 f6 38 84 7b 88 0a cd ab 3b 34 f3 f5 0e b0>,
     absValidity: 2018-03-21T19:14:23.600Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer a5 3b 4e d8 99 f8 e3 3f>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.15:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 16 0.5 1521573323401
connected to auth! from local port 56594
received auth hello!
{ authId: 401, nonce: <Buffer bf 8a ae db 54 6f c5 b5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 13 5e a8 78 1b 03 d5 23>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100619,
  cipherKeyVal: <Buffer de 6d 21 24 57 4e 3f 48 1c 8a 7e 2c 32 0e ca c7>,
  macKeyVal: <Buffer 44 89 da a5 e5 d5 ab 66 25 58 28 e0 c9 3e 50 5f 74 c6 7e 14 0b 3a 57 10 02 cd d9 65 04 f9 0c 72>,
  absValidity: 2018-03-21T19:15:23.686Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40100619,
     cipherKeyVal: <Buffer de 6d 21 24 57 4e 3f 48 1c 8a 7e 2c 32 0e ca c7>,
     macKeyVal: <Buffer 44 89 da a5 e5 d5 ab 66 25 58 28 e0 c9 3e 50 5f 74 c6 7e 14 0b 3a 57 10 02 cd d9 65 04 f9 0c 72>,
     absValidity: 2018-03-21T19:15:23.686Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 17 0d f1 dc b1 9c 58 c4>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.15:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 17 0.47058823529411764 1521573383412
connected to auth! from local port 56866
received auth hello!
{ authId: 401, nonce: <Buffer 4b bd 00 15 c2 77 7d eb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1b 1c 9a 50 e5 dc f2 7c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100632,
  cipherKeyVal: <Buffer 6d c9 e9 70 71 b5 c8 ac ed 37 5e 80 ae 37 d1 06>,
  macKeyVal: <Buffer 87 ef cf de 8e 13 8c 57 ba 8d 5e 53 ee 0f 5a 18 c9 8f 8d c3 b4 2f 79 c3 50 e2 e3 da 98 a0 d7 e7>,
  absValidity: 2018-03-21T19:16:23.550Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40100632,
     cipherKeyVal: <Buffer 6d c9 e9 70 71 b5 c8 ac ed 37 5e 80 ae 37 d1 06>,
     macKeyVal: <Buffer 87 ef cf de 8e 13 8c 57 ba 8d 5e 53 ee 0f 5a 18 c9 8f 8d c3 b4 2f 79 c3 50 e2 e3 da 98 a0 d7 e7>,
     absValidity: 2018-03-21T19:16:23.550Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer ce c7 cf 1d 39 06 b6 55>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.15:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 18 0.4444444444444444 1521573443421
connected to auth! from local port 57110
received auth hello!
{ authId: 401, nonce: <Buffer 7b 7f 3b 34 72 2e 30 e2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3e 35 69 6c 3c 73 91 e8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100646,
  cipherKeyVal: <Buffer f4 c1 0f 26 d6 86 7c eb a2 c0 95 9b f9 3b 4d fd>,
  macKeyVal: <Buffer 24 a5 3f 0e 05 50 85 05 4d 61 ca 1c a8 93 5f b2 0c 1c 9d 58 4c 03 95 57 8b 2d 27 c4 b5 dd cf 15>,
  absValidity: 2018-03-21T19:17:23.567Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40100646,
     cipherKeyVal: <Buffer f4 c1 0f 26 d6 86 7c eb a2 c0 95 9b f9 3b 4d fd>,
     macKeyVal: <Buffer 24 a5 3f 0e 05 50 85 05 4d 61 ca 1c a8 93 5f b2 0c 1c 9d 58 4c 03 95 57 8b 2d 27 c4 b5 dd cf 15>,
     absValidity: 2018-03-21T19:17:23.567Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer ca 90 61 f2 fd dc a6 cc>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.15:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 19 0.42105263157894735 1521573503429
connected to auth! from local port 57346
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 20 0.4 1521573563439
connected to auth! from local port 57570
received auth hello!
{ authId: 401, nonce: <Buffer f7 d9 9d 98 08 ee f2 23> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 26 8b 64 7f 8d 00 cc e3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100670,
  cipherKeyVal: <Buffer bd a9 e6 34 d4 12 c2 3c 10 ae 0d d4 38 e6 a0 86>,
  macKeyVal: <Buffer ea d8 b2 82 2f 45 47 9f eb 23 da b5 69 d6 21 10 73 3b 97 29 46 4d 2c c8 f7 32 98 54 43 00 d4 f2>,
  absValidity: 2018-03-21T19:19:23.740Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40100670,
     cipherKeyVal: <Buffer bd a9 e6 34 d4 12 c2 3c 10 ae 0d d4 38 e6 a0 86>,
     macKeyVal: <Buffer ea d8 b2 82 2f 45 47 9f eb 23 da b5 69 d6 21 10 73 3b 97 29 46 4d 2c c8 f7 32 98 54 43 00 d4 f2>,
     absValidity: 2018-03-21T19:19:23.740Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 9b ac 84 8a 01 8d e3 9a>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.15:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 21 0.38095238095238093 1521573623450
connected to auth! from local port 57794
received auth hello!
{ authId: 401, nonce: <Buffer 22 ee 0d 80 cb a7 f0 96> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3d 87 28 23 a9 c1 7f 40>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100682,
  cipherKeyVal: <Buffer 5d 56 b6 4d 64 78 45 80 70 a4 7d c3 3c 4b 12 b6>,
  macKeyVal: <Buffer db da c3 a9 e6 93 dc 60 2d 98 5b 4b a1 91 4f 31 5f be 78 e0 93 19 d8 46 98 75 12 1c fd 6f 6d 8e>,
  absValidity: 2018-03-21T19:20:23.852Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40100682,
     cipherKeyVal: <Buffer 5d 56 b6 4d 64 78 45 80 70 a4 7d c3 3c 4b 12 b6>,
     macKeyVal: <Buffer db da c3 a9 e6 93 dc 60 2d 98 5b 4b a1 91 4f 31 5f be 78 e0 93 19 d8 46 98 75 12 1c fd 6f 6d 8e>,
     absValidity: 2018-03-21T19:20:23.852Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 68 7b b0 c1 8e b1 47 ea>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.15:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 22 0.36363636363636365 1521573683457
connected to auth! from local port 58022
received auth hello!
{ authId: 401, nonce: <Buffer ba a9 e3 ac 20 da d6 34> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 09 3d 35 43 a3 4a 7b 60>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100695,
  cipherKeyVal: <Buffer 60 64 b5 69 42 2e b3 aa 6b b9 f9 86 06 10 0e d2>,
  macKeyVal: <Buffer 55 7b ea ab 78 61 5f 0f 9f 0c a3 5f 23 d0 1c 41 5b 90 e1 76 e9 a6 2f 90 15 44 6f ba 31 d8 2f 9b>,
  absValidity: 2018-03-21T19:21:23.911Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40100695,
     cipherKeyVal: <Buffer 60 64 b5 69 42 2e b3 aa 6b b9 f9 86 06 10 0e d2>,
     macKeyVal: <Buffer 55 7b ea ab 78 61 5f 0f 9f 0c a3 5f 23 d0 1c 41 5b 90 e1 76 e9 a6 2f 90 15 44 6f ba 31 d8 2f 9b>,
     absValidity: 2018-03-21T19:21:23.911Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer a0 0a d3 70 4c ff 17 de>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.15:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 23 0.34782608695652173 1521573743467
connected to auth! from local port 58244
received auth hello!
{ authId: 401, nonce: <Buffer 09 43 da 5d 09 a3 a0 17> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3d 1e c4 eb 61 bb aa 53>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100709,
  cipherKeyVal: <Buffer 7f d1 5d 4d b6 f6 47 aa c8 36 92 ee 1c e8 0a 45>,
  macKeyVal: <Buffer 4d 7e 48 54 7f 21 5d 39 03 6a 0d e1 de 00 93 9b dd 0c 6b 89 9e 61 a4 0f 35 27 51 17 39 53 28 74>,
  absValidity: 2018-03-21T19:22:26.007Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40100709,
     cipherKeyVal: <Buffer 7f d1 5d 4d b6 f6 47 aa c8 36 92 ee 1c e8 0a 45>,
     macKeyVal: <Buffer 4d 7e 48 54 7f 21 5d 39 03 6a 0d e1 de 00 93 9b dd 0c 6b 89 9e 61 a4 0f 35 27 51 17 39 53 28 74>,
     absValidity: 2018-03-21T19:22:26.007Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 72 06 77 ab d4 20 f3 1a>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.15:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 24 0.3333333333333333 1521573803474
connected to auth! from local port 58480
received auth hello!
{ authId: 401, nonce: <Buffer c6 2a 6e 7d 7d 57 fc 41> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b9 b8 ee b2 c2 52 fd dc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100723,
  cipherKeyVal: <Buffer 64 34 53 e8 d7 bc 37 59 20 db 8f 05 17 33 27 c9>,
  macKeyVal: <Buffer 3e 23 a3 ec 42 99 15 41 24 2e 60 17 bc 12 fd e0 30 0d 13 1b 96 2a f6 e2 24 d7 04 f4 2d 24 bd ea>,
  absValidity: 2018-03-21T19:23:26.055Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40100723,
     cipherKeyVal: <Buffer 64 34 53 e8 d7 bc 37 59 20 db 8f 05 17 33 27 c9>,
     macKeyVal: <Buffer 3e 23 a3 ec 42 99 15 41 24 2e 60 17 bc 12 fd e0 30 0d 13 1b 96 2a f6 e2 24 d7 04 f4 2d 24 bd ea>,
     absValidity: 2018-03-21T19:23:26.055Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer f4 dd bb 32 b2 5f 4d df>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.15:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 25 0.32 1521573863482
connected to auth! from local port 58716
received auth hello!
{ authId: 401, nonce: <Buffer f1 98 d7 29 e7 7a 96 25> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0e be 48 9d 81 a3 85 6e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100737,
  cipherKeyVal: <Buffer 26 4f a5 cc fb 3c aa ec a3 9d ad 7a 44 84 d7 5f>,
  macKeyVal: <Buffer e6 3d 9f 0b aa 7f 95 43 a8 7f 9b 3a 47 4a 7c b8 bb 70 1b bf 4e 7e f9 54 91 8d cc 24 6a 47 35 7d>,
  absValidity: 2018-03-21T19:24:26.073Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40100737,
     cipherKeyVal: <Buffer 26 4f a5 cc fb 3c aa ec a3 9d ad 7a 44 84 d7 5f>,
     macKeyVal: <Buffer e6 3d 9f 0b aa 7f 95 43 a8 7f 9b 3a 47 4a 7c b8 bb 70 1b bf 4e 7e f9 54 91 8d cc 24 6a 47 35 7d>,
     absValidity: 2018-03-21T19:24:26.073Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 7e 0d 4c f5 4d d6 d6 c1>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.15:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 26 0.3076923076923077 1521573923489
connected to auth! from local port 58952
received auth hello!
{ authId: 401, nonce: <Buffer 28 61 f8 1f 0f 4b 45 fb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f8 ec 55 ea 0b ba 09 2d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100750,
  cipherKeyVal: <Buffer 5c b2 4c 1b 72 7b b3 de 79 dd eb c9 cd a2 2f 74>,
  macKeyVal: <Buffer 80 ce ba 9d ec e0 10 0d b6 02 9f c4 b5 fc a0 39 29 d8 2c b2 99 bb 36 0e 15 f8 a5 40 5c c9 97 1a>,
  absValidity: 2018-03-21T19:25:26.125Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40100750,
     cipherKeyVal: <Buffer 5c b2 4c 1b 72 7b b3 de 79 dd eb c9 cd a2 2f 74>,
     macKeyVal: <Buffer 80 ce ba 9d ec e0 10 0d b6 02 9f c4 b5 fc a0 39 29 d8 2c b2 99 bb 36 0e 15 f8 a5 40 5c c9 97 1a>,
     absValidity: 2018-03-21T19:25:26.125Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 56 17 3c a8 99 c6 04 ca>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.15:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 27 0.2962962962962963 1521573983494
connected to auth! from local port 59178
received auth hello!
{ authId: 401, nonce: <Buffer 68 63 07 a9 a8 f1 3f 0a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 78 61 44 48 e7 a3 d1 59>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100763,
  cipherKeyVal: <Buffer 61 3f 8c 86 bd b6 b8 87 d5 19 3c c7 a7 7a 5f fb>,
  macKeyVal: <Buffer 51 dc 72 6b d0 7c 76 54 31 db 4a 45 df 40 c3 07 a7 24 32 0b 42 51 ef f7 33 22 02 64 f5 0d 23 d8>,
  absValidity: 2018-03-21T19:26:26.205Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40100763,
     cipherKeyVal: <Buffer 61 3f 8c 86 bd b6 b8 87 d5 19 3c c7 a7 7a 5f fb>,
     macKeyVal: <Buffer 51 dc 72 6b d0 7c 76 54 31 db 4a 45 df 40 c3 07 a7 24 32 0b 42 51 ef f7 33 22 02 64 f5 0d 23 d8>,
     absValidity: 2018-03-21T19:26:26.205Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer d2 e2 4a e0 5c 53 ac 1e>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.15:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 28 0.2857142857142857 1521574043502
connected to auth! from local port 59410
received auth hello!
{ authId: 401, nonce: <Buffer 58 22 4f 33 c5 4f f6 3b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cc 07 3e 4f b3 36 e6 f1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100776,
  cipherKeyVal: <Buffer ae 54 16 ae 9e 44 d8 38 5f 78 d0 45 cd 6c 3c 16>,
  macKeyVal: <Buffer fa 51 82 c1 4f 54 1d dc 43 7f 57 c6 25 9e 32 9c 45 e3 06 71 33 3a 2a 30 68 ac e3 64 67 0b ff c3>,
  absValidity: 2018-03-21T19:27:24.229Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40100776,
     cipherKeyVal: <Buffer ae 54 16 ae 9e 44 d8 38 5f 78 d0 45 cd 6c 3c 16>,
     macKeyVal: <Buffer fa 51 82 c1 4f 54 1d dc 43 7f 57 c6 25 9e 32 9c 45 e3 06 71 33 3a 2a 30 68 ac e3 64 67 0b ff c3>,
     absValidity: 2018-03-21T19:27:24.229Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 84 5d 89 a2 c8 02 08 fc>
switching to HANDSHAKE_1_SENT
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 19:27:26 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 9 28 0.32142857142857145 1521574046757
