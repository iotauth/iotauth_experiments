changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s519.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's519',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 76 31 ... > }
Handler: listening on port 22100
s519:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400080
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47494
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400081
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47504
received auth hello!
{ authId: 504, nonce: <Buffer bc d0 d8 9b eb 79 68 0a> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 58 04 36 29 39 57 f2 f0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 63 dc a2 c0 9a 6e 88 ac 11 ef 8c c9 2a 10 9b 43>,
  macKeyVal: <Buffer b7 e2 3b cc e0 07 ba 63 77 46 0d 3f a4 86 c8 a7 68 f5 62 11 55 44 ac d4 e3 20 6f d4 02 43 c1 de>,
  absValidity: 2018-03-20T20:02:23.380Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e9 35 b7 c0 09 9d e4 05>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e9 35 b7 c0 09 9d e4 05> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.86:56020',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
received auth hello!
{ authId: 504, nonce: <Buffer 59 2d fd 8f 0c 28 86 19> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer d1 17 a0 ed 64 73 71 21>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 73 0b a8 ec d0 c4 c6 83 b0 de 4b f1 11 a2 e7 99>,
  macKeyVal: <Buffer a0 e1 04 b3 92 f5 25 47 85 05 d5 86 90 5c a6 46 ed 60 2c 71 41 cf e0 d8 80 30 a4 14 a9 5d 64 4b>,
  absValidity: 2018-03-20T20:02:24.332Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ee a2 47 8c 1f 45 8e 02>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ee a2 47 8c 1f 45 8e 02> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.87:57296',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400086
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47764
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400087
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47774
received auth hello!
{ authId: 504, nonce: <Buffer f2 4c 2f db 1c db 53 54> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d7 37 3c 99 8e a6 85 d8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fa 65 17 cf 1a d5 1c 7d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer fa 65 17 cf 1a d5 1c 7d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.86:56290',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
received auth hello!
{ authId: 504, nonce: <Buffer 78 b5 2a df fe a2 74 bf> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d9 9e 94 25 a2 26 c1 2c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b4 df 6c 51 24 9d bc fb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b4 df 6c 51 24 9d bc fb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.87:57566',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400092
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48034
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400093
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48044
received auth hello!
{ authId: 504, nonce: <Buffer f6 16 59 c5 42 66 42 bb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ed 6b 64 cf e9 63 1b 2d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2d 7b dd 01 e7 39 37 84>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 2d 7b dd 01 e7 39 37 84> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.86:56560',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
received auth hello!
{ authId: 504, nonce: <Buffer ac c3 c9 3b 40 2e 1f 58> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 76 2f 1d 7f 7c 77 6f 3e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 84 e8 71 85 76 48 f2 2d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 84 e8 71 85 76 48 f2 2d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.87:57836',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400098
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48304
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400099
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48314
received auth hello!
{ authId: 504, nonce: <Buffer c8 f3 3e 58 fb b4 0f 28> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 11 75 41 94 db a6 3f 53>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 59 97 6a 4c 3c c9 a7 04>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 59 97 6a 4c 3c c9 a7 04> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.86:56830',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
received auth hello!
{ authId: 504, nonce: <Buffer 6f d7 95 f2 f2 ec 19 ba> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 86 11 a8 44 0f 69 7e c8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c8 35 04 4f 20 c5 bf 5a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c8 35 04 4f 20 c5 bf 5a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.87:58106',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400104
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48574
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400105
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48584
received auth hello!
{ authId: 504, nonce: <Buffer 92 03 16 8f 09 95 1c 74> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7c 7c a6 3e bf 5a 8e 52>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 64 7e 63 c3 a3 a2 92 02>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 64 7e 63 c3 a3 a2 92 02> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.86:57100',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
received auth hello!
{ authId: 504, nonce: <Buffer 05 d9 3a 5d 9a 2b 65 c2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 98 50 7f 9b af 5c 36 69>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7b 6a 38 11 43 ca 7c 1a>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 7b 6a 38 11 43 ca 7c 1a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.87:58376',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400110
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48838
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400111
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48854
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer a1 26 66 8b 24 09 ff 0f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 58 3d 56 2b 5b 8e 67 74>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 05 03 6a 82 55 aa 03 ee>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 05 03 6a 82 55 aa 03 ee> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.86:57364',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
