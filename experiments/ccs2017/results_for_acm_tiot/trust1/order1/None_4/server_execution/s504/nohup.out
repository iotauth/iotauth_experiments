changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s504.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's504',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 32 2b ... > }
Handler: listening on port 22100
s504:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101205
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38576
received auth hello!
{ authId: 501, nonce: <Buffer 97 ec 09 ee e8 80 ab 28> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 8e fa b0 d3 10 2e 55 39>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 4b 89 6d 9d 06 a4 39 ff c2 eb b2 03 70 b9 3b 97>,
  macKeyVal: <Buffer 0d b5 8e 91 cf 17 27 c4 01 94 6a 8f ec 06 5b b3 8b 31 89 91 9d 7b aa cc 4f 4f 7e a1 a5 1e b0 8b>,
  absValidity: 2018-03-22T00:20:02.110Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e3 9c d5 95 c1 5e 27 87>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e3 9c d5 95 c1 5e 27 87> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.67:59458',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101213
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38832
received auth hello!
{ authId: 501, nonce: <Buffer 2f c5 1f 36 00 20 25 48> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d8 bd 54 ea f2 d5 93 f4>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bb db 72 a3 8e 55 57 9c>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer bb db 72 a3 8e 55 57 9c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.67:59714',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101221
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39102
received auth hello!
{ authId: 501, nonce: <Buffer fa 4b d2 f9 13 5a 5c 6e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7a fe 6c 47 ce f2 bf 03>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 84 86 8c 06 13 9d 0b 9d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 84 86 8c 06 13 9d 0b 9d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.67:59984',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101229
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39372
received auth hello!
{ authId: 501, nonce: <Buffer b2 6c 20 b3 28 75 19 e5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 53 ea 62 59 fe 55 ef 1c>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e5 32 2c 91 d7 7a 82 62>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e5 32 2c 91 d7 7a 82 62> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.67:60254',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101237
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39642
received auth hello!
{ authId: 501, nonce: <Buffer fb 07 a3 5f e6 12 cf 18> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f2 1b b7 12 5c 22 99 d2>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1b 81 84 ca d6 3d 48 e9>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 1b 81 84 ca d6 3d 48 e9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.67:60524',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101245
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39912
received auth hello!
{ authId: 501, nonce: <Buffer db dd 0e 90 09 9b ed 02> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 01 30 ea d6 57 51 06 6c>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 40 f5 4f 6f 50 48 d9 e0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 40 f5 4f 6f 50 48 d9 e0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.67:60794',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101253
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40182
received auth hello!
{ authId: 501, nonce: <Buffer 43 9d 63 b0 73 4b dc 59> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 41 29 07 d2 81 d4 90 71>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 18 3e d9 dd 3e 63 51 93>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 18 3e d9 dd 3e 63 51 93> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.67:32832',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
