changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s505.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's505',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 71 79 ... > }
Handler: listening on port 22100
s505:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101206
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50228
received auth hello!
{ authId: 501, nonce: <Buffer a8 06 30 1e c2 39 dc c2> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer ff be d8 50 e2 4f f8 7e>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer d4 8d b2 1f 48 19 83 32 d4 65 22 08 fa 83 b5 d9>,
  macKeyVal: <Buffer e0 06 1b 37 87 ad 35 b3 13 87 93 08 d4 b2 2b cc e5 73 b5 1a a7 ff 4f b4 4b 7e 05 91 eb 09 c9 82>,
  absValidity: 2018-03-22T00:20:05.471Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fb 05 63 1a f8 2d f7 58>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer fb 05 63 1a f8 2d f7 58> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.68:49514',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101207
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50240
received auth hello!
{ authId: 501, nonce: <Buffer 2d ef 17 8a f4 1a 77 a1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3f 73 ea 00 86 61 e7 50>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f7 c4 e7 f5 74 5e 30 ec>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f7 c4 e7 f5 74 5e 30 ec> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.69:38186',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101214
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50490
received auth hello!
{ authId: 501, nonce: <Buffer 83 4a ca 19 31 42 12 50> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7c b7 c9 21 78 e2 54 38>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b6 3a c5 59 9d 1c 41 2f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b6 3a c5 59 9d 1c 41 2f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.68:49776',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101215
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50508
received auth hello!
{ authId: 501, nonce: <Buffer 3e 7f 10 42 98 b4 4e fe> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f6 ff e9 7c 91 82 42 a7>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 45 69 7c df 09 bf da 9f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 45 69 7c df 09 bf da 9f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.69:38450',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101222
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50760
received auth hello!
{ authId: 501, nonce: <Buffer e1 9f fd 2f 2e e3 98 31> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0b 4f 88 25 0a f3 de f1>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 45 a3 28 45 b6 61 7f 32>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 45 a3 28 45 b6 61 7f 32> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.68:50046',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101223
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50778
received auth hello!
{ authId: 501, nonce: <Buffer 0b 48 ea b5 6a ec 58 ff> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 15 36 65 e9 e5 fa 57 a8>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 09 e7 32 64 39 23 66 af>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 09 e7 32 64 39 23 66 af> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.69:38724',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101230
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51030
received auth hello!
{ authId: 501, nonce: <Buffer 39 b0 ef 98 a2 d1 96 04> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 24 a3 81 c2 ac 40 2f 76>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0f 1a 25 e8 1c f7 ea a4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0f 1a 25 e8 1c f7 ea a4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.68:50316',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101231
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51048
received auth hello!
{ authId: 501, nonce: <Buffer 7a ef 59 ea b3 11 7f 86> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer da 50 29 be cc 7f 99 3d>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 74 03 e4 46 27 17 e5 0d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 74 03 e4 46 27 17 e5 0d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.69:38994',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101238
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51300
received auth hello!
{ authId: 501, nonce: <Buffer cb 7a 8b 42 c3 54 ad f2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3b e3 e2 8a 4c 09 a2 58>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer df 8c bf b2 b2 ec d6 5f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer df 8c bf b2 b2 ec d6 5f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.68:50586',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101239
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51316
received auth hello!
{ authId: 501, nonce: <Buffer 06 a2 77 90 2b 61 59 8a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cf dc d3 a6 27 8b c3 82>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e1 53 ac 98 fe 1d cf 2f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e1 53 ac 98 fe 1d cf 2f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.69:39260',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101246
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51570
received auth hello!
{ authId: 501, nonce: <Buffer 3c 07 e0 5f 92 b0 a4 90> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 11 f5 ab a5 74 fe 36 88>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 92 bf 9a 9b 29 f5 5b 96>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 92 bf 9a 9b 29 f5 5b 96> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.68:50856',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101247
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51588
received auth hello!
{ authId: 501, nonce: <Buffer 3c 08 5e 0c 9c ea fb a5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9a 07 fa 69 f5 11 a6 b7>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fd 50 b5 8a d9 d2 d6 33>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer fd 50 b5 8a d9 d2 d6 33> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.69:39534',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101254
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51840
received auth hello!
{ authId: 501, nonce: <Buffer 3a 40 eb f8 ec 1c 00 d5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 93 f8 6a ae 46 4a 89 50>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0e 78 c0 00 d4 43 e2 39>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0e 78 c0 00 d4 43 e2 39> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.68:51126',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101255
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51856
received auth hello!
{ authId: 501, nonce: <Buffer c6 13 9e 36 47 32 8f 86> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a5 16 89 ea 36 02 7a 97>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ae 35 53 5d 07 07 fd ed>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ae 35 53 5d 07 07 fd ed> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.69:39800',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
