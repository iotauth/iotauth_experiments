changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s407.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's407',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 6f 66 ... > }
Handler: listening on port 22100
s407:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200779
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38306
received auth hello!
{ authId: 402, nonce: <Buffer d4 aa f7 48 05 0a a8 81> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer d0 c4 ff 62 ae 77 69 69>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 53 b3 18 62 75 81 70 0e de a4 91 20 0f 1c 54 6d>,
  macKeyVal: <Buffer 00 9a 2e 91 79 c2 73 1c 20 b8 8d ff 2c cd 15 2c a5 4c a1 db f7 66 66 28 cb 5c 0b 16 00 fc 05 cc>,
  absValidity: 2018-03-22T00:19:09.498Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 96 ad ee ce 07 01 5e d7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 96 ad ee ce 07 01 5e d7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.51:38702',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200786
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38468
received auth hello!
{ authId: 402, nonce: <Buffer 61 8e ad 1d 02 8b e1 a9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 87 9a 55 cd fa 98 54 3b>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 71 42 9c 06 89 82 67 fe>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 71 42 9c 06 89 82 67 fe> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.51:38864',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200793
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38736
received auth hello!
{ authId: 402, nonce: <Buffer 8b e6 29 82 8b dd 02 f0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2f 03 4d c1 6d 8f eb ba>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9b 4a 00 0c a0 aa cb 9d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9b 4a 00 0c a0 aa cb 9d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.51:39132',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200800
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39006
received auth hello!
{ authId: 402, nonce: <Buffer 62 69 be 72 5c bc 25 fe> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 40 22 6d 02 fc de e3 60>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d5 56 17 87 ef 24 5a 90>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d5 56 17 87 ef 24 5a 90> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.51:39402',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200807
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39276
received auth hello!
{ authId: 402, nonce: <Buffer ec df 54 dc d5 9e c3 bd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 94 ef f4 71 b4 09 13 e2>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer af 9c be f9 17 a9 04 8b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer af 9c be f9 17 a9 04 8b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.51:39672',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200814
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39546
received auth hello!
{ authId: 402, nonce: <Buffer 48 34 83 59 c7 b6 c9 fa> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a8 77 2a ef cb 82 c2 aa>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e2 52 9e cc 06 31 05 2b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e2 52 9e cc 06 31 05 2b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.51:39942',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200821
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39816
received auth hello!
{ authId: 402, nonce: <Buffer 06 1f bf 95 a5 00 fa 2f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 75 cb e9 c9 23 f5 e5 a5>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e1 6d 6b 26 9d 91 20 85>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e1 6d 6b 26 9d 91 20 85> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.51:40212',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200828
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40086
received auth hello!
{ authId: 402, nonce: <Buffer 9d f2 41 aa 2c 4a 6c 1a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 65 9a f2 a4 b9 e1 48 05>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d8 0d 4e 97 63 66 28 a0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d8 0d 4e 97 63 66 28 a0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.51:40482',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
