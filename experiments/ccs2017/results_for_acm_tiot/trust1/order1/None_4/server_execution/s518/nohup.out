changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s518.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's518',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 67 49 42 41 41 4b 43 41 51 45 41 33 62 ... > }
Handler: listening on port 22100
s518:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400341
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44028
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer f4 ff b8 dd f7 8b 4b a3> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 18 81 da 74 20 0f 97 eb>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer ee 06 b9 e4 1e 6f 9d 59 f5 e7 50 f6 a7 25 b5 0d>,
  macKeyVal: <Buffer 3c d1 4d a4 89 c7 eb 2b 79 16 fd d0 bb 2b fb c3 74 e4 f4 64 b8 ac ce 74 92 3e db 43 9d d6 f7 39>,
  absValidity: 2018-03-22T00:21:03.378Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 09 61 98 60 8a 21 44 6d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 09 61 98 60 8a 21 44 6d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.84:53370',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400343
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44060
received auth hello!
{ authId: 504, nonce: <Buffer 24 e9 56 cb f3 4f 90 58> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 65 85 d2 24 b8 5d ee 35>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 36 8a be 31 3d 26 96 9a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 36 8a be 31 3d 26 96 9a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.85:40624',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400347
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44298
received auth hello!
{ authId: 504, nonce: <Buffer d9 38 b9 23 2d ad a6 e8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 72 73 55 c6 2d 48 f5 ae>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 76 fe 14 09 c3 4c 14 c5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 76 fe 14 09 c3 4c 14 c5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.84:53640',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400349
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44330
received auth hello!
{ authId: 504, nonce: <Buffer ac 76 e5 a0 aa eb 2f 9a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 71 b6 ef 70 c5 7a ce cd>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b3 6a 00 2d a4 d7 d2 a7>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b3 6a 00 2d a4 d7 d2 a7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.85:40894',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400353
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44568
received auth hello!
{ authId: 504, nonce: <Buffer 15 fd 5a 61 f9 e4 bd 07> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 53 9c c5 55 2e 60 d4 f9>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9e 3e 53 61 0e b5 9f e2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9e 3e 53 61 0e b5 9f e2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.84:53910',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400355
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44600
received auth hello!
{ authId: 504, nonce: <Buffer c5 30 f3 e2 1d b6 60 12> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a4 89 67 65 71 92 d3 31>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 65 81 13 60 22 9a 03 b3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 65 81 13 60 22 9a 03 b3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.85:41164',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400359
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44838
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer 0d c5 d8 b0 61 91 2c b5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f1 24 db c4 06 36 aa 1d>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d8 d6 9b b2 74 60 de 35>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d8 d6 9b b2 74 60 de 35> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.84:54180',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400361
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44870
received auth hello!
{ authId: 504, nonce: <Buffer 31 a3 95 e2 df 0a f8 a5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 40 cf 80 70 be a6 cb fe>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 02 2e eb 20 85 68 17 21>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 02 2e eb 20 85 68 17 21> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.85:41434',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400365
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45108
received auth hello!
{ authId: 504, nonce: <Buffer 09 34 8d 32 c1 e2 d2 a3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 51 be ef 31 41 35 83 b4>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 81 b5 a4 dd 7b c0 f6 61>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 81 b5 a4 dd 7b c0 f6 61> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.84:54450',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400367
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45140
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer 39 5f 18 0c 27 e0 6a 96> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b5 9d 17 8a ce 71 f5 93>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1b 1a 73 d9 6a 14 dd 63>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1b 1a 73 d9 6a 14 dd 63> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.85:41704',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400371
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45378
received auth hello!
{ authId: 504, nonce: <Buffer c1 2c 1c 6b 93 6c 4f fa> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 62 1e f4 bb ea 83 c3 4e>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4a 53 c7 6a 23 a7 e8 00>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4a 53 c7 6a 23 a7 e8 00> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.84:54720',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400373
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45410
received auth hello!
{ authId: 504, nonce: <Buffer ab 6f 54 8b e4 3f 7d 45> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2d a1 f2 ba 06 88 44 73>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6c f9 10 d4 a1 f4 b0 f4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6c f9 10 d4 a1 f4 b0 f4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.85:41974',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
