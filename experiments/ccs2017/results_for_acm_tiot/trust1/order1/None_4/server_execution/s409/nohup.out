changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s409.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's409',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 67 49 42 41 41 4b 43 41 51 45 41 6f 6c ... > }
Handler: listening on port 22100
s409:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200783
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45456
received auth hello!
{ authId: 402, nonce: <Buffer 3a b4 2e 89 91 2b c0 c8> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 01 08 99 39 37 54 4b b1>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer bd 4a a6 68 3a 0b 72 be 0c 1f b5 9d 24 6f ab 61>,
  macKeyVal: <Buffer bf 3c 35 c8 3b da 0e 64 73 dc ef f6 95 d8 b7 ff c6 6c 7c eb e5 ac fd 34 c6 03 cf 3d b6 df 99 7f>,
  absValidity: 2018-03-22T00:19:25.449Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8e db 32 d5 7f d2 78 b1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8e db 32 d5 7f d2 78 b1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.55:34624',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200790
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45642
received auth hello!
{ authId: 402, nonce: <Buffer 22 4b 61 85 f4 1d eb b8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7d 29 83 96 10 c4 99 c1>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e2 e7 f5 01 0a 0b 69 c5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e2 e7 f5 01 0a 0b 69 c5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.55:34810',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200797
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45914
received auth hello!
{ authId: 402, nonce: <Buffer f6 1e 56 cc 48 29 67 92> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 94 16 c6 4e d8 c4 07 24>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7b 95 fb a7 eb c9 2e d4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 7b 95 fb a7 eb c9 2e d4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.55:35082',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200804
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46184
received auth hello!
{ authId: 402, nonce: <Buffer ed 75 ca 70 ef 0d 8e 23> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 80 fc c1 71 a2 39 3e 6a>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ca 62 17 55 a9 e6 de 46>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ca 62 17 55 a9 e6 de 46> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.55:35352',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200811
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46454
received auth hello!
{ authId: 402, nonce: <Buffer cf 9b 03 3c 9c 78 45 49> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8c 78 d8 37 0d ce 0e fa>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6b df 17 fc 8c 16 40 40>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 6b df 17 fc 8c 16 40 40> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.55:35622',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200818
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46724
received auth hello!
{ authId: 402, nonce: <Buffer fc 80 09 b4 48 d0 b3 73> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1a 70 00 a8 41 b4 7e 15>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1e f7 56 10 1c 30 93 8f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1e f7 56 10 1c 30 93 8f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.55:35892',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200825
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46994
received auth hello!
{ authId: 402, nonce: <Buffer 17 60 f1 6b 4e 55 6e c0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer de aa 49 f9 32 55 24 7f>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5e b8 3a f9 b5 6c b9 e7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5e b8 3a f9 b5 6c b9 e7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.55:36162',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
