changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s410.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's410',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 35 5a ... > }
Handler: listening on port 22100
s410:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200781
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54410
received auth hello!
{ authId: 402, nonce: <Buffer 45 37 3a 05 51 32 8a cb> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer b7 99 0f 1d 43 1d 84 ab>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer c8 89 dc 8d 67 2f b8 cf 42 c3 9b 86 27 d2 b0 1b>,
  macKeyVal: <Buffer 4b ba 26 58 ef 72 cc 2d 34 6f 2a 1f 75 4a ca 66 48 21 3e ad 87 64 32 ff 72 55 cc 96 ac 54 94 fb>,
  absValidity: 2018-03-22T00:19:17.444Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2b 9f cf d4 79 94 46 1b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 2b 9f cf d4 79 94 46 1b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.53:57074',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200788
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54584
received auth hello!
{ authId: 402, nonce: <Buffer b2 51 70 44 b2 35 3b 35> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f2 66 62 cd 9c 8d 0f ff>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ca 73 7d 62 d6 c6 cb 97>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ca 73 7d 62 d6 c6 cb 97> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.53:57248',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200795
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54856
received auth hello!
{ authId: 402, nonce: <Buffer 2c 2d 12 56 78 81 af 8a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8a ad 0f 2c b8 e9 d1 b0>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6a b5 b4 66 16 c8 21 1d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 6a b5 b4 66 16 c8 21 1d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.53:57520',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200802
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55126
received auth hello!
{ authId: 402, nonce: <Buffer 0f 55 d0 a3 9b f5 ca 29> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3b 3e c3 33 60 f1 1b fe>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a0 6d 41 24 74 df cd 88>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a0 6d 41 24 74 df cd 88> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.53:57790',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200809
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55396
received auth hello!
{ authId: 402, nonce: <Buffer 18 75 90 b4 90 b0 85 4b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 06 32 81 45 69 2c 91 f0>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 41 07 c5 09 6c 8f 1e ea>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 41 07 c5 09 6c 8f 1e ea> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.53:58060',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200816
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55666
received auth hello!
{ authId: 402, nonce: <Buffer 33 02 85 3e 4c 42 b7 96> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 30 d1 59 46 53 0a 9e 72>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ff fe a0 c9 57 6e 7a de>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ff fe a0 c9 57 6e 7a de> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.53:58330',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200823
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55936
received auth hello!
{ authId: 402, nonce: <Buffer c8 b9 c3 d2 0b 1e 28 fe> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fc 27 4d 3d e9 4e 20 e1>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 54 e4 37 0d 5b 4d 37 e5>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 54 e4 37 0d 5b 4d 37 e5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.53:58600',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200830
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56202
received auth hello!
{ authId: 402, nonce: <Buffer d2 61 58 65 95 dd fa c0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b7 84 ae 4a cf 1d e7 b3>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e4 e8 51 82 a2 58 f9 07>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e4 e8 51 82 a2 58 f9 07> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.53:58866',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
