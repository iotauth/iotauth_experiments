changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s416.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's416',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 51 49 42 41 41 4b 43 41 51 45 41 35 7a ... > }
Handler: listening on port 22100
s416:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301245
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49082
received auth hello!
{ authId: 403, nonce: <Buffer cd b3 6d 01 d6 05 78 ac> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 19 e6 e7 df 86 ee 07 65>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 72 e0 b6 d5 56 99 a1 70 1f 7a 8f 8a ec 02 b7 97>,
  macKeyVal: <Buffer 19 04 1f 3b 7b 22 fb 78 ec 14 58 0f 4c 1a 38 cd 94 17 2d 7f 74 cb e7 e5 f1 62 b5 5f e9 76 91 58>,
  absValidity: 2018-03-22T00:19:40.384Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c7 b1 37 ad 62 ce f6 6e>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c7 b1 37 ad 62 ce f6 6e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.60:52814',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301246
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49088
received auth hello!
{ authId: 403, nonce: <Buffer ef 29 84 c5 57 cd 50 1a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2e 1b 98 61 00 91 31 6c>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 66 ab 66 77 7c 77 42 b0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 66 ab 66 77 7c 77 42 b0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.61:47144',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301251
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49294
received auth hello!
{ authId: 403, nonce: <Buffer cb 62 2d af f9 da 4e 8b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 39 71 79 f9 dc f5 d0 89>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3e db 70 c3 ce dd 39 b2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3e db 70 c3 ce dd 39 b2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.60:53026',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301252
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49310
received auth hello!
{ authId: 403, nonce: <Buffer 57 de 38 62 79 ef ae 1a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fd 2e 31 2a 76 f8 44 7f>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3f 94 8f 6a 89 e1 8d 7c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3f 94 8f 6a 89 e1 8d 7c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.61:47366',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301257
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49566
received auth hello!
{ authId: 403, nonce: <Buffer a8 21 fe ae 4a 77 56 2c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 15 64 bd 5a d4 08 6f 3a>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bd 49 0f 22 9f cc 42 16>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bd 49 0f 22 9f cc 42 16> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.60:53298',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301258
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49582
received auth hello!
{ authId: 403, nonce: <Buffer e3 c6 06 86 1c 02 38 cb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ba 98 5c 42 af 3e 6e 3b>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cd 8e e3 d5 d0 05 ea ae>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer cd 8e e3 d5 d0 05 ea ae> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.61:47638',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301263
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49836
received auth hello!
{ authId: 403, nonce: <Buffer e5 37 f7 be 3c e0 21 b9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a2 1a 77 65 a2 4c 91 be>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5c be f3 1a 66 82 d0 ee>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 5c be f3 1a 66 82 d0 ee> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.60:53568',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301264
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49852
received auth hello!
{ authId: 403, nonce: <Buffer 4e 3d 02 fd 45 ce 23 e3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer be 95 b0 72 f3 f6 5e 4a>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ca 84 39 c3 51 53 62 13>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ca 84 39 c3 51 53 62 13> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.61:47908',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301269
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50106
received auth hello!
{ authId: 403, nonce: <Buffer 72 b2 75 42 f3 14 15 5c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c6 55 54 a6 88 52 4a db>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a2 01 1d 2f c8 38 82 fc>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer a2 01 1d 2f c8 38 82 fc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.60:53838',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301270
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50122
received auth hello!
{ authId: 403, nonce: <Buffer 5e 6b f9 76 20 ba bf 38> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ff 17 61 6f d0 6e 2a 69>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cc 25 25 61 a1 11 aa 64>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer cc 25 25 61 a1 11 aa 64> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.61:48178',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301275
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50376
received auth hello!
{ authId: 403, nonce: <Buffer 03 d7 08 cd b5 35 34 e3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer dd 89 a4 89 9c e8 a2 e6>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 48 94 d2 31 cc 16 c9 99>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 48 94 d2 31 cc 16 c9 99> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.60:54108',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301276
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50392
received auth hello!
{ authId: 403, nonce: <Buffer 0f d0 cf 1e ed 86 a4 7b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ed 9a 63 39 70 63 22 06>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5a 7a 32 33 9a 02 5c 46>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5a 7a 32 33 9a 02 5c 46> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.61:48448',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301281
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50646
received auth hello!
{ authId: 403, nonce: <Buffer 7e ab af ed 19 25 81 c9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e2 2d 6b 06 50 54 87 80>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 56 1b 0c a6 9c 40 fd 1a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 56 1b 0c a6 9c 40 fd 1a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.60:54378',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301282
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50662
received auth hello!
{ authId: 403, nonce: <Buffer a8 98 33 24 cc 68 8a e6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c3 c1 3d 33 3e df 19 14>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b2 ce ea 03 26 b3 44 c8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b2 ce ea 03 26 b3 44 c8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.61:48718',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301287
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50908
received auth hello!
{ authId: 403, nonce: <Buffer d8 86 64 f3 6f 37 13 db> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d2 52 2c b4 9e b1 90 f0>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 03 65 d4 a1 6b 3c 28 8f>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 03 65 d4 a1 6b 3c 28 8f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.60:54640',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301288
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50926
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
