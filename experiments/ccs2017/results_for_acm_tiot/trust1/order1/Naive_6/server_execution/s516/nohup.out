changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s516.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's516',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 76 4b ... > }
Handler: listening on port 22100
s516:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300593
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40608
received auth hello!
{ authId: 503, nonce: <Buffer 2b d1 71 33 22 15 a6 8c> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 6d 9e 31 0e 7f ab d1 73>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 26 f0 80 18 9e e6 2f e6 75 39 a3 76 02 9f a2 f2>,
  macKeyVal: <Buffer a4 36 77 0a 55 6d b3 f1 4d 54 d5 4b 1f 77 8f f3 4a 36 e2 dd fc 64 f0 f0 f8 52 fd a4 2d 35 97 1f>,
  absValidity: 2018-03-20T23:10:50.635Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fb 52 aa 9a d7 ef a8 fd>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fb 52 aa 9a d7 ef a8 fd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.82:49448',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300598
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40878
received auth hello!
{ authId: 503, nonce: <Buffer 63 8d c2 ad ff 65 2a ab> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer eb ac e0 b1 59 a1 92 df>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c9 3c 99 48 f2 3c 66 0c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c9 3c 99 48 f2 3c 66 0c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.82:49718',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300603
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41148
received auth hello!
{ authId: 503, nonce: <Buffer 83 06 be b6 20 66 44 d2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 59 64 ca be 69 27 60 50>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4b bd ec 84 99 cb 30 04>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4b bd ec 84 99 cb 30 04> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.82:49988',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300608
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41418
received auth hello!
{ authId: 503, nonce: <Buffer 30 d0 a3 d3 07 88 cc bc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5e 02 b5 7a d9 9f 0e b3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3c da 56 36 21 5a 12 c0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3c da 56 36 21 5a 12 c0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.82:50258',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300613
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41688
received auth hello!
{ authId: 503, nonce: <Buffer 2d 6f 02 1e b6 b0 37 38> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3b ac 95 66 89 ee a6 05>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 97 7d 76 67 1c a5 6d cb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 97 7d 76 67 1c a5 6d cb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.82:50528',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300618
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41958
received auth hello!
{ authId: 503, nonce: <Buffer 83 b5 c0 0a 93 ca 75 96> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 37 ee ad 10 91 00 fc 1e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 60 aa 7a fd 5f 9e e5 0e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 60 aa 7a fd 5f 9e e5 0e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.82:50798',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300623
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42212
received auth hello!
{ authId: 503, nonce: <Buffer 09 c8 9d b0 6d 1c 83 91> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5d 54 ec bc 9d 75 50 7f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7f c4 9d bf fb 66 95 02>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 7f c4 9d bf fb 66 95 02> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.82:51054',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
