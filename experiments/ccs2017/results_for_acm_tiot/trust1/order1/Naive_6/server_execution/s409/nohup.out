changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s409.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's409',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 79 64 ... > }
Handler: listening on port 22100
s409:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200422
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53990
received auth hello!
{ authId: 402, nonce: <Buffer 11 1f 14 40 56 30 42 69> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 8e 3c f9 0a 93 dc 34 cb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer d4 57 f5 30 ba 94 fc 1f 1f 28 ac 1c 3c 6a 71 46>,
  macKeyVal: <Buffer b0 e6 0d 15 77 d1 2e 31 aa 75 84 ac e7 30 e9 b6 9e 67 2e 6c 97 ff 2d 0f aa e4 1b 0a 9f 7f 76 77>,
  absValidity: 2018-03-20T23:09:23.679Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 26 b7 e7 1b 70 8d 3d 75>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 26 b7 e7 1b 70 8d 3d 75> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.55:43158',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200429
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54176
received auth hello!
{ authId: 402, nonce: <Buffer e3 1f e2 99 94 de d0 1f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f6 6a a3 6a e7 87 5f f0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 08 35 fc 76 0e dc a7 bb>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 08 35 fc 76 0e dc a7 bb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.55:43344',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200436
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54446
received auth hello!
{ authId: 402, nonce: <Buffer 97 64 25 03 28 b2 06 8a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 69 3b c6 db b6 2c 0d 08>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bf 9f 3c f4 15 1a 08 8d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bf 9f 3c f4 15 1a 08 8d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.55:43614',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200443
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54716
received auth hello!
{ authId: 402, nonce: <Buffer b3 2c 37 4f 5a 0d 90 96> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9f 6d d9 92 08 83 54 b4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer dd fe 3f bd 2f 42 4a 77>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer dd fe 3f bd 2f 42 4a 77> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.55:43884',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200450
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54986
received auth hello!
{ authId: 402, nonce: <Buffer 6d 87 34 6f be 7c b8 46> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f5 f4 68 05 d9 03 aa 39>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9e 91 e2 e5 56 ab 21 f7>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 9e 91 e2 e5 56 ab 21 f7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.55:44154',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200457
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55256
received auth hello!
{ authId: 402, nonce: <Buffer 5c b6 72 82 8b d7 c4 c0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3e 7f 7c 0b 38 0d f4 d5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 13 13 3a 7c be 0b da d7>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 13 13 3a 7c be 0b da d7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.55:44424',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200464
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55526
received auth hello!
{ authId: 402, nonce: <Buffer 9d fd 01 80 8a b0 b7 9d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ef 55 d0 93 bb 98 52 27>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4c 94 78 db 9e 58 fb 98>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4c 94 78 db 9e 58 fb 98> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.55:44694',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
