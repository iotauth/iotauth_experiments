changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s513.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's513',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 51 49 42 41 41 4b 43 41 51 45 41 33 43 ... > }
Handler: listening on port 22100
s513:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300590
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57376
received auth hello!
{ authId: 502, nonce: <Buffer c0 9c 81 c8 0c 85 5a 2b> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 26 28 d0 79 8f 3c 5f 13>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer ef f8 1b a5 bc 7e aa 04 65 91 82 c5 61 f2 62 6f>,
  macKeyVal: <Buffer 93 9a 83 0e 45 e1 6e 00 cf 38 c2 67 65 76 e1 c7 2e d7 f3 a1 f8 6e 15 7c 27 6d b2 b9 db 8d 51 6b>,
  absValidity: 2018-03-20T23:10:41.041Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 05 3c b4 b2 a2 71 35 fb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 05 3c b4 b2 a2 71 35 fb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.79:42862',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300595
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57646
received auth hello!
{ authId: 502, nonce: <Buffer c1 57 bb b3 67 ef 7b 8e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d5 77 22 a3 94 36 0d 2b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5b 38 f3 fb 70 12 7c df>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5b 38 f3 fb 70 12 7c df> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.79:43132',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300600
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57916
received auth hello!
{ authId: 502, nonce: <Buffer b3 8a 8e 85 71 75 ab d7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1b 42 a4 0f ce 92 f7 76>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 10 80 f4 a4 e6 b1 7c 57>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 10 80 f4 a4 e6 b1 7c 57> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.79:43402',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300605
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58186
received auth hello!
{ authId: 502, nonce: <Buffer 4e 82 47 3a 5e 77 c4 56> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ac bb 7b 64 7c dc 47 19>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 31 94 f6 0d bc 7b fb d1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 31 94 f6 0d bc 7b fb d1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.79:43672',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300610
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58456
received auth hello!
{ authId: 502, nonce: <Buffer 79 b9 2a ec 95 88 00 8c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fc 8d c5 e5 1c fa 4f 9a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e5 7a d3 03 9f 68 c0 2b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e5 7a d3 03 9f 68 c0 2b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.79:43942',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300615
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58726
received auth hello!
{ authId: 502, nonce: <Buffer 73 54 de 31 ce e8 2a f0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b8 c6 41 6e 3d 3f 68 96>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3f 2c e8 91 49 34 13 22>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 3f 2c e8 91 49 34 13 22> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.79:44212',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300620
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58992
received auth hello!
{ authId: 502, nonce: <Buffer cb 79 80 27 cb 34 42 bb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ae d9 b7 5c cf 68 ee 0f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 96 56 a3 1e 65 7e 6a d1>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 96 56 a3 1e 65 7e 6a d1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.79:44478',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201422
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59720
received auth hello!
{ authId: 502, nonce: <Buffer ae 0c e1 9d b6 77 c0 e3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 76 7a 48 10 8e f3 de 83>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e8 72 80 8d 6a cb d6 81>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e8 72 80 8d 6a cb d6 81> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.79:45204',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201440
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59974
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer c5 16 1e 23 e8 a9 a5 3a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d2 fc 48 3a 17 ac ee 5a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fe 4d ab d2 96 cf e1 62>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer fe 4d ab d2 96 cf e1 62> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.79:45460',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201604
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33750
received auth hello!
{ authId: 502, nonce: <Buffer 29 47 95 b4 19 9a d6 b7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 42 4c e3 3c 21 16 57 d1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7e cb 6a 18 bc 1d a4 55>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 7e cb 6a 18 bc 1d a4 55> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.79:47468',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201617
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33892
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 58 6b 0a dd 14 e3 56 c6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 68 e0 a8 c2 58 62 6e 5d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e6 61 22 e4 7e c0 f4 80>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e6 61 22 e4 7e c0 f4 80> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.79:47610',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201628
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34014
received auth hello!
{ authId: 502, nonce: <Buffer 9d bf 1d a3 72 7f bc 73> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8c 35 7f d2 c0 7f 07 29>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 70 91 fe 55 10 a2 c6 a2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 70 91 fe 55 10 a2 c6 a2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.79:47732',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
