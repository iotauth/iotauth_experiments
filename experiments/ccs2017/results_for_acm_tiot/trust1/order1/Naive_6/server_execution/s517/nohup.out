changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s517.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's517',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 67 49 42 41 41 4b 43 41 51 45 41 74 70 ... > }
Handler: listening on port 22100
s517:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300594
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56232
received auth hello!
{ authId: 503, nonce: <Buffer e6 6f 5a 51 53 f3 0d da> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 66 a7 d4 88 3f 82 df a6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer f3 f7 0d 33 bc fa 1f ce bd 44 1f bb b0 97 e4 e0>,
  macKeyVal: <Buffer 86 0d ba d6 a3 ab e3 ed 21 0d 41 45 bb 30 52 90 8e 22 e2 50 35 1b ba 76 3d 43 a4 76 f6 1a e5 69>,
  absValidity: 2018-03-20T23:10:53.889Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 93 10 11 7a 2c 10 f7 d0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 93 10 11 7a 2c 10 f7 d0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.83:50698',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300599
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56504
received auth hello!
{ authId: 503, nonce: <Buffer ad bf 2f 07 a0 e3 ab 07> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 34 cb 23 92 4e cc e1 95>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 92 50 c0 f0 f7 f4 90 bb>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 92 50 c0 f0 f7 f4 90 bb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.83:50968',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300604
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56774
received auth hello!
{ authId: 503, nonce: <Buffer c8 57 07 9c 92 ff 79 40> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6b 5a 80 c4 dd 86 b8 1e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6c 5d 4a a2 6f b5 c2 aa>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 6c 5d 4a a2 6f b5 c2 aa> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.83:51240',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300609
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57042
received auth hello!
{ authId: 503, nonce: <Buffer c3 70 31 1a 7d d5 45 96> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 60 f7 29 5e 1f 21 62 25>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 62 07 d0 91 12 e2 fa a9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 62 07 d0 91 12 e2 fa a9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.83:51508',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300614
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57312
received auth hello!
{ authId: 503, nonce: <Buffer f7 dd f0 4d 2e 5e b5 13> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b4 3c 82 36 bc 77 22 84>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d6 27 c7 b9 f2 1e 5f e2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d6 27 c7 b9 f2 1e 5f e2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.83:51778',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300619
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57584
received auth hello!
{ authId: 503, nonce: <Buffer b8 05 ab 8b fc db 9c f4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 43 5e 4a ed ae 4e 68 e7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 77 7e bf d5 e3 9a f2 8d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 77 7e bf d5 e3 9a f2 8d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.83:52050',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
