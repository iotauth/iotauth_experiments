changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s507.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's507',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 35 53 ... > }
Handler: listening on port 22100
s507:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100617
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47906
received auth hello!
{ authId: 501, nonce: <Buffer 49 33 3a c0 18 2b 85 1d> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 06 c7 68 62 05 0a da e7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 93 91 dd 55 e9 9b 01 31 70 10 60 3c 18 9e db 36>,
  macKeyVal: <Buffer ca 6d 1b 6c ec 41 c0 5b ac e2 6c 56 17 d7 21 87 c7 f7 cb d6 83 90 88 18 ae 37 6f 2e 86 45 47 ad>,
  absValidity: 2018-03-20T23:10:14.504Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 73 42 38 c4 2c cd ef 73>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 73 42 38 c4 2c cd ef 73> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.71:33344',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100625
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48176
received auth hello!
{ authId: 501, nonce: <Buffer a7 ff 65 fa 32 c4 58 19> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 46 60 19 27 5c 52 03 65>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 81 c3 5c f2 05 96 c5 0a>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 81 c3 5c f2 05 96 c5 0a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.71:33614',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100633
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48446
received auth hello!
{ authId: 501, nonce: <Buffer 7a ed 37 9f e5 8f 00 6a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 88 09 fd 91 50 2e e2 10>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 99 44 82 9d c4 15 35 b1>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 99 44 82 9d c4 15 35 b1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.71:33884',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100641
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48716
received auth hello!
{ authId: 501, nonce: <Buffer 22 69 b9 ac 65 97 e6 37> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5f bc ea 79 cb 5d 55 9f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 91 d7 23 64 ad 9b 63 19>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 91 d7 23 64 ad 9b 63 19> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.71:34154',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100649
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48986
received auth hello!
{ authId: 501, nonce: <Buffer 05 7a 4f 72 13 e3 94 f6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 17 1c 06 5e 9a fe 60 05>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 82 91 c4 a7 af 54 66 e9>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 82 91 c4 a7 af 54 66 e9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.71:34424',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100657
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49256
received auth hello!
{ authId: 501, nonce: <Buffer 73 77 67 0b 66 b7 27 79> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cd e5 e0 fa 54 0c f2 c1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 38 f4 82 cd a4 10 0d 9d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 38 f4 82 cd a4 10 0d 9d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.71:34694',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100665
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49526
received auth hello!
{ authId: 501, nonce: <Buffer dd f5 57 f2 78 b4 49 d2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 36 19 26 d0 0f 30 57 35>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 04 53 15 08 97 2a 40 38>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 04 53 15 08 97 2a 40 38> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.71:34964',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201414
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201430
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in server - details: handshake2 timed out...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in server - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in server - details: Error occurred in migration request: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201451
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 45216
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 2d 65 08 e1 95 17 08 45> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '016245740808',
  notBefore: 2018-03-20T22:05:54.000Z,
  notAfter: 2018-03-21T22:07:34.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'E4:19:6D:0C:8B:16:48:A2:32:B6:94:73:F6:80:86:72:13:AA:3E:3D',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'E40B9EF20959AA49D02016EC2E9896074EE0818689EAD7319ECC8ED8C9557412ED46C95E67464598F6233ECEB8BF25A876F0D30B65CED2B1FED8D1F07CF9042FD7F86E3B637BE17FBFD7C9F0DB5850835170B354A52C175B769A37BA578F965436FF29BCFD54C5D4E939E02214503C8A69FFBBF0EC06657DF9498BE98DEB26B62E1453817F6DFAE9B50EE21C5A643FF0292539838A682562303CB77FC6028B22B30B78957E4F78E539103F991928681EBF3100D31960F43F8ECFC6C2F3063B353E92BFFEF77A49BBCBF417864AE8169AA061F590E5FB3393A4592EFA1100FC186B95B83724CA0B11D8BC02BC9BD4F9E08552DE2D1EB0EE0E866E41A520730E6F',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJFdAgIMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDMy\nMDIyMDU1NFoXDTE4MDMyMTIyMDczNFowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDkC57yCVmqSdAgFuwumJYHTuCBhonq1zGezI7YyVV0Eu1GyV5n\nRkWY9iM+zri/Jah28NMLZc7Ssf7Y0fB8+QQv1/huO2N74X+/18nw21hQg1Fws1Sl\nLBdbdpo3ulePllQ2/ym8/VTF1Ok54CIUUDyKaf+78OwGZX35SYvpjesmti4UU4F/\nbfrptQ7iHFpkP/ApJTmDimglYjA8t3/GAosiswt4lX5PeOU5ED+ZGShoHr8xANMZ\nYPQ/js/GwvMGOzU+kr/+93pJu8v0F4ZK6BaaoGH1kOX7M5OkWS76EQD8GGuVuDck\nygsR2LwCvJvU+eCFUt4tHrDuDoZuQaUgcw5vAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBABkJcVLNsxiUWt25hTnwKEx7IA6XcBdq\nQAG5AQhTIOW7Dy3BCfN8WaAdvH2bBAdeBUGoge6adhSadohUK/dBWzdfL1zKcXQ8\nt8riR0jbgml5opFtx57BaKJUWeVwvWoj4kouLbEalRJw/EuULcxV4+2A1n6Q+q3I\nqrLJBmIRounZCERGRmOwXgkQ/kIEdgSsHQmOqQ1Vs6Fc4jmsyIWkAGiGoWsdRs33\nCc+Ls/p3Qf+m6jz5zrzelh5dAsNBC1hRc3Z5O1fHDPAJ8Ak8YOWhflE+vHQKt2dt\nEAoR7vwzF2xK/1u19vbMdzwqAOiZGFvuXqg5WBgHciMzXbSKh6gYx1I=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 1
to: 2
disconnected from auth
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201500
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45936
received auth hello!
{ authId: 502, nonce: <Buffer 85 27 6e 16 09 b4 fa 1a> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer fb 03 01 ea d2 88 58 6a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer f6 e0 b0 f3 67 36 15 9b 63 ec 38 20 9b 00 f1 b2>,
  macKeyVal: <Buffer cf c8 a1 ec 67 91 6f 6b 96 62 f7 ef 16 d5 07 33 82 f7 a7 a2 63 a2 38 b1 af 43 9d 9a d2 3c cf 57>,
  absValidity: 2018-03-20T23:26:29.128Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e0 79 1e 23 ec c3 43 54>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e0 79 1e 23 ec c3 43 54> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.71:36886',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201532
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46272
received auth hello!
{ authId: 502, nonce: <Buffer 9d 77 a5 ed d8 16 36 16> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f3 5a 4e 39 f3 a7 ef b0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d9 f2 23 df a8 79 bc ee>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d9 f2 23 df a8 79 bc ee> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.71:37222',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201549
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46442
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 87 4e 5d cf ed d2 ae 9f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d7 8e 08 b7 14 5b ee 23>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d0 fc c2 d7 1a 88 66 9e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d0 fc c2 d7 1a 88 66 9e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.71:37392',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201564
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46600
received auth hello!
{ authId: 502, nonce: <Buffer f5 0d 5e 26 21 1b 17 4f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 59 da 62 97 4e b0 f5 21>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 37 6c 4f ba 2e 0a 70 3c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 37 6c 4f ba 2e 0a 70 3c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.71:37550',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201575
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46728
received auth hello!
{ authId: 502, nonce: <Buffer 10 a5 51 37 1c 3a c1 c6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ef 9e 53 9c 87 4d 6a 02>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1c 19 d7 76 05 27 ba 1c>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 1c 19 d7 76 05 27 ba 1c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.71:37676',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201589
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46884
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201599
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47026
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201611
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47168
received auth hello!
{ authId: 502, nonce: <Buffer 41 cf cf 98 d0 d2 07 9d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8e 0e 61 95 63 7a aa c4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 00 0f 8a 4b f5 e6 fd 1e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 00 0f 8a 4b f5 e6 fd 1e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.71:38116',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201643
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47522
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer d8 e0 ae d3 6e f5 49 74> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2f d7 56 d8 35 68 b5 9d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e2 17 1d 87 c7 e5 59 39>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e2 17 1d 87 c7 e5 59 39> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.71:38472',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
