changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s413.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's413',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 51 49 42 41 41 4b 43 41 51 45 41 76 38 ... > }
Handler: listening on port 22100
s413:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300602
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47932
received auth hello!
{ authId: 403, nonce: <Buffer 20 64 88 c2 3e 01 02 3b> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 8d 96 48 08 d6 67 ce 2c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 39 fe 3d f3 d8 74 88 e8 e2 70 b7 f2 72 3b 57 7a>,
  macKeyVal: <Buffer 9a 8b 33 11 29 f0 e3 2a 28 24 0e 3c 6a 28 8c 95 03 15 8a 2f 8e 61 51 f5 18 b1 6f 38 fc fc 40 2d>,
  absValidity: 2018-03-20T23:09:30.434Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 17 fa 9f 3a c0 b4 eb 6e>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 17 fa 9f 3a c0 b4 eb 6e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.58:54792',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300608
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48136
received auth hello!
{ authId: 403, nonce: <Buffer 41 72 8b 2e ec e9 e9 c7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 11 14 b5 a1 35 95 02 eb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 84 d8 aa 6b aa 58 b8 49>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 84 d8 aa 6b aa 58 b8 49> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.58:54996',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300614
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48406
received auth hello!
{ authId: 403, nonce: <Buffer af 2a af 0c ae ac 09 cd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d8 9c c4 2b aa cb 42 77>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0d f9 41 65 4b 79 b7 63>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0d f9 41 65 4b 79 b7 63> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.58:55266',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300620
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48676
received auth hello!
{ authId: 403, nonce: <Buffer c8 c3 8c df 58 6a 19 5a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 96 c4 04 82 f6 6b 6e b0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ee bb d6 ae af 50 3a 82>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ee bb d6 ae af 50 3a 82> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.58:55536',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300626
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48946
received auth hello!
{ authId: 403, nonce: <Buffer 5f 92 6f b7 56 38 13 30> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 52 01 37 1a 31 99 86 14>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e7 b0 8a 27 2c f0 7d ca>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e7 b0 8a 27 2c f0 7d ca> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.58:55806',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300632
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49216
received auth hello!
{ authId: 403, nonce: <Buffer 09 f8 b0 6e e7 97 cb 30> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b6 45 7b 02 9a 3d ca 8e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 99 1c 33 95 03 86 37 8a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 99 1c 33 95 03 86 37 8a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.58:56076',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300638
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49486
received auth hello!
{ authId: 403, nonce: <Buffer 17 b0 d6 50 3e 06 a4 05> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a9 0b d0 d5 e1 24 ef f7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fc 08 7c 66 2b 01 7e 11>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fc 08 7c 66 2b 01 7e 11> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.58:56346',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300644
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49752
received auth hello!
{ authId: 403, nonce: <Buffer a0 fb 4c 85 74 b0 da b9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c7 c9 8d fd cb 2f 3c 2b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6b 63 b2 e8 19 9e 6e 86>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 6b 63 b2 e8 19 9e 6e 86> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.58:56612',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
