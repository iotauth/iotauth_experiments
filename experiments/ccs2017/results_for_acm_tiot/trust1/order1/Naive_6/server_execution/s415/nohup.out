changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s415.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's415',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 6f 70 ... > }
Handler: listening on port 22100
s415:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300603
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49910
received auth hello!
{ authId: 403, nonce: <Buffer b1 5a b3 66 8c 7e b4 43> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer fb fb be 03 2e 70 ae 40>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer d5 5c 58 7b c2 1b 7c 43 a7 ce 63 b5 ef ce de 22>,
  macKeyVal: <Buffer 06 c8 82 f5 9b d6 29 47 ca 84 38 da 6c 30 82 30 34 9e 58 3d bb f4 b7 3a 01 e5 46 26 09 a0 35 5d>,
  absValidity: 2018-03-20T23:09:34.345Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 72 71 89 9b 8d 08 66 11>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 72 71 89 9b 8d 08 66 11> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.59:42652',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300609
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50120
received auth hello!
{ authId: 403, nonce: <Buffer c0 03 e5 8b 53 1b d1 c0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2e 3c 15 a6 b6 99 89 12>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 15 b8 97 c7 34 74 e1 51>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 15 b8 97 c7 34 74 e1 51> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.59:42860',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300615
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50390
received auth hello!
{ authId: 403, nonce: <Buffer 68 25 c5 e8 ec 0f cf 44> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7c f9 1f ad cc 18 80 c2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 10 80 a3 e4 3c ba 2c 2b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 10 80 a3 e4 3c ba 2c 2b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.59:43130',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300621
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50660
received auth hello!
{ authId: 403, nonce: <Buffer 43 82 f5 10 04 11 f3 0f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b6 02 25 58 58 84 03 ba>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9c 1a 9b 61 36 52 67 5c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9c 1a 9b 61 36 52 67 5c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.59:43400',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300627
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50930
received auth hello!
{ authId: 403, nonce: <Buffer 33 dc 84 c9 85 d8 df ee> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9c d9 6b c1 9c 16 98 09>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bc 19 b9 df 0d 8d 5a b4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bc 19 b9 df 0d 8d 5a b4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.59:43672',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300633
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51200
received auth hello!
{ authId: 403, nonce: <Buffer 3a f1 2f a9 38 47 9c 88> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a6 85 58 17 39 5e 04 2f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0c dd 94 10 d2 15 3c 08>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0c dd 94 10 d2 15 3c 08> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.59:43940',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300639
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51470
received auth hello!
{ authId: 403, nonce: <Buffer b3 a4 3c a5 35 03 46 5f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 09 ac f1 5e c0 44 b7 4f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2c 8f 76 e3 4e 61 27 03>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2c 8f 76 e3 4e 61 27 03> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.59:44210',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300645
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51736
received auth hello!
{ authId: 403, nonce: <Buffer a5 63 89 cd 77 7d ed ae> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 53 02 91 7c 1e da ac bd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer eb eb 7a a1 ad 59 66 42>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer eb eb 7a a1 ad 59 66 42> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.59:44478',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
