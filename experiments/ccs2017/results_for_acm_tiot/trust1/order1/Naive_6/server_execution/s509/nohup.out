changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s509.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's509',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 7a 79 ... > }
Handler: listening on port 22100
s509:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201344
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57434
received auth hello!
{ authId: 502, nonce: <Buffer ee 08 33 f6 6b f7 fb 62> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 41 d7 30 b6 13 c7 7d a9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 2f 5f 39 88 0b 87 26 33 72 c7 0d bd 70 43 a1 d2>,
  macKeyVal: <Buffer bf 1a 31 98 4d 0d 96 cc 53 f5 fe 3e bb b4 33 2f 66 31 96 81 ae 52 ef b4 7d d8 7b c5 13 af cc c5>,
  absValidity: 2018-03-20T23:10:20.070Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f7 ab 75 bb da cc 20 2f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f7 ab 75 bb da cc 20 2f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.73:46414',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201351
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57704
received auth hello!
{ authId: 502, nonce: <Buffer f7 10 5c 04 4f b4 3c 58> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4b 07 84 a0 37 bf f7 21>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d9 94 c1 5d 82 3d 3f c2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d9 94 c1 5d 82 3d 3f c2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.73:46684',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201358
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57974
received auth hello!
{ authId: 502, nonce: <Buffer 62 8f b3 92 1b 01 9a 7e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 10 fd 00 a3 ea 86 65 4e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9a 96 d8 2f 11 ca 6b cf>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9a 96 d8 2f 11 ca 6b cf> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.73:46954',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201365
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58244
received auth hello!
{ authId: 502, nonce: <Buffer 22 c1 06 aa 10 e8 aa 27> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 03 9d 91 7c c8 6d 30 1b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e3 af 10 e6 5d 83 8a 6b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e3 af 10 e6 5d 83 8a 6b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.73:47224',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201372
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58514
received auth hello!
{ authId: 502, nonce: <Buffer b9 50 a3 21 fa f9 c6 b6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0b c0 f8 46 df 2b 23 a5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1b b5 96 e0 88 c6 48 be>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1b b5 96 e0 88 c6 48 be> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.73:47494',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201379
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58784
received auth hello!
{ authId: 502, nonce: <Buffer 78 2f ff 80 75 c8 a9 3c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 52 f2 d4 72 51 5b 5b b0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 95 19 31 90 e6 b9 0c 3e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 95 19 31 90 e6 b9 0c 3e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.73:47764',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201386
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59054
received auth hello!
{ authId: 502, nonce: <Buffer f0 2d 5d 64 ec f3 b2 e6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c1 69 cb 63 06 21 df 36>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ed 3f 0f f4 49 bc e4 75>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ed 3f 0f f4 49 bc e4 75> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.73:48034',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201393
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59236
received auth hello!
{ authId: 502, nonce: <Buffer 26 e6 7e e4 1a 4b d1 4b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 18 a2 db 10 33 7e 44 9b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 74 9e 81 29 ab 27 2a d7>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 74 9e 81 29 ab 27 2a d7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.73:48216',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201400
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59394
received auth hello!
{ authId: 502, nonce: <Buffer 4f 96 ca 00 cc 4c 62 fc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 88 bf f5 4e af 78 93 07>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f4 ca d4 89 a2 6a bd a4>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f4 ca d4 89 a2 6a bd a4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.73:48374',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201407
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59598
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer c7 a1 86 fb 67 3f 82 86> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 44 15 c4 fb ea f6 34 fd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 20 23 30 a1 e0 4d 03 7a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 20 23 30 a1 e0 4d 03 7a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.73:48578',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201416
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59788
received auth hello!
{ authId: 502, nonce: <Buffer 00 5f 8a 37 c7 88 0d 85> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c2 88 b3 8b ef c3 14 fe>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 46 bf 16 4c 89 93 7b ae>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 46 bf 16 4c 89 93 7b ae> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.73:48766',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201432
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60006
received auth hello!
{ authId: 502, nonce: <Buffer 8d 93 15 3f 02 fd 73 87> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer af 1b f7 ea 72 e5 53 57>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bd 21 02 c2 15 77 d1 f4>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer bd 21 02 c2 15 77 d1 f4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.73:48984',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201452
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60246
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201464
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60442
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201477
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60648
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201487
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60802
received auth hello!
{ authId: 502, nonce: <Buffer c9 de d5 bc 57 49 9b 89> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ef 1b b0 01 87 ff e6 e6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 58 2c da 82 2a 05 1a 0c>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 58 2c da 82 2a 05 1a 0c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.73:49780',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201516
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 32890
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201641
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34296
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer c2 1e 2c aa 77 2b df 61> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 58 a7 0c b1 96 9a aa a9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9d b2 b7 3a e9 a9 21 a3>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 9d b2 b7 3a e9 a9 21 a3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.73:51508',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201657
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34456
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
received auth hello!
{ authId: 502, nonce: <Buffer b0 1d 95 4e 7b a9 ec db> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5c 8c cd f8 fc 6d 67 02>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7d ae 42 0b 1a 07 79 d0>
Handler: Error in server - details: Error during comm init, details: Error: This socket has been ended by the other party
switching to HANDSHAKE_2_SENT
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
