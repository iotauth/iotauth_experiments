changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s416.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's416',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 30 6c ... > }
Handler: listening on port 22100
s416:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300604
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57616
received auth hello!
{ authId: 403, nonce: <Buffer 3a 07 6e 7f 46 45 76 49> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer ab f9 50 d9 8d da da 80>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer fe 97 5c 15 2e b5 81 63 74 b8 e1 1b f8 3c ee 45>,
  macKeyVal: <Buffer 20 27 9c 8b d1 fa f4 ec 56 74 ad f2 5b 27 31 fc e8 ee 33 51 8a 17 2e bd 1b 43 56 e6 2a d6 d6 f3>,
  absValidity: 2018-03-20T23:09:38.330Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e4 ab f0 79 c9 97 a3 39>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e4 ab f0 79 c9 97 a3 39> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.60:33116',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300605
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57622
received auth hello!
{ authId: 403, nonce: <Buffer c4 3e 9a 8c 31 40 9c f6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1a 59 28 ee 17 1b b4 9d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c7 36 2c 24 e7 3e 9a d0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c7 36 2c 24 e7 3e 9a d0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.61:55678',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300610
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57828
received auth hello!
{ authId: 403, nonce: <Buffer c1 67 fb 3c c2 56 49 3f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9d ca be 0f a4 ac 8f f8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 83 5a 78 8d 0b 19 33 12>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 83 5a 78 8d 0b 19 33 12> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.60:33328',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300611
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57844
received auth hello!
{ authId: 403, nonce: <Buffer c7 56 46 c8 3d 88 92 3f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d7 de 44 6c 9a 80 36 90>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e1 b9 a7 d8 08 4d bf 2a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e1 b9 a7 d8 08 4d bf 2a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.61:55900',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300616
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58098
received auth hello!
{ authId: 403, nonce: <Buffer 31 84 89 2e 40 73 b5 1b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 79 d5 cc 1f 3a 48 e8 e1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f0 0a 11 82 0b 89 87 d7>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f0 0a 11 82 0b 89 87 d7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.60:33598',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300617
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58114
received auth hello!
{ authId: 403, nonce: <Buffer 47 6d 31 a8 72 fe a3 a4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7d ea 9a 0b e9 70 89 3a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7c 67 5f 55 47 79 14 21>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 7c 67 5f 55 47 79 14 21> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.61:56170',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300622
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58368
received auth hello!
{ authId: 403, nonce: <Buffer 4d 50 e0 fc 94 e1 e5 c3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cc d1 70 e7 c1 74 4f 33>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f9 ae cb a5 b1 f6 c2 17>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f9 ae cb a5 b1 f6 c2 17> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.60:33868',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300623
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58384
received auth hello!
{ authId: 403, nonce: <Buffer bb 0b fe 65 68 27 a0 a6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d9 65 b9 f7 ea fe bd 87>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 50 ba 28 a4 38 84 5f 1a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 50 ba 28 a4 38 84 5f 1a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.61:56440',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300628
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58638
received auth hello!
{ authId: 403, nonce: <Buffer 52 db eb 03 43 75 08 30> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5b 27 3f 33 c4 27 ab c7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b0 84 42 be a2 20 96 07>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b0 84 42 be a2 20 96 07> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.60:34138',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300629
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58654
received auth hello!
{ authId: 403, nonce: <Buffer 70 bf ee e5 1d 69 16 ca> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 69 6e 46 7d f9 84 ec 7d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 36 d7 5d fc c2 0a 88 f8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 36 d7 5d fc c2 0a 88 f8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.61:56710',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300634
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58908
received auth hello!
{ authId: 403, nonce: <Buffer 64 09 6b 75 9b 6b a4 81> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fe 29 f9 86 4f af fd 0f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a0 04 fd 3d 06 62 22 27>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a0 04 fd 3d 06 62 22 27> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.60:34408',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300635
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58924
received auth hello!
{ authId: 403, nonce: <Buffer 07 ef 11 06 75 f6 dc 3a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer eb 0a 30 32 21 b2 7b 33>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8a 74 b2 48 6f e8 3f ea>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8a 74 b2 48 6f e8 3f ea> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.61:56980',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300640
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59178
received auth hello!
{ authId: 403, nonce: <Buffer 75 fb 16 cf 41 56 18 1f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d6 ac 61 43 de 3f 3e 62>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b0 3d 1e ce 9f 62 bb 6e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b0 3d 1e ce 9f 62 bb 6e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.60:34678',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300641
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59194
received auth hello!
{ authId: 403, nonce: <Buffer 88 01 93 4a d8 49 42 34> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 00 d4 6c e6 37 27 33 0a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 43 d5 e5 ef 52 b6 db 4e>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 43 d5 e5 ef 52 b6 db 4e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.61:57250',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300646
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59444
received auth hello!
{ authId: 403, nonce: <Buffer 6b a8 86 64 d3 d2 7e e9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 17 d0 3b af a6 d7 65 40>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7b 18 40 8f d2 13 1f d1>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 7b 18 40 8f d2 13 1f d1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.60:34944',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300647
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59460
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
