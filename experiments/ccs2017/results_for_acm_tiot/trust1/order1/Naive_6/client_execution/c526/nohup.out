changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c526.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c526',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 34 6c ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521583866039
connected to auth! from local port 45646
received auth hello!
{ authId: 504, nonce: <Buffer dd c6 9d f9 22 c2 ee ee> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer c5 15 7e 55 b6 71 c6 8e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 77 a5 aa e5 03 fb c4 ea 37 42 c7 7d aa db f6 59>,
  macKeyVal: <Buffer 45 65 8e 5d 6d 16 24 2c b3 b0 81 51 9e f5 0b cb 13 4a 7f 29 2a c1 a0 49 5e 92 74 0b 59 8b 05 f3>,
  absValidity: 2018-03-20T23:11:09.185Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400194,
  cipherKeyVal: <Buffer f2 df a7 a0 b3 66 60 21 86 2a 42 6a 5c f3 a0 c5>,
  macKeyVal: <Buffer ea 57 10 25 a8 9d c1 53 c1 91 cd a2 68 af 0c 4b 77 2e 63 51 1c 3b b2 df 0e ef f5 f6 cb 1e d3 91>,
  absValidity: 2018-03-21T22:11:09.185Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50400194,
     cipherKeyVal: <Buffer f2 df a7 a0 b3 66 60 21 86 2a 42 6a 5c f3 a0 c5>,
     macKeyVal: <Buffer ea 57 10 25 a8 9d c1 53 c1 91 cd a2 68 af 0c 4b 77 2e 63 51 1c 3b b2 df 0e ef f5 f6 cb 1e d3 91>,
     absValidity: 2018-03-21T22:11:09.185Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 99 0d bc 01 11 8f a0 4b>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:11:12 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521583872554
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521583926086
connected to auth! from local port 45916
received auth hello!
{ authId: 504, nonce: <Buffer 09 07 13 35 5b 17 53 d7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ab 4b 19 1f 70 16 9e 60>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400200,
  cipherKeyVal: <Buffer 8a ba 4c b0 ea 24 39 fc 47 d3 c4 08 9e ef f2 de>,
  macKeyVal: <Buffer ec 26 8c 3b cd 39 3b 76 b7 5c d4 ec b8 6a 15 61 fa 3a 5d e6 67 2a b9 c1 6b f6 01 42 50 2c b8 20>,
  absValidity: 2018-03-21T22:12:08.930Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50400200,
     cipherKeyVal: <Buffer 8a ba 4c b0 ea 24 39 fc 47 d3 c4 08 9e ef f2 de>,
     macKeyVal: <Buffer ec 26 8c 3b cd 39 3b 76 b7 5c d4 ec b8 6a 15 61 fa 3a 5d e6 67 2a b9 c1 6b f6 01 42 50 2c b8 20>,
     absValidity: 2018-03-21T22:12:08.930Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer af 4b e6 70 c4 31 e0 f3>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:12:12 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521583932484
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521583986137
connected to auth! from local port 46186
received auth hello!
{ authId: 504, nonce: <Buffer e1 f5 f8 70 6b 55 36 7a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 62 3f c6 95 21 0b e9 2b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400206,
  cipherKeyVal: <Buffer 2e d5 03 85 08 6b 20 9f 62 ed 47 c8 6f 3d 59 a3>,
  macKeyVal: <Buffer 7d 50 00 51 52 b4 7e 16 aa 65 0e f4 75 7c d9 85 14 a5 fb c6 5f 01 c8 a8 24 2f af 96 9c 4c 3c 6d>,
  absValidity: 2018-03-21T22:13:09.424Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50400206,
     cipherKeyVal: <Buffer 2e d5 03 85 08 6b 20 9f 62 ed 47 c8 6f 3d 59 a3>,
     macKeyVal: <Buffer 7d 50 00 51 52 b4 7e 16 aa 65 0e f4 75 7c d9 85 14 a5 fb c6 5f 01 c8 a8 24 2f af 96 9c 4c 3c 6d>,
     absValidity: 2018-03-21T22:13:09.424Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 4b 71 a9 46 2d e1 60 31>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:13:12 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521583992437
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521584046189
connected to auth! from local port 46456
received auth hello!
{ authId: 504, nonce: <Buffer da b4 cc 51 2a d5 04 7d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 55 c1 92 9d c0 d8 7e 45>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400212,
  cipherKeyVal: <Buffer 51 92 d3 0e 28 4e fa 37 ef 08 5d 86 a0 35 d3 c3>,
  macKeyVal: <Buffer 85 4a 0f b8 b5 76 57 f0 cd 34 7f ab ba 81 9d 98 2d 5e 03 1e 54 ff 1d 75 31 95 c6 0c 27 ad ec f2>,
  absValidity: 2018-03-21T22:14:09.498Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50400212,
     cipherKeyVal: <Buffer 51 92 d3 0e 28 4e fa 37 ef 08 5d 86 a0 35 d3 c3>,
     macKeyVal: <Buffer 85 4a 0f b8 b5 76 57 f0 cd 34 7f ab ba 81 9d 98 2d 5e 03 1e 54 ff 1d 75 31 95 c6 0c 27 ad ec f2>,
     absValidity: 2018-03-21T22:14:09.498Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer a6 c9 81 ad 04 8f a7 85>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:14:12 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521584052504
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521584106244
connected to auth! from local port 46726
received auth hello!
{ authId: 504, nonce: <Buffer fa 79 43 7a 74 7b 62 1b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 08 d2 bc ee 71 4c cf d3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400218,
  cipherKeyVal: <Buffer c9 d1 1c 20 3e 45 85 46 f6 56 41 3e 9b 8d d3 a2>,
  macKeyVal: <Buffer 95 bb 64 0a 02 0e 30 97 99 bb 8e 80 b4 7a ad 48 aa 31 e3 80 da 43 d9 1e 91 b7 2c 35 31 2f 04 15>,
  absValidity: 2018-03-21T22:15:09.561Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50400218,
     cipherKeyVal: <Buffer c9 d1 1c 20 3e 45 85 46 f6 56 41 3e 9b 8d d3 a2>,
     macKeyVal: <Buffer 95 bb 64 0a 02 0e 30 97 99 bb 8e 80 b4 7a ad 48 aa 31 e3 80 da 43 d9 1e 91 b7 2c 35 31 2f 04 15>,
     absValidity: 2018-03-21T22:15:09.561Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer b4 a1 19 18 37 9e 62 74>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:15:12 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521584112564
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521584166295
connected to auth! from local port 46996
received auth hello!
{ authId: 504, nonce: <Buffer 83 c6 d6 b8 e7 92 ea b0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f3 39 f7 9c a4 29 42 2c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400224,
  cipherKeyVal: <Buffer 3f 8d 07 0d 59 08 61 6d 7c 86 0c 67 08 6e aa ff>,
  macKeyVal: <Buffer df 6d 1d 3d 7c 5f 9b 7e 0d 64 f6 fe 05 09 d8 a2 fa 8a 5c 3e 8e 92 dd a2 10 14 b3 17 d9 19 ed d0>,
  absValidity: 2018-03-21T22:16:09.590Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50400224,
     cipherKeyVal: <Buffer 3f 8d 07 0d 59 08 61 6d 7c 86 0c 67 08 6e aa ff>,
     macKeyVal: <Buffer df 6d 1d 3d 7c 5f 9b 7e 0d 64 f6 fe 05 09 d8 a2 fa 8a 5c 3e 8e 92 dd a2 10 14 b3 17 d9 19 ed d0>,
     absValidity: 2018-03-21T22:16:09.590Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer ac df f4 a4 e8 d2 25 be>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.42:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 7 0.7142857142857143 1521584226303
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 8 0.625 1521584286313
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.6:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 9 0.5555555555555556 1521584346321
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.3:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 10 0.5 1521584406325
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.1:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 11 0.45454545454545453 1521584466333
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 2
to: 3
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 12 0.4166666666666667 1521584526340
failure in connection with Auth : authFailureCount: 6
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 3
to: 4
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 13 0.38461538461538464 1521584586347
failure in connection with Auth : authFailureCount: 7
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 4
to: 5
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 39330
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 14 0.35714285714285715 1521584646354
failure in connection with Auth : authFailureCount: 8
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 39512
received auth hello!
{ authId: 502, nonce: <Buffer 7e 98 a7 59 27 98 e7 57> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth504',
     commonName: '10.0.0.7' },
  serial: '016245740CB7',
  notBefore: 2018-03-20T22:05:56.000Z,
  notAfter: 2018-03-21T22:07:36.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '36:5F:CE:E1:EA:99:80:10:89:FF:F6:13:CA:5E:17:59:60:B8:38:32',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'E40B9EF20959AA49D02016EC2E9896074EE0818689EAD7319ECC8ED8C9557412ED46C95E67464598F6233ECEB8BF25A876F0D30B65CED2B1FED8D1F07CF9042FD7F86E3B637BE17FBFD7C9F0DB5850835170B354A52C175B769A37BA578F965436FF29BCFD54C5D4E939E02214503C8A69FFBBF0EC06657DF9498BE98DEB26B62E1453817F6DFAE9B50EE21C5A643FF0292539838A682562303CB77FC6028B22B30B78957E4F78E539103F991928681EBF3100D31960F43F8ECFC6C2F3063B353E92BFFEF77A49BBCBF417864AE8169AA061F590E5FB3393A4592EFA1100FC186B95B83724CA0B11D8BC02BC9BD4F9E08552DE2D1EB0EE0E866E41A520730E6F',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJFdAy3MA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDQxETAPBgNVBAMMCDEwLjAuMC43MB4XDTE4MDMy\nMDIyMDU1NloXDTE4MDMyMTIyMDczNlowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDkC57yCVmqSdAgFuwumJYHTuCBhonq1zGezI7YyVV0Eu1GyV5n\nRkWY9iM+zri/Jah28NMLZc7Ssf7Y0fB8+QQv1/huO2N74X+/18nw21hQg1Fws1Sl\nLBdbdpo3ulePllQ2/ym8/VTF1Ok54CIUUDyKaf+78OwGZX35SYvpjesmti4UU4F/\nbfrptQ7iHFpkP/ApJTmDimglYjA8t3/GAosiswt4lX5PeOU5ED+ZGShoHr8xANMZ\nYPQ/js/GwvMGOzU+kr/+93pJu8v0F4ZK6BaaoGH1kOX7M5OkWS76EQD8GGuVuDck\nygsR2LwCvJvU+eCFUt4tHrDuDoZuQaUgcw5vAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAHjpcsYdFl8Ksztl0CxHnpJb6pcspFG4\nGrTJJl3jZeEiMAUTvzLYUIFsN0fl4AjcnVY0xH6l+B8toQHSF6iCjX3CzX/SRuAC\no4iMTzsLdKxgkOo4RQIo0vIYe8g//4+m/fsidWvkgn1Meh3+AEjteyx6+tJfxFav\nZa+vaXZnBwqQo7f3NtiIlEbak72beZiG/JjFHIkrTQDNKnmzFZqaZMLY+fZLLBaV\niEsw07AQ70SJKW575LK7BnYOkojPvQfyhnuWcD6JDyDRCqXOVEriu95aej6WWwID\n2uznotgjsnnLJPTqvAkrxoloEgDyjhfNbtHjCWuhLquexyfbFJwq714=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 5
to: 6
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 15 0.3333333333333333 1521584706364
connected to auth! from local port 39694
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 16 0.3125 1521584766375
connected to auth! from local port 39848
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 17 0.29411764705882354 1521584826386
connected to auth! from local port 40006
received auth hello!
{ authId: 502, nonce: <Buffer ea 43 d6 4d 0a 06 7b ec> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 99 d1 55 b4 6e 3a 77 7e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer fa d6 77 9a 74 28 46 ed 87 78 bf 3a 91 d0 13 64>,
  macKeyVal: <Buffer 91 b6 fe 7a d8 f2 8b 4a ef e7 85 8e e1 ca e1 32 57 47 75 21 c8 83 35 60 87 fb c8 df 97 ec 30 ef>,
  absValidity: 2018-03-20T23:27:18.083Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201513,
  cipherKeyVal: <Buffer 60 41 ad 23 53 75 dd a0 3e c2 b7 6e b4 21 45 79>,
  macKeyVal: <Buffer 4b b5 bb 0c 8d 9e a7 9d 4f 62 b3 44 d5 8d 02 ab 4a b0 41 9f c2 24 bd b5 4e 53 e7 c9 5f 0d f9 94>,
  absValidity: 2018-03-21T22:27:18.083Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50201513,
     cipherKeyVal: <Buffer 60 41 ad 23 53 75 dd a0 3e c2 b7 6e b4 21 45 79>,
     macKeyVal: <Buffer 4b b5 bb 0c 8d 9e a7 9d 4f 62 b3 44 d5 8d 02 ab 4a b0 41 9f c2 24 bd b5 4e 53 e7 c9 5f 0d f9 94>,
     absValidity: 2018-03-21T22:27:18.083Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 14 15 5b 34 64 c4 45 01>
switching to HANDSHAKE_1_SENT
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 18 0.2777777777777778 1521584886434
connected to auth! from local port 40172
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.42:undefined
received auth hello!
{ authId: 502, nonce: <Buffer cf 6d aa ea d2 4a d2 7e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e6 33 cf 18 a9 f4 b6 0e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201529,
  cipherKeyVal: <Buffer de 93 56 2d 08 31 61 6a a6 89 10 66 b1 14 1c af>,
  macKeyVal: <Buffer 5a 1b 77 51 b0 47 64 13 47 fb b3 e9 fb 9e 1c 2e 03 66 d9 db 26 6b 03 bd 93 09 b5 85 f5 41 fc 5b>,
  absValidity: 2018-03-21T22:28:14.090Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50201529,
     cipherKeyVal: <Buffer de 93 56 2d 08 31 61 6a a6 89 10 66 b1 14 1c af>,
     macKeyVal: <Buffer 5a 1b 77 51 b0 47 64 13 47 fb b3 e9 fb 9e 1c 2e 03 66 d9 db 26 6b 03 bd 93 09 b5 85 f5 41 fc 5b>,
     absValidity: 2018-03-21T22:28:14.090Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer ff d3 fb 89 ad 9b c6 68>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.42:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 19 0.2631578947368421 1521584946438
connected to auth! from local port 40338
received auth hello!
{ authId: 502, nonce: <Buffer f9 96 60 dd 90 f5 28 31> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 28 fa 85 dc cd 5d 16 d8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201545,
  cipherKeyVal: <Buffer 71 72 43 39 d2 c1 26 74 84 78 91 86 23 c6 ad 48>,
  macKeyVal: <Buffer c3 74 66 96 11 0a c7 63 b2 5e 6e 32 b1 0f ff bf e0 d8 e1 e0 4b 3e 5c a7 7d d5 09 9f 47 06 a9 3a>,
  absValidity: 2018-03-21T22:29:14.078Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50201545,
     cipherKeyVal: <Buffer 71 72 43 39 d2 c1 26 74 84 78 91 86 23 c6 ad 48>,
     macKeyVal: <Buffer c3 74 66 96 11 0a c7 63 b2 5e 6e 32 b1 0f ff bf e0 d8 e1 e0 4b 3e 5c a7 7d d5 09 9f 47 06 a9 3a>,
     absValidity: 2018-03-21T22:29:14.078Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 64 13 89 a2 72 b5 a5 c3>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.42:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 20 0.25 1521585006440
connected to auth! from local port 40496
received auth hello!
{ authId: 502, nonce: <Buffer df bf 66 c6 bf 6d 12 84> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 86 05 6f 4e 99 2f 1a 18>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201560,
  cipherKeyVal: <Buffer bd 03 d6 2f 26 d6 02 bb 1a 51 0a f9 fd 34 65 d3>,
  macKeyVal: <Buffer c1 64 78 98 98 b1 25 dc ab c9 bd d6 d1 c4 13 82 27 24 c1 9b dd 7a 37 4c df fb 72 70 fd f4 49 79>,
  absValidity: 2018-03-21T22:30:14.099Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50201560,
     cipherKeyVal: <Buffer bd 03 d6 2f 26 d6 02 bb 1a 51 0a f9 fd 34 65 d3>,
     macKeyVal: <Buffer c1 64 78 98 98 b1 25 dc ab c9 bd d6 d1 c4 13 82 27 24 c1 9b dd 7a 37 4c df fb 72 70 fd f4 49 79>,
     absValidity: 2018-03-21T22:30:14.099Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer c0 8b 63 86 5d 29 14 4e>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.42:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 21 0.23809523809523808 1521585066442
connected to auth! from local port 40646
received auth hello!
{ authId: 502, nonce: <Buffer 47 7a a2 fb d5 86 13 ec> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 04 af 63 08 f7 2a 4e 7b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201573,
  cipherKeyVal: <Buffer c2 8a cb c4 f2 c4 b1 88 84 0b af 32 8c e9 e9 49>,
  macKeyVal: <Buffer 9d f7 8d 06 4c 5c 97 cc ef e2 ee 38 3f 52 ae 87 56 4f 9a 6a e6 eb 17 49 89 9b 39 92 71 29 2a b2>,
  absValidity: 2018-03-21T22:31:14.076Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50201573,
     cipherKeyVal: <Buffer c2 8a cb c4 f2 c4 b1 88 84 0b af 32 8c e9 e9 49>,
     macKeyVal: <Buffer 9d f7 8d 06 4c 5c 97 cc ef e2 ee 38 3f 52 ae 87 56 4f 9a 6a e6 eb 17 49 89 9b 39 92 71 29 2a b2>,
     absValidity: 2018-03-21T22:31:14.076Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 19 b9 cd 49 5b 15 4a 4d>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.42:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 22 0.22727272727272727 1521585126444
connected to auth! from local port 40802
received auth hello!
{ authId: 502, nonce: <Buffer 85 82 1e dc 25 3b f0 bc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a1 8f 5c 1d fa 0e 42 e1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201587,
  cipherKeyVal: <Buffer 39 7f b8 75 ca d1 d7 e7 e4 16 60 f6 ac 7a 9d 2f>,
  macKeyVal: <Buffer f5 6d c6 80 ea 10 7a 61 0b a8 3b 83 43 26 c2 75 da ce e7 d9 67 d0 a3 54 10 25 75 62 ef e2 0b 23>,
  absValidity: 2018-03-21T22:32:14.079Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50201587,
     cipherKeyVal: <Buffer 39 7f b8 75 ca d1 d7 e7 e4 16 60 f6 ac 7a 9d 2f>,
     macKeyVal: <Buffer f5 6d c6 80 ea 10 7a 61 0b a8 3b 83 43 26 c2 75 da ce e7 d9 67 d0 a3 54 10 25 75 62 ef e2 0b 23>,
     absValidity: 2018-03-21T22:32:14.079Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer ee b6 3c 67 1f 9e ca 65>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.42:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 23 0.21739130434782608 1521585186447
connected to auth! from local port 40952
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 24 0.20833333333333334 1521585246456
connected to auth! from local port 41090
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 25 0.2 1521585306467
connected to auth! from local port 41230
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 26 0.19230769230769232 1521585366478
connected to auth! from local port 41364
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 27 0.18518518518518517 1521585426489
connected to auth! from local port 41530
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 28 0.17857142857142858 1521585486497
connected to auth! from local port 41640
received auth hello!
{ authId: 502, nonce: <Buffer e6 39 0b a9 de 6b 22 82> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 53 79 17 a4 a0 62 b2 49>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201660,
  cipherKeyVal: <Buffer 73 36 e8 38 d4 60 a7 7e 31 f7 71 c5 ae 84 5c 4c>,
  macKeyVal: <Buffer fe 74 0f a3 43 b3 0a 3c 6e 65 49 41 f8 87 d6 c4 f0 78 80 1d 8c 7b 56 9f 73 db f6 f3 0b 4b f8 9a>,
  absValidity: 2018-03-21T22:38:10.402Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50201660,
     cipherKeyVal: <Buffer 73 36 e8 38 d4 60 a7 7e 31 f7 71 c5 ae 84 5c 4c>,
     macKeyVal: <Buffer fe 74 0f a3 43 b3 0a 3c 6e 65 49 41 f8 87 d6 c4 f0 78 80 1d 8c 7b 56 9f 73 db f6 f3 0b 4b f8 9a>,
     absValidity: 2018-03-21T22:38:10.402Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 7f 7e 1f 56 f4 66 05 37>
switching to HANDSHAKE_1_SENT
