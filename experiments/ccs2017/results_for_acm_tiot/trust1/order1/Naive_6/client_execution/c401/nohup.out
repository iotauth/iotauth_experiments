changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c401.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c401',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 74 36 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521583721222
connected to auth! from local port 45970
received auth hello!
{ authId: 401, nonce: <Buffer 26 6e c1 a1 ed 6c e1 03> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 08 c2 7c b5 2c 7f d3 44>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer d9 d6 49 cd f7 bc be d3 5d b7 a4 d6 08 1b e5 fa>,
  macKeyVal: <Buffer 67 e7 d3 d4 4a 4d fa 20 6f f5 c4 ec 9e 3b c0 7e ce 60 3c 09 e4 33 bc a7 77 0d 6a 4f 9d 27 0a e2>,
  absValidity: 2018-03-20T23:08:41.411Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101299,
  cipherKeyVal: <Buffer ee da 7e d5 f4 85 fe 24 1e 00 34 ef fe 99 ea 2a>,
  macKeyVal: <Buffer 3b 3a 77 76 d6 39 d8 65 5d 65 7d fd 24 f2 06 7f 20 e0 52 8e 69 d9 36 a3 1e c6 60 1f b5 f2 1a fe>,
  absValidity: 2018-03-21T22:08:41.408Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.8',
  serverPort: 22100,
  sessionKey: 
   { id: 40101299,
     cipherKeyVal: <Buffer ee da 7e d5 f4 85 fe 24 1e 00 34 ef fe 99 ea 2a>,
     macKeyVal: <Buffer 3b 3a 77 76 d6 39 d8 65 5d 65 7d fd 24 f2 06 7f 20 e0 52 8e 69 d9 36 a3 1e c6 60 1f b5 f2 1a fe>,
     absValidity: 2018-03-21T22:08:41.408Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 0f bd 7e 25 b2 f1 65 52>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:08:42 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521583722360
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521583781281
connected to auth! from local port 46084
received auth hello!
{ authId: 401, nonce: <Buffer c0 52 4d 13 6e da 9b 73> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 65 8f 47 06 d2 09 4f 5a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101305,
  cipherKeyVal: <Buffer e3 42 4c df a1 22 9e 3e f6 fa a9 dc 51 24 62 fc>,
  macKeyVal: <Buffer 58 14 eb 00 54 8c 6d 09 91 9f 55 8e 11 62 45 d8 a0 5f 1e 3f 0b 27 19 11 f4 5b 7f c3 64 6f 68 d9>,
  absValidity: 2018-03-21T22:09:41.421Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.8',
  serverPort: 22100,
  sessionKey: 
   { id: 40101305,
     cipherKeyVal: <Buffer e3 42 4c df a1 22 9e 3e f6 fa a9 dc 51 24 62 fc>,
     macKeyVal: <Buffer 58 14 eb 00 54 8c 6d 09 91 9f 55 8e 11 62 45 d8 a0 5f 1e 3f 0b 27 19 11 f4 5b 7f c3 64 6f 68 d9>,
     absValidity: 2018-03-21T22:09:41.421Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 17 63 f2 d1 68 28 eb 77>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:09:42 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521583782509
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521583841337
connected to auth! from local port 46306
received auth hello!
{ authId: 401, nonce: <Buffer 47 2f 2b 6c 2f ad 52 20> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1d f1 73 43 7d e9 d2 4e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101311,
  cipherKeyVal: <Buffer 2d a5 c9 30 c1 7a 66 45 2b d1 00 ed af 8a 80 1f>,
  macKeyVal: <Buffer 59 93 a1 79 62 fe c7 36 0c 2d b9 bd db d1 26 a3 6d 70 7d 60 0c 69 4a 12 df 4c 68 e3 72 f3 f7 4d>,
  absValidity: 2018-03-21T22:10:41.539Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.8',
  serverPort: 22100,
  sessionKey: 
   { id: 40101311,
     cipherKeyVal: <Buffer 2d a5 c9 30 c1 7a 66 45 2b d1 00 ed af 8a 80 1f>,
     macKeyVal: <Buffer 59 93 a1 79 62 fe c7 36 0c 2d b9 bd db d1 26 a3 6d 70 7d 60 0c 69 4a 12 df 4c 68 e3 72 f3 f7 4d>,
     absValidity: 2018-03-21T22:10:41.539Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 09 7f 60 a8 c8 2a 26 f9>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:10:42 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521583842645
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521583901397
connected to auth! from local port 46576
received auth hello!
{ authId: 401, nonce: <Buffer 0b be 14 19 e4 7d 1d 54> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 43 f0 a5 a1 34 13 94 75>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101317,
  cipherKeyVal: <Buffer 7c e9 91 bc 40 1b 87 02 b9 2c 22 90 af bd 45 dc>,
  macKeyVal: <Buffer a7 5c f9 b2 80 20 2a a7 51 5a 42 5f d2 f9 00 b4 66 ec d4 af 13 50 e0 fc c4 03 df a8 59 70 60 c4>,
  absValidity: 2018-03-21T22:11:41.590Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.8',
  serverPort: 22100,
  sessionKey: 
   { id: 40101317,
     cipherKeyVal: <Buffer 7c e9 91 bc 40 1b 87 02 b9 2c 22 90 af bd 45 dc>,
     macKeyVal: <Buffer a7 5c f9 b2 80 20 2a a7 51 5a 42 5f d2 f9 00 b4 66 ec d4 af 13 50 e0 fc c4 03 df a8 59 70 60 c4>,
     absValidity: 2018-03-21T22:11:41.590Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 9f 89 74 f3 04 ea 72 cd>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:11:42 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521583902609
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521583961453
connected to auth! from local port 46846
received auth hello!
{ authId: 401, nonce: <Buffer 83 48 4c b4 8e f1 39 d7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6f 86 46 40 c7 9a 52 e6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101323,
  cipherKeyVal: <Buffer 6b 1b cf 90 e5 5e ca 50 f0 ef 8d 2c e9 72 da 17>,
  macKeyVal: <Buffer 37 03 93 6d 36 22 a6 0d b8 33 17 65 68 76 65 dc 63 0a 7f 82 3d c3 10 1e 1d d9 51 f4 72 b0 49 ec>,
  absValidity: 2018-03-21T22:12:41.652Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.8',
  serverPort: 22100,
  sessionKey: 
   { id: 40101323,
     cipherKeyVal: <Buffer 6b 1b cf 90 e5 5e ca 50 f0 ef 8d 2c e9 72 da 17>,
     macKeyVal: <Buffer 37 03 93 6d 36 22 a6 0d b8 33 17 65 68 76 65 dc 63 0a 7f 82 3d c3 10 1e 1d d9 51 f4 72 b0 49 ec>,
     absValidity: 2018-03-21T22:12:41.652Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 5f fd 5c 76 5d 96 0d 3d>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:12:42 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521583962694
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521584021509
connected to auth! from local port 47116
received auth hello!
{ authId: 401, nonce: <Buffer d0 2d c9 40 58 b9 8c 52> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9e 4a 9f f3 9e 1f ca 20>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101329,
  cipherKeyVal: <Buffer c2 e8 c1 66 e8 4b c2 f8 93 66 ba 7f d5 6d 45 ab>,
  macKeyVal: <Buffer f4 93 0c 69 79 81 a8 6c 42 6d a0 3e 2d 37 98 1f fb da 0b 96 6c e5 3d e9 90 e3 ca ca 49 06 0d 59>,
  absValidity: 2018-03-21T22:13:41.705Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.8',
  serverPort: 22100,
  sessionKey: 
   { id: 40101329,
     cipherKeyVal: <Buffer c2 e8 c1 66 e8 4b c2 f8 93 66 ba 7f d5 6d 45 ab>,
     macKeyVal: <Buffer f4 93 0c 69 79 81 a8 6c 42 6d a0 3e 2d 37 98 1f fb da 0b 96 6c e5 3d e9 90 e3 ca ca 49 06 0d 59>,
     absValidity: 2018-03-21T22:13:41.705Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 8a c7 8b 10 d4 a2 73 6e>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:13:42 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521584022677
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521584081565
connected to auth! from local port 47386
received auth hello!
{ authId: 401, nonce: <Buffer 41 71 84 6f 32 46 17 56> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 09 21 49 e1 6d aa df 47>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101335,
  cipherKeyVal: <Buffer e0 03 1d 6c 63 cd e2 a4 88 be 06 d9 15 51 56 80>,
  macKeyVal: <Buffer 93 72 f0 a2 7f 10 fb 90 a8 da f2 7c 6d 2b ad 4c 95 25 41 c3 ce 19 92 e9 02 73 2b 7f b3 0e 11 0e>,
  absValidity: 2018-03-21T22:14:41.735Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.8',
  serverPort: 22100,
  sessionKey: 
   { id: 40101335,
     cipherKeyVal: <Buffer e0 03 1d 6c 63 cd e2 a4 88 be 06 d9 15 51 56 80>,
     macKeyVal: <Buffer 93 72 f0 a2 7f 10 fb 90 a8 da f2 7c 6d 2b ad 4c 95 25 41 c3 ce 19 92 e9 02 73 2b 7f b3 0e 11 0e>,
     absValidity: 2018-03-21T22:14:41.735Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 98 0e 37 6e 5c c5 eb 86>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:14:42 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521584082602
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521584141624
connected to auth! from local port 47656
received auth hello!
{ authId: 401, nonce: <Buffer 2d 33 4c e1 bf d4 b2 1a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f4 63 67 ca 38 38 cb 4a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101341,
  cipherKeyVal: <Buffer 88 55 9c a9 33 8a 74 1f 9e 91 99 bb 4e c1 d5 06>,
  macKeyVal: <Buffer ac 2e 89 c6 1a 67 54 73 b6 6b 09 7c b2 0c db 7b d8 0a f5 27 15 30 57 fc 3d d2 f2 e3 be 23 1e 9c>,
  absValidity: 2018-03-21T22:15:41.787Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.8',
  serverPort: 22100,
  sessionKey: 
   { id: 40101341,
     cipherKeyVal: <Buffer 88 55 9c a9 33 8a 74 1f 9e 91 99 bb 4e c1 d5 06>,
     macKeyVal: <Buffer ac 2e 89 c6 1a 67 54 73 b6 6b 09 7c b2 0c db 7b d8 0a f5 27 15 30 57 fc 3d d2 f2 e3 be 23 1e 9c>,
     absValidity: 2018-03-21T22:15:41.787Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer f9 a4 1d 35 df 4a ed b2>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:15:42 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 8 1 1521584142852
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 9 0.8888888888888888 1521584201684
connected to auth! from local port 47922
received auth hello!
{ authId: 401, nonce: <Buffer ef 79 fc 90 a7 3f b9 8d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1b 36 2b 37 99 37 9d 2d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101347,
  cipherKeyVal: <Buffer 91 09 d4 f4 83 5a 6a 9e 62 7c db 56 50 1f d9 3e>,
  macKeyVal: <Buffer bb 5f 05 f2 50 af 0a 57 c2 35 9f dc 32 e0 90 24 21 da dd e0 ec ad c1 e4 13 f0 69 52 bd 07 b2 b4>,
  absValidity: 2018-03-21T22:16:41.859Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.8',
  serverPort: 22100,
  sessionKey: 
   { id: 40101347,
     cipherKeyVal: <Buffer 91 09 d4 f4 83 5a 6a 9e 62 7c db 56 50 1f d9 3e>,
     macKeyVal: <Buffer bb 5f 05 f2 50 af 0a 57 c2 35 9f dc 32 e0 90 24 21 da dd e0 ec ad c1 e4 13 f0 69 52 bd 07 b2 b4>,
     absValidity: 2018-03-21T22:16:41.859Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer f9 43 7b 5d 05 4f c1 75>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:16:42 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 9 9 1 1521584202715
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 10 0.9 1521584261742
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.1:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 11 0.8181818181818182 1521584321753
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.1:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 12 0.75 1521584381761
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.1:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 13 0.6923076923076923 1521584441768
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.1:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 14 0.6428571428571429 1521584501775
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 2
to: 3
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.1:21100
connected to auth! from local port 45258
received auth hello!
{ authId: 502, nonce: <Buffer 02 95 c4 14 f9 eb 9f f5> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth401',
     commonName: '10.0.0.1' },
  serial: '0162457401A2',
  notBefore: 2018-03-20T22:05:53.000Z,
  notAfter: 2018-03-21T22:07:33.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '0B:97:D5:ED:39:1B:E5:E0:95:C9:31:E4:BC:B1:7B:18:89:B1:33:C1',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'E40B9EF20959AA49D02016EC2E9896074EE0818689EAD7319ECC8ED8C9557412ED46C95E67464598F6233ECEB8BF25A876F0D30B65CED2B1FED8D1F07CF9042FD7F86E3B637BE17FBFD7C9F0DB5850835170B354A52C175B769A37BA578F965436FF29BCFD54C5D4E939E02214503C8A69FFBBF0EC06657DF9498BE98DEB26B62E1453817F6DFAE9B50EE21C5A643FF0292539838A682562303CB77FC6028B22B30B78957E4F78E539103F991928681EBF3100D31960F43F8ECFC6C2F3063B353E92BFFEF77A49BBCBF417864AE8169AA061F590E5FB3393A4592EFA1100FC186B95B83724CA0B11D8BC02BC9BD4F9E08552DE2D1EB0EE0E866E41A520730E6F',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJFdAGiMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDExETAPBgNVBAMMCDEwLjAuMC4xMB4XDTE4MDMy\nMDIyMDU1M1oXDTE4MDMyMTIyMDczM1owYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDkC57yCVmqSdAgFuwumJYHTuCBhonq1zGezI7YyVV0Eu1GyV5n\nRkWY9iM+zri/Jah28NMLZc7Ssf7Y0fB8+QQv1/huO2N74X+/18nw21hQg1Fws1Sl\nLBdbdpo3ulePllQ2/ym8/VTF1Ok54CIUUDyKaf+78OwGZX35SYvpjesmti4UU4F/\nbfrptQ7iHFpkP/ApJTmDimglYjA8t3/GAosiswt4lX5PeOU5ED+ZGShoHr8xANMZ\nYPQ/js/GwvMGOzU+kr/+93pJu8v0F4ZK6BaaoGH1kOX7M5OkWS76EQD8GGuVuDck\nygsR2LwCvJvU+eCFUt4tHrDuDoZuQaUgcw5vAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAItvUfipOkdPZlqJIASIPmKrWCQ1qHcR\nByG8136cn34lxZmVDcX65a1JlFoXxMr7rc2sqbIVYUcwE8n70MGCS778eg1IcuVH\npmoouw5TNPsxE6ZXsUHQQbcZhuuqB232lOJdNC+wUy/4px2qFO0GJrQuDR7/9YB9\nHvwUBAwgTb17G1XmArygnwBWFlBUbHKXAtRSbkvOKXvVAAvDK5B7/d8icH+g4yqx\nYl5nYN3lp/hl/Wp5j44ua3zAQS5YL8eb4iAShTLFw+kRHTTA/1x5NeFMhE3ExUA/\nR2VPBlZpBkv7UsqWfuLU6in9FmEEVLI2pBAm5bN7KVS/6H6ix/2FqtU=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 3
to: 4
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 15 0.6 1521584561785
connected to auth! from local port 45474
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 16 0.5625 1521584621795
connected to auth! from local port 45662
received auth hello!
{ authId: 502, nonce: <Buffer a2 93 ae bc 84 4a c4 74> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 69 95 7e 8e 18 12 a0 cd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer b4 94 83 22 10 a1 95 2e 07 3e 1f 16 4d 7d 5b 6f>,
  macKeyVal: <Buffer 54 05 76 2a eb d9 f2 4c ac a1 d1 fe fd b1 bc 6c 7d 51 bd e9 c3 23 6d 99 dc ea 41 40 b6 c5 73 e1>,
  absValidity: 2018-03-20T23:23:45.600Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201466,
  cipherKeyVal: <Buffer 7d 77 7a 59 3d 9d a7 46 f6 95 89 ca c4 f7 3f b5>,
  macKeyVal: <Buffer 70 ae ea 56 5e 81 f6 49 66 f5 df df 04 1b 44 05 f6 4e ac 81 3c d3 56 25 2c 8c 21 fe c6 c2 ec 08>,
  absValidity: 2018-03-21T22:23:45.600Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.8',
  serverPort: 22100,
  sessionKey: 
   { id: 50201466,
     cipherKeyVal: <Buffer 7d 77 7a 59 3d 9d a7 46 f6 95 89 ca c4 f7 3f b5>,
     macKeyVal: <Buffer 70 ae ea 56 5e 81 f6 49 66 f5 df df 04 1b 44 05 f6 4e ac 81 3c d3 56 25 2c 8c 21 fe c6 c2 ec 08>,
     absValidity: 2018-03-21T22:23:45.600Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 7d d2 07 27 26 be 56 33>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.8:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 17 0.5294117647058824 1521584681801
connected to auth! from local port 45868
received auth hello!
{ authId: 502, nonce: <Buffer 98 dd 6f 65 b2 1a 95 91> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bf 4d 32 04 a7 0c d8 64>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201480,
  cipherKeyVal: <Buffer a0 1f 08 ef 88 a6 a3 f6 64 55 1e be 8d 3e 64 ea>,
  macKeyVal: <Buffer 73 c1 c4 a4 f1 ef 9a 0d 6d 2d a9 f7 1d 04 e5 23 26 c8 e9 b4 17 ad e5 f6 75 30 e3 ac 5f 65 9a 08>,
  absValidity: 2018-03-21T22:24:45.588Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.8',
  serverPort: 22100,
  sessionKey: 
   { id: 50201480,
     cipherKeyVal: <Buffer a0 1f 08 ef 88 a6 a3 f6 64 55 1e be 8d 3e 64 ea>,
     macKeyVal: <Buffer 73 c1 c4 a4 f1 ef 9a 0d 6d 2d a9 f7 1d 04 e5 23 26 c8 e9 b4 17 ad e5 f6 75 30 e3 ac 5f 65 9a 08>,
     absValidity: 2018-03-21T22:24:45.588Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer aa 72 f4 b3 07 d2 be 6f>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.8:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 18 0.5 1521584741808
connected to auth! from local port 46020
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 19 0.47368421052631576 1521584801818
connected to auth! from local port 46170
received auth hello!
{ authId: 502, nonce: <Buffer cf 61 59 93 75 90 e0 02> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 73 f5 75 e6 ac bf 30 78>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201505,
  cipherKeyVal: <Buffer 75 c4 5b fd b7 c8 50 4a 7c 35 a7 2b 2a 5f ca ee>,
  macKeyVal: <Buffer 5b 62 94 ae da ce 1c c7 c1 01 9b dd e2 1b e9 1d 5f e7 95 a6 94 5e d9 33 57 e9 1c 99 6b 82 34 88>,
  absValidity: 2018-03-21T22:26:45.587Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.8',
  serverPort: 22100,
  sessionKey: 
   { id: 50201505,
     cipherKeyVal: <Buffer 75 c4 5b fd b7 c8 50 4a 7c 35 a7 2b 2a 5f ca ee>,
     macKeyVal: <Buffer 5b 62 94 ae da ce 1c c7 c1 01 9b dd e2 1b e9 1d 5f e7 95 a6 94 5e d9 33 57 e9 1c 99 6b 82 34 88>,
     absValidity: 2018-03-21T22:26:45.587Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer d9 cc 83 2a 6d 1c 19 b9>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.8:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 20 0.45 1521584861825
connected to auth! from local port 46346
received auth hello!
{ authId: 502, nonce: <Buffer 5c a6 79 0a 16 52 2f 3a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 54 54 03 66 c5 42 cf d8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201521,
  cipherKeyVal: <Buffer 44 fa 88 80 e9 5a 4f 0a b2 c0 ee aa cb fb af 10>,
  macKeyVal: <Buffer 7f ad 2c 69 15 42 ae e3 14 82 43 d7 81 27 a0 a0 18 94 9d c3 d5 80 4e 28 e2 19 64 9f 16 59 d0 3f>,
  absValidity: 2018-03-21T22:27:45.590Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.8',
  serverPort: 22100,
  sessionKey: 
   { id: 50201521,
     cipherKeyVal: <Buffer 44 fa 88 80 e9 5a 4f 0a b2 c0 ee aa cb fb af 10>,
     macKeyVal: <Buffer 7f ad 2c 69 15 42 ae e3 14 82 43 d7 81 27 a0 a0 18 94 9d c3 d5 80 4e 28 e2 19 64 9f 16 59 d0 3f>,
     absValidity: 2018-03-21T22:27:45.590Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 1b f5 0f 3c 30 2a 0c 70>
switching to HANDSHAKE_1_SENT
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.8:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 21 0.42857142857142855 1521584921832
connected to auth! from local port 46506
received auth hello!
{ authId: 502, nonce: <Buffer 72 42 be b2 5e ea 6a c3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7d 19 fa 95 2b 60 6f 17>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201537,
  cipherKeyVal: <Buffer e6 49 31 f3 7d ef d7 b8 ac 07 34 68 ff 41 97 ff>,
  macKeyVal: <Buffer dc 27 4d 94 3b 79 d3 c6 ca c2 26 4c ec 36 9a f9 a5 5b 8a 37 d3 15 64 ef b1 6b bb 23 73 71 4f ce>,
  absValidity: 2018-03-21T22:28:45.592Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.8',
  serverPort: 22100,
  sessionKey: 
   { id: 50201537,
     cipherKeyVal: <Buffer e6 49 31 f3 7d ef d7 b8 ac 07 34 68 ff 41 97 ff>,
     macKeyVal: <Buffer dc 27 4d 94 3b 79 d3 c6 ca c2 26 4c ec 36 9a f9 a5 5b 8a 37 d3 15 64 ef b1 6b bb 23 73 71 4f ce>,
     absValidity: 2018-03-21T22:28:45.592Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 66 8f 44 3c 90 e0 63 e4>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.8:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 22 0.4090909090909091 1521584981838
connected to auth! from local port 46676
received auth hello!
{ authId: 502, nonce: <Buffer bc 04 ca 3b c3 db 5a e6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f3 3f a2 3e b8 72 2b 6f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201553,
  cipherKeyVal: <Buffer b0 45 03 26 5d 58 c2 5b 74 0b 7d 78 e8 35 36 c4>,
  macKeyVal: <Buffer e4 ec 5a e1 c8 e2 3f 6a 94 d0 55 0d b5 e7 58 59 26 95 c0 76 5b 58 b4 62 8d b9 a9 92 be 1c ab 34>,
  absValidity: 2018-03-21T22:29:45.602Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.8',
  serverPort: 22100,
  sessionKey: 
   { id: 50201553,
     cipherKeyVal: <Buffer b0 45 03 26 5d 58 c2 5b 74 0b 7d 78 e8 35 36 c4>,
     macKeyVal: <Buffer e4 ec 5a e1 c8 e2 3f 6a 94 d0 55 0d b5 e7 58 59 26 95 c0 76 5b 58 b4 62 8d b9 a9 92 be 1c ab 34>,
     absValidity: 2018-03-21T22:29:45.602Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 16 dd ed 5d 94 60 2a 5a>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.8:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 23 0.391304347826087 1521585041845
connected to auth! from local port 46830
received auth hello!
{ authId: 502, nonce: <Buffer ad b2 fd 03 96 3a e1 55> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 68 84 91 c2 6c 2a 44 94>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201567,
  cipherKeyVal: <Buffer 31 21 ca 39 12 8b 81 8b 75 2b d1 3b 94 2b b7 96>,
  macKeyVal: <Buffer 51 bc 78 dc 15 0e 3b a8 8d 7a e2 fa f8 8c 41 64 7b 0e 54 ac 21 bd f3 cf 6d 05 82 59 71 7c d3 7c>,
  absValidity: 2018-03-21T22:30:45.582Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.8',
  serverPort: 22100,
  sessionKey: 
   { id: 50201567,
     cipherKeyVal: <Buffer 31 21 ca 39 12 8b 81 8b 75 2b d1 3b 94 2b b7 96>,
     macKeyVal: <Buffer 51 bc 78 dc 15 0e 3b a8 8d 7a e2 fa f8 8c 41 64 7b 0e 54 ac 21 bd f3 cf 6d 05 82 59 71 7c d3 7c>,
     absValidity: 2018-03-21T22:30:45.582Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer f7 af 0c c7 c4 07 da e5>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.8:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 24 0.375 1521585101851
connected to auth! from local port 46986
received auth hello!
{ authId: 502, nonce: <Buffer 54 bd c3 72 f4 cc 9e bb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b4 74 b7 93 28 84 0f f1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201581,
  cipherKeyVal: <Buffer 40 07 8c 4c 02 a2 5f ca bb 92 41 c1 b2 58 61 d5>,
  macKeyVal: <Buffer 79 06 b8 7f 40 86 3a e6 86 b2 b2 4b a4 ef 1b d4 81 70 47 02 6c 43 fe 88 f4 aa 35 f0 da 17 36 1f>,
  absValidity: 2018-03-21T22:31:45.569Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.8',
  serverPort: 22100,
  sessionKey: 
   { id: 50201581,
     cipherKeyVal: <Buffer 40 07 8c 4c 02 a2 5f ca bb 92 41 c1 b2 58 61 d5>,
     macKeyVal: <Buffer 79 06 b8 7f 40 86 3a e6 86 b2 b2 4b a4 ef 1b d4 81 70 47 02 6c 43 fe 88 f4 aa 35 f0 da 17 36 1f>,
     absValidity: 2018-03-21T22:31:45.569Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 6f c3 52 f1 b0 23 e2 ac>
switching to HANDSHAKE_1_SENT
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:31:57 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 10 24 0.4166666666666667 1521585118019
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 10 25 0.4 1521585161896
connected to auth! from local port 47138
received auth hello!
{ authId: 502, nonce: <Buffer 19 9a 7f 39 21 11 a0 63> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c5 11 75 65 e7 3d da a4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201594,
  cipherKeyVal: <Buffer a1 e3 b0 42 0e 45 c9 c6 ab cc e0 4b 41 a2 f5 a2>,
  macKeyVal: <Buffer 47 c1 c4 d9 27 73 3b aa e7 84 54 97 ef fc 14 71 1c b3 03 59 42 a9 ff a8 10 57 f4 ac 2a eb 54 d5>,
  absValidity: 2018-03-21T22:32:45.575Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.8',
  serverPort: 22100,
  sessionKey: 
   { id: 50201594,
     cipherKeyVal: <Buffer a1 e3 b0 42 0e 45 c9 c6 ab cc e0 4b 41 a2 f5 a2>,
     macKeyVal: <Buffer 47 c1 c4 d9 27 73 3b aa e7 84 54 97 ef fc 14 71 1c b3 03 59 42 a9 ff a8 10 57 f4 ac 2a eb 54 d5>,
     absValidity: 2018-03-21T22:32:45.575Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 42 8f 4d 4d b1 04 af 2e>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:32:57 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 11 25 0.44 1521585178054
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 11 26 0.4230769230769231 1521585221909
connected to auth! from local port 47272
received auth hello!
{ authId: 502, nonce: <Buffer 77 19 66 b5 18 33 a4 7a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8b ec 6e 3b 4f 38 a5 97>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201603,
  cipherKeyVal: <Buffer e4 07 07 19 03 98 d6 af 39 8b 89 ff 69 e9 b9 ef>,
  macKeyVal: <Buffer 8e 4c 46 20 80 fc 2c 57 c0 ba 85 9c a8 60 52 1e 07 24 8b 76 0b 00 ad 47 d8 16 b8 bc 7a 32 a1 5c>,
  absValidity: 2018-03-21T22:33:45.578Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.8',
  serverPort: 22100,
  sessionKey: 
   { id: 50201603,
     cipherKeyVal: <Buffer e4 07 07 19 03 98 d6 af 39 8b 89 ff 69 e9 b9 ef>,
     macKeyVal: <Buffer 8e 4c 46 20 80 fc 2c 57 c0 ba 85 9c a8 60 52 1e 07 24 8b 76 0b 00 ad 47 d8 16 b8 bc 7a 32 a1 5c>,
     absValidity: 2018-03-21T22:33:45.578Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer df 92 ae b1 77 be aa 07>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:33:49 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 12 26 0.46153846153846156 1521585229949
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 12 27 0.4444444444444444 1521585281962
connected to auth! from local port 47414
received auth hello!
{ authId: 502, nonce: <Buffer d4 f0 b5 d8 a8 ed 2c 5a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7d 43 56 1b 78 cb c6 e3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201616,
  cipherKeyVal: <Buffer e3 00 9c 98 91 47 5c 20 9d fe df 2d 07 bd 46 c7>,
  macKeyVal: <Buffer 5a 26 46 24 9b ac 80 a0 e7 97 5b 1b d1 a2 87 28 61 a0 70 d0 9a ea 7c 18 ca c2 c7 f3 48 0d 64 61>,
  absValidity: 2018-03-21T22:34:45.597Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.8',
  serverPort: 22100,
  sessionKey: 
   { id: 50201616,
     cipherKeyVal: <Buffer e3 00 9c 98 91 47 5c 20 9d fe df 2d 07 bd 46 c7>,
     macKeyVal: <Buffer 5a 26 46 24 9b ac 80 a0 e7 97 5b 1b d1 a2 87 28 61 a0 70 d0 9a ea 7c 18 ca c2 c7 f3 48 0d 64 61>,
     absValidity: 2018-03-21T22:34:45.597Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 71 73 89 a3 05 b2 79 7e>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:34:49 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 13 27 0.48148148148148145 1521585289864
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 13 28 0.4642857142857143 1521585342014
connected to auth! from local port 47554
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 13 29 0.4482758620689655 1521585402025
connected to auth! from local port 47690
