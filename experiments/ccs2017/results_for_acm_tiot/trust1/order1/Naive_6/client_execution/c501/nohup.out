changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c501.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c501',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 76 4e ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521583782677
connected to auth! from local port 46640
received auth hello!
{ authId: 501, nonce: <Buffer 18 cc 01 4d e9 b3 7b 79> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 78 e6 36 6e 01 f1 ce 43>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 67 60 29 79 c3 48 f5 85 f9 27 f6 41 04 5b 6c ec>,
  macKeyVal: <Buffer 2e b9 0f 37 4e 4a 84 4d aa 9f 53 5d f9 40 a7 d2 74 b4 c9 4d f6 67 21 23 32 4b e7 ba 1e d2 4a b1>,
  absValidity: 2018-03-20T23:09:42.887Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100610,
  cipherKeyVal: <Buffer c6 2c 91 9d 92 ea 9d ca d8 e6 79 07 2d 33 a5 b3>,
  macKeyVal: <Buffer 7d 37 8d f6 12 a5 2e 49 61 19 f0 77 1f f5 4f ff 7c 32 9f 58 67 81 7b 69 3a 92 0a 29 4a f9 12 04>,
  absValidity: 2018-03-21T22:09:42.884Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50100610,
     cipherKeyVal: <Buffer c6 2c 91 9d 92 ea 9d ca d8 e6 79 07 2d 33 a5 b3>,
     macKeyVal: <Buffer 7d 37 8d f6 12 a5 2e 49 61 19 f0 77 1f f5 4f ff 7c 32 9f 58 67 81 7b 69 3a 92 0a 29 4a f9 12 04>,
     absValidity: 2018-03-21T22:09:42.884Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 3a c9 a9 b1 a8 ae f6 3f>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:09:43 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521583783882
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521583842734
connected to auth! from local port 46864
received auth hello!
{ authId: 501, nonce: <Buffer 22 3c f4 09 03 49 81 8d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 74 1d 9c 15 1d a9 2a dc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100618,
  cipherKeyVal: <Buffer 88 dc 75 9c a4 f7 e4 56 91 80 7e 7e 1f c2 c9 ca>,
  macKeyVal: <Buffer 2c 54 6a ac bb e1 1e cd 9e 14 dc b4 dd 4f dc 68 d6 e2 b3 4c 10 dc 0f e5 f1 d3 50 37 04 96 a1 83>,
  absValidity: 2018-03-21T22:10:43.024Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50100618,
     cipherKeyVal: <Buffer 88 dc 75 9c a4 f7 e4 56 91 80 7e 7e 1f c2 c9 ca>,
     macKeyVal: <Buffer 2c 54 6a ac bb e1 1e cd 9e 14 dc b4 dd 4f dc 68 d6 e2 b3 4c 10 dc 0f e5 f1 d3 50 37 04 96 a1 83>,
     absValidity: 2018-03-21T22:10:43.024Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 82 5f 68 c6 34 d0 9d 08>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:10:43 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521583844437
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521583902741
connected to auth! from local port 47134
received auth hello!
{ authId: 501, nonce: <Buffer d9 e2 8b 7c 0c a0 4d 55> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3c 1b 5f 57 35 60 5d 75>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100626,
  cipherKeyVal: <Buffer b9 58 96 e3 37 2e 30 e7 d6 6a 96 86 55 c5 bf 3a>,
  macKeyVal: <Buffer c4 e0 88 68 3e 4d 20 9f fd 8e f0 7a bc c9 a4 3d c5 bc 79 3d 15 75 19 85 23 24 5e 96 b8 56 2d 62>,
  absValidity: 2018-03-21T22:11:43.016Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50100626,
     cipherKeyVal: <Buffer b9 58 96 e3 37 2e 30 e7 d6 6a 96 86 55 c5 bf 3a>,
     macKeyVal: <Buffer c4 e0 88 68 3e 4d 20 9f fd 8e f0 7a bc c9 a4 3d c5 bc 79 3d 15 75 19 85 23 24 5e 96 b8 56 2d 62>,
     absValidity: 2018-03-21T22:11:43.016Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 94 a5 b2 4b 9d 6e 76 46>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:11:43 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521583904381
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521583962796
connected to auth! from local port 47404
received auth hello!
{ authId: 501, nonce: <Buffer 41 c4 6e 67 2e 48 3f 0c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f9 0c 90 df 60 84 25 9c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100634,
  cipherKeyVal: <Buffer 52 5c 81 ec 53 74 b7 8b 44 21 73 aa 0c 96 90 30>,
  macKeyVal: <Buffer 46 60 46 a0 74 7e eb 18 21 d3 da bd 42 ae 31 c0 9b 5b 6f ae 31 fe 1d 9a d8 c3 a1 4f 88 69 b4 c7>,
  absValidity: 2018-03-21T22:12:43.058Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50100634,
     cipherKeyVal: <Buffer 52 5c 81 ec 53 74 b7 8b 44 21 73 aa 0c 96 90 30>,
     macKeyVal: <Buffer 46 60 46 a0 74 7e eb 18 21 d3 da bd 42 ae 31 c0 9b 5b 6f ae 31 fe 1d 9a d8 c3 a1 4f 88 69 b4 c7>,
     absValidity: 2018-03-21T22:12:43.058Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer f6 d7 ec 8b af d7 66 da>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:12:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521583964436
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521584022853
connected to auth! from local port 47674
received auth hello!
{ authId: 501, nonce: <Buffer 47 93 b6 f3 01 be d5 2c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f6 09 3f 5e 9c 19 f4 66>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100642,
  cipherKeyVal: <Buffer 13 76 b2 f9 f8 01 db 28 81 ae 1f dd 95 b4 3f 4e>,
  macKeyVal: <Buffer 09 fc ea 2e 73 77 6f be c8 ed 91 e7 78 7f 17 fd 01 b8 97 a4 6c 34 cf 5f e9 ef a9 e2 dc de fa 4d>,
  absValidity: 2018-03-21T22:13:43.063Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50100642,
     cipherKeyVal: <Buffer 13 76 b2 f9 f8 01 db 28 81 ae 1f dd 95 b4 3f 4e>,
     macKeyVal: <Buffer 09 fc ea 2e 73 77 6f be c8 ed 91 e7 78 7f 17 fd 01 b8 97 a4 6c 34 cf 5f e9 ef a9 e2 dc de fa 4d>,
     absValidity: 2018-03-21T22:13:43.063Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer d3 4d 0b ac 34 a2 d3 b5>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:13:43 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521584024233
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521584082909
connected to auth! from local port 47944
received auth hello!
{ authId: 501, nonce: <Buffer 52 80 89 71 e3 60 34 88> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8d 21 0d 1e 6f 9e 0b 5d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100650,
  cipherKeyVal: <Buffer 6e 12 90 60 33 20 9b 64 f1 dd 85 24 71 48 e9 c6>,
  macKeyVal: <Buffer 66 9f a3 d6 fc 53 b0 91 15 88 a2 0e 7f c2 3c b5 c0 35 5c 2f d8 d0 8a 44 63 4c 5d c0 83 c5 b3 c9>,
  absValidity: 2018-03-21T22:14:43.093Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50100650,
     cipherKeyVal: <Buffer 6e 12 90 60 33 20 9b 64 f1 dd 85 24 71 48 e9 c6>,
     macKeyVal: <Buffer 66 9f a3 d6 fc 53 b0 91 15 88 a2 0e 7f c2 3c b5 c0 35 5c 2f d8 d0 8a 44 63 4c 5d c0 83 c5 b3 c9>,
     absValidity: 2018-03-21T22:14:43.093Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 3d ef 9a d4 18 f9 ef 01>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:14:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521584084536
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521584142965
connected to auth! from local port 48214
received auth hello!
{ authId: 501, nonce: <Buffer 49 36 be 06 81 9f 26 57> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8a a3 a0 5b 2c 3c b7 99>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100658,
  cipherKeyVal: <Buffer 55 d2 3f 0e 5a ac 5d 1c 4a 71 c9 7e ff 7b ba 0f>,
  macKeyVal: <Buffer b0 6e a8 4c 09 20 ab ee 19 1e c5 e5 07 42 c4 7f 2a 3c 98 9b 95 3b c6 55 e8 ac 8b d6 d9 45 dc e3>,
  absValidity: 2018-03-21T22:15:43.190Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50100658,
     cipherKeyVal: <Buffer 55 d2 3f 0e 5a ac 5d 1c 4a 71 c9 7e ff 7b ba 0f>,
     macKeyVal: <Buffer b0 6e a8 4c 09 20 ab ee 19 1e c5 e5 07 42 c4 7f 2a 3c 98 9b 95 3b c6 55 e8 ac 8b d6 d9 45 dc e3>,
     absValidity: 2018-03-21T22:15:43.190Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer d5 34 84 1f 3c e8 b9 62>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:15:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521584144672
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521584203024
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 9 0.7777777777777778 1521584263033
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.1:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 10 0.7 1521584323041
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 11 0.6363636363636364 1521584383049
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 56882
received auth hello!
{ authId: 502, nonce: <Buffer 75 f3 3a f9 55 7c 63 0b> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '016245740808',
  notBefore: 2018-03-20T22:05:54.000Z,
  notAfter: 2018-03-21T22:07:34.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'E4:19:6D:0C:8B:16:48:A2:32:B6:94:73:F6:80:86:72:13:AA:3E:3D',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'E40B9EF20959AA49D02016EC2E9896074EE0818689EAD7319ECC8ED8C9557412ED46C95E67464598F6233ECEB8BF25A876F0D30B65CED2B1FED8D1F07CF9042FD7F86E3B637BE17FBFD7C9F0DB5850835170B354A52C175B769A37BA578F965436FF29BCFD54C5D4E939E02214503C8A69FFBBF0EC06657DF9498BE98DEB26B62E1453817F6DFAE9B50EE21C5A643FF0292539838A682562303CB77FC6028B22B30B78957E4F78E539103F991928681EBF3100D31960F43F8ECFC6C2F3063B353E92BFFEF77A49BBCBF417864AE8169AA061F590E5FB3393A4592EFA1100FC186B95B83724CA0B11D8BC02BC9BD4F9E08552DE2D1EB0EE0E866E41A520730E6F',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJFdAgIMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDMy\nMDIyMDU1NFoXDTE4MDMyMTIyMDczNFowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDkC57yCVmqSdAgFuwumJYHTuCBhonq1zGezI7YyVV0Eu1GyV5n\nRkWY9iM+zri/Jah28NMLZc7Ssf7Y0fB8+QQv1/huO2N74X+/18nw21hQg1Fws1Sl\nLBdbdpo3ulePllQ2/ym8/VTF1Ok54CIUUDyKaf+78OwGZX35SYvpjesmti4UU4F/\nbfrptQ7iHFpkP/ApJTmDimglYjA8t3/GAosiswt4lX5PeOU5ED+ZGShoHr8xANMZ\nYPQ/js/GwvMGOzU+kr/+93pJu8v0F4ZK6BaaoGH1kOX7M5OkWS76EQD8GGuVuDck\nygsR2LwCvJvU+eCFUt4tHrDuDoZuQaUgcw5vAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBABkJcVLNsxiUWt25hTnwKEx7IA6XcBdq\nQAG5AQhTIOW7Dy3BCfN8WaAdvH2bBAdeBUGoge6adhSadohUK/dBWzdfL1zKcXQ8\nt8riR0jbgml5opFtx57BaKJUWeVwvWoj4kouLbEalRJw/EuULcxV4+2A1n6Q+q3I\nqrLJBmIRounZCERGRmOwXgkQ/kIEdgSsHQmOqQ1Vs6Fc4jmsyIWkAGiGoWsdRs33\nCc+Ls/p3Qf+m6jz5zrzelh5dAsNBC1hRc3Z5O1fHDPAJ8Ak8YOWhflE+vHQKt2dt\nEAoR7vwzF2xK/1u19vbMdzwqAOiZGFvuXqg5WBgHciMzXbSKh6gYx1I=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 2
to: 3
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 12 0.5833333333333334 1521584443060
connected to auth! from local port 57080
received auth hello!
{ authId: 502, nonce: <Buffer c4 ca e1 7b e0 4d 6d 02> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer ac e9 10 89 ae 58 ae 35>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer ab 7a 29 d8 43 a2 0c dc ed a9 54 3b 9d f8 8c e7>,
  macKeyVal: <Buffer 24 4d fe 43 60 97 ac 9a c1 55 b2 63 3b f5 78 b8 2b c2 c6 d4 09 60 a2 2e 56 02 7b 99 64 aa f4 dd>,
  absValidity: 2018-03-20T23:20:45.533Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201423,
  cipherKeyVal: <Buffer 27 93 49 23 a2 6a f8 9c 1b e3 8a e3 8f 0f da 51>,
  macKeyVal: <Buffer 97 c4 c8 35 63 03 fe b6 49 8f 82 14 cc 2f 5d 42 53 80 3f 34 17 5b 5a fe 30 94 11 79 1c 3a c5 36>,
  absValidity: 2018-03-21T22:20:45.532Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50201423,
     cipherKeyVal: <Buffer 27 93 49 23 a2 6a f8 9c 1b e3 8a e3 8f 0f da 51>,
     macKeyVal: <Buffer 97 c4 c8 35 63 03 fe b6 49 8f 82 14 cc 2f 5d 42 53 80 3f 34 17 5b 5a fe 30 94 11 79 1c 3a c5 36>,
     absValidity: 2018-03-21T22:20:45.532Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 4c f6 5b 8a 47 e1 20 fd>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.24:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 13 0.5384615384615384 1521584503067
connected to auth! from local port 57294
received auth hello!
{ authId: 502, nonce: <Buffer b5 f7 c7 14 5d a7 e7 87> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a4 8d d5 24 27 05 6c 00>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201438,
  cipherKeyVal: <Buffer 39 74 c4 79 0c a1 3e 18 0f 7a e4 40 d2 a6 b7 9b>,
  macKeyVal: <Buffer 79 c1 18 65 29 69 9a b7 dc 48 15 70 a4 6d 89 1f 35 6a 52 41 78 69 54 b1 c8 33 39 b0 d4 7a cc cf>,
  absValidity: 2018-03-21T22:21:46.821Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50201438,
     cipherKeyVal: <Buffer 39 74 c4 79 0c a1 3e 18 0f 7a e4 40 d2 a6 b7 9b>,
     macKeyVal: <Buffer 79 c1 18 65 29 69 9a b7 dc 48 15 70 a4 6d 89 1f 35 6a 52 41 78 69 54 b1 c8 33 39 b0 d4 7a cc cf>,
     absValidity: 2018-03-21T22:21:46.821Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer bc 45 0b 2c 6a e6 c6 c7>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.24:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 14 0.5 1521584563074
connected to auth! from local port 57518
received auth hello!
{ authId: 502, nonce: <Buffer 42 a4 cf dc 53 d9 1c fd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cc a4 20 6c 56 7b 54 5a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201456,
  cipherKeyVal: <Buffer 1e 66 07 c4 bc a3 38 59 c2 07 e9 ac 82 a2 fc 17>,
  macKeyVal: <Buffer 8e b6 07 c1 f9 c5 05 7f d5 ca dd d1 f6 dd 28 77 7b ea 35 87 85 fd 3d 5d fc ea 9e e8 29 b0 cb 74>,
  absValidity: 2018-03-21T22:22:46.835Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50201456,
     cipherKeyVal: <Buffer 1e 66 07 c4 bc a3 38 59 c2 07 e9 ac 82 a2 fc 17>,
     macKeyVal: <Buffer 8e b6 07 c1 f9 c5 05 7f d5 ca dd d1 f6 dd 28 77 7b ea 35 87 85 fd 3d 5d fc ea 9e e8 29 b0 cb 74>,
     absValidity: 2018-03-21T22:22:46.835Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 7d 6e f6 56 1f 8a e3 56>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.24:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 15 0.4666666666666667 1521584623080
connected to auth! from local port 57706
received auth hello!
{ authId: 502, nonce: <Buffer ba 57 ec 23 cb c4 e8 a3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d9 2a 97 82 13 ff 87 1b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201467,
  cipherKeyVal: <Buffer c7 58 d0 60 bf 55 79 26 f2 f2 5f d2 ee eb 9e 0e>,
  macKeyVal: <Buffer f9 68 40 a3 de e1 33 16 c4 fb 39 ab 9a 1a 9b b1 4b 55 91 e6 2e 6d ed 84 ab b5 f5 32 47 16 50 d7>,
  absValidity: 2018-03-21T22:23:46.823Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50201467,
     cipherKeyVal: <Buffer c7 58 d0 60 bf 55 79 26 f2 f2 5f d2 ee eb 9e 0e>,
     macKeyVal: <Buffer f9 68 40 a3 de e1 33 16 c4 fb 39 ab 9a 1a 9b b1 4b 55 91 e6 2e 6d ed 84 ab b5 f5 32 47 16 50 d7>,
     absValidity: 2018-03-21T22:23:46.823Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 6a 8d c7 1b 32 dc d9 16>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.24:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 16 0.4375 1521584683086
connected to auth! from local port 57912
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 17 0.4117647058823529 1521584743096
connected to auth! from local port 58064
received auth hello!
{ authId: 502, nonce: <Buffer ef 85 b5 a6 14 52 19 fd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 35 bb ad 8b da a4 c5 64>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201493,
  cipherKeyVal: <Buffer 77 3c 34 73 29 a4 96 be c8 7c 20 31 5c e9 9a f3>,
  macKeyVal: <Buffer 8c 3b 9f 90 2e 4d 2b 87 7f 7b ef 5b ee a3 0b 61 0e 20 dd e7 af aa 59 fe 25 9d dc 35 c1 3a 98 a9>,
  absValidity: 2018-03-21T22:25:50.840Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50201493,
     cipherKeyVal: <Buffer 77 3c 34 73 29 a4 96 be c8 7c 20 31 5c e9 9a f3>,
     macKeyVal: <Buffer 8c 3b 9f 90 2e 4d 2b 87 7f 7b ef 5b ee a3 0b 61 0e 20 dd e7 af aa 59 fe 25 9d dc 35 c1 3a 98 a9>,
     absValidity: 2018-03-21T22:25:50.840Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 5c d7 51 47 9e bf 75 a4>
switching to HANDSHAKE_1_SENT
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.24:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 18 0.3888888888888889 1521584803098
connected to auth! from local port 58216
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 19 0.3684210526315789 1521584863108
connected to auth! from local port 58388
received auth hello!
{ authId: 502, nonce: <Buffer 32 80 58 bd 75 85 ef 58> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 69 f9 b0 cd a2 80 9c 2f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201523,
  cipherKeyVal: <Buffer 94 e4 65 85 70 8a b6 db c9 bd 4a 89 b2 4e 3f d4>,
  macKeyVal: <Buffer b8 37 35 f1 e2 4f 65 29 03 b8 0b 8f dd 82 1f ad d7 e2 13 c7 83 25 b1 1e fb ea 2f 39 f8 21 5e 0d>,
  absValidity: 2018-03-21T22:27:50.836Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50201523,
     cipherKeyVal: <Buffer 94 e4 65 85 70 8a b6 db c9 bd 4a 89 b2 4e 3f d4>,
     macKeyVal: <Buffer b8 37 35 f1 e2 4f 65 29 03 b8 0b 8f dd 82 1f ad d7 e2 13 c7 83 25 b1 1e fb ea 2f 39 f8 21 5e 0d>,
     absValidity: 2018-03-21T22:27:50.836Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 91 95 f9 e9 69 ee 61 82>
switching to HANDSHAKE_1_SENT
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.24:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 20 0.35 1521584923112
connected to auth! from local port 58552
received auth hello!
{ authId: 502, nonce: <Buffer 7c a9 f0 4a 51 11 2e 1d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 08 3e 74 73 b8 03 94 b0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201539,
  cipherKeyVal: <Buffer 0c ed 4b 60 ce 5c 2a b1 f0 ee 77 0d a5 77 09 9a>,
  macKeyVal: <Buffer cc ee 9a 22 f3 d1 ae 99 82 e5 da 0d a0 a7 a7 ba 8e d7 b2 19 76 5b 59 cb 8f 46 fe d5 43 a7 89 e7>,
  absValidity: 2018-03-21T22:28:50.855Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50201539,
     cipherKeyVal: <Buffer 0c ed 4b 60 ce 5c 2a b1 f0 ee 77 0d a5 77 09 9a>,
     macKeyVal: <Buffer cc ee 9a 22 f3 d1 ae 99 82 e5 da 0d a0 a7 a7 ba 8e d7 b2 19 76 5b 59 cb 8f 46 fe d5 43 a7 89 e7>,
     absValidity: 2018-03-21T22:28:50.855Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 73 97 01 c7 30 f4 54 f8>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.24:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 21 0.3333333333333333 1521584983114
connected to auth! from local port 58718
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 22 0.3181818181818182 1521585043123
connected to auth! from local port 58872
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 23 0.30434782608695654 1521585103126
connected to auth! from local port 59028
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 24 0.2916666666666667 1521585163137
connected to auth! from local port 59184
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 25 0.28 1521585223147
connected to auth! from local port 59314
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 26 0.2692307692307692 1521585283158
connected to auth! from local port 59456
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 27 0.25925925925925924 1521585343168
connected to auth! from local port 59596
Handler: Error in secure comm - details: Auth hello timedout ...
received auth hello!
{ authId: 502, nonce: <Buffer f3 e3 d4 4c 81 c0 63 ea> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: write after end
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 28 0.25 1521585403173
connected to auth! from local port 59736
disconnected from auth
Handler: Error in secure comm - details: Connection with Auth timed out...
Handler: Error in secure comm - details: Auth hello timedout ...
received auth hello!
{ authId: 502, nonce: <Buffer e3 1f f0 c0 3e a8 0a 6c> }
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: write after end
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 29 0.2413793103448276 1521585463174
connected to auth! from local port 59884
