changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c525.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c525',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 67 49 42 41 41 4b 43 41 51 45 41 74 74 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521583862701
connected to auth! from local port 41866
received auth hello!
{ authId: 504, nonce: <Buffer 4c e3 7d fd 0c 59 76 15> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 15 c6 c9 b7 b2 73 a6 db>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer e2 fb 79 0b e5 07 19 b0 18 9f f0 35 89 57 2c 0f>,
  macKeyVal: <Buffer d0 55 98 97 34 ad 1e df b4 8f 8e 23 be d0 60 80 a7 d6 77 1e 3e 52 94 1c 27 81 6b ae 5c f8 07 c3>,
  absValidity: 2018-03-20T23:11:05.931Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400193,
  cipherKeyVal: <Buffer a1 b3 06 f6 44 74 1e a8 2e 78 d5 bf d1 1a 56 cb>,
  macKeyVal: <Buffer bf 5b a4 4d d9 05 79 a2 65 e0 0e 25 6a 60 35 d2 f5 15 58 94 fb 62 20 09 e0 14 c4 3b ac ef d8 a6>,
  absValidity: 2018-03-21T22:11:05.930Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50400193,
     cipherKeyVal: <Buffer a1 b3 06 f6 44 74 1e a8 2e 78 d5 bf d1 1a 56 cb>,
     macKeyVal: <Buffer bf 5b a4 4d d9 05 79 a2 65 e0 0e 25 6a 60 35 d2 f5 15 58 94 fb 62 20 09 e0 14 c4 3b ac ef d8 a6>,
     absValidity: 2018-03-21T22:11:05.930Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer e0 95 79 76 2f a4 ca 41>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:11:10 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521583870672
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521583922750
connected to auth! from local port 42136
received auth hello!
{ authId: 504, nonce: <Buffer 73 51 4d f8 89 12 bc 46> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 64 54 e8 af c9 ba 8c 80>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400199,
  cipherKeyVal: <Buffer f1 be 93 2d 75 f9 06 de b3 3b 97 72 dd 00 7f 8c>,
  macKeyVal: <Buffer e5 5b 59 21 28 ef 38 39 23 24 2e c2 33 04 df 7b 18 ce aa 1f a5 be 93 fc 97 74 c9 0f 6c d2 9c b7>,
  absValidity: 2018-03-21T22:12:05.947Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50400199,
     cipherKeyVal: <Buffer f1 be 93 2d 75 f9 06 de b3 3b 97 72 dd 00 7f 8c>,
     macKeyVal: <Buffer e5 5b 59 21 28 ef 38 39 23 24 2e c2 33 04 df 7b 18 ce aa 1f a5 be 93 fc 97 74 c9 0f 6c d2 9c b7>,
     absValidity: 2018-03-21T22:12:05.947Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 4f 89 d8 e4 4e ea 10 7c>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:12:10 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521583931440
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521583982797
connected to auth! from local port 42406
received auth hello!
{ authId: 504, nonce: <Buffer 05 06 98 61 9a 63 24 01> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 03 6d 30 9b e4 8b 3c be>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400205,
  cipherKeyVal: <Buffer ed 89 74 5a 9a 90 b0 20 8e 67 bd 77 a8 e8 5f 65>,
  macKeyVal: <Buffer 0d 55 20 7d e1 9b 18 45 72 60 94 4b 46 06 3c f9 e6 db c1 8d ee fe ce 7a bc 5e 54 9e 03 40 84 48>,
  absValidity: 2018-03-21T22:13:05.953Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50400205,
     cipherKeyVal: <Buffer ed 89 74 5a 9a 90 b0 20 8e 67 bd 77 a8 e8 5f 65>,
     macKeyVal: <Buffer 0d 55 20 7d e1 9b 18 45 72 60 94 4b 46 06 3c f9 e6 db c1 8d ee fe ce 7a bc 5e 54 9e 03 40 84 48>,
     absValidity: 2018-03-21T22:13:05.953Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer f6 91 4c 08 00 fb c9 33>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:13:10 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521583990750
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521584042835
connected to auth! from local port 42674
received auth hello!
{ authId: 504, nonce: <Buffer 26 7f 40 8b 3e 04 38 d0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer af d8 9e b1 31 44 8c d8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400211,
  cipherKeyVal: <Buffer 58 0c a6 8c 27 fe 3b f5 9f ba 1c 1d ff 58 59 a6>,
  macKeyVal: <Buffer 38 40 c3 4a 75 4f 5b 46 b8 2e c2 e4 26 49 c4 20 f3 43 3e dd 24 51 2a 0a d8 a3 ce 88 d2 17 07 4c>,
  absValidity: 2018-03-21T22:14:05.993Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50400211,
     cipherKeyVal: <Buffer 58 0c a6 8c 27 fe 3b f5 9f ba 1c 1d ff 58 59 a6>,
     macKeyVal: <Buffer 38 40 c3 4a 75 4f 5b 46 b8 2e c2 e4 26 49 c4 20 f3 43 3e dd 24 51 2a 0a d8 a3 ce 88 d2 17 07 4c>,
     absValidity: 2018-03-21T22:14:05.993Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 50 31 b9 f2 87 59 42 e6>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:14:10 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521584050957
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521584102858
connected to auth! from local port 42944
received auth hello!
{ authId: 504, nonce: <Buffer e1 1b 82 f4 0c 23 c2 71> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a3 e7 48 58 22 c4 41 30>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400217,
  cipherKeyVal: <Buffer 5e 14 96 64 6f 76 cd c3 88 8f 34 d1 22 30 01 0b>,
  macKeyVal: <Buffer 49 6e d4 dc 71 5e 39 38 59 a7 bf ee 4d 9b 61 5f 1a 1a a9 1a 03 d9 95 ce 00 42 b2 33 b3 86 c8 c3>,
  absValidity: 2018-03-21T22:15:06.067Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50400217,
     cipherKeyVal: <Buffer 5e 14 96 64 6f 76 cd c3 88 8f 34 d1 22 30 01 0b>,
     macKeyVal: <Buffer 49 6e d4 dc 71 5e 39 38 59 a7 bf ee 4d 9b 61 5f 1a 1a a9 1a 03 d9 95 ce 00 42 b2 33 b3 86 c8 c3>,
     absValidity: 2018-03-21T22:15:06.067Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 7b 54 41 f1 fc ed 48 5a>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:15:10 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521584110931
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521584162910
connected to auth! from local port 43214
received auth hello!
{ authId: 504, nonce: <Buffer 7b ef 85 b0 f0 ff 44 d1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6b a4 7d 8f be 26 b2 34>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400223,
  cipherKeyVal: <Buffer bf 29 71 8b fb 53 44 4c 23 46 a6 ab 52 4f 14 68>,
  macKeyVal: <Buffer 06 b6 ad cf 0c aa 9c 01 c7 d7 58 ea 7c 59 6f 65 bd 36 f2 7f 0f 08 ab 44 de 32 7d de d8 52 45 05>,
  absValidity: 2018-03-21T22:16:06.074Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50400223,
     cipherKeyVal: <Buffer bf 29 71 8b fb 53 44 4c 23 46 a6 ab 52 4f 14 68>,
     macKeyVal: <Buffer 06 b6 ad cf 0c aa 9c 01 c7 d7 58 ea 7c 59 6f 65 bd 36 f2 7f 0f 08 ab 44 de 32 7d de d8 52 45 05>,
     absValidity: 2018-03-21T22:16:06.074Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer b9 d9 39 86 b4 93 c8 08>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:16:11 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521584171680
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521584222962
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 8 0.75 1521584282972
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.6:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 9 0.6666666666666666 1521584342980
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.3:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 10 0.6 1521584402988
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.1:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 11 0.5454545454545454 1521584462996
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 2
to: 3
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 12 0.5 1521584523003
failure in connection with Auth : authFailureCount: 6
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 3
to: 4
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 13 0.46153846153846156 1521584583010
failure in connection with Auth : authFailureCount: 7
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 4
to: 5
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 46012
received auth hello!
{ authId: 502, nonce: <Buffer 2f a5 35 d2 0c e7 d7 fc> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth504',
     commonName: '10.0.0.7' },
  serial: '016245740CB7',
  notBefore: 2018-03-20T22:05:56.000Z,
  notAfter: 2018-03-21T22:07:36.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '36:5F:CE:E1:EA:99:80:10:89:FF:F6:13:CA:5E:17:59:60:B8:38:32',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'E40B9EF20959AA49D02016EC2E9896074EE0818689EAD7319ECC8ED8C9557412ED46C95E67464598F6233ECEB8BF25A876F0D30B65CED2B1FED8D1F07CF9042FD7F86E3B637BE17FBFD7C9F0DB5850835170B354A52C175B769A37BA578F965436FF29BCFD54C5D4E939E02214503C8A69FFBBF0EC06657DF9498BE98DEB26B62E1453817F6DFAE9B50EE21C5A643FF0292539838A682562303CB77FC6028B22B30B78957E4F78E539103F991928681EBF3100D31960F43F8ECFC6C2F3063B353E92BFFEF77A49BBCBF417864AE8169AA061F590E5FB3393A4592EFA1100FC186B95B83724CA0B11D8BC02BC9BD4F9E08552DE2D1EB0EE0E866E41A520730E6F',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJFdAy3MA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDQxETAPBgNVBAMMCDEwLjAuMC43MB4XDTE4MDMy\nMDIyMDU1NloXDTE4MDMyMTIyMDczNlowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDkC57yCVmqSdAgFuwumJYHTuCBhonq1zGezI7YyVV0Eu1GyV5n\nRkWY9iM+zri/Jah28NMLZc7Ssf7Y0fB8+QQv1/huO2N74X+/18nw21hQg1Fws1Sl\nLBdbdpo3ulePllQ2/ym8/VTF1Ok54CIUUDyKaf+78OwGZX35SYvpjesmti4UU4F/\nbfrptQ7iHFpkP/ApJTmDimglYjA8t3/GAosiswt4lX5PeOU5ED+ZGShoHr8xANMZ\nYPQ/js/GwvMGOzU+kr/+93pJu8v0F4ZK6BaaoGH1kOX7M5OkWS76EQD8GGuVuDck\nygsR2LwCvJvU+eCFUt4tHrDuDoZuQaUgcw5vAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAHjpcsYdFl8Ksztl0CxHnpJb6pcspFG4\nGrTJJl3jZeEiMAUTvzLYUIFsN0fl4AjcnVY0xH6l+B8toQHSF6iCjX3CzX/SRuAC\no4iMTzsLdKxgkOo4RQIo0vIYe8g//4+m/fsidWvkgn1Meh3+AEjteyx6+tJfxFav\nZa+vaXZnBwqQo7f3NtiIlEbak72beZiG/JjFHIkrTQDNKnmzFZqaZMLY+fZLLBaV\niEsw07AQ70SJKW575LK7BnYOkojPvQfyhnuWcD6JDyDRCqXOVEriu95aej6WWwID\n2uznotgjsnnLJPTqvAkrxoloEgDyjhfNbtHjCWuhLquexyfbFJwq714=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 5
to: 6
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 14 0.42857142857142855 1521584643019
connected to auth! from local port 46184
received auth hello!
{ authId: 502, nonce: <Buffer 1c 00 49 3e 3b 5c 71 61> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer f7 76 96 8f dc d5 d7 59>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 1f 32 5a e8 9a f7 bf 07 39 80 7c 09 40 ce ac 34>,
  macKeyVal: <Buffer 73 e1 1a 14 94 c7 12 42 c3 c0 f4 71 ba c0 e6 42 e1 86 92 b6 fa ed 69 8e 1b 35 72 9e 27 77 06 76>,
  absValidity: 2018-03-20T23:24:06.837Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201470,
  cipherKeyVal: <Buffer d2 98 f9 ba 73 27 c9 72 e0 77 a4 2a 6d 11 a2 10>,
  macKeyVal: <Buffer 3e 6e 38 3e 39 39 d2 8a eb a5 91 2f d3 a0 76 6c b7 d7 5d 2b bd e3 cb fe 89 68 fd 23 93 19 db ac>,
  absValidity: 2018-03-21T22:24:06.836Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50201470,
     cipherKeyVal: <Buffer d2 98 f9 ba 73 27 c9 72 e0 77 a4 2a 6d 11 a2 10>,
     macKeyVal: <Buffer 3e 6e 38 3e 39 39 d2 8a eb a5 91 2f d3 a0 76 6c b7 d7 5d 2b bd e3 cb fe 89 68 fd 23 93 19 db ac>,
     absValidity: 2018-03-21T22:24:06.836Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 49 69 5a 8f a4 17 e4 a3>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.42:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 15 0.4 1521584703026
connected to auth! from local port 46380
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 16 0.375 1521584763037
connected to auth! from local port 46530
received auth hello!
{ authId: 502, nonce: <Buffer e8 48 7a 6b 49 cc c8 cb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e9 e0 cc 0c b9 d8 86 08>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201504,
  cipherKeyVal: <Buffer 11 26 bf bd 58 7c 2d e6 d0 24 cd 34 ce 40 fe 3a>,
  macKeyVal: <Buffer 65 27 4a bb 46 8d 33 90 e0 a7 95 2d ca 7d 07 25 00 25 6c bc 97 a0 76 02 9b a7 7b d8 e4 4d f9 5d>,
  absValidity: 2018-03-21T22:26:42.821Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50201504,
     cipherKeyVal: <Buffer 11 26 bf bd 58 7c 2d e6 d0 24 cd 34 ce 40 fe 3a>,
     macKeyVal: <Buffer 65 27 4a bb 46 8d 33 90 e0 a7 95 2d ca 7d 07 25 00 25 6c bc 97 a0 76 02 9b a7 7b d8 e4 4d f9 5d>,
     absValidity: 2018-03-21T22:26:42.821Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 12 e2 b2 ad 4b 44 d3 ad>
switching to HANDSHAKE_1_SENT
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 17 0.35294117647058826 1521584823057
connected to auth! from local port 46688
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.42:undefined
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 18 0.3333333333333333 1521584883065
connected to auth! from local port 46854
received auth hello!
{ authId: 502, nonce: <Buffer 9d be 7b ce 5b 56 d7 29> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1c f5 c9 76 3d fc 8d 10>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201536,
  cipherKeyVal: <Buffer ba 19 ef 0e 49 66 95 2e 79 d1 95 35 6e 4b e7 68>,
  macKeyVal: <Buffer db 87 16 87 39 25 33 33 10 6f 86 92 ed e3 50 1f cd 81 f6 ad c5 21 a1 41 84 31 31 0f df 83 df 13>,
  absValidity: 2018-03-21T22:28:42.831Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50201536,
     cipherKeyVal: <Buffer ba 19 ef 0e 49 66 95 2e 79 d1 95 35 6e 4b e7 68>,
     macKeyVal: <Buffer db 87 16 87 39 25 33 33 10 6f 86 92 ed e3 50 1f cd 81 f6 ad c5 21 a1 41 84 31 31 0f df 83 df 13>,
     absValidity: 2018-03-21T22:28:42.831Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 62 ae dc ce ab 8c 7c 3d>
switching to HANDSHAKE_1_SENT
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 19 0.3157894736842105 1521584943086
connected to auth! from local port 47020
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.42:undefined
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 20 0.3 1521585003096
connected to auth! from local port 47178
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 21 0.2857142857142857 1521585063106
connected to auth! from local port 47332
received auth hello!
{ authId: 502, nonce: <Buffer 2a ab 76 46 37 7a 68 e5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c3 75 0a 03 c8 1f c2 78>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201576,
  cipherKeyVal: <Buffer 7f 89 37 19 23 d2 55 e8 a0 8b be ff 9d 02 7c ee>,
  macKeyVal: <Buffer c3 37 2d aa 37 e7 44 3f 5b 65 e0 02 c6 57 b7 d2 eb a6 1e b4 3d 50 e0 46 c4 10 74 91 1e a3 34 06>,
  absValidity: 2018-03-21T22:31:22.832Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50201576,
     cipherKeyVal: <Buffer 7f 89 37 19 23 d2 55 e8 a0 8b be ff 9d 02 7c ee>,
     macKeyVal: <Buffer c3 37 2d aa 37 e7 44 3f 5b 65 e0 02 c6 57 b7 d2 eb a6 1e b4 3d 50 e0 46 c4 10 74 91 1e a3 34 06>,
     absValidity: 2018-03-21T22:31:22.832Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 1e 6f a9 0c 17 0f 84 98>
switching to HANDSHAKE_1_SENT
disconnected from auth
received auth hello!
{ authId: 502, nonce: <Buffer 6c 5c ab 51 73 e8 c6 a9> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: write after end
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 22 0.2727272727272727 1521585123106
connected to auth! from local port 47488
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.42:undefined
received auth hello!
{ authId: 502, nonce: <Buffer e8 ea a9 fa 8c a5 ea 7a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b7 88 37 aa b6 9a 4c 07>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201590,
  cipherKeyVal: <Buffer ae 54 09 d3 06 12 5d 40 2a a2 4a cb 65 7c e7 8b>,
  macKeyVal: <Buffer c0 8c 2a d3 2c 44 a5 2b ef f4 7e df 97 f1 20 69 c7 22 be 4d 1a 03 96 f6 60 3c 87 17 f0 ae 7c a5>,
  absValidity: 2018-03-21T22:32:18.848Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50201590,
     cipherKeyVal: <Buffer ae 54 09 d3 06 12 5d 40 2a a2 4a cb 65 7c e7 8b>,
     macKeyVal: <Buffer c0 8c 2a d3 2c 44 a5 2b ef f4 7e df 97 f1 20 69 c7 22 be 4d 1a 03 96 f6 60 3c 87 17 f0 ae 7c a5>,
     absValidity: 2018-03-21T22:32:18.848Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 18 28 69 41 72 ed c6 f5>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Connection with Auth timed out...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 23 0.2608695652173913 1521585183133
connected to auth! from local port 47638
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.42:undefined
received auth hello!
{ authId: 502, nonce: <Buffer b1 c0 bf 68 d1 53 2e 57> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ce de c5 04 41 6a d7 2b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201598,
  cipherKeyVal: <Buffer ae ab 35 5b 51 e4 1f 51 a8 7f df 25 f0 18 29 ea>,
  macKeyVal: <Buffer 43 e0 e5 9c d7 46 b2 d4 43 8b e6 8c 7f b7 aa 2b be 8a 0a fa 25 cf 26 d0 f6 89 27 ad aa 57 41 26>,
  absValidity: 2018-03-21T22:33:10.890Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50201598,
     cipherKeyVal: <Buffer ae ab 35 5b 51 e4 1f 51 a8 7f df 25 f0 18 29 ea>,
     macKeyVal: <Buffer 43 e0 e5 9c d7 46 b2 d4 43 8b e6 8c 7f b7 aa 2b be 8a 0a fa 25 cf 26 d0 f6 89 27 ad aa 57 41 26>,
     absValidity: 2018-03-21T22:33:10.890Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 77 68 c9 d2 5d 53 d8 21>
switching to HANDSHAKE_1_SENT
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:33:18 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 23 0.30434782608695654 1521585199280
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 24 0.2916666666666667 1521585243178
connected to auth! from local port 47776
received auth hello!
{ authId: 502, nonce: <Buffer ee ba 14 96 da 24 9c ba> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3b 62 58 2b 6b dc e7 25>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201608,
  cipherKeyVal: <Buffer 6c 39 52 c3 74 4e 83 12 8e d2 96 e0 0f 1e 02 a6>,
  macKeyVal: <Buffer de 22 3d 1a b9 b7 06 a2 80 c6 1d 6e 8f fe 47 ca 8f 08 44 bd 06 93 47 57 ff 23 f8 c7 6d a0 80 5d>,
  absValidity: 2018-03-21T22:34:06.873Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50201608,
     cipherKeyVal: <Buffer 6c 39 52 c3 74 4e 83 12 8e d2 96 e0 0f 1e 02 a6>,
     macKeyVal: <Buffer de 22 3d 1a b9 b7 06 a2 80 c6 1d 6e 8f fe 47 ca 8f 08 44 bd 06 93 47 57 ff 23 f8 c7 6d a0 80 5d>,
     absValidity: 2018-03-21T22:34:06.873Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 3a 69 4a 0e 74 ef 32 04>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:34:15 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 24 0.3333333333333333 1521585255460
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 25 0.32 1521585303225
connected to auth! from local port 47914
received auth hello!
{ authId: 502, nonce: <Buffer 60 53 69 2d ba 97 d7 e9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 60 d0 2e 0c 27 fb e8 46>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201620,
  cipherKeyVal: <Buffer e2 f5 6f 0e f6 e5 eb 03 9b 43 d9 ce 02 ea 35 80>,
  macKeyVal: <Buffer 10 3b f3 1b e5 e2 6a c2 3a 86 c6 e4 5d d5 1c a3 3c a7 15 b6 63 4c d2 04 65 71 2e 59 1b 2b e9 ed>,
  absValidity: 2018-03-21T22:35:06.877Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50201620,
     cipherKeyVal: <Buffer e2 f5 6f 0e f6 e5 eb 03 9b 43 d9 ce 02 ea 35 80>,
     macKeyVal: <Buffer 10 3b f3 1b e5 e2 6a c2 3a 86 c6 e4 5d d5 1c a3 3c a7 15 b6 63 4c d2 04 65 71 2e 59 1b 2b e9 ed>,
     absValidity: 2018-03-21T22:35:06.877Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 67 bd eb ab 51 cf 27 b6>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.42:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 26 0.3076923076923077 1521585363232
connected to auth! from local port 48046
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 27 0.2962962962962963 1521585423243
connected to auth! from local port 48210
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 28 0.2857142857142857 1521585483253
connected to auth! from local port 48330
received auth hello!
{ authId: 502, nonce: <Buffer ed 15 06 95 bf ce f0 27> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 40 c8 90 3e 70 25 da ec>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201659,
  cipherKeyVal: <Buffer 03 3a 6f 99 f1 48 97 5c c2 d1 9b ae 53 0b 2f b1>,
  macKeyVal: <Buffer 24 3e b8 dc a1 6e e7 9a 63 5e 6d 29 5e f7 6b ae 59 60 f8 cf 21 cd 46 d8 5f 7a a3 46 90 87 0a 8c>,
  absValidity: 2018-03-21T22:38:07.064Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.42',
  serverPort: 22100,
  sessionKey: 
   { id: 50201659,
     cipherKeyVal: <Buffer 03 3a 6f 99 f1 48 97 5c c2 d1 9b ae 53 0b 2f b1>,
     macKeyVal: <Buffer 24 3e b8 dc a1 6e e7 9a 63 5e 6d 29 5e f7 6b ae 59 60 f8 cf 21 cd 46 d8 5f 7a a3 46 90 87 0a 8c>,
     absValidity: 2018-03-21T22:38:07.064Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 6b 8f e2 33 b7 f5 85 fa>
switching to HANDSHAKE_1_SENT
