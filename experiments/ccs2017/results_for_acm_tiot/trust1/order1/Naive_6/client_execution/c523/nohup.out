changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c523.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c523',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 73 62 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521583856107
connected to auth! from local port 40400
received auth hello!
{ authId: 504, nonce: <Buffer a6 3f 92 70 aa 5b 09 b5> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer a0 22 f5 9f d7 08 1f 32>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 0e 16 1b b9 8e 16 ce 3d 60 0f 97 b1 49 4f f5 0a>,
  macKeyVal: <Buffer de 87 9d d7 f5 44 c5 76 92 6b 9b 6e 7c 34 32 06 66 9d 9d 5e ee 1f 8a 15 83 d6 3f e1 f7 67 bc 92>,
  absValidity: 2018-03-20T23:10:56.320Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400190,
  cipherKeyVal: <Buffer 30 22 10 a0 98 37 3b c2 cc 94 dd 83 b6 79 32 32>,
  macKeyVal: <Buffer d6 b9 53 41 89 9c 11 0a d9 ee d7 ce c8 89 28 45 9b b6 3e 3a cd b0 61 9e 4c 91 8c 57 9f a8 93 5e>,
  absValidity: 2018-03-21T22:10:56.320Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50400190,
     cipherKeyVal: <Buffer 30 22 10 a0 98 37 3b c2 cc 94 dd 83 b6 79 32 32>,
     macKeyVal: <Buffer d6 b9 53 41 89 9c 11 0a d9 ee d7 ce c8 89 28 45 9b b6 3e 3a cd b0 61 9e 4c 91 8c 57 9f a8 93 5e>,
     absValidity: 2018-03-21T22:10:56.320Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer e5 3e df 56 e1 59 d3 f8>
switching to HANDSHAKE_1_SENT
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:11:00 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521583860884
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521583916162
connected to auth! from local port 40670
received auth hello!
{ authId: 504, nonce: <Buffer 97 c3 df 8f 83 24 6d 13> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 94 79 06 7a 6e 2a f2 f2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400196,
  cipherKeyVal: <Buffer 2a b0 bc 17 2c 10 89 23 91 89 65 82 40 58 8a b7>,
  macKeyVal: <Buffer 5f 06 02 e2 f2 78 b8 70 fc 05 0e 26 a3 04 48 8c c2 b9 3b 58 73 63 51 cb 72 10 92 64 c6 5c 79 98>,
  absValidity: 2018-03-21T22:11:56.319Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50400196,
     cipherKeyVal: <Buffer 2a b0 bc 17 2c 10 89 23 91 89 65 82 40 58 8a b7>,
     macKeyVal: <Buffer 5f 06 02 e2 f2 78 b8 70 fc 05 0e 26 a3 04 48 8c c2 b9 3b 58 73 63 51 cb 72 10 92 64 c6 5c 79 98>,
     absValidity: 2018-03-21T22:11:56.319Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 4b da 6a 62 47 df 20 bd>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:11:58 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521583919159
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521583976217
connected to auth! from local port 40940
received auth hello!
{ authId: 504, nonce: <Buffer 98 69 b3 4d ec be ff d1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ae bf 61 a7 0e c8 0a 79>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400202,
  cipherKeyVal: <Buffer 7b f7 aa 15 33 6a b2 79 aa b9 97 3e 74 ee 30 ab>,
  macKeyVal: <Buffer 3a 61 4b da d3 3a b0 fc 7a c9 37 f4 bb af 56 ef 8b 47 f3 06 8c 9f ae 61 d1 ab 3e 16 2a 57 ff ea>,
  absValidity: 2018-03-21T22:12:56.365Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50400202,
     cipherKeyVal: <Buffer 7b f7 aa 15 33 6a b2 79 aa b9 97 3e 74 ee 30 ab>,
     macKeyVal: <Buffer 3a 61 4b da d3 3a b0 fc 7a c9 37 f4 bb af 56 ef 8b 47 f3 06 8c 9f ae 61 d1 ab 3e 16 2a 57 ff ea>,
     absValidity: 2018-03-21T22:12:56.365Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 98 33 26 59 aa cf 6e 39>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:12:58 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521583979157
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521584036275
connected to auth! from local port 41210
received auth hello!
{ authId: 504, nonce: <Buffer ed 52 e0 bc 86 b6 22 bb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 15 93 3e d4 1a 17 85 23>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400208,
  cipherKeyVal: <Buffer 04 2a ef 19 7d 42 b4 b9 6b 93 5c 3d f0 94 3d 08>,
  macKeyVal: <Buffer 1d 0b 8f 76 36 ea d3 90 0a dc b9 db e2 b1 35 73 1e 11 7d e1 3c 6d 10 79 88 96 45 54 93 b5 11 82>,
  absValidity: 2018-03-21T22:13:56.446Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50400208,
     cipherKeyVal: <Buffer 04 2a ef 19 7d 42 b4 b9 6b 93 5c 3d f0 94 3d 08>,
     macKeyVal: <Buffer 1d 0b 8f 76 36 ea d3 90 0a dc b9 db e2 b1 35 73 1e 11 7d e1 3c 6d 10 79 88 96 45 54 93 b5 11 82>,
     absValidity: 2018-03-21T22:13:56.446Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer e3 47 32 64 ef 09 fc 14>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:13:58 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521584038976
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521584096333
connected to auth! from local port 41480
received auth hello!
{ authId: 504, nonce: <Buffer b3 50 c3 dc 06 9b 90 76> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0b 8e ef f6 19 d9 b5 44>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400214,
  cipherKeyVal: <Buffer 91 0e 40 bc 4d 10 cd 09 4d dc 95 47 c7 51 48 ac>,
  macKeyVal: <Buffer 4f 01 b5 52 e3 93 1d e7 5b 90 d2 0c 09 64 5f 77 b5 b0 c2 b5 49 fc 9d 26 9d 72 57 67 18 fc 0f a3>,
  absValidity: 2018-03-21T22:14:56.451Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50400214,
     cipherKeyVal: <Buffer 91 0e 40 bc 4d 10 cd 09 4d dc 95 47 c7 51 48 ac>,
     macKeyVal: <Buffer 4f 01 b5 52 e3 93 1d e7 5b 90 d2 0c 09 64 5f 77 b5 b0 c2 b5 49 fc 9d 26 9d 72 57 67 18 fc 0f a3>,
     absValidity: 2018-03-21T22:14:56.451Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer e7 96 63 d8 58 86 d5 e9>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:14:58 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521584099340
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521584156389
connected to auth! from local port 41750
received auth hello!
{ authId: 504, nonce: <Buffer 96 ae 2a e3 7e 50 da 85> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2c 67 59 5c 37 f5 18 b1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400220,
  cipherKeyVal: <Buffer 78 6c db 84 a5 55 a7 20 90 07 3c 10 56 d3 cf 17>,
  macKeyVal: <Buffer 25 8a 4c bc 61 62 88 96 a9 c4 33 84 96 a5 a7 72 be c7 2c 55 b3 56 f9 d2 14 48 b7 31 62 d0 d8 61>,
  absValidity: 2018-03-21T22:15:56.538Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50400220,
     cipherKeyVal: <Buffer 78 6c db 84 a5 55 a7 20 90 07 3c 10 56 d3 cf 17>,
     macKeyVal: <Buffer 25 8a 4c bc 61 62 88 96 a9 c4 33 84 96 a5 a7 72 be c7 2c 55 b3 56 f9 d2 14 48 b7 31 62 d0 d8 61>,
     absValidity: 2018-03-21T22:15:56.538Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 30 50 ff fd 61 25 43 38>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:15:58 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521584159376
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521584216445
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 8 0.75 1521584276457
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.6:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 9 0.6666666666666666 1521584336464
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.3:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 10 0.6 1521584396467
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.1:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 11 0.5454545454545454 1521584456468
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 2
to: 3
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 12 0.5 1521584516476
failure in connection with Auth : authFailureCount: 6
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 3
to: 4
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 13 0.46153846153846156 1521584576483
failure in connection with Auth : authFailureCount: 7
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 4
to: 5
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 41510
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 14 0.42857142857142855 1521584636490
failure in connection with Auth : authFailureCount: 8
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 41692
received auth hello!
{ authId: 502, nonce: <Buffer 42 09 12 b3 cc 10 7f 37> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth504',
     commonName: '10.0.0.7' },
  serial: '016245740CB7',
  notBefore: 2018-03-20T22:05:56.000Z,
  notAfter: 2018-03-21T22:07:36.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '36:5F:CE:E1:EA:99:80:10:89:FF:F6:13:CA:5E:17:59:60:B8:38:32',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'E40B9EF20959AA49D02016EC2E9896074EE0818689EAD7319ECC8ED8C9557412ED46C95E67464598F6233ECEB8BF25A876F0D30B65CED2B1FED8D1F07CF9042FD7F86E3B637BE17FBFD7C9F0DB5850835170B354A52C175B769A37BA578F965436FF29BCFD54C5D4E939E02214503C8A69FFBBF0EC06657DF9498BE98DEB26B62E1453817F6DFAE9B50EE21C5A643FF0292539838A682562303CB77FC6028B22B30B78957E4F78E539103F991928681EBF3100D31960F43F8ECFC6C2F3063B353E92BFFEF77A49BBCBF417864AE8169AA061F590E5FB3393A4592EFA1100FC186B95B83724CA0B11D8BC02BC9BD4F9E08552DE2D1EB0EE0E866E41A520730E6F',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJFdAy3MA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDQxETAPBgNVBAMMCDEwLjAuMC43MB4XDTE4MDMy\nMDIyMDU1NloXDTE4MDMyMTIyMDczNlowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDkC57yCVmqSdAgFuwumJYHTuCBhonq1zGezI7YyVV0Eu1GyV5n\nRkWY9iM+zri/Jah28NMLZc7Ssf7Y0fB8+QQv1/huO2N74X+/18nw21hQg1Fws1Sl\nLBdbdpo3ulePllQ2/ym8/VTF1Ok54CIUUDyKaf+78OwGZX35SYvpjesmti4UU4F/\nbfrptQ7iHFpkP/ApJTmDimglYjA8t3/GAosiswt4lX5PeOU5ED+ZGShoHr8xANMZ\nYPQ/js/GwvMGOzU+kr/+93pJu8v0F4ZK6BaaoGH1kOX7M5OkWS76EQD8GGuVuDck\nygsR2LwCvJvU+eCFUt4tHrDuDoZuQaUgcw5vAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAHjpcsYdFl8Ksztl0CxHnpJb6pcspFG4\nGrTJJl3jZeEiMAUTvzLYUIFsN0fl4AjcnVY0xH6l+B8toQHSF6iCjX3CzX/SRuAC\no4iMTzsLdKxgkOo4RQIo0vIYe8g//4+m/fsidWvkgn1Meh3+AEjteyx6+tJfxFav\nZa+vaXZnBwqQo7f3NtiIlEbak72beZiG/JjFHIkrTQDNKnmzFZqaZMLY+fZLLBaV\niEsw07AQ70SJKW575LK7BnYOkojPvQfyhnuWcD6JDyDRCqXOVEriu95aej6WWwID\n2uznotgjsnnLJPTqvAkrxoloEgDyjhfNbtHjCWuhLquexyfbFJwq714=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 5
to: 6
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 15 0.4 1521584696501
connected to auth! from local port 41880
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 16 0.375 1521584756512
connected to auth! from local port 42032
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 17 0.35294117647058826 1521584816523
connected to auth! from local port 42190
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 18 0.3333333333333333 1521584876529
connected to auth! from local port 42358
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 19 0.3157894736842105 1521584936537
connected to auth! from local port 42524
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 20 0.3 1521584996548
connected to auth! from local port 42682
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 21 0.2857142857142857 1521585056558
connected to auth! from local port 42836
received auth hello!
{ authId: 502, nonce: <Buffer b4 28 d8 b8 12 f0 17 f5> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer ce 76 41 d3 fa 55 97 d0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 4f d2 47 0f bd ef c7 8a 84 f1 07 ff 0d 4c d3 bf>,
  macKeyVal: <Buffer 35 87 1d c8 a3 d2 41 35 53 b6 34 1f a0 c3 6f ea d9 28 82 d2 4b 00 b2 f4 72 75 01 42 b5 4f 64 26>,
  absValidity: 2018-03-20T23:31:28.345Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201577,
  cipherKeyVal: <Buffer 8a 50 79 1b 06 8b 54 53 97 da 1a 51 5a 62 e2 4c>,
  macKeyVal: <Buffer 2e 44 05 57 f1 bf 47 0b 7f d9 25 84 40 14 55 db e2 de 3a 64 ce 35 f9 cd 62 e7 aa 1d 22 ef 26 48>,
  absValidity: 2018-03-21T22:31:28.345Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50201577,
     cipherKeyVal: <Buffer 8a 50 79 1b 06 8b 54 53 97 da 1a 51 5a 62 e2 4c>,
     macKeyVal: <Buffer 2e 44 05 57 f1 bf 47 0b 7f d9 25 84 40 14 55 db e2 de 3a 64 ce 35 f9 cd 62 e7 aa 1d 22 ef 26 48>,
     absValidity: 2018-03-21T22:31:28.345Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 07 7f be a6 8f 25 3c e7>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 22 0.2727272727272727 1521585116586
connected to auth! from local port 42992
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.41:undefined
received auth hello!
{ authId: 502, nonce: <Buffer bf 0d b9 96 4f 9b 3b 9b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 24 fc f5 1f 79 52 40 e9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201591,
  cipherKeyVal: <Buffer 82 40 5c 05 d7 74 bc a4 f8 14 99 81 d9 ab 0e b3>,
  macKeyVal: <Buffer 4a 9c 83 7e 78 1f 63 73 59 a1 a6 9c 9a cd a2 3c fb e1 ca 9f 78 26 70 27 51 79 ec a4 12 6d 50 1d>,
  absValidity: 2018-03-21T22:32:20.339Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50201591,
     cipherKeyVal: <Buffer 82 40 5c 05 d7 74 bc a4 f8 14 99 81 d9 ab 0e b3>,
     macKeyVal: <Buffer 4a 9c 83 7e 78 1f 63 73 59 a1 a6 9c 9a cd a2 3c fb e1 ca 9f 78 26 70 27 51 79 ec a4 12 6d 50 1d>,
     absValidity: 2018-03-21T22:32:20.339Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 31 50 47 8c 5e c7 b6 b1>
switching to HANDSHAKE_1_SENT
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 23 0.2608695652173913 1521585176597
connected to auth! from local port 43142
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.41:undefined
received auth hello!
{ authId: 502, nonce: <Buffer 7b 87 ea 24 7c dc 30 c2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d6 44 82 d2 a5 d7 de 28>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201600,
  cipherKeyVal: <Buffer 4d 27 72 31 d1 6c 29 ac 71 29 dc 16 91 72 cc 6f>,
  macKeyVal: <Buffer 46 90 56 8b 15 81 0d b2 ca 8d 52 16 d7 54 ff d3 d2 6c 91 4d b0 04 a2 0c 82 7e 8f 7a 6a 2e 96 03>,
  absValidity: 2018-03-21T22:33:24.321Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50201600,
     cipherKeyVal: <Buffer 4d 27 72 31 d1 6c 29 ac 71 29 dc 16 91 72 cc 6f>,
     macKeyVal: <Buffer 46 90 56 8b 15 81 0d b2 ca 8d 52 16 d7 54 ff d3 d2 6c 91 4d b0 04 a2 0c 82 7e 8f 7a 6a 2e 96 03>,
     absValidity: 2018-03-21T22:33:24.321Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer fc 57 ba 82 35 e7 50 97>
switching to HANDSHAKE_1_SENT
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 24 0.25 1521585236630
connected to auth! from local port 43276
received auth hello!
{ authId: 502, nonce: <Buffer 24 d8 44 66 1e ab 76 e5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cb 0b 25 1d 91 b7 de 67>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201609,
  cipherKeyVal: <Buffer 80 df 88 3f e3 5f 1c d4 e0 44 23 b5 4c df 63 50>,
  macKeyVal: <Buffer 1f 93 e7 39 fc 72 9b 42 5f 76 64 09 35 db 15 07 05 51 56 62 03 b9 da 38 ed c6 af 1b 63 39 ff f1>,
  absValidity: 2018-03-21T22:34:08.346Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50201609,
     cipherKeyVal: <Buffer 80 df 88 3f e3 5f 1c d4 e0 44 23 b5 4c df 63 50>,
     macKeyVal: <Buffer 1f 93 e7 39 fc 72 9b 42 5f 76 64 09 35 db 15 07 05 51 56 62 03 b9 da 38 ed c6 af 1b 63 39 ff f1>,
     absValidity: 2018-03-21T22:34:08.346Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 4b e1 63 e1 02 2d 0d fd>
switching to HANDSHAKE_1_SENT
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:34:12 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 24 0.2916666666666667 1521585252966
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.41:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 25 0.28 1521585296669
connected to auth! from local port 43414
received auth hello!
{ authId: 502, nonce: <Buffer 43 96 09 25 96 86 71 f0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e2 35 f1 2b 67 8c 18 13>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201624,
  cipherKeyVal: <Buffer b8 ab 75 54 40 f9 d7 6b fa 8b 56 15 6a 14 ad 75>,
  macKeyVal: <Buffer 9d da 31 51 32 ae 74 16 9c 3b f1 34 1e 4d f3 67 18 7e 4b 63 cc b8 23 6b 3c e4 d3 55 5b b3 b6 40>,
  absValidity: 2018-03-21T22:35:24.345Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50201624,
     cipherKeyVal: <Buffer b8 ab 75 54 40 f9 d7 6b fa 8b 56 15 6a 14 ad 75>,
     macKeyVal: <Buffer 9d da 31 51 32 ae 74 16 9c 3b f1 34 1e 4d f3 67 18 7e 4b 63 cc b8 23 6b 3c e4 d3 55 5b b3 b6 40>,
     absValidity: 2018-03-21T22:35:24.345Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer c2 24 f9 a3 6a c5 8f d9>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 26 0.2692307692307692 1521585356701
connected to auth! from local port 43554
received auth hello!
{ authId: 502, nonce: <Buffer f2 a9 4a 97 62 ca a6 0d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1d 9f 70 f4 b8 29 85 0e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201631,
  cipherKeyVal: <Buffer 14 cc 30 6a 5d b2 99 b5 62 89 b4 22 fa 6d b7 e3>,
  macKeyVal: <Buffer e7 29 97 0c 02 b4 1f f8 2d 0c bc c2 9f 1b 64 49 42 6d e3 d5 03 ff da f1 58 59 48 d3 53 3b c2 fc>,
  absValidity: 2018-03-21T22:36:08.371Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50201631,
     cipherKeyVal: <Buffer 14 cc 30 6a 5d b2 99 b5 62 89 b4 22 fa 6d b7 e3>,
     macKeyVal: <Buffer e7 29 97 0c 02 b4 1f f8 2d 0c bc c2 9f 1b 64 49 42 6d e3 d5 03 ff da f1 58 59 48 d3 53 3b c2 fc>,
     absValidity: 2018-03-21T22:36:08.371Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer d1 27 bf f7 bd d5 83 80>
switching to HANDSHAKE_1_SENT
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:36:12 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 26 0.3076923076923077 1521585372651
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.41:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 27 0.2962962962962963 1521585416744
connected to auth! from local port 43716
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 28 0.2857142857142857 1521585476753
connected to auth! from local port 43842
received auth hello!
{ authId: 502, nonce: <Buffer 7e 6f c6 46 c1 8f 1b 54> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1c 30 fc 4c 74 16 b8 51>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201658,
  cipherKeyVal: <Buffer 05 10 83 84 2a 22 51 16 7c 4d 34 29 67 e5 28 6b>,
  macKeyVal: <Buffer 32 fe 0e 05 34 b0 90 dd 55 d0 4b 47 e2 06 8b db 1a a3 d2 5a 6c 64 59 53 9f 9e 24 3c 67 16 a5 dc>,
  absValidity: 2018-03-21T22:38:00.602Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.41',
  serverPort: 22100,
  sessionKey: 
   { id: 50201658,
     cipherKeyVal: <Buffer 05 10 83 84 2a 22 51 16 7c 4d 34 29 67 e5 28 6b>,
     macKeyVal: <Buffer 32 fe 0e 05 34 b0 90 dd 55 d0 4b 47 e2 06 8b db 1a a3 d2 5a 6c 64 59 53 9f 9e 24 3c 67 16 a5 dc>,
     absValidity: 2018-03-21T22:38:00.602Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer fc e8 f6 b8 3d 2b 20 33>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:38:04 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 9 28 0.32142857142857145 1521585485184
