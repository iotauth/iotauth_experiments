changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c504.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c504',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 74 54 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521583792714
connected to auth! from local port 41080
received auth hello!
{ authId: 504, nonce: <Buffer dd 8c 45 7b 1e 01 b3 c4> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 2d 0b 3a 4a 92 8b 8a 16>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer ae 65 27 5f 46 38 18 d6 bf 7a 19 55 d0 d3 ce 47>,
  macKeyVal: <Buffer eb c5 ec c0 84 4e 27 f6 3d 41 96 25 8b 3a bc 56 dc bc c3 80 b2 ac fd 30 7a cf ee b3 0d 17 2b 8e>,
  absValidity: 2018-03-20T23:09:52.885Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400187,
  cipherKeyVal: <Buffer a5 ed 37 6e a2 76 ac ac a7 04 2c af f9 cb de 19>,
  macKeyVal: <Buffer 30 53 49 7c e8 e3 54 88 fc d7 fd 68 53 fd f8 c3 f9 d3 ae 2a 5a 97 c9 dc 65 33 4d 3e 74 ef 3a 04>,
  absValidity: 2018-03-21T22:09:52.884Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50400187,
     cipherKeyVal: <Buffer a5 ed 37 6e a2 76 ac ac a7 04 2c af f9 cb de 19>,
     macKeyVal: <Buffer 30 53 49 7c e8 e3 54 88 fc d7 fd 68 53 fd f8 c3 f9 d3 ae 2a 5a 97 c9 dc 65 33 4d 3e 74 ef 3a 04>,
     absValidity: 2018-03-21T22:09:52.884Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 31 00 ce a4 6d 64 78 e6>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:09:53 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521583793660
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521583852770
connected to auth! from local port 41322
received auth hello!
{ authId: 504, nonce: <Buffer df 83 90 8c 9a 32 16 f0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 88 d6 85 c8 58 32 2e 51>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400189,
  cipherKeyVal: <Buffer bd 7e c5 ce 7c 6c 1f b7 fc 2a 4f d8 f8 1b a7 bb>,
  macKeyVal: <Buffer 5d 88 26 ec 38 25 2d 6b ca 78 2b 63 7f b7 1f b4 31 2d 19 4c f6 2c 93 62 fd 7f f1 f7 3e d9 cb f1>,
  absValidity: 2018-03-21T22:10:53.073Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50400189,
     cipherKeyVal: <Buffer bd 7e c5 ce 7c 6c 1f b7 fc 2a 4f d8 f8 1b a7 bb>,
     macKeyVal: <Buffer 5d 88 26 ec 38 25 2d 6b ca 78 2b 63 7f b7 1f b4 31 2d 19 4c f6 2c 93 62 fd 7f f1 f7 3e d9 cb f1>,
     absValidity: 2018-03-21T22:10:53.073Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 93 58 20 c9 98 73 4f cb>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:10:53 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521583854502
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521583912820
connected to auth! from local port 41590
received auth hello!
{ authId: 504, nonce: <Buffer e5 99 5f 8b 11 54 f1 91> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8a 42 c5 21 d2 28 c6 d6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400195,
  cipherKeyVal: <Buffer 84 af 87 03 29 0c 2d 14 dc 9b 6c e3 8b 7e ad f7>,
  macKeyVal: <Buffer 4e b3 13 7d 8d 7e 83 97 25 e2 4b 6c c6 1a fc 8a 8e ed 2f f8 1a b2 2f 0a 35 25 51 c7 29 cb 26 4d>,
  absValidity: 2018-03-21T22:11:53.071Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50400195,
     cipherKeyVal: <Buffer 84 af 87 03 29 0c 2d 14 dc 9b 6c e3 8b 7e ad f7>,
     macKeyVal: <Buffer 4e b3 13 7d 8d 7e 83 97 25 e2 4b 6c c6 1a fc 8a 8e ed 2f f8 1a b2 2f 0a 35 25 51 c7 29 cb 26 4d>,
     absValidity: 2018-03-21T22:11:53.071Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 7c be 41 89 73 da c1 b6>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:11:53 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521583914539
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521583972835
connected to auth! from local port 41860
received auth hello!
{ authId: 504, nonce: <Buffer 56 87 2f 98 92 4e 5d 39> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer dd a5 94 f0 62 9a d0 6c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400201,
  cipherKeyVal: <Buffer d9 d9 9a b4 cd 29 01 80 c3 17 b0 74 61 c1 c3 01>,
  macKeyVal: <Buffer 0b 33 4d e1 48 46 ce cb 8d 39 a0 2d 36 a3 db 3c b4 56 39 bd 3e 46 54 82 53 74 84 36 f6 a5 73 43>,
  absValidity: 2018-03-21T22:12:52.996Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50400201,
     cipherKeyVal: <Buffer d9 d9 9a b4 cd 29 01 80 c3 17 b0 74 61 c1 c3 01>,
     macKeyVal: <Buffer 0b 33 4d e1 48 46 ce cb 8d 39 a0 2d 36 a3 db 3c b4 56 39 bd 3e 46 54 82 53 74 84 36 f6 a5 73 43>,
     absValidity: 2018-03-21T22:12:52.996Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 8e f8 c0 7f 89 1c 90 c6>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:12:53 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521583974457
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521584032884
connected to auth! from local port 42132
received auth hello!
{ authId: 504, nonce: <Buffer 11 86 6b e0 3e 7e 73 d5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b5 c0 81 d5 b9 22 da 86>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400207,
  cipherKeyVal: <Buffer 94 55 e8 a7 5b 26 81 c6 02 33 49 cb b1 ec 9f 53>,
  macKeyVal: <Buffer fb 6e d9 cf 53 71 d2 c9 32 3f 76 f1 ec df 5c 46 22 0e d3 a3 74 5c 3e 46 e5 55 29 3c ae d6 ea 7c>,
  absValidity: 2018-03-21T22:13:53.050Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50400207,
     cipherKeyVal: <Buffer 94 55 e8 a7 5b 26 81 c6 02 33 49 cb b1 ec 9f 53>,
     macKeyVal: <Buffer fb 6e d9 cf 53 71 d2 c9 32 3f 76 f1 ec df 5c 46 22 0e d3 a3 74 5c 3e 46 e5 55 29 3c ae d6 ea 7c>,
     absValidity: 2018-03-21T22:13:53.050Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 40 1a 99 9a 6f 23 fb 07>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:13:53 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521584034476
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521584092941
connected to auth! from local port 42402
received auth hello!
{ authId: 504, nonce: <Buffer 38 1f 12 2d 2b be 52 4a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 05 12 22 de e8 b2 67 61>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400213,
  cipherKeyVal: <Buffer 5e 30 8d b1 df 69 8c c1 b2 c2 89 89 ae 80 99 85>,
  macKeyVal: <Buffer 9d da a5 a5 31 84 36 11 35 97 10 bd 88 05 06 62 70 21 5d a6 95 36 a7 84 be 3d c2 81 2f bc 6e ae>,
  absValidity: 2018-03-21T22:14:53.191Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50400213,
     cipherKeyVal: <Buffer 5e 30 8d b1 df 69 8c c1 b2 c2 89 89 ae 80 99 85>,
     macKeyVal: <Buffer 9d da a5 a5 31 84 36 11 35 97 10 bd 88 05 06 62 70 21 5d a6 95 36 a7 84 be 3d c2 81 2f bc 6e ae>,
     absValidity: 2018-03-21T22:14:53.191Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 54 2a 10 06 86 18 80 97>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:14:53 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521584094418
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521584152988
connected to auth! from local port 42672
received auth hello!
{ authId: 504, nonce: <Buffer a8 b4 51 a8 d3 c6 34 8f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 92 33 c7 9f fa a5 33 64>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400219,
  cipherKeyVal: <Buffer 38 be a0 f0 d9 5d 56 6c 2f 43 a9 e0 03 21 a2 d2>,
  macKeyVal: <Buffer ca 10 86 a2 f1 a0 0e 47 38 52 60 ce 71 b7 aa ae 07 3e 00 72 70 ad 2e 71 f1 be 60 fd 51 09 97 fe>,
  absValidity: 2018-03-21T22:15:53.135Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50400219,
     cipherKeyVal: <Buffer 38 be a0 f0 d9 5d 56 6c 2f 43 a9 e0 03 21 a2 d2>,
     macKeyVal: <Buffer ca 10 86 a2 f1 a0 0e 47 38 52 60 ce 71 b7 aa ae 07 3e 00 72 70 ad 2e 71 f1 be 60 fd 51 09 97 fe>,
     absValidity: 2018-03-21T22:15:53.135Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer cb c6 38 4c ce be 24 6c>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:15:53 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521584154402
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521584212993
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 9 0.7777777777777778 1521584273004
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.1:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 10 0.7 1521584333011
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 11 0.6363636363636364 1521584393017
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 12 0.5833333333333334 1521584453025
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 2
to: 3
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 47252
received auth hello!
{ authId: 502, nonce: <Buffer 0e 0e 0f e1 a3 87 c8 06> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth504',
     commonName: '10.0.0.7' },
  serial: '016245740CB7',
  notBefore: 2018-03-20T22:05:56.000Z,
  notAfter: 2018-03-21T22:07:36.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '36:5F:CE:E1:EA:99:80:10:89:FF:F6:13:CA:5E:17:59:60:B8:38:32',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'E40B9EF20959AA49D02016EC2E9896074EE0818689EAD7319ECC8ED8C9557412ED46C95E67464598F6233ECEB8BF25A876F0D30B65CED2B1FED8D1F07CF9042FD7F86E3B637BE17FBFD7C9F0DB5850835170B354A52C175B769A37BA578F965436FF29BCFD54C5D4E939E02214503C8A69FFBBF0EC06657DF9498BE98DEB26B62E1453817F6DFAE9B50EE21C5A643FF0292539838A682562303CB77FC6028B22B30B78957E4F78E539103F991928681EBF3100D31960F43F8ECFC6C2F3063B353E92BFFEF77A49BBCBF417864AE8169AA061F590E5FB3393A4592EFA1100FC186B95B83724CA0B11D8BC02BC9BD4F9E08552DE2D1EB0EE0E866E41A520730E6F',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJFdAy3MA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDQxETAPBgNVBAMMCDEwLjAuMC43MB4XDTE4MDMy\nMDIyMDU1NloXDTE4MDMyMTIyMDczNlowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDkC57yCVmqSdAgFuwumJYHTuCBhonq1zGezI7YyVV0Eu1GyV5n\nRkWY9iM+zri/Jah28NMLZc7Ssf7Y0fB8+QQv1/huO2N74X+/18nw21hQg1Fws1Sl\nLBdbdpo3ulePllQ2/ym8/VTF1Ok54CIUUDyKaf+78OwGZX35SYvpjesmti4UU4F/\nbfrptQ7iHFpkP/ApJTmDimglYjA8t3/GAosiswt4lX5PeOU5ED+ZGShoHr8xANMZ\nYPQ/js/GwvMGOzU+kr/+93pJu8v0F4ZK6BaaoGH1kOX7M5OkWS76EQD8GGuVuDck\nygsR2LwCvJvU+eCFUt4tHrDuDoZuQaUgcw5vAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAHjpcsYdFl8Ksztl0CxHnpJb6pcspFG4\nGrTJJl3jZeEiMAUTvzLYUIFsN0fl4AjcnVY0xH6l+B8toQHSF6iCjX3CzX/SRuAC\no4iMTzsLdKxgkOo4RQIo0vIYe8g//4+m/fsidWvkgn1Meh3+AEjteyx6+tJfxFav\nZa+vaXZnBwqQo7f3NtiIlEbak72beZiG/JjFHIkrTQDNKnmzFZqaZMLY+fZLLBaV\niEsw07AQ70SJKW575LK7BnYOkojPvQfyhnuWcD6JDyDRCqXOVEriu95aej6WWwID\n2uznotgjsnnLJPTqvAkrxoloEgDyjhfNbtHjCWuhLquexyfbFJwq714=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 3
to: 4
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 13 0.5384615384615384 1521584513035
connected to auth! from local port 47456
received auth hello!
{ authId: 502, nonce: <Buffer 1b 4e be a8 2e 19 de ae> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 2c eb 83 05 de 28 b0 19>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 68 0b 4b 9e 78 40 e1 0e e2 0b 34 06 fc 70 2f b6>,
  macKeyVal: <Buffer db 0c 50 f4 a0 c8 14 c9 e1 cf 62 ec 4a 72 ec d6 f6 ca c7 62 b2 77 51 8c 2b 9a 8f f8 8d f2 94 29>,
  absValidity: 2018-03-20T23:22:00.842Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201444,
  cipherKeyVal: <Buffer ae 21 8c b6 a8 3e 38 e8 06 b1 f6 7e e6 2e e9 a3>,
  macKeyVal: <Buffer 58 6a 4d 3d c4 00 36 12 47 b5 45 92 46 15 06 0b e9 41 37 c6 bc d0 2a f0 d6 6e 74 45 9a 11 a9 b7>,
  absValidity: 2018-03-21T22:22:00.842Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50201444,
     cipherKeyVal: <Buffer ae 21 8c b6 a8 3e 38 e8 06 b1 f6 7e e6 2e e9 a3>,
     macKeyVal: <Buffer 58 6a 4d 3d c4 00 36 12 47 b5 45 92 46 15 06 0b e9 41 37 c6 bc d0 2a f0 d6 6e 74 45 9a 11 a9 b7>,
     absValidity: 2018-03-21T22:22:00.842Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 7e 06 c7 b4 81 30 15 2f>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.26:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 14 0.5 1521584573038
connected to auth! from local port 47674
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 15 0.4666666666666667 1521584633048
connected to auth! from local port 47864
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 16 0.4375 1521584693058
connected to auth! from local port 48064
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 17 0.4117647058823529 1521584753069
connected to auth! from local port 48214
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 18 0.3888888888888889 1521584813079
connected to auth! from local port 48372
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 19 0.3684210526315789 1521584873090
connected to auth! from local port 48540
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 20 0.35 1521584933100
connected to auth! from local port 48706
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 21 0.3333333333333333 1521584993109
connected to auth! from local port 48866
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 22 0.3181818181818182 1521585053120
connected to auth! from local port 49020
received auth hello!
{ authId: 502, nonce: <Buffer 22 fb 22 63 48 88 92 57> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 76 06 87 8d 9a 32 91 b7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201579,
  cipherKeyVal: <Buffer 97 f6 55 11 3e 33 62 89 78 b9 3e 7d 11 dc 41 81>,
  macKeyVal: <Buffer 78 30 55 40 c2 e0 b7 f7 ca dc b1 1f 77 44 ca 87 26 18 53 2e 9c 1c f2 a2 27 2c 2c cd a3 f0 76 57>,
  absValidity: 2018-03-21T22:31:32.835Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50201579,
     cipherKeyVal: <Buffer 97 f6 55 11 3e 33 62 89 78 b9 3e 7d 11 dc 41 81>,
     macKeyVal: <Buffer 78 30 55 40 c2 e0 b7 f7 ca dc b1 1f 77 44 ca 87 26 18 53 2e 9c 1c f2 a2 27 2c 2c cd a3 f0 76 57>,
     absValidity: 2018-03-21T22:31:32.835Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 24 bf 7e 55 b6 1a d9 ef>
switching to HANDSHAKE_1_SENT
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:31:36 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 22 0.36363636363636365 1521585097221
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 23 0.34782608695652173 1521585113135
connected to auth! from local port 49178
received auth hello!
{ authId: 502, nonce: <Buffer 93 d4 55 96 4e f4 10 a3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 23 dd e0 f1 c1 ba 96 57>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201593,
  cipherKeyVal: <Buffer cf 9e ce af 8e 18 ad df be 82 d1 bb 91 02 4f cd>,
  macKeyVal: <Buffer e6 98 40 ec cd a9 1b 9b cb 1b 89 e0 29 95 05 16 b3 89 cb 39 34 bd 82 60 69 02 9c 27 c5 5b 13 33>,
  absValidity: 2018-03-21T22:32:36.848Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50201593,
     cipherKeyVal: <Buffer cf 9e ce af 8e 18 ad df be 82 d1 bb 91 02 4f cd>,
     macKeyVal: <Buffer e6 98 40 ec cd a9 1b 9b cb 1b 89 e0 29 95 05 16 b3 89 cb 39 34 bd 82 60 69 02 9c 27 c5 5b 13 33>,
     absValidity: 2018-03-21T22:32:36.848Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 64 a3 8e 19 1f bc 14 63>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:32:40 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 9 23 0.391304347826087 1521585161178
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 24 0.375 1521585173148
connected to auth! from local port 49334
received auth hello!
{ authId: 502, nonce: <Buffer 15 20 f5 44 b6 f2 e0 b5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1c c2 b0 b9 83 b7 21 e7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201602,
  cipherKeyVal: <Buffer 1c 82 05 7e b2 fb dd 9b 35 dd b3 92 ae 52 1b 29>,
  macKeyVal: <Buffer d9 b0 67 cc c9 75 4b f9 65 1a 60 8b 17 ee fe 06 3a 2f f2 83 42 aa 2e 2f 55 4c c1 25 d0 a5 8a de>,
  absValidity: 2018-03-21T22:33:36.850Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50201602,
     cipherKeyVal: <Buffer 1c 82 05 7e b2 fb dd 9b 35 dd b3 92 ae 52 1b 29>,
     macKeyVal: <Buffer d9 b0 67 cc c9 75 4b f9 65 1a 60 8b 17 ee fe 06 3a 2f f2 83 42 aa 2e 2f 55 4c c1 25 d0 a5 8a de>,
     absValidity: 2018-03-21T22:33:36.850Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 01 3d 30 fb 4f cb f0 27>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:33:40 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 10 24 0.4166666666666667 1521585221229
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 10 25 0.4 1521585233160
connected to auth! from local port 49468
received auth hello!
{ authId: 502, nonce: <Buffer fd 31 fd 45 c8 4c ca 0b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0d c4 c4 fe 4c 17 64 ba>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201613,
  cipherKeyVal: <Buffer a7 d5 44 f8 62 87 22 38 de 6f 8d e4 ce 64 1f 49>,
  macKeyVal: <Buffer a7 44 54 d1 9a a9 3c 20 60 3f ac ad 03 30 d9 0f 2c 75 8d 16 95 89 e0 d0 14 9e 26 35 50 e3 5b 6c>,
  absValidity: 2018-03-21T22:34:28.826Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50201613,
     cipherKeyVal: <Buffer a7 d5 44 f8 62 87 22 38 de 6f 8d e4 ce 64 1f 49>,
     macKeyVal: <Buffer a7 44 54 d1 9a a9 3c 20 60 3f ac ad 03 30 d9 0f 2c 75 8d 16 95 89 e0 d0 14 9e 26 35 50 e3 5b 6c>,
     absValidity: 2018-03-21T22:34:28.826Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 8e fb 85 ea b7 49 55 2b>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:34:32 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 11 25 0.44 1521585273271
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 11 26 0.4230769230769231 1521585293180
connected to auth! from local port 49606
received auth hello!
{ authId: 502, nonce: <Buffer 5c cc c5 d5 42 d2 1a cf> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3e 8c dc 1c 70 8b 8b aa>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201618,
  cipherKeyVal: <Buffer 7a 1b 89 79 b7 59 32 5f cf 29 8c 81 c2 52 9e 96>,
  macKeyVal: <Buffer a1 2a 5f 38 c2 fd 68 fd 0d c1 f8 ca a9 8a 66 1f 8e 74 83 d9 7c 48 ac fe d4 18 a3 d4 3e d3 c8 d0>,
  absValidity: 2018-03-21T22:34:57.086Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50201618,
     cipherKeyVal: <Buffer 7a 1b 89 79 b7 59 32 5f cf 29 8c 81 c2 52 9e 96>,
     macKeyVal: <Buffer a1 2a 5f 38 c2 fd 68 fd 0d c1 f8 ca a9 8a 66 1f 8e 74 83 d9 7c 48 ac fe d4 18 a3 d4 3e d3 c8 d0>,
     absValidity: 2018-03-21T22:34:57.086Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 93 a5 28 06 e8 58 c4 37>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.26:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 11 27 0.4074074074074074 1521585353183
connected to auth! from local port 49746
received auth hello!
{ authId: 502, nonce: <Buffer c4 5c 47 65 d2 2e 6a 8e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a8 fc a1 b8 f6 bc fa c0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201632,
  cipherKeyVal: <Buffer 0e f4 72 32 ab be 9c e9 4a d7 96 6d c6 09 9a 6e>,
  macKeyVal: <Buffer 0f e7 c6 10 c2 9b 3d 76 36 74 44 d1 c6 25 fc 28 cf a4 57 98 4d f8 2f 4b 66 39 a4 66 b7 94 e5 c8>,
  absValidity: 2018-03-21T22:36:12.822Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50201632,
     cipherKeyVal: <Buffer 0e f4 72 32 ab be 9c e9 4a d7 96 6d c6 09 9a 6e>,
     macKeyVal: <Buffer 0f e7 c6 10 c2 9b 3d 76 36 74 44 d1 c6 25 fc 28 cf a4 57 98 4d f8 2f 4b 66 39 a4 66 b7 94 e5 c8>,
     absValidity: 2018-03-21T22:36:12.822Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 3e 7e e1 45 b2 95 e8 95>
switching to HANDSHAKE_1_SENT
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 22:36:16 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 12 27 0.4444444444444444 1521585377265
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 12 28 0.42857142857142855 1521585413219
connected to auth! from local port 49902
Handler: Error in secure comm - details: Auth hello timedout ...
