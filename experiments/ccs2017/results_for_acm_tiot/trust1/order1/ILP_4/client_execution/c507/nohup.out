changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c507.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c507',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 72 52 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521597562726
connected to auth! from local port 41810
received auth hello!
{ authId: 501, nonce: <Buffer 31 95 cc fb b1 4b b6 a8> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 52 04 7f f8 06 5e 14 af>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 15 2c 96 94 31 5a cc 75 d1 09 e3 db d3 a0 94 a6>,
  macKeyVal: <Buffer df 73 ec 8c 47 71 a9 8b aa 5c c0 f8 35 68 38 e6 c7 9b ab 91 64 09 ef cb 19 26 ce ad 1e 11 ab fc>,
  absValidity: 2018-03-21T02:59:22.884Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100535,
  cipherKeyVal: <Buffer 80 33 18 68 c1 fd a6 74 2f cd 24 ac 14 88 3b 1a>,
  macKeyVal: <Buffer 9f a9 c5 f1 ad 61 20 95 7a d6 26 b5 c3 3a 6f ba 89 23 42 db ab 12 2f 07 47 d2 3a fc f4 0c 42 d3>,
  absValidity: 2018-03-22T01:59:22.883Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100535,
     cipherKeyVal: <Buffer 80 33 18 68 c1 fd a6 74 2f cd 24 ac 14 88 3b 1a>,
     macKeyVal: <Buffer 9f a9 c5 f1 ad 61 20 95 7a d6 26 b5 c3 3a 6f ba 89 23 42 db ab 12 2f 07 47 d2 3a fc f4 0c 42 d3>,
     absValidity: 2018-03-22T01:59:22.883Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 43 bf 68 80 33 8a bf c9>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 01:59:23 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521597563801
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521597622782
connected to auth! from local port 42072
received auth hello!
{ authId: 501, nonce: <Buffer 12 c1 3b 0e fd 6d 33 8b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b8 cf 59 71 1d c9 d9 c8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100543,
  cipherKeyVal: <Buffer a5 3d 54 0b a3 a8 f3 1f 0e ba 47 82 af 70 de 9d>,
  macKeyVal: <Buffer 4e 57 9e 4a ba 4d d1 12 88 22 53 1d 86 f9 6b fa fb 00 70 e0 f1 a7 ef cd 36 c6 ac c4 33 72 5c eb>,
  absValidity: 2018-03-22T02:00:22.959Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100543,
     cipherKeyVal: <Buffer a5 3d 54 0b a3 a8 f3 1f 0e ba 47 82 af 70 de 9d>,
     macKeyVal: <Buffer 4e 57 9e 4a ba 4d d1 12 88 22 53 1d 86 f9 6b fa fb 00 70 e0 f1 a7 ef cd 36 c6 ac c4 33 72 5c eb>,
     absValidity: 2018-03-22T02:00:22.959Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 61 82 8b 3c 19 81 4c c5>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:00:23 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521597623819
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521597682841
connected to auth! from local port 42342
received auth hello!
{ authId: 501, nonce: <Buffer c4 91 d9 b7 31 ac 08 71> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 91 e1 c9 f7 09 cb 1d e3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100551,
  cipherKeyVal: <Buffer a7 77 65 9c 61 e3 ad 46 b4 83 32 db c3 3a 95 35>,
  macKeyVal: <Buffer 5f 72 6e f4 27 2c 24 7f 51 29 a8 bd 92 e5 34 e3 b6 5b 7a a0 04 b0 62 84 d2 36 b0 42 d8 1a cc a3>,
  absValidity: 2018-03-22T02:01:23.016Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100551,
     cipherKeyVal: <Buffer a7 77 65 9c 61 e3 ad 46 b4 83 32 db c3 3a 95 35>,
     macKeyVal: <Buffer 5f 72 6e f4 27 2c 24 7f 51 29 a8 bd 92 e5 34 e3 b6 5b 7a a0 04 b0 62 84 d2 36 b0 42 d8 1a cc a3>,
     absValidity: 2018-03-22T02:01:23.016Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer c6 09 0d 6c 09 73 17 c7>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:01:23 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521597683867
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521597742897
connected to auth! from local port 42612
received auth hello!
{ authId: 501, nonce: <Buffer 53 bc df 1f 1c f0 83 ff> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ea 93 35 e1 82 a8 65 36>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100559,
  cipherKeyVal: <Buffer 2b 6e 2e fa a0 d4 9e 15 40 a1 4f 32 e4 ea 20 b1>,
  macKeyVal: <Buffer d1 74 df 0c 0a a0 06 15 15 19 e4 43 6d 85 0a 20 95 7b 70 8e d1 2e 1d 16 01 ff 65 96 5a 30 da 65>,
  absValidity: 2018-03-22T02:02:23.037Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100559,
     cipherKeyVal: <Buffer 2b 6e 2e fa a0 d4 9e 15 40 a1 4f 32 e4 ea 20 b1>,
     macKeyVal: <Buffer d1 74 df 0c 0a a0 06 15 15 19 e4 43 6d 85 0a 20 95 7b 70 8e d1 2e 1d 16 01 ff 65 96 5a 30 da 65>,
     absValidity: 2018-03-22T02:02:23.037Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 13 34 85 23 63 2f b5 8c>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:02:23 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521597743881
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521597802906
connected to auth! from local port 42882
received auth hello!
{ authId: 501, nonce: <Buffer e4 a0 5a 67 af 56 9d ab> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6f d5 84 d8 27 6e 60 8d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100567,
  cipherKeyVal: <Buffer 53 bc a2 96 9c 9c 3b 7d 23 02 a4 cf 63 47 32 03>,
  macKeyVal: <Buffer a0 28 19 f6 74 51 2b 4e c0 f6 88 91 12 7d 5c ff e6 f9 a4 d6 77 6f ec 9c e7 6b 0c 18 bb ba a8 66>,
  absValidity: 2018-03-22T02:03:23.043Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100567,
     cipherKeyVal: <Buffer 53 bc a2 96 9c 9c 3b 7d 23 02 a4 cf 63 47 32 03>,
     macKeyVal: <Buffer a0 28 19 f6 74 51 2b 4e c0 f6 88 91 12 7d 5c ff e6 f9 a4 d6 77 6f ec 9c e7 6b 0c 18 bb ba a8 66>,
     absValidity: 2018-03-22T02:03:23.043Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 18 82 36 38 02 85 ad 8e>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:03:23 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521597803894
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521597862966
connected to auth! from local port 43152
received auth hello!
{ authId: 501, nonce: <Buffer 04 33 94 a5 8e 27 1d c2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8c 44 15 bc 9e b5 28 a6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100575,
  cipherKeyVal: <Buffer a2 08 3e 4b 70 88 94 27 fa 7f dc 61 78 51 73 6a>,
  macKeyVal: <Buffer 0d 04 06 76 57 c5 ec 8a b3 37 f6 32 24 37 d0 d2 57 cf fa 85 a6 b7 b9 87 3e 77 8b 98 ed 53 af d8>,
  absValidity: 2018-03-22T02:04:23.127Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100575,
     cipherKeyVal: <Buffer a2 08 3e 4b 70 88 94 27 fa 7f dc 61 78 51 73 6a>,
     macKeyVal: <Buffer 0d 04 06 76 57 c5 ec 8a b3 37 f6 32 24 37 d0 d2 57 cf fa 85 a6 b7 b9 87 3e 77 8b 98 ed 53 af d8>,
     absValidity: 2018-03-22T02:04:23.127Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 51 4d 2e a2 82 fc e9 2d>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:04:23 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521597864013
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521597923025
connected to auth! from local port 43422
received auth hello!
{ authId: 501, nonce: <Buffer 2f 3c aa ac 88 ce 05 cf> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4c 0e c9 3e 5c d8 df 7d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100583,
  cipherKeyVal: <Buffer 94 f5 b5 67 af cd a4 1c 46 e9 d8 71 38 ec 21 6c>,
  macKeyVal: <Buffer 4e 33 f0 5c d2 43 b4 43 75 24 d9 9e 93 26 8b 15 9b b7 0e 86 6c c1 bf 67 15 d3 4f 45 d1 83 65 9d>,
  absValidity: 2018-03-22T02:05:23.184Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100583,
     cipherKeyVal: <Buffer 94 f5 b5 67 af cd a4 1c 46 e9 d8 71 38 ec 21 6c>,
     macKeyVal: <Buffer 4e 33 f0 5c d2 43 b4 43 75 24 d9 9e 93 26 8b 15 9b b7 0e 86 6c c1 bf 67 15 d3 4f 45 d1 83 65 9d>,
     absValidity: 2018-03-22T02:05:23.184Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 06 f5 fd 29 51 57 2b 3a>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:05:23 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521597924024
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521597983057
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 9 0.7777777777777778 1521598043068
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 54318
received auth hello!
{ authId: 502, nonce: <Buffer 96 d1 f6 55 c8 b1 e8 43> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '01624645FAB9',
  notBefore: 2018-03-21T01:55:14.000Z,
  notAfter: 2018-03-22T01:56:54.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '2E:C0:89:B5:17:EF:3A:05:8F:67:B9:FE:AA:B3:DE:73:47:D9:C8:CC',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'FF6CB5202497CC77AF28EFDE774858E4FEF04355E5228E378962DF4235BE3683DAF9E38A7E22621D66B3B50166D897E97BF911F9E8FC09D686961AA39679014E5DDD27EA0F02DE853A41537DB5E37F33395E249F355C0D074419572E9856D1D598CAB2CD6951013DDCB0A163B943DFCD2694BE18B9B3892695B3052EBD9115D447293C83AF24A008794B842E4F0A6C2A8D0189612A600AA40A592603E43713C0ECCA681024E5EC429FAD09484B824919DF59C8BD488E0D372D2A3D8B99B6068E24BBBDA8F0BCDDBA806010E4A7181736DF08D4D1CFC16E26507C360EDCBFF1B5F4288CE304DE62E9696665C5108489AD7232658356998FF47C4F7E8A04225423',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJGRfq5MA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDMy\nMTAxNTUxNFoXDTE4MDMyMjAxNTY1NFowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQD/bLUgJJfMd68o7953SFjk/vBDVeUijjeJYt9CNb42g9r544p+\nImIdZrO1AWbYl+l7+RH56PwJ1oaWGqOWeQFOXd0n6g8C3oU6QVN9teN/MzleJJ81\nXA0HRBlXLphW0dWYyrLNaVEBPdywoWO5Q9/NJpS+GLmziSaVswUuvZEV1EcpPIOv\nJKAIeUuELk8KbCqNAYlhKmAKpApZJgPkNxPA7MpoECTl7EKfrQlIS4JJGd9ZyL1I\njg03LSo9i5m2Bo4ku72o8LzduoBgEOSnGBc23wjU0c/BbiZQfDYO3L/xtfQojOME\n3mLpaWZlxRCEia1yMmWDVpmP9HxPfooEIlQjAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAJtn2soSweKqNdCE0rJBsO8oTEnmF8hO\n4ZUxr8YZVwzfcbTRhi3zT6QRSkycbmuAixrS1pb2vtd7yhu+ZtKotzfe5cYAr7Dn\nTnaXJ58Yw6nr15yEX9JVmva4bxtiU3Zowv3x9ySJ3SWmBPR609MPB/V+n7+Ayna/\nfsCTqShchjmVZyfCTs5TjcTqsJLZhKfXKrDyZaMhSDkvCvVkOWBMptSFmncis3m3\ncfq9J9miuSmhMMWN0saQpvSxvNlDZ0b0nYW2i2WHQaxO8UslsZCNRt6NDLi46WK6\nyhm9I4P3rehTQZEq2b8y+WwUkOuEFf0TdgUrPmFPzxGqf2Jr5ysChNg=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 10 0.7 1521598103077
connected to auth! from local port 54530
received auth hello!
{ authId: 502, nonce: <Buffer 61 d0 2d 9b 45 cc e9 51> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 75 68 30 2c 5a 50 0b 60>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer a5 b2 0f 08 f9 68 c3 ae 08 db 9a 9d 52 ab 76 00>,
  macKeyVal: <Buffer 70 c0 25 fa d3 0a 74 86 a6 93 26 df 21 73 31 51 48 d1 de fa 67 77 b6 ab aa 43 ff bc 3c fa f8 be>,
  absValidity: 2018-03-21T03:08:23.237Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200773,
  cipherKeyVal: <Buffer 9b 7a b6 d9 f9 eb 5b 5f af a3 fd b9 9e 00 47 86>,
  macKeyVal: <Buffer 73 bc 7d a0 eb 42 ff bf 76 4e 1c d9 f1 e9 fe 05 03 d0 4a 12 15 f3 68 3e 3b 3b 2b eb 5a d4 7c 99>,
  absValidity: 2018-03-22T02:08:23.237Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200773,
     cipherKeyVal: <Buffer 9b 7a b6 d9 f9 eb 5b 5f af a3 fd b9 9e 00 47 86>,
     macKeyVal: <Buffer 73 bc 7d a0 eb 42 ff bf 76 4e 1c d9 f1 e9 fe 05 03 d0 4a 12 15 f3 68 3e 3b 3b 2b eb 5a d4 7c 99>,
     absValidity: 2018-03-22T02:08:23.237Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer a4 c3 4b f5 7c ef 13 4b>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.28:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 11 0.6363636363636364 1521598163087
connected to auth! from local port 54772
received auth hello!
{ authId: 502, nonce: <Buffer 62 b6 e1 4f a7 16 96 8c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 90 9b 19 65 71 e3 1f 9e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200782,
  cipherKeyVal: <Buffer 66 52 b2 63 27 62 e8 c3 bc 8c dc 95 41 20 17 e0>,
  macKeyVal: <Buffer 69 da 88 47 78 1f bc b0 e9 3a b6 d5 60 70 6b dc f6 6e f0 5c d3 11 73 57 91 2f 28 7e 6f 2b 0c e4>,
  absValidity: 2018-03-22T02:09:23.968Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200782,
     cipherKeyVal: <Buffer 66 52 b2 63 27 62 e8 c3 bc 8c dc 95 41 20 17 e0>,
     macKeyVal: <Buffer 69 da 88 47 78 1f bc b0 e9 3a b6 d5 60 70 6b dc f6 6e f0 5c d3 11 73 57 91 2f 28 7e 6f 2b 0c e4>,
     absValidity: 2018-03-22T02:09:23.968Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 99 f4 f4 09 23 15 c9 a5>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.28:undefined
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 12 0.5833333333333334 1521598223097
connected to auth! from local port 55024
received auth hello!
{ authId: 502, nonce: <Buffer a4 02 20 1d 88 9d 71 bd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9e 36 be b7 2b 44 15 cb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200794,
  cipherKeyVal: <Buffer fa 00 61 57 14 6e 30 2a f9 bc df e2 d3 f1 65 65>,
  macKeyVal: <Buffer b1 5c 2b c3 0f 36 79 17 d1 85 b0 68 44 49 1e 9e 86 bc 79 21 68 5f ee 90 a6 7e 2d 7e 5b b6 b1 73>,
  absValidity: 2018-03-22T02:10:23.417Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200794,
     cipherKeyVal: <Buffer fa 00 61 57 14 6e 30 2a f9 bc df e2 d3 f1 65 65>,
     macKeyVal: <Buffer b1 5c 2b c3 0f 36 79 17 d1 85 b0 68 44 49 1e 9e 86 bc 79 21 68 5f ee 90 a6 7e 2d 7e 5b b6 b1 73>,
     absValidity: 2018-03-22T02:10:23.417Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 13 0.5384615384615384 1521598283153
connected to auth! from local port 55240
received auth hello!
{ authId: 502, nonce: <Buffer f6 8a 55 75 eb d7 57 28> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 10 1f 7f 6f 65 14 12 12>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200808,
  cipherKeyVal: <Buffer dc 58 3c ff fd c1 47 be 0f 1c ef 2a 05 9e 17 65>,
  macKeyVal: <Buffer 02 c6 63 bd 58 32 06 ab bf 03 0c 4d 53 65 5f 91 10 6d 74 7a 58 54 6b bc 1d 51 8f da 4b b5 68 d9>,
  absValidity: 2018-03-22T02:11:23.337Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200808,
     cipherKeyVal: <Buffer dc 58 3c ff fd c1 47 be 0f 1c ef 2a 05 9e 17 65>,
     macKeyVal: <Buffer 02 c6 63 bd 58 32 06 ab bf 03 0c 4d 53 65 5f 91 10 6d 74 7a 58 54 6b bc 1d 51 8f da 4b b5 68 d9>,
     absValidity: 2018-03-22T02:11:23.337Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 14 0.5 1521598343160
connected to auth! from local port 55464
received auth hello!
{ authId: 502, nonce: <Buffer 3a 75 74 7d 1c 89 b6 27> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 34 e9 11 86 01 cd 34 9a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200823,
  cipherKeyVal: <Buffer 20 40 ba 89 8c 5a 8e 81 b6 8a 49 d3 0a e4 e4 4e>,
  macKeyVal: <Buffer 41 0b 2d d6 88 bc f9 8e 82 2f 5d f1 6d 37 16 b0 f5 d9 53 33 03 28 5e 99 70 d1 6b ff 81 08 61 7b>,
  absValidity: 2018-03-22T02:12:23.339Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200823,
     cipherKeyVal: <Buffer 20 40 ba 89 8c 5a 8e 81 b6 8a 49 d3 0a e4 e4 4e>,
     macKeyVal: <Buffer 41 0b 2d d6 88 bc f9 8e 82 2f 5d f1 6d 37 16 b0 f5 d9 53 33 03 28 5e 99 70 d1 6b ff 81 08 61 7b>,
     absValidity: 2018-03-22T02:12:23.339Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 15 0.4666666666666667 1521598403220
connected to auth! from local port 55698
received auth hello!
{ authId: 502, nonce: <Buffer d3 13 0f 6e 9a 82 d0 b6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 98 e2 a7 51 27 38 a6 ef>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200838,
  cipherKeyVal: <Buffer cf f5 1d fe fa c6 b0 3d ff 3c d9 9f 87 3e 95 ac>,
  macKeyVal: <Buffer 34 22 9c fe d5 da d9 f6 de fb 4b c0 88 81 47 61 1a 05 d9 f8 fb 7a 4c f3 71 9a 0c 7b 4b bd ee 68>,
  absValidity: 2018-03-22T02:13:23.490Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200838,
     cipherKeyVal: <Buffer cf f5 1d fe fa c6 b0 3d ff 3c d9 9f 87 3e 95 ac>,
     macKeyVal: <Buffer 34 22 9c fe d5 da d9 f6 de fb 4b c0 88 81 47 61 1a 05 d9 f8 fb 7a 4c f3 71 9a 0c 7b 4b bd ee 68>,
     absValidity: 2018-03-22T02:13:23.490Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 16 0.4375 1521598463280
connected to auth! from local port 55916
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 17 0.4117647058823529 1521598523291
connected to auth! from local port 56138
received auth hello!
{ authId: 502, nonce: <Buffer d0 60 07 69 ce d1 76 e7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 13 5b ba 00 bc 8f 6a 58>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200867,
  cipherKeyVal: <Buffer f6 4a b5 27 ae a4 8b f6 99 45 fa f5 87 ba e3 82>,
  macKeyVal: <Buffer 95 c5 35 1f 3d 0c 3b 62 fd 6a f5 80 29 6a 6d 0c be a4 db 80 f0 4b 6e 26 f2 90 a8 e2 fe ca c4 38>,
  absValidity: 2018-03-22T02:15:43.109Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200867,
     cipherKeyVal: <Buffer f6 4a b5 27 ae a4 8b f6 99 45 fa f5 87 ba e3 82>,
     macKeyVal: <Buffer 95 c5 35 1f 3d 0c 3b 62 fd 6a f5 80 29 6a 6d 0c be a4 db 80 f0 4b 6e 26 f2 90 a8 e2 fe ca c4 38>,
     absValidity: 2018-03-22T02:15:43.109Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 18 0.3888888888888889 1521598583332
connected to auth! from local port 56348
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 19 0.3684210526315789 1521598643343
connected to auth! from local port 56544
received auth hello!
{ authId: 502, nonce: <Buffer d7 35 85 c9 45 9c ee 93> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 45 32 5f 3f bc b0 cf 43>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200890,
  cipherKeyVal: <Buffer 81 e6 3e 77 42 ff 1b 53 f1 3b 7d 15 d0 a0 78 cd>,
  macKeyVal: <Buffer e8 c3 c8 01 f1 17 e1 17 b2 e3 d6 94 10 93 cf f7 d7 3c df ab 6c 69 09 d3 c7 21 69 73 23 5a 12 1d>,
  absValidity: 2018-03-22T02:17:27.122Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200890,
     cipherKeyVal: <Buffer 81 e6 3e 77 42 ff 1b 53 f1 3b 7d 15 d0 a0 78 cd>,
     macKeyVal: <Buffer e8 c3 c8 01 f1 17 e1 17 b2 e3 d6 94 10 93 cf f7 d7 3c df ab 6c 69 09 d3 c7 21 69 73 23 5a 12 1d>,
     absValidity: 2018-03-22T02:17:27.122Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
received auth hello!
{ authId: 502, nonce: <Buffer 65 ee 70 9a fb 1f 3f a0> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: write after end
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 20 0.35 1521598703371
connected to auth! from local port 56746
Handler: Error in secure comm - details: Connection with Auth timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 74 db 4b 5a f5 a1 bc 48> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 80 1d a0 d7 26 d8 12 5e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200904,
  cipherKeyVal: <Buffer 53 b2 10 c2 af f6 ca 13 f2 40 89 d0 cd 71 3d 3c>,
  macKeyVal: <Buffer bc f1 6d 99 1e 1b 2d 8a b2 80 1e 96 08 9e 6f 6d c8 d5 6c 81 8b 4e bc 95 cb b5 e5 aa 40 1a 44 fe>,
  absValidity: 2018-03-22T02:18:35.138Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200904,
     cipherKeyVal: <Buffer 53 b2 10 c2 af f6 ca 13 f2 40 89 d0 cd 71 3d 3c>,
     macKeyVal: <Buffer bc f1 6d 99 1e 1b 2d 8a b2 80 1e 96 08 9e 6f 6d c8 d5 6c 81 8b 4e bc 95 cb b5 e5 aa 40 1a 44 fe>,
     absValidity: 2018-03-22T02:18:35.138Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 21 0.3333333333333333 1521598763419
connected to auth! from local port 56948
received auth hello!
{ authId: 502, nonce: <Buffer 28 7c b9 48 89 0d c7 e7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3e 7d 8b f1 73 2d 04 bb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200917,
  cipherKeyVal: <Buffer 6a f4 e0 29 97 13 4a 9e 32 d6 d2 6e 50 8b b1 a6>,
  macKeyVal: <Buffer b8 74 37 01 c3 0a f4 97 00 53 45 4b c9 3a de a3 50 86 3d 8e 5a 30 58 64 84 75 82 5b b5 22 cf cb>,
  absValidity: 2018-03-22T02:19:35.113Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200917,
     cipherKeyVal: <Buffer 6a f4 e0 29 97 13 4a 9e 32 d6 d2 6e 50 8b b1 a6>,
     macKeyVal: <Buffer b8 74 37 01 c3 0a f4 97 00 53 45 4b c9 3a de a3 50 86 3d 8e 5a 30 58 64 84 75 82 5b b5 22 cf cb>,
     absValidity: 2018-03-22T02:19:35.113Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 22 0.3181818181818182 1521598823468
connected to auth! from local port 57158
received auth hello!
{ authId: 502, nonce: <Buffer f8 c2 2d 6b bd f5 79 23> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c8 26 ad a1 0c a9 ab 6d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200930,
  cipherKeyVal: <Buffer 58 e9 c6 87 c8 78 a6 b8 da e8 50 41 b2 99 b6 18>,
  macKeyVal: <Buffer f0 37 e3 4b 03 bf ca 24 e7 a0 1f 2a 3d 19 f4 39 ca d5 78 42 29 14 01 c9 ab 7c 81 7e 21 19 a8 6d>,
  absValidity: 2018-03-22T02:20:39.125Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200930,
     cipherKeyVal: <Buffer 58 e9 c6 87 c8 78 a6 b8 da e8 50 41 b2 99 b6 18>,
     macKeyVal: <Buffer f0 37 e3 4b 03 bf ca 24 e7 a0 1f 2a 3d 19 f4 39 ca d5 78 42 29 14 01 c9 ab 7c 81 7e 21 19 a8 6d>,
     absValidity: 2018-03-22T02:20:39.125Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 23 0.30434782608695654 1521598883513
connected to auth! from local port 57346
received auth hello!
{ authId: 502, nonce: <Buffer 63 fc 9c 89 db 8c 32 48> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 97 c3 30 9a a9 d3 85 29>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200945,
  cipherKeyVal: <Buffer 36 46 46 ea 5d 76 e2 47 14 8e 48 65 ff 61 6e bf>,
  macKeyVal: <Buffer 92 02 7f c2 a9 7a 06 17 3e 5f dd 76 e4 96 20 4b 3e c3 e3 4b e6 51 30 65 3e 2c 48 32 7e a1 b1 5c>,
  absValidity: 2018-03-22T02:21:39.375Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200945,
     cipherKeyVal: <Buffer 36 46 46 ea 5d 76 e2 47 14 8e 48 65 ff 61 6e bf>,
     macKeyVal: <Buffer 92 02 7f c2 a9 7a 06 17 3e 5f dd 76 e4 96 20 4b 3e c3 e3 4b e6 51 30 65 3e 2c 48 32 7e a1 b1 5c>,
     absValidity: 2018-03-22T02:21:39.375Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
received auth hello!
{ authId: 502, nonce: <Buffer 20 89 d6 f9 18 4a f7 a2> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: write after end
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 24 0.2916666666666667 1521598943529
connected to auth! from local port 57530
Handler: Error in secure comm - details: Connection with Auth timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 3e 44 f2 fc 9c bc fb e3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 97 d9 59 aa 7e d2 b2 ac>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200956,
  cipherKeyVal: <Buffer 4a 8b 6e ba 48 07 eb 65 c4 0d 91 20 cf 74 97 b6>,
  macKeyVal: <Buffer 6b a8 a7 0c b9 f8 80 9d d9 80 fc 1c f2 66 92 e0 a3 22 73 e4 42 bd 21 b7 31 c2 ba cc f1 c5 1d 33>,
  absValidity: 2018-03-22T02:22:39.369Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200956,
     cipherKeyVal: <Buffer 4a 8b 6e ba 48 07 eb 65 c4 0d 91 20 cf 74 97 b6>,
     macKeyVal: <Buffer 6b a8 a7 0c b9 f8 80 9d d9 80 fc 1c f2 66 92 e0 a3 22 73 e4 42 bd 21 b7 31 c2 ba cc f1 c5 1d 33>,
     absValidity: 2018-03-22T02:22:39.369Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 25 0.28 1521599003570
connected to auth! from local port 57714
received auth hello!
{ authId: 502, nonce: <Buffer a5 ff 56 ff cc 4c 71 04> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 32 6f 36 73 0c ac dd b2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200973,
  cipherKeyVal: <Buffer 8b 0f e7 1e 58 e6 96 cc 3f a1 d9 0f 6b 39 8d f8>,
  macKeyVal: <Buffer 3b 52 65 ce 30 91 02 e1 e7 de 06 a0 ae 8b 6d d0 16 f3 67 f1 88 7f e0 6f 44 aa 02 74 f8 61 1c a4>,
  absValidity: 2018-03-22T02:23:43.375Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200973,
     cipherKeyVal: <Buffer 8b 0f e7 1e 58 e6 96 cc 3f a1 d9 0f 6b 39 8d f8>,
     macKeyVal: <Buffer 3b 52 65 ce 30 91 02 e1 e7 de 06 a0 ae 8b 6d d0 16 f3 67 f1 88 7f e0 6f 44 aa 02 74 f8 61 1c a4>,
     absValidity: 2018-03-22T02:23:43.375Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 26 0.2692307692307692 1521599063610
connected to auth! from local port 57906
received auth hello!
{ authId: 502, nonce: <Buffer 1f 44 b8 56 12 12 e2 1b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 42 4b 09 55 c3 54 7f 17>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200985,
  cipherKeyVal: <Buffer 21 15 2d 47 94 b3 90 b1 91 b3 5a f6 21 15 06 d2>,
  macKeyVal: <Buffer 56 3a bc f5 e3 4c 12 95 1d 73 46 03 85 6f 8d 5e 0f b7 57 35 59 7c 1e 43 8a f5 88 94 b6 82 17 ba>,
  absValidity: 2018-03-22T02:24:27.402Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50200985,
     cipherKeyVal: <Buffer 21 15 2d 47 94 b3 90 b1 91 b3 5a f6 21 15 06 d2>,
     macKeyVal: <Buffer 56 3a bc f5 e3 4c 12 95 1d 73 46 03 85 6f 8d 5e 0f b7 57 35 59 7c 1e 43 8a f5 88 94 b6 82 17 ba>,
     absValidity: 2018-03-22T02:24:27.402Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 27 0.25925925925925924 1521599123665
connected to auth! from local port 58102
received auth hello!
{ authId: 502, nonce: <Buffer df 81 27 8a b4 dc e5 c5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 24 b9 0a bb 4b 3f c2 a6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201000,
  cipherKeyVal: <Buffer 77 48 a4 1e 25 f3 8e e7 78 2d b1 04 34 3f e2 a8>,
  macKeyVal: <Buffer b4 21 fa 3d b6 d2 eb 0e 23 2d 5e e5 96 b4 67 7f a8 3a 6f 64 af 06 2e cc 5c 70 d3 b0 6b af d7 de>,
  absValidity: 2018-03-22T02:25:24.371Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50201000,
     cipherKeyVal: <Buffer 77 48 a4 1e 25 f3 8e e7 78 2d b1 04 34 3f e2 a8>,
     macKeyVal: <Buffer b4 21 fa 3d b6 d2 eb 0e 23 2d 5e e5 96 b4 67 7f a8 3a 6f 64 af 06 2e cc 5c 70 d3 b0 6b af d7 de>,
     absValidity: 2018-03-22T02:25:24.371Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 28 0.25 1521599183682
connected to auth! from local port 58280
received auth hello!
{ authId: 502, nonce: <Buffer 99 92 3f d8 58 ef 1f 0a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8a 87 b7 c5 b7 09 87 71>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201015,
  cipherKeyVal: <Buffer 60 56 0a 88 69 6e 5d 0e 6b 07 b0 79 4d 4a 56 a0>,
  macKeyVal: <Buffer f3 dc 2a e1 5c 0c 5e 8e 97 46 13 c6 f8 85 79 57 ed c5 44 f7 b8 e7 02 29 1b 8a b5 ea b7 ba 0c 2b>,
  absValidity: 2018-03-22T02:26:24.128Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50201015,
     cipherKeyVal: <Buffer 60 56 0a 88 69 6e 5d 0e 6b 07 b0 79 4d 4a 56 a0>,
     macKeyVal: <Buffer f3 dc 2a e1 5c 0c 5e 8e 97 46 13 c6 f8 85 79 57 ed c5 44 f7 b8 e7 02 29 1b 8a b5 ea b7 ba 0c 2b>,
     absValidity: 2018-03-22T02:26:24.128Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
