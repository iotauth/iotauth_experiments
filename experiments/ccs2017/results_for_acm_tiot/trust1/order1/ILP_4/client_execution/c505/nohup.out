changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c505.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c505',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 34 31 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521597556127
connected to auth! from local port 39036
received auth hello!
{ authId: 504, nonce: <Buffer eb 15 6d 82 d8 70 77 60> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer ed f6 b8 7a fa 17 6b cb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 9d 3e 24 d7 ca e4 09 49 ad ea 16 74 19 6a 31 ab>,
  macKeyVal: <Buffer 84 d5 f6 9f 98 52 d4 36 0f 1a f7 5d e7 34 05 c6 ff 1d 6d 6d f4 16 f9 1a ba b5 f5 5b 92 72 92 b4>,
  absValidity: 2018-03-21T02:59:16.299Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400114,
  cipherKeyVal: <Buffer 23 8d 2b 55 a8 1f 7c c2 02 09 3e ec 9f 94 4f dd>,
  macKeyVal: <Buffer e2 19 a4 51 a0 97 3b 30 97 ea 1f 12 7b 16 fd 6f d4 1c bf 38 6f 2e 1d 08 e5 28 55 4c 24 14 11 93>,
  absValidity: 2018-03-22T01:59:16.299Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50400114,
     cipherKeyVal: <Buffer 23 8d 2b 55 a8 1f 7c c2 02 09 3e ec 9f 94 4f dd>,
     macKeyVal: <Buffer e2 19 a4 51 a0 97 3b 30 97 ea 1f 12 7b 16 fd 6f d4 1c bf 38 6f 2e 1d 08 e5 28 55 4c 24 14 11 93>,
     absValidity: 2018-03-22T01:59:16.299Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 35 e3 30 ff 9b 60 21 cf>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 01:59:16 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521597557225
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521597616186
connected to auth! from local port 39286
received auth hello!
{ authId: 504, nonce: <Buffer 1e 88 2c 64 c0 5c d5 12> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c5 b7 c5 45 74 35 96 d9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400117,
  cipherKeyVal: <Buffer 3f 3c 9d d8 1c cc d2 e9 47 df 8b 06 8b 66 22 aa>,
  macKeyVal: <Buffer c5 67 c9 b8 cb f9 04 7c f5 59 4d 03 76 04 27 55 63 b7 a6 32 73 ef 0a ca e4 5b 14 d4 e3 19 f3 b0>,
  absValidity: 2018-03-22T02:00:16.516Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50400117,
     cipherKeyVal: <Buffer 3f 3c 9d d8 1c cc d2 e9 47 df 8b 06 8b 66 22 aa>,
     macKeyVal: <Buffer c5 67 c9 b8 cb f9 04 7c f5 59 4d 03 76 04 27 55 63 b7 a6 32 73 ef 0a ca e4 5b 14 d4 e3 19 f3 b0>,
     absValidity: 2018-03-22T02:00:16.516Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 42 be df d0 64 7f 7c 5f>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:00:20 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521597620843
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521597676241
connected to auth! from local port 39556
received auth hello!
{ authId: 504, nonce: <Buffer cd e4 04 73 72 0b 72 9b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 92 71 c9 54 0d 63 de 2a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400123,
  cipherKeyVal: <Buffer ee 1a 53 46 8d fd 4e 65 93 7b f2 75 79 cc 36 c1>,
  macKeyVal: <Buffer 57 8d 63 01 70 b7 11 2b f8 95 fd 28 27 26 a1 ac 1d 51 2f 5d 9c 0f 78 99 32 65 32 e2 ea 09 e4 03>,
  absValidity: 2018-03-22T02:01:16.736Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50400123,
     cipherKeyVal: <Buffer ee 1a 53 46 8d fd 4e 65 93 7b f2 75 79 cc 36 c1>,
     macKeyVal: <Buffer 57 8d 63 01 70 b7 11 2b f8 95 fd 28 27 26 a1 ac 1d 51 2f 5d 9c 0f 78 99 32 65 32 e2 ea 09 e4 03>,
     absValidity: 2018-03-22T02:01:16.736Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 40 bd ff 61 dd 13 fa 27>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:01:20 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521597680883
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521597736297
connected to auth! from local port 39828
received auth hello!
{ authId: 504, nonce: <Buffer ca 11 4f b7 51 3e ca e5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b5 b2 2a 96 30 9b 8a 3f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400129,
  cipherKeyVal: <Buffer 63 4b d3 b6 ac f3 d5 e2 ef 80 d9 4a d4 53 b4 44>,
  macKeyVal: <Buffer c5 f6 00 d7 19 4c e9 2e d4 a3 ba 0b 4a fc 6a b7 6e 25 c2 66 23 63 35 b2 7f 44 91 4c 34 95 74 d2>,
  absValidity: 2018-03-22T02:02:16.554Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50400129,
     cipherKeyVal: <Buffer 63 4b d3 b6 ac f3 d5 e2 ef 80 d9 4a d4 53 b4 44>,
     macKeyVal: <Buffer c5 f6 00 d7 19 4c e9 2e d4 a3 ba 0b 4a fc 6a b7 6e 25 c2 66 23 63 35 b2 7f 44 91 4c 34 95 74 d2>,
     absValidity: 2018-03-22T02:02:16.554Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer a2 cf 73 ba ff a8 53 f0>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:02:20 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521597740938
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521597796335
connected to auth! from local port 40096
received auth hello!
{ authId: 504, nonce: <Buffer 79 75 d3 20 4f 13 99 d3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2e 63 39 6c 09 29 e8 1e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400135,
  cipherKeyVal: <Buffer 73 84 ca 9d 58 d5 1c 96 1e b5 a2 84 16 1a c3 fb>,
  macKeyVal: <Buffer ca 1d bb 81 f5 7b ec 2b 34 5c e8 4c 32 36 9d 51 ff e8 59 47 c9 7c 87 f6 a9 ff c1 24 38 95 43 7c>,
  absValidity: 2018-03-22T02:03:16.757Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50400135,
     cipherKeyVal: <Buffer 73 84 ca 9d 58 d5 1c 96 1e b5 a2 84 16 1a c3 fb>,
     macKeyVal: <Buffer ca 1d bb 81 f5 7b ec 2b 34 5c e8 4c 32 36 9d 51 ff e8 59 47 c9 7c 87 f6 a9 ff c1 24 38 95 43 7c>,
     absValidity: 2018-03-22T02:03:16.757Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 6b b1 02 08 63 89 64 17>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:03:20 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521597801000
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521597856389
connected to auth! from local port 40366
received auth hello!
{ authId: 504, nonce: <Buffer 14 ae 33 f4 36 09 58 61> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a2 43 3a 52 15 2d d7 fc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400141,
  cipherKeyVal: <Buffer 18 85 2f e8 a4 04 e2 d0 ab bb 07 41 78 67 0d 54>,
  macKeyVal: <Buffer 7b d9 d1 ec 69 4f a7 3b 3f 12 be a2 a4 78 cb 3e 52 e8 f8 c7 8c 8d 2b 0f b3 0f fc 5a 83 a4 00 8c>,
  absValidity: 2018-03-22T02:04:16.685Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50400141,
     cipherKeyVal: <Buffer 18 85 2f e8 a4 04 e2 d0 ab bb 07 41 78 67 0d 54>,
     macKeyVal: <Buffer 7b d9 d1 ec 69 4f a7 3b 3f 12 be a2 a4 78 cb 3e 52 e8 f8 c7 8c 8d 2b 0f b3 0f fc 5a 83 a4 00 8c>,
     absValidity: 2018-03-22T02:04:16.685Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 4a 19 a9 5a fb 62 10 c3>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:04:20 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521597861433
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521597916441
connected to auth! from local port 40636
received auth hello!
{ authId: 504, nonce: <Buffer f3 e4 e2 84 b6 9f a6 7f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b6 e1 b7 1e 81 3f cc b1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400147,
  cipherKeyVal: <Buffer fa 44 16 1c 38 4c 28 55 c9 60 60 b8 ff 48 21 fd>,
  macKeyVal: <Buffer 0f f1 fd 76 36 99 92 9f 22 f6 5e bc c9 6d 22 d7 0f af 74 63 47 1a 37 26 30 2f 06 ab fd 49 8c 8b>,
  absValidity: 2018-03-22T02:05:16.803Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50400147,
     cipherKeyVal: <Buffer fa 44 16 1c 38 4c 28 55 c9 60 60 b8 ff 48 21 fd>,
     macKeyVal: <Buffer 0f f1 fd 76 36 99 92 9f 22 f6 5e bc c9 6d 22 d7 0f af 74 63 47 1a 37 26 30 2f 06 ab fd 49 8c 8b>,
     absValidity: 2018-03-22T02:05:16.803Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 09 98 8a e3 b4 f5 f3 8c>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:05:20 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521597921230
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521597976497
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 9 0.7777777777777778 1521598036506
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 10 0.7 1521598096510
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 47378
received auth hello!
{ authId: 502, nonce: <Buffer e0 df 42 9e 13 f1 73 54> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth504',
     commonName: '10.0.0.7' },
  serial: '016246460309',
  notBefore: 2018-03-21T01:55:16.000Z,
  notAfter: 2018-03-22T01:56:56.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'AB:B4:22:6D:DC:14:27:9B:72:32:67:BA:1A:E8:82:A3:33:F0:33:71',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'FF6CB5202497CC77AF28EFDE774858E4FEF04355E5228E378962DF4235BE3683DAF9E38A7E22621D66B3B50166D897E97BF911F9E8FC09D686961AA39679014E5DDD27EA0F02DE853A41537DB5E37F33395E249F355C0D074419572E9856D1D598CAB2CD6951013DDCB0A163B943DFCD2694BE18B9B3892695B3052EBD9115D447293C83AF24A008794B842E4F0A6C2A8D0189612A600AA40A592603E43713C0ECCA681024E5EC429FAD09484B824919DF59C8BD488E0D372D2A3D8B99B6068E24BBBDA8F0BCDDBA806010E4A7181736DF08D4D1CFC16E26507C360EDCBFF1B5F4288CE304DE62E9696665C5108489AD7232658356998FF47C4F7E8A04225423',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJGRgMJMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDQxETAPBgNVBAMMCDEwLjAuMC43MB4XDTE4MDMy\nMTAxNTUxNloXDTE4MDMyMjAxNTY1NlowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQD/bLUgJJfMd68o7953SFjk/vBDVeUijjeJYt9CNb42g9r544p+\nImIdZrO1AWbYl+l7+RH56PwJ1oaWGqOWeQFOXd0n6g8C3oU6QVN9teN/MzleJJ81\nXA0HRBlXLphW0dWYyrLNaVEBPdywoWO5Q9/NJpS+GLmziSaVswUuvZEV1EcpPIOv\nJKAIeUuELk8KbCqNAYlhKmAKpApZJgPkNxPA7MpoECTl7EKfrQlIS4JJGd9ZyL1I\njg03LSo9i5m2Bo4ku72o8LzduoBgEOSnGBc23wjU0c/BbiZQfDYO3L/xtfQojOME\n3mLpaWZlxRCEia1yMmWDVpmP9HxPfooEIlQjAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAJe4gcV0gxhx3i9/8mmGRxjw+DyeOLYk\nLdDGYSKkewMB5kt5+dO3FZvRXlWEqKnnsHWfDA30PSJx3a5KsJGDKmSCgD2lPHtp\n9NM9Lh3gdBrTYeX7f+ar4rSh10I4Zokx0jIFGoE3IbEIHQSC9Igj9NOYvHaqegZY\noJhsgCa52HjCEyLw9gaZ88wZ0kCpjruppwkN7e6lRnkjNJ53fzdAPRbEeACS0ISS\nbrw6vBCCOzsygupM335GwzwNs6Iom+U6LvWAEyvM2HOmzaUvqiXH3UYzmmxhTUYe\nZCxCKQtTO/bYMTVSjlIA7oZ0TWyuxv9nIc2k2fmuerLXe4/C0NsM2CU=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 1
to: 2
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 11 0.6363636363636364 1521598156517
connected to auth! from local port 47604
received auth hello!
{ authId: 502, nonce: <Buffer 84 11 68 59 e3 64 f2 91> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer fd ac 23 c7 65 29 60 86>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer ae 4f be 1d be 33 dc c7 29 ae 76 e2 98 34 d6 38>,
  macKeyVal: <Buffer 00 19 ea 4b 9d 01 1d 8b d8 da 29 63 2f aa bc 39 0d 74 82 72 d9 fd 91 a8 02 7d 88 4b 9a 48 07 0c>,
  absValidity: 2018-03-21T03:09:16.701Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200781,
  cipherKeyVal: <Buffer af 6f a7 26 b5 86 5d c0 50 07 83 a0 f8 c7 5a dd>,
  macKeyVal: <Buffer 4d a1 2a cb 52 09 da 6f b6 d7 fc 63 a3 0f ad 74 27 88 7b ab 24 b9 9c 0a 07 c5 25 c1 c8 9d 06 84>,
  absValidity: 2018-03-22T02:09:16.700Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50200781,
     cipherKeyVal: <Buffer af 6f a7 26 b5 86 5d c0 50 07 83 a0 f8 c7 5a dd>,
     macKeyVal: <Buffer 4d a1 2a cb 52 09 da 6f b6 d7 fc 63 a3 0f ad 74 27 88 7b ab 24 b9 9c 0a 07 c5 25 c1 c8 9d 06 84>,
     absValidity: 2018-03-22T02:09:16.700Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer db 8f d1 a7 78 16 96 82>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.26:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 12 0.5833333333333334 1521598216525
connected to auth! from local port 47856
received auth hello!
{ authId: 502, nonce: <Buffer e5 c5 4b e1 07 d8 ee f8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 67 14 06 51 ad a8 ee 31>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200792,
  cipherKeyVal: <Buffer 34 56 e5 7c 03 4c 6d fe 84 92 71 af 10 2c d6 dc>,
  macKeyVal: <Buffer 51 42 ea b7 ed 5b 84 60 c3 18 79 91 41 32 e2 3a c1 3c 56 62 e3 01 3d 63 44 e7 9f d0 2e 1c 72 ce>,
  absValidity: 2018-03-22T02:10:16.663Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50200792,
     cipherKeyVal: <Buffer 34 56 e5 7c 03 4c 6d fe 84 92 71 af 10 2c d6 dc>,
     macKeyVal: <Buffer 51 42 ea b7 ed 5b 84 60 c3 18 79 91 41 32 e2 3a c1 3c 56 62 e3 01 3d 63 44 e7 9f d0 2e 1c 72 ce>,
     absValidity: 2018-03-22T02:10:16.663Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 32 40 e5 f7 58 60 18 50>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.26:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 13 0.5384615384615384 1521598276529
connected to auth! from local port 48068
received auth hello!
{ authId: 502, nonce: <Buffer 13 e3 c6 9b 78 2f 77 00> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b9 54 de c8 bb f2 2d d3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200806,
  cipherKeyVal: <Buffer c6 8d 4b c2 a2 19 0f ff 81 97 23 29 ef 7d 01 3e>,
  macKeyVal: <Buffer 86 b4 70 21 0b 0b 87 8e fd f4 ae 89 8c d9 78 2c e5 98 ba ec 6b bb 53 f1 c9 1c 62 67 eb 48 2a d7>,
  absValidity: 2018-03-22T02:11:16.657Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50200806,
     cipherKeyVal: <Buffer c6 8d 4b c2 a2 19 0f ff 81 97 23 29 ef 7d 01 3e>,
     macKeyVal: <Buffer 86 b4 70 21 0b 0b 87 8e fd f4 ae 89 8c d9 78 2c e5 98 ba ec 6b bb 53 f1 c9 1c 62 67 eb 48 2a d7>,
     absValidity: 2018-03-22T02:11:16.657Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer a9 ac 62 93 ad c6 2d fa>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.26:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 14 0.5 1521598336539
connected to auth! from local port 48294
received auth hello!
{ authId: 502, nonce: <Buffer 21 35 75 23 ca f7 9d dc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer de 72 b5 91 22 0c 1b 3d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200821,
  cipherKeyVal: <Buffer 58 8d a1 02 53 95 ff 30 1c a9 5d d4 5b 66 b7 18>,
  macKeyVal: <Buffer 73 5f e2 3e 34 e1 e7 44 2b 30 bc d5 54 61 5e ae 62 49 4e f5 36 cf 6d 3e d0 28 96 bd b5 b7 25 4e>,
  absValidity: 2018-03-22T02:12:16.698Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50200821,
     cipherKeyVal: <Buffer 58 8d a1 02 53 95 ff 30 1c a9 5d d4 5b 66 b7 18>,
     macKeyVal: <Buffer 73 5f e2 3e 34 e1 e7 44 2b 30 bc d5 54 61 5e ae 62 49 4e f5 36 cf 6d 3e d0 28 96 bd b5 b7 25 4e>,
     absValidity: 2018-03-22T02:12:16.698Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer d2 67 5f 2e 24 ba 46 c2>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.26:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 15 0.4666666666666667 1521598396549
connected to auth! from local port 48526
received auth hello!
{ authId: 502, nonce: <Buffer 50 7f c2 79 8a 6d 13 02> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 49 fd 1e 75 bc 42 e1 6d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200836,
  cipherKeyVal: <Buffer cf f7 ac 68 d7 c2 43 b1 9f f4 ea 2c 92 5c b1 85>,
  macKeyVal: <Buffer b0 bc 70 43 44 00 95 4d ee 9f 5a f4 84 a3 c0 90 49 b1 6d 09 9e 91 5b 5d 9d 12 a1 b3 ec 5a 7c 26>,
  absValidity: 2018-03-22T02:13:16.736Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50200836,
     cipherKeyVal: <Buffer cf f7 ac 68 d7 c2 43 b1 9f f4 ea 2c 92 5c b1 85>,
     macKeyVal: <Buffer b0 bc 70 43 44 00 95 4d ee 9f 5a f4 84 a3 c0 90 49 b1 6d 09 9e 91 5b 5d 9d 12 a1 b3 ec 5a 7c 26>,
     absValidity: 2018-03-22T02:13:16.736Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 23 aa 63 79 11 09 bc 1a>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.26:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 16 0.4375 1521598456560
connected to auth! from local port 48752
received auth hello!
{ authId: 502, nonce: <Buffer 4c dc 9e 29 de 3d e2 d4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f6 66 54 7c 6b 59 16 28>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200851,
  cipherKeyVal: <Buffer b4 a0 3e b1 f0 00 ee 33 f6 f5 d8 78 61 17 5a 93>,
  macKeyVal: <Buffer 38 65 9c ad de 6e 62 5f 52 3e 7a b0 b5 1f 2c a5 90 0d b8 67 ea dd b9 83 8e 7b 61 3e f1 01 69 6e>,
  absValidity: 2018-03-22T02:14:18.409Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50200851,
     cipherKeyVal: <Buffer b4 a0 3e b1 f0 00 ee 33 f6 f5 d8 78 61 17 5a 93>,
     macKeyVal: <Buffer 38 65 9c ad de 6e 62 5f 52 3e 7a b0 b5 1f 2c a5 90 0d b8 67 ea dd b9 83 8e 7b 61 3e f1 01 69 6e>,
     absValidity: 2018-03-22T02:14:18.409Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 2d 0a 8a 30 4c ab 2a 3e>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.26:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 17 0.4117647058823529 1521598516568
connected to auth! from local port 48972
received auth hello!
{ authId: 502, nonce: <Buffer df 72 de 3b af 72 52 c4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7c 4a 23 55 f0 cf 25 50>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200865,
  cipherKeyVal: <Buffer b6 c2 5f 27 25 a3 5b 46 a2 9b 56 7a 1b b0 a1 93>,
  macKeyVal: <Buffer 45 3e ab 99 13 f3 59 c0 50 bf eb b8 97 02 f0 9b 96 cd ac 8b ba 60 37 9f 8e e8 52 2d d0 bc 5f 4c>,
  absValidity: 2018-03-22T02:15:20.366Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50200865,
     cipherKeyVal: <Buffer b6 c2 5f 27 25 a3 5b 46 a2 9b 56 7a 1b b0 a1 93>,
     macKeyVal: <Buffer 45 3e ab 99 13 f3 59 c0 50 bf eb b8 97 02 f0 9b 96 cd ac 8b ba 60 37 9f 8e e8 52 2d d0 bc 5f 4c>,
     absValidity: 2018-03-22T02:15:20.366Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 22 3c 65 3d a7 27 63 64>
switching to HANDSHAKE_1_SENT
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:15:24 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 17 0.47058823529411764 1521598524991
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 18 0.4444444444444444 1521598576617
connected to auth! from local port 49184
received auth hello!
{ authId: 502, nonce: <Buffer be 78 fd 4d d3 e1 24 70> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer aa 28 21 5e 9f 97 7f 6d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200878,
  cipherKeyVal: <Buffer 20 53 40 54 33 5d 46 50 4c a3 af b9 cd 99 65 db>,
  macKeyVal: <Buffer 97 48 aa 2d 08 f7 db d5 fe 10 69 3b be 97 2e 5a 75 45 50 9f d7 2b 87 aa b8 3b 32 06 ec 57 d2 e2>,
  absValidity: 2018-03-22T02:16:20.349Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50200878,
     cipherKeyVal: <Buffer 20 53 40 54 33 5d 46 50 4c a3 af b9 cd 99 65 db>,
     macKeyVal: <Buffer 97 48 aa 2d 08 f7 db d5 fe 10 69 3b be 97 2e 5a 75 45 50 9f d7 2b 87 aa b8 3b 32 06 ec 57 d2 e2>,
     absValidity: 2018-03-22T02:16:20.349Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer da 7b 16 f9 cd 9b 62 6d>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:16:24 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 9 18 0.5 1521598584992
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 19 0.47368421052631576 1521598636669
connected to auth! from local port 49380
received auth hello!
{ authId: 502, nonce: <Buffer e8 e2 45 8b c3 73 5d 9b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c2 89 dd 0b 35 3e ff 09>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200889,
  cipherKeyVal: <Buffer ca bf 33 b4 62 42 24 9b 59 f0 ea b8 7c 43 5d 7f>,
  macKeyVal: <Buffer 6d f6 ca 4b f6 28 2d 1e 5a 92 51 61 89 a2 bd 8d 07 5f d4 21 6d 12 a0 e2 3d 58 86 03 33 c6 5f 8e>,
  absValidity: 2018-03-22T02:17:20.377Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50200889,
     cipherKeyVal: <Buffer ca bf 33 b4 62 42 24 9b 59 f0 ea b8 7c 43 5d 7f>,
     macKeyVal: <Buffer 6d f6 ca 4b f6 28 2d 1e 5a 92 51 61 89 a2 bd 8d 07 5f d4 21 6d 12 a0 e2 3d 58 86 03 33 c6 5f 8e>,
     absValidity: 2018-03-22T02:17:20.377Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer ec 29 22 73 6c 3b 27 91>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:17:24 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 10 19 0.5263157894736842 1521598645156
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 10 20 0.5 1521598696721
connected to auth! from local port 49582
received auth hello!
{ authId: 502, nonce: <Buffer ce 7c 60 67 7b c4 6c 35> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4b 74 61 3e a2 a3 af 5c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200902,
  cipherKeyVal: <Buffer 24 d2 0c f1 1f ac 54 8d da b6 0a 44 2e b1 41 59>,
  macKeyVal: <Buffer 26 c7 8b ba 59 1f b9 17 54 78 f9 a7 06 af 00 de 9a df 08 8b 3b ba 91 92 d6 c3 7c 32 69 f7 b2 2c>,
  absValidity: 2018-03-22T02:18:20.378Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50200902,
     cipherKeyVal: <Buffer 24 d2 0c f1 1f ac 54 8d da b6 0a 44 2e b1 41 59>,
     macKeyVal: <Buffer 26 c7 8b ba 59 1f b9 17 54 78 f9 a7 06 af 00 de 9a df 08 8b 3b ba 91 92 d6 c3 7c 32 69 f7 b2 2c>,
     absValidity: 2018-03-22T02:18:20.378Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer f4 76 7b 21 d8 58 ed cc>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:18:24 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 11 20 0.55 1521598704872
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 11 21 0.5238095238095238 1521598756767
connected to auth! from local port 49788
received auth hello!
{ authId: 502, nonce: <Buffer f1 52 5c 2a e5 3f 54 eb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 83 cb 84 91 d2 3d 7c 4a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200919,
  cipherKeyVal: <Buffer f0 91 03 96 ca 5b e3 e3 5c d8 c5 de df d4 80 d7>,
  macKeyVal: <Buffer 9b b5 d0 0a 1b 06 9a 52 5f dc b4 8a 6d f9 52 03 bd bf d9 75 ed f5 79 1f fb 4a 47 44 db df 44 c7>,
  absValidity: 2018-03-22T02:19:40.614Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50200919,
     cipherKeyVal: <Buffer f0 91 03 96 ca 5b e3 e3 5c d8 c5 de df d4 80 d7>,
     macKeyVal: <Buffer 9b b5 d0 0a 1b 06 9a 52 5f dc b4 8a 6d f9 52 03 bd bf d9 75 ed f5 79 1f fb 4a 47 44 db df 44 c7>,
     absValidity: 2018-03-22T02:19:40.614Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer cc e6 ad 2a 32 28 02 cf>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 11 22 0.5 1521598816804
connected to auth! from local port 49994
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.26:undefined
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 11 23 0.4782608695652174 1521598876814
connected to auth! from local port 50190
received auth hello!
{ authId: 502, nonce: <Buffer da 49 8b e9 80 0f b0 cd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 42 a4 0d 72 05 f7 71 94>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200942,
  cipherKeyVal: <Buffer 59 40 28 b4 e7 55 8a 3e cf 6c 1c 38 f6 ec 91 d0>,
  macKeyVal: <Buffer df a0 b7 a2 16 0c 82 03 3e 92 34 17 02 28 61 ed 1f 1e a3 e6 84 fa 85 2b 62 b3 26 86 26 00 bf 15>,
  absValidity: 2018-03-22T02:21:32.665Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50200942,
     cipherKeyVal: <Buffer 59 40 28 b4 e7 55 8a 3e cf 6c 1c 38 f6 ec 91 d0>,
     macKeyVal: <Buffer df a0 b7 a2 16 0c 82 03 3e 92 34 17 02 28 61 ed 1f 1e a3 e6 84 fa 85 2b 62 b3 26 86 26 00 bf 15>,
     absValidity: 2018-03-22T02:21:32.665Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.26:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 11 24 0.4583333333333333 1521598936857
connected to auth! from local port 50364
received auth hello!
{ authId: 502, nonce: <Buffer a3 f7 67 80 17 6e 7b 79> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: write after end
received auth hello!
{ authId: 502, nonce: <Buffer 09 28 2b 7e 3d f5 99 ce> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 22 a7 ec 11 41 d5 50 15>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200960,
  cipherKeyVal: <Buffer ff 21 cb de 24 68 3d 60 17 c8 4c e3 17 a6 df 2b>,
  macKeyVal: <Buffer 6b c8 c2 cc f6 e8 54 d2 5b 36 bc 47 b1 ba 6e 78 08 91 6a 35 b2 3f aa be c9 8b 34 7b c7 4d 44 85>,
  absValidity: 2018-03-22T02:23:00.887Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50200960,
     cipherKeyVal: <Buffer ff 21 cb de 24 68 3d 60 17 c8 4c e3 17 a6 df 2b>,
     macKeyVal: <Buffer 6b c8 c2 cc f6 e8 54 d2 5b 36 bc 47 b1 ba 6e 78 08 91 6a 35 b2 3f aa be c9 8b 34 7b c7 4d 44 85>,
     absValidity: 2018-03-22T02:23:00.887Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.26:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 11 25 0.44 1521598996865
connected to auth! from local port 50552
received auth hello!
{ authId: 502, nonce: <Buffer 9a 3c e4 28 35 d0 c1 a8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 10 7d 6b 1e a9 08 cf d9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200970,
  cipherKeyVal: <Buffer 38 41 1e 55 49 c9 35 2a 94 f8 50 6d 4e 7e b0 f9>,
  macKeyVal: <Buffer 03 4d 43 e6 36 a9 06 00 68 44 b8 92 b5 75 a9 f1 27 cf 3f 0d 16 75 44 40 5f 77 ac 38 8c 4d a5 ae>,
  absValidity: 2018-03-22T02:23:36.627Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50200970,
     cipherKeyVal: <Buffer 38 41 1e 55 49 c9 35 2a 94 f8 50 6d 4e 7e b0 f9>,
     macKeyVal: <Buffer 03 4d 43 e6 36 a9 06 00 68 44 b8 92 b5 75 a9 f1 27 cf 3f 0d 16 75 44 40 5f 77 ac 38 8c 4d a5 ae>,
     absValidity: 2018-03-22T02:23:36.627Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.26:22100
disconnected from auth
Handler: Error in secure comm - details: Connection with Auth timed out...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 11 26 0.4230769230769231 1521599056904
connected to auth! from local port 50744
received auth hello!
{ authId: 502, nonce: <Buffer d2 24 75 d2 2c 08 dd 7a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 42 77 09 e7 96 cf 6c 88>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200983,
  cipherKeyVal: <Buffer 6a ef dc 3a 54 3b f9 cd 9c 34 44 cc 20 a3 f2 38>,
  macKeyVal: <Buffer d9 b8 c1 87 83 a6 d6 01 4f 55 45 93 af 19 15 2a d1 bb ea ad e7 6e f5 12 28 21 ce 3e 68 3d 15 a7>,
  absValidity: 2018-03-22T02:24:20.671Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50200983,
     cipherKeyVal: <Buffer 6a ef dc 3a 54 3b f9 cd 9c 34 44 cc 20 a3 f2 38>,
     macKeyVal: <Buffer d9 b8 c1 87 83 a6 d6 01 4f 55 45 93 af 19 15 2a d1 bb ea ad e7 6e f5 12 28 21 ce 3e 68 3d 15 a7>,
     absValidity: 2018-03-22T02:24:20.671Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.26:22100
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 11 27 0.4074074074074074 1521599116923
connected to auth! from local port 50934
received auth hello!
{ authId: 502, nonce: <Buffer 66 9e 8b 43 62 3c d2 08> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 75 25 ce 30 cd 37 5a f1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50200998,
  cipherKeyVal: <Buffer 80 99 f2 e7 52 5a 5e 77 17 b2 ac c7 17 95 7d 2e>,
  macKeyVal: <Buffer ea e9 91 ca fa 3c ce 2d a6 70 2f 83 14 2e 38 4e a2 44 29 70 f1 0b 68 49 7e c0 2c 58 d6 77 46 a5>,
  absValidity: 2018-03-22T02:25:17.054Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50200998,
     cipherKeyVal: <Buffer 80 99 f2 e7 52 5a 5e 77 17 b2 ac c7 17 95 7d 2e>,
     macKeyVal: <Buffer ea e9 91 ca fa 3c ce 2d a6 70 2f 83 14 2e 38 4e a2 44 29 70 f1 0b 68 49 7e c0 2c 58 d6 77 46 a5>,
     absValidity: 2018-03-22T02:25:17.054Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.26:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 11 28 0.39285714285714285 1521599176983
connected to auth! from local port 51116
received auth hello!
{ authId: 502, nonce: <Buffer c6 b6 d8 27 82 f5 9a ed> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 31 ff 46 1a fc 07 c4 66>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201013,
  cipherKeyVal: <Buffer d3 39 f9 87 ee d6 ec f8 40 13 c3 f3 f1 7e f6 88>,
  macKeyVal: <Buffer dd 2b 7e 17 ae d8 63 0b 6a 23 d3 63 04 16 5b b3 b7 57 a2 7d 6f c2 9e 79 fd bf 9b c6 88 bf 7f 83>,
  absValidity: 2018-03-22T02:26:17.177Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50201013,
     cipherKeyVal: <Buffer d3 39 f9 87 ee d6 ec f8 40 13 c3 f3 f1 7e f6 88>,
     macKeyVal: <Buffer dd 2b 7e 17 ae d8 63 0b 6a 23 d3 63 04 16 5b b3 b7 57 a2 7d 6f c2 9e 79 fd bf 9b c6 88 bf 7f 83>,
     absValidity: 2018-03-22T02:26:17.177Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.26:22100
disconnected from auth
