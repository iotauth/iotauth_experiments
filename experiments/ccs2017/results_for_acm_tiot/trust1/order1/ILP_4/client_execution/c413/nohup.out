changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c413.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c413',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 78 39 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521597520081
connected to auth! from local port 33444
received auth hello!
{ authId: 402, nonce: <Buffer 95 b6 35 8b f6 cf 76 f8> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer cb b2 4c 07 fa b3 ce a9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 16 29 5c d1 1a d6 fa f2 be d1 a9 d4 39 fd 3e 45>,
  macKeyVal: <Buffer 19 b1 46 4e a9 09 32 c6 41 7e 5c 7d 76 d8 70 ee 36 ce de ea a8 06 ea de 18 d3 87 c7 79 03 c7 e9>,
  absValidity: 2018-03-21T02:58:41.812Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200312,
  cipherKeyVal: <Buffer 9f 92 2b af 28 d0 11 34 c2 28 18 1b 9c b1 e6 05>,
  macKeyVal: <Buffer 6c 58 15 71 b5 b6 3d 69 9b 03 ef 60 11 cb ba c8 0c 73 ea 4f e7 59 ee f3 84 87 90 c3 60 ec 8b 40>,
  absValidity: 2018-03-22T01:58:41.812Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.16',
  serverPort: 22100,
  sessionKey: 
   { id: 40200312,
     cipherKeyVal: <Buffer 9f 92 2b af 28 d0 11 34 c2 28 18 1b 9c b1 e6 05>,
     macKeyVal: <Buffer 6c 58 15 71 b5 b6 3d 69 9b 03 ef 60 11 cb ba c8 0c 73 ea 4f e7 59 ee f3 84 87 90 c3 60 ec 8b 40>,
     absValidity: 2018-03-22T01:58:41.812Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 72 79 d2 c3 da 11 29 bc>
switching to HANDSHAKE_1_SENT
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 01:58:43 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521597524425
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521597580134
connected to auth! from local port 33630
received auth hello!
{ authId: 402, nonce: <Buffer c8 72 22 b8 ca 84 60 ab> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b1 f3 34 b0 a9 ad cb 95>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200319,
  cipherKeyVal: <Buffer 5f d2 20 03 b4 18 2e 6e a0 bb 35 77 75 d1 b7 44>,
  macKeyVal: <Buffer 7f 27 8f 15 ad fa 00 7c fd 72 52 a2 28 16 30 c8 04 ff 50 fa 95 f7 f7 02 c1 20 e2 07 fa 81 d5 94>,
  absValidity: 2018-03-22T01:59:41.851Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.16',
  serverPort: 22100,
  sessionKey: 
   { id: 40200319,
     cipherKeyVal: <Buffer 5f d2 20 03 b4 18 2e 6e a0 bb 35 77 75 d1 b7 44>,
     macKeyVal: <Buffer 7f 27 8f 15 ad fa 00 7c fd 72 52 a2 28 16 30 c8 04 ff 50 fa 95 f7 f7 02 c1 20 e2 07 fa 81 d5 94>,
     absValidity: 2018-03-22T01:59:41.851Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 9e 4c 64 3c 18 3f 79 ed>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 01:59:43 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521597584512
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521597640190
connected to auth! from local port 33902
received auth hello!
{ authId: 402, nonce: <Buffer 79 9c 3b cd 3a 58 bf 4e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b3 f2 a5 d1 ca 4a 68 b3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200326,
  cipherKeyVal: <Buffer aa 98 df 3b 96 5b f8 7f 00 1c 2c a9 0a 96 b0 9e>,
  macKeyVal: <Buffer 6a fc f2 6f a3 6b fb 3b 90 a1 88 52 03 d8 80 bc ae 7c 9a 84 e1 e6 bb c5 1b c1 1c 61 ea 2c 92 e2>,
  absValidity: 2018-03-22T02:00:41.894Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.16',
  serverPort: 22100,
  sessionKey: 
   { id: 40200326,
     cipherKeyVal: <Buffer aa 98 df 3b 96 5b f8 7f 00 1c 2c a9 0a 96 b0 9e>,
     macKeyVal: <Buffer 6a fc f2 6f a3 6b fb 3b 90 a1 88 52 03 d8 80 bc ae 7c 9a 84 e1 e6 bb c5 1b c1 1c 61 ea 2c 92 e2>,
     absValidity: 2018-03-22T02:00:41.894Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 4d f0 11 8c 05 f2 71 af>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:00:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521597644390
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521597700222
connected to auth! from local port 34172
received auth hello!
{ authId: 402, nonce: <Buffer 71 38 fe 03 cc e2 56 84> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 33 25 86 23 bf 65 a8 c7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200333,
  cipherKeyVal: <Buffer 32 29 11 07 fd 32 ca 99 40 1a 2b 72 49 e8 0c c2>,
  macKeyVal: <Buffer c6 fd c8 81 81 65 0f 50 68 49 ed f0 9e 08 af 84 3b 90 91 99 fa d8 ed 18 e8 ce 97 80 45 45 9c 8c>,
  absValidity: 2018-03-22T02:01:41.985Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.16',
  serverPort: 22100,
  sessionKey: 
   { id: 40200333,
     cipherKeyVal: <Buffer 32 29 11 07 fd 32 ca 99 40 1a 2b 72 49 e8 0c c2>,
     macKeyVal: <Buffer c6 fd c8 81 81 65 0f 50 68 49 ed f0 9e 08 af 84 3b 90 91 99 fa d8 ed 18 e8 ce 97 80 45 45 9c 8c>,
     absValidity: 2018-03-22T02:01:41.985Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 30 03 bc 2e 95 b7 f9 b1>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:01:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521597704700
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521597760277
connected to auth! from local port 34442
received auth hello!
{ authId: 402, nonce: <Buffer af f2 cc e6 ef c2 0b 27> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7e f7 d0 a8 ab 63 dd 8e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200340,
  cipherKeyVal: <Buffer 7b 25 67 1d 4c 5e 41 2b 54 c1 95 0d 0c 02 e5 bd>,
  macKeyVal: <Buffer 1e b2 f2 b4 1a 98 4b b3 11 1f b5 2f a5 92 34 0d 8e 2a f9 b9 e1 bd 68 c0 a8 23 55 19 8c 0f 35 a4>,
  absValidity: 2018-03-22T02:02:42.009Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.16',
  serverPort: 22100,
  sessionKey: 
   { id: 40200340,
     cipherKeyVal: <Buffer 7b 25 67 1d 4c 5e 41 2b 54 c1 95 0d 0c 02 e5 bd>,
     macKeyVal: <Buffer 1e b2 f2 b4 1a 98 4b b3 11 1f b5 2f a5 92 34 0d 8e 2a f9 b9 e1 bd 68 c0 a8 23 55 19 8c 0f 35 a4>,
     absValidity: 2018-03-22T02:02:42.009Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 6b 6f e1 ad 77 fb ea fb>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:02:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521597764588
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521597820333
connected to auth! from local port 34712
received auth hello!
{ authId: 402, nonce: <Buffer fd 04 1e 08 06 3f c2 39> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 27 ac 62 00 52 ce 99 52>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200347,
  cipherKeyVal: <Buffer 57 8b ae 00 7c 1c 14 19 99 12 9d d0 a3 02 95 c5>,
  macKeyVal: <Buffer 7e ca 64 56 65 1e a0 94 7e 3f 4f 6b c4 23 bf 95 c2 c9 73 be 6d fc 1f d5 16 69 e2 e4 cc f6 35 3c>,
  absValidity: 2018-03-22T02:03:42.059Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.16',
  serverPort: 22100,
  sessionKey: 
   { id: 40200347,
     cipherKeyVal: <Buffer 57 8b ae 00 7c 1c 14 19 99 12 9d d0 a3 02 95 c5>,
     macKeyVal: <Buffer 7e ca 64 56 65 1e a0 94 7e 3f 4f 6b c4 23 bf 95 c2 c9 73 be 6d fc 1f d5 16 69 e2 e4 cc f6 35 3c>,
     absValidity: 2018-03-22T02:03:42.059Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 9d e4 0b 84 c1 1f 8e 8e>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:03:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521597824751
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521597880389
connected to auth! from local port 34982
received auth hello!
{ authId: 402, nonce: <Buffer 66 93 62 69 cb 17 cb 25> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 46 55 32 40 ee a4 3c 41>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200354,
  cipherKeyVal: <Buffer 15 68 4d ab b0 52 2e fb 6c cd f5 ec 14 cb f9 be>,
  macKeyVal: <Buffer 0e 95 0a 6d c9 6b 34 ee 37 9a c2 b8 75 69 46 ce e6 0a 60 7d 90 8b 20 fc bd 2b df 0a 26 cd 24 6f>,
  absValidity: 2018-03-22T02:04:42.166Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.16',
  serverPort: 22100,
  sessionKey: 
   { id: 40200354,
     cipherKeyVal: <Buffer 15 68 4d ab b0 52 2e fb 6c cd f5 ec 14 cb f9 be>,
     macKeyVal: <Buffer 0e 95 0a 6d c9 6b 34 ee 37 9a c2 b8 75 69 46 ce e6 0a 60 7d 90 8b 20 fc bd 2b df 0a 26 cd 24 6f>,
     absValidity: 2018-03-22T02:04:42.166Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer d9 f4 86 4d 3f d6 3d 13>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:04:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521597884694
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521597940446
connected to auth! from local port 35252
Handler: Error in secure comm - details: Disconnected from auth before getting session key response
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 9 0.7777777777777778 1521598000456
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 10 0.7 1521598060465
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 33632
received auth hello!
{ authId: 503, nonce: <Buffer 60 b6 b7 3d b0 45 36 ad> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth503',
     commonName: '10.0.1.6' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth402',
     commonName: '10.0.0.2' },
  serial: '01624645F814',
  notBefore: 2018-03-21T01:55:13.000Z,
  notAfter: 2018-03-22T01:56:53.000Z,
  subjectHash: '5542437f',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'F1:D7:C3:86:73:CE:D8:1D:E2:FF:04:33:0C:68:F2:0B:78:08:EB:85',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'BEF8F49475DE2A7247021F450606CD5891A65AED3D5B5352F639856656DABAB71FBB39B48DC0B2D02F476ECDDA817725D9247F8343EFA59CE3C8A1478669A0BBC7331BFA8CA47D0D8AF82267CED06E82D935EE41A36521595DE2E9C9282C6C4EE18E9EF871EB69AFA64DAF8AF9C918FF6EBDCE83735918F691FBA5D857D30199CC98C65973C1020FC538746EF90A2737A41391E8FFB49EFEDDB1B9899BB362DE128DF9797D19395ABA6F755427F4D2533E459F827BEFAB7F66A40D2E20A5261297BEA33E1532F5BC6F4F7AB69CBFFC885108509A63CB8EBD0F0FB315C71A59CD5995A1BE71E5570E2D3AA54A128F129827DA7DE4AAB6B1B12275D61933AA6811',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.6' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 503,
  host: '10.0.1.6',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJGRfgUMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDIxETAPBgNVBAMMCDEwLjAuMC4yMB4XDTE4MDMy\nMTAxNTUxM1oXDTE4MDMyMjAxNTY1M1owYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMzERMA8GA1UEAwwIMTAuMC4xLjYwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQC++PSUdd4qckcCH0UGBs1YkaZa7T1bU1L2OYVmVtq6tx+7ObSN\nwLLQL0duzdqBdyXZJH+DQ++lnOPIoUeGaaC7xzMb+oykfQ2K+CJnztBugtk17kGj\nZSFZXeLpySgsbE7hjp74cetpr6ZNr4r5yRj/br3Og3NZGPaR+6XYV9MBmcyYxllz\nwQIPxTh0bvkKJzekE5Ho/7Se/t2xuYmbs2LeEo35eX0ZOVq6b3VUJ/TSUz5Fn4J7\n76t/ZqQNLiClJhKXvqM+FTL1vG9Peracv/yIUQhQmmPLjr0PD7MVxxpZzVmVob5x\n5VcOLTqlShKPEpgn2n3kqraxsSJ11hkzqmgRAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQYwDQYJKoZIhvcNAQELBQADggEBAFJmAAUJ7ulHPHIapkKNUvjUj801jbm3\n6IJLjZCw02Gw/vi7YtYRVy+uF/hOaEyGwH7oy5jeYG5L+5kkwsLhUIPa0NTJ0Rg5\nS7KQk7By8Ek3vVpxeZrR5s8LvuMdRW1jZZTTTqhypu3cGEox/6vdYadA3UgSWGXK\nF3BSDBjA1N8nfeBonPyujsT3h0/ZOW59W+N0MzW65+20VVQzyzZO9xSQbAjUyxLl\nSOj3KHWFkgT7Slze43X5NFAVVgOoDVOlS8/jrDGxdKtymLz4NmCE6OHw/jSWsVwk\nvV1+FNH3nwo+vhGS+siwwwRgsd9a2qpeTs6x/4xwGxsomtgY8Vj+trQ=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 11 0.6363636363636364 1521598120473
connected to auth! from local port 33856
received auth hello!
{ authId: 503, nonce: <Buffer 8d ec 49 a4 84 fe 70 56> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer af 1f b6 a2 f4 62 50 f1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer f3 4a df 05 ec ed f7 7a be 44 c6 72 fb 0b c2 c4>,
  macKeyVal: <Buffer 03 ec 51 10 8a 65 c2 6c 85 8f 1e 4c c1 b0 67 31 e2 b8 f3 c1 71 60 2a 25 18 95 04 21 a2 88 08 01>,
  absValidity: 2018-03-21T03:08:40.712Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300555,
  cipherKeyVal: <Buffer a6 9d bc 34 9a 23 59 29 07 d8 38 12 51 7a 7c be>,
  macKeyVal: <Buffer 16 c7 2c 86 24 a1 ab 0b ea f7 a9 9a 91 dd b0 ef 1c 1b d8 82 1a b6 ab dc a8 41 76 8f 0b 52 ab e8>,
  absValidity: 2018-03-22T02:08:40.712Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.16',
  serverPort: 22100,
  sessionKey: 
   { id: 50300555,
     cipherKeyVal: <Buffer a6 9d bc 34 9a 23 59 29 07 d8 38 12 51 7a 7c be>,
     macKeyVal: <Buffer 16 c7 2c 86 24 a1 ab 0b ea f7 a9 9a 91 dd b0 ef 1c 1b d8 82 1a b6 ab dc a8 41 76 8f 0b 52 ab e8>,
     absValidity: 2018-03-22T02:08:40.712Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer f9 81 7b 2f 91 3f 99 a7>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.16:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 12 0.5833333333333334 1521598180483
connected to auth! from local port 34104
received auth hello!
{ authId: 503, nonce: <Buffer 26 e7 ce 85 8f fd d2 98> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a4 ef 5f 4f 14 35 74 1b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300562,
  cipherKeyVal: <Buffer 4e 2e 92 34 b9 2c 5c fc db 14 55 2e 75 9b 4d e7>,
  macKeyVal: <Buffer d0 9e 31 1c 05 01 62 6c 28 db b0 4b 78 8a 2b c8 29 f9 a7 37 b1 3e 7c 95 fd b2 01 54 c2 b9 97 5a>,
  absValidity: 2018-03-22T02:09:40.755Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.16',
  serverPort: 22100,
  sessionKey: 
   { id: 50300562,
     cipherKeyVal: <Buffer 4e 2e 92 34 b9 2c 5c fc db 14 55 2e 75 9b 4d e7>,
     macKeyVal: <Buffer d0 9e 31 1c 05 01 62 6c 28 db b0 4b 78 8a 2b c8 29 f9 a7 37 b1 3e 7c 95 fd b2 01 54 c2 b9 97 5a>,
     absValidity: 2018-03-22T02:09:40.755Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 77 b0 a6 65 8e 51 36 f8>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.16:undefined
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 13 0.5384615384615384 1521598240494
connected to auth! from local port 34344
received auth hello!
{ authId: 503, nonce: <Buffer 1e 02 86 47 dc 40 8b 9c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3f 33 2a aa 22 15 a2 7a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300569,
  cipherKeyVal: <Buffer e3 37 a4 ac d3 34 ab 7f 1f 18 bf e3 77 37 a1 dd>,
  macKeyVal: <Buffer d1 c4 d7 5f 1a 58 ed 1e a0 71 8e de 8b bb aa c9 7c 00 06 65 3a e8 b0 d8 07 f4 4f f0 04 9e 9c 4b>,
  absValidity: 2018-03-22T02:10:40.673Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.16',
  serverPort: 22100,
  sessionKey: 
   { id: 50300569,
     cipherKeyVal: <Buffer e3 37 a4 ac d3 34 ab 7f 1f 18 bf e3 77 37 a1 dd>,
     macKeyVal: <Buffer d1 c4 d7 5f 1a 58 ed 1e a0 71 8e de 8b bb aa c9 7c 00 06 65 3a e8 b0 d8 07 f4 4f f0 04 9e 9c 4b>,
     absValidity: 2018-03-22T02:10:40.673Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.16:22100
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 14 0.5 1521598300554
connected to auth! from local port 34564
received auth hello!
{ authId: 503, nonce: <Buffer 24 d0 9c 46 2b 35 52 2d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 07 99 d1 b4 b8 f3 30 be>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300577,
  cipherKeyVal: <Buffer d5 f3 06 92 55 a4 70 2f 37 97 f8 ca 2b a8 28 44>,
  macKeyVal: <Buffer ad 29 b3 5c 11 68 24 87 df 84 50 24 6b 30 88 de 88 06 4f ca c3 63 48 c1 c9 c5 a3 a6 55 dc 0b 66>,
  absValidity: 2018-03-22T02:11:40.698Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.16',
  serverPort: 22100,
  sessionKey: 
   { id: 50300577,
     cipherKeyVal: <Buffer d5 f3 06 92 55 a4 70 2f 37 97 f8 ca 2b a8 28 44>,
     macKeyVal: <Buffer ad 29 b3 5c 11 68 24 87 df 84 50 24 6b 30 88 de 88 06 4f ca c3 63 48 c1 c9 c5 a3 a6 55 dc 0b 66>,
     absValidity: 2018-03-22T02:11:40.698Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.16:22100
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 15 0.4666666666666667 1521598360589
connected to auth! from local port 34796
received auth hello!
{ authId: 503, nonce: <Buffer 6d 1f bd b5 7f 5c 1d 84> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5f 52 00 7e 19 ee b6 2e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300585,
  cipherKeyVal: <Buffer 8c db d4 c5 30 4d 7b 12 41 f1 3f 99 23 6d 1e 8d>,
  macKeyVal: <Buffer 11 c4 f8 52 43 f3 93 d5 b1 32 b6 1c 60 0c 8c bd 1a 9f 27 ce 07 04 1b b6 1f fc f2 d0 fc 6a b1 dd>,
  absValidity: 2018-03-22T02:12:40.708Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.16',
  serverPort: 22100,
  sessionKey: 
   { id: 50300585,
     cipherKeyVal: <Buffer 8c db d4 c5 30 4d 7b 12 41 f1 3f 99 23 6d 1e 8d>,
     macKeyVal: <Buffer 11 c4 f8 52 43 f3 93 d5 b1 32 b6 1c 60 0c 8c bd 1a 9f 27 ce 07 04 1b b6 1f fc f2 d0 fc 6a b1 dd>,
     absValidity: 2018-03-22T02:12:40.708Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.16:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 16 0.4375 1521598420610
connected to auth! from local port 35020
received auth hello!
{ authId: 503, nonce: <Buffer 0c 0c 59 94 ab ea 17 f5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9a 51 a4 71 dc 04 1d 62>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300593,
  cipherKeyVal: <Buffer 29 c0 dd 0f 29 2d 52 51 59 78 e1 c2 af 22 08 e7>,
  macKeyVal: <Buffer 79 c2 e9 23 53 61 fc c7 df 6c df ae 5e 34 dc f4 dc 4b b9 e2 fc 18 ea 7b 09 c2 e6 96 2c 82 68 72>,
  absValidity: 2018-03-22T02:13:40.844Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.16',
  serverPort: 22100,
  sessionKey: 
   { id: 50300593,
     cipherKeyVal: <Buffer 29 c0 dd 0f 29 2d 52 51 59 78 e1 c2 af 22 08 e7>,
     macKeyVal: <Buffer 79 c2 e9 23 53 61 fc c7 df 6c df ae 5e 34 dc f4 dc 4b b9 e2 fc 18 ea 7b 09 c2 e6 96 2c 82 68 72>,
     absValidity: 2018-03-22T02:13:40.844Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.16:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 17 0.4117647058823529 1521598480669
connected to auth! from local port 35238
received auth hello!
{ authId: 503, nonce: <Buffer 58 ed 32 66 46 9e 27 b6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 91 db ea 6b cc 36 0e c5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300601,
  cipherKeyVal: <Buffer 6d 45 d4 e4 6d 66 1b 88 4c 0a 7a f6 ac a9 c7 ac>,
  macKeyVal: <Buffer c4 27 cd 6c 88 22 0d 25 74 88 4d f9 e1 dc f8 a2 e0 7d 6f 58 fd 5a ea 74 ae 32 ca ec d7 5a 68 32>,
  absValidity: 2018-03-22T02:14:40.826Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.16',
  serverPort: 22100,
  sessionKey: 
   { id: 50300601,
     cipherKeyVal: <Buffer 6d 45 d4 e4 6d 66 1b 88 4c 0a 7a f6 ac a9 c7 ac>,
     macKeyVal: <Buffer c4 27 cd 6c 88 22 0d 25 74 88 4d f9 e1 dc f8 a2 e0 7d 6f 58 fd 5a ea 74 ae 32 ca ec d7 5a 68 32>,
     absValidity: 2018-03-22T02:14:40.826Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.16:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 18 0.3888888888888889 1521598540694
connected to auth! from local port 35448
received auth hello!
{ authId: 503, nonce: <Buffer bd 57 c7 72 f7 8f 55 f3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0c 2b b1 af 7e ab b2 71>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300609,
  cipherKeyVal: <Buffer ba 86 e0 18 aa c0 1a 38 f4 41 46 89 4b f2 d4 d7>,
  macKeyVal: <Buffer 6e 68 f9 03 96 c3 98 8e f6 aa 58 59 77 92 ff ad 2d cf 5e 03 bf fb 84 2a b9 30 ff 6d 4f 93 a1 ed>,
  absValidity: 2018-03-22T02:15:40.829Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.16',
  serverPort: 22100,
  sessionKey: 
   { id: 50300609,
     cipherKeyVal: <Buffer ba 86 e0 18 aa c0 1a 38 f4 41 46 89 4b f2 d4 d7>,
     macKeyVal: <Buffer 6e 68 f9 03 96 c3 98 8e f6 aa 58 59 77 92 ff ad 2d cf 5e 03 bf fb 84 2a b9 30 ff 6d 4f 93 a1 ed>,
     absValidity: 2018-03-22T02:15:40.829Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.16:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 19 0.3684210526315789 1521598600754
connected to auth! from local port 35654
received auth hello!
{ authId: 503, nonce: <Buffer 53 07 69 64 77 78 7a 17> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a7 04 6c 2a ed a6 85 00>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300617,
  cipherKeyVal: <Buffer d9 40 21 9e 4d c2 57 40 dc 78 47 1f fa 62 90 8d>,
  macKeyVal: <Buffer 9d ce d4 12 73 ec da a6 0a ee ae 28 0d f8 19 e8 25 69 8e 0d a4 42 0f 10 ce 31 e2 73 df 67 b9 05>,
  absValidity: 2018-03-22T02:16:40.913Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.16',
  serverPort: 22100,
  sessionKey: 
   { id: 50300617,
     cipherKeyVal: <Buffer d9 40 21 9e 4d c2 57 40 dc 78 47 1f fa 62 90 8d>,
     macKeyVal: <Buffer 9d ce d4 12 73 ec da a6 0a ee ae 28 0d f8 19 e8 25 69 8e 0d a4 42 0f 10 ce 31 e2 73 df 67 b9 05>,
     absValidity: 2018-03-22T02:16:40.913Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.16:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 20 0.35 1521598660815
connected to auth! from local port 35852
received auth hello!
{ authId: 503, nonce: <Buffer b8 eb 61 70 bc 4f 95 9a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e4 fd 4f 1f 8b aa 79 b0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300625,
  cipherKeyVal: <Buffer 1c f2 9b 35 6f 82 92 71 5f 44 99 fb 52 e5 d9 24>,
  macKeyVal: <Buffer 20 aa be b6 d9 9c 52 20 79 a6 ca 68 c1 65 f7 81 6e 24 1a 3f dd e2 eb 68 8c 2c e8 c5 e9 37 b6 92>,
  absValidity: 2018-03-22T02:17:40.962Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.16',
  serverPort: 22100,
  sessionKey: 
   { id: 50300625,
     cipherKeyVal: <Buffer 1c f2 9b 35 6f 82 92 71 5f 44 99 fb 52 e5 d9 24>,
     macKeyVal: <Buffer 20 aa be b6 d9 9c 52 20 79 a6 ca 68 c1 65 f7 81 6e 24 1a 3f dd e2 eb 68 8c 2c e8 c5 e9 37 b6 92>,
     absValidity: 2018-03-22T02:17:40.962Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.16:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 21 0.3333333333333333 1521598720867
connected to auth! from local port 36058
received auth hello!
{ authId: 503, nonce: <Buffer 18 e9 76 12 f2 7a c9 60> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c8 2f 8f e6 e3 da 68 ea>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300633,
  cipherKeyVal: <Buffer 32 f5 f4 2e f5 0f 13 07 d8 0a 90 ba 9d 18 9d fa>,
  macKeyVal: <Buffer 7d e6 3c 42 eb d5 1a bb 01 c9 54 0d 15 fa 2c a2 99 b2 4f 1f 53 50 9d ca 3b 12 b3 18 cd b1 48 0b>,
  absValidity: 2018-03-22T02:18:41.116Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.16',
  serverPort: 22100,
  sessionKey: 
   { id: 50300633,
     cipherKeyVal: <Buffer 32 f5 f4 2e f5 0f 13 07 d8 0a 90 ba 9d 18 9d fa>,
     macKeyVal: <Buffer 7d e6 3c 42 eb d5 1a bb 01 c9 54 0d 15 fa 2c a2 99 b2 4f 1f 53 50 9d ca 3b 12 b3 18 cd b1 48 0b>,
     absValidity: 2018-03-22T02:18:41.116Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.16:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 22 0.3181818181818182 1521598780925
connected to auth! from local port 36264
received auth hello!
{ authId: 503, nonce: <Buffer 28 36 37 a1 5f fb ca 73> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3a ae 31 b3 f6 f2 d1 ba>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300641,
  cipherKeyVal: <Buffer 17 b8 61 d4 bb 61 32 bf 28 83 c2 54 f6 92 d5 a9>,
  macKeyVal: <Buffer d5 19 17 97 63 51 15 44 e4 e5 59 24 97 c8 d3 4e e6 19 70 a1 d1 81 b9 1d 95 78 c6 3f 88 00 e8 52>,
  absValidity: 2018-03-22T02:19:41.130Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.16',
  serverPort: 22100,
  sessionKey: 
   { id: 50300641,
     cipherKeyVal: <Buffer 17 b8 61 d4 bb 61 32 bf 28 83 c2 54 f6 92 d5 a9>,
     macKeyVal: <Buffer d5 19 17 97 63 51 15 44 e4 e5 59 24 97 c8 d3 4e e6 19 70 a1 d1 81 b9 1d 95 78 c6 3f 88 00 e8 52>,
     absValidity: 2018-03-22T02:19:41.130Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.16:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 23 0.30434782608695654 1521598840985
connected to auth! from local port 36466
received auth hello!
{ authId: 503, nonce: <Buffer 29 23 88 30 eb ad 41 f8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4c cd 3d ee 3c ac 2f 93>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300649,
  cipherKeyVal: <Buffer fd 21 1f 44 3c de 44 86 ee ae 00 5c 19 10 0e 7f>,
  macKeyVal: <Buffer 90 77 aa 94 40 b1 cf 29 77 f8 f4 75 36 90 69 b1 be 3b 7b 0a 37 5f ec e3 03 2b 3a 3c e0 62 06 6d>,
  absValidity: 2018-03-22T02:20:41.131Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.16',
  serverPort: 22100,
  sessionKey: 
   { id: 50300649,
     cipherKeyVal: <Buffer fd 21 1f 44 3c de 44 86 ee ae 00 5c 19 10 0e 7f>,
     macKeyVal: <Buffer 90 77 aa 94 40 b1 cf 29 77 f8 f4 75 36 90 69 b1 be 3b 7b 0a 37 5f ec e3 03 2b 3a 3c e0 62 06 6d>,
     absValidity: 2018-03-22T02:20:41.131Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.16:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 24 0.2916666666666667 1521598901046
connected to auth! from local port 36656
received auth hello!
{ authId: 503, nonce: <Buffer b2 b7 3a 64 56 14 7a fe> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 04 e1 b2 96 4f 9a 5d a4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300657,
  cipherKeyVal: <Buffer 9a a1 74 da 3c bc 6e 23 35 91 69 60 2e 6d 4e 62>,
  macKeyVal: <Buffer e3 01 23 20 cf 5a fd f7 c6 31 c8 cb 47 8b bb 26 c5 50 23 bf 73 f7 d3 dc b8 f5 e8 d7 f1 22 48 e5>,
  absValidity: 2018-03-22T02:21:41.185Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.16',
  serverPort: 22100,
  sessionKey: 
   { id: 50300657,
     cipherKeyVal: <Buffer 9a a1 74 da 3c bc 6e 23 35 91 69 60 2e 6d 4e 62>,
     macKeyVal: <Buffer e3 01 23 20 cf 5a fd f7 c6 31 c8 cb 47 8b bb 26 c5 50 23 bf 73 f7 d3 dc b8 f5 e8 d7 f1 22 48 e5>,
     absValidity: 2018-03-22T02:21:41.185Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.16:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 25 0.28 1521598961105
connected to auth! from local port 36832
received auth hello!
{ authId: 503, nonce: <Buffer e2 95 ab 2a 37 f9 79 35> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 44 d1 c4 36 18 34 a3 b4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300665,
  cipherKeyVal: <Buffer 43 35 f8 03 e5 fb 80 75 88 b0 76 94 27 44 1d 16>,
  macKeyVal: <Buffer 35 ca 34 64 1d 49 4d a4 13 58 df 4c 64 b6 d5 cf b7 81 62 a2 3a 36 27 c5 d2 08 4b ea 37 ab c1 e2>,
  absValidity: 2018-03-22T02:22:41.229Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.16',
  serverPort: 22100,
  sessionKey: 
   { id: 50300665,
     cipherKeyVal: <Buffer 43 35 f8 03 e5 fb 80 75 88 b0 76 94 27 44 1d 16>,
     macKeyVal: <Buffer 35 ca 34 64 1d 49 4d a4 13 58 df 4c 64 b6 d5 cf b7 81 62 a2 3a 36 27 c5 d2 08 4b ea 37 ab c1 e2>,
     absValidity: 2018-03-22T02:22:41.229Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.16:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 26 0.2692307692307692 1521599021166
connected to auth! from local port 37018
received auth hello!
{ authId: 503, nonce: <Buffer 0b b3 2f c6 db 4b ce e0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bf 4a bd 13 36 4d 0d ea>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300673,
  cipherKeyVal: <Buffer 6c b2 b2 7b 9f 9a fe 10 d3 cb 13 30 59 1a a3 95>,
  macKeyVal: <Buffer 4d 5b 69 70 e3 95 32 45 01 f9 fc 19 15 e9 4e 6d 4b 70 1f 4c 93 61 b6 44 59 9b 2f ee 9a 5c 05 2f>,
  absValidity: 2018-03-22T02:23:41.293Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.16',
  serverPort: 22100,
  sessionKey: 
   { id: 50300673,
     cipherKeyVal: <Buffer 6c b2 b2 7b 9f 9a fe 10 d3 cb 13 30 59 1a a3 95>,
     macKeyVal: <Buffer 4d 5b 69 70 e3 95 32 45 01 f9 fc 19 15 e9 4e 6d 4b 70 1f 4c 93 61 b6 44 59 9b 2f ee 9a 5c 05 2f>,
     absValidity: 2018-03-22T02:23:41.293Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.16:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 27 0.25925925925925924 1521599081225
connected to auth! from local port 37214
received auth hello!
{ authId: 503, nonce: <Buffer 65 27 c6 52 9a 3d e6 28> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 28 48 8c aa 31 f3 a4 53>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300681,
  cipherKeyVal: <Buffer 49 d3 a8 9f 48 d7 ef fc d3 8b 2e 65 53 08 a0 79>,
  macKeyVal: <Buffer 2e 2a cb 63 7f 21 ac 78 5a 56 d1 94 e1 c5 5f 89 f5 56 59 8a 90 43 a7 de 7e 9d e1 33 4e 00 2a 43>,
  absValidity: 2018-03-22T02:24:41.379Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.16',
  serverPort: 22100,
  sessionKey: 
   { id: 50300681,
     cipherKeyVal: <Buffer 49 d3 a8 9f 48 d7 ef fc d3 8b 2e 65 53 08 a0 79>,
     macKeyVal: <Buffer 2e 2a cb 63 7f 21 ac 78 5a 56 d1 94 e1 c5 5f 89 f5 56 59 8a 90 43 a7 de 7e 9d e1 33 4e 00 2a 43>,
     absValidity: 2018-03-22T02:24:41.379Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.16:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 28 0.25 1521599141226
connected to auth! from local port 37406
received auth hello!
{ authId: 503, nonce: <Buffer 77 17 b2 0f 57 05 13 07> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e9 5c d8 75 a3 22 81 42>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300689,
  cipherKeyVal: <Buffer 0b 68 f5 04 06 cb d9 2e 13 9e d3 28 13 17 82 1e>,
  macKeyVal: <Buffer b3 08 7f e6 9f fe 6d 35 e8 6c d4 09 da 93 0b a2 b3 98 bb 9f d1 1c 68 26 c7 03 83 d1 28 ac e2 97>,
  absValidity: 2018-03-22T02:25:41.430Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.16',
  serverPort: 22100,
  sessionKey: 
   { id: 50300689,
     cipherKeyVal: <Buffer 0b 68 f5 04 06 cb d9 2e 13 9e d3 28 13 17 82 1e>,
     macKeyVal: <Buffer b3 08 7f e6 9f fe 6d 35 e8 6c d4 09 da 93 0b a2 b3 98 bb 9f d1 1c 68 26 c7 03 83 d1 28 ac e2 97>,
     absValidity: 2018-03-22T02:25:41.430Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.16:22100
disconnected from auth
