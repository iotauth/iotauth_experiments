changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s518.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's518',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 51 49 42 41 41 4b 43 41 51 45 41 76 77 ... > }
Handler: listening on port 22100
s518:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400116
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51522
received auth hello!
{ authId: 504, nonce: <Buffer be 7e b0 31 2a 96 37 5e> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 6e db 3d 62 56 73 76 0a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 7a d0 c2 ca 94 a2 ee 72 14 7b 22 b0 42 e4 25 56>,
  macKeyVal: <Buffer 7e 56 3f 2c 66 4f cf de a5 fa 0f 43 f8 45 41 56 c6 64 42 93 50 1c ea 05 3d d3 0e 4e 26 07 0a 3b>,
  absValidity: 2018-03-21T03:00:18.705Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8a 5f be 81 f4 ed a5 7f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8a 5f be 81 f4 ed a5 7f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.84:60864',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400118
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51550
received auth hello!
{ authId: 504, nonce: <Buffer 92 73 d5 ec ae 30 d4 f5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 52 d8 73 01 d0 a4 bc 77>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9a 37 6e e7 97 33 45 78>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 9a 37 6e e7 97 33 45 78> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.85:48116',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400122
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51792
received auth hello!
{ authId: 504, nonce: <Buffer ec f8 2c 68 8b ec b1 b7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 29 97 78 10 cb f6 aa 15>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bd 2c 71 78 95 7f 35 d8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bd 2c 71 78 95 7f 35 d8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.84:32902',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400124
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51820
received auth hello!
{ authId: 504, nonce: <Buffer f4 da 8b 94 d2 ce 33 da> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 96 f0 2a e2 1b 4d 7d 5b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 45 b8 b1 d6 58 13 a1 4a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 45 b8 b1 d6 58 13 a1 4a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.85:48386',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400128
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52062
received auth hello!
{ authId: 504, nonce: <Buffer ca f0 44 c6 02 91 7f 15> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a8 11 7e da 76 0d e9 c7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7a 2d 74 0e f5 77 47 b8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 7a 2d 74 0e f5 77 47 b8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.84:33170',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400130
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52090
received auth hello!
{ authId: 504, nonce: <Buffer bb d9 10 80 38 4a cd dd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5f 7f be b9 f7 bd ba 7e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 37 ee 79 35 61 75 4a 10>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 37 ee 79 35 61 75 4a 10> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.85:48656',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400134
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52332
received auth hello!
{ authId: 504, nonce: <Buffer 03 9c 72 18 78 4e 2d 03> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d7 b7 81 f9 81 21 f9 4e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7d ca c7 95 06 44 83 a5>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 7d ca c7 95 06 44 83 a5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.84:33442',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400136
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52360
received auth hello!
{ authId: 504, nonce: <Buffer 89 11 63 f1 66 5d 76 e0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1f ea 8f dd a2 ff 2a cf>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e6 15 87 ae 38 08 b2 fa>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e6 15 87 ae 38 08 b2 fa> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.85:48926',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400140
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52602
received auth hello!
{ authId: 504, nonce: <Buffer eb cb c6 1a 09 e5 5b 85> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 64 13 a4 cb 8f e2 5c cd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 10 22 48 a2 45 0b 0d 8b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 10 22 48 a2 45 0b 0d 8b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.84:33712',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400142
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52630
received auth hello!
{ authId: 504, nonce: <Buffer 01 5b 5a 15 54 ac 28 4a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7e d1 91 27 2e 48 7e e8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ed fe d8 01 7c 7a 23 f2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ed fe d8 01 7c 7a 23 f2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.85:49196',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400146
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52872
received auth hello!
{ authId: 504, nonce: <Buffer d7 50 24 c9 ba 81 7d 04> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9c 55 c7 4e 70 9d 1e cf>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a6 44 ab a6 cd 37 1b b4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a6 44 ab a6 cd 37 1b b4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.84:33982',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400148
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52900
received auth hello!
{ authId: 504, nonce: <Buffer d6 2d 19 ae 7a ec 2c 54> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 60 e1 c8 03 25 c6 0c b6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2c 52 ed 5f 47 37 65 64>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 2c 52 ed 5f 47 37 65 64> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.85:49466',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100904
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100905
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 49352
received auth hello!
{ authId: 502, nonce: <Buffer fe 0e b1 26 55 42 cc b7> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth504',
     commonName: '10.0.0.7' },
  serial: '016246460309',
  notBefore: 2018-03-21T01:55:16.000Z,
  notAfter: 2018-03-22T01:56:56.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'AB:B4:22:6D:DC:14:27:9B:72:32:67:BA:1A:E8:82:A3:33:F0:33:71',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'FF6CB5202497CC77AF28EFDE774858E4FEF04355E5228E378962DF4235BE3683DAF9E38A7E22621D66B3B50166D897E97BF911F9E8FC09D686961AA39679014E5DDD27EA0F02DE853A41537DB5E37F33395E249F355C0D074419572E9856D1D598CAB2CD6951013DDCB0A163B943DFCD2694BE18B9B3892695B3052EBD9115D447293C83AF24A008794B842E4F0A6C2A8D0189612A600AA40A592603E43713C0ECCA681024E5EC429FAD09484B824919DF59C8BD488E0D372D2A3D8B99B6068E24BBBDA8F0BCDDBA806010E4A7181736DF08D4D1CFC16E26507C360EDCBFF1B5F4288CE304DE62E9696665C5108489AD7232658356998FF47C4F7E8A04225423',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJGRgMJMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDQxETAPBgNVBAMMCDEwLjAuMC43MB4XDTE4MDMy\nMTAxNTUxNloXDTE4MDMyMjAxNTY1NlowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQD/bLUgJJfMd68o7953SFjk/vBDVeUijjeJYt9CNb42g9r544p+\nImIdZrO1AWbYl+l7+RH56PwJ1oaWGqOWeQFOXd0n6g8C3oU6QVN9teN/MzleJJ81\nXA0HRBlXLphW0dWYyrLNaVEBPdywoWO5Q9/NJpS+GLmziSaVswUuvZEV1EcpPIOv\nJKAIeUuELk8KbCqNAYlhKmAKpApZJgPkNxPA7MpoECTl7EKfrQlIS4JJGd9ZyL1I\njg03LSo9i5m2Bo4ku72o8LzduoBgEOSnGBc23wjU0c/BbiZQfDYO3L/xtfQojOME\n3mLpaWZlxRCEia1yMmWDVpmP9HxPfooEIlQjAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAJe4gcV0gxhx3i9/8mmGRxjw+DyeOLYk\nLdDGYSKkewMB5kt5+dO3FZvRXlWEqKnnsHWfDA30PSJx3a5KsJGDKmSCgD2lPHtp\n9NM9Lh3gdBrTYeX7f+ar4rSh10I4Zokx0jIFGoE3IbEIHQSC9Igj9NOYvHaqegZY\noJhsgCa52HjCEyLw9gaZ88wZ0kCpjruppwkN7e6lRnkjNJ53fzdAPRbEeACS0ISS\nbrw6vBCCOzsygupM335GwzwNs6Iom+U6LvWAEyvM2HOmzaUvqiXH3UYzmmxhTUYe\nZCxCKQtTO/bYMTVSjlIA7oZ0TWyuxv9nIc2k2fmuerLXe4/C0NsM2CU=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100914
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49560
received auth hello!
{ authId: 502, nonce: <Buffer 52 e2 82 6b 19 4d 0b 47> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 37 5c b7 fb 58 d4 9f a8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer a6 25 a8 a4 d8 ae 8c 12 ab 93 c3 0e 9b 07 d9 42>,
  macKeyVal: <Buffer d1 19 79 ed 6c 5c 73 a8 85 09 ce 56 76 c7 02 77 53 38 f8 a8 f4 35 01 7f 8c 35 dd ea 44 27 11 43>,
  absValidity: 2018-03-21T03:09:22.747Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 46 c2 bc 61 6f bf 53 aa>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 46 c2 bc 61 6f bf 53 aa> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.84:34874',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100915
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49572
received auth hello!
{ authId: 502, nonce: <Buffer a5 06 05 f8 4f a0 3a 6e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7c 7d 37 6a 9e c0 2c a1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 77 09 2e 78 c2 c8 b0 08>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 77 09 2e 78 c2 c8 b0 08> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.85:50342',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100926
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49816
received auth hello!
{ authId: 502, nonce: <Buffer fa 9b 56 e4 c2 d3 6b 0d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9b 84 62 ae 82 e7 17 61>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5c 1c b3 27 71 9c 67 66>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5c 1c b3 27 71 9c 67 66> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.84:35130',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100927
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49826
received auth hello!
{ authId: 502, nonce: <Buffer 9b 40 cf d9 8f 8c 36 cc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8d 6e e8 08 f9 c7 8b 38>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 52 81 45 e8 9c f5 56 d2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 52 81 45 e8 9c f5 56 d2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.85:50594',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100937
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50044
received auth hello!
{ authId: 502, nonce: <Buffer d1 52 7a 45 70 33 11 da> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 96 c7 4d 59 64 ef 8a 9b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cf d1 a4 50 27 fc 8f c4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer cf d1 a4 50 27 fc 8f c4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.85:50814',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100939
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50076
received auth hello!
{ authId: 502, nonce: <Buffer 8c 18 90 66 87 15 eb a3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 58 7c c0 6e e0 5b 85 52>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5d 29 85 54 42 b8 27 09>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5d 29 85 54 42 b8 27 09> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.84:35388',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100948
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50250
received auth hello!
{ authId: 502, nonce: <Buffer 10 55 2b 65 11 e8 99 99> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c3 5f e9 93 3c 10 d6 17>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d0 70 81 1a 85 c9 dd 62>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d0 70 81 1a 85 c9 dd 62> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.84:35562',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100950
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50288
received auth hello!
{ authId: 502, nonce: <Buffer 3b 63 5b 33 ac ad 52 ae> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9f 5d c8 5e bf ee 94 f5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a2 49 c0 ad 4f 47 76 86>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a2 49 c0 ad 4f 47 76 86> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.85:51056',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100962
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50502
received auth hello!
{ authId: 502, nonce: <Buffer e3 af 5d de d8 be 94 40> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ac 02 ef c9 5b 24 9c a6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e2 c6 a3 b8 7e 2d b9 50>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e2 c6 a3 b8 7e 2d b9 50> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.85:51272',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100963
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50524
received auth hello!
{ authId: 502, nonce: <Buffer fa 87 5b 40 db 88 5d e3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b8 01 e3 f3 d3 ff 1e c5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 29 2e 28 be 09 24 6b 80>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 29 2e 28 be 09 24 6b 80> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.84:35836',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100974
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50736
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100975
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50744
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer ac a8 94 43 44 56 8f 5e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b1 08 44 85 71 88 87 3f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ee 1a 3a e6 6b c7 d3 fb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ee 1a 3a e6 6b c7 d3 fb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.85:51512',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100987
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50938
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100991
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50972
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 5b c5 5d 01 25 0d 48 d0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d2 69 77 34 c9 5c 1f 1e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 48 08 a7 5d a5 69 da cb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 48 08 a7 5d a5 69 da cb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.85:51742',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
received auth hello!
{ authId: 502, nonce: <Buffer f6 ba 00 46 f1 92 f7 22> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c8 d9 b0 c9 62 cd a0 0c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 42 d5 e9 bf 7b 29 4d 25>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 42 d5 e9 bf 7b 29 4d 25> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 24,
  remoteAddress: '::ffff:10.0.1.84:36252',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 24 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 24 }
specified socketID: 24
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #24 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101000
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51162
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101012
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51346
received auth hello!
{ authId: 502, nonce: <Buffer a9 15 eb cb 37 29 a5 7a> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: write after end
Handler: Error in server - details: handshake2 timed out...
disconnected from auth
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Connection with Auth timed out...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101024
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51560
received auth hello!
{ authId: 502, nonce: <Buffer 51 f4 42 3a 80 40 0f c5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3d 91 89 91 bf 52 4a ae>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 35 1e 2e bb 5d 87 10 2a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 35 1e 2e bb 5d 87 10 2a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 25,
  remoteAddress: '::ffff:10.0.1.84:36874',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 25 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 25 }
specified socketID: 25
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #25 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101034
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51730
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101036
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51748
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer d1 77 1d e4 4a e0 d2 f3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 02 dd 71 5b b1 98 77 c9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b8 6a c7 9b d1 c8 fa a7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b8 6a c7 9b d1 c8 fa a7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 26,
  remoteAddress: '::ffff:10.0.1.85:52518',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 26 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 26 }
specified socketID: 26
received auth hello!
{ authId: 502, nonce: <Buffer f1 14 04 46 9c 01 21 73> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4d 50 e5 4a 57 16 77 69>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8e b5 e8 e3 a7 dd c3 cd>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 8e b5 e8 e3 a7 dd c3 cd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 27,
  remoteAddress: '::ffff:10.0.1.84:37044',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 27 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 27 }
specified socketID: 27
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #27 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101049
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51952
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #26 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101050
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51958
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 30 63 89 b1 d7 95 1b 9e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 86 cc e2 e6 c4 ac 38 c8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f7 0a 6f 9a c2 b7 45 83>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f7 0a 6f 9a c2 b7 45 83> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 28,
  remoteAddress: '::ffff:10.0.1.85:52728',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 28 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 28 }
specified socketID: 28
received auth hello!
{ authId: 502, nonce: <Buffer 51 2f db 1c 8a 36 26 28> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 78 a3 9e cd 12 ef 8b 6d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d6 dd 09 d4 83 98 ac b5>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer d6 dd 09 d4 83 98 ac b5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 29,
  remoteAddress: '::ffff:10.0.1.84:37264',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 29 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 29 }
specified socketID: 29
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #28 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101061
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52150
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 44 73 e1 a7 ba e9 ea cb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 88 04 3e 20 17 be 47 14>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 30 f2 99 d0 56 bd 27 49>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 30 f2 99 d0 56 bd 27 49> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 30,
  remoteAddress: '::ffff:10.0.1.85:52918',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 30 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 30 }
specified socketID: 30
received auth hello!
{ authId: 502, nonce: <Buffer ed 3b d9 e3 6c 35 80 13> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1d 4e 9b 2e 8f b9 6d 36>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 16 51 d1 d0 d8 a5 8c 0e>
Handler: Error in server - details: Error during comm init, details: Error: This socket has been ended by the other party
switching to HANDSHAKE_2_SENT
disconnected from auth
received auth hello!
{ authId: 502, nonce: <Buffer b1 5f 6b 5e 7c 45 f5 7a> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: write after end
disconnected from auth
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #29 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101072
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52306
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #30 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101074
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52330
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer bb 7d 1c a9 59 12 a4 9f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d4 d6 17 fd 1e 92 e4 50>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1b 10 a0 e8 fc d0 a7 30>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 1b 10 a0 e8 fc d0 a7 30> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 31,
  remoteAddress: '::ffff:10.0.1.85:53100',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 31 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 31 }
specified socketID: 31
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer ce 47 a1 50 81 6e f1 7c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a8 12 0b d1 4f 3c 24 65>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d8 ef 7e 92 e5 7a 22 5f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d8 ef 7e 92 e5 7a 22 5f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 32,
  remoteAddress: '::ffff:10.0.1.84:37618',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 32 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 32 }
specified socketID: 32
Handler: Error in server - details: Connection with Auth timed out...
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #32 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101083
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52496
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #31 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101085
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52516
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 01 1a c8 e7 a0 26 01 67> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3b 4f 86 99 85 c3 7d 1f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 76 79 4e 6b 9e ac f8 5f>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 76 79 4e 6b 9e ac f8 5f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 33,
  remoteAddress: '::ffff:10.0.1.85:53286',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 33 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 33 }
specified socketID: 33
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 5d 72 24 ce b4 a5 2e 20> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 91 74 01 83 61 8c c4 e3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6c 83 8e 09 14 df bd 93>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 6c 83 8e 09 14 df bd 93> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 34,
  remoteAddress: '::ffff:10.0.1.84:37808',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 34 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 34 }
specified socketID: 34
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #34 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101095
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52688
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer cd 62 df 78 a0 16 be cc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer df 86 84 eb bd f6 5f 47>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1c b6 92 12 55 99 f1 44>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1c b6 92 12 55 99 f1 44> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 35,
  remoteAddress: '::ffff:10.0.1.84:38002',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 35 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 35 }
specified socketID: 35
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #33 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101100
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52744
received auth hello!
{ authId: 502, nonce: <Buffer ef 79 78 48 e8 8c 7b d4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2b 2d 5c b8 e5 14 f7 ac>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b7 42 ae 7e ca 2c 46 1f>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b7 42 ae 7e ca 2c 46 1f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 36,
  remoteAddress: '::ffff:10.0.1.85:53514',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 36 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 36 }
specified socketID: 36
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #35 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101107
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52872
received auth hello!
{ authId: 502, nonce: <Buffer d2 32 54 39 8c 9e b3 77> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 51 8f 5a 84 ed f5 a7 55>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b3 41 75 fc e3 27 20 cb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b3 41 75 fc e3 27 20 cb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 37,
  remoteAddress: '::ffff:10.0.1.84:38186',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 37 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 37 }
specified socketID: 37
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #36 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101109
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52896
received auth hello!
{ authId: 502, nonce: <Buffer 53 07 87 77 60 10 2d 0c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 81 8f 01 06 8e 5b 96 c2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d5 de eb 47 f2 95 3e c8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d5 de eb 47 f2 95 3e c8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 38,
  remoteAddress: '::ffff:10.0.1.85:53666',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 38 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 38 }
specified socketID: 38
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #37 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101118
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53054
received auth hello!
{ authId: 502, nonce: <Buffer 38 1a a4 ea f0 96 53 81> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6b a9 d7 38 99 5e 2f b1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 14 86 ff fb e7 68 ae 52>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 14 86 ff fb e7 68 ae 52> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 39,
  remoteAddress: '::ffff:10.0.1.84:38366',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 39 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 39 }
specified socketID: 39
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #38 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101119
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53066
received auth hello!
{ authId: 502, nonce: <Buffer 3c 9e 8f 1f f6 d3 78 9a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2b 37 49 5a 79 41 69 e7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 87 1c ef 54 e2 58 1b 55>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 87 1c ef 54 e2 58 1b 55> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 40,
  remoteAddress: '::ffff:10.0.1.85:53834',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 40 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 40 }
specified socketID: 40
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #39 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101122
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53176
received auth hello!
{ authId: 502, nonce: <Buffer eb 3e 2c 0e 62 0c 59 e4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f3 f5 64 b8 9d b1 20 ac>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6e 8d 40 f3 a7 e0 d5 12>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6e 8d 40 f3 a7 e0 d5 12> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 41,
  remoteAddress: '::ffff:10.0.1.84:38490',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 41 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 41 }
specified socketID: 41
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #40 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101123
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53182
received auth hello!
{ authId: 502, nonce: <Buffer dc ea ca 27 52 e4 36 8f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 99 36 d9 92 b9 56 e2 5f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 08 23 e7 1b 73 00 80 3f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 08 23 e7 1b 73 00 80 3f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 42,
  remoteAddress: '::ffff:10.0.1.85:53952',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 42 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 42 }
specified socketID: 42
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #41 closed
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #42 closed
