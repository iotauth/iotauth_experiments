changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s413.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's413',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 30 6d ... > }
Handler: listening on port 22100
s413:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300524
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46890
received auth hello!
{ authId: 403, nonce: <Buffer 92 cf b3 19 74 8f 12 b9> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 07 e7 07 72 60 ed 1e ce>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 3d a4 8d ae 8d 89 89 ab 9f 3d ce 3f 02 f7 cc fe>,
  macKeyVal: <Buffer c3 ca f1 1a c4 26 3f 35 12 89 76 e1 88 d1 fc f1 2c 0b fd c4 8b d8 74 0b b6 3f 09 07 86 61 5f 3a>,
  absValidity: 2018-03-21T02:58:50.587Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer be e6 98 5c ba 7e 2d 41>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer be e6 98 5c ba 7e 2d 41> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.58:53750',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300530
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47094
received auth hello!
{ authId: 403, nonce: <Buffer 93 d2 7a a4 bc f0 a7 7c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2d 24 ad 64 6b 77 6f 0d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 59 95 9c e1 1c 5a 32 97>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 59 95 9c e1 1c 5a 32 97> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.58:53954',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300536
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47366
received auth hello!
{ authId: 403, nonce: <Buffer 5d 05 80 a3 68 aa 25 3d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fb 67 a4 eb 04 ba b0 a3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e0 90 79 49 c3 16 b1 16>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e0 90 79 49 c3 16 b1 16> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.58:54226',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300542
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47636
received auth hello!
{ authId: 403, nonce: <Buffer 1a 77 05 94 32 5c 28 a5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 26 b1 5f c3 08 99 de eb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 74 8e 6d 1b 05 77 6d e4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 74 8e 6d 1b 05 77 6d e4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.58:54496',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300548
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47906
received auth hello!
{ authId: 403, nonce: <Buffer d4 4c d4 cf 68 8c 3f 59> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b7 31 db 04 d5 74 45 1d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9d 75 ea e0 b1 6e 80 fe>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 9d 75 ea e0 b1 6e 80 fe> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.58:54766',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300554
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48176
received auth hello!
{ authId: 403, nonce: <Buffer bb 7f c4 e6 9e 8c 95 bb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 42 80 8a 91 b0 71 ec ae>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d6 37 53 5e 44 a6 68 7b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d6 37 53 5e 44 a6 68 7b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.58:55036',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300560
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48446
received auth hello!
{ authId: 403, nonce: <Buffer 07 8c d3 47 84 c1 f1 fd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c8 4c 0c b6 dd 5b 49 d3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ae 49 01 a1 81 55 28 3d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ae 49 01 a1 81 55 28 3d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.58:55306',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300566
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48712
received auth hello!
{ authId: 403, nonce: <Buffer 8b 9e 06 1a 35 20 ab 0e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3a 22 d1 ec c3 3f 77 91>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cd b0 10 9d 2d 9f 46 84>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer cd b0 10 9d 2d 9f 46 84> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.58:55572',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
