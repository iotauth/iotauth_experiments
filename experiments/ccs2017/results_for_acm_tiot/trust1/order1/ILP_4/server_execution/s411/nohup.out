changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s411.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's411',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 73 61 ... > }
Handler: listening on port 22100
s411:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100839
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60850
received auth hello!
{ authId: 403, nonce: <Buffer 5d 24 a2 7c a8 2a 2a ad> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 29 31 a0 f4 18 24 c8 53>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 20 94 08 79 a5 9b 29 b6 fc 74 df 8a c1 dc 3d 1b>,
  macKeyVal: <Buffer c9 b4 6e 54 2a 6f 92 89 ca 05 ed f6 aa 5a a6 ef 91 b1 28 f9 da 71 b4 d9 4d 49 ea 1e b7 56 a4 9f>,
  absValidity: 2018-03-21T02:58:08.636Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 85 c7 4e 3d 1c 69 bc 91>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 85 c7 4e 3d 1c 69 bc 91> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.45:34744',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100845
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60976
received auth hello!
{ authId: 403, nonce: <Buffer fa 89 a5 31 f5 27 8c c9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 09 31 f1 aa 5d bd 08 d3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 39 79 60 82 43 89 71 ee>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 39 79 60 82 43 89 71 ee> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.45:34870',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100851
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 32980
received auth hello!
{ authId: 403, nonce: <Buffer 0d 1d a1 9d 0b e0 ce 8c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 46 d1 cd 6e 0d 65 31 a2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 79 69 34 40 5f 23 b4 4e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 79 69 34 40 5f 23 b4 4e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.45:35106',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100857
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33250
received auth hello!
{ authId: 403, nonce: <Buffer f5 4b ff c3 38 5f c3 01> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 27 ad 66 c6 b3 3e 55 1b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 80 98 8c c3 c9 17 43 49>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 80 98 8c c3 c9 17 43 49> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.45:35376',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100863
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33520
received auth hello!
{ authId: 403, nonce: <Buffer 3e fe 99 42 89 2b bd 8b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9d 68 8d 22 2e 88 06 62>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c4 90 27 ef 81 97 1d ef>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c4 90 27 ef 81 97 1d ef> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.45:35646',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100869
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33790
received auth hello!
{ authId: 403, nonce: <Buffer a2 d5 95 02 3c 3a de 2e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9b 6f d7 02 ce 9a 8a a3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 81 2a 13 51 be 2f 35 92>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 81 2a 13 51 be 2f 35 92> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.45:35916',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100875
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34060
received auth hello!
{ authId: 403, nonce: <Buffer 83 b1 16 f9 7a 06 8d 80> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3d 2d 57 d9 e8 55 66 86>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a7 15 25 18 2d 47 f7 cf>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer a7 15 25 18 2d 47 f7 cf> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.45:36186',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100881
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34330
received auth hello!
{ authId: 403, nonce: <Buffer 3b a1 d6 6f 82 d0 c0 17> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 40 ac e3 15 41 9b 58 9b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 67 e9 6f 75 65 c1 28 6d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 67 e9 6f 75 65 c1 28 6d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.45:36456',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100887
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect ECONNREFUSED 10.0.1.3:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100893
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.3:21100
connected to auth! from local port 33350
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 503, nonce: <Buffer 09 f0 1e 19 8b 70 05 95> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in server - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100899
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.3:21100
connected to auth! from local port 33568
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 503, nonce: <Buffer 6d dd d8 09 b0 93 95 5b> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in server - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100910
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.3:21100
connected to auth! from local port 44488
received auth hello!
{ authId: 401, nonce: <Buffer 16 ab e8 6b b4 67 0e 5b> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth401',
     commonName: '10.0.1.1' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth403',
     commonName: '10.0.0.3' },
  serial: '01624645F8C5',
  notBefore: 2018-03-21T01:55:13.000Z,
  notAfter: 2018-03-22T01:56:53.000Z,
  subjectHash: 'de555cae',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '2B:A6:06:A7:FB:01:1D:06:46:75:34:79:2A:0D:90:3D:D0:72:4A:3E',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'B1D96D976344F70094AA7D00CFD0F6058B1B31F97C522A983DCB23C390F9190875BA7C64D5E5888B86F8FBB648A0578A448C8237E3471A64ED59A03226A81FB2D143B5D1B71755CE1746179065723893719601038056ABCE33D646915D78D23FCCCDAB70CDEB639AEA41A5AC90E02E3302A6EEA261EDEC33DAF9FF6E9D9AA13A87980386B0E5509FC1EC88DB6E99D090B087A95B3C78136AA98C511DF596BB516D5BEEA892745A9EBF372CC45AE13E88878E884DB48A986EB570DE84DB722811E539492023404AA567C0DE100C0C0E8B6B33FB2C63046063377803BC046949DBDCBCD85174D56D807C222E8E1C0DC97AA62D0B26CD1F36670A8CC0942EAA82E3',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.1' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 401,
  host: '10.0.1.1',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJGRfjFMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDMxETAPBgNVBAMMCDEwLjAuMC4zMB4XDTE4MDMy\nMTAxNTUxM1oXDTE4MDMyMjAxNTY1M1owYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDQwMTERMA8GA1UEAwwIMTAuMC4xLjEwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQCx2W2XY0T3AJSqfQDP0PYFixsx+XxSKpg9yyPDkPkZCHW6fGTV\n5YiLhvj7tkigV4pEjII340caZO1ZoDImqB+y0UO10bcXVc4XRheQZXI4k3GWAQOA\nVqvOM9ZGkV140j/MzatwzetjmupBpayQ4C4zAqbuomHt7DPa+f9unZqhOoeYA4aw\n5VCfweyI226Z0JCwh6lbPHgTaqmMUR31lrtRbVvuqJJ0Wp6/NyzEWuE+iIeOiE20\niphutXDehNtyKBHlOUkgI0BKpWfA3hAMDA6LazP7LGMEYGM3eAO8BGlJ29y82FF0\n1W2AfCIujhwNyXqmLQsmzR82ZwqMwJQuqoLjAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQEwDQYJKoZIhvcNAQELBQADggEBAMY4EQ13MF3YzkoMpPlEpZqa2Px0spJ+\nbxsU2MCgk5vOk+Kc/YZzXiglvKsEHRJMAbycT9ORBvxl5sKKt77mvRP5HG8OsthL\nH4f3AkXRGcDZLfi3oiZqexstty2MEchr6EoLRnAWvZdA1g5rt87sjOvb9lnCF2og\n23LDDUexICtz2VrY1MIyQ3nZJ0lrW9VxWp9b2zzfix3Vms66LJl9QGzyukm8yqi3\nk0RVMsi/yvbS/DbC3dn3jkeEIWpop4d7fttYRPr3zr7vj6ME6DQcr73va5tY829k\nxqTt+3gL+GK59+GHt4GuLVnd/FrLe6bJElmsaOJuODJt8ADwwES2PMU=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 1
to: 2
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100921
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44720
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100933
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44946
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100944
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45162
received auth hello!
{ authId: 401, nonce: <Buffer 4c 6a f3 2a 00 7f a8 19> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer e0 52 d2 55 ac 0d ba 38>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 22 8b 72 34 06 29 b1 8d c4 ed 3b 92 d8 90 37 a1>,
  macKeyVal: <Buffer e5 d4 c9 90 34 e8 ba 1c 97 66 05 da 9f 07 ce e7 98 69 f2 0b 22 3a 53 85 f0 d6 c1 73 d6 7b ff 29>,
  absValidity: 2018-03-21T03:12:09.203Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2e 67 88 d7 ac f9 30 f8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2e 67 88 d7 ac f9 30 f8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.45:38020',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100957
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45394
received auth hello!
{ authId: 401, nonce: <Buffer 67 98 87 69 03 14 67 cd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 28 3c c8 2d d1 25 08 c6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9a 66 9f bd 6e d8 61 00>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9a 66 9f bd 6e d8 61 00> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.45:38252',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100969
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45620
received auth hello!
{ authId: 401, nonce: <Buffer 9e 6a f2 90 23 b3 23 1b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 49 92 c3 f7 d0 b8 94 3b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 03 4e 5f 76 5a 8a c1 29>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 03 4e 5f 76 5a 8a c1 29> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.45:38478',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100982
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45842
received auth hello!
{ authId: 401, nonce: <Buffer fb 38 ab 71 19 00 3b bf> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 23 56 db 8f 3f 74 24 cf>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 26 cb 2f e1 16 46 22 e4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 26 cb 2f e1 16 46 22 e4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.45:38700',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100995
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46052
received auth hello!
{ authId: 401, nonce: <Buffer ae 0c 1f ac ba 66 19 5b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0a 62 4a 2f 8e c3 83 6c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4e 1a a5 b4 82 ba 07 32>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 4e 1a a5 b4 82 ba 07 32> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.45:38910',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101007
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46252
received auth hello!
{ authId: 401, nonce: <Buffer d4 12 b5 61 97 8b 0b e7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 71 67 75 bd ae ae e3 1c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a0 9d 64 9f 6c 65 ca 45>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer a0 9d 64 9f 6c 65 ca 45> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.45:39110',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101019
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46450
received auth hello!
{ authId: 401, nonce: <Buffer f0 09 7e b9 eb a2 a8 a1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c5 75 9b 1b a1 18 50 da>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a7 47 e8 af 23 6d 54 b6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a7 47 e8 af 23 6d 54 b6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.45:39308',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101031
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46652
received auth hello!
{ authId: 401, nonce: <Buffer 3f ef 68 fc 05 bb 95 1a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b0 9c eb 21 94 b0 bd 11>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8d ac e5 a6 c8 84 d7 b2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8d ac e5 a6 c8 84 d7 b2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.45:39510',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101044
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46862
received auth hello!
{ authId: 401, nonce: <Buffer 92 de c2 dc 01 9d 15 ac> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 52 69 a9 bb 6e b8 0d f3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c7 1c 1e dc a6 0c 8d c0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c7 1c 1e dc a6 0c 8d c0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.45:39720',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Handler: Error in server - details: Disconnected from auth before getting session key response
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101057
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47062
received auth hello!
{ authId: 401, nonce: <Buffer 03 b9 bd 8c 3e 14 30 58> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 85 52 c6 a3 fa 1a ec 58>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fa 53 61 51 a8 7c 42 54>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fa 53 61 51 a8 7c 42 54> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.45:39916',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Handler: Error in server - details: Disconnected from auth before getting session key response
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
