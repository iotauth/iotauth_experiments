changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s415.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's415',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 67 49 42 41 41 4b 43 41 51 45 41 7a 43 ... > }
Handler: listening on port 22100
s415:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300525
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48868
received auth hello!
{ authId: 403, nonce: <Buffer e6 8e b0 63 69 76 07 18> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer a4 45 b4 b6 c0 ea d8 e4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer c4 8f 3c 97 85 90 47 34 79 a9 64 6f d1 98 48 f4>,
  macKeyVal: <Buffer dc bd 15 72 a4 85 8f 73 e1 51 95 0b d8 f9 5f 6d 92 11 cf 18 0a 22 3d cd 9e 2e 61 d0 ee be 51 2a>,
  absValidity: 2018-03-21T02:58:54.471Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer eb b6 89 00 fc b0 09 b6>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer eb b6 89 00 fc b0 09 b6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.59:41610',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300531
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49078
received auth hello!
{ authId: 403, nonce: <Buffer c7 cc dd 1a e8 dc 0b 1e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ca ca a6 4f f2 75 1e 47>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f1 03 3c 43 6e ec f2 af>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f1 03 3c 43 6e ec f2 af> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.59:41820',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300537
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49350
received auth hello!
{ authId: 403, nonce: <Buffer 68 6a c5 64 95 de 50 04> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 51 82 7d 98 92 a2 02 0c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6b 89 1c 57 19 a3 c1 6b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 6b 89 1c 57 19 a3 c1 6b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.59:42090',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300543
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49620
received auth hello!
{ authId: 403, nonce: <Buffer d8 24 15 5b 4c 88 aa 31> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 08 65 18 29 09 91 de ab>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 07 97 3e 93 a4 24 8c 62>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 07 97 3e 93 a4 24 8c 62> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.59:42360',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300549
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49890
received auth hello!
{ authId: 403, nonce: <Buffer c2 5d 38 bf a0 72 f1 b8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c1 44 ee fe 0d 1e 65 a3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ad 37 32 99 82 b0 09 7e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ad 37 32 99 82 b0 09 7e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.59:42630',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300555
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50160
received auth hello!
{ authId: 403, nonce: <Buffer b5 22 69 fc 99 a9 eb 6a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1c 04 07 13 98 f0 22 86>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7d 71 8a 70 19 5d 89 af>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 7d 71 8a 70 19 5d 89 af> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.59:42902',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300561
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50430
received auth hello!
{ authId: 403, nonce: <Buffer 87 5a 2d 2d 5b f6 f0 f3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7f f6 16 c1 bb c1 4a 06>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d4 28 c9 6a c5 2d 5c e1>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer d4 28 c9 6a c5 2d 5c e1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.59:43170',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300567
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50696
received auth hello!
{ authId: 403, nonce: <Buffer 01 cb 53 d0 5c 67 62 59> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2b bf be c2 38 74 e5 bd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e3 42 8a b5 1e c9 12 89>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e3 42 8a b5 1e c9 12 89> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.59:43438',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
