changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s414.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's414',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 6c 46 ... > }
Handler: listening on port 22100
s414:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300522
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35858
received auth hello!
{ authId: 403, nonce: <Buffer 8e ff d8 09 bb d2 44 f3> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 78 15 7a ed c2 e8 04 07>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer df 48 3e 17 d4 3e 45 0a 0a 08 a4 32 ea 3d 66 df>,
  macKeyVal: <Buffer f9 d5 a6 93 23 ac 79 81 bf 68 f9 7e 65 51 e5 87 ac 5d c0 75 89 d2 7f 47 ad 54 ec 67 47 9c 10 ac>,
  absValidity: 2018-03-21T02:58:44.273Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 94 7a 35 09 2b dc 7e 0b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 94 7a 35 09 2b dc 7e 0b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.56:36664',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300528
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36050
received auth hello!
{ authId: 403, nonce: <Buffer 98 cc ef a3 49 b0 12 93> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 08 a9 07 38 b6 fc 2d 3b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer af 1a d3 50 4b 46 31 54>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer af 1a d3 50 4b 46 31 54> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.56:36856',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300534
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36322
received auth hello!
{ authId: 403, nonce: <Buffer 68 77 5c 5e 9f 2d da 4e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6a a8 43 5b e8 ee 40 02>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d0 80 93 7c c2 c9 23 f9>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer d0 80 93 7c c2 c9 23 f9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.56:37128',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300540
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36592
received auth hello!
{ authId: 403, nonce: <Buffer b8 ae fe 98 92 fc 76 05> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 84 c2 d5 4f 75 c8 c2 6d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5f e0 99 14 3b c2 c0 53>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5f e0 99 14 3b c2 c0 53> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.56:37398',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300546
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36862
received auth hello!
{ authId: 403, nonce: <Buffer a1 af bb 7c 02 23 b9 ef> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 25 78 76 37 02 fd 7c 81>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e2 8c df cd 09 21 d4 8f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e2 8c df cd 09 21 d4 8f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.56:37668',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300552
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37132
received auth hello!
{ authId: 403, nonce: <Buffer 7c 1c c3 e4 15 bd 7e 97> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 76 82 d0 c7 8f 6c 01 07>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 83 1d 45 d2 16 b4 76 3f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 83 1d 45 d2 16 b4 76 3f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.56:37938',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300558
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37402
received auth hello!
{ authId: 403, nonce: <Buffer e9 0a 4c 6a 1d 18 16 d3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 33 da e5 27 8d 52 1e 70>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 66 28 0c f7 10 87 15 d4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 66 28 0c f7 10 87 15 d4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.56:38208',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300564
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37668
received auth hello!
{ authId: 403, nonce: <Buffer 28 19 de da 31 e6 dc 55> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7f 14 e8 7a 9a f1 5c 82>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 56 24 44 8e d3 9a 0a 84>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 56 24 44 8e d3 9a 0a 84> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.56:38474',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
