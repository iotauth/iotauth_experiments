changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s405.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's405',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 74 59 ... > }
Handler: listening on port 22100
s405:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200722
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40174
received auth hello!
{ authId: 402, nonce: <Buffer 91 4e 8f c6 13 1d 8a ca> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 25 a1 4f a3 67 64 22 1d>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer bb 26 38 c9 a8 b5 b6 7d c3 f7 a5 ef 91 bc 2b fd>,
  macKeyVal: <Buffer 12 a0 c1 5f e4 4e f1 36 b9 2e 3b 63 d4 65 d0 0b 4f 31 e7 2d 3d 2a 57 dd 28 b5 87 8e d1 d0 05 c4>,
  absValidity: 2018-03-21T22:43:05.394Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2e 2b ee c7 54 d3 93 89>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 2e 2b ee c7 54 d3 93 89> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.49:50900',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200729
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40324
received auth hello!
{ authId: 402, nonce: <Buffer ef e1 0a 17 68 a2 36 8b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a1 b6 b5 23 8a 94 93 7a>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 40 87 48 f7 42 e1 b2 05>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 40 87 48 f7 42 e1 b2 05> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.49:51050',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200736
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40580
received auth hello!
{ authId: 402, nonce: <Buffer 3c 7f b8 ae cc 5f 67 e1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c6 ce 64 93 d0 ca 0c b0>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 83 ef c8 82 7d 9c cc c9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 83 ef c8 82 7d 9c cc c9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.49:51306',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200743
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40850
received auth hello!
{ authId: 402, nonce: <Buffer 4e 6b 6f 53 b5 87 bf 75> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ab 92 87 3d eb 4e 55 06>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5e 9a 07 81 2c 3d 48 2a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5e 9a 07 81 2c 3d 48 2a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.49:51576',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200750
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41120
received auth hello!
{ authId: 402, nonce: <Buffer e0 9a 86 d2 3e 25 83 1e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 79 c7 c1 9c bb 74 7f 4e>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e1 76 00 04 b4 4a 67 74>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e1 76 00 04 b4 4a 67 74> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.49:51846',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200757
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41390
received auth hello!
{ authId: 402, nonce: <Buffer 8b a7 49 91 8e f9 68 e2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e8 f7 98 26 f6 91 54 b8>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 16 65 9c 1c 0c 93 18 54>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 16 65 9c 1c 0c 93 18 54> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.49:52116',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200764
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41660
received auth hello!
{ authId: 402, nonce: <Buffer 2a 3c de 3e 54 19 d1 e8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2f a8 9e 7d c5 bb 90 3c>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3f ab 5c e5 49 f3 5e 43>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3f ab 5c e5 49 f3 5e 43> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.49:52386',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200771
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41930
received auth hello!
{ authId: 402, nonce: <Buffer 43 73 14 26 29 f5 f6 9e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 52 05 67 53 b5 2d c2 fc>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ed b4 04 97 e5 1e 04 86>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ed b4 04 97 e5 1e 04 86> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.49:52656',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
