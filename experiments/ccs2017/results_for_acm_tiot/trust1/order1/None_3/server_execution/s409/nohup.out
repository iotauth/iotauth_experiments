changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s409.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's409',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 67 49 42 41 41 4b 43 41 51 45 41 6f 6c ... > }
Handler: listening on port 22100
s409:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200728
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39660
received auth hello!
{ authId: 402, nonce: <Buffer 22 68 04 94 cf 7e 16 01> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 9a 0b 05 d5 8f a6 e8 ce>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer d8 65 4f 54 0d 5b 48 d3 10 57 90 6f a4 f4 9f 6f>,
  macKeyVal: <Buffer 10 72 18 6d 3e 77 58 70 df ee 67 e0 6d 8f 7e 75 d8 74 95 be a9 a3 a3 0b be 7c fe 65 21 c5 ab 34>,
  absValidity: 2018-03-21T22:43:27.896Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a6 07 49 03 46 02 ff 0f>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer a6 07 49 03 46 02 ff 0f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.55:57060',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200735
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39846
received auth hello!
{ authId: 402, nonce: <Buffer d7 f6 99 d3 29 b3 f5 81> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a1 12 9a ff 9b f0 af 0a>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 21 5c de 43 75 b8 5a 54>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 21 5c de 43 75 b8 5a 54> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.55:57246',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200742
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40118
received auth hello!
{ authId: 402, nonce: <Buffer 55 f6 d6 32 94 69 1a 3b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bd 70 6a f9 22 dc 37 79>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4a a3 d5 6b f8 46 db 0a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4a a3 d5 6b f8 46 db 0a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.55:57518',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200749
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40388
received auth hello!
{ authId: 402, nonce: <Buffer a5 4b c1 37 ec 03 f1 2a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer eb df 23 62 86 07 bb eb>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c0 79 af 64 7e e0 a6 76>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c0 79 af 64 7e e0 a6 76> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.55:57788',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200756
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40658
received auth hello!
{ authId: 402, nonce: <Buffer cd 58 6c 13 e9 8e ef 71> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 83 5b 1d 3e 28 be 24 0c>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 20 47 67 b3 e6 4e 24 16>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 20 47 67 b3 e6 4e 24 16> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.55:58058',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200763
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40928
received auth hello!
{ authId: 402, nonce: <Buffer 85 8a 8e 88 84 40 fc 8d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cc f6 6d c3 33 5d bb 8e>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2a 05 e4 e2 e1 c3 e9 d4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2a 05 e4 e2 e1 c3 e9 d4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.55:58328',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200770
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41198
received auth hello!
{ authId: 402, nonce: <Buffer cf e5 b4 54 39 94 cc 91> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0c 5a 75 82 a7 7e 17 bf>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 87 c2 bc 4b b7 88 7c 1d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 87 c2 bc 4b b7 88 7c 1d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.55:58598',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
