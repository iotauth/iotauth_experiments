changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s503.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's503',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 77 6f ... > }
Handler: listening on port 22100
s503:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101148
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57178
received auth hello!
{ authId: 504, nonce: <Buffer 99 aa 09 af 16 3d 57 d1> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer a5 6c b2 0f b6 c7 e8 f0>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 36 e9 6d 08 88 f2 5c 3a 16 5f e8 24 a2 c1 14 c0>,
  macKeyVal: <Buffer 7c c6 75 71 b7 da a6 d0 ad 67 89 22 f8 06 ea 62 2e 41 44 d2 48 bf bc 79 ff 5d e0 e4 a2 7d db ab>,
  absValidity: 2018-03-21T22:43:54.548Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e4 46 da 9c ad 93 ba 37>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e4 46 da 9c ad 93 ba 37> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.64:49876',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400301
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57190
received auth hello!
{ authId: 504, nonce: <Buffer e5 72 87 83 df 91 de a0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 48 bf 5e e9 80 97 4d 00>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5d 78 66 a7 b5 29 40 cf>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5d 78 66 a7 b5 29 40 cf> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.65:55218',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400302
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57202
received auth hello!
{ authId: 504, nonce: <Buffer 6d 60 51 ed 9e cf 69 31> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 14 ca 5b 88 6d fb 24 50>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f5 b6 f2 b5 a9 f8 6f dd>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f5 b6 f2 b5 a9 f8 6f dd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.66:53790',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101156
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57420
received auth hello!
{ authId: 504, nonce: <Buffer 18 25 1b 93 26 91 e7 41> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 07 df b3 a9 80 b5 1d 4b>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 96 e5 91 b7 26 eb 62 ca>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 96 e5 91 b7 26 eb 62 ca> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.64:50118',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400303
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57438
received auth hello!
{ authId: 504, nonce: <Buffer 77 37 62 00 e6 64 40 0e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 98 04 c5 99 91 b5 db d4>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 53 1d 93 f0 08 12 04 3f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 53 1d 93 f0 08 12 04 3f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.65:55466',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400305
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57462
received auth hello!
{ authId: 504, nonce: <Buffer 4a 3c 70 f3 89 90 5e 97> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d4 bd b3 42 5d 63 14 4b>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 07 c4 04 de 4b 9c 7b 8c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 07 c4 04 de 4b 9c 7b 8c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.66:54050',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101164
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57690
received auth hello!
{ authId: 504, nonce: <Buffer 4b 37 21 b3 7f c6 c6 85> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 09 f3 e7 e0 b3 40 e8 88>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bf 50 e1 44 7a be 91 d5>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer bf 50 e1 44 7a be 91 d5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.64:50388',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400309
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57708
received auth hello!
{ authId: 504, nonce: <Buffer 97 26 a5 9e 70 08 f8 30> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 92 70 4e 96 a1 e8 03 2f>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a9 01 d8 da 70 72 69 4f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a9 01 d8 da 70 72 69 4f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.65:55736',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400311
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57732
received auth hello!
{ authId: 504, nonce: <Buffer c7 36 da 27 2d 69 ac d9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 36 7c 43 41 ac 58 44 ed>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7b d1 2c 9e 7c 3c 41 de>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 7b d1 2c 9e 7c 3c 41 de> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.66:54320',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101172
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57960
received auth hello!
{ authId: 504, nonce: <Buffer 9a e2 41 65 01 20 a2 a3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b2 5c 34 4d f3 8c 11 dd>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 73 15 b9 3e 1d ad a7 8a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 73 15 b9 3e 1d ad a7 8a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.64:50658',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400315
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57978
received auth hello!
{ authId: 504, nonce: <Buffer e2 56 a9 9c ae de c4 7a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 33 11 42 eb 8a 78 f5 14>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7c bc d5 a4 27 8b 1e df>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 7c bc d5 a4 27 8b 1e df> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.65:56006',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400317
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58002
received auth hello!
{ authId: 504, nonce: <Buffer a9 e7 a0 6d ad d7 28 44> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 85 41 38 6d 0d 40 80 c3>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c3 46 21 bc 45 35 a9 86>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c3 46 21 bc 45 35 a9 86> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.66:54590',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101180
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58230
received auth hello!
{ authId: 504, nonce: <Buffer 1d 9d 64 70 42 c7 78 0e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b4 32 53 1e 1a 29 a5 8a>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cb 48 5d f5 f3 29 6f d1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer cb 48 5d f5 f3 29 6f d1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.64:50928',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400321
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58248
received auth hello!
{ authId: 504, nonce: <Buffer 20 cc cc 97 3f 32 cc 39> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e9 73 55 4f d2 22 67 38>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 51 e9 00 9c fe ea e5 a2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 51 e9 00 9c fe ea e5 a2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.65:56276',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400323
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58272
received auth hello!
{ authId: 504, nonce: <Buffer cd 36 d5 ec 76 33 4c a5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 12 8f 4d fd ec 14 62 a6>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5b 2e 60 de bd d4 4d 8f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5b 2e 60 de bd d4 4d 8f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.66:54860',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101188
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58500
received auth hello!
{ authId: 504, nonce: <Buffer 5b 13 a2 2f b5 31 c5 44> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c4 f7 ad f2 5b 30 9c b3>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1d 22 21 d9 59 0e f9 38>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1d 22 21 d9 59 0e f9 38> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.64:51198',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400327
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58518
received auth hello!
{ authId: 504, nonce: <Buffer 3e bd 4c 1a c3 34 0a 02> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f5 c5 80 69 89 05 33 2f>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 03 7e e3 49 4d 32 87 d9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 03 7e e3 49 4d 32 87 d9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.65:56546',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400329
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58542
received auth hello!
{ authId: 504, nonce: <Buffer 7c c3 18 d0 29 a6 2c d9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 28 6a 7e f2 77 fe f1 6b>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b7 24 e3 92 2b 88 3a d8>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b7 24 e3 92 2b 88 3a d8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.66:55130',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101196
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58770
received auth hello!
{ authId: 504, nonce: <Buffer 33 df bd 03 9c 97 b5 3f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3b da 5e 6e 9e 46 91 e0>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 90 ec 49 39 6d b4 a2 f1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 90 ec 49 39 6d b4 a2 f1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.64:51468',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400333
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58788
received auth hello!
{ authId: 504, nonce: <Buffer eb 3e 1d 51 f2 55 60 31> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 74 a9 36 b4 9b 5e f3 0d>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 41 f2 aa 94 b3 6e 94 db>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 41 f2 aa 94 b3 6e 94 db> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.65:56816',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400335
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58812
received auth hello!
{ authId: 504, nonce: <Buffer d5 fc c5 59 80 51 31 03> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fb 05 1b 61 c5 50 f5 89>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 88 25 ff 6c 91 98 17 65>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 88 25 ff 6c 91 98 17 65> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.66:55400',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
