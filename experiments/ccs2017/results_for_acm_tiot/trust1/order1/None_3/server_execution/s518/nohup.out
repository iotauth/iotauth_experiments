changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s518.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's518',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 67 49 42 41 41 4b 43 41 51 45 41 33 62 ... > }
Handler: listening on port 22100
s518:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400304
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38232
received auth hello!
{ authId: 504, nonce: <Buffer e4 ea 09 60 7b c4 db 45> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 93 4b 71 bf d7 46 5d 6e>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 0c df 0a 37 4c 53 b2 33 52 2e b3 a1 dc ff 3b 2d>,
  macKeyVal: <Buffer cd bd 5b 71 fa 0a 86 0b b6 c5 c4 f9 2d 6d 76 a9 52 ae af 5a b9 07 b3 6e 79 35 f2 a9 6c 39 33 aa>,
  absValidity: 2018-03-21T22:45:00.340Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 14 91 50 18 c4 24 1b d4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 14 91 50 18 c4 24 1b d4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.84:47574',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400306
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38264
received auth hello!
{ authId: 504, nonce: <Buffer d1 5e d8 c4 83 d2 85 58> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 27 0b ec 31 71 d3 d4 23>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9a cd b1 92 1e 41 8b 46>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 9a cd b1 92 1e 41 8b 46> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.85:34830',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400310
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38502
received auth hello!
{ authId: 504, nonce: <Buffer 83 13 75 45 f9 e1 95 52> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5b 7b 22 13 0e dc 47 c2>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a4 4c 45 f0 7d a6 82 7f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a4 4c 45 f0 7d a6 82 7f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.84:47844',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400312
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38534
received auth hello!
{ authId: 504, nonce: <Buffer 4d 77 06 e5 c8 96 bc 97> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bd b3 7e d0 2a 3e 04 d5>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer df c4 c4 17 30 2f f5 e1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer df c4 c4 17 30 2f f5 e1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.85:35100',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400316
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38772
received auth hello!
{ authId: 504, nonce: <Buffer 14 9c ab 82 46 5a e3 42> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 82 d6 b2 03 ef 7a 7b b6>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4c 8a a2 3c ed 26 a4 f1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4c 8a a2 3c ed 26 a4 f1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.84:48114',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400318
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38804
received auth hello!
{ authId: 504, nonce: <Buffer 67 65 5c fa 3a 73 5d 34> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 34 63 54 08 f9 c9 ea 1e>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f0 3f 2a 90 ab a3 9e 70>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f0 3f 2a 90 ab a3 9e 70> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.85:35370',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400322
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39042
received auth hello!
{ authId: 504, nonce: <Buffer 15 a6 33 e0 7d 65 b4 67> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3c f5 a3 07 4c df d7 de>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 44 76 d6 53 da f8 b5 4d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 44 76 d6 53 da f8 b5 4d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.84:48384',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400324
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39074
received auth hello!
{ authId: 504, nonce: <Buffer a9 a0 fb cd 13 2f f7 56> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cd d9 40 8f 80 8d 98 95>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8e b7 80 32 a8 6c a0 7b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 8e b7 80 32 a8 6c a0 7b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.85:35640',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400328
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39312
received auth hello!
{ authId: 504, nonce: <Buffer fd d0 f2 9a 3e 84 c1 8d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a8 11 01 4f 87 37 5e 46>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 37 a5 db 9b 01 70 39 77>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 37 a5 db 9b 01 70 39 77> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.84:48654',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400330
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39344
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer bd 73 31 5b b6 cf 52 0d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a5 e7 cd 03 f3 75 b8 65>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2a b6 89 b1 87 ff d7 48>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2a b6 89 b1 87 ff d7 48> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.85:35910',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400334
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39582
received auth hello!
{ authId: 504, nonce: <Buffer 79 14 95 e8 03 8f 06 64> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9c 43 28 24 b8 87 15 31>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 67 9e f5 cd e4 08 d4 c3>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 67 9e f5 cd e4 08 d4 c3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.84:48924',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400336
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39614
received auth hello!
{ authId: 504, nonce: <Buffer 26 63 8d c1 e5 10 26 8f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 68 91 ab 06 ed 89 38 23>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5f e3 3f fd 40 7e ee 0e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5f e3 3f fd 40 7e ee 0e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.85:36180',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
