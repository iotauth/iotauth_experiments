changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s410.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's410',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 35 5a ... > }
Handler: listening on port 22100
s410:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200726
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48614
received auth hello!
{ authId: 402, nonce: <Buffer 6f 47 61 8b 68 21 e9 30> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 38 7f b9 37 a8 c1 79 99>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 62 16 4c 01 85 8f 15 79 9b 32 93 72 63 f5 e0 4a>,
  macKeyVal: <Buffer f1 52 f9 dc 0a 03 b3 2d f4 fd cf df f4 9d b0 7b a0 e9 e7 00 ed af f2 32 70 15 5a ec d8 55 46 75>,
  absValidity: 2018-03-21T22:43:19.821Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9c d1 74 23 08 da a3 74>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 9c d1 74 23 08 da a3 74> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.53:51278',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200733
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48788
received auth hello!
{ authId: 402, nonce: <Buffer 86 5e 4a fd dd 1b 3f 73> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3c 3b 96 33 b4 bd af 0f>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 99 92 c2 dd 49 7a 19 06>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 99 92 c2 dd 49 7a 19 06> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.53:51452',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200740
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49060
received auth hello!
{ authId: 402, nonce: <Buffer de af 54 be 3b d0 9f 43> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b5 f8 22 ee 27 10 cd 60>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9e 8d 7d a6 c3 19 68 5a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9e 8d 7d a6 c3 19 68 5a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.53:51724',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200747
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49330
received auth hello!
{ authId: 402, nonce: <Buffer 4d a4 52 da e8 d2 7f 0f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c1 de bd e6 50 d6 d7 c2>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ca 4a 17 ba e8 05 0a 4c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ca 4a 17 ba e8 05 0a 4c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.53:51994',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200754
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49600
received auth hello!
{ authId: 402, nonce: <Buffer b1 39 f6 32 de fe 68 85> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 52 25 9f ba c0 05 b2 17>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 11 eb 07 d8 b3 b8 a4 d5>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 11 eb 07 d8 b3 b8 a4 d5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.53:52264',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200761
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49870
received auth hello!
{ authId: 402, nonce: <Buffer 33 04 e5 c4 3f a6 ec 54> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e5 16 67 53 29 ba 9d c3>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 83 cb 5f 8a 19 da 89 05>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 83 cb 5f 8a 19 da 89 05> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.53:52534',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200768
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50140
received auth hello!
{ authId: 402, nonce: <Buffer 24 8a 14 51 42 82 d8 c7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a8 25 38 73 ef af 45 7c>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 28 81 c6 4c a1 d4 87 2e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 28 81 c6 4c a1 d4 87 2e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.53:52804',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200775
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50406
received auth hello!
{ authId: 402, nonce: <Buffer c8 a2 4c 5a 4f 6f 07 3a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e8 ef 12 13 54 03 64 3b>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 02 05 56 46 04 8d c5 ab>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 02 05 56 46 04 8d c5 ab> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.53:53070',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
