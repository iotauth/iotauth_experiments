changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c407.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c407',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 75 4b ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521592792384
connected to auth! from local port 53284
received auth hello!
{ authId: 402, nonce: <Buffer e5 29 2d 61 ed 76 ba 9b> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 19 72 3a a9 86 24 a9 d4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer b3 1f 9e 49 f5 45 3c 1d ab 5a b8 53 4d 2a a2 43>,
  macKeyVal: <Buffer 6c 13 f4 16 96 7b 02 f2 98 c1 fe 1e b6 14 e0 36 6c a6 29 bd 10 8f e4 5a e8 b1 52 e6 ac 73 8d 24>,
  absValidity: 2018-03-21T01:39:52.542Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200196,
  cipherKeyVal: <Buffer 31 f6 b5 0d c9 1d 32 ba 16 ad bf 04 5d 5b 50 6d>,
  macKeyVal: <Buffer 3b ba f6 70 be e7 ec da f0 17 13 60 06 c1 43 5f 05 5d f5 fb 05 ef 4e 91 4d 2a fe 41 bd bf f3 c3>,
  absValidity: 2018-03-22T00:39:52.536Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200196,
     cipherKeyVal: <Buffer 31 f6 b5 0d c9 1d 32 ba 16 ad bf 04 5d 5b 50 6d>,
     macKeyVal: <Buffer 3b ba f6 70 be e7 ec da f0 17 13 60 06 c1 43 5f 05 5d f5 fb 05 ef 4e 91 4d 2a fe 41 bd bf f3 c3>,
     absValidity: 2018-03-22T00:39:52.536Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 0d 47 4e fb a3 5e 77 06>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 00:39:53 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521592793463
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521592852442
connected to auth! from local port 53434
received auth hello!
{ authId: 402, nonce: <Buffer 96 62 6a fb 86 b7 fe f2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bc 30 97 6c b6 fa d9 85>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200203,
  cipherKeyVal: <Buffer c9 20 f2 6e ec cd 8a 8f 2b 0e e2 f1 02 7f c1 52>,
  macKeyVal: <Buffer a2 8c 68 8e 83 b8 77 6b a5 98 f7 84 14 e8 fb 0c 75 65 fa fe 79 dc fa 97 d9 ef 08 f8 7a 4e a1 86>,
  absValidity: 2018-03-22T00:40:52.611Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200203,
     cipherKeyVal: <Buffer c9 20 f2 6e ec cd 8a 8f 2b 0e e2 f1 02 7f c1 52>,
     macKeyVal: <Buffer a2 8c 68 8e 83 b8 77 6b a5 98 f7 84 14 e8 fb 0c 75 65 fa fe 79 dc fa 97 d9 ef 08 f8 7a 4e a1 86>,
     absValidity: 2018-03-22T00:40:52.611Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 29 48 fd db 17 97 7b c3>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 00:40:53 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521592853597
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521592912465
connected to auth! from local port 53690
received auth hello!
{ authId: 402, nonce: <Buffer 67 44 2a d1 2e c7 67 30> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ec 19 8b 92 32 ac f0 bb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200210,
  cipherKeyVal: <Buffer fd 12 3b 1e 14 e8 f2 ad 60 ad e3 be 0f b3 35 6e>,
  macKeyVal: <Buffer 29 d9 96 6e 94 4f ee 8d 7c 09 94 11 af d1 3f 77 82 71 b7 76 16 ff 81 99 a9 ea c9 89 2c 00 79 ec>,
  absValidity: 2018-03-22T00:41:52.636Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200210,
     cipherKeyVal: <Buffer fd 12 3b 1e 14 e8 f2 ad 60 ad e3 be 0f b3 35 6e>,
     macKeyVal: <Buffer 29 d9 96 6e 94 4f ee 8d 7c 09 94 11 af d1 3f 77 82 71 b7 76 16 ff 81 99 a9 ea c9 89 2c 00 79 ec>,
     absValidity: 2018-03-22T00:41:52.636Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 92 29 59 0d 92 6a f7 cb>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 00:41:53 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521592913914
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521592972521
connected to auth! from local port 53960
received auth hello!
{ authId: 402, nonce: <Buffer 9e 3d b1 13 92 a7 b7 f1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 49 58 f8 6a 06 d9 9c f3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200217,
  cipherKeyVal: <Buffer f0 61 38 87 7e d0 d3 16 83 32 5e e1 32 a3 d8 55>,
  macKeyVal: <Buffer 3a d0 2f 16 8f 11 c7 36 e8 17 0d 74 09 8a 12 4e 8d 19 4c 39 97 58 1c 1a 7e 6c d6 19 98 3d 16 7c>,
  absValidity: 2018-03-22T00:42:52.650Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200217,
     cipherKeyVal: <Buffer f0 61 38 87 7e d0 d3 16 83 32 5e e1 32 a3 d8 55>,
     macKeyVal: <Buffer 3a d0 2f 16 8f 11 c7 36 e8 17 0d 74 09 8a 12 4e 8d 19 4c 39 97 58 1c 1a 7e 6c d6 19 98 3d 16 7c>,
     absValidity: 2018-03-22T00:42:52.650Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer ff 0a 2d b3 76 ea 6d 97>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 00:42:53 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521592973759
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521593032577
connected to auth! from local port 54230
received auth hello!
{ authId: 402, nonce: <Buffer 51 4f 09 93 c0 a0 1e 29> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b6 98 2a 4c bc 65 4f 96>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200224,
  cipherKeyVal: <Buffer a2 c5 33 1a 84 f5 d2 29 40 42 c6 6d 01 b7 d2 99>,
  macKeyVal: <Buffer e2 1c 57 c9 7c 19 ca 03 4b 05 b2 c8 2b c0 14 cb 9a e9 f9 73 79 e2 2d 8d 95 bb 30 06 a2 d6 7c 76>,
  absValidity: 2018-03-22T00:43:52.755Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200224,
     cipherKeyVal: <Buffer a2 c5 33 1a 84 f5 d2 29 40 42 c6 6d 01 b7 d2 99>,
     macKeyVal: <Buffer e2 1c 57 c9 7c 19 ca 03 4b 05 b2 c8 2b c0 14 cb 9a e9 f9 73 79 e2 2d 8d 95 bb 30 06 a2 d6 7c 76>,
     absValidity: 2018-03-22T00:43:52.755Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 1b ac 56 b5 a0 51 29 3c>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 00:43:53 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521593033852
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521593092634
connected to auth! from local port 54500
received auth hello!
{ authId: 402, nonce: <Buffer ed 38 ae e6 f7 bd b0 ed> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 22 91 1e 27 cf f9 9f 89>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200231,
  cipherKeyVal: <Buffer 01 7a 27 08 7d 7d 85 d1 87 12 22 39 2e ff d1 6b>,
  macKeyVal: <Buffer 3c f0 e7 f6 da df c3 d0 ec 4c a8 e2 56 5e 7c b5 7e 6e e6 cf c6 a4 73 9c 71 6e c0 a6 50 75 4d cb>,
  absValidity: 2018-03-22T00:44:52.813Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200231,
     cipherKeyVal: <Buffer 01 7a 27 08 7d 7d 85 d1 87 12 22 39 2e ff d1 6b>,
     macKeyVal: <Buffer 3c f0 e7 f6 da df c3 d0 ec 4c a8 e2 56 5e 7c b5 7e 6e e6 cf c6 a4 73 9c 71 6e c0 a6 50 75 4d cb>,
     absValidity: 2018-03-22T00:44:52.813Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer ff 1a 7a b4 b5 e2 2c 05>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 00:44:53 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521593093948
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521593152689
connected to auth! from local port 54770
received auth hello!
{ authId: 402, nonce: <Buffer b0 a1 09 c9 1d bd ee cd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3e fc 49 91 14 15 38 57>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200238,
  cipherKeyVal: <Buffer fc bb 75 da a6 13 51 19 3b 6b 76 a4 94 ac 23 f3>,
  macKeyVal: <Buffer 37 bc d0 b0 ff fd 03 8e e1 0a 12 01 d0 c1 9e 06 bf 9d 1b ed fc 7a 8d 5e 13 e7 4a 9c eb dc ef ed>,
  absValidity: 2018-03-22T00:45:52.853Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200238,
     cipherKeyVal: <Buffer fc bb 75 da a6 13 51 19 3b 6b 76 a4 94 ac 23 f3>,
     macKeyVal: <Buffer 37 bc d0 b0 ff fd 03 8e e1 0a 12 01 d0 c1 9e 06 bf 9d 1b ed fc 7a 8d 5e 13 e7 4a 9c eb dc ef ed>,
     absValidity: 2018-03-22T00:45:52.853Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 96 3e f0 54 c8 b8 d6 c9>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 00:45:53 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521593153916
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521593212749
connected to auth! from local port 55040
received auth hello!
{ authId: 402, nonce: <Buffer 6a 87 e8 b8 fa a2 b7 a1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a7 17 3a ce e0 1d 80 a1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200245,
  cipherKeyVal: <Buffer a3 a0 40 25 a5 64 0e 98 73 cc 92 f4 d7 91 83 23>,
  macKeyVal: <Buffer e6 93 da 55 9e 10 11 88 41 08 10 e5 43 07 4e 2f 2a ab e0 f3 6e c3 34 a4 06 b9 f6 79 9a b1 34 64>,
  absValidity: 2018-03-22T00:46:52.888Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200245,
     cipherKeyVal: <Buffer a3 a0 40 25 a5 64 0e 98 73 cc 92 f4 d7 91 83 23>,
     macKeyVal: <Buffer e6 93 da 55 9e 10 11 88 41 08 10 e5 43 07 4e 2f 2a ab e0 f3 6e c3 34 a4 06 b9 f6 79 9a b1 34 64>,
     absValidity: 2018-03-22T00:46:52.888Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 8b 8b 0d ff 81 d5 3d 99>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 00:46:53 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 8 1 1521593214123
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 9 0.8888888888888888 1521593272808
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 10 0.8 1521593332818
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 59260
received auth hello!
{ authId: 403, nonce: <Buffer ae e9 b9 69 ab b1 c5 46> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 11 0.7272727272727273 1521593392828
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 59512
received auth hello!
{ authId: 403, nonce: <Buffer a8 3d 28 3f 7d 5d 9c 2a> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 12 0.6666666666666666 1521593452830
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 47718
received auth hello!
{ authId: 502, nonce: <Buffer 7a 55 90 96 c8 4a 0e 91> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 13 0.6153846153846154 1521593512831
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 47974
received auth hello!
{ authId: 502, nonce: <Buffer f3 a2 32 ac 1e 8c f0 bd> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 14 0.5714285714285714 1521593572841
failure in connection with Auth : authFailureCount: 6
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 36962
received auth hello!
{ authId: 503, nonce: <Buffer d0 78 2f ab d8 87 f5 b3> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth503',
     commonName: '10.0.1.6' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth402',
     commonName: '10.0.0.2' },
  serial: '016245FE203A',
  notBefore: 2018-03-21T00:36:45.000Z,
  notAfter: 2018-03-22T00:38:25.000Z,
  subjectHash: '5542437f',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '46:30:1C:9B:0A:A6:D6:7C:09:84:5B:28:97:A5:CF:C5:4C:3E:EE:35',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'BEF8F49475DE2A7247021F450606CD5891A65AED3D5B5352F639856656DABAB71FBB39B48DC0B2D02F476ECDDA817725D9247F8343EFA59CE3C8A1478669A0BBC7331BFA8CA47D0D8AF82267CED06E82D935EE41A36521595DE2E9C9282C6C4EE18E9EF871EB69AFA64DAF8AF9C918FF6EBDCE83735918F691FBA5D857D30199CC98C65973C1020FC538746EF90A2737A41391E8FFB49EFEDDB1B9899BB362DE128DF9797D19395ABA6F755427F4D2533E459F827BEFAB7F66A40D2E20A5261297BEA33E1532F5BC6F4F7AB69CBFFC885108509A63CB8EBD0F0FB315C71A59CD5995A1BE71E5570E2D3AA54A128F129827DA7DE4AAB6B1B12275D61933AA6811',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.6' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 503,
  host: '10.0.1.6',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJF/iA6MA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDIxETAPBgNVBAMMCDEwLjAuMC4yMB4XDTE4MDMy\nMTAwMzY0NVoXDTE4MDMyMjAwMzgyNVowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMzERMA8GA1UEAwwIMTAuMC4xLjYwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQC++PSUdd4qckcCH0UGBs1YkaZa7T1bU1L2OYVmVtq6tx+7ObSN\nwLLQL0duzdqBdyXZJH+DQ++lnOPIoUeGaaC7xzMb+oykfQ2K+CJnztBugtk17kGj\nZSFZXeLpySgsbE7hjp74cetpr6ZNr4r5yRj/br3Og3NZGPaR+6XYV9MBmcyYxllz\nwQIPxTh0bvkKJzekE5Ho/7Se/t2xuYmbs2LeEo35eX0ZOVq6b3VUJ/TSUz5Fn4J7\n76t/ZqQNLiClJhKXvqM+FTL1vG9Peracv/yIUQhQmmPLjr0PD7MVxxpZzVmVob5x\n5VcOLTqlShKPEpgn2n3kqraxsSJ11hkzqmgRAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQYwDQYJKoZIhvcNAQELBQADggEBACmsqHoc9wbR4mgQIT9+pNSq3mhOnUW4\nYswH+3uxYPllds93ldSEN3xcFfPKJPPAT14bV7LHWpcNc0ZmdVdkRIaBI6/Wyug5\n8AvE+xZbCaYJsupOYNCihUfw+Q11ScQcg/qGAICFFioiQd1dwYFTTo0HJYg4rwyw\njaI/kr/fWcqm6ldNR6EiOey30H3nFN4d3r+VrFR3HwlJXLqNJJCB+opMEn7L+q42\nSD1k0eafO3oHPM0PXpIydjY+IXVN9iIVGs/8Du/+rk65jahb+e2aeHy86YBB9RR7\nWvbQAnUqe876A0E0Vfa0a90fLxjYxN/bfEO86rs9N9jhwMdkFY2kQmA=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 2
to: 3
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 15 0.5333333333333333 1521593632851
connected to auth! from local port 37210
received auth hello!
{ authId: 503, nonce: <Buffer 51 35 77 1e 74 a2 c1 bf> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer e6 14 ce 0a 4c 01 c7 50>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer f8 de 3a 32 f4 3a 94 a6 8a 0a 1e 10 57 94 99 bf>,
  macKeyVal: <Buffer 3f 46 9d 20 a4 8c 39 3e 3a eb c7 a7 c2 16 6e 68 01 d9 f6 59 37 8f 9b f5 37 00 77 3c 4e 80 e2 b9>,
  absValidity: 2018-03-21T01:53:53.069Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300208,
  cipherKeyVal: <Buffer 65 10 8a 71 d2 f7 20 84 5e 0e c6 bc b2 4a ba b2>,
  macKeyVal: <Buffer 29 36 19 07 36 54 a7 5f ca f1 0d 39 10 34 97 8a b8 b1 eb ff 82 09 26 c6 f4 24 5c dc 8a fc cd 3d>,
  absValidity: 2018-03-22T00:53:53.068Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 50300208,
     cipherKeyVal: <Buffer 65 10 8a 71 d2 f7 20 84 5e 0e c6 bc b2 4a ba b2>,
     macKeyVal: <Buffer 29 36 19 07 36 54 a7 5f ca f1 0d 39 10 34 97 8a b8 b1 eb ff 82 09 26 c6 f4 24 5c dc 8a fc cd 3d>,
     absValidity: 2018-03-22T00:53:53.068Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer c8 5b 18 0c 17 4b 68 0f>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 16 0.5 1521593692857
connected to auth! from local port 37476
received auth hello!
{ authId: 503, nonce: <Buffer f4 ac a3 b4 24 e0 ca 2e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b8 d8 35 c7 fe 28 54 0b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300216,
  cipherKeyVal: <Buffer e5 c2 58 fc 87 a1 47 76 72 0d ee 2b 28 af 1e e6>,
  macKeyVal: <Buffer 75 d3 9a c0 a2 99 be a9 97 70 f9 32 6e 53 6d 75 3c 4e cc ce e5 ca 11 89 c3 7b 14 a6 79 90 48 c4>,
  absValidity: 2018-03-22T00:54:53.088Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 50300216,
     cipherKeyVal: <Buffer e5 c2 58 fc 87 a1 47 76 72 0d ee 2b 28 af 1e e6>,
     macKeyVal: <Buffer 75 d3 9a c0 a2 99 be a9 97 70 f9 32 6e 53 6d 75 3c 4e cc ce e5 ca 11 89 c3 7b 14 a6 79 90 48 c4>,
     absValidity: 2018-03-22T00:54:53.088Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer e1 90 1e 1b ad f5 fd 4b>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 17 0.47058823529411764 1521593752867
connected to auth! from local port 37740
received auth hello!
{ authId: 503, nonce: <Buffer 0f c6 13 85 8c 54 76 f2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cc 59 dc e4 d7 6c 59 37>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300224,
  cipherKeyVal: <Buffer 3c d7 ae d5 03 1f b3 86 e9 87 a8 53 be 03 26 0f>,
  macKeyVal: <Buffer 9c 3d 31 89 12 ad 59 54 2b 69 f0 7f 68 e6 66 da 23 fc 13 1c a8 96 ce 7b 29 4e 12 62 8c 7d b1 36>,
  absValidity: 2018-03-22T00:55:53.073Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 50300224,
     cipherKeyVal: <Buffer 3c d7 ae d5 03 1f b3 86 e9 87 a8 53 be 03 26 0f>,
     macKeyVal: <Buffer 9c 3d 31 89 12 ad 59 54 2b 69 f0 7f 68 e6 66 da 23 fc 13 1c a8 96 ce 7b 29 4e 12 62 8c 7d b1 36>,
     absValidity: 2018-03-22T00:55:53.073Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer cc f8 77 3f 25 df 4c 83>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 18 0.4444444444444444 1521593812877
connected to auth! from local port 38000
received auth hello!
{ authId: 503, nonce: <Buffer c1 57 c7 9f 30 18 65 b3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b2 71 56 b1 a4 be a0 fa>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300232,
  cipherKeyVal: <Buffer 3a 6f 0a 4e 0e 8a 0d 14 9a fd 11 6a b5 bc ce 73>,
  macKeyVal: <Buffer b4 d9 02 15 aa e7 e3 ec 19 29 dd a1 9c a5 4c fb 90 32 ca fa 86 4a 4d 18 c5 e2 0b 6a 6b 0d 19 e9>,
  absValidity: 2018-03-22T00:56:53.000Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 50300232,
     cipherKeyVal: <Buffer 3a 6f 0a 4e 0e 8a 0d 14 9a fd 11 6a b5 bc ce 73>,
     macKeyVal: <Buffer b4 d9 02 15 aa e7 e3 ec 19 29 dd a1 9c a5 4c fb 90 32 ca fa 86 4a 4d 18 c5 e2 0b 6a 6b 0d 19 e9>,
     absValidity: 2018-03-22T00:56:53.000Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 00 a6 fb d1 52 b3 47 95>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 19 0.42105263157894735 1521593872887
connected to auth! from local port 38264
received auth hello!
{ authId: 503, nonce: <Buffer 22 75 d3 49 f9 17 3e 56> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 48 03 f7 08 b4 35 55 76>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300240,
  cipherKeyVal: <Buffer 18 da 1d c9 26 4f 4b 67 9e 8a 19 97 3c 15 67 b0>,
  macKeyVal: <Buffer 8c fa f2 e9 a4 c9 14 c9 69 df b7 92 db da fd b4 c7 a4 d5 f1 d4 61 de e1 38 33 b8 f5 a0 33 12 c6>,
  absValidity: 2018-03-22T00:57:53.089Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 50300240,
     cipherKeyVal: <Buffer 18 da 1d c9 26 4f 4b 67 9e 8a 19 97 3c 15 67 b0>,
     macKeyVal: <Buffer 8c fa f2 e9 a4 c9 14 c9 69 df b7 92 db da fd b4 c7 a4 d5 f1 d4 61 de e1 38 33 b8 f5 a0 33 12 c6>,
     absValidity: 2018-03-22T00:57:53.089Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 4e 4a 12 87 03 d9 4e ce>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 20 0.4 1521593932898
connected to auth! from local port 38526
received auth hello!
{ authId: 503, nonce: <Buffer a9 6d e1 93 42 2e 87 f6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c0 28 1d 91 97 e4 69 b4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300248,
  cipherKeyVal: <Buffer a0 f9 82 12 e2 64 14 4b 34 d5 c0 11 dc 8e 6e 72>,
  macKeyVal: <Buffer 68 27 3e 65 29 73 04 cc d4 65 a7 51 b6 3f 2c 44 52 fa c2 0f be 9c e3 11 2f 07 d5 fd 7e 21 fa 0e>,
  absValidity: 2018-03-22T00:58:53.029Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 50300248,
     cipherKeyVal: <Buffer a0 f9 82 12 e2 64 14 4b 34 d5 c0 11 dc 8e 6e 72>,
     macKeyVal: <Buffer 68 27 3e 65 29 73 04 cc d4 65 a7 51 b6 3f 2c 44 52 fa c2 0f be 9c e3 11 2f 07 d5 fd 7e 21 fa 0e>,
     absValidity: 2018-03-22T00:58:53.029Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 04 e0 93 6f 23 36 b2 02>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 21 0.38095238095238093 1521593992908
connected to auth! from local port 38786
received auth hello!
{ authId: 503, nonce: <Buffer 99 d8 8c d9 a1 b2 4c d2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f5 7a 3e a7 24 9c 6b e2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300256,
  cipherKeyVal: <Buffer f4 5e ea e1 06 93 80 11 7d 06 2c 04 53 50 d5 17>,
  macKeyVal: <Buffer 9b a7 80 de 74 34 ef 78 39 cd 58 6f 2e cd 57 d9 7f e5 0c 27 61 bb 0d 24 04 9a 52 f4 1e 11 88 b8>,
  absValidity: 2018-03-22T00:59:53.159Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 50300256,
     cipherKeyVal: <Buffer f4 5e ea e1 06 93 80 11 7d 06 2c 04 53 50 d5 17>,
     macKeyVal: <Buffer 9b a7 80 de 74 34 ef 78 39 cd 58 6f 2e cd 57 d9 7f e5 0c 27 61 bb 0d 24 04 9a 52 f4 1e 11 88 b8>,
     absValidity: 2018-03-22T00:59:53.159Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer ef 0a 20 8e 78 2d 8f 1f>
switching to HANDSHAKE_1_SENT
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 22 0.36363636363636365 1521594052919
connected to auth! from local port 39044
received auth hello!
{ authId: 503, nonce: <Buffer 5d e7 a9 7c 7c f6 6f d2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fe 2b ba a4 79 25 fb ae>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300264,
  cipherKeyVal: <Buffer 1c d9 86 c6 53 9c 85 68 ee f9 35 35 2c 2c f5 bf>,
  macKeyVal: <Buffer 65 e1 ba 35 83 27 10 b3 0a 20 dd 28 cd ed b0 06 a3 74 d3 a7 3b db 64 cf ed 4d 61 86 52 c0 01 0f>,
  absValidity: 2018-03-22T01:00:53.315Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 50300264,
     cipherKeyVal: <Buffer 1c d9 86 c6 53 9c 85 68 ee f9 35 35 2c 2c f5 bf>,
     macKeyVal: <Buffer 65 e1 ba 35 83 27 10 b3 0a 20 dd 28 cd ed b0 06 a3 74 d3 a7 3b db 64 cf ed 4d 61 86 52 c0 01 0f>,
     absValidity: 2018-03-22T01:00:53.315Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer e4 6a b3 97 9b 8a 70 5d>
switching to HANDSHAKE_1_SENT
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 23 0.34782608695652173 1521594112928
connected to auth! from local port 39302
received auth hello!
{ authId: 503, nonce: <Buffer e1 35 3d 84 cf 0c 69 eb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e9 eb f6 08 56 00 40 bd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300272,
  cipherKeyVal: <Buffer c0 9b d5 24 18 e5 81 49 36 1e 42 e9 d2 30 ff 3c>,
  macKeyVal: <Buffer ff 6a e2 1f 25 00 14 d0 53 f4 34 dc 82 63 af e3 ee 2d f0 21 b4 90 76 f8 54 47 b2 24 bc f7 76 27>,
  absValidity: 2018-03-22T01:01:53.219Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 50300272,
     cipherKeyVal: <Buffer c0 9b d5 24 18 e5 81 49 36 1e 42 e9 d2 30 ff 3c>,
     macKeyVal: <Buffer ff 6a e2 1f 25 00 14 d0 53 f4 34 dc 82 63 af e3 ee 2d f0 21 b4 90 76 f8 54 47 b2 24 bc f7 76 27>,
     absValidity: 2018-03-22T01:01:53.219Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer d3 7b 10 88 6f 10 3d 91>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 24 0.3333333333333333 1521594172939
connected to auth! from local port 39560
received auth hello!
{ authId: 503, nonce: <Buffer 81 8b 02 ab ba 40 4c ad> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 47 b6 7b a5 20 54 f3 03>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300280,
  cipherKeyVal: <Buffer 1b c9 9a 7a c6 00 d9 a6 67 a4 95 c4 84 c7 c8 63>,
  macKeyVal: <Buffer 5e e5 59 0a 91 83 6a 85 4b ea a4 26 af ec 09 35 1a af 87 97 6e 23 42 8e e2 de ad 68 56 7a 25 1e>,
  absValidity: 2018-03-22T01:02:53.101Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 50300280,
     cipherKeyVal: <Buffer 1b c9 9a 7a c6 00 d9 a6 67 a4 95 c4 84 c7 c8 63>,
     macKeyVal: <Buffer 5e e5 59 0a 91 83 6a 85 4b ea a4 26 af ec 09 35 1a af 87 97 6e 23 42 8e e2 de ad 68 56 7a 25 1e>,
     absValidity: 2018-03-22T01:02:53.101Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 5b 57 d7 5a af 4d 5a e9>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 25 0.32 1521594232948
connected to auth! from local port 39820
received auth hello!
{ authId: 503, nonce: <Buffer 9a 27 fa 9b 8f 47 9e 11> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f9 c4 aa 7b 74 1c 86 bd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300288,
  cipherKeyVal: <Buffer 80 aa d0 e9 14 1d cf b7 60 ac d6 8e fb 59 99 b5>,
  macKeyVal: <Buffer 4b e1 ea 1a c3 2e 2c d0 9b 74 10 46 e5 02 fc af 8d 15 ef 4b 50 00 89 8c cc 1b fc 20 b0 37 5d a4>,
  absValidity: 2018-03-22T01:03:53.231Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 50300288,
     cipherKeyVal: <Buffer 80 aa d0 e9 14 1d cf b7 60 ac d6 8e fb 59 99 b5>,
     macKeyVal: <Buffer 4b e1 ea 1a c3 2e 2c d0 9b 74 10 46 e5 02 fc af 8d 15 ef 4b 50 00 89 8c cc 1b fc 20 b0 37 5d a4>,
     absValidity: 2018-03-22T01:03:53.231Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer d0 2a be 9d 10 e3 5f 05>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 26 0.3076923076923077 1521594292957
connected to auth! from local port 40072
received auth hello!
{ authId: 503, nonce: <Buffer 67 bf a0 b3 6f 65 45 20> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c7 27 59 57 1f e3 c3 0f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300296,
  cipherKeyVal: <Buffer b5 e4 b8 77 d1 56 46 fb b8 04 9d 3b 81 7b 3b 46>,
  macKeyVal: <Buffer 48 03 3e f0 1e a9 64 e2 c4 58 c9 77 f9 83 b1 81 ac ca 23 bc 34 a5 e9 89 a6 1d 93 fd 57 3f 32 ab>,
  absValidity: 2018-03-22T01:04:53.159Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 50300296,
     cipherKeyVal: <Buffer b5 e4 b8 77 d1 56 46 fb b8 04 9d 3b 81 7b 3b 46>,
     macKeyVal: <Buffer 48 03 3e f0 1e a9 64 e2 c4 58 c9 77 f9 83 b1 81 ac ca 23 bc 34 a5 e9 89 a6 1d 93 fd 57 3f 32 ab>,
     absValidity: 2018-03-22T01:04:53.159Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer ff b9 07 c3 07 87 f4 cb>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 27 0.2962962962962963 1521594352965
connected to auth! from local port 40320
received auth hello!
{ authId: 503, nonce: <Buffer 4e fa 33 5c 30 ea fb 3c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d4 de ef 77 3d b0 91 08>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300304,
  cipherKeyVal: <Buffer 48 33 3a 26 21 67 54 2a 9f 22 51 d4 5a a8 bc 7f>,
  macKeyVal: <Buffer 16 b6 4d 42 2d 00 9e 70 6a dc d2 70 f7 e8 21 75 c2 f1 dc f4 e5 29 6f 68 1f 46 d5 b4 6c 8f 1a 64>,
  absValidity: 2018-03-22T01:05:53.124Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 50300304,
     cipherKeyVal: <Buffer 48 33 3a 26 21 67 54 2a 9f 22 51 d4 5a a8 bc 7f>,
     macKeyVal: <Buffer 16 b6 4d 42 2d 00 9e 70 6a dc d2 70 f7 e8 21 75 c2 f1 dc f4 e5 29 6f 68 1f 46 d5 b4 6c 8f 1a 64>,
     absValidity: 2018-03-22T01:05:53.124Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 15 dc 9b 2d c0 23 01 e8>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 28 0.2857142857142857 1521594412975
connected to auth! from local port 40572
received auth hello!
{ authId: 503, nonce: <Buffer b0 ca be e1 3a 1d 5d 26> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c2 5d 7f 4c c5 be 56 0e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300312,
  cipherKeyVal: <Buffer 8d f4 c7 ab 64 96 14 9c 00 d3 6b 6e a5 24 2c 16>,
  macKeyVal: <Buffer 8b f8 33 49 9a 6f 8b c6 f8 d0 da e6 48 86 9b 11 19 7c d5 fe 3d a0 c1 bb c4 28 92 81 8d 46 cc 39>,
  absValidity: 2018-03-22T01:06:53.138Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 50300312,
     cipherKeyVal: <Buffer 8d f4 c7 ab 64 96 14 9c 00 d3 6b 6e a5 24 2c 16>,
     macKeyVal: <Buffer 8b f8 33 49 9a 6f 8b c6 f8 d0 da e6 48 86 9b 11 19 7c d5 fe 3d a0 c1 bb c4 28 92 81 8d 46 cc 39>,
     absValidity: 2018-03-22T01:06:53.138Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 47 f8 26 c1 59 9c a8 e9>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
