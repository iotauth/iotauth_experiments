changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s410.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's410',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 76 6a ... > }
Handler: listening on port 22100
s410:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200200
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47710
received auth hello!
{ authId: 402, nonce: <Buffer 1a 9c 35 6d d0 c1 5c a4> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 42 71 c3 ff 9e 27 c9 ab>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 68 cc f8 64 e0 f4 23 19 c6 ff 1a d9 4e 13 51 ed>,
  macKeyVal: <Buffer a1 2b 83 d6 ba 19 02 bb 30 bf 97 0b 1c a3 96 6c d6 1d 2e f9 29 ba ba db 0c 56 dc 94 5a 11 6f 61>,
  absValidity: 2018-03-21T01:40:07.498Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3f 9f 45 d1 22 24 80 1d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 3f 9f 45 d1 22 24 80 1d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.53:50374',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200207
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47884
received auth hello!
{ authId: 402, nonce: <Buffer c4 ff b3 db b7 a3 c2 df> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4a 6c a0 44 04 5a b6 68>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b8 d5 44 26 89 13 34 3f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b8 d5 44 26 89 13 34 3f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.53:50548',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200214
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48156
received auth hello!
{ authId: 402, nonce: <Buffer 57 12 aa c4 ee 08 90 1d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 52 c1 55 d9 e3 22 27 33>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 93 1f 30 be c1 a6 b1 25>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 93 1f 30 be c1 a6 b1 25> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.53:50820',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200221
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48426
received auth hello!
{ authId: 402, nonce: <Buffer 48 5b 39 39 f4 04 f0 14> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 88 c7 ff ec c2 ee 98 f1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 19 22 c4 7c 24 9a 84 8a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 19 22 c4 7c 24 9a 84 8a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.53:51090',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200228
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48696
received auth hello!
{ authId: 402, nonce: <Buffer 21 c1 b1 d6 e1 94 86 c9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 45 48 a6 af fa 5e f5 e3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4b e8 ef 54 81 f3 6d e8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4b e8 ef 54 81 f3 6d e8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.53:51360',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200235
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48966
received auth hello!
{ authId: 402, nonce: <Buffer 70 e9 49 11 a0 61 65 ff> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 36 e4 9e 44 12 5b d9 6f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 50 9c b3 45 59 f8 60 2b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 50 9c b3 45 59 f8 60 2b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.53:51630',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200242
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49236
received auth hello!
{ authId: 402, nonce: <Buffer 6d a6 82 16 3e 88 5e e6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b7 62 e7 ed 4a d7 79 22>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 11 bb 3a 4d f0 a9 9e 6b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 11 bb 3a 4d f0 a9 9e 6b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.53:51900',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200249
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49502
received auth hello!
{ authId: 402, nonce: <Buffer 9f 13 41 0b 8c 13 5e 2d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 24 74 5d 83 90 67 a9 07>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 16 64 b0 72 10 98 79 11>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 16 64 b0 72 10 98 79 11> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.53:52166',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
