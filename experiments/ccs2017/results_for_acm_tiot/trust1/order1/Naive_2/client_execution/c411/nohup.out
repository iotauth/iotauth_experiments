changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c411.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c411',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 67 49 42 41 41 4b 43 41 51 45 41 77 62 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521569552507
connected to auth! from local port 55614
received auth hello!
{ authId: 402, nonce: <Buffer 2c 12 9d 7d b8 bb 90 11> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 05 8a 6d a7 a1 32 ca d8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 66 88 a5 7f f7 f4 90 23 0b 16 eb ff 54 2a de 5a>,
  macKeyVal: <Buffer 64 64 d6 7b 7e e7 8e 34 28 1a 5c 23 ce 99 b9 60 a3 92 4e 90 5e 3b e2 7f 00 a6 73 9d 91 fd cb 7f>,
  absValidity: 2018-03-20T19:12:32.802Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200200,
  cipherKeyVal: <Buffer b9 dd 34 95 5d e5 e8 3c 3f 81 cc ce c1 8a 2d f0>,
  macKeyVal: <Buffer ec a5 00 08 e3 89 06 c9 7b 13 5e 1f b6 09 5c 4b 8c 68 76 6a 75 75 2a 95 8d 63 41 ec cb 7d f0 bc>,
  absValidity: 2018-03-21T18:12:32.802Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.17',
  serverPort: 22100,
  sessionKey: 
   { id: 40200200,
     cipherKeyVal: <Buffer b9 dd 34 95 5d e5 e8 3c 3f 81 cc ce c1 8a 2d f0>,
     macKeyVal: <Buffer ec a5 00 08 e3 89 06 c9 7b 13 5e 1f b6 09 5c 4b 8c 68 76 6a 75 75 2a 95 8d 63 41 ec cb 7d f0 bc>,
     absValidity: 2018-03-21T18:12:32.802Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer e2 5d 92 61 48 f4 92 c1>
switching to HANDSHAKE_1_SENT
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 18:12:34 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521569555221
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521569612562
connected to auth! from local port 55788
received auth hello!
{ authId: 402, nonce: <Buffer b6 04 9c 4a 27 06 6f 1c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 76 87 6b f2 84 17 8e 26>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200207,
  cipherKeyVal: <Buffer a0 31 ac a6 87 bc 84 b2 32 62 cd c4 d6 2e 82 9b>,
  macKeyVal: <Buffer 52 c7 63 be 0b 8e 48 a0 f7 43 ed 6f e1 3d 98 af d3 28 09 59 b5 3b 55 1a c4 9e c5 48 2e 04 98 b6>,
  absValidity: 2018-03-21T18:13:32.850Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.17',
  serverPort: 22100,
  sessionKey: 
   { id: 40200207,
     cipherKeyVal: <Buffer a0 31 ac a6 87 bc 84 b2 32 62 cd c4 d6 2e 82 9b>,
     macKeyVal: <Buffer 52 c7 63 be 0b 8e 48 a0 f7 43 ed 6f e1 3d 98 af d3 28 09 59 b5 3b 55 1a c4 9e c5 48 2e 04 98 b6>,
     absValidity: 2018-03-21T18:13:32.850Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 0e 08 9a 76 6a e6 40 54>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 18:13:34 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521569615521
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521569672617
connected to auth! from local port 56058
received auth hello!
{ authId: 402, nonce: <Buffer 12 7f 0c 9d 3f 25 48 19> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 03 ad 66 5d 01 1f d1 98>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200214,
  cipherKeyVal: <Buffer 87 65 60 98 d1 2a 16 0f 56 ca b0 a2 5c 66 dc f8>,
  macKeyVal: <Buffer 31 71 ae dc f9 a0 64 b0 b5 e6 71 0e 2f 6c 39 a6 c0 54 27 c6 5e b9 65 9c 20 4c f5 08 49 a5 5a 37>,
  absValidity: 2018-03-21T18:14:32.902Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.17',
  serverPort: 22100,
  sessionKey: 
   { id: 40200214,
     cipherKeyVal: <Buffer 87 65 60 98 d1 2a 16 0f 56 ca b0 a2 5c 66 dc f8>,
     macKeyVal: <Buffer 31 71 ae dc f9 a0 64 b0 b5 e6 71 0e 2f 6c 39 a6 c0 54 27 c6 5e b9 65 9c 20 4c f5 08 49 a5 5a 37>,
     absValidity: 2018-03-21T18:14:32.902Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 6e 4f 9f 19 53 23 95 58>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 18:14:35 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521569675558
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521569732658
connected to auth! from local port 56328
received auth hello!
{ authId: 402, nonce: <Buffer 47 80 1e b9 4b dd 78 fb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f4 e4 1e 15 94 6e 0e 27>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200221,
  cipherKeyVal: <Buffer df 50 e4 f0 ff ef f4 52 c4 06 b8 6b 8c a4 1c be>,
  macKeyVal: <Buffer eb d2 10 ec 47 74 c8 20 eb 3b c5 22 d4 8d 6c c7 80 25 4e 92 c6 c9 f3 a2 27 bf d8 bd 22 18 ec 8d>,
  absValidity: 2018-03-21T18:15:32.980Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.17',
  serverPort: 22100,
  sessionKey: 
   { id: 40200221,
     cipherKeyVal: <Buffer df 50 e4 f0 ff ef f4 52 c4 06 b8 6b 8c a4 1c be>,
     macKeyVal: <Buffer eb d2 10 ec 47 74 c8 20 eb 3b c5 22 d4 8d 6c c7 80 25 4e 92 c6 c9 f3 a2 27 bf d8 bd 22 18 ec 8d>,
     absValidity: 2018-03-21T18:15:32.980Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 85 b1 8c 21 2d 06 15 05>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 18:15:35 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521569735638
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521569792713
connected to auth! from local port 56598
received auth hello!
{ authId: 402, nonce: <Buffer e0 34 ea 8e 46 02 d3 13> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fd f1 66 b7 2b 62 33 12>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200228,
  cipherKeyVal: <Buffer f6 d8 a1 fa 42 f7 f3 05 af e6 62 e4 4f 22 54 c1>,
  macKeyVal: <Buffer 8f 80 38 0b 17 71 a5 74 47 63 17 9b 4e 56 a8 4d 9e ad de 71 36 75 7a 8d 36 64 54 e6 71 3d 75 3f>,
  absValidity: 2018-03-21T18:16:33.010Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.17',
  serverPort: 22100,
  sessionKey: 
   { id: 40200228,
     cipherKeyVal: <Buffer f6 d8 a1 fa 42 f7 f3 05 af e6 62 e4 4f 22 54 c1>,
     macKeyVal: <Buffer 8f 80 38 0b 17 71 a5 74 47 63 17 9b 4e 56 a8 4d 9e ad de 71 36 75 7a 8d 36 64 54 e6 71 3d 75 3f>,
     absValidity: 2018-03-21T18:16:33.010Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 17 cb 65 c5 c9 01 dc fd>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 18:16:35 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521569795559
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521569852769
connected to auth! from local port 56868
received auth hello!
{ authId: 402, nonce: <Buffer 31 e3 08 18 8c 42 e6 d7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0e a2 09 55 53 45 4e 20>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200235,
  cipherKeyVal: <Buffer c5 f7 a4 f2 a4 e1 38 ae 6a e4 e8 3a 44 ce e7 38>,
  macKeyVal: <Buffer 86 4e d5 ee a8 31 74 71 5c ed e6 c3 d3 d7 b7 a1 60 45 a0 9f 6d df 5f 46 39 e9 d2 2c e9 1b bf 48>,
  absValidity: 2018-03-21T18:17:33.078Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.17',
  serverPort: 22100,
  sessionKey: 
   { id: 40200235,
     cipherKeyVal: <Buffer c5 f7 a4 f2 a4 e1 38 ae 6a e4 e8 3a 44 ce e7 38>,
     macKeyVal: <Buffer 86 4e d5 ee a8 31 74 71 5c ed e6 c3 d3 d7 b7 a1 60 45 a0 9f 6d df 5f 46 39 e9 d2 2c e9 1b bf 48>,
     absValidity: 2018-03-21T18:17:33.078Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 52 4c 8e 9a 3c 08 f3 df>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 18:17:35 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521569855541
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521569912772
connected to auth! from local port 57138
received auth hello!
{ authId: 402, nonce: <Buffer 7d c4 19 94 4c 16 8a 3b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6c f1 33 a8 a2 44 2d 39>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200242,
  cipherKeyVal: <Buffer 7f 5c 9d d2 5d 57 0f 4b e1 65 ca c1 1c 30 e8 c6>,
  macKeyVal: <Buffer 9d e2 8f 23 78 67 c2 5b 55 fb ec 0d fb bc 0a d2 b5 0e 05 66 de 12 a3 10 80 70 79 34 ca 6d df a7>,
  absValidity: 2018-03-21T18:18:33.126Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.17',
  serverPort: 22100,
  sessionKey: 
   { id: 40200242,
     cipherKeyVal: <Buffer 7f 5c 9d d2 5d 57 0f 4b e1 65 ca c1 1c 30 e8 c6>,
     macKeyVal: <Buffer 9d e2 8f 23 78 67 c2 5b 55 fb ec 0d fb bc 0a d2 b5 0e 05 66 de 12 a3 10 80 70 79 34 ca 6d df a7>,
     absValidity: 2018-03-21T18:18:33.126Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 27 af f9 9f db 3a b6 f2>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 18:18:35 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521569915665
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521569972781
connected to auth! from local port 57404
received auth hello!
{ authId: 402, nonce: <Buffer 1a 7e 09 cd 0c f3 29 26> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ea 3f 64 4d 02 41 dc b0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200249,
  cipherKeyVal: <Buffer 47 46 c4 17 99 1a ec cf 2d 18 43 90 b1 9e 90 c0>,
  macKeyVal: <Buffer 01 0b 1a d0 06 dc c7 a9 26 44 d0 4b 6d ef 29 3c 22 bc 12 dd 09 74 82 30 e8 57 cb 0c 84 c6 76 9b>,
  absValidity: 2018-03-21T18:19:33.184Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.17',
  serverPort: 22100,
  sessionKey: 
   { id: 40200249,
     cipherKeyVal: <Buffer 47 46 c4 17 99 1a ec cf 2d 18 43 90 b1 9e 90 c0>,
     macKeyVal: <Buffer 01 0b 1a d0 06 dc c7 a9 26 44 d0 4b 6d ef 29 3c 22 bc 12 dd 09 74 82 30 e8 57 cb 0c 84 c6 76 9b>,
     absValidity: 2018-03-21T18:19:33.184Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 86 ed e9 df b0 f5 be 0f>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 18:19:35 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 8 1 1521569975692
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 9 0.8888888888888888 1521570032839
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 10 0.8 1521570092849
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 47614
received auth hello!
{ authId: 502, nonce: <Buffer b0 eb 51 39 36 70 80 c6> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 11 0.7272727272727273 1521570152853
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 47862
received auth hello!
{ authId: 502, nonce: <Buffer 27 96 aa 0a 6a 22 9c 6b> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 12 0.6666666666666666 1521570212864
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 41126
received auth hello!
{ authId: 501, nonce: <Buffer b2 00 28 d6 ed a6 3d 24> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 13 0.6153846153846154 1521570272874
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 41374
received auth hello!
{ authId: 501, nonce: <Buffer 99 44 ae 45 e5 e3 8c c5> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 14 0.5714285714285714 1521570332884
failure in connection with Auth : authFailureCount: 6
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 59834
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 15 0.5333333333333333 1521570392891
failure in connection with Auth : authFailureCount: 7
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 60086
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 16 0.5 1521570452893
failure in connection with Auth : authFailureCount: 8
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 2
to: 3
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 42450
received auth hello!
{ authId: 403, nonce: <Buffer c8 f6 c2 74 74 92 ed 57> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 17 0.47058823529411764 1521570512902
failure in connection with Auth : authFailureCount: 9
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 42708
received auth hello!
{ authId: 403, nonce: <Buffer 04 f5 30 85 79 b9 0a 7c> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 18 0.4444444444444444 1521570572913
failure in connection with Auth : authFailureCount: 10
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 3
to: 4
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 54958
received auth hello!
{ authId: 503, nonce: <Buffer e1 7b 1e 58 5c 18 00 05> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth503',
     commonName: '10.0.1.6' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth402',
     commonName: '10.0.0.2' },
  serial: '0162449B557E',
  notBefore: 2018-03-20T18:09:13.000Z,
  notAfter: 2018-03-21T18:10:53.000Z,
  subjectHash: '5542437f',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '3C:AA:C7:02:26:ED:A0:5F:E6:73:73:C6:D1:0C:84:E7:C9:3A:0D:90',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'DE5B30AA46CAB50E9EB99610D7CD6F5A13A506E423E0B2FA7E5B5516308134D5EBA5029E1E86687304DE74F1EDC282AFF2BDBD5A1EEA4AB5A9C11B58BE559B6581427760281F7D05FB35B0241357C06845115CC2742374425A859E0CF161E9E28FB5DADEF2AD5312533F095CB0709A99F829AD0B3B1B19C8FB4E17DFB5D85CE6E65EA745001E8C0CC8AC5A752E195090E212D1563BE34185B3211F90F9135C8AD962B139057D6E600CF5797302C942DB7EEA5A0963E1105D1B46C227E6B60D0B1D7EF08EA4E9BE1220E5269AD51AB8E328F18D2AC5A2F47D0508AD6101DC087A6295158FC3BEDA4B4CD32EC8D3E6E2F67DC2962059753EE1281A41E463966327',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.6' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 503,
  host: '10.0.1.6',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJEm1V+MA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDIxETAPBgNVBAMMCDEwLjAuMC4yMB4XDTE4MDMy\nMDE4MDkxM1oXDTE4MDMyMTE4MTA1M1owYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMzERMA8GA1UEAwwIMTAuMC4xLjYwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDeWzCqRsq1Dp65lhDXzW9aE6UG5CPgsvp+W1UWMIE01eulAp4e\nhmhzBN508e3Cgq/yvb1aHupKtanBG1i+VZtlgUJ3YCgffQX7NbAkE1fAaEURXMJ0\nI3RCWoWeDPFh6eKPtdre8q1TElM/CVywcJqZ+CmtCzsbGcj7Thfftdhc5uZep0UA\nHowMyKxadS4ZUJDiEtFWO+NBhbMhH5D5E1yK2WKxOQV9bmAM9XlzAslC237qWglj\n4RBdG0bCJ+a2DQsdfvCOpOm+EiDlJprVGrjjKPGNKsWi9H0FCK1hAdwIemKVFY/D\nvtpLTNMuyNPm4vZ9wpYgWXU+4SgaQeRjlmMnAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQYwDQYJKoZIhvcNAQELBQADggEBABVb9rf2T3ft1bpaAmDr3eb+nODoWvrl\nXeJ5EgDA8Tpf2+eYByrKYmPxgGjcPaX5mRpCJy2/5oxWG4dQe1Ex2GrL7sJ78NGA\nCkkOlFkzqQ4KITkc3qJ2TpvRF1wNr0tf7phZuv5KgZdE7qG3W34k5nsYMp/Qe08s\nNJHEkXjQ/Tstt2eMlC72TUJL6n25leowJ7RZrF8lDynOdYUp+gRVkiCNMev4hl9n\nfpfx31jALYqVFON0s6E9mI/o8vJM+1vpTZX0/K4gUZIqtcKKDwjaBUHuX/EB9sk5\ntsi9w9TZ14XNc2ct+YrJzhUNtzy9XBNRzpkyOd4CPoPtE7vRcVKZ9Us=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 4
to: 5
disconnected from auth
/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902
            eventHandlers.onError('Error occurred in migration request: Disconnected from auth before getting migration response: ' + error);
                                                                                                                                      ^

ReferenceError: error is not defined
    at Socket.<anonymous> (/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902:135)
    at emitNone (events.js:91:20)
    at Socket.emit (events.js:188:7)
    at endReadableNT (_stream_readable.js:975:12)
    at _combinedTickCallback (internal/process/next_tick.js:80:11)
    at process._tickCallback (internal/process/next_tick.js:104:9)
