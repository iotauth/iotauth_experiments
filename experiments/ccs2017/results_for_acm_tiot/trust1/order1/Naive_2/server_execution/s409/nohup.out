changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s409.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's409',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 79 64 ... > }
Handler: listening on port 22100
s409:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200202
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56396
received auth hello!
{ authId: 402, nonce: <Buffer 3f 70 79 e2 03 b6 0c 25> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 3d 73 bf a9 1a 10 30 e5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 17 00 3e 65 f2 95 d1 5d 02 05 87 40 54 ec a8 a2>,
  macKeyVal: <Buffer de 6a fc 29 00 a6 7c eb 70 ca 60 2c 3c 18 47 5e 96 af b0 ef 8d 4d a8 a2 dd 61 9d f2 57 0b e6 1a>,
  absValidity: 2018-03-20T19:12:42.836Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a6 42 94 8e 30 61 75 a8>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer a6 42 94 8e 30 61 75 a8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.55:45564',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200209
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56582
received auth hello!
{ authId: 402, nonce: <Buffer 4b a6 22 85 76 29 60 1b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1a e6 19 9c 46 37 a7 cb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8d 17 97 47 ee c2 be 59>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 8d 17 97 47 ee c2 be 59> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.55:45750',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200216
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56852
received auth hello!
{ authId: 402, nonce: <Buffer b6 31 75 b0 57 cd 2c 4c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b5 fa 4b a4 3c a7 d4 69>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3a 82 cf 7e f2 6f 23 2a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3a 82 cf 7e f2 6f 23 2a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.55:46020',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200223
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57122
received auth hello!
{ authId: 402, nonce: <Buffer 9d cc 7f 1b 2a 2c b4 6a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3d 71 60 00 5f 3a 24 95>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cf 84 8b ac 75 fe c7 4d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer cf 84 8b ac 75 fe c7 4d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.55:46290',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200230
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57392
received auth hello!
{ authId: 402, nonce: <Buffer 79 75 85 69 12 1f 2d c5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2b 95 bb 0c 1d 3f 99 1c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 32 fa e0 60 12 9d 5c d1>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 32 fa e0 60 12 9d 5c d1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.55:46560',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200237
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57662
received auth hello!
{ authId: 402, nonce: <Buffer 2b 06 07 61 0e f2 7e 62> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 54 2f 68 e8 8e b4 9e 08>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a4 8e 7d 59 ba 90 76 2f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a4 8e 7d 59 ba 90 76 2f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.55:46830',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200244
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57932
received auth hello!
{ authId: 402, nonce: <Buffer cf 73 99 59 d4 8e 70 77> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f6 f9 98 66 02 64 5e f1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bd c7 b6 1b 83 14 41 a4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bd c7 b6 1b 83 14 41 a4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.55:47100',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
