changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s406.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's406',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 7a 42 ... > }
Handler: listening on port 22100
s406:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200197
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 32858
received auth hello!
{ authId: 402, nonce: <Buffer 3f 89 b8 4c 77 d1 64 e2> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 98 2e 3f 6d 36 8a d4 61>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 94 37 89 ba c7 ca a3 73 f6 38 60 f7 ea 6b 09 0f>,
  macKeyVal: <Buffer be 84 39 fd 6a 47 18 09 e9 12 7a f6 02 3c 54 a5 cc 21 28 63 1c 34 b6 4f a3 ee f9 e3 4f 13 97 71>,
  absValidity: 2018-03-20T19:12:23.505Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 20 dc 61 e8 17 1d 5a 7b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 20 dc 61 e8 17 1d 5a 7b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.50:47706',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200204
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33014
received auth hello!
{ authId: 402, nonce: <Buffer de a5 ac 84 92 bc 73 18> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 13 1c 58 5e 73 8b 1b 33>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b7 b7 67 f3 5a 02 6e 3e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b7 b7 67 f3 5a 02 6e 3e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.50:47862',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200211
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33274
received auth hello!
{ authId: 402, nonce: <Buffer 36 b2 f5 18 4f 05 94 ae> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1d 51 2f 3a 66 2a 86 80>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9c 35 20 81 94 76 b3 de>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9c 35 20 81 94 76 b3 de> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.50:48122',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200218
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33544
received auth hello!
{ authId: 402, nonce: <Buffer 6c 98 f8 49 9d 0a 4b 83> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 99 5f 71 ca 44 c9 86 db>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ac 0a ff ae 56 2f e5 31>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ac 0a ff ae 56 2f e5 31> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.50:48392',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200225
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33814
received auth hello!
{ authId: 402, nonce: <Buffer 24 64 e7 c2 57 06 b8 53> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bb b8 ca 0e 93 97 34 6a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f4 98 b1 4b 57 28 a9 3b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f4 98 b1 4b 57 28 a9 3b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.50:48662',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200232
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34084
received auth hello!
{ authId: 402, nonce: <Buffer e4 be 67 b3 34 3b 0c 28> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 06 9c 3c 29 62 5c dc a3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 10 df fc 81 59 88 c5 a4>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 10 df fc 81 59 88 c5 a4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.50:48932',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200239
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34354
received auth hello!
{ authId: 402, nonce: <Buffer 08 dc 56 d3 4c 87 f4 63> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0c fb 45 42 c3 2b 41 1d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c4 6d 9b 9a 0b 27 b5 07>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c4 6d 9b 9a 0b 27 b5 07> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.50:49202',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200246
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34624
received auth hello!
{ authId: 402, nonce: <Buffer 54 35 76 23 c4 37 d3 06> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5a c4 d1 4b 66 97 ab bf>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 15 1d 78 54 ed c9 4a c2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 15 1d 78 54 ed c9 4a c2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.50:49472',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
