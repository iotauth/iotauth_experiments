changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s410.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's410',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 35 5a ... > }
Handler: listening on port 22100
s410:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200255
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37742
received auth hello!
{ authId: 402, nonce: <Buffer 7b f4 c2 7b dd 7f e6 64> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 32 68 b8 72 a9 3d 72 e8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 83 28 57 4b e4 ed 59 4a 8e 17 cc 96 b3 0b cb 20>,
  macKeyVal: <Buffer e4 27 be f5 be fc 49 e7 f6 70 e7 06 22 83 50 4a 77 99 69 24 6f fc 05 bf 7b d3 3f 29 bc 5c bc 4c>,
  absValidity: 2018-03-21T06:47:29.765Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f8 d9 8d 44 77 bb 32 dc>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f8 d9 8d 44 77 bb 32 dc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.53:40406',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200262
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37916
received auth hello!
{ authId: 402, nonce: <Buffer 16 f4 37 90 a6 16 9f 83> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9d 45 9a 29 cf 27 a5 fd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6a 03 4c 27 ba f8 31 82>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6a 03 4c 27 ba f8 31 82> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.53:40580',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200269
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38188
received auth hello!
{ authId: 402, nonce: <Buffer a5 2c cd d2 de 8b fa 9d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e8 6a 02 0b f6 90 68 a2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e8 a4 73 12 97 aa 27 b7>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e8 a4 73 12 97 aa 27 b7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.53:40852',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200276
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38458
received auth hello!
{ authId: 402, nonce: <Buffer 09 f8 46 d6 18 ec ac 3b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fd 58 aa c5 5b e0 a4 18>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7f 42 ef 36 a2 0f 37 a0>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 7f 42 ef 36 a2 0f 37 a0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.53:41122',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200283
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38728
received auth hello!
{ authId: 402, nonce: <Buffer 9b bc 59 6e b2 85 e6 2f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 46 a3 5d b8 05 1a 41 42>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 51 4e 69 12 1e 11 8c 0d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 51 4e 69 12 1e 11 8c 0d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.53:41392',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200290
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38998
received auth hello!
{ authId: 402, nonce: <Buffer 6a bd 22 b1 70 d2 ff 03> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 88 8e 59 8c f0 73 e1 9d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e2 e3 8e 96 e0 b2 e1 66>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e2 e3 8e 96 e0 b2 e1 66> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.53:41662',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200297
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39268
received auth hello!
{ authId: 402, nonce: <Buffer e7 c3 b2 24 13 63 b8 51> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 18 fc 4d 0b 0f 33 0c c1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 72 c0 15 9a 6c 28 d1 b4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 72 c0 15 9a 6c 28 d1 b4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.53:41932',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200304
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39538
received auth hello!
{ authId: 402, nonce: <Buffer 85 46 ca 5e 1a b1 52 97> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a3 d1 5b 01 22 75 5c c8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f7 29 71 e6 db 47 5a 05>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f7 29 71 e6 db 47 5a 05> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.53:42202',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300419
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300429
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 48240
received auth hello!
{ authId: 503, nonce: <Buffer fa 4e 8f 61 47 a7 ce 97> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth503',
     commonName: '10.0.1.6' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth402',
     commonName: '10.0.0.2' },
  serial: '016247178A17',
  notBefore: 2018-03-21T05:44:07.000Z,
  notAfter: 2018-03-22T05:45:47.000Z,
  subjectHash: '5542437f',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '97:6A:EB:00:59:68:A7:AD:3E:4D:FE:A9:B6:2A:E9:0B:40:D1:1C:A5',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'E2C77ADB548D185210E7FA2988369325521D9CF6957B61D640674333307D4FC133154B2C56A9BBCE5655BEDE59A620D2F68A660E6DEB43308DBAFD7A396559B1C6BD0ED769D2F4066CEB2BFDB38188C4D295C06D196ECCC621767B060A3D3BCF3CF4458D7031B2D0AB66B8846DD9C1D4374DEB5D3E30D68FF926574682526527828E3BB232E36626859A826F5DA69748C9567F01930811E1C310842AAE799D7FAD1E9BE8B5D23DC0BC0D4537FC44D1FE7D84E57938DEE6D651DAEC8C897885315FE2797FFB87939E2A342186F4C566B1623BD369CC0226678E3A96E9092471F81CCC14C868DBEA8B6F0B2E5D566294136E91C2B3B101366D8A5B6642614F0CF5',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.6' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 503,
  host: '10.0.1.6',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJHF4oXMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDIxETAPBgNVBAMMCDEwLjAuMC4yMB4XDTE4MDMy\nMTA1NDQwN1oXDTE4MDMyMjA1NDU0N1owYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMzERMA8GA1UEAwwIMTAuMC4xLjYwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDix3rbVI0YUhDn+imINpMlUh2c9pV7YdZAZ0MzMH1PwTMVSyxW\nqbvOVlW+3lmmINL2imYObetDMI26/Xo5ZVmxxr0O12nS9AZs6yv9s4GIxNKVwG0Z\nbszGIXZ7Bgo9O8889EWNcDGy0KtmuIRt2cHUN03rXT4w1o/5JldGglJlJ4KOO7Iy\n42YmhZqCb12ml0jJVn8BkwgR4cMQhCqueZ1/rR6b6LXSPcC8DUU3/ETR/n2E5Xk4\n3ubWUdrsjIl4hTFf4nl/+4eTnio0IYb0xWaxYjvTacwCJmeOOpbpCSRx+BzMFMho\n2+qLbwsuXVZilBNukcKzsQE2bYpbZkJhTwz1AgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQYwDQYJKoZIhvcNAQELBQADggEBAA/U/UVNfOzcZdQ4pbV0bQtut9dEjxAx\ncBdXIcek+LysVIqObTpGi6pUEEF1P0V34ZeG779l+UhbUait5Cogb6R7lbHaKd7u\nM8gQ6aEZC2Q9zcTdgcFdipvEOp4/dq1np/uMCvOKzMVKLq1ULUzJDW+khQpSMtXS\n+loQUQ8u8mPCThX6qGCIxWql7Wy9hpilNrjpIllsor6/dMwxTDay34eFuQZpjdIh\nMFbZmrZsKpozITMxto06zaaghRZ3Arq+G3hYzBCTBMkj3Ux105DwofMTuwbFSmmo\nvIxq8zKdoF3wWT38DGdwfc9+Q4A5iMb6NdewuGVDngexeQST7xpSnZs=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300439
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48496
received auth hello!
{ authId: 503, nonce: <Buffer 20 b0 83 df 4d f0 d2 d3> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer ed 4b bc f1 06 c7 98 06>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 93 1a 3f 87 e4 ef c2 21 76 12 70 8b db d2 0f 1d>,
  macKeyVal: <Buffer 68 2e 6b 6b d4 99 06 6b b7 8b 7c 88 34 15 14 f4 8e 16 72 2a ca ef 70 cb 58 01 5a 34 14 20 50 c6>,
  absValidity: 2018-03-21T06:59:29.588Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 70 16 ce a8 da 16 8e 1d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 70 16 ce a8 da 16 8e 1d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.53:43450',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300449
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48762
received auth hello!
{ authId: 503, nonce: <Buffer 78 b8 36 76 66 18 93 f1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 81 ec 41 47 2e 35 c5 09>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 20 9a d1 28 11 ba d2 2a>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 20 9a d1 28 11 ba d2 2a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.53:43716',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300459
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49028
received auth hello!
{ authId: 503, nonce: <Buffer 0a 11 10 1a 14 77 aa 7e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 95 f4 f2 91 60 f7 b6 a2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6b f5 86 06 33 86 6e c3>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 6b f5 86 06 33 86 6e c3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.53:43982',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300469
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49294
received auth hello!
{ authId: 503, nonce: <Buffer 13 fe 0e 6f bf 46 18 a0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 12 12 2f 3e 16 79 90 13>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e6 ce 59 e9 2d f2 7c 39>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e6 ce 59 e9 2d f2 7c 39> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.53:44248',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300479
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49560
received auth hello!
{ authId: 503, nonce: <Buffer 3b ed 3e aa 1f a7 5d f3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2f 47 90 32 56 71 63 d6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 73 6e e1 3c 05 57 a1 b1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 73 6e e1 3c 05 57 a1 b1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.53:44514',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300489
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49826
received auth hello!
{ authId: 503, nonce: <Buffer e8 bd 36 2d 8e 54 dd fc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d4 df c4 73 23 fa c4 72>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 13 40 f7 95 97 db 1c 9e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 13 40 f7 95 97 db 1c 9e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.53:44780',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300499
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50092
received auth hello!
{ authId: 503, nonce: <Buffer 87 e7 70 4c 15 a8 35 4e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fe b5 33 ed 64 ed ff 76>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c5 77 91 12 ef 3e ea 42>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c5 77 91 12 ef 3e ea 42> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.53:45046',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300509
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50358
received auth hello!
{ authId: 503, nonce: <Buffer a3 23 da 1c eb 48 cb 16> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2e 2d 4a ee 14 74 5a 25>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 53 ad 80 75 7e 7c b2 7e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 53 ad 80 75 7e 7c b2 7e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.53:45312',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300519
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50624
received auth hello!
{ authId: 503, nonce: <Buffer 14 55 f8 bb 6f a0 7f eb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 48 c2 72 37 ac 18 e8 62>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e3 64 f3 45 62 68 a7 6c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e3 64 f3 45 62 68 a7 6c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.53:45578',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300529
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50890
received auth hello!
{ authId: 503, nonce: <Buffer 52 bb ff 7e a5 24 85 0f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e0 56 31 c5 40 b9 e1 c6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f3 dd 3c 7c f9 32 61 bb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f3 dd 3c 7c f9 32 61 bb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.53:45844',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300539
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51156
received auth hello!
{ authId: 503, nonce: <Buffer f0 12 bc e5 9b d1 96 5d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e6 d2 26 72 99 81 c0 b0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7a c6 39 90 ae 88 67 ac>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 7a c6 39 90 ae 88 67 ac> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.53:46110',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300549
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51422
received auth hello!
{ authId: 503, nonce: <Buffer bc 2e c7 d5 b6 60 29 24> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 56 f7 53 9a 71 f7 b9 d4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bd 96 ea 02 c9 1d 6c 3c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bd 96 ea 02 c9 1d 6c 3c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.53:46376',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300559
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51688
received auth hello!
{ authId: 503, nonce: <Buffer 81 3d 6c 69 29 c5 3e 47> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 93 01 b4 84 43 d2 53 26>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8b d9 0a 0b a8 09 58 c0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8b d9 0a 0b a8 09 58 c0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.53:46642',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300569
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51954
received auth hello!
{ authId: 503, nonce: <Buffer fd 8e 53 8b 6f 58 86 ea> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 28 a6 22 49 1f 7f fb c9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3e ec 96 50 dd 07 72 ad>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 3e ec 96 50 dd 07 72 ad> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.53:46908',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300579
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52220
received auth hello!
{ authId: 503, nonce: <Buffer 18 d9 b6 ff a0 79 e2 0e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0c 1d 4b 26 7b 1f 21 63>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer da 21 8f 7a cf b8 20 06>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer da 21 8f 7a cf b8 20 06> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.53:47174',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300589
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52486
received auth hello!
{ authId: 503, nonce: <Buffer a0 7d dc 85 0b 65 a7 0f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5c 3b e2 40 4c a9 5e 64>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3f df 6e f8 e2 0f 13 b1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3f df 6e f8 e2 0f 13 b1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.53:47440',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
