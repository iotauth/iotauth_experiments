changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s507.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's507',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 6d 66 ... > }
Handler: listening on port 22100
s507:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100489
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50936
received auth hello!
{ authId: 501, nonce: <Buffer f4 29 7b 47 9b 34 d1 e5> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 34 1c ff 35 f1 84 0a 69>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 93 8a 24 e6 ed 3a b4 0f 70 7e 9d 21 38 d0 e1 c9>,
  macKeyVal: <Buffer d0 13 34 9a b6 07 15 36 6e 12 e1 9d 52 74 01 64 cb 7e 06 33 56 e8 c1 e8 d7 20 6f 08 dc 15 b0 35>,
  absValidity: 2018-03-21T06:48:28.554Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6f 00 11 39 a1 42 bd 3f>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 6f 00 11 39 a1 42 bd 3f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.71:36374',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100497
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51208
received auth hello!
{ authId: 501, nonce: <Buffer a1 7b 53 2f 62 5d 8f e7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 41 81 6a 9e 5b 7d 92 de>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e5 51 b9 fd ac d2 c9 c0>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e5 51 b9 fd ac d2 c9 c0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.71:36646',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100505
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51478
received auth hello!
{ authId: 501, nonce: <Buffer f3 eb 68 d5 3b ad 7c b7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1c 43 34 53 da 29 8a 7c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e5 0e 19 04 da 2c 8b f5>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e5 0e 19 04 da 2c 8b f5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.71:36916',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100513
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51748
received auth hello!
{ authId: 501, nonce: <Buffer b1 9e 37 83 ad 24 9f c1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer db f1 aa f6 4d c2 0e 06>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6e 07 28 80 a2 ca 60 e6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6e 07 28 80 a2 ca 60 e6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.71:37186',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100521
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52018
received auth hello!
{ authId: 501, nonce: <Buffer c9 2c f2 e7 f9 e6 68 5f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer df 4f b4 a7 a7 e8 61 84>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 63 7a 2e 8f f1 c2 e2 b0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 63 7a 2e 8f f1 c2 e2 b0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.71:37456',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100529
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52288
received auth hello!
{ authId: 501, nonce: <Buffer 96 a9 be 59 28 96 82 a1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 62 4e 92 f6 11 e5 dc 04>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 04 b6 94 25 75 56 46 53>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 04 b6 94 25 75 56 46 53> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.71:37726',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100537
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52558
received auth hello!
{ authId: 501, nonce: <Buffer 75 46 72 82 c7 24 3d db> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f6 71 d4 c6 c4 de c9 dd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b4 a8 2d 9e ea be fb 1c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b4 a8 2d 9e ea be fb 1c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.71:37996',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200569
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200582
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 48034
received auth hello!
{ authId: 502, nonce: <Buffer 57 9a 17 49 34 fa 8d 4e> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '016247178CAE',
  notBefore: 2018-03-21T05:44:08.000Z,
  notAfter: 2018-03-22T05:45:48.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '38:5E:6C:BE:04:69:C4:55:9C:BC:0F:D4:85:3D:DE:73:9C:8B:82:CA',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'AEEAB02ACD0C32937DD84F3EB43F6189EAF089B04CE490F227FEC1E1A42FF33AACC957083F15D2CFEBF0E484D5D2BD03DD21587B3DF0ADCF1F273CEB6D3ADD0C5BD72406DA2D4A379546AD8D1C72FF3DB6ECF5D19A3A100B89C7B659A65778923B085EE02B29C23C0BF27314DEEC84CC61B318C930EC82C3B5DB050AD2527763CDCB5CEE65C7B2D7C1052512A2B08B2601CA1A4E32273B811E50FD7E40A702A19D8D7DB1E27E4C4E0A2F783C9AE1F654053799A646075FDCF3A86C68C654BCCA093F1A4B4044DAAFAB0E1FA7692D70BA1D4DBF798207A97EFFA87E7F6BE94B5E3D49438D87392AA382C0493F6F6E59A3B858B64877C59B95478C667FEE6CD71D',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJHF4yuMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDMy\nMTA1NDQwOFoXDTE4MDMyMjA1NDU0OFowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQCu6rAqzQwyk33YTz60P2GJ6vCJsEzkkPIn/sHhpC/zOqzJVwg/\nFdLP6/DkhNXSvQPdIVh7PfCtzx8nPOttOt0MW9ckBtotSjeVRq2NHHL/Pbbs9dGa\nOhALice2WaZXeJI7CF7gKynCPAvycxTe7ITMYbMYyTDsgsO12wUK0lJ3Y83LXO5l\nx7LXwQUlEqKwiyYByhpOMic7gR5Q/X5ApwKhnY19seJ+TE4KL3g8muH2VAU3maZG\nB1/c86hsaMZUvMoJPxpLQETar6sOH6dpLXC6HU2/eYIHqX7/qH5/a+lLXj1JQ42H\nOSqjgsBJP29uWaO4WLZId8WblUeMZn/ubNcdAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAJOdt3VTDFTavlKO9undoHc3GnfCQOFZ\nNYrh9aZVJup3R8oBPfF1dM0zOIFoGH+lT3jorWwcVFAQHQ+CX4RsQJKi6pRS6Ppp\nLGVHDWNWz1xJRsVUjmjlq+bLWBQzkHYnPAL5I6mLnlkYBuFI5hBRNbf5KCK8+b8D\nIcsUBU6uB+7IsdEtczbgqNwo7KFCqT7dCeaO2nbhENGNDofe9Jt8HY0RM+WQwY2x\n+p+5L4YK3aT+SH0eiIoC3r4Z8+sS8j5AjLchSwJJjbkz4Nucx02nisv4VQWuwrRx\nwxiQXtF8WmezD/RnRfHRWpe7luIyQm6yfZEHTSPcpM3w3BNU6XCjD6w=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200595
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48294
received auth hello!
{ authId: 502, nonce: <Buffer fe 41 b0 25 34 70 07 cf> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 8c 37 d6 ba 78 49 c5 4a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 05 91 00 cf 9e ab 7d 3a 4c 1b d4 5b 94 b2 fd d4>,
  macKeyVal: <Buffer 14 17 49 7c c2 7f 10 87 eb fd 86 db d5 63 86 2a f0 0e 79 26 f3 16 23 b8 ec f2 48 ed 4a a3 db 9a>,
  absValidity: 2018-03-21T06:59:27.666Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2a 0d ab 9c 67 f4 69 38>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2a 0d ab 9c 67 f4 69 38> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.71:39244',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200608
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48560
received auth hello!
{ authId: 502, nonce: <Buffer ee a1 1f 52 44 e6 cc fc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3a 76 a4 c8 90 62 f4 b2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0e 95 75 76 6a 29 dc 28>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0e 95 75 76 6a 29 dc 28> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.71:39510',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200621
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48826
received auth hello!
{ authId: 502, nonce: <Buffer 34 8a 25 24 b7 52 e9 6e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 12 d1 40 8a 36 37 1b ca>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 36 4c c8 73 3e 5f 2f 89>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 36 4c c8 73 3e 5f 2f 89> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.71:39776',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200634
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49092
received auth hello!
{ authId: 502, nonce: <Buffer e2 08 3d 08 4b 1d 08 b2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 92 36 68 a9 4e 7e 3a b5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 33 85 69 73 0c 55 11 e8>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 33 85 69 73 0c 55 11 e8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.71:40042',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200647
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49358
received auth hello!
{ authId: 502, nonce: <Buffer 35 07 b3 3a 02 24 a0 9e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 29 c9 d1 3c 2f d4 73 88>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fb 30 c9 be e4 75 77 77>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer fb 30 c9 be e4 75 77 77> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.71:40308',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200660
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49624
received auth hello!
{ authId: 502, nonce: <Buffer 72 ee 96 0e 36 c6 96 8d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 13 57 2c bd 08 cb c6 1b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0b 48 68 17 8e 07 80 29>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 0b 48 68 17 8e 07 80 29> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.71:40574',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200673
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49890
received auth hello!
{ authId: 502, nonce: <Buffer 32 81 0a 61 c2 81 6e 6d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e0 ba e2 00 89 76 7a 89>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 68 18 a8 da 01 44 f0 30>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 68 18 a8 da 01 44 f0 30> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.71:40840',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200686
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50156
received auth hello!
{ authId: 502, nonce: <Buffer 38 47 ac a6 59 13 0c c5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 97 61 7e 7b 15 3c 8a be>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 57 34 a4 aa 67 be 36 49>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 57 34 a4 aa 67 be 36 49> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.71:41106',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200699
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50422
received auth hello!
{ authId: 502, nonce: <Buffer f7 b1 4e 3a a0 62 e1 33> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c2 bb c5 b9 65 de 10 ee>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 44 a9 3b 5b 9a 14 1d e3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 44 a9 3b 5b 9a 14 1d e3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.71:41372',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200712
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50688
received auth hello!
{ authId: 502, nonce: <Buffer cb cc 28 80 dd ad ad a8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3f 03 aa 0f 47 4f 85 de>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 58 cb 04 b7 4b f6 f5 a2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 58 cb 04 b7 4b f6 f5 a2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.71:41638',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200725
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50954
received auth hello!
{ authId: 502, nonce: <Buffer 2c f3 40 8a 78 ab 1f b8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9e 07 90 bd f8 ac a2 db>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer df 23 74 b2 80 08 3d 30>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer df 23 74 b2 80 08 3d 30> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.71:41904',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200738
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51220
received auth hello!
{ authId: 502, nonce: <Buffer 10 ed 63 24 97 9e 82 ad> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 62 d5 09 01 8c 55 60 27>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ee a4 2d 26 ed 18 26 2e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ee a4 2d 26 ed 18 26 2e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.71:42170',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200751
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51486
received auth hello!
{ authId: 502, nonce: <Buffer 36 44 7b 23 29 ff b4 f6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 89 14 1f 3c 0c 77 93 b1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 44 05 8a dc 9c 1d a2 b3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 44 05 8a dc 9c 1d a2 b3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.71:42436',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200764
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51752
received auth hello!
{ authId: 502, nonce: <Buffer 83 eb 0f 15 40 73 0e 14> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e6 87 9c 03 9f 50 3e 92>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e8 ed 8e 10 ea f8 4a 87>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e8 ed 8e 10 ea f8 4a 87> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.71:42702',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200777
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52018
received auth hello!
{ authId: 502, nonce: <Buffer 2d 15 67 c8 85 8f 3f 30> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e8 a3 47 d2 ce 8b 19 9f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer be fa d4 c7 46 9f 1d 99>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer be fa d4 c7 46 9f 1d 99> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.71:42968',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200790
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52284
received auth hello!
{ authId: 502, nonce: <Buffer 1a 82 a5 f9 6e f8 ea a4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f4 af 63 69 86 8e 2d fc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 20 20 08 fe 98 5c 8f 47>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 20 20 08 fe 98 5c 8f 47> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.71:43234',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200803
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52492
received auth hello!
{ authId: 502, nonce: <Buffer cf c5 e1 4e 7a b0 0c f8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 98 52 60 5a 5c e3 d1 11>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer de e3 69 7a 42 b5 91 a3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer de e3 69 7a 42 b5 91 a3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.71:43442',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
