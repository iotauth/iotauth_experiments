changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s504.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's504',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 32 2b ... > }
Handler: listening on port 22100
s504:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100485
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50140
received auth hello!
{ authId: 501, nonce: <Buffer 1d d0 78 22 4c 84 75 c8> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 2f 57 35 96 f1 c7 ed 5f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 10 f7 30 a1 1a 10 4f 97 2b 31 54 1c 8e 4d 98 ed>,
  macKeyVal: <Buffer 21 95 79 c1 6f 22 c1 c5 61 27 02 99 d0 f9 68 f0 b7 10 f8 e9 c4 9a 3d 67 31 a1 f5 7e 60 91 81 b9>,
  absValidity: 2018-03-21T06:48:14.159Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ef 37 34 c5 4b 07 6f 90>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ef 37 34 c5 4b 07 6f 90> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.67:42790',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100493
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50396
received auth hello!
{ authId: 501, nonce: <Buffer 16 83 9b 66 59 42 32 31> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c2 ed 38 f8 3b 3a 33 df>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 77 43 75 e1 eb c9 3e 6d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 77 43 75 e1 eb c9 3e 6d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.67:43046',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100501
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50666
received auth hello!
{ authId: 501, nonce: <Buffer 39 cb 6f 60 c0 2d 52 4a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 01 52 f9 46 be e8 4f da>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2e 8f 10 60 47 df cf 3d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2e 8f 10 60 47 df cf 3d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.67:43316',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100509
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50936
received auth hello!
{ authId: 501, nonce: <Buffer 61 05 8b 92 06 ab f7 33> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 66 ec 5a e6 03 4e d0 f9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 45 64 32 2d 74 70 08 2a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 45 64 32 2d 74 70 08 2a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.67:43586',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100517
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51206
received auth hello!
{ authId: 501, nonce: <Buffer 59 72 51 f5 8f e5 02 05> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a5 0a 28 3c 9a 49 d7 2d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 42 42 74 b9 39 54 96 46>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 42 42 74 b9 39 54 96 46> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.67:43856',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100525
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51476
received auth hello!
{ authId: 501, nonce: <Buffer c3 40 88 7b da 49 a4 91> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6a 1b df c3 84 f3 41 59>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5b 1e 2d fa a2 59 f4 f1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5b 1e 2d fa a2 59 f4 f1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.67:44126',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100533
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51746
received auth hello!
{ authId: 501, nonce: <Buffer e5 0a 70 c5 54 f6 9c 03> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 92 97 3d 16 4b 73 96 5c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 62 75 00 3f c9 74 26 1a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 62 75 00 3f c9 74 26 1a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.67:44396',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200568
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200581
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 42930
received auth hello!
{ authId: 502, nonce: <Buffer 69 40 8b 9c 8f 65 80 f8> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '016247178CAE',
  notBefore: 2018-03-21T05:44:08.000Z,
  notAfter: 2018-03-22T05:45:48.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '38:5E:6C:BE:04:69:C4:55:9C:BC:0F:D4:85:3D:DE:73:9C:8B:82:CA',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'AEEAB02ACD0C32937DD84F3EB43F6189EAF089B04CE490F227FEC1E1A42FF33AACC957083F15D2CFEBF0E484D5D2BD03DD21587B3DF0ADCF1F273CEB6D3ADD0C5BD72406DA2D4A379546AD8D1C72FF3DB6ECF5D19A3A100B89C7B659A65778923B085EE02B29C23C0BF27314DEEC84CC61B318C930EC82C3B5DB050AD2527763CDCB5CEE65C7B2D7C1052512A2B08B2601CA1A4E32273B811E50FD7E40A702A19D8D7DB1E27E4C4E0A2F783C9AE1F654053799A646075FDCF3A86C68C654BCCA093F1A4B4044DAAFAB0E1FA7692D70BA1D4DBF798207A97EFFA87E7F6BE94B5E3D49438D87392AA382C0493F6F6E59A3B858B64877C59B95478C667FEE6CD71D',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJHF4yuMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDMy\nMTA1NDQwOFoXDTE4MDMyMjA1NDU0OFowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQCu6rAqzQwyk33YTz60P2GJ6vCJsEzkkPIn/sHhpC/zOqzJVwg/\nFdLP6/DkhNXSvQPdIVh7PfCtzx8nPOttOt0MW9ckBtotSjeVRq2NHHL/Pbbs9dGa\nOhALice2WaZXeJI7CF7gKynCPAvycxTe7ITMYbMYyTDsgsO12wUK0lJ3Y83LXO5l\nx7LXwQUlEqKwiyYByhpOMic7gR5Q/X5ApwKhnY19seJ+TE4KL3g8muH2VAU3maZG\nB1/c86hsaMZUvMoJPxpLQETar6sOH6dpLXC6HU2/eYIHqX7/qH5/a+lLXj1JQ42H\nOSqjgsBJP29uWaO4WLZId8WblUeMZn/ubNcdAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAJOdt3VTDFTavlKO9undoHc3GnfCQOFZ\nNYrh9aZVJup3R8oBPfF1dM0zOIFoGH+lT3jorWwcVFAQHQ+CX4RsQJKi6pRS6Ppp\nLGVHDWNWz1xJRsVUjmjlq+bLWBQzkHYnPAL5I6mLnlkYBuFI5hBRNbf5KCK8+b8D\nIcsUBU6uB+7IsdEtczbgqNwo7KFCqT7dCeaO2nbhENGNDofe9Jt8HY0RM+WQwY2x\n+p+5L4YK3aT+SH0eiIoC3r4Z8+sS8j5AjLchSwJJjbkz4Nucx02nisv4VQWuwrRx\nwxiQXtF8WmezD/RnRfHRWpe7luIyQm6yfZEHTSPcpM3w3BNU6XCjD6w=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200594
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43208
received auth hello!
{ authId: 502, nonce: <Buffer fa 7f 2f be 50 77 7b 2c> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer a7 fe 5b fc b7 67 bd ea>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 85 5c 92 cd e9 a2 c4 30 7f 5a 54 7e 71 bc bb e1>,
  macKeyVal: <Buffer 2e ad a3 5b 15 cb 43 d7 76 76 7c b4 43 34 39 fe 67 75 13 86 71 74 53 9b 50 a6 66 5c 35 80 38 a1>,
  absValidity: 2018-03-21T06:59:15.047Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer eb 1c 35 ff d8 ee 54 35>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer eb 1c 35 ff d8 ee 54 35> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.67:45644',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200607
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43472
received auth hello!
{ authId: 502, nonce: <Buffer e2 a3 a0 71 4b 19 61 f9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d0 21 6f 32 38 16 fb 0d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer dc ac 62 51 cf 56 67 dc>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer dc ac 62 51 cf 56 67 dc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.67:45908',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200620
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43738
received auth hello!
{ authId: 502, nonce: <Buffer f6 f0 a9 1b 9d 30 e2 84> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 20 fa f9 ce ed f3 5a 78>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8f 00 f7 8d cb c7 88 f1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8f 00 f7 8d cb c7 88 f1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.67:46174',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200633
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44004
received auth hello!
{ authId: 502, nonce: <Buffer 97 71 9d ed 16 a4 d8 19> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a7 b4 fd 37 3c 27 f3 8f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 57 ca 74 2c 7f 59 f7 de>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 57 ca 74 2c 7f 59 f7 de> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.67:46440',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200646
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44270
received auth hello!
{ authId: 502, nonce: <Buffer 31 54 00 1d cd 3b f1 ed> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f6 c5 b0 c2 9c 9f 83 d4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bc 56 d0 f8 af 46 12 ca>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bc 56 d0 f8 af 46 12 ca> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.67:46706',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200659
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44536
received auth hello!
{ authId: 502, nonce: <Buffer e2 f4 94 24 07 07 e8 0e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 22 94 69 33 ab c2 f0 80>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f7 31 16 21 54 ef 49 74>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f7 31 16 21 54 ef 49 74> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.67:46972',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200672
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44802
received auth hello!
{ authId: 502, nonce: <Buffer 69 26 e4 de 9d cd 92 d1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 25 c4 34 be ae ca 9a b6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 05 8a 84 fa 7d 5b fc 86>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 05 8a 84 fa 7d 5b fc 86> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.67:47238',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200685
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45068
received auth hello!
{ authId: 502, nonce: <Buffer 4f 19 f5 8f d6 d2 07 b1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4e 5f cf 85 f3 e4 f3 ed>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer aa 8d eb 74 67 da 1b b4>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer aa 8d eb 74 67 da 1b b4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.67:47504',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200698
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45334
received auth hello!
{ authId: 502, nonce: <Buffer f9 fb 16 b7 89 ff 43 86> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ad c7 a4 0f 9d 6f e7 20>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bb cf 94 35 6a 12 62 2c>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer bb cf 94 35 6a 12 62 2c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.67:47770',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200711
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45600
received auth hello!
{ authId: 502, nonce: <Buffer 9d 91 52 12 5a aa df 53> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d7 9c 4b c7 a0 ff 7a 95>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d9 11 05 97 c4 67 5d ba>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer d9 11 05 97 c4 67 5d ba> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.67:48036',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200724
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45866
received auth hello!
{ authId: 502, nonce: <Buffer 9a 00 15 5c f3 3a c9 5b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 54 06 ce a6 51 0a 83 da>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 86 83 f6 f3 57 d6 4e e4>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 86 83 f6 f3 57 d6 4e e4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.67:48302',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200737
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46132
received auth hello!
{ authId: 502, nonce: <Buffer 5d 20 2c 23 e5 d5 d7 11> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 67 3e 8a 99 47 15 01 56>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer da f0 c7 5d 31 9f 63 1f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer da f0 c7 5d 31 9f 63 1f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.67:48568',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200750
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46398
received auth hello!
{ authId: 502, nonce: <Buffer 52 ab 12 1d c5 82 0b c4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6e e9 4f 03 f7 98 14 42>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 01 17 58 3a b3 92 c7 18>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 01 17 58 3a b3 92 c7 18> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.67:48834',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200763
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46664
received auth hello!
{ authId: 502, nonce: <Buffer e8 67 f5 e0 cc d1 d6 9d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer de f9 56 45 82 9f 5f 33>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 99 eb 34 f5 2f d3 c1 f8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 99 eb 34 f5 2f d3 c1 f8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.67:49100',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200776
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46930
received auth hello!
{ authId: 502, nonce: <Buffer 41 5f f5 07 53 40 7d 8b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 03 ca 02 95 28 d6 b5 d0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 25 c0 a1 20 85 89 e3 77>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 25 c0 a1 20 85 89 e3 77> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.67:49366',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200789
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47196
received auth hello!
{ authId: 502, nonce: <Buffer 04 f8 21 b9 7e eb 47 b9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4b 4b b1 b8 03 10 96 42>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 52 42 3c 30 48 52 a2 9e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 52 42 3c 30 48 52 a2 9e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.67:49632',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50200802
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47434
received auth hello!
{ authId: 502, nonce: <Buffer a3 6b 9c 2f 38 8d cf 13> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ce 7c 6e 49 4f 76 2c 95>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 53 71 4d 83 7e 0c 05 8f>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 53 71 4d 83 7e 0c 05 8f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.67:49870',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
