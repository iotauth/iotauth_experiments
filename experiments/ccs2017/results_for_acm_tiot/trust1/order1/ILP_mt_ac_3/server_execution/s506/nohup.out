changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s506.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's506',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 37 56 ... > }
Handler: listening on port 22100
s506:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100488
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47544
received auth hello!
{ authId: 501, nonce: <Buffer 75 43 d3 0f ab a4 da 36> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer af 2e 6b 0b bf 34 6e 25>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 75 7d 6f 78 05 e2 ca 5f c0 d2 d4 db 17 c8 28 95>,
  macKeyVal: <Buffer 0e 4a 22 05 77 6b 33 ef 47 d9 67 ff 8a 90 00 dc 7b 1b 23 39 fa 9c d9 50 77 7e 7f 7b cc 0a ee 63>,
  absValidity: 2018-03-21T06:48:24.607Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7d bf ac 6c f7 9c ed 32>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 7d bf ac 6c f7 9c ed 32> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.70:57674',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100496
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47812
received auth hello!
{ authId: 501, nonce: <Buffer 4f fc 31 20 f0 e8 43 17> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f3 43 75 e2 9c 3c 56 93>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 15 23 88 b8 e4 c4 33 4b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 15 23 88 b8 e4 c4 33 4b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.70:57942',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100504
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48082
received auth hello!
{ authId: 501, nonce: <Buffer f8 e5 2e 67 3d aa 7b 4b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ae 8f 3e 79 55 9e f9 d2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cf 28 93 29 3b d0 a3 a6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer cf 28 93 29 3b d0 a3 a6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.70:58212',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100512
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48356
received auth hello!
{ authId: 501, nonce: <Buffer 60 ee a6 0c bb d5 43 99> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 43 af c5 50 a2 42 9a a5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bf eb 58 c6 fd 59 95 b3>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer bf eb 58 c6 fd 59 95 b3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.70:58486',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100520
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48626
received auth hello!
{ authId: 501, nonce: <Buffer 41 b0 c9 0a 43 f5 18 91> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a7 48 59 dc 08 7f 6d d9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 04 50 48 83 28 38 ef 71>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 04 50 48 83 28 38 ef 71> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.70:58756',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100528
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48896
received auth hello!
{ authId: 501, nonce: <Buffer dd 33 29 b6 86 cb 3e 9e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6e bf 16 8d 24 3b 44 29>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b9 89 76 30 77 47 87 ca>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b9 89 76 30 77 47 87 ca> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.70:59026',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100536
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49166
received auth hello!
{ authId: 501, nonce: <Buffer fd a0 aa 10 73 b9 81 4b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer eb 8d 87 05 e6 88 f2 69>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d3 01 03 dd 00 ac c0 f0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d3 01 03 dd 00 ac c0 f0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.70:59296',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300399
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300410
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 34746
received auth hello!
{ authId: 403, nonce: <Buffer fa 12 f5 a4 7e 0e 9b 5d> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth403',
     commonName: '10.0.1.3' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '016247178C54',
  notBefore: 2018-03-21T05:44:08.000Z,
  notAfter: 2018-03-22T05:45:48.000Z,
  subjectHash: 'f6675d02',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '93:F5:B9:A8:BA:50:45:5B:22:49:3C:C7:38:E0:17:A4:7F:D5:C4:B4',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'C1AF2AC14B2F9392816EA88E782CC620B8F0D9E9DF6104EF1AF7999CEFD8A2AEFC535AEE32C8AC2DEEF8D8C3E1D186A9573F54B742E50E789C1A1BEE9249B9F4B3FC8821417A35131B1D3A5EA5C25715102E5B23A1D99A36E95F8737CF107DA75A7C3ED9B39BC6B81E16A95865D4AFE6338ED606A7AC25BC3DD385B313915D9B4CC716C41035CE9F3D7C05EE7B6FA15F93F6F65703A9AE169B5AF8DF9E6CFCA863F962EF8A45E8AE4DFCE5E01A3DD5E9294C309F59829BE396D2E5638A3288C3B2B9AE54A576847BE786ACABDC946A06B02895771675ADE4537E87BC980D9456CB3777B9C475C1405AE6C01B6C37AC672A3C28340090055170CAAE6720274ADD',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.3' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 403,
  host: '10.0.1.3',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJHF4xUMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDMy\nMTA1NDQwOFoXDTE4MDMyMjA1NDU0OFowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDQwMzERMA8GA1UEAwwIMTAuMC4xLjMwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDBryrBSy+TkoFuqI54LMYguPDZ6d9hBO8a95mc79iirvxTWu4y\nyKwt7vjYw+HRhqlXP1S3QuUOeJwaG+6SSbn0s/yIIUF6NRMbHTpepcJXFRAuWyOh\n2Zo26V+HN88QfadafD7Zs5vGuB4WqVhl1K/mM47WBqesJbw904WzE5Fdm0zHFsQQ\nNc6fPXwF7ntvoV+T9vZXA6muFpta+N+ebPyoY/li74pF6K5N/OXgGj3V6SlMMJ9Z\ngpvjltLlY4oyiMOyua5UpXaEe+eGrKvclGoGsCiVdxZ1reRTfoe8mA2UVss3d7nE\ndcFAWubAG2w3rGcqPCg0AJAFUXDKrmcgJ0rdAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQMwDQYJKoZIhvcNAQELBQADggEBADyUrzxyzkZEjFF5v/R9vJ8l8u5d0w6V\n/8AjHTdLk98X0PDQ2897hP9leASyAbTzxodgkNjIHhnmPMlRnv9GTCCuw1lOVNXG\nQqE7z6po6o343o60xOEe3MC4vyHQIQ7LPvc4enGSobtgJ+1FtqcTlBsM/H22eruW\nbrkpbFoYOA4YsLkNFW0sLSWAYbcQ31ObIULCYPq4k/njmRAEo0a8KqykS4WUliJ2\nxDzptcok8GKJ6cqDQED1DzvOsyx7GdRJzKl3YKuoI89ca3ZMtfM5QzxAluYQEl25\n2a+EcUUW/IX2BYclLP3QPcpQh1FZOsyxnf7pOuAu+RvNk4uZrXxICa0=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300421
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35010
received auth hello!
{ authId: 403, nonce: <Buffer c5 84 fd 2b ed 73 77 11> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer d8 ec e9 1d 18 07 98 30>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 15 51 51 b2 4e 34 4d 6b da b3 b6 93 d6 50 0b 3a>,
  macKeyVal: <Buffer ac 51 05 c2 3a 0d 7d 3a ff 52 d9 f3 5d 1b ba 81 fd 15 a7 9f d0 2f 52 dd 2b 57 c0 a8 41 b9 f5 4f>,
  absValidity: 2018-03-21T06:59:24.496Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a7 c8 ef 2e c5 eb d0 65>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a7 c8 ef 2e c5 eb d0 65> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.70:60544',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300432
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35270
received auth hello!
{ authId: 403, nonce: <Buffer 35 41 bb 9b a4 d4 26 38> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 64 1d 1c cc b4 8b c3 ec>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9d 79 e7 c0 a9 ed 4e 42>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9d 79 e7 c0 a9 ed 4e 42> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.70:60804',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300443
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35544
received auth hello!
{ authId: 403, nonce: <Buffer fe e8 66 1d 8b 6b f6 63> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2e 2a 41 d4 22 6e b4 78>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 74 46 03 3c 01 65 0d 51>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 74 46 03 3c 01 65 0d 51> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.70:32844',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300454
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35798
received auth hello!
{ authId: 403, nonce: <Buffer f0 d2 d7 d4 f7 b9 a9 41> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer df b2 0d 8e eb a1 4d ca>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c7 83 cd f7 03 7e 62 ad>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c7 83 cd f7 03 7e 62 ad> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.70:33100',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300465
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36064
received auth hello!
{ authId: 403, nonce: <Buffer ca d5 ff 57 de 41 f4 9b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0d ea 67 57 b8 75 2f 92>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 66 42 de 56 3e 11 a6 50>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 66 42 de 56 3e 11 a6 50> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.70:33366',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300476
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36330
received auth hello!
{ authId: 403, nonce: <Buffer e5 ce 6a fe 68 f8 0a 46> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f1 5a c7 b1 2e 65 aa 4a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 04 a8 6e 65 c2 38 61 57>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 04 a8 6e 65 c2 38 61 57> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.70:33632',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300487
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36602
received auth hello!
{ authId: 403, nonce: <Buffer 3d 23 5a b5 14 43 c6 96> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3a 23 2d 43 59 a5 08 c7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 43 52 76 a9 e1 10 27 9d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 43 52 76 a9 e1 10 27 9d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.70:33902',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300498
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36874
received auth hello!
{ authId: 403, nonce: <Buffer bc 0c 2c 14 ba 7f 8e 50> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 36 b2 c1 a2 9d f0 18 ba>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fc 87 10 f3 41 fd 2c da>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fc 87 10 f3 41 fd 2c da> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.70:34174',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300509
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37134
received auth hello!
{ authId: 403, nonce: <Buffer e6 2c e1 40 4d 84 a6 06> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fa 15 7f 7e 3c 17 1c ec>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 34 33 40 81 b0 f2 7e 12>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 34 33 40 81 b0 f2 7e 12> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.70:34432',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300520
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37398
received auth hello!
{ authId: 403, nonce: <Buffer 60 aa fc 24 b4 4b ad be> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1b 82 af a4 b0 e0 86 ac>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 49 cc be 0b 7e 1f dd 98>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 49 cc be 0b 7e 1f dd 98> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.70:34700',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300531
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37664
received auth hello!
{ authId: 403, nonce: <Buffer d1 4d 8c 09 90 8f 06 9a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 30 0e 77 f0 bd 38 c4 3f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 68 8d 14 15 80 0f d0 c9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 68 8d 14 15 80 0f d0 c9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.70:34964',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300542
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37938
received auth hello!
{ authId: 403, nonce: <Buffer 72 0b 14 be f0 d5 63 fa> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fc 24 f3 31 89 d2 2c f4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 70 3e 40 bc ae 0d f7 85>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 70 3e 40 bc ae 0d f7 85> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.70:35240',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300553
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38200
received auth hello!
{ authId: 403, nonce: <Buffer eb 73 12 01 90 f1 86 52> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1c ee 13 fd 60 7f 9e 72>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 06 83 20 47 63 e8 d4 77>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 06 83 20 47 63 e8 d4 77> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.70:35502',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300564
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38466
received auth hello!
{ authId: 403, nonce: <Buffer db 04 7c 71 e3 51 4a c8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 55 d4 44 97 90 12 61 bc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer dd b2 fd d5 1f 50 b3 32>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer dd b2 fd d5 1f 50 b3 32> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.70:35768',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300575
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38736
received auth hello!
{ authId: 403, nonce: <Buffer 4d a6 a6 64 1a 14 62 93> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e1 3b d3 5c 14 76 35 f2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fe 64 04 71 c1 18 b5 3e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fe 64 04 71 c1 18 b5 3e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.70:36036',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300586
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39002
received auth hello!
{ authId: 403, nonce: <Buffer fe 90 c9 33 a6 28 9a ae> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer db bb 81 c0 27 1c 15 02>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 71 d8 0f 61 ee 11 aa ca>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 71 d8 0f 61 ee 11 aa ca> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.70:36304',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300597
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39214
received auth hello!
{ authId: 403, nonce: <Buffer e9 e4 a7 ee a5 79 74 c5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6a e9 0a 6d 62 bd 0b 20>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ec 0c f3 e8 59 38 46 ad>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ec 0c f3 e8 59 38 46 ad> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.70:36516',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
