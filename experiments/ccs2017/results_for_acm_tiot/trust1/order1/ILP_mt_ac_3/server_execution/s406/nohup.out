changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s406.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's406',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 33 6c ... > }
Handler: listening on port 22100
s406:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200252
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33482
received auth hello!
{ authId: 402, nonce: <Buffer d5 e9 92 1a 50 ae a6 f6> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 6f b7 01 4a d3 25 b8 7c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer f9 bf a4 d7 b1 6d 3e d5 1e 59 c6 fe 91 86 db 1e>,
  macKeyVal: <Buffer 27 69 bb 25 df 8c 62 07 96 e1 9f 94 05 29 63 1f 17 31 96 f9 8f 7b 39 fd ae b9 d4 c1 8a 3a b4 d8>,
  absValidity: 2018-03-21T06:47:18.658Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 33 63 1d 55 91 96 fb 07>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 33 63 1d 55 91 96 fb 07> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.50:48330',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200259
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33638
received auth hello!
{ authId: 402, nonce: <Buffer 50 8a dd 7b 06 0a a1 39> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ad 1b 2a 96 28 77 5b 4e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c2 ae 6c e0 0f 6e b2 16>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c2 ae 6c e0 0f 6e b2 16> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.50:48486',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200266
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33900
received auth hello!
{ authId: 402, nonce: <Buffer 93 30 51 80 5e 98 f2 1b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d0 54 ce ed f0 bd 1a 24>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ad fd 0c ee 1a f3 99 13>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ad fd 0c ee 1a f3 99 13> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.50:48748',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200273
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34170
received auth hello!
{ authId: 402, nonce: <Buffer eb 9f 85 32 a9 6e bd ce> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 75 79 40 78 cb 3c ad b1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 62 34 2c e8 f7 68 dd 1d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 62 34 2c e8 f7 68 dd 1d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.50:49018',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200280
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34440
received auth hello!
{ authId: 402, nonce: <Buffer 5d 13 2c b3 e0 c8 b2 29> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 15 8e a0 aa 0b 58 79 4a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f5 06 10 45 ba 01 e3 29>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f5 06 10 45 ba 01 e3 29> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.50:49288',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200287
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34710
received auth hello!
{ authId: 402, nonce: <Buffer 56 4e 36 43 e9 c5 36 88> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b6 eb 14 2d 01 87 e1 01>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6a 65 1d 4f 8d a2 60 7a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6a 65 1d 4f 8d a2 60 7a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.50:49558',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200294
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34980
received auth hello!
{ authId: 402, nonce: <Buffer cb 13 1f 8b da 82 1c bb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d9 ba 08 ec 17 be 30 77>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 24 ce fb 91 e6 36 e0 61>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 24 ce fb 91 e6 36 e0 61> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.50:49828',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200301
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35250
received auth hello!
{ authId: 402, nonce: <Buffer 91 52 92 c0 7f 46 75 f3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e4 63 c0 71 78 e5 88 c9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a7 a9 45 80 72 ae d8 e0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a7 a9 45 80 72 ae d8 e0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.50:50098',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300416
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300426
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 39730
received auth hello!
{ authId: 503, nonce: <Buffer 4c 6b 57 1d 6e 37 a7 d5> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth503',
     commonName: '10.0.1.6' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth402',
     commonName: '10.0.0.2' },
  serial: '016247178A17',
  notBefore: 2018-03-21T05:44:07.000Z,
  notAfter: 2018-03-22T05:45:47.000Z,
  subjectHash: '5542437f',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '97:6A:EB:00:59:68:A7:AD:3E:4D:FE:A9:B6:2A:E9:0B:40:D1:1C:A5',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'E2C77ADB548D185210E7FA2988369325521D9CF6957B61D640674333307D4FC133154B2C56A9BBCE5655BEDE59A620D2F68A660E6DEB43308DBAFD7A396559B1C6BD0ED769D2F4066CEB2BFDB38188C4D295C06D196ECCC621767B060A3D3BCF3CF4458D7031B2D0AB66B8846DD9C1D4374DEB5D3E30D68FF926574682526527828E3BB232E36626859A826F5DA69748C9567F01930811E1C310842AAE799D7FAD1E9BE8B5D23DC0BC0D4537FC44D1FE7D84E57938DEE6D651DAEC8C897885315FE2797FFB87939E2A342186F4C566B1623BD369CC0226678E3A96E9092471F81CCC14C868DBEA8B6F0B2E5D566294136E91C2B3B101366D8A5B6642614F0CF5',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.6' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 503,
  host: '10.0.1.6',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJHF4oXMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDIxETAPBgNVBAMMCDEwLjAuMC4yMB4XDTE4MDMy\nMTA1NDQwN1oXDTE4MDMyMjA1NDU0N1owYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMzERMA8GA1UEAwwIMTAuMC4xLjYwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDix3rbVI0YUhDn+imINpMlUh2c9pV7YdZAZ0MzMH1PwTMVSyxW\nqbvOVlW+3lmmINL2imYObetDMI26/Xo5ZVmxxr0O12nS9AZs6yv9s4GIxNKVwG0Z\nbszGIXZ7Bgo9O8889EWNcDGy0KtmuIRt2cHUN03rXT4w1o/5JldGglJlJ4KOO7Iy\n42YmhZqCb12ml0jJVn8BkwgR4cMQhCqueZ1/rR6b6LXSPcC8DUU3/ETR/n2E5Xk4\n3ubWUdrsjIl4hTFf4nl/+4eTnio0IYb0xWaxYjvTacwCJmeOOpbpCSRx+BzMFMho\n2+qLbwsuXVZilBNukcKzsQE2bYpbZkJhTwz1AgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQYwDQYJKoZIhvcNAQELBQADggEBAA/U/UVNfOzcZdQ4pbV0bQtut9dEjxAx\ncBdXIcek+LysVIqObTpGi6pUEEF1P0V34ZeG779l+UhbUait5Cogb6R7lbHaKd7u\nM8gQ6aEZC2Q9zcTdgcFdipvEOp4/dq1np/uMCvOKzMVKLq1ULUzJDW+khQpSMtXS\n+loQUQ8u8mPCThX6qGCIxWql7Wy9hpilNrjpIllsor6/dMwxTDay34eFuQZpjdIh\nMFbZmrZsKpozITMxto06zaaghRZ3Arq+G3hYzBCTBMkj3Ux105DwofMTuwbFSmmo\nvIxq8zKdoF3wWT38DGdwfc9+Q4A5iMb6NdewuGVDngexeQST7xpSnZs=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300436
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39998
received auth hello!
{ authId: 503, nonce: <Buffer 14 5f b2 0a 1d 60 e6 f0> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 44 83 93 58 17 56 c7 b6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer cb 93 09 9f bd 30 94 69 a3 fb c7 2e 20 28 b5 8a>,
  macKeyVal: <Buffer d7 06 af 03 76 e8 ed 70 81 b4 2f ab 29 e5 da e3 b9 3d 83 cd de 03 7b db c8 aa 8f 45 a7 a2 de c5>,
  absValidity: 2018-03-21T06:59:19.318Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cd 15 22 4e 90 0c 4f c4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer cd 15 22 4e 90 0c 4f c4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.50:51342',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300446
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40258
received auth hello!
{ authId: 503, nonce: <Buffer 03 2b 97 a9 1f 6a cb 45> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ab 29 b6 c9 4d 5f f5 87>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 05 52 02 2b dc 62 61 ee>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 05 52 02 2b dc 62 61 ee> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.50:51602',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300456
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40528
received auth hello!
{ authId: 503, nonce: <Buffer 41 88 cd 7e 9e 0d fc ef> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8d 01 5a f9 87 82 6d 59>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6d 4a a8 5f 65 b1 8f 48>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6d 4a a8 5f 65 b1 8f 48> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.50:51870',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300466
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40794
received auth hello!
{ authId: 503, nonce: <Buffer cc 78 e2 14 36 90 d6 07> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 89 35 5b 32 76 22 94 6d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 26 77 c3 e5 37 d6 f1 78>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 26 77 c3 e5 37 d6 f1 78> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.50:52138',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300476
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41060
received auth hello!
{ authId: 503, nonce: <Buffer a9 f9 67 0b 2c d5 da f6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 65 b0 c1 1d a0 a0 7b 07>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e7 a6 1c a2 cb be 56 9b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e7 a6 1c a2 cb be 56 9b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.50:52404',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300486
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41326
received auth hello!
{ authId: 503, nonce: <Buffer 37 2b ee de 20 ca 53 66> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 63 e4 3d 53 ec 6b e2 5a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d9 8d a5 ac 9b c4 03 12>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d9 8d a5 ac 9b c4 03 12> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.50:52670',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300496
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41592
received auth hello!
{ authId: 503, nonce: <Buffer 22 8f bb 2e 80 5a 5c c9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ba 57 f4 f2 01 3f 7c 1e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer be 9b 1b 69 2f e6 13 e2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer be 9b 1b 69 2f e6 13 e2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.50:52936',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300506
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41858
received auth hello!
{ authId: 503, nonce: <Buffer 12 ac ad 21 7a fa 73 73> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 99 9c 39 a1 2b 45 ca ed>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 80 98 ac de cf 99 83 cd>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 80 98 ac de cf 99 83 cd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.50:53202',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300516
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42124
received auth hello!
{ authId: 503, nonce: <Buffer 7e ef c7 f7 44 96 85 37> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6e 36 3c 79 fc ac 0a 86>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2f ed 83 e1 ad bd 5d bd>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 2f ed 83 e1 ad bd 5d bd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.50:53468',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300526
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42390
received auth hello!
{ authId: 503, nonce: <Buffer 55 5a 52 a0 20 c0 06 9f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bf 23 2f dd 84 a2 99 f1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9e 47 6a d2 88 16 d3 c7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9e 47 6a d2 88 16 d3 c7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.50:53734',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300536
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42656
received auth hello!
{ authId: 503, nonce: <Buffer 72 73 2b 8a 8d f9 8c fa> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b4 1b 53 8b 82 3a 18 e7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 52 62 b4 c6 ff 3e 35 a4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 52 62 b4 c6 ff 3e 35 a4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.50:54000',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300546
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42922
received auth hello!
{ authId: 503, nonce: <Buffer 2b 9a 35 2a 18 25 ab ff> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 35 e9 fa 73 2c 3c 02 a9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fd e7 ef a7 17 ee df b9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fd e7 ef a7 17 ee df b9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.50:54266',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300556
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43188
received auth hello!
{ authId: 503, nonce: <Buffer 3e 82 a1 f4 61 56 de 96> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d2 e0 1e 61 ea 28 eb d8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 59 a6 7d f2 ac 4b 98 3e>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 59 a6 7d f2 ac 4b 98 3e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.50:54532',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300566
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43454
received auth hello!
{ authId: 503, nonce: <Buffer 7f dd ba a2 0a ce 1f e9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d6 5a b5 81 e8 4f cf 6e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2a 2c fe 9c 41 8e 85 91>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2a 2c fe 9c 41 8e 85 91> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.50:54798',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300576
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43720
received auth hello!
{ authId: 503, nonce: <Buffer 60 e4 54 83 08 5e 50 d1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 66 35 83 05 b5 99 76 7d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fb d9 15 d8 88 a6 e9 59>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer fb d9 15 d8 88 a6 e9 59> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.50:55064',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300586
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43986
received auth hello!
{ authId: 503, nonce: <Buffer f3 f2 d7 1a 5f 5c 41 af> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c2 89 b8 9c 4f 0c 0d eb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cc c4 b8 df b9 6e 68 73>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer cc c4 b8 df b9 6e 68 73> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.50:55330',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
