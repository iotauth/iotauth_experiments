changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s502.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's502',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 70 71 ... > }
Handler: listening on port 22100
s502:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100483
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56178
received auth hello!
{ authId: 501, nonce: <Buffer 4c ce 5b f2 e4 bb d9 1b> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 0b 01 da dd 89 a9 c5 a2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer f2 d2 3f 03 e1 54 c4 3b 01 35 6d 8a 75 d7 aa 66>,
  macKeyVal: <Buffer 5f 34 1a 9f 86 ae 17 9f cc b9 db 90 89 f4 67 e5 af 3d ab d2 a9 f0 45 8e a7 a4 b4 da 1e 40 bd 44>,
  absValidity: 2018-03-21T06:48:00.987Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ae 4d 1c 9b dc 5c 88 18>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ae 4d 1c 9b dc 5c 88 18> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.63:42282',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100491
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56414
received auth hello!
{ authId: 501, nonce: <Buffer d4 eb ac 7c 20 66 c5 51> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f8 04 f6 75 c1 71 77 70>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer af 55 c6 e7 cc 15 46 35>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer af 55 c6 e7 cc 15 46 35> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.63:42518',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100499
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56684
received auth hello!
{ authId: 501, nonce: <Buffer b2 cb ca 6a cc 76 6e 2b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ff 30 06 12 58 af f9 b1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 72 ad 40 24 9d d5 33 7e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 72 ad 40 24 9d d5 33 7e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.63:42788',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100507
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56954
received auth hello!
{ authId: 501, nonce: <Buffer 5e 6b ba 46 df 1c a2 da> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bf 11 ea cc 2a 9d c2 97>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ab bd 42 ac e7 09 9f 67>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ab bd 42 ac e7 09 9f 67> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.63:43058',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100515
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57224
received auth hello!
{ authId: 501, nonce: <Buffer 84 c7 5d d1 b2 d3 2f b3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8f 4e 2e 46 48 96 f8 8e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 00 80 97 66 c3 54 5b e4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 00 80 97 66 c3 54 5b e4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.63:43328',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100523
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57494
received auth hello!
{ authId: 501, nonce: <Buffer c3 3e 3b 2d 66 b6 6b 86> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5f ab 53 7c 4a d3 81 e7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9c 21 df 14 c6 93 4a e9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9c 21 df 14 c6 93 4a e9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.63:43598',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100531
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57764
received auth hello!
{ authId: 501, nonce: <Buffer 10 48 45 13 4b eb 51 3c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 39 dd 29 55 82 87 b4 19>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer db cb 48 41 3b 27 a8 42>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer db cb 48 41 3b 27 a8 42> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.63:43868',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300395
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300406
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 60134
received auth hello!
{ authId: 403, nonce: <Buffer c7 43 b3 00 cd 39 5d 42> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth403',
     commonName: '10.0.1.3' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '016247178C54',
  notBefore: 2018-03-21T05:44:08.000Z,
  notAfter: 2018-03-22T05:45:48.000Z,
  subjectHash: 'f6675d02',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '93:F5:B9:A8:BA:50:45:5B:22:49:3C:C7:38:E0:17:A4:7F:D5:C4:B4',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'C1AF2AC14B2F9392816EA88E782CC620B8F0D9E9DF6104EF1AF7999CEFD8A2AEFC535AEE32C8AC2DEEF8D8C3E1D186A9573F54B742E50E789C1A1BEE9249B9F4B3FC8821417A35131B1D3A5EA5C25715102E5B23A1D99A36E95F8737CF107DA75A7C3ED9B39BC6B81E16A95865D4AFE6338ED606A7AC25BC3DD385B313915D9B4CC716C41035CE9F3D7C05EE7B6FA15F93F6F65703A9AE169B5AF8DF9E6CFCA863F962EF8A45E8AE4DFCE5E01A3DD5E9294C309F59829BE396D2E5638A3288C3B2B9AE54A576847BE786ACABDC946A06B02895771675ADE4537E87BC980D9456CB3777B9C475C1405AE6C01B6C37AC672A3C28340090055170CAAE6720274ADD',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.3' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 403,
  host: '10.0.1.3',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJHF4xUMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDMy\nMTA1NDQwOFoXDTE4MDMyMjA1NDU0OFowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDQwMzERMA8GA1UEAwwIMTAuMC4xLjMwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDBryrBSy+TkoFuqI54LMYguPDZ6d9hBO8a95mc79iirvxTWu4y\nyKwt7vjYw+HRhqlXP1S3QuUOeJwaG+6SSbn0s/yIIUF6NRMbHTpepcJXFRAuWyOh\n2Zo26V+HN88QfadafD7Zs5vGuB4WqVhl1K/mM47WBqesJbw904WzE5Fdm0zHFsQQ\nNc6fPXwF7ntvoV+T9vZXA6muFpta+N+ebPyoY/li74pF6K5N/OXgGj3V6SlMMJ9Z\ngpvjltLlY4oyiMOyua5UpXaEe+eGrKvclGoGsCiVdxZ1reRTfoe8mA2UVss3d7nE\ndcFAWubAG2w3rGcqPCg0AJAFUXDKrmcgJ0rdAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQMwDQYJKoZIhvcNAQELBQADggEBADyUrzxyzkZEjFF5v/R9vJ8l8u5d0w6V\n/8AjHTdLk98X0PDQ2897hP9leASyAbTzxodgkNjIHhnmPMlRnv9GTCCuw1lOVNXG\nQqE7z6po6o343o60xOEe3MC4vyHQIQ7LPvc4enGSobtgJ+1FtqcTlBsM/H22eruW\nbrkpbFoYOA4YsLkNFW0sLSWAYbcQ31ObIULCYPq4k/njmRAEo0a8KqykS4WUliJ2\nxDzptcok8GKJ6cqDQED1DzvOsyx7GdRJzKl3YKuoI89ca3ZMtfM5QzxAluYQEl25\n2a+EcUUW/IX2BYclLP3QPcpQh1FZOsyxnf7pOuAu+RvNk4uZrXxICa0=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300417
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60410
received auth hello!
{ authId: 403, nonce: <Buffer 4d 46 f4 1a 84 9d 2e bd> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer a0 08 d3 29 ff 18 a3 91>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer eb 4a 1f 77 50 d6 af 22 eb 3b 0d 64 dd 50 84 25>,
  macKeyVal: <Buffer 7b 6f b9 b4 00 0c 8a c5 e9 86 f0 c9 c7 c0 07 35 eb c5 47 b0 81 23 dc 49 f4 57 79 5b e1 1f 89 e9>,
  absValidity: 2018-03-21T06:59:01.717Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 47 68 76 58 af 4d 6c ee>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 47 68 76 58 af 4d 6c ee> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.63:45120',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300428
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60674
received auth hello!
{ authId: 403, nonce: <Buffer 22 bf 90 29 bb 69 b1 af> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer be 63 e5 a4 dc ce a8 51>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6c d3 85 9f 73 ad 27 21>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6c d3 85 9f 73 ad 27 21> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.63:45384',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300439
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60940
received auth hello!
{ authId: 403, nonce: <Buffer 14 ad ad 85 5f c9 6b 3f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 10 4f 74 8e 26 bc dc b0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b0 5d 2c 4f 7e ad 74 69>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b0 5d 2c 4f 7e ad 74 69> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.63:45650',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300450
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 32974
received auth hello!
{ authId: 403, nonce: <Buffer 90 12 cf 98 bb c0 36 9e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ed c1 c4 62 23 ad 9a e1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1a b2 de ba 90 eb 3d 8f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1a b2 de ba 90 eb 3d 8f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.63:45916',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300461
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33240
received auth hello!
{ authId: 403, nonce: <Buffer fd 37 84 be f4 6f 3a 38> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e8 cd d2 95 4c 78 49 ee>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cd ef c2 a4 4f 31 d0 a7>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer cd ef c2 a4 4f 31 d0 a7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.63:46182',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300472
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33502
received auth hello!
{ authId: 403, nonce: <Buffer 69 b2 18 03 d9 a7 de 12> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a4 3d 15 5e a8 69 9f 91>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 92 3d d8 bf e2 4e 58 40>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 92 3d d8 bf e2 4e 58 40> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.63:46444',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300483
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33768
received auth hello!
{ authId: 403, nonce: <Buffer 79 53 90 f2 0c 91 4f 8c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3d bf d2 dc 10 43 a3 cc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 72 28 b9 4e db 41 59 26>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 72 28 b9 4e db 41 59 26> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.63:46710',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300494
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34038
received auth hello!
{ authId: 403, nonce: <Buffer 12 00 88 7c 47 69 77 52> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8f a1 ef 40 65 42 7d 50>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 03 7a 53 7f 51 93 5a a0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 03 7a 53 7f 51 93 5a a0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.63:46980',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300505
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34304
received auth hello!
{ authId: 403, nonce: <Buffer 0e 58 19 49 41 8a a3 10> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 21 8d 5e 43 1d 5f c3 ac>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b2 d6 dd 77 bb 84 e2 7f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b2 d6 dd 77 bb 84 e2 7f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.63:47246',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300516
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34570
received auth hello!
{ authId: 403, nonce: <Buffer 8e 87 95 de c5 b9 5b 20> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4a cd a0 4e 45 57 ce 64>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 53 b0 4f c0 86 7e 67 8d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 53 b0 4f c0 86 7e 67 8d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.63:47512',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300527
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34836
received auth hello!
{ authId: 403, nonce: <Buffer 87 33 0b ef f6 2c 74 96> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f6 81 ea e7 49 e1 69 a7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0f dc 15 01 69 95 1f 21>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 0f dc 15 01 69 95 1f 21> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.63:47778',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300538
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35102
received auth hello!
{ authId: 403, nonce: <Buffer a6 3a dd 90 5b 3d 1f b0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 97 b4 bb 85 7b 7a c5 52>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 29 4b 9e da 99 7a a6 db>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 29 4b 9e da 99 7a a6 db> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.63:48044',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300549
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35368
received auth hello!
{ authId: 403, nonce: <Buffer 42 9b 94 75 4d ad ea 7b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 89 b7 ff eb 6d 34 10 0f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4c a5 40 06 af 1c f0 d3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4c a5 40 06 af 1c f0 d3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.63:48310',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300560
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35634
received auth hello!
{ authId: 403, nonce: <Buffer 43 16 b3 f4 e1 3a 6d 80> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9a c6 ec a3 7d b3 e6 8d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2d 6d 25 d1 eb 65 ab be>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 2d 6d 25 d1 eb 65 ab be> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.63:48576',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300571
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35900
received auth hello!
{ authId: 403, nonce: <Buffer 06 28 63 bf e6 f0 e9 a3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 91 eb ec 53 78 c7 bd 17>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 35 74 5a a0 83 83 2f 4a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 35 74 5a a0 83 83 2f 4a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.63:48842',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300582
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36166
received auth hello!
{ authId: 403, nonce: <Buffer 3a a1 d8 c4 b1 6f 50 66> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 88 8c 5a 0a a4 11 52 67>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f9 db f0 77 74 be 48 0b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f9 db f0 77 74 be 48 0b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.63:49108',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300593
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36420
received auth hello!
{ authId: 403, nonce: <Buffer 93 64 68 e6 97 b7 be f8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a6 a1 f4 9f 0a 92 a1 90>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f1 9f 75 76 8f aa 1a 86>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f1 9f 75 76 8f aa 1a 86> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.63:49362',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
