changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s409.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's409',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 67 49 42 41 41 4b 43 41 51 45 41 6f 6c ... > }
Handler: listening on port 22100
s409:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200838
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50942
received auth hello!
{ authId: 402, nonce: <Buffer c1 d4 b1 b9 61 f1 81 ad> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 2c 65 60 4b 0d ce 71 e0>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 62 51 f4 64 57 2e 0f a1 a7 b6 7d bb 96 ed 64 29>,
  macKeyVal: <Buffer e3 b8 3b d9 27 42 11 2f 85 59 a9 28 63 25 08 f8 aa f8 d4 ae ca e0 ca 78 f5 70 5e 29 63 35 8f 24>,
  absValidity: 2018-03-22T01:08:04.782Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 49 36 c2 da 5c e7 f7 37>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 49 36 c2 da 5c e7 f7 37> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.55:40110',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200845
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51130
received auth hello!
{ authId: 402, nonce: <Buffer db e8 55 bb 1a a1 74 b7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c7 46 c2 3d 3d 54 11 31>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 03 5f 0e 9a 6e 7e d4 80>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 03 5f 0e 9a 6e 7e d4 80> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.55:40296',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200852
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51400
received auth hello!
{ authId: 402, nonce: <Buffer 8c a0 58 a0 0a b3 9c 80> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 96 7a 7d f7 01 78 7b c9>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ef 27 15 91 80 46 cd b3>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ef 27 15 91 80 46 cd b3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.55:40568',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200859
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51670
received auth hello!
{ authId: 402, nonce: <Buffer a3 21 62 b3 90 6e e0 bc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8a 57 99 03 c6 e0 79 6b>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f0 f0 cb 4c 22 0d bb 7b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f0 f0 cb 4c 22 0d bb 7b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.55:40838',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200866
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51940
received auth hello!
{ authId: 402, nonce: <Buffer 1a 0f 28 af 4b b8 8b fd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6b ea 27 51 6d 1d 8d 8d>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 48 ef 65 52 c3 b1 57 c2>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 48 ef 65 52 c3 b1 57 c2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.55:41108',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200873
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52212
received auth hello!
{ authId: 402, nonce: <Buffer ab 04 a5 13 c6 57 c9 47> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 93 6e 74 03 78 39 26 98>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b5 b0 13 66 66 b4 dd 52>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b5 b0 13 66 66 b4 dd 52> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.55:41378',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200880
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52480
received auth hello!
{ authId: 402, nonce: <Buffer a1 6a 59 05 cf b1 6a 92> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 84 43 a4 23 7f cc 54 9a>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 88 ac cc 95 9e 36 c5 92>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 88 ac cc 95 9e 36 c5 92> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.55:41648',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
