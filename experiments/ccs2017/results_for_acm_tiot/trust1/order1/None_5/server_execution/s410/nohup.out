changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s410.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's410',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 35 5a ... > }
Handler: listening on port 22100
s410:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200836
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59896
received auth hello!
{ authId: 402, nonce: <Buffer 8b 81 01 37 c3 c8 b5 7c> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer c4 30 70 f7 59 61 25 71>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 88 71 09 d2 60 8a 1f d3 bd 9d 45 31 11 8b 7f 24>,
  macKeyVal: <Buffer 89 f7 c2 50 e0 66 0e 42 87 5a 28 b5 8d 9b 79 71 e3 e9 52 69 84 84 0e 6e d1 c4 0f 03 23 e6 e8 89>,
  absValidity: 2018-03-22T01:07:56.765Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 79 7a 60 ed 87 f1 ba 64>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 79 7a 60 ed 87 f1 ba 64> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.53:34328',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200843
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60070
received auth hello!
{ authId: 402, nonce: <Buffer 2b 03 94 10 9d 6c 2a 13> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6c 14 33 23 d4 17 58 c5>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 76 28 af 6c cd 59 22 8e>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 76 28 af 6c cd 59 22 8e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.53:34502',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200850
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60342
received auth hello!
{ authId: 402, nonce: <Buffer 85 f4 78 e4 39 e2 d4 81> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 25 b3 00 3d 75 35 a1 ea>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c9 77 10 28 42 82 02 2f>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c9 77 10 28 42 82 02 2f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.53:34774',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200857
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60612
received auth hello!
{ authId: 402, nonce: <Buffer 2d 34 14 51 c7 36 3b 19> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 49 4e df ed 8f 85 5e c9>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3c 83 c2 23 bd 73 81 1f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3c 83 c2 23 bd 73 81 1f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.53:35044',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200864
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60882
received auth hello!
{ authId: 402, nonce: <Buffer 9f 8b ac 2e a1 31 9d fe> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6f 57 21 ee 4f b2 db 05>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 95 2c b0 3e 16 c1 e1 3b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 95 2c b0 3e 16 c1 e1 3b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.53:35314',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200871
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 32920
received auth hello!
{ authId: 402, nonce: <Buffer 25 13 21 da 4f e9 f9 82> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 68 ce 58 ba e0 d9 b8 d8>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a2 83 fc 47 93 89 f7 20>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a2 83 fc 47 93 89 f7 20> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.53:35584',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200878
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33190
received auth hello!
{ authId: 402, nonce: <Buffer 38 f9 9a 6a cb 0d e6 32> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1a 4c 88 99 6c d5 47 3c>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 70 db 34 37 32 27 54 75>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 70 db 34 37 32 27 54 75> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.53:35854',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200885
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33460
received auth hello!
{ authId: 402, nonce: <Buffer 68 9d 05 2f b4 30 86 62> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fc cf 12 94 36 b4 93 c2>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cd 59 5f 81 c6 0c b1 07>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer cd 59 5f 81 c6 0c b1 07> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.53:36124',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
