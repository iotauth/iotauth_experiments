changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s513.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's513',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 75 74 ... > }
Handler: listening on port 22100
s513:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301477
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54326
received auth hello!
{ authId: 502, nonce: <Buffer a0 06 6c c4 d8 19 7b 6c> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer bf 51 aa 6c 89 f6 6f ca>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 26 83 63 e5 7b 8e 69 22 2e 92 2a b2 ad 86 b0 3d>,
  macKeyVal: <Buffer 34 27 75 9b 57 44 74 41 a0 d9 54 9a 86 88 10 7b 0a 7c 45 be 7f c3 e9 10 1e 14 7d ef aa 8d 57 53>,
  absValidity: 2018-03-22T01:09:21.688Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 08 e6 91 87 f8 20 b2 1f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 08 e6 91 87 f8 20 b2 1f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.79:39812',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301482
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54600
received auth hello!
{ authId: 502, nonce: <Buffer e3 06 c8 8f fc 2a ab 57> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f4 92 0a 4b 96 45 06 14>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 82 35 93 e5 fc 01 fd 7e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 82 35 93 e5 fc 01 fd 7e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.79:40084',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301487
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54868
received auth hello!
{ authId: 502, nonce: <Buffer 9a 37 0a 20 c6 87 1d b4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e9 cb 10 fc 73 3e c8 33>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 43 f2 4e 0f 31 63 0a 4a>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 43 f2 4e 0f 31 63 0a 4a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.79:40354',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301492
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55138
received auth hello!
{ authId: 502, nonce: <Buffer a8 de 97 b3 2a 07 9b 9b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c6 cf cd fa 3b 11 b2 7b>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3b ba c2 46 cf 14 72 f7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3b ba c2 46 cf 14 72 f7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.79:40624',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301497
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55408
received auth hello!
{ authId: 502, nonce: <Buffer c6 76 9a a8 62 76 87 a2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e6 b8 78 40 78 87 72 ea>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e7 6e b9 08 46 2a 9d aa>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e7 6e b9 08 46 2a 9d aa> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.79:40894',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301502
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55678
received auth hello!
{ authId: 502, nonce: <Buffer a0 98 b8 be 47 7e 61 e1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 57 63 6b 29 be 6c 63 2a>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cf 45 52 d9 a2 f4 bd 45>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer cf 45 52 d9 a2 f4 bd 45> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.79:41164',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301507
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55944
received auth hello!
{ authId: 502, nonce: <Buffer 79 22 1b 0c 45 08 5d 5b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f2 07 7e 1f df a2 70 f1>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1b 8a 05 b4 63 a3 7e 57>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 1b 8a 05 b4 63 a3 7e 57> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.79:41430',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
