changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s413.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's413',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 76 77 ... > }
Handler: listening on port 22100
s413:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301291
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44884
received auth hello!
{ authId: 403, nonce: <Buffer de f9 02 c3 d2 01 cb 0a> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer a8 02 ec b3 61 31 3c 3a>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer cd 0c 73 cc 80 c2 f4 20 1b 74 ff 5a ca 1f 85 0f>,
  macKeyVal: <Buffer 07 e4 65 6a 88 b9 df 0a dc 90 19 ed c3 22 58 30 f9 5d bf 2f c5 cd f1 3b b0 40 17 ea 88 a0 f8 97>,
  absValidity: 2018-03-22T01:08:11.446Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 48 c8 56 fc d4 db 1d 8e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 48 c8 56 fc d4 db 1d 8e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.58:51744',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301297
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45088
received auth hello!
{ authId: 403, nonce: <Buffer 73 c0 e9 0d 2b ff 7e eb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 20 60 20 2e 9d 5d 64 e6>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 24 81 17 d9 c9 67 32 d2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 24 81 17 d9 c9 67 32 d2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.58:51948',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301303
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45360
received auth hello!
{ authId: 403, nonce: <Buffer 6f 2b 3f 11 8e ab e6 02> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d3 0f 1d a7 21 2b 93 e8>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c5 86 5a 92 8f 82 9f 20>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c5 86 5a 92 8f 82 9f 20> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.58:52220',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301309
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45630
received auth hello!
{ authId: 403, nonce: <Buffer 8d fc 5f 59 8d d4 0d 84> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bd 2b 1b 8f 72 17 91 97>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4d 0a 4a 94 2d ba 80 ca>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4d 0a 4a 94 2d ba 80 ca> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.58:52490',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301315
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45900
received auth hello!
{ authId: 403, nonce: <Buffer 50 c1 e0 44 87 a5 f0 31> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 68 02 09 7e 36 0a fa 46>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0c 05 64 62 81 e5 98 37>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 0c 05 64 62 81 e5 98 37> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.58:52760',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301321
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46170
received auth hello!
{ authId: 403, nonce: <Buffer c1 46 55 c9 8b 05 77 2a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0c a6 31 1c 1a 9d 74 03>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7f bf dc ba 8e b1 38 b8>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 7f bf dc ba 8e b1 38 b8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.58:53030',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301327
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46440
received auth hello!
{ authId: 403, nonce: <Buffer a2 df b9 4f 8a f4 dd 69> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 03 a6 54 e1 ec c3 9b d1>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 14 45 59 2e 13 ed 6f 07>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 14 45 59 2e 13 ed 6f 07> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.58:53300',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301333
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46706
received auth hello!
{ authId: 403, nonce: <Buffer 06 09 4c 2f 1c d3 70 9f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 79 56 07 0a ce f4 09 11>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 09 29 bb 1a 62 7d 13 4b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 09 29 bb 1a 62 7d 13 4b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.58:53566',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
