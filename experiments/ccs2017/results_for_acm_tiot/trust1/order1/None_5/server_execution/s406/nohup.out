changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s406.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's406',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 33 6c ... > }
Handler: listening on port 22100
s406:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200833
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55636
received auth hello!
{ authId: 402, nonce: <Buffer 9b 6f 42 bb b7 e9 7c 59> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 04 5e e1 a8 82 50 0f 8f>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer b5 a5 68 34 7c 64 ff 9b c6 5b f1 16 38 66 c5 1d>,
  macKeyVal: <Buffer 73 76 16 09 b5 99 b2 22 bb b8 39 8a 89 5a 80 e1 43 a0 71 78 51 7a fb 98 bc b7 74 ed 81 74 03 d8>,
  absValidity: 2018-03-22T01:07:45.572Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 78 59 c4 b7 cf 94 fb 7e>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 78 59 c4 b7 cf 94 fb 7e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.50:42252',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200840
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55792
received auth hello!
{ authId: 402, nonce: <Buffer 8e 9a 1e ae a8 fc a0 98> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9c 0c eb 89 4a 8d 7e 48>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 98 7c ef c6 89 54 59 7c>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 98 7c ef c6 89 54 59 7c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.50:42408',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200847
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56054
received auth hello!
{ authId: 402, nonce: <Buffer a8 53 87 c9 1c bd 0e db> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 33 a1 c2 fe 67 ed 62 ff>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8b 04 25 28 40 43 a6 42>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8b 04 25 28 40 43 a6 42> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.50:42670',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200854
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56324
received auth hello!
{ authId: 402, nonce: <Buffer ea fd 13 a2 12 73 7b 60> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f0 94 2e d4 8e bf ce 5d>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 84 c6 de 0e 79 45 54 e4>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 84 c6 de 0e 79 45 54 e4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.50:42940',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200861
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56594
received auth hello!
{ authId: 402, nonce: <Buffer 48 a6 8b 6d 5c 6f ee 78> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f5 96 13 90 22 3b db f6>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 54 89 db 70 33 9b b4 f2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 54 89 db 70 33 9b b4 f2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.50:43210',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200868
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56864
received auth hello!
{ authId: 402, nonce: <Buffer 6b 39 37 f9 fe 3a 88 74> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bf c1 35 7f eb 0f 3b d1>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e3 8a 23 c7 40 fb 15 e2>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e3 8a 23 c7 40 fb 15 e2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.50:43480',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200875
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57134
received auth hello!
{ authId: 402, nonce: <Buffer ae 62 f5 00 56 bb 7c e0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b1 f5 dd 15 d1 bd aa 72>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9f e2 45 46 d6 b1 bb e3>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 9f e2 45 46 d6 b1 bb e3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.50:43750',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200882
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57404
received auth hello!
{ authId: 402, nonce: <Buffer 63 ed 5e 0f 42 dc 00 de> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 53 02 4a e4 dc e8 a0 e8>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 02 d2 34 fb 4a d3 23 6d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 02 d2 34 fb 4a d3 23 6d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.50:44020',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
