changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s516.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's516',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 33 73 ... > }
Handler: listening on port 22100
s516:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301480
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37556
received auth hello!
{ authId: 503, nonce: <Buffer 5b a6 db 42 7a 66 c4 3c> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer ff 4e 1f a9 d4 41 1a 40>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 34 72 2d 6e 21 e1 8f c4 f1 42 84 04 3a f8 6a 61>,
  macKeyVal: <Buffer d1 97 25 08 b2 ea f1 78 f2 d7 a6 93 f6 c0 1d b9 e2 71 15 b7 2c ff f7 87 46 41 e8 2e 1e 44 ea 71>,
  absValidity: 2018-03-22T01:09:30.564Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ff 0a 3c 4c 68 90 2c 76>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ff 0a 3c 4c 68 90 2c 76> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.82:46398',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301485
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37826
received auth hello!
{ authId: 503, nonce: <Buffer ae 66 44 60 46 aa 2e 3a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f6 e0 37 5d 39 64 11 1d>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 79 b2 ef 6d 28 5c 4c c5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 79 b2 ef 6d 28 5c 4c c5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.82:46668',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301490
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38096
received auth hello!
{ authId: 503, nonce: <Buffer 24 9c c2 1f 8d bc c9 83> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fd 8d 8e 4d 33 09 8a 96>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 25 7a f1 41 95 95 81 16>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 25 7a f1 41 95 95 81 16> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.82:46938',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301495
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38366
received auth hello!
{ authId: 503, nonce: <Buffer ba 37 00 6f b8 6f 38 b1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 20 30 39 3d 18 20 df c8>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 58 49 fc ac c3 90 48 5b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 58 49 fc ac c3 90 48 5b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.82:47208',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301500
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38636
received auth hello!
{ authId: 503, nonce: <Buffer 80 20 15 67 94 7a 12 2e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer dc 87 ca 4e a9 fe 0e b7>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 25 96 58 ff 6d a4 da 33>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 25 96 58 ff 6d a4 da 33> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.82:47478',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301505
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38906
received auth hello!
{ authId: 503, nonce: <Buffer d7 bd 07 e0 f2 77 c6 0c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fd 87 77 e1 be 7a cd 29>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b6 ff 8c b1 8d 6a 01 3b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b6 ff 8c b1 8d 6a 01 3b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.82:47748',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301510
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39164
received auth hello!
{ authId: 503, nonce: <Buffer 36 69 eb 23 ec 5c 2f 98> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 40 7a ce 2d ff 22 28 31>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f4 ea 43 f0 97 d3 df f4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f4 ea 43 f0 97 d3 df f4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.82:48006',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
