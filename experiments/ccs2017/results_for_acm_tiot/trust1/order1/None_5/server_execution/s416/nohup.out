changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s416.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's416',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 51 49 42 41 41 4b 43 41 51 45 41 35 7a ... > }
Handler: listening on port 22100
s416:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301293
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54568
received auth hello!
{ authId: 403, nonce: <Buffer cd 4c 0d 84 c3 b8 d2 9a> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 77 b0 6f 7a fc 42 d4 8f>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer b0 68 bf 77 c4 9b d6 f2 f1 c5 0c b4 4f 17 7c df>,
  macKeyVal: <Buffer 95 5e be 34 8c c5 17 62 72 b7 c3 6f c0 63 0c 99 f2 cc e7 ad 57 31 88 3a 36 40 47 a4 62 a1 bc 23>,
  absValidity: 2018-03-22T01:08:19.438Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4d 29 7e 55 43 87 bd 27>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 4d 29 7e 55 43 87 bd 27> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.60:58300',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301294
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54574
received auth hello!
{ authId: 403, nonce: <Buffer 8e ba f6 59 c0 0a bf 12> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8a 82 04 a2 ad b7 8e 0d>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1e ef 09 80 e3 06 92 3d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1e ef 09 80 e3 06 92 3d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.61:52630',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301299
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54782
received auth hello!
{ authId: 403, nonce: <Buffer 4b a1 20 c3 ce ee 3e 31> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 81 fa 7d 44 5b b9 2c d3>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1a ed e1 f7 bd fa 4f 53>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1a ed e1 f7 bd fa 4f 53> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.60:58512',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301300
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54798
received auth hello!
{ authId: 403, nonce: <Buffer 96 45 2f 3e 23 c3 6d c9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4b 57 79 fd a0 9f 77 c8>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 33 f2 db 29 87 57 d5 aa>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 33 f2 db 29 87 57 d5 aa> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.61:52852',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301305
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55056
received auth hello!
{ authId: 403, nonce: <Buffer b6 59 db 14 87 c1 a6 ce> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f5 60 ee 1d f8 99 05 4f>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 80 56 ae ae 9c 14 86 29>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 80 56 ae ae 9c 14 86 29> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.60:58784',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301306
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55068
received auth hello!
{ authId: 403, nonce: <Buffer 1b 19 01 cd 06 8e 35 92> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b0 5b 15 69 9f 92 8c 0a>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4c 73 8c bc ad 0e 13 ca>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4c 73 8c bc ad 0e 13 ca> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.61:53124',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301311
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55324
received auth hello!
{ authId: 403, nonce: <Buffer 20 67 30 86 c6 52 e3 b6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2a af d4 02 ab 07 0c 2a>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c5 08 d4 ec 24 a5 b2 d3>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c5 08 d4 ec 24 a5 b2 d3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.60:59054',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301312
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55338
received auth hello!
{ authId: 403, nonce: <Buffer 9b a8 85 26 5a c1 05 ee> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ec 4d 4c 5e 9e eb 9c 47>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e6 53 e0 83 da 46 bf 10>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e6 53 e0 83 da 46 bf 10> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.61:53394',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301317
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55594
received auth hello!
{ authId: 403, nonce: <Buffer f8 33 9c 89 60 e2 3c 84> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3c 64 2a 02 ae e2 72 2e>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 36 c1 af ce 1c c5 94 1a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 36 c1 af ce 1c c5 94 1a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.60:59324',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301318
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55608
received auth hello!
{ authId: 403, nonce: <Buffer 37 67 53 e2 d9 44 b7 1a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer be 31 23 91 9f 28 25 f6>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 41 1d 32 3a 81 9b a2 ac>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 41 1d 32 3a 81 9b a2 ac> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.61:53664',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301323
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55864
received auth hello!
{ authId: 403, nonce: <Buffer c8 3d 30 b4 38 a2 8a 76> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4d e5 49 f8 67 48 b7 8d>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 81 dc 17 5c 53 47 a7 4b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 81 dc 17 5c 53 47 a7 4b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.60:59594',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301324
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55878
received auth hello!
{ authId: 403, nonce: <Buffer a0 a0 3f 40 6d 7a 0a 74> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9d 82 89 8d 23 c8 ef 51>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer eb da 74 66 b3 4c ef 16>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer eb da 74 66 b3 4c ef 16> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.61:53934',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301329
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56134
received auth hello!
{ authId: 403, nonce: <Buffer 23 25 3f 34 e3 d0 65 97> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3e 44 20 80 64 e7 0d 4f>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bb ba 7e 6b 7d fe df 44>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer bb ba 7e 6b 7d fe df 44> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.60:59864',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301330
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56148
received auth hello!
{ authId: 403, nonce: <Buffer 09 98 b5 c8 4c e2 2d fd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b7 ff f4 c3 7d b1 a8 e8>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2c 11 3f b2 07 06 37 a2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2c 11 3f b2 07 06 37 a2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.61:54204',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301335
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56400
received auth hello!
{ authId: 403, nonce: <Buffer 1b 99 dc 93 a1 ba 66 e0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c7 2b 95 cf a7 40 16 76>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cd 32 23 91 ac 00 78 4f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer cd 32 23 91 ac 00 78 4f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.60:60130',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301336
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56418
Handler: Error in server - details: Error occurred in session key request: Error: read ECONNRESET
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
