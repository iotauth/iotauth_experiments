changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s405.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's405',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 74 59 ... > }
Handler: listening on port 22100
s405:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200832
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51456
received auth hello!
{ authId: 402, nonce: <Buffer 93 eb 13 d5 e3 bd 5b d9> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer ce d4 8e 75 b6 84 08 ff>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 8e 77 af 8c fe d4 7f 15 ed 2c 01 b7 4e d6 3d 31>,
  macKeyVal: <Buffer 5a 27 c2 7b c1 5c 55 5d 18 13 1e b0 2c 04 da d0 9b ef dc 99 46 d5 9f 66 05 83 34 94 22 88 e7 4b>,
  absValidity: 2018-03-22T01:07:42.351Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 00 d1 09 c4 66 a2 4e f1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 00 d1 09 c4 66 a2 4e f1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.49:33950',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200839
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51606
received auth hello!
{ authId: 402, nonce: <Buffer 1d 3e 7c c6 8e 8b 28 f5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 60 b0 a2 10 e1 4f 24 ad>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ea e5 e9 0e 63 b7 67 4c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ea e5 e9 0e 63 b7 67 4c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.49:34100',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200846
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51862
received auth hello!
{ authId: 402, nonce: <Buffer 1c 06 07 9c 50 92 8b 59> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e5 15 8f 16 0e 33 75 f0>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cb b6 0c 00 63 f0 9a cc>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer cb b6 0c 00 63 f0 9a cc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.49:34356',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200853
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52132
received auth hello!
{ authId: 402, nonce: <Buffer 14 58 fd 29 95 4e 3f f4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 29 8c 83 9b 00 35 79 f2>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c4 a0 b0 35 c3 e3 93 bf>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c4 a0 b0 35 c3 e3 93 bf> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.49:34626',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200860
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52402
received auth hello!
{ authId: 402, nonce: <Buffer 3c fa 8b 97 8a e0 e5 24> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c2 fb 54 f7 96 c9 a9 80>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f9 6a 51 44 18 ca 62 b5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f9 6a 51 44 18 ca 62 b5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.49:34896',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200867
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52672
received auth hello!
{ authId: 402, nonce: <Buffer 00 15 65 c0 6e 44 6e 1b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 26 4d 53 65 43 78 73 23>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ea dd fa 52 3e e3 af ab>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ea dd fa 52 3e e3 af ab> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.49:35166',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200874
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52942
received auth hello!
{ authId: 402, nonce: <Buffer 51 8c 9c 5c 98 98 2a 3e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9e 2d 98 43 ef 24 ef c5>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e8 fa 43 96 c7 0c 30 f5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e8 fa 43 96 c7 0c 30 f5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.49:35436',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200881
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53212
received auth hello!
{ authId: 402, nonce: <Buffer 28 43 91 87 31 96 66 c4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f6 71 7b 39 7f 6a 25 c5>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 14 90 fc fd e3 d7 f4 5c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 14 90 fc fd e3 d7 f4 5c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.49:35706',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
