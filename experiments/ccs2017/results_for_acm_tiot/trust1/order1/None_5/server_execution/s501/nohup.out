changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s501.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's501',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 78 42 ... > }
Handler: listening on port 22100
s501:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101258
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40712
received auth hello!
{ authId: 501, nonce: <Buffer f9 35 df 25 f6 1f 6e c9> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 40 79 c0 bd 5c 4f 35 ec>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 93 d9 64 ae 18 9a ee 8d a6 db 33 80 7c bc 0b 8e>,
  macKeyVal: <Buffer 84 d0 f0 d3 1f 81 37 99 32 78 bc cf b4 5d 8a 97 5e 49 12 2c 47 c0 2d 81 f3 f7 39 aa a9 57 b2 e2>,
  absValidity: 2018-03-22T01:08:24.534Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ad 55 67 3f bf d2 29 fc>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ad 55 67 3f bf d2 29 fc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.62:51018',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101266
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40942
received auth hello!
{ authId: 501, nonce: <Buffer 79 0d a2 c5 ff e9 3f 0d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 71 b3 e5 83 0f ce 86 9e>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ce 6a 97 53 f8 20 30 ed>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ce 6a 97 53 f8 20 30 ed> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.62:51248',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101274
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41212
received auth hello!
{ authId: 501, nonce: <Buffer 07 b6 cd ad 21 55 3d 56> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a4 a1 7e c3 f6 13 1f 03>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f2 bf a4 84 4b ee 2d 22>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f2 bf a4 84 4b ee 2d 22> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.62:51518',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101282
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41482
received auth hello!
{ authId: 501, nonce: <Buffer 10 9c db 7d e9 79 fe a6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c1 87 5e 5c 45 ed 1f f7>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bd 01 47 05 04 ff cb e3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bd 01 47 05 04 ff cb e3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.62:51788',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101290
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41752
received auth hello!
{ authId: 501, nonce: <Buffer ce 44 b9 ef 52 b3 d8 aa> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 24 23 30 76 c7 47 ab 09>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8d 82 e3 59 9b ef 0d 89>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8d 82 e3 59 9b ef 0d 89> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.62:52058',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101298
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42022
received auth hello!
{ authId: 501, nonce: <Buffer b3 2d 62 59 01 17 9e c8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0c 78 60 14 52 35 37 54>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 45 89 2c 1b de 0f 12 de>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 45 89 2c 1b de 0f 12 de> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.62:52328',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101306
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42292
received auth hello!
{ authId: 501, nonce: <Buffer 17 6b d0 f9 22 5a bf f3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e1 96 a7 31 15 84 b8 74>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d2 73 f9 c5 bc 86 69 cd>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d2 73 f9 c5 bc 86 69 cd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.62:52598',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
