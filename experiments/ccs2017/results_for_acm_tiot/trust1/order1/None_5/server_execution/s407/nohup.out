changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s407.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's407',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 6f 66 ... > }
Handler: listening on port 22100
s407:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200834
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43792
received auth hello!
{ authId: 402, nonce: <Buffer 23 3b c6 17 98 fd 65 bf> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer c4 d8 e9 2e 14 42 26 92>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer ec 52 77 95 1a 1c e1 3b ee 39 7f d4 bb 08 c9 64>,
  macKeyVal: <Buffer 03 c0 0d 38 ab ae 56 f4 82 83 03 b8 ed 74 94 63 60 6c d5 55 f7 e0 d2 39 5b bf ce 90 8c e9 ab d3>,
  absValidity: 2018-03-22T01:07:48.827Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8d 2d 5f 40 4f f8 8c 64>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8d 2d 5f 40 4f f8 8c 64> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.51:44188',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200841
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43954
received auth hello!
{ authId: 402, nonce: <Buffer c5 b3 4f 5e be a0 7e 76> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 88 fb 86 6c 9f cd e0 6f>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b2 54 67 ed 0c 55 d1 fc>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b2 54 67 ed 0c 55 d1 fc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.51:44350',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200848
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44222
received auth hello!
{ authId: 402, nonce: <Buffer 03 88 ca 36 ff 91 f0 0c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ef cb 9b 8f 87 d5 0c 66>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 95 c7 3c 1e 2c 7b 90 f7>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 95 c7 3c 1e 2c 7b 90 f7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.51:44618',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200855
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44492
received auth hello!
{ authId: 402, nonce: <Buffer 02 69 72 1c d8 e8 da f7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 23 45 90 fc ea 67 56 28>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d5 be 35 6b 13 6d 63 6b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer d5 be 35 6b 13 6d 63 6b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.51:44888',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200862
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44762
received auth hello!
{ authId: 402, nonce: <Buffer 57 c9 a6 9e fd 6e 15 2a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bc 29 04 cf 6c af ec 58>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 37 b8 d1 6d 7c a7 d6 a6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 37 b8 d1 6d 7c a7 d6 a6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.51:45158',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200869
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45032
received auth hello!
{ authId: 402, nonce: <Buffer 81 75 7e be 79 c6 17 1d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2d 17 8c 67 d0 7e 37 bc>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cd 02 d6 38 81 1f 60 11>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer cd 02 d6 38 81 1f 60 11> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.51:45428',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200876
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45302
received auth hello!
{ authId: 402, nonce: <Buffer 22 76 ca 69 eb 55 be a0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5f 4e 17 c4 16 ab ba 12>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 07 0c b3 03 fc ff a0 58>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 07 0c b3 03 fc ff a0 58> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.51:45698',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200883
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45572
received auth hello!
{ authId: 402, nonce: <Buffer 83 50 51 52 ca e3 2f 33> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6c f5 a6 41 27 48 19 ab>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c4 51 7d 60 62 9a 22 c3>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c4 51 7d 60 62 9a 22 c3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.51:45968',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
