changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c504.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c504',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 78 42 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521648376317
connected to auth! from local port 41508
received auth hello!
{ authId: 504, nonce: <Buffer f9 ba 70 bc 42 7e 13 85> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer c5 35 97 0b 8e 24 f0 44>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer fb bc 60 94 9f be ae 40 50 92 d6 77 7d 18 6d 2f>,
  macKeyVal: <Buffer 81 e5 35 b4 3d 1d c2 92 b5 16 42 25 7c c4 e5 0f c5 f2 42 6f 6f c7 f7 cf 17 3e fd f5 47 4e f8 fd>,
  absValidity: 2018-03-21T17:06:16.480Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400226,
  cipherKeyVal: <Buffer fe 13 6b be 5c 7b cd 6d 40 b0 a9 eb 14 8d 47 c7>,
  macKeyVal: <Buffer 9c 77 99 d3 ce 56 fd 4b b5 1c bf 1f b4 47 f7 c4 36 0a 66 a8 7a 64 f2 2a 29 7d 27 2b 59 9b c4 9e>,
  absValidity: 2018-03-22T16:06:16.479Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50400226,
     cipherKeyVal: <Buffer fe 13 6b be 5c 7b cd 6d 40 b0 a9 eb 14 8d 47 c7>,
     macKeyVal: <Buffer 9c 77 99 d3 ce 56 fd 4b b5 1c bf 1f b4 47 f7 c4 36 0a 66 a8 7a 64 f2 2a 29 7d 27 2b 59 9b c4 9e>,
     absValidity: 2018-03-22T16:06:16.479Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer f1 b7 27 c8 5a 9b 01 60>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 16:06:17 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521648377307
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521648436374
connected to auth! from local port 41756
received auth hello!
{ authId: 504, nonce: <Buffer 49 2b 49 7c 70 ec 7d 11> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 58 6a 35 aa 5c 6d 9f f9>
auth nonce verified
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400228,
  cipherKeyVal: <Buffer 86 ff 6f 3a ba da fa 7d 72 22 a0 55 f4 af e8 c4>,
  macKeyVal: <Buffer 65 5e 6a 48 ff 37 7a 76 81 3b 84 74 25 7d 13 cf 7d 57 90 58 9f 76 88 1a 59 38 73 de 3d 81 db 86>,
  absValidity: 2018-03-22T16:07:16.579Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50400228,
     cipherKeyVal: <Buffer 86 ff 6f 3a ba da fa 7d 72 22 a0 55 f4 af e8 c4>,
     macKeyVal: <Buffer 65 5e 6a 48 ff 37 7a 76 81 3b 84 74 25 7d 13 cf 7d 57 90 58 9f 76 88 1a 59 38 73 de 3d 81 db 86>,
     absValidity: 2018-03-22T16:07:16.579Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 02 8c 04 13 ec aa 99 d1>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 16:07:17 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521648437835
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521648496432
connected to auth! from local port 42026
received auth hello!
{ authId: 504, nonce: <Buffer 68 6a f4 6b c0 32 ac c9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 74 61 61 56 81 4e e1 32>
auth nonce verified
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400234,
  cipherKeyVal: <Buffer 4f 1b 47 89 69 82 a7 a6 6e ed 65 65 4d c6 ee ec>,
  macKeyVal: <Buffer e4 22 ea 40 94 64 5e ce 3f bd 33 1d c7 a8 53 69 a5 8a e1 1b 39 b9 10 21 47 b9 b9 d8 33 e8 4f fb>,
  absValidity: 2018-03-22T16:08:16.635Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50400234,
     cipherKeyVal: <Buffer 4f 1b 47 89 69 82 a7 a6 6e ed 65 65 4d c6 ee ec>,
     macKeyVal: <Buffer e4 22 ea 40 94 64 5e ce 3f bd 33 1d c7 a8 53 69 a5 8a e1 1b 39 b9 10 21 47 b9 b9 d8 33 e8 4f fb>,
     absValidity: 2018-03-22T16:08:16.635Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 71 43 6f 95 11 31 e9 63>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 16:08:17 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521648497786
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521648556489
connected to auth! from local port 42296
received auth hello!
{ authId: 504, nonce: <Buffer be 39 90 a9 d4 f9 b7 32> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f7 9c ad 0a 7b 24 5c d9>
auth nonce verified
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400240,
  cipherKeyVal: <Buffer 1b 61 2d ef f5 2b b8 9c 6d 64 8c 78 16 8e f1 75>,
  macKeyVal: <Buffer d8 20 77 df cf ef 31 09 53 62 45 92 51 73 f8 4b 7e eb eb 6f e4 5f 4b aa b9 d0 d5 de 1c 76 1d 24>,
  absValidity: 2018-03-22T16:09:16.670Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50400240,
     cipherKeyVal: <Buffer 1b 61 2d ef f5 2b b8 9c 6d 64 8c 78 16 8e f1 75>,
     macKeyVal: <Buffer d8 20 77 df cf ef 31 09 53 62 45 92 51 73 f8 4b 7e eb eb 6f e4 5f 4b aa b9 d0 d5 de 1c 76 1d 24>,
     absValidity: 2018-03-22T16:09:16.670Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 06 49 10 a2 2a e8 b6 40>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 16:09:17 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521648557796
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521648616548
connected to auth! from local port 42566
received auth hello!
{ authId: 504, nonce: <Buffer b3 6c b5 d1 39 48 88 5e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5d f1 f0 e8 89 c7 f8 83>
auth nonce verified
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400246,
  cipherKeyVal: <Buffer 7e 81 ba 9f e9 19 0e 4b f1 da cf a8 b6 ed a9 78>,
  macKeyVal: <Buffer bd cb 86 ca 40 f7 f7 ec 0d 37 9f 71 dc 8d f4 b2 b5 58 a5 f1 b7 9b 87 01 51 72 0d 91 9a ae 7a 02>,
  absValidity: 2018-03-22T16:10:16.720Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50400246,
     cipherKeyVal: <Buffer 7e 81 ba 9f e9 19 0e 4b f1 da cf a8 b6 ed a9 78>,
     macKeyVal: <Buffer bd cb 86 ca 40 f7 f7 ec 0d 37 9f 71 dc 8d f4 b2 b5 58 a5 f1 b7 9b 87 01 51 72 0d 91 9a ae 7a 02>,
     absValidity: 2018-03-22T16:10:16.720Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 8f a8 02 32 0b b9 04 7c>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 16:10:17 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521648617864
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521648676605
connected to auth! from local port 42836
received auth hello!
{ authId: 504, nonce: <Buffer df f5 49 bf d4 df 2e b4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cf 9b 71 94 6b 3a c0 df>
auth nonce verified
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400252,
  cipherKeyVal: <Buffer 25 d0 19 d8 7f a3 35 5e 34 fb f5 b5 08 85 98 27>,
  macKeyVal: <Buffer b8 56 c7 60 6b 44 a6 96 42 86 3d d1 d6 07 b3 00 08 4e 09 b8 c2 6f 08 45 11 5c 82 35 da d0 ee d0>,
  absValidity: 2018-03-22T16:11:16.768Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50400252,
     cipherKeyVal: <Buffer 25 d0 19 d8 7f a3 35 5e 34 fb f5 b5 08 85 98 27>,
     macKeyVal: <Buffer b8 56 c7 60 6b 44 a6 96 42 86 3d d1 d6 07 b3 00 08 4e 09 b8 c2 6f 08 45 11 5c 82 35 da d0 ee d0>,
     absValidity: 2018-03-22T16:11:16.768Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 88 81 6a 70 5f 26 bb e2>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 16:11:17 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521648677998
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521648736606
connected to auth! from local port 43106
received auth hello!
{ authId: 504, nonce: <Buffer 20 94 0e 93 cb fd 9c a0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 15 bc 3a 4a 86 99 6f 3f>
auth nonce verified
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50400258,
  cipherKeyVal: <Buffer 71 6a ed 16 88 c5 1e fd 56 f2 8f 96 c7 b9 3a c0>,
  macKeyVal: <Buffer 4d 2e 23 fa c4 27 4d b7 2a b3 00 46 ee ac ed f8 1d 1e 38 82 3f 92 6c 3f 2b 43 bd 91 e4 3d f1 75>,
  absValidity: 2018-03-22T16:12:16.779Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.26',
  serverPort: 22100,
  sessionKey: 
   { id: 50400258,
     cipherKeyVal: <Buffer 71 6a ed 16 88 c5 1e fd 56 f2 8f 96 c7 b9 3a c0>,
     macKeyVal: <Buffer 4d 2e 23 fa c4 27 4d b7 2a b3 00 46 ee ac ed f8 1d 1e 38 82 3f 92 6c 3f 2b 43 bd 91 e4 3d f1 75>,
     absValidity: 2018-03-22T16:12:16.779Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 70 09 9b 0e f7 31 0f 4b>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 16:12:17 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521648737867
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521648796662
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 9 0.7777777777777778 1521648856672
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 10 0.7 1521648916677
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 11 0.6363636363636364 1521648976687
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 12 0.5833333333333334 1521649036697
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 13 0.5384615384615384 1521649096707
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 14 0.5 1521649156720
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 15 0.4666666666666667 1521649216730
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 16 0.4375 1521649276739
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 17 0.4117647058823529 1521649336742
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 18 0.3888888888888889 1521649396749
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 19 0.3684210526315789 1521649456760
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 20 0.35 1521649516770
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 21 0.3333333333333333 1521649576781
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 22 0.3181818181818182 1521649636783
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 23 0.30434782608695654 1521649696794
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 24 0.2916666666666667 1521649756804
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 25 0.28 1521649816813
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 26 0.2692307692307692 1521649876821
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 27 0.25925925925925924 1521649936825
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
