changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c410.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c410',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 67 49 42 41 41 4b 43 41 51 45 41 36 70 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521614193239
connected to auth! from local port 56832
received auth hello!
{ authId: 402, nonce: <Buffer fd 9c 98 43 d2 e6 1a 1e> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 03 d1 9f 9c 11 3e fc 26>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer f9 38 bc 17 b4 73 99 16 a9 f0 a6 f8 88 28 1f a9>,
  macKeyVal: <Buffer 87 a9 51 3d 25 e1 55 14 fc e9 9d 6a f2 33 cf 1a 42 16 ed 66 d8 47 a4 84 a1 ae b8 e6 d3 e5 fa 76>,
  absValidity: 2018-03-21T07:36:33.412Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200309,
  cipherKeyVal: <Buffer cb b7 ac e4 6a 82 89 cb 90 d9 a6 0f e2 6f 89 1d>,
  macKeyVal: <Buffer 89 bd 1f 81 d7 fd 34 3f 31 16 b8 d4 69 53 a6 da 23 f3 4f e8 65 71 58 48 30 12 fb 69 cc ff 6c 4b>,
  absValidity: 2018-03-22T06:36:33.411Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200309,
     cipherKeyVal: <Buffer cb b7 ac e4 6a 82 89 cb 90 d9 a6 0f e2 6f 89 1d>,
     macKeyVal: <Buffer 89 bd 1f 81 d7 fd 34 3f 31 16 b8 d4 69 53 a6 da 23 f3 4f e8 65 71 58 48 30 12 fb 69 cc ff 6c 4b>,
     absValidity: 2018-03-22T06:36:33.411Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 3f ae 68 09 35 b7 02 ae>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 06:36:34 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521614194902
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521614253255
connected to auth! from local port 57000
received auth hello!
{ authId: 402, nonce: <Buffer 8f 94 51 98 cb 71 a6 6d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 41 02 3b 07 73 3d fd 69>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200316,
  cipherKeyVal: <Buffer 83 8d a2 f9 5d c2 e0 b5 86 6f 83 bc 60 91 c9 b8>,
  macKeyVal: <Buffer b9 1f 18 21 e1 b7 a4 f2 96 94 67 6f 82 8e 49 83 c5 27 a4 bd af 50 35 40 39 cd 4d 0e 1d 27 59 f3>,
  absValidity: 2018-03-22T06:37:33.482Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200316,
     cipherKeyVal: <Buffer 83 8d a2 f9 5d c2 e0 b5 86 6f 83 bc 60 91 c9 b8>,
     macKeyVal: <Buffer b9 1f 18 21 e1 b7 a4 f2 96 94 67 6f 82 8e 49 83 c5 27 a4 bd af 50 35 40 39 cd 4d 0e 1d 27 59 f3>,
     absValidity: 2018-03-22T06:37:33.482Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 22 e8 a5 e5 1e c6 05 ee>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 06:37:34 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521614254995
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521614313304
connected to auth! from local port 57270
received auth hello!
{ authId: 402, nonce: <Buffer 63 83 39 34 36 4f 05 f9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fc 5e fc ad 83 62 65 6a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200323,
  cipherKeyVal: <Buffer 6f 9b a1 94 7a 3b 36 d0 c9 11 13 9f 64 f4 4b 59>,
  macKeyVal: <Buffer 28 fe 02 fa 2b 21 c9 34 9f 09 53 f8 b3 65 26 a5 83 9f 7f 2d 41 49 e4 da e0 69 62 2c 38 09 6f 04>,
  absValidity: 2018-03-22T06:38:33.639Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200323,
     cipherKeyVal: <Buffer 6f 9b a1 94 7a 3b 36 d0 c9 11 13 9f 64 f4 4b 59>,
     macKeyVal: <Buffer 28 fe 02 fa 2b 21 c9 34 9f 09 53 f8 b3 65 26 a5 83 9f 7f 2d 41 49 e4 da e0 69 62 2c 38 09 6f 04>,
     absValidity: 2018-03-22T06:38:33.639Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 46 5a ab 8a ac 26 9e c5>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 06:38:34 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521614315176
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521614373358
connected to auth! from local port 57542
received auth hello!
{ authId: 402, nonce: <Buffer d3 ba 40 7d 75 a8 49 3a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 78 36 ee 32 52 e7 69 ee>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200330,
  cipherKeyVal: <Buffer 63 0f ab e6 43 2d ac 64 6a 0e d7 8c 40 12 e5 31>,
  macKeyVal: <Buffer 22 25 56 92 1c 94 41 d8 3b f0 d0 1a 74 12 c5 49 4c c8 2d d4 f6 7e 6a b1 c8 11 f8 0d 7b 2b 28 63>,
  absValidity: 2018-03-22T06:39:33.603Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200330,
     cipherKeyVal: <Buffer 63 0f ab e6 43 2d ac 64 6a 0e d7 8c 40 12 e5 31>,
     macKeyVal: <Buffer 22 25 56 92 1c 94 41 d8 3b f0 d0 1a 74 12 c5 49 4c c8 2d d4 f6 7e 6a b1 c8 11 f8 0d 7b 2b 28 63>,
     absValidity: 2018-03-22T06:39:33.603Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 73 d5 e6 8c d9 29 19 ca>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 06:39:34 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521614375127
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521614433403
connected to auth! from local port 57812
received auth hello!
{ authId: 402, nonce: <Buffer 39 03 6f cc 43 21 b4 12> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f0 db 4f 7b 3b b1 f7 3c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200337,
  cipherKeyVal: <Buffer af c4 ad 83 58 1f 5c 85 08 ec 47 69 00 2f 65 2d>,
  macKeyVal: <Buffer b3 38 04 ec 74 df e4 bc 0d 4c 5d 34 e8 5a 56 6a 75 c5 75 cb 61 b4 fc 55 48 4d 8b 7f 75 83 d8 7d>,
  absValidity: 2018-03-22T06:40:33.605Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200337,
     cipherKeyVal: <Buffer af c4 ad 83 58 1f 5c 85 08 ec 47 69 00 2f 65 2d>,
     macKeyVal: <Buffer b3 38 04 ec 74 df e4 bc 0d 4c 5d 34 e8 5a 56 6a 75 c5 75 cb 61 b4 fc 55 48 4d 8b 7f 75 83 d8 7d>,
     absValidity: 2018-03-22T06:40:33.605Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 8b cb d3 3c 3b 64 ad 9d>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 06:40:34 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521614435269
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521614493461
connected to auth! from local port 58082
received auth hello!
{ authId: 402, nonce: <Buffer 35 c9 39 00 37 8e 8c ad> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 18 d5 b0 57 c8 92 34 2f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200344,
  cipherKeyVal: <Buffer 64 12 b5 d4 bf 4e 8d 48 2c ee 97 2e cb 88 8a e1>,
  macKeyVal: <Buffer 81 39 f4 d9 c6 48 cd 57 0b 90 b8 f8 98 e9 50 00 42 d7 92 5f 30 0d 69 0b 85 51 45 c8 d0 a0 a7 44>,
  absValidity: 2018-03-22T06:41:33.767Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200344,
     cipherKeyVal: <Buffer 64 12 b5 d4 bf 4e 8d 48 2c ee 97 2e cb 88 8a e1>,
     macKeyVal: <Buffer 81 39 f4 d9 c6 48 cd 57 0b 90 b8 f8 98 e9 50 00 42 d7 92 5f 30 0d 69 0b 85 51 45 c8 d0 a0 a7 44>,
     absValidity: 2018-03-22T06:41:33.767Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 25 0f 31 c7 32 be 1a 0f>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 06:41:34 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521614495248
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521614553517
connected to auth! from local port 58352
received auth hello!
{ authId: 402, nonce: <Buffer a9 e0 b5 81 fa 53 81 13> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a5 df 81 af cd 29 36 f2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200351,
  cipherKeyVal: <Buffer d9 5e 0d 06 9d 54 62 ec cf 3f 01 5f 6e d1 f7 cd>,
  macKeyVal: <Buffer a9 5a ff d5 6c 51 11 6f f1 84 56 dd 5d 5c 46 8f 6d af 4a 4e 5b cc 07 96 bf 48 ad c7 ad 71 f1 87>,
  absValidity: 2018-03-22T06:42:33.720Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200351,
     cipherKeyVal: <Buffer d9 5e 0d 06 9d 54 62 ec cf 3f 01 5f 6e d1 f7 cd>,
     macKeyVal: <Buffer a9 5a ff d5 6c 51 11 6f f1 84 56 dd 5d 5c 46 8f 6d af 4a 4e 5b cc 07 96 bf 48 ad c7 ad 71 f1 87>,
     absValidity: 2018-03-22T06:42:33.720Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 1b 0f 1a a4 bf 16 bd ee>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 06:42:34 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521614555302
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521614613540
connected to auth! from local port 58618
received auth hello!
{ authId: 402, nonce: <Buffer ac b5 34 08 c9 e1 8c 17> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2c e2 56 8e 5a 9a b5 11>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200358,
  cipherKeyVal: <Buffer f2 d8 15 9f 1f 1d a7 ac 17 01 00 2c 84 9c 1e d7>,
  macKeyVal: <Buffer f0 55 85 92 71 5f b5 55 18 b7 5b ca 9b fd 8c ed 04 b6 f8 82 c9 e0 63 12 3d 10 eb 95 69 81 ce 2b>,
  absValidity: 2018-03-22T06:43:33.783Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200358,
     cipherKeyVal: <Buffer f2 d8 15 9f 1f 1d a7 ac 17 01 00 2c 84 9c 1e d7>,
     macKeyVal: <Buffer f0 55 85 92 71 5f b5 55 18 b7 5b ca 9b fd 8c ed 04 b6 f8 82 c9 e0 63 12 3d 10 eb 95 69 81 ce 2b>,
     absValidity: 2018-03-22T06:43:33.783Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer c8 56 cc b5 22 c6 1c 45>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 06:43:34 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 8 1 1521614615153
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 9 0.8888888888888888 1521614673599
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 10 0.8 1521614733610
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 39862
received auth hello!
{ authId: 503, nonce: <Buffer 59 b2 57 40 ab 89 6d a6> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth503',
     commonName: '10.0.1.6' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth402',
     commonName: '10.0.0.2' },
  serial: '016247448955',
  notBefore: 2018-03-21T06:33:16.000Z,
  notAfter: 2018-03-22T06:34:56.000Z,
  subjectHash: '5542437f',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '17:CF:DE:B6:D5:09:75:D3:B7:40:FB:C7:C2:D2:BA:55:D2:6C:EE:E6',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'E2C77ADB548D185210E7FA2988369325521D9CF6957B61D640674333307D4FC133154B2C56A9BBCE5655BEDE59A620D2F68A660E6DEB43308DBAFD7A396559B1C6BD0ED769D2F4066CEB2BFDB38188C4D295C06D196ECCC621767B060A3D3BCF3CF4458D7031B2D0AB66B8846DD9C1D4374DEB5D3E30D68FF926574682526527828E3BB232E36626859A826F5DA69748C9567F01930811E1C310842AAE799D7FAD1E9BE8B5D23DC0BC0D4537FC44D1FE7D84E57938DEE6D651DAEC8C897885315FE2797FFB87939E2A342186F4C566B1623BD369CC0226678E3A96E9092471F81CCC14C868DBEA8B6F0B2E5D566294136E91C2B3B101366D8A5B6642614F0CF5',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.6' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 503,
  host: '10.0.1.6',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJHRIlVMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDIxETAPBgNVBAMMCDEwLjAuMC4yMB4XDTE4MDMy\nMTA2MzMxNloXDTE4MDMyMjA2MzQ1NlowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMzERMA8GA1UEAwwIMTAuMC4xLjYwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDix3rbVI0YUhDn+imINpMlUh2c9pV7YdZAZ0MzMH1PwTMVSyxW\nqbvOVlW+3lmmINL2imYObetDMI26/Xo5ZVmxxr0O12nS9AZs6yv9s4GIxNKVwG0Z\nbszGIXZ7Bgo9O8889EWNcDGy0KtmuIRt2cHUN03rXT4w1o/5JldGglJlJ4KOO7Iy\n42YmhZqCb12ml0jJVn8BkwgR4cMQhCqueZ1/rR6b6LXSPcC8DUU3/ETR/n2E5Xk4\n3ubWUdrsjIl4hTFf4nl/+4eTnio0IYb0xWaxYjvTacwCJmeOOpbpCSRx+BzMFMho\n2+qLbwsuXVZilBNukcKzsQE2bYpbZkJhTwz1AgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQYwDQYJKoZIhvcNAQELBQADggEBABYhpM52doni6a6R3Or4nzfAvq527r0g\nEBz00RfOW9xa8MuV7aGXT4ijaiI9v0ajnopbJXO28pQScI8ubk+AjpQ9MwqWRX2i\nfBkNHWzpwLSdjab5ziPn2TbV0oFyajNeyl5OPFeAYd/e8UICR3ylSNgZuqHa43Ah\nA/YBp5gNM+k3ziJyBI5Uc0lsi8srV/b4Bj39RYKHQR5gNJ+ydPYloe2Hnq+jFwIw\npPwe47uxbdHaqUKzigeiDic/3KDbylf9y473m1Lu4lg6Sak5HAw+FWWcOiFnTqXR\nK3g8Afchz7l8SLFBXNPwc4RBhNxh6tydzpO/dndDwqqhuMF7cuUEPgs=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 11 0.7272727272727273 1521614793621
connected to auth! from local port 40076
received auth hello!
{ authId: 503, nonce: <Buffer 3e 48 0d 2d 82 bf 31 e2> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 57 fe 05 9e ff 3c d8 f5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 4a 8c 04 17 c6 b0 ba 85 cb cf 63 0f 61 3f 56 52>,
  macKeyVal: <Buffer ac d4 7c 91 ed b3 87 9a 27 bd d0 e4 61 c0 ee dd 2c 78 e4 22 6f 67 3b f4 ab 08 25 54 2e c2 ec e4>,
  absValidity: 2018-03-21T07:46:33.769Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300650,
  cipherKeyVal: <Buffer 91 45 32 98 f2 9a 4e 79 38 45 1e 23 fd dd 4a b1>,
  macKeyVal: <Buffer a9 83 46 e4 9c 72 d6 59 9c d8 0e fe 7f 31 f2 40 dd cb a9 5a e9 b9 59 df f4 c0 f0 00 00 eb 37 67>,
  absValidity: 2018-03-22T06:46:33.769Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300650,
     cipherKeyVal: <Buffer 91 45 32 98 f2 9a 4e 79 38 45 1e 23 fd dd 4a b1>,
     macKeyVal: <Buffer a9 83 46 e4 9c 72 d6 59 9c d8 0e fe 7f 31 f2 40 dd cb a9 5a e9 b9 59 df f4 c0 f0 00 00 eb 37 67>,
     absValidity: 2018-03-22T06:46:33.769Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 66 3c 5e aa 09 10 7c d9>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.15:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 12 0.6666666666666666 1521614853631
connected to auth! from local port 40316
received auth hello!
{ authId: 503, nonce: <Buffer c5 3c df 10 a6 1b e8 e7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f6 58 ce e6 40 20 fe f2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300660,
  cipherKeyVal: <Buffer b3 ed 5b 83 2d 8e 7c e8 32 20 c8 c4 01 fd a6 9d>,
  macKeyVal: <Buffer 92 29 5f 6d e2 ca 4b ba 88 ef 28 d8 46 15 1e b6 4b 23 cc 16 7b c8 5d 64 72 f5 3b e3 b8 c8 cf 54>,
  absValidity: 2018-03-22T06:47:33.778Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300660,
     cipherKeyVal: <Buffer b3 ed 5b 83 2d 8e 7c e8 32 20 c8 c4 01 fd a6 9d>,
     macKeyVal: <Buffer 92 29 5f 6d e2 ca 4b ba 88 ef 28 d8 46 15 1e b6 4b 23 cc 16 7b c8 5d 64 72 f5 3b e3 b8 c8 cf 54>,
     absValidity: 2018-03-22T06:47:33.778Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer d9 52 04 d6 1c 79 2a 51>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.15:undefined
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 13 0.6153846153846154 1521614913637
connected to auth! from local port 40552
received auth hello!
{ authId: 503, nonce: <Buffer 44 a7 61 28 9e 76 ec a1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 39 39 8a cd 9d 93 b6 d1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300670,
  cipherKeyVal: <Buffer c9 e2 21 42 d6 38 69 43 c8 21 aa 79 73 df b9 a1>,
  macKeyVal: <Buffer e6 e0 64 5c 39 77 b3 d9 93 c2 38 4c c0 b5 c3 3a 9f d0 6d 27 eb ac 10 23 7b b8 00 ff 93 59 df 69>,
  absValidity: 2018-03-22T06:48:33.913Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300670,
     cipherKeyVal: <Buffer c9 e2 21 42 d6 38 69 43 c8 21 aa 79 73 df b9 a1>,
     macKeyVal: <Buffer e6 e0 64 5c 39 77 b3 d9 93 c2 38 4c c0 b5 c3 3a 9f d0 6d 27 eb ac 10 23 7b b8 00 ff 93 59 df 69>,
     absValidity: 2018-03-22T06:48:33.913Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 14 0.5714285714285714 1521614973697
connected to auth! from local port 40770
received auth hello!
{ authId: 503, nonce: <Buffer 69 9c bc d0 bf 1c fc 02> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a6 48 fd 43 d9 58 9f 56>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300680,
  cipherKeyVal: <Buffer fa bc 8e ef 4d fc d9 13 b5 1a 1c 85 2d 16 3e 80>,
  macKeyVal: <Buffer 63 05 1a 96 ac 79 9b f0 a3 a1 db 96 00 94 e2 82 b9 69 e6 36 0c 49 ca 30 25 4b e0 6b 8b 4e 44 4f>,
  absValidity: 2018-03-22T06:49:34.318Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300680,
     cipherKeyVal: <Buffer fa bc 8e ef 4d fc d9 13 b5 1a 1c 85 2d 16 3e 80>,
     macKeyVal: <Buffer 63 05 1a 96 ac 79 9b f0 a3 a1 db 96 00 94 e2 82 b9 69 e6 36 0c 49 ca 30 25 4b e0 6b 8b 4e 44 4f>,
     absValidity: 2018-03-22T06:49:34.318Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 15 0.5333333333333333 1521615033757
connected to auth! from local port 40998
received auth hello!
{ authId: 503, nonce: <Buffer 07 92 c1 82 3d ca 20 7b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5c 48 04 c5 6b 02 4c 55>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300690,
  cipherKeyVal: <Buffer 6f 63 ca b5 e7 72 11 b0 ad d0 1e 4f c9 69 9b ae>,
  macKeyVal: <Buffer a2 c7 61 0d 1a 13 93 e5 46 33 61 fd c3 fe db 27 17 86 91 46 c7 3c 7c cb e3 a4 19 c0 ba 6d ad 0d>,
  absValidity: 2018-03-22T06:50:34.376Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300690,
     cipherKeyVal: <Buffer 6f 63 ca b5 e7 72 11 b0 ad d0 1e 4f c9 69 9b ae>,
     macKeyVal: <Buffer a2 c7 61 0d 1a 13 93 e5 46 33 61 fd c3 fe db 27 17 86 91 46 c7 3c 7c cb e3 a4 19 c0 ba 6d ad 0d>,
     absValidity: 2018-03-22T06:50:34.376Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 16 0.5 1521615093817
connected to auth! from local port 41220
received auth hello!
{ authId: 503, nonce: <Buffer dc 0c 81 c1 d7 94 e2 dc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 93 6a f2 91 10 ae b7 a6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300700,
  cipherKeyVal: <Buffer 67 41 99 a5 b4 0e 70 70 fa a6 03 b5 c6 e8 ff 4a>,
  macKeyVal: <Buffer af d3 c3 3b 3f 5b fe 78 dd f7 f5 65 dd 46 9a 98 8b 63 56 45 c8 7e 59 4b 88 b9 b9 2f 2c 97 93 e7>,
  absValidity: 2018-03-22T06:51:34.358Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300700,
     cipherKeyVal: <Buffer 67 41 99 a5 b4 0e 70 70 fa a6 03 b5 c6 e8 ff 4a>,
     macKeyVal: <Buffer af d3 c3 3b 3f 5b fe 78 dd f7 f5 65 dd 46 9a 98 8b 63 56 45 c8 7e 59 4b 88 b9 b9 2f 2c 97 93 e7>,
     absValidity: 2018-03-22T06:51:34.358Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 17 0.47058823529411764 1521615153836
connected to auth! from local port 41442
received auth hello!
{ authId: 503, nonce: <Buffer bd fd 83 f8 ec 27 23 33> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e4 52 9e 5a fc 43 b9 31>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300710,
  cipherKeyVal: <Buffer 3c 98 07 71 62 80 47 8c 11 92 be 9a ef d7 13 2b>,
  macKeyVal: <Buffer 06 8f 6d f5 33 6f 81 cc 49 e2 47 7b e5 7f d1 d8 d6 83 2b 74 6c 9a 0e 81 96 a3 eb 17 34 a3 28 21>,
  absValidity: 2018-03-22T06:52:34.439Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300710,
     cipherKeyVal: <Buffer 3c 98 07 71 62 80 47 8c 11 92 be 9a ef d7 13 2b>,
     macKeyVal: <Buffer 06 8f 6d f5 33 6f 81 cc 49 e2 47 7b e5 7f d1 d8 d6 83 2b 74 6c 9a 0e 81 96 a3 eb 17 34 a3 28 21>,
     absValidity: 2018-03-22T06:52:34.439Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 18 0.4444444444444444 1521615213893
connected to auth! from local port 41664
received auth hello!
{ authId: 503, nonce: <Buffer ce 22 7f 40 37 42 a8 e3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6c c2 24 58 80 f1 36 f3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300720,
  cipherKeyVal: <Buffer 42 0b 02 7f c4 b6 7b bf 13 6b c3 6e 9b 63 a5 05>,
  macKeyVal: <Buffer 01 76 30 b8 21 4e 6a 6f f3 06 ce 60 d5 25 c4 88 41 aa db 9c ca df 11 58 57 ff 51 32 8a ea 69 62>,
  absValidity: 2018-03-22T06:53:34.538Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300720,
     cipherKeyVal: <Buffer 42 0b 02 7f c4 b6 7b bf 13 6b c3 6e 9b 63 a5 05>,
     macKeyVal: <Buffer 01 76 30 b8 21 4e 6a 6f f3 06 ce 60 d5 25 c4 88 41 aa db 9c ca df 11 58 57 ff 51 32 8a ea 69 62>,
     absValidity: 2018-03-22T06:53:34.538Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 19 0.42105263157894735 1521615273898
connected to auth! from local port 41884
received auth hello!
{ authId: 503, nonce: <Buffer 5b 88 bc 5f 5e fb ee 26> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 56 aa 9d e3 24 35 ab 25>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300730,
  cipherKeyVal: <Buffer 3f 3e 76 e8 5a 63 7c 77 1d 18 5f 1c 1b b2 80 02>,
  macKeyVal: <Buffer 5c 86 f2 06 c9 47 e7 39 34 75 d4 cd a0 75 66 ae e0 08 f0 9f ec 35 63 e0 3c 65 bc 12 bd da 56 ae>,
  absValidity: 2018-03-22T06:54:34.594Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300730,
     cipherKeyVal: <Buffer 3f 3e 76 e8 5a 63 7c 77 1d 18 5f 1c 1b b2 80 02>,
     macKeyVal: <Buffer 5c 86 f2 06 c9 47 e7 39 34 75 d4 cd a0 75 66 ae e0 08 f0 9f ec 35 63 e0 3c 65 bc 12 bd da 56 ae>,
     absValidity: 2018-03-22T06:54:34.594Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 20 0.4 1521615333958
connected to auth! from local port 42104
received auth hello!
{ authId: 503, nonce: <Buffer 1c 0a 98 e0 75 71 bf 40> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bd 74 b0 5a e5 6e c8 29>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300740,
  cipherKeyVal: <Buffer 6c 30 f5 93 50 f3 4b e9 25 70 e3 b7 5e 42 bf ab>,
  macKeyVal: <Buffer 8e a0 25 fb 6f 2c ba 4f fe 09 e8 bb e5 54 50 90 e9 76 98 d7 95 70 4c 9c b5 4c b8 f0 f4 34 4f 1a>,
  absValidity: 2018-03-22T06:55:34.588Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300740,
     cipherKeyVal: <Buffer 6c 30 f5 93 50 f3 4b e9 25 70 e3 b7 5e 42 bf ab>,
     macKeyVal: <Buffer 8e a0 25 fb 6f 2c ba 4f fe 09 e8 bb e5 54 50 90 e9 76 98 d7 95 70 4c 9c b5 4c b8 f0 f4 34 4f 1a>,
     absValidity: 2018-03-22T06:55:34.588Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 21 0.38095238095238093 1521615394018
connected to auth! from local port 42326
received auth hello!
{ authId: 503, nonce: <Buffer c7 3d 1d c9 5e 63 77 39> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d3 56 a6 46 d2 4b 3b 37>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300750,
  cipherKeyVal: <Buffer 94 c4 b4 ab 94 c2 90 54 73 5f e5 b8 b4 b4 4c ab>,
  macKeyVal: <Buffer 33 1e 2e de 30 37 b2 8e 1a 35 d7 e1 8d 0d 66 fb 12 ff 7e 71 8c 8f 5c 79 b6 7b 15 1e d1 0e d5 10>,
  absValidity: 2018-03-22T06:56:34.676Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300750,
     cipherKeyVal: <Buffer 94 c4 b4 ab 94 c2 90 54 73 5f e5 b8 b4 b4 4c ab>,
     macKeyVal: <Buffer 33 1e 2e de 30 37 b2 8e 1a 35 d7 e1 8d 0d 66 fb 12 ff 7e 71 8c 8f 5c 79 b6 7b 15 1e d1 0e d5 10>,
     absValidity: 2018-03-22T06:56:34.676Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 22 0.36363636363636365 1521615454077
connected to auth! from local port 42548
received auth hello!
{ authId: 503, nonce: <Buffer 72 06 87 e0 dd 40 c3 a3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5b 15 19 4e 70 04 cc 6d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300760,
  cipherKeyVal: <Buffer 71 21 2a c4 ff 41 52 74 7e e1 ef d5 11 3c a1 76>,
  macKeyVal: <Buffer 25 2d b2 69 bf 8e ee 6d bb a7 5e 4a 67 1a f8 6d 1a e8 fb f7 bf 81 a9 4d 99 04 f4 02 ab 5a 29 8f>,
  absValidity: 2018-03-22T06:57:34.689Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300760,
     cipherKeyVal: <Buffer 71 21 2a c4 ff 41 52 74 7e e1 ef d5 11 3c a1 76>,
     macKeyVal: <Buffer 25 2d b2 69 bf 8e ee 6d bb a7 5e 4a 67 1a f8 6d 1a e8 fb f7 bf 81 a9 4d 99 04 f4 02 ab 5a 29 8f>,
     absValidity: 2018-03-22T06:57:34.689Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 23 0.34782608695652173 1521615514136
connected to auth! from local port 42770
received auth hello!
{ authId: 503, nonce: <Buffer 7d 8a e8 66 2e 41 ac 47> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6b 2c e9 d4 02 e1 9c 91>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300770,
  cipherKeyVal: <Buffer 5f ad 53 32 7c e3 aa 04 ee c8 de 9c 6c fd 68 b2>,
  macKeyVal: <Buffer d5 2c 1d 27 e5 c8 3d d4 ac b6 5b b3 49 7d 8b eb 68 09 6b 28 5a e3 f4 55 15 22 d8 5c 9b ff 6a 35>,
  absValidity: 2018-03-22T06:58:34.749Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300770,
     cipherKeyVal: <Buffer 5f ad 53 32 7c e3 aa 04 ee c8 de 9c 6c fd 68 b2>,
     macKeyVal: <Buffer d5 2c 1d 27 e5 c8 3d d4 ac b6 5b b3 49 7d 8b eb 68 09 6b 28 5a e3 f4 55 15 22 d8 5c 9b ff 6a 35>,
     absValidity: 2018-03-22T06:58:34.749Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 24 0.3333333333333333 1521615574148
connected to auth! from local port 42992
received auth hello!
{ authId: 503, nonce: <Buffer 87 a7 35 ce 53 0b 35 b2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 43 91 2c dd 90 29 e0 6a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300780,
  cipherKeyVal: <Buffer c6 5e a1 b7 38 b8 ad 37 3e 0c 28 5c 82 05 89 9b>,
  macKeyVal: <Buffer ab fe b1 04 37 47 ab 55 e4 44 59 51 8a c9 b0 90 f6 a9 9c 25 29 f0 3d b1 e6 c4 a7 17 e8 9e 3d 3a>,
  absValidity: 2018-03-22T06:59:34.778Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300780,
     cipherKeyVal: <Buffer c6 5e a1 b7 38 b8 ad 37 3e 0c 28 5c 82 05 89 9b>,
     macKeyVal: <Buffer ab fe b1 04 37 47 ab 55 e4 44 59 51 8a c9 b0 90 f6 a9 9c 25 29 f0 3d b1 e6 c4 a7 17 e8 9e 3d 3a>,
     absValidity: 2018-03-22T06:59:34.778Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 25 0.32 1521615634155
connected to auth! from local port 43210
received auth hello!
{ authId: 503, nonce: <Buffer fb 2f 46 b7 aa 12 9f c1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c5 d3 83 eb 2b 4a 0c bd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300790,
  cipherKeyVal: <Buffer 3b b5 99 88 db f2 d8 cf 75 ba 34 10 02 e6 a9 8b>,
  macKeyVal: <Buffer db 72 8e 16 ab a5 8c d0 a8 4a 67 01 d3 98 2c 34 dc 92 9c b4 46 45 14 73 fe 0a e1 c4 95 00 0c 7d>,
  absValidity: 2018-03-22T07:00:34.973Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300790,
     cipherKeyVal: <Buffer 3b b5 99 88 db f2 d8 cf 75 ba 34 10 02 e6 a9 8b>,
     macKeyVal: <Buffer db 72 8e 16 ab a5 8c d0 a8 4a 67 01 d3 98 2c 34 dc 92 9c b4 46 45 14 73 fe 0a e1 c4 95 00 0c 7d>,
     absValidity: 2018-03-22T07:00:34.973Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 26 0.3076923076923077 1521615694213
connected to auth! from local port 43432
received auth hello!
{ authId: 503, nonce: <Buffer f4 b0 7f ce d8 74 fe 22> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 81 58 5b 92 c5 0c f2 60>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300800,
  cipherKeyVal: <Buffer b1 35 6d ee 2b e3 9a c0 ec ea 34 de fc e6 7c 42>,
  macKeyVal: <Buffer 1b 05 70 2c 1c 8a 75 9d 92 3a 6e 4e 1c ce 06 b6 d7 40 f2 8c 09 b3 d6 ae d8 c6 7d 67 42 0c 35 4b>,
  absValidity: 2018-03-22T07:01:34.884Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300800,
     cipherKeyVal: <Buffer b1 35 6d ee 2b e3 9a c0 ec ea 34 de fc e6 7c 42>,
     macKeyVal: <Buffer 1b 05 70 2c 1c 8a 75 9d 92 3a 6e 4e 1c ce 06 b6 d7 40 f2 8c 09 b3 d6 ae d8 c6 7d 67 42 0c 35 4b>,
     absValidity: 2018-03-22T07:01:34.884Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 27 0.2962962962962963 1521615754273
connected to auth! from local port 43654
received auth hello!
{ authId: 503, nonce: <Buffer c1 6a 29 08 49 f2 a9 85> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8d 03 f1 9f 03 f7 66 eb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300810,
  cipherKeyVal: <Buffer 88 8a a3 36 53 ff ca 00 5e 45 3b 1b ec 66 a7 47>,
  macKeyVal: <Buffer 7d ab 24 e2 76 2e 44 db dc 25 56 6e 6a fa 84 f2 9f 21 33 10 2b 86 f9 68 f1 3c c0 38 b4 7e 34 03>,
  absValidity: 2018-03-22T07:02:34.979Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300810,
     cipherKeyVal: <Buffer 88 8a a3 36 53 ff ca 00 5e 45 3b 1b ec 66 a7 47>,
     macKeyVal: <Buffer 7d ab 24 e2 76 2e 44 db dc 25 56 6e 6a fa 84 f2 9f 21 33 10 2b 86 f9 68 f1 3c c0 38 b4 7e 34 03>,
     absValidity: 2018-03-22T07:02:34.979Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 28 0.2857142857142857 1521615814333
connected to auth! from local port 43876
received auth hello!
{ authId: 503, nonce: <Buffer 28 d3 f7 fc 0f e5 3e 84> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e3 08 7c e8 01 a1 94 ae>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300820,
  cipherKeyVal: <Buffer ae ed f4 7c 72 f8 78 fb 35 e2 36 03 1e ba e4 69>,
  macKeyVal: <Buffer 5e 9c dc 49 86 62 0c 69 53 20 da 9a 33 ba 0d d5 90 1c 16 3d af 19 ed 47 94 b7 60 0b 1b b0 62 ea>,
  absValidity: 2018-03-22T07:03:34.948Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300820,
     cipherKeyVal: <Buffer ae ed f4 7c 72 f8 78 fb 35 e2 36 03 1e ba e4 69>,
     macKeyVal: <Buffer 5e 9c dc 49 86 62 0c 69 53 20 da 9a 33 ba 0d d5 90 1c 16 3d af 19 ed 47 94 b7 60 0b 1b b0 62 ea>,
     absValidity: 2018-03-22T07:03:34.948Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 29 0.27586206896551724 1521615874385
connected to auth! from local port 44098
received auth hello!
{ authId: 503, nonce: <Buffer 11 07 81 4c e1 29 64 f8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer de 51 22 40 2a 78 26 3f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300830,
  cipherKeyVal: <Buffer 26 da 5d c5 2a fc e9 4d 4e 20 fb 2f 32 15 bc b2>,
  macKeyVal: <Buffer 3d 77 52 6c f3 87 de f3 68 91 19 9e 5f a8 ac 2a 85 cb 81 23 11 18 eb 4c 82 13 40 d7 c0 68 93 e9>,
  absValidity: 2018-03-22T07:04:35.067Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300830,
     cipherKeyVal: <Buffer 26 da 5d c5 2a fc e9 4d 4e 20 fb 2f 32 15 bc b2>,
     macKeyVal: <Buffer 3d 77 52 6c f3 87 de f3 68 91 19 9e 5f a8 ac 2a 85 cb 81 23 11 18 eb 4c 82 13 40 d7 c0 68 93 e9>,
     absValidity: 2018-03-22T07:04:35.067Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
