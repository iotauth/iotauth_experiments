changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s415.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's415',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 74 46 ... > }
Handler: listening on port 22100
s415:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300601
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60408
received auth hello!
{ authId: 403, nonce: <Buffer 5d bd c6 71 4c fb 2f f5> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 42 71 66 89 03 64 54 cb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer cc 6f 19 f7 aa f6 d2 a7 08 20 8f a9 72 10 d9 0c>,
  macKeyVal: <Buffer f5 a7 d7 2c 0e 70 3a e4 1a bc 0a 00 43 b3 9d c3 6e 66 d4 09 86 bc 05 28 33 50 07 37 df 80 0a 4e>,
  absValidity: 2018-03-21T07:36:57.194Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e7 bf 84 80 56 6f 60 db>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e7 bf 84 80 56 6f 60 db> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.59:53150',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300607
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60618
received auth hello!
{ authId: 403, nonce: <Buffer eb 92 20 22 44 a1 10 84> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8c 93 b1 37 49 06 94 27>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7d cf ff de 90 ec 52 0e>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 7d cf ff de 90 ec 52 0e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.59:53360',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300613
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60890
received auth hello!
{ authId: 403, nonce: <Buffer 29 06 8c a2 54 2e dd a4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e4 d0 c7 02 be d9 e7 1a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 09 15 b4 1b bf 88 75 3f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 09 15 b4 1b bf 88 75 3f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.59:53632',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300619
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 32928
received auth hello!
{ authId: 403, nonce: <Buffer 7e 64 d4 0e fc af c4 88> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 94 a7 dd 2e 6b 39 49 2d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e6 86 2f cb 26 5d f0 97>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e6 86 2f cb 26 5d f0 97> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.59:53902',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300625
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33198
received auth hello!
{ authId: 403, nonce: <Buffer 29 b3 9a 49 f0 0b e0 cc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f7 26 c6 d6 fb 33 35 a3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 69 bc 1a 6d f0 30 82 05>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 69 bc 1a 6d f0 30 82 05> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.59:54172',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300631
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33468
received auth hello!
{ authId: 403, nonce: <Buffer 98 b4 ca 8b ff 35 64 e0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0d aa f5 14 a8 89 67 df>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 70 4d 77 45 a3 2d d9 5a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 70 4d 77 45 a3 2d d9 5a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.59:54442',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300637
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33738
received auth hello!
{ authId: 403, nonce: <Buffer 75 37 52 ab 26 1c 82 8e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3d ce 26 e1 1b 38 b9 74>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f2 a1 d8 2e 02 29 db 47>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f2 a1 d8 2e 02 29 db 47> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.59:54712',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300643
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34000
received auth hello!
{ authId: 403, nonce: <Buffer 43 ec 15 c0 4d 4f ca 8a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ab 3a 85 c6 d9 b5 08 f9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 53 31 6e 8b 35 f9 2a 94>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 53 31 6e 8b 35 f9 2a 94> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.59:54974',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
