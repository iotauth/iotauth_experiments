changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s413.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's413',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 76 77 ... > }
Handler: listening on port 22100
s413:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300600
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58430
received auth hello!
{ authId: 403, nonce: <Buffer 1b 5c 01 d5 da 6f bd 6f> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 51 85 4d 70 a5 b4 54 8e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 63 31 6d 7c c3 25 af 81 ef 90 e6 2d 0d a0 2a b5>,
  macKeyVal: <Buffer 79 7d f1 36 8d 49 ff 1e 5f 66 e1 39 95 b0 74 49 51 5d e1 f5 f3 9b 00 03 17 64 45 e9 51 54 76 30>,
  absValidity: 2018-03-21T07:36:53.331Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4b eb 70 f9 2c 1e 35 17>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4b eb 70 f9 2c 1e 35 17> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.58:37058',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300606
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58634
received auth hello!
{ authId: 403, nonce: <Buffer b1 1c 42 0a e9 52 e7 76> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 37 1a 86 85 8b 03 8d 88>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer af 72 bc 0c e2 b2 98 df>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer af 72 bc 0c e2 b2 98 df> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.58:37262',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300612
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58906
received auth hello!
{ authId: 403, nonce: <Buffer c5 99 3b eb 26 65 75 61> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7d fc 9c 3c 5a ae 14 04>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6f 66 29 dc 5e 8a f8 26>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6f 66 29 dc 5e 8a f8 26> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.58:37534',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300618
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59176
received auth hello!
{ authId: 403, nonce: <Buffer 67 53 36 c3 d5 e7 eb da> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 72 2b b5 ea 99 0b 12 f7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 01 73 98 a5 01 67 c3 92>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 01 73 98 a5 01 67 c3 92> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.58:37804',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300624
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59446
received auth hello!
{ authId: 403, nonce: <Buffer e2 51 66 a3 f4 f7 44 b2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 39 50 18 d3 95 ac 25 5d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4f 7f 39 ef 60 4f c0 ca>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4f 7f 39 ef 60 4f c0 ca> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.58:38074',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300630
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59716
received auth hello!
{ authId: 403, nonce: <Buffer 44 4f 60 b7 0f 2a cb aa> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e4 57 0a 8d e3 7b 20 2c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c7 c9 78 15 c2 c3 33 67>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c7 c9 78 15 c2 c3 33 67> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.58:38344',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300636
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59986
received auth hello!
{ authId: 403, nonce: <Buffer c0 9c 3f 28 86 97 ad ce> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 61 4b c1 13 8c 8a c5 19>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ab 81 7a 09 9e 85 77 75>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ab 81 7a 09 9e 85 77 75> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.58:38614',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300642
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60248
received auth hello!
{ authId: 403, nonce: <Buffer 63 66 77 16 0a dd 92 87> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b8 93 fc d4 da 5f 96 25>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b7 51 5d 1e 3a d1 9f bc>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b7 51 5d 1e 3a d1 9f bc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.58:38876',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
