changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s416.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's416',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 51 49 42 41 41 4b 43 41 51 45 41 35 7a ... > }
Handler: listening on port 22100
s416:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300602
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39882
received auth hello!
{ authId: 403, nonce: <Buffer 07 a5 ac 32 3c 00 a1 32> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 11 6b f5 89 6b 24 2e 7a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 8d 4b 21 96 04 57 14 01 65 81 03 df ca 70 7b 50>,
  macKeyVal: <Buffer 6c 5e 3c a5 26 45 b9 e1 05 15 1f a1 b3 a3 d4 24 a8 19 30 93 2e 7a dd 68 03 4e a1 33 75 fc ea af>,
  absValidity: 2018-03-21T07:37:01.205Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 00 6a e8 ab f6 2a af 33>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 00 6a e8 ab f6 2a af 33> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.60:43614',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300603
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39888
received auth hello!
{ authId: 403, nonce: <Buffer 65 8c f7 6f c7 84 78 b6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c3 b8 83 58 8d 72 e8 f8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2d 85 e0 d7 34 58 76 ec>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2d 85 e0 d7 34 58 76 ec> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.61:37944',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300608
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40094
received auth hello!
{ authId: 403, nonce: <Buffer c5 db 2d 70 5f 72 71 5a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 78 a3 69 2d 0c 58 f3 b2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8c d2 b0 9b e3 f7 be f7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8c d2 b0 9b e3 f7 be f7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.60:43826',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300609
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40110
received auth hello!
{ authId: 403, nonce: <Buffer 0b 6d a8 a7 e2 20 48 ef> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2a 7f a7 fd d6 2c ea d2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e7 d2 be 20 7a cb 23 50>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e7 d2 be 20 7a cb 23 50> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.61:38166',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300614
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40368
received auth hello!
{ authId: 403, nonce: <Buffer a9 e5 ff 87 4c 89 00 3d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6b 0a 7c df bd 60 5d bd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ed 6f d8 6d 44 ee 57 fa>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ed 6f d8 6d 44 ee 57 fa> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.60:44098',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300615
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40382
received auth hello!
{ authId: 403, nonce: <Buffer 08 58 da f8 69 bb c8 47> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6f f9 c2 2a ee f2 d3 8e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0c 48 79 ae 9c b5 b9 64>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0c 48 79 ae 9c b5 b9 64> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.61:38438',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300620
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40636
received auth hello!
{ authId: 403, nonce: <Buffer 47 9b 4a cc e7 30 db f3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9d 10 9a 22 39 3e cd 30>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 23 be fe 93 3e 52 71 05>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 23 be fe 93 3e 52 71 05> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.60:44368',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300621
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40652
received auth hello!
{ authId: 403, nonce: <Buffer f1 c4 03 93 44 5a ce b6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 55 33 93 3f 6b f1 de 3d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d6 22 01 c4 c7 ad 62 e6>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer d6 22 01 c4 c7 ad 62 e6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.61:38708',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300626
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40906
received auth hello!
{ authId: 403, nonce: <Buffer 66 ed 42 4e 3f fe 6b df> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cb 34 a0 45 0e d6 b3 42>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 25 16 26 45 4e 6f 7e 1a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 25 16 26 45 4e 6f 7e 1a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.60:44638',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300627
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40922
received auth hello!
{ authId: 403, nonce: <Buffer e4 1a 27 01 02 0d b5 4a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7a c6 5d de b1 02 c0 c2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 03 0c 58 94 bd dd cc a6>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 03 0c 58 94 bd dd cc a6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.61:38978',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300632
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41176
received auth hello!
{ authId: 403, nonce: <Buffer 8f 2c b7 1f 1a d2 05 09> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b1 8b 6c 7e c7 62 67 7a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 36 09 2a 21 b2 b1 4d bf>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 36 09 2a 21 b2 b1 4d bf> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.60:44908',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300633
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41192
received auth hello!
{ authId: 403, nonce: <Buffer 3c f9 ad f7 60 10 2a 67> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b1 da c9 26 a4 e1 fd 69>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a8 6d c5 88 0b c9 43 cb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a8 6d c5 88 0b c9 43 cb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.61:39248',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300638
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41446
received auth hello!
{ authId: 403, nonce: <Buffer 77 37 e4 14 db df d2 26> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8e 0d 32 fa e6 57 22 4f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 84 0a 0a a3 5c 3f 6c 28>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 84 0a 0a a3 5c 3f 6c 28> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.60:45178',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300639
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41462
received auth hello!
{ authId: 403, nonce: <Buffer b4 d0 36 ad cb 7a de b8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cf 30 c3 b7 4e e3 9a 14>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6e 4d c6 21 4f c3 d6 f2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6e 4d c6 21 4f c3 d6 f2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.61:39518',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300644
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41708
received auth hello!
{ authId: 403, nonce: <Buffer 40 dc 17 c0 3e d8 d4 ee> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 33 11 93 85 47 8d 58 5e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 27 82 4c c8 76 8e 8e 61>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 27 82 4c c8 76 8e 8e 61> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.60:45440',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300645
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41724
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
