changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s505.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's505',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 71 79 ... > }
Handler: listening on port 22100
s505:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100542
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41028
received auth hello!
{ authId: 501, nonce: <Buffer 09 e9 77 17 ef 52 ba 88> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer a5 ef 3f 05 59 7e 9f 7c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 46 b9 da 7a e5 a5 b8 bb 6f 8a 2f 50 74 e1 1a 02>,
  macKeyVal: <Buffer 51 6d ea a7 e4 32 59 b3 e3 a0 2c 9f ee 51 db cc 64 7a 0e 41 4d 97 72 bb aa 1a 9d 3a 94 59 75 7e>,
  absValidity: 2018-03-21T07:37:26.119Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d9 6d 27 6d 22 0d 71 f8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d9 6d 27 6d 22 0d 71 f8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.68:40314',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100543
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41040
received auth hello!
{ authId: 501, nonce: <Buffer af 05 1a 82 72 de 04 d8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 76 e4 51 2d a5 9c 8e fb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e1 16 aa d3 0b 4f fd f6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e1 16 aa d3 0b 4f fd f6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.69:57218',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100550
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41290
received auth hello!
{ authId: 501, nonce: <Buffer 87 d6 8e 3a 47 b3 fc 3f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c7 36 f2 f0 10 0b 21 ab>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 18 5b ef 68 cd c5 58 fc>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 18 5b ef 68 cd c5 58 fc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.68:40576',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100551
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41308
received auth hello!
{ authId: 501, nonce: <Buffer cd b4 34 ae 96 8b 19 ed> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ac b9 74 3a 14 57 8e 20>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 75 f8 b2 a8 f8 9a 16 2a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 75 f8 b2 a8 f8 9a 16 2a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.69:57486',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100558
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41560
received auth hello!
{ authId: 501, nonce: <Buffer 0a 93 38 a2 68 cd 3c 55> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2d e4 09 97 64 42 72 91>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3f da 1e 1f 53 5b f7 25>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 3f da 1e 1f 53 5b f7 25> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.68:40846',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100559
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41578
received auth hello!
{ authId: 501, nonce: <Buffer 62 19 ee 46 6d d6 ea 50> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f9 09 0a a4 4d 79 d2 36>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1b 8a a4 81 91 27 93 ad>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1b 8a a4 81 91 27 93 ad> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.69:57756',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100566
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41830
received auth hello!
{ authId: 501, nonce: <Buffer 09 d5 95 ab 40 5d 6f 24> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a2 57 f1 6d 3d 98 a1 8b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 12 d6 68 e1 14 2b 43 12>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 12 d6 68 e1 14 2b 43 12> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.68:41116',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100567
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41844
received auth hello!
{ authId: 501, nonce: <Buffer fd 82 f4 2e 59 40 44 d2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8f cc bd b3 ce ff 47 ad>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 11 a9 e8 a5 28 ab c3 19>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 11 a9 e8 a5 28 ab c3 19> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.69:58022',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100574
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42100
received auth hello!
{ authId: 501, nonce: <Buffer 56 de 82 3f 79 25 04 fb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 12 b9 79 4c 04 0b 8d 50>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 49 f3 b3 bf 2f 37 fe 6c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 49 f3 b3 bf 2f 37 fe 6c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.68:41386',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100575
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42118
received auth hello!
{ authId: 501, nonce: <Buffer e4 57 46 5b 3a ed 1b 46> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d6 bd b5 57 f9 67 08 1f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8b e9 5c a3 26 35 d9 5c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8b e9 5c a3 26 35 d9 5c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.69:58296',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100582
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42370
received auth hello!
{ authId: 501, nonce: <Buffer 03 48 02 e7 a0 b8 12 44> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 55 9e 54 53 88 59 44 cc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fe 02 31 7c 1d b7 d0 35>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fe 02 31 7c 1d b7 d0 35> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.68:41656',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100583
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42384
received auth hello!
{ authId: 501, nonce: <Buffer d0 28 9e 00 f1 ad 78 85> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a4 1f cd fe c0 04 d3 6c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a8 67 4c 27 ec 18 84 be>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a8 67 4c 27 ec 18 84 be> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.69:58562',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100590
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42640
received auth hello!
{ authId: 501, nonce: <Buffer 13 3e ca df 6b d9 91 cf> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5a 66 16 80 29 30 b2 20>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 03 21 9c a6 cf 49 74 ac>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 03 21 9c a6 cf 49 74 ac> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.68:41926',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100591
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42654
received auth hello!
{ authId: 501, nonce: <Buffer e8 de 0a 39 dc 36 9d c1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d3 ca 78 b3 36 e5 9c 0a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 61 72 c4 1c cf 96 ff 7b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 61 72 c4 1c cf 96 ff 7b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.69:58832',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
