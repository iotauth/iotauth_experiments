changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s412.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's412',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 34 74 ... > }
Handler: listening on port 22100
s412:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300599
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44280
received auth hello!
{ authId: 403, nonce: <Buffer 7f 73 b7 f1 84 0c 0f 44> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer d1 c0 81 86 0c 69 43 a0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer cb 2d 8e 6d 6a b3 92 d6 ca c6 1b af 03 4e 2b 41>,
  macKeyVal: <Buffer c5 0f 00 67 68 06 6d 60 3f 24 b6 20 a3 c3 a7 d5 19 cd 52 8e 43 35 a7 9d 07 85 bd 92 57 b0 58 17>,
  absValidity: 2018-03-21T07:36:50.150Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c0 0b ee 6a a1 25 f2 44>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c0 0b ee 6a a1 25 f2 44> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.57:53350',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300605
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44478
received auth hello!
{ authId: 403, nonce: <Buffer 03 06 f0 c2 0b 89 8d cb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ff 99 2d ae 31 ee 5e f7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 35 f0 98 bc f1 0f ab 42>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 35 f0 98 bc f1 0f ab 42> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.57:53548',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300611
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44750
received auth hello!
{ authId: 403, nonce: <Buffer 2c a2 d3 57 9a 8b 0c 89> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5d e6 01 2b 7b 0e f5 8d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8e 00 a4 6d 53 78 82 94>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8e 00 a4 6d 53 78 82 94> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.57:53820',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300617
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45020
received auth hello!
{ authId: 403, nonce: <Buffer ca a4 8d 00 04 c1 e6 51> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f1 5c bd 5f a0 6b d8 0c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 17 e8 53 53 77 e0 5a b6>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 17 e8 53 53 77 e0 5a b6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.57:54090',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300623
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45290
received auth hello!
{ authId: 403, nonce: <Buffer ce 0b 1e c6 31 e4 51 15> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c8 bb 4b 93 0d 7d d6 7a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 29 00 93 75 3b 3e a3 bc>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 29 00 93 75 3b 3e a3 bc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.57:54360',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300629
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45560
received auth hello!
{ authId: 403, nonce: <Buffer 62 d0 e6 72 83 ba de 20> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a8 60 7b 1e 80 81 b1 08>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 00 b7 43 b9 d7 46 8f ec>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 00 b7 43 b9 d7 46 8f ec> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.57:54630',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300635
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45830
received auth hello!
{ authId: 403, nonce: <Buffer 50 6c 40 5c 44 25 69 d7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 85 1c ee 5d dd ec 88 c9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ae 89 01 f7 e9 71 77 d6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ae 89 01 f7 e9 71 77 d6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.57:54900',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300641
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46092
received auth hello!
{ authId: 403, nonce: <Buffer cf 9a c0 b1 4d 0b 01 67> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0b c5 9f 47 94 3c d8 63>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 55 d9 2a 77 80 3f cd 72>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 55 d9 2a 77 80 3f cd 72> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.57:55162',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
