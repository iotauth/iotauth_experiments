changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c522.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c522',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 30 47 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521581475442
connected to auth! from local port 36786
received auth hello!
{ authId: 503, nonce: <Buffer 49 ac 50 ea 94 43 78 2b> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 55 69 e0 9a 48 54 4b 4c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 60 6a 48 e6 6c d1 d1 9b 66 58 6c fc 16 96 8d d3>,
  macKeyVal: <Buffer 2d 27 b4 61 3b bb 77 ef 75 68 a7 e7 27 68 ae 80 ea 9f b7 e3 ee 6b f1 89 e0 44 60 e1 98 92 95 f5>,
  absValidity: 2018-03-20T22:31:15.672Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300560,
  cipherKeyVal: <Buffer 4a 99 0b 8b 34 d3 70 39 3c 17 c8 a7 a3 86 a5 80>,
  macKeyVal: <Buffer 53 54 36 60 3c 1d 89 94 ed 7f d2 13 91 62 5a 86 00 db c0 c3 2b 07 18 1c bb 11 81 13 99 0b 9f 56>,
  absValidity: 2018-03-21T21:31:15.672Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.40',
  serverPort: 22100,
  sessionKey: 
   { id: 50300560,
     cipherKeyVal: <Buffer 4a 99 0b 8b 34 d3 70 39 3c 17 c8 a7 a3 86 a5 80>,
     macKeyVal: <Buffer 53 54 36 60 3c 1d 89 94 ed 7f d2 13 91 62 5a 86 00 db c0 c3 2b 07 18 1c bb 11 81 13 99 0b 9f 56>,
     absValidity: 2018-03-21T21:31:15.672Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 7d 82 ec 5e d7 8a 4d fd>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 21:31:16 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521581477360
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521581535498
connected to auth! from local port 37056
received auth hello!
{ authId: 503, nonce: <Buffer 39 ab 16 aa a6 eb 5a e5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 06 95 75 40 06 6e 26 e9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300565,
  cipherKeyVal: <Buffer 73 a2 ab 8f 4e 3c 1b 4b 60 53 bb 5a 77 63 00 e8>,
  macKeyVal: <Buffer 86 29 bd 2f 35 20 b2 ef cd 25 66 ec 66 b1 2a 46 58 f5 78 a0 4d 3c 67 90 cc 6a ea 9c bc bb 50 b0>,
  absValidity: 2018-03-21T21:32:15.686Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.40',
  serverPort: 22100,
  sessionKey: 
   { id: 50300565,
     cipherKeyVal: <Buffer 73 a2 ab 8f 4e 3c 1b 4b 60 53 bb 5a 77 63 00 e8>,
     macKeyVal: <Buffer 86 29 bd 2f 35 20 b2 ef cd 25 66 ec 66 b1 2a 46 58 f5 78 a0 4d 3c 67 90 cc 6a ea 9c bc bb 50 b0>,
     absValidity: 2018-03-21T21:32:15.686Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 71 6b db e7 43 d9 0c 34>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 21:32:16 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521581537177
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521581595553
connected to auth! from local port 37326
received auth hello!
{ authId: 503, nonce: <Buffer 4e b6 a1 65 97 a6 25 f1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 52 b2 48 10 60 8d 2d 74>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300570,
  cipherKeyVal: <Buffer a6 d3 9c bd 29 3b f8 24 a1 62 09 fc b9 a0 03 74>,
  macKeyVal: <Buffer 77 16 ae b1 64 8d e9 85 49 99 8f 66 6b 64 bb c4 40 9d 96 2e 6e da 7d 73 97 1d ed 03 f2 18 40 4d>,
  absValidity: 2018-03-21T21:33:15.732Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.40',
  serverPort: 22100,
  sessionKey: 
   { id: 50300570,
     cipherKeyVal: <Buffer a6 d3 9c bd 29 3b f8 24 a1 62 09 fc b9 a0 03 74>,
     macKeyVal: <Buffer 77 16 ae b1 64 8d e9 85 49 99 8f 66 6b 64 bb c4 40 9d 96 2e 6e da 7d 73 97 1d ed 03 f2 18 40 4d>,
     absValidity: 2018-03-21T21:33:15.732Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 70 98 65 97 7f 79 1f b9>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 21:33:16 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521581597275
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521581655585
connected to auth! from local port 37596
received auth hello!
{ authId: 503, nonce: <Buffer 42 53 58 44 75 f7 36 71> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f1 d0 3b 1d 64 33 85 a9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300575,
  cipherKeyVal: <Buffer 2c 16 0f b1 17 0a 3b 39 3d f2 26 13 41 da eb 79>,
  macKeyVal: <Buffer 64 49 24 63 6e 5c 1b 3c 13 49 65 af a4 d2 31 82 98 b1 99 c5 25 3a aa ac 74 9e 4f bd 3d 0e 9a 61>,
  absValidity: 2018-03-21T21:34:15.767Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.40',
  serverPort: 22100,
  sessionKey: 
   { id: 50300575,
     cipherKeyVal: <Buffer 2c 16 0f b1 17 0a 3b 39 3d f2 26 13 41 da eb 79>,
     macKeyVal: <Buffer 64 49 24 63 6e 5c 1b 3c 13 49 65 af a4 d2 31 82 98 b1 99 c5 25 3a aa ac 74 9e 4f bd 3d 0e 9a 61>,
     absValidity: 2018-03-21T21:34:15.767Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 97 5a c3 2c 43 8e b9 62>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 21:34:16 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521581657283
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521581715606
connected to auth! from local port 37866
received auth hello!
{ authId: 503, nonce: <Buffer 2e 3c d6 99 dc cd b2 6d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1f 39 50 23 d7 de 36 a3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300580,
  cipherKeyVal: <Buffer 0c af c3 26 ba c8 dd 3c d5 8f fa 80 f2 89 93 f5>,
  macKeyVal: <Buffer 92 9f 7d 4e a7 7b 9e 7b f6 bc e4 19 05 73 d0 ba da 58 02 89 bb 02 34 bd 71 84 1e 40 a5 48 53 56>,
  absValidity: 2018-03-21T21:35:15.738Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.40',
  serverPort: 22100,
  sessionKey: 
   { id: 50300580,
     cipherKeyVal: <Buffer 0c af c3 26 ba c8 dd 3c d5 8f fa 80 f2 89 93 f5>,
     macKeyVal: <Buffer 92 9f 7d 4e a7 7b 9e 7b f6 bc e4 19 05 73 d0 ba da 58 02 89 bb 02 34 bd 71 84 1e 40 a5 48 53 56>,
     absValidity: 2018-03-21T21:35:15.738Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer e8 a4 3b 8f ae de 70 46>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 21:35:16 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521581717457
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521581775661
connected to auth! from local port 38136
received auth hello!
{ authId: 503, nonce: <Buffer b8 1a 10 af cd 4f 21 e2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ee 75 c9 e6 b7 d1 2d dd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300585,
  cipherKeyVal: <Buffer 16 79 57 99 e5 e2 e0 ba 42 f5 4f c2 8a 9b 6d 08>,
  macKeyVal: <Buffer 9e dc 38 39 35 e8 c4 91 bf 94 2d e4 c8 57 6d 68 a1 60 f9 d5 0a fc 03 95 06 5f c4 7f d7 41 4d 46>,
  absValidity: 2018-03-21T21:36:15.866Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.40',
  serverPort: 22100,
  sessionKey: 
   { id: 50300585,
     cipherKeyVal: <Buffer 16 79 57 99 e5 e2 e0 ba 42 f5 4f c2 8a 9b 6d 08>,
     macKeyVal: <Buffer 9e dc 38 39 35 e8 c4 91 bf 94 2d e4 c8 57 6d 68 a1 60 f9 d5 0a fc 03 95 06 5f c4 7f d7 41 4d 46>,
     absValidity: 2018-03-21T21:36:15.866Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer b6 ec 31 2c f4 dd e5 d8>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 21:36:17 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521581777386
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521581835697
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect ECONNREFUSED 10.0.1.6:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 8 0.75 1521581895708
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.3:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 9 0.6666666666666666 1521581955718
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.3:21100
failure in migration to another Auth : migrationFailureCount: 3
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 4
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 10 0.6 1521582015726
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 11 0.5454545454545454 1521582075733
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 12 0.5 1521582135740
failure in connection with Auth : authFailureCount: 6
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 2
to: 3
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 13 0.46153846153846156 1521582195747
failure in connection with Auth : authFailureCount: 7
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 3
to: 4
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
connected to auth! from local port 51172
received auth hello!
{ authId: 401, nonce: <Buffer 8c 6f 36 70 b8 62 64 ec> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 14 0.42857142857142855 1521582255759
failure in connection with Auth : authFailureCount: 8
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
connected to auth! from local port 51410
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 15 0.4 1521582315763
failure in connection with Auth : authFailureCount: 9
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 4
to: 5
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
connected to auth! from local port 55672
received auth hello!
{ authId: 502, nonce: <Buffer 48 1d 53 3c dd 41 f8 cf> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth503',
     commonName: '10.0.0.6' },
  serial: '0162454FC775',
  notBefore: 2018-03-20T21:26:19.000Z,
  notAfter: 2018-03-21T21:27:59.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'DA:19:E6:31:F5:77:9C:BD:8E:77:5C:73:00:B9:41:10:7E:4D:65:2B',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'E40B9EF20959AA49D02016EC2E9896074EE0818689EAD7319ECC8ED8C9557412ED46C95E67464598F6233ECEB8BF25A876F0D30B65CED2B1FED8D1F07CF9042FD7F86E3B637BE17FBFD7C9F0DB5850835170B354A52C175B769A37BA578F965436FF29BCFD54C5D4E939E02214503C8A69FFBBF0EC06657DF9498BE98DEB26B62E1453817F6DFAE9B50EE21C5A643FF0292539838A682562303CB77FC6028B22B30B78957E4F78E539103F991928681EBF3100D31960F43F8ECFC6C2F3063B353E92BFFEF77A49BBCBF417864AE8169AA061F590E5FB3393A4592EFA1100FC186B95B83724CA0B11D8BC02BC9BD4F9E08552DE2D1EB0EE0E866E41A520730E6F',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJFT8d1MA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDMxETAPBgNVBAMMCDEwLjAuMC42MB4XDTE4MDMy\nMDIxMjYxOVoXDTE4MDMyMTIxMjc1OVowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDkC57yCVmqSdAgFuwumJYHTuCBhonq1zGezI7YyVV0Eu1GyV5n\nRkWY9iM+zri/Jah28NMLZc7Ssf7Y0fB8+QQv1/huO2N74X+/18nw21hQg1Fws1Sl\nLBdbdpo3ulePllQ2/ym8/VTF1Ok54CIUUDyKaf+78OwGZX35SYvpjesmti4UU4F/\nbfrptQ7iHFpkP/ApJTmDimglYjA8t3/GAosiswt4lX5PeOU5ED+ZGShoHr8xANMZ\nYPQ/js/GwvMGOzU+kr/+93pJu8v0F4ZK6BaaoGH1kOX7M5OkWS76EQD8GGuVuDck\nygsR2LwCvJvU+eCFUt4tHrDuDoZuQaUgcw5vAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBADoMSUQqXLSgZ2nrwFEPypiD9WlF1O7s\nW78xpDxl/K+u/4ezkGck97EP90ifqJbzV9qTv1y4podTWuhYRmSwBD8D9g2OYL+r\nTir/Hu5ZP/F4306qggIl/XKD+ZzE1fnTu/gs+zOYnZzoF61cIfEV5rx/nVmm+axT\nB3tHoDLOTZjUgd3nafrg7xnfACL4mVHCrRmwv5TLdwGS8G8o0ACeIcsnJkCDIH1k\nHWNUJbWUFbGWzHQP44rIgiimRYl6iRZeCfDcwnunZf22koRTZE0k2mBxGNPJbS2O\nemRfwVifzJd9G2dGvLaHpB4tj2imqYBLdKIxIVZcxjP/FVMLY9cEH2U=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 5
to: 6
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 16 0.375 1521582375769
connected to auth! from local port 55872
received auth hello!
{ authId: 502, nonce: <Buffer 8f 38 8c 7b 99 c5 a9 b4> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 58 2c 97 89 b6 a2 0f b8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer c5 b6 14 58 ea da 49 f4 2b 1d b7 9c 0d 00 a6 0d>,
  macKeyVal: <Buffer d3 a5 2f 46 9a af d6 2a 73 5d d1 ca 7a fa fe c3 a7 16 96 63 94 e1 cf f3 50 19 b4 90 40 0b d4 e8>,
  absValidity: 2018-03-20T22:46:19.574Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201156,
  cipherKeyVal: <Buffer 26 ba 3a 44 a2 3d 2f e5 a6 f7 65 9a 48 c3 de 60>,
  macKeyVal: <Buffer 5a 76 18 2a 93 a8 95 0e d6 66 bb 82 3e 20 ba 9c 6c 44 40 4d 50 76 d8 a2 4b 95 a6 72 1d 54 eb 9b>,
  absValidity: 2018-03-21T21:46:19.573Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.40',
  serverPort: 22100,
  sessionKey: 
   { id: 50201156,
     cipherKeyVal: <Buffer 26 ba 3a 44 a2 3d 2f e5 a6 f7 65 9a 48 c3 de 60>,
     macKeyVal: <Buffer 5a 76 18 2a 93 a8 95 0e d6 66 bb 82 3e 20 ba 9c 6c 44 40 4d 50 76 d8 a2 4b 95 a6 72 1d 54 eb 9b>,
     absValidity: 2018-03-21T21:46:19.573Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer ce 7b 36 09 cb 6f 96 1a>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.40:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 17 0.35294117647058826 1521582435776
connected to auth! from local port 56104
received auth hello!
{ authId: 502, nonce: <Buffer 65 33 1e 81 a2 42 0d 62> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer dd 0a 89 f4 c8 37 05 cb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201172,
  cipherKeyVal: <Buffer a5 e8 30 99 e5 43 f1 ee 82 9b 3e 57 00 bb 44 50>,
  macKeyVal: <Buffer 45 c2 78 3c ce 2d f5 1e 7c c0 29 41 d5 bf 23 77 e9 77 f2 db 98 78 aa 75 66 b8 25 5f c8 bf 36 4d>,
  absValidity: 2018-03-21T21:47:19.646Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.40',
  serverPort: 22100,
  sessionKey: 
   { id: 50201172,
     cipherKeyVal: <Buffer a5 e8 30 99 e5 43 f1 ee 82 9b 3e 57 00 bb 44 50>,
     macKeyVal: <Buffer 45 c2 78 3c ce 2d f5 1e 7c c0 29 41 d5 bf 23 77 e9 77 f2 db 98 78 aa 75 66 b8 25 5f c8 bf 36 4d>,
     absValidity: 2018-03-21T21:47:19.646Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 33 6f 54 ea 2f ad eb a3>
switching to HANDSHAKE_1_SENT
disconnected from auth
/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902
            eventHandlers.onError('Error occurred in migration request: Disconnected from auth before getting migration response: ' + error);
                                                                                                                                      ^

ReferenceError: error is not defined
    at Socket.<anonymous> (/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902:135)
    at emitNone (events.js:91:20)
    at Socket.emit (events.js:188:7)
    at endReadableNT (_stream_readable.js:975:12)
    at _combinedTickCallback (internal/process/next_tick.js:80:11)
    at process._tickCallback (internal/process/next_tick.js:104:9)
