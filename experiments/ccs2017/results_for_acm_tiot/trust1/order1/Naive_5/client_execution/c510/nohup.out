changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c510.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c510',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 51 49 42 41 41 4b 43 41 51 45 41 73 32 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521581435854
connected to auth! from local port 44176
received auth hello!
{ authId: 501, nonce: <Buffer 77 0d b8 f9 53 96 ef ae> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer f4 60 21 42 0d af b0 ef>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer ad 62 05 10 9c da 91 a5 40 d0 b1 fe be b2 c8 89>,
  macKeyVal: <Buffer f4 46 cb 41 84 66 2d e4 a1 49 95 bb b7 63 40 8b 43 6e b0 bd 72 d2 57 0e a3 0a bf 4d b0 17 c9 da>,
  absValidity: 2018-03-20T22:30:36.037Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100561,
  cipherKeyVal: <Buffer 4e 05 4b 33 ea 7c fb 2b 74 e7 78 2b 05 4f 1e 29>,
  macKeyVal: <Buffer 74 31 c6 64 c4 6d 78 8e 56 19 cb 3d e4 45 eb ee 7d 83 61 95 e8 f7 0a 93 eb af b9 13 6a 15 a3 38>,
  absValidity: 2018-03-21T21:30:36.037Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.30',
  serverPort: 22100,
  sessionKey: 
   { id: 50100561,
     cipherKeyVal: <Buffer 4e 05 4b 33 ea 7c fb 2b 74 e7 78 2b 05 4f 1e 29>,
     macKeyVal: <Buffer 74 31 c6 64 c4 6d 78 8e 56 19 cb 3d e4 45 eb ee 7d 83 61 95 e8 f7 0a 93 eb af b9 13 6a 15 a3 38>,
     absValidity: 2018-03-21T21:30:36.037Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 7b ec 7c ed c3 f3 46 04>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 21:30:37 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521581438223
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521581495910
connected to auth! from local port 44446
received auth hello!
{ authId: 501, nonce: <Buffer 9a e9 b7 4e a0 3f c9 8f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4d 91 09 df c2 0a d8 b3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100569,
  cipherKeyVal: <Buffer 9e a2 10 a5 ab bf 8f 9b 34 a9 8b c5 38 ff 58 cf>,
  macKeyVal: <Buffer 4b 45 03 3c 59 96 52 7a 47 47 de 5e ec fd cb 67 bd f6 79 bf 03 ef 1d fd 99 f2 46 c9 34 43 34 55>,
  absValidity: 2018-03-21T21:31:36.111Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.30',
  serverPort: 22100,
  sessionKey: 
   { id: 50100569,
     cipherKeyVal: <Buffer 9e a2 10 a5 ab bf 8f 9b 34 a9 8b c5 38 ff 58 cf>,
     macKeyVal: <Buffer 4b 45 03 3c 59 96 52 7a 47 47 de 5e ec fd cb 67 bd f6 79 bf 03 ef 1d fd 99 f2 46 c9 34 43 34 55>,
     absValidity: 2018-03-21T21:31:36.111Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer db 19 55 72 ea e4 a2 54>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 21:31:37 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521581498159
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521581555965
connected to auth! from local port 44716
received auth hello!
{ authId: 501, nonce: <Buffer 2d 57 4a cd 48 d9 de a3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b3 d8 a4 b0 2a a6 e7 77>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100577,
  cipherKeyVal: <Buffer e3 a1 8d c6 bb 5c c6 04 ac c9 5b 0b a1 08 67 06>,
  macKeyVal: <Buffer 2b 2f f5 53 0f 41 54 ec ff 90 2e 50 59 c1 c4 97 bd db 15 ff 65 0e 0f 0a 4e ae 81 3b 07 61 1a 92>,
  absValidity: 2018-03-21T21:32:36.133Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.30',
  serverPort: 22100,
  sessionKey: 
   { id: 50100577,
     cipherKeyVal: <Buffer e3 a1 8d c6 bb 5c c6 04 ac c9 5b 0b a1 08 67 06>,
     macKeyVal: <Buffer 2b 2f f5 53 0f 41 54 ec ff 90 2e 50 59 c1 c4 97 bd db 15 ff 65 0e 0f 0a 4e ae 81 3b 07 61 1a 92>,
     absValidity: 2018-03-21T21:32:36.133Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer e1 a4 bc cd 7d 67 9c d5>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 21:32:37 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521581558272
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521581616015
connected to auth! from local port 44986
received auth hello!
{ authId: 501, nonce: <Buffer 04 d4 11 3f fb 70 7d bb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1a 1f bf e5 28 e5 72 14>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100585,
  cipherKeyVal: <Buffer 8c bd 2e c9 68 41 31 d5 de 63 f6 4d df 01 77 40>,
  macKeyVal: <Buffer 28 fb 24 0f 70 c8 6f f4 73 94 21 db a5 a3 5a e3 c5 1d 0a 7a 9a 5f 3b 60 3d fa 1a 10 d3 7a d4 4d>,
  absValidity: 2018-03-21T21:33:36.232Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.30',
  serverPort: 22100,
  sessionKey: 
   { id: 50100585,
     cipherKeyVal: <Buffer 8c bd 2e c9 68 41 31 d5 de 63 f6 4d df 01 77 40>,
     macKeyVal: <Buffer 28 fb 24 0f 70 c8 6f f4 73 94 21 db a5 a3 5a e3 c5 1d 0a 7a 9a 5f 3b 60 3d fa 1a 10 d3 7a d4 4d>,
     absValidity: 2018-03-21T21:33:36.232Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 6b 8e 1e 90 71 a5 d3 56>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 21:33:38 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521581618363
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521581676063
connected to auth! from local port 45256
received auth hello!
{ authId: 501, nonce: <Buffer ac 5d 39 18 af 5f b5 5f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f1 d7 40 91 66 c2 f8 c4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100593,
  cipherKeyVal: <Buffer c8 10 cc c0 00 9e 1f 40 e7 d5 b7 45 6c 90 87 0e>,
  macKeyVal: <Buffer c1 66 d7 bf dd 23 cb 01 25 db a7 21 d9 1c 3c a6 57 4b 92 a1 02 d7 cd c0 72 df f4 51 98 7b fa 37>,
  absValidity: 2018-03-21T21:34:36.298Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.30',
  serverPort: 22100,
  sessionKey: 
   { id: 50100593,
     cipherKeyVal: <Buffer c8 10 cc c0 00 9e 1f 40 e7 d5 b7 45 6c 90 87 0e>,
     macKeyVal: <Buffer c1 66 d7 bf dd 23 cb 01 25 db a7 21 d9 1c 3c a6 57 4b 92 a1 02 d7 cd c0 72 df f4 51 98 7b fa 37>,
     absValidity: 2018-03-21T21:34:36.298Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer c9 34 77 1d f1 54 ae 5e>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 21:34:38 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521581678306
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521581736081
connected to auth! from local port 45526
received auth hello!
{ authId: 501, nonce: <Buffer 1a 59 d2 83 aa 04 b4 9d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f2 88 e9 8d 76 27 c5 20>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100601,
  cipherKeyVal: <Buffer 7b ca d0 1b 84 6b a2 7c 27 02 3d b3 33 d9 f5 1e>,
  macKeyVal: <Buffer dd d4 41 f9 ec 68 e3 7f b6 df 67 1d 7d 32 26 5d e9 aa 78 5a c2 ea 0b 14 3e 17 1a d8 d0 89 4f 6c>,
  absValidity: 2018-03-21T21:35:36.260Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.30',
  serverPort: 22100,
  sessionKey: 
   { id: 50100601,
     cipherKeyVal: <Buffer 7b ca d0 1b 84 6b a2 7c 27 02 3d b3 33 d9 f5 1e>,
     macKeyVal: <Buffer dd d4 41 f9 ec 68 e3 7f b6 df 67 1d 7d 32 26 5d e9 aa 78 5a c2 ea 0b 14 3e 17 1a d8 d0 89 4f 6c>,
     absValidity: 2018-03-21T21:35:36.260Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer fa bc 68 10 ad ca 54 7b>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 21:35:38 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521581738315
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521581796137
connected to auth! from local port 45796
received auth hello!
{ authId: 501, nonce: <Buffer 12 6d 59 10 ee ad 19 71> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 60 2d 5c 47 cc 5e e7 cb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100609,
  cipherKeyVal: <Buffer 51 3a 73 1d 8c ff 0e 59 07 86 24 e4 54 bf 25 ff>,
  macKeyVal: <Buffer 97 ce 26 2a bc b5 65 61 e8 f6 c5 7c 81 c6 f8 a8 db 3c 90 8a 85 5f 38 10 00 b8 ec c1 ed bd db a3>,
  absValidity: 2018-03-21T21:36:36.309Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.30',
  serverPort: 22100,
  sessionKey: 
   { id: 50100609,
     cipherKeyVal: <Buffer 51 3a 73 1d 8c ff 0e 59 07 86 24 e4 54 bf 25 ff>,
     macKeyVal: <Buffer 97 ce 26 2a bc b5 65 61 e8 f6 c5 7c 81 c6 f8 a8 db 3c 90 8a 85 5f 38 10 00 b8 ec c1 ed bd db a3>,
     absValidity: 2018-03-21T21:36:36.309Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer b9 ec 12 8c d3 9b b6 1e>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 21:36:38 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521581798427
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521581856196
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 9 0.7777777777777778 1521581916206
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 10 0.7 1521581976214
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 59872
received auth hello!
{ authId: 502, nonce: <Buffer c4 0e e2 4c f7 85 e1 85> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '0162454FC332',
  notBefore: 2018-03-20T21:26:18.000Z,
  notAfter: 2018-03-21T21:27:58.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '6F:38:43:BC:D5:F1:13:C9:CD:90:C8:0E:87:9C:0A:B9:32:A6:32:49',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'E40B9EF20959AA49D02016EC2E9896074EE0818689EAD7319ECC8ED8C9557412ED46C95E67464598F6233ECEB8BF25A876F0D30B65CED2B1FED8D1F07CF9042FD7F86E3B637BE17FBFD7C9F0DB5850835170B354A52C175B769A37BA578F965436FF29BCFD54C5D4E939E02214503C8A69FFBBF0EC06657DF9498BE98DEB26B62E1453817F6DFAE9B50EE21C5A643FF0292539838A682562303CB77FC6028B22B30B78957E4F78E539103F991928681EBF3100D31960F43F8ECFC6C2F3063B353E92BFFEF77A49BBCBF417864AE8169AA061F590E5FB3393A4592EFA1100FC186B95B83724CA0B11D8BC02BC9BD4F9E08552DE2D1EB0EE0E866E41A520730E6F',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJFT8MyMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDMy\nMDIxMjYxOFoXDTE4MDMyMTIxMjc1OFowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDkC57yCVmqSdAgFuwumJYHTuCBhonq1zGezI7YyVV0Eu1GyV5n\nRkWY9iM+zri/Jah28NMLZc7Ssf7Y0fB8+QQv1/huO2N74X+/18nw21hQg1Fws1Sl\nLBdbdpo3ulePllQ2/ym8/VTF1Ok54CIUUDyKaf+78OwGZX35SYvpjesmti4UU4F/\nbfrptQ7iHFpkP/ApJTmDimglYjA8t3/GAosiswt4lX5PeOU5ED+ZGShoHr8xANMZ\nYPQ/js/GwvMGOzU+kr/+93pJu8v0F4ZK6BaaoGH1kOX7M5OkWS76EQD8GGuVuDck\nygsR2LwCvJvU+eCFUt4tHrDuDoZuQaUgcw5vAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAI4Fqq14qkynqQF4x8rvl6Aa72v4cuva\nj124l6jPCLm2Pdc3CEIgQMwLWIY5wXnZuQqRBMrHPmNmVCqEm72idk2/NXbhf54S\nefWH/9FWM8D9LJF5accBM2VvQngbc+lNl64wy9KoPiJjbxyzusmwEyTY/+pDU8r2\nUHEhcwyzMXoFDrep2JuGQ1QleBQgulS4ifavE8PuE1gXVLO1tuM4OfXqv9ceKHiv\ndiTyfiXQNS1ljy9U5IinZk4JQKUekXHA8y6GxDAuIab9Kj+cbHWARJn2yJo3kI66\nxLVVjricwUpyO2jNNHaQPGo5G+v5Ctw+nxcswZWdBcUDkMczo3peYkI=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 1
to: 2
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 11 0.6363636363636364 1521582036225
connected to auth! from local port 60082
received auth hello!
{ authId: 502, nonce: <Buffer 82 a6 7b a5 10 63 64 ff> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 16 2e e3 de 7d 68 e8 2a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 16 a0 b8 16 37 05 f6 79 b1 f0 cf a4 5f 8e be 57>,
  macKeyVal: <Buffer ac 8f 9f 6e 43 31 3e 39 79 43 8e bb df 29 32 c7 ce d5 6f 36 f7 a5 5c cb 03 c9 a0 b5 ea ca 4b ca>,
  absValidity: 2018-03-20T22:40:36.420Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201070,
  cipherKeyVal: <Buffer 8d ac 9e 75 dd 03 96 77 dd 47 54 09 be 6f f9 4a>,
  macKeyVal: <Buffer af e0 e9 50 b8 26 8f 48 01 e7 43 63 3d e2 bc d4 f0 0a 1a 86 8c b4 c5 88 1b 74 99 49 0e 5b 54 2a>,
  absValidity: 2018-03-21T21:40:36.419Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.30',
  serverPort: 22100,
  sessionKey: 
   { id: 50201070,
     cipherKeyVal: <Buffer 8d ac 9e 75 dd 03 96 77 dd 47 54 09 be 6f f9 4a>,
     macKeyVal: <Buffer af e0 e9 50 b8 26 8f 48 01 e7 43 63 3d e2 bc d4 f0 0a 1a 86 8c b4 c5 88 1b 74 99 49 0e 5b 54 2a>,
     absValidity: 2018-03-21T21:40:36.419Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 1e 1b 22 bb a8 a7 61 3c>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.30:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 12 0.5833333333333334 1521582096235
connected to auth! from local port 60296
received auth hello!
{ authId: 502, nonce: <Buffer 82 a7 dd 33 70 b4 01 e3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d4 e8 12 94 3a 73 66 32>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201080,
  cipherKeyVal: <Buffer 9b e5 48 bd ee 47 37 b5 94 38 07 ad 44 68 ba 29>,
  macKeyVal: <Buffer 0a 87 2e 22 5a fb a8 0b 06 a8 b6 50 9c 8c f6 44 51 ad d7 95 05 c7 83 c0 b3 32 f5 f3 c3 6c bf 45>,
  absValidity: 2018-03-21T21:41:36.361Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.30',
  serverPort: 22100,
  sessionKey: 
   { id: 50201080,
     cipherKeyVal: <Buffer 9b e5 48 bd ee 47 37 b5 94 38 07 ad 44 68 ba 29>,
     macKeyVal: <Buffer 0a 87 2e 22 5a fb a8 0b 06 a8 b6 50 9c 8c f6 44 51 ad d7 95 05 c7 83 c0 b3 32 f5 f3 c3 6c bf 45>,
     absValidity: 2018-03-21T21:41:36.361Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 24 d2 48 6f bb d4 3f 97>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.30:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 13 0.5384615384615384 1521582156241
connected to auth! from local port 60542
received auth hello!
{ authId: 502, nonce: <Buffer 3a ce 0c 20 fb 21 a8 34> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 01 f9 04 3b 0d 23 7b 9c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201098,
  cipherKeyVal: <Buffer 0e 42 ed 62 29 b0 2c de 92 50 03 b9 de ec c3 e9>,
  macKeyVal: <Buffer 87 9d 78 ab a2 a3 69 f3 98 4c e1 e4 13 7f 57 1c 77 85 bd bd 99 f8 eb 75 df ed 4b 7b fe 3f 25 49>,
  absValidity: 2018-03-21T21:42:36.375Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.30',
  serverPort: 22100,
  sessionKey: 
   { id: 50201098,
     cipherKeyVal: <Buffer 0e 42 ed 62 29 b0 2c de 92 50 03 b9 de ec c3 e9>,
     macKeyVal: <Buffer 87 9d 78 ab a2 a3 69 f3 98 4c e1 e4 13 7f 57 1c 77 85 bd bd 99 f8 eb 75 df ed 4b 7b fe 3f 25 49>,
     absValidity: 2018-03-21T21:42:36.375Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer e2 1d 77 f9 ce 0b f7 49>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.30:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 14 0.5 1521582216243
connected to auth! from local port 60788
received auth hello!
{ authId: 502, nonce: <Buffer ea b4 69 04 90 40 9e 7d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 92 62 0b 70 0c 29 c3 40>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201116,
  cipherKeyVal: <Buffer 7a d7 d8 6b f2 d6 f1 a8 d7 fa 74 e5 84 1f 12 88>,
  macKeyVal: <Buffer 85 4f 0e 1b 86 db 79 98 fb 24 fa 1e 96 f0 65 66 12 ff 15 f0 66 a6 22 a8 33 91 60 33 54 6b 4c 50>,
  absValidity: 2018-03-21T21:43:37.305Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.30',
  serverPort: 22100,
  sessionKey: 
   { id: 50201116,
     cipherKeyVal: <Buffer 7a d7 d8 6b f2 d6 f1 a8 d7 fa 74 e5 84 1f 12 88>,
     macKeyVal: <Buffer 85 4f 0e 1b 86 db 79 98 fb 24 fa 1e 96 f0 65 66 12 ff 15 f0 66 a6 22 a8 33 91 60 33 54 6b 4c 50>,
     absValidity: 2018-03-21T21:43:37.305Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 50 3c 9b df 3e 0b c2 da>
switching to HANDSHAKE_1_SENT
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 21:43:43 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 14 0.5714285714285714 1521582223499
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 15 0.5333333333333333 1521582276296
connected to auth! from local port 32800
received auth hello!
{ authId: 502, nonce: <Buffer 4a c7 31 e2 c8 ce a3 10> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2f 3d 1a e3 3b 05 f0 be>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201135,
  cipherKeyVal: <Buffer 2c c4 ae d8 cf 86 5f b7 1d 35 ac c6 80 bd f2 b7>,
  macKeyVal: <Buffer 5d 29 8b 30 92 3d f2 1c 5a 2e f5 ba 2c db 0c 77 aa aa c4 52 5f f1 28 c0 0b 3c ce cf f9 19 f0 38>,
  absValidity: 2018-03-21T21:44:37.319Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.30',
  serverPort: 22100,
  sessionKey: 
   { id: 50201135,
     cipherKeyVal: <Buffer 2c c4 ae d8 cf 86 5f b7 1d 35 ac c6 80 bd f2 b7>,
     macKeyVal: <Buffer 5d 29 8b 30 92 3d f2 1c 5a 2e f5 ba 2c db 0c 77 aa aa c4 52 5f f1 28 c0 0b 3c ce cf f9 19 f0 38>,
     absValidity: 2018-03-21T21:44:37.319Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 9a a1 4b fb 60 3a fe 3f>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 21:44:40 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 9 15 0.6 1521582280966
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 16 0.5625 1521582336352
connected to auth! from local port 33024
Handler: Error in secure comm - details: Auth hello timedout ...
received auth hello!
{ authId: 502, nonce: <Buffer d8 7a ff 4e 11 2c 14 80> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: write after end
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 17 0.5294117647058824 1521582396352
connected to auth! from local port 33240
disconnected from auth
Handler: Error in secure comm - details: Connection with Auth timed out...
Handler: Error in secure comm - details: Auth hello timedout ...
received auth hello!
{ authId: 502, nonce: <Buffer cc 7c 07 a6 a5 3b 75 4c> }
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: write after end
connected to auth! from local port 37758
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 18 0.5 1521582456361
connected to auth! from local port 33462
disconnected from auth
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Handler: Error in secure comm - details: Connection with Auth timed out...
Handler: Error in secure comm - details: Auth hello timedout ...
received auth hello!
{ authId: 502, nonce: <Buffer ed 9a 4e b9 6f 31 0c d3> }
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: write after end
connected to auth! from local port 37962
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 19 0.47368421052631576 1521582516361
connected to auth! from local port 33640
disconnected from auth
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Handler: Error in secure comm - details: Connection with Auth timed out...
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 20 0.45 1521582576370
connected to auth! from local port 33818
received auth hello!
{ authId: 502, nonce: <Buffer 53 2b 85 17 17 b4 ba d3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f6 7d 52 e5 f9 86 97 93>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201216,
  cipherKeyVal: <Buffer a4 ca 6a f8 68 ca 7a 02 06 23 63 dd 4d 06 6d a9>,
  macKeyVal: <Buffer a8 2b ab c5 43 38 81 e9 1b 8b ff 24 bb f1 67 b7 d5 34 8b 46 e6 98 cc 60 45 3c dc a5 42 5b 53 be>,
  absValidity: 2018-03-21T21:49:48.078Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.30',
  serverPort: 22100,
  sessionKey: 
   { id: 50201216,
     cipherKeyVal: <Buffer a4 ca 6a f8 68 ca 7a 02 06 23 63 dd 4d 06 6d a9>,
     macKeyVal: <Buffer a8 2b ab c5 43 38 81 e9 1b 8b ff 24 bb f1 67 b7 d5 34 8b 46 e6 98 cc 60 45 3c dc a5 42 5b 53 be>,
     absValidity: 2018-03-21T21:49:48.078Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 0c a7 00 32 44 de 08 bd>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
received auth hello!
{ authId: 502, nonce: <Buffer 33 f7 5b 18 c9 8b 57 af> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: write after end
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 21 0.42857142857142855 1521582636390
connected to auth! from local port 33998
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.30:undefined
Handler: Error in secure comm - details: Connection with Auth timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 48 17 a2 be 20 b2 1e d7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 02 56 81 2a cd 3f 60 69>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201232,
  cipherKeyVal: <Buffer f3 2e 5e bf 73 56 3c b3 a9 3d 8e d5 44 e0 5e 4a>,
  macKeyVal: <Buffer e0 52 f0 96 3b 3a 33 d9 e9 fd 4b 28 36 df 01 6a 41 9b 0a 29 aa 40 47 43 34 a8 dd cc 39 4e 40 f1>,
  absValidity: 2018-03-21T21:50:48.055Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.30',
  serverPort: 22100,
  sessionKey: 
   { id: 50201232,
     cipherKeyVal: <Buffer f3 2e 5e bf 73 56 3c b3 a9 3d 8e d5 44 e0 5e 4a>,
     macKeyVal: <Buffer e0 52 f0 96 3b 3a 33 d9 e9 fd 4b 28 36 df 01 6a 41 9b 0a 29 aa 40 47 43 34 a8 dd cc 39 4e 40 f1>,
     absValidity: 2018-03-21T21:50:48.055Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 12 bb d2 eb 1b 1b ab f0>
switching to HANDSHAKE_1_SENT
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 22 0.4090909090909091 1521582696439
connected to auth! from local port 34182
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.30:undefined
received auth hello!
{ authId: 502, nonce: <Buffer 96 ec 96 2e cf d6 2e c0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d8 7f f6 a7 18 0a 10 43>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201247,
  cipherKeyVal: <Buffer 81 69 a8 71 9e e0 37 ab c9 60 c2 59 c8 fe 00 5f>,
  macKeyVal: <Buffer e8 08 3c 32 fb 4d f1 42 87 c8 1f f1 72 d8 fb 29 54 38 44 41 4f 21 53 c3 6e 40 ae c7 8a a5 de 4c>,
  absValidity: 2018-03-21T21:51:48.046Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.30',
  serverPort: 22100,
  sessionKey: 
   { id: 50201247,
     cipherKeyVal: <Buffer 81 69 a8 71 9e e0 37 ab c9 60 c2 59 c8 fe 00 5f>,
     macKeyVal: <Buffer e8 08 3c 32 fb 4d f1 42 87 c8 1f f1 72 d8 fb 29 54 38 44 41 4f 21 53 c3 6e 40 ae c7 8a a5 de 4c>,
     absValidity: 2018-03-21T21:51:48.046Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 08 3b 8b 70 4d 0d 79 00>
switching to HANDSHAKE_1_SENT
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 21:52:00 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 10 22 0.45454545454545453 1521582720472
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 10 23 0.43478260869565216 1521582756473
connected to auth! from local port 34348
Handler: Error in secure comm - details: Auth hello timedout ...
received auth hello!
{ authId: 502, nonce: <Buffer d2 f2 86 9f a6 e4 c1 41> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: write after end
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 10 24 0.4166666666666667 1521582816478
connected to auth! from local port 34520
received auth hello!
{ authId: 502, nonce: <Buffer c8 76 96 9e 7a bd 45 2a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 74 1f 54 1d f3 6f 1f 52>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201275,
  cipherKeyVal: <Buffer be 17 20 06 11 86 c0 9b 1d e6 fd 13 cb 20 5d e6>,
  macKeyVal: <Buffer 49 1f 5b c2 f4 92 a3 71 e3 e6 87 38 99 b5 4b b4 34 78 d8 03 19 df 1b 56 5c a5 89 33 b1 19 5d cf>,
  absValidity: 2018-03-21T21:53:40.144Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.30',
  serverPort: 22100,
  sessionKey: 
   { id: 50201275,
     cipherKeyVal: <Buffer be 17 20 06 11 86 c0 9b 1d e6 fd 13 cb 20 5d e6>,
     macKeyVal: <Buffer 49 1f 5b c2 f4 92 a3 71 e3 e6 87 38 99 b5 4b b4 34 78 d8 03 19 df 1b 56 5c a5 89 33 b1 19 5d cf>,
     absValidity: 2018-03-21T21:53:40.144Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer b4 78 11 15 c5 36 53 f0>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
disconnected from auth
Handler: Error in secure comm - details: Connection with Auth timed out...
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.30:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 10 25 0.4 1521582876484
connected to auth! from local port 34698
received auth hello!
{ authId: 502, nonce: <Buffer 47 5d a6 7c f8 7e ac da> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer aa 95 24 26 e5 97 e9 7b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201292,
  cipherKeyVal: <Buffer 34 a1 85 26 5e ba 96 34 88 84 39 7c 29 71 ba fc>,
  macKeyVal: <Buffer fc bc f5 b2 77 58 7a 39 c3 fc 7c 24 ad f9 00 ee af aa 89 7f 27 22 37 9a 63 bb 51 c6 d3 79 fc e2>,
  absValidity: 2018-03-21T21:54:40.098Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.30',
  serverPort: 22100,
  sessionKey: 
   { id: 50201292,
     cipherKeyVal: <Buffer 34 a1 85 26 5e ba 96 34 88 84 39 7c 29 71 ba fc>,
     macKeyVal: <Buffer fc bc f5 b2 77 58 7a 39 c3 fc 7c 24 ad f9 00 ee af aa 89 7f 27 22 37 9a 63 bb 51 c6 d3 79 fc e2>,
     absValidity: 2018-03-21T21:54:40.098Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 71 e8 f7 da ab 1a dc f8>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.30:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 10 26 0.38461538461538464 1521582936490
connected to auth! from local port 34872
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 10 27 0.37037037037037035 1521582996501
connected to auth! from local port 35052
received auth hello!
{ authId: 502, nonce: <Buffer f5 bf e8 d9 63 3d 8e b5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b6 31 1f ec c2 fb 0c 55>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201328,
  cipherKeyVal: <Buffer 05 31 8d 29 96 67 a0 03 ad f2 7c af 4d a5 e7 3c>,
  macKeyVal: <Buffer 0a e5 45 02 13 b4 1b 44 da 80 df 0e f6 2d 4a ae 62 b0 61 8d db 8b e3 e1 13 9b dd 59 76 76 4b 19>,
  absValidity: 2018-03-21T21:56:56.316Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.30',
  serverPort: 22100,
  sessionKey: 
   { id: 50201328,
     cipherKeyVal: <Buffer 05 31 8d 29 96 67 a0 03 ad f2 7c af 4d a5 e7 3c>,
     macKeyVal: <Buffer 0a e5 45 02 13 b4 1b 44 da 80 df 0e f6 2d 4a ae 62 b0 61 8d db 8b e3 e1 13 9b dd 59 76 76 4b 19>,
     absValidity: 2018-03-21T21:56:56.316Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer c0 4b 32 ac fd 65 66 8b>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 21:57:00 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 11 27 0.4074074074074074 1521583020686
received auth hello!
{ authId: 502, nonce: <Buffer ee c1 0c ef 66 3b c0 77> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: write after end
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 11 28 0.39285714285714285 1521583056501
connected to auth! from local port 35210
