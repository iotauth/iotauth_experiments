changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c507.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c507',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 6e 39 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521581426045
connected to auth! from local port 36748
received auth hello!
{ authId: 501, nonce: <Buffer 44 5e 5d e8 c4 7c 62 09> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer e6 af 1c 4e cc 47 b5 f2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 76 5e 61 a1 f9 c4 e5 1b d9 20 5d 4f 8c a8 10 a2>,
  macKeyVal: <Buffer f6 eb 35 af 08 2e 6b a4 7d 6e d8 c6 7e fa ce 2c fa 5a da b3 95 a7 22 38 9a 77 79 d8 ea 6e 27 02>,
  absValidity: 2018-03-20T22:30:26.192Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100558,
  cipherKeyVal: <Buffer 9e 0f b0 a4 0d 49 77 fa 1e 31 91 8e 80 b0 fd 67>,
  macKeyVal: <Buffer 83 2f 7c 86 02 1f 15 02 cc 79 13 09 80 85 56 c4 6a 68 91 bf 4d a2 2c 5f 08 53 68 80 3d 29 1a 60>,
  absValidity: 2018-03-21T21:30:26.191Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100558,
     cipherKeyVal: <Buffer 9e 0f b0 a4 0d 49 77 fa 1e 31 91 8e 80 b0 fd 67>,
     macKeyVal: <Buffer 83 2f 7c 86 02 1f 15 02 cc 79 13 09 80 85 56 c4 6a 68 91 bf 4d a2 2c 5f 08 53 68 80 3d 29 1a 60>,
     absValidity: 2018-03-21T21:30:26.191Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer a6 40 1a eb d0 ed f9 3a>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 21:30:26 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521581427083
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521581486102
connected to auth! from local port 37008
received auth hello!
{ authId: 501, nonce: <Buffer 0a 05 9f 35 d5 ac c2 42> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 43 b2 e3 56 93 56 3d 81>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100566,
  cipherKeyVal: <Buffer 03 32 88 13 f4 ff ea 32 26 3b e2 48 9a 0d 33 e0>,
  macKeyVal: <Buffer 41 05 66 13 15 13 11 9e 8f d2 73 db 7f 25 eb c1 11 8b 5a a8 65 8a 20 a6 d7 40 52 81 93 6d ae 67>,
  absValidity: 2018-03-21T21:31:26.239Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100566,
     cipherKeyVal: <Buffer 03 32 88 13 f4 ff ea 32 26 3b e2 48 9a 0d 33 e0>,
     macKeyVal: <Buffer 41 05 66 13 15 13 11 9e 8f d2 73 db 7f 25 eb c1 11 8b 5a a8 65 8a 20 a6 d7 40 52 81 93 6d ae 67>,
     absValidity: 2018-03-21T21:31:26.239Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 1a b7 c2 8d ed f0 6f 64>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 21:31:26 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521581487056
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521581546157
connected to auth! from local port 37278
received auth hello!
{ authId: 501, nonce: <Buffer 61 35 e0 55 ab 05 e3 9d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7c 53 48 d6 a5 46 b2 86>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100574,
  cipherKeyVal: <Buffer fd a6 e0 45 e7 fd 01 49 eb 1e 25 c9 b6 45 62 ea>,
  macKeyVal: <Buffer 35 a7 38 1b 69 60 61 8a 08 a8 fa 12 5d 67 09 bc 9a 5f 54 18 4a 87 6f 05 70 a2 6c 5f 7c cb 4b 62>,
  absValidity: 2018-03-21T21:32:26.324Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100574,
     cipherKeyVal: <Buffer fd a6 e0 45 e7 fd 01 49 eb 1e 25 c9 b6 45 62 ea>,
     macKeyVal: <Buffer 35 a7 38 1b 69 60 61 8a 08 a8 fa 12 5d 67 09 bc 9a 5f 54 18 4a 87 6f 05 70 a2 6c 5f 7c cb 4b 62>,
     absValidity: 2018-03-21T21:32:26.324Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 60 56 c7 0f d1 d8 41 0c>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 21:32:26 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521581547289
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521581606209
connected to auth! from local port 37548
received auth hello!
{ authId: 501, nonce: <Buffer f4 58 b8 d9 66 5e 36 1a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 29 35 2c c5 9e 6f 5f 81>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100582,
  cipherKeyVal: <Buffer 98 f7 89 e5 76 f1 67 fe b9 87 ea 50 39 42 52 19>,
  macKeyVal: <Buffer 5c 30 c6 f3 b1 f2 08 e7 b9 5c 9d c0 5f d3 91 dc 3d d0 22 5f 28 d5 c9 a5 16 c3 2c 8f 6c f5 f4 c5>,
  absValidity: 2018-03-21T21:33:26.340Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100582,
     cipherKeyVal: <Buffer 98 f7 89 e5 76 f1 67 fe b9 87 ea 50 39 42 52 19>,
     macKeyVal: <Buffer 5c 30 c6 f3 b1 f2 08 e7 b9 5c 9d c0 5f d3 91 dc 3d d0 22 5f 28 d5 c9 a5 16 c3 2c 8f 6c f5 f4 c5>,
     absValidity: 2018-03-21T21:33:26.340Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 7e 6e 26 94 71 77 a2 50>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 21:33:26 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521581607160
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521581666211
connected to auth! from local port 37818
received auth hello!
{ authId: 501, nonce: <Buffer 52 49 75 64 dd 64 31 4f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ac 86 a4 85 15 c3 97 11>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100590,
  cipherKeyVal: <Buffer e4 e3 01 3b 59 5b 00 7a 68 31 96 36 46 c3 e4 2f>,
  macKeyVal: <Buffer d7 5c 39 da 48 f1 5c 0b 72 19 6c ba 8a a4 ed f9 96 be 8c b9 c7 8a ed 46 52 51 81 0b 1a 5e 43 d6>,
  absValidity: 2018-03-21T21:34:26.343Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100590,
     cipherKeyVal: <Buffer e4 e3 01 3b 59 5b 00 7a 68 31 96 36 46 c3 e4 2f>,
     macKeyVal: <Buffer d7 5c 39 da 48 f1 5c 0b 72 19 6c ba 8a a4 ed f9 96 be 8c b9 c7 8a ed 46 52 51 81 0b 1a 5e 43 d6>,
     absValidity: 2018-03-21T21:34:26.343Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 5e 47 7c 76 64 34 6f b1>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 21:34:26 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521581667231
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521581726269
connected to auth! from local port 38088
received auth hello!
{ authId: 501, nonce: <Buffer ff 51 73 b9 76 2b db 28> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c9 e3 34 1a 82 20 7f ef>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100598,
  cipherKeyVal: <Buffer 0b 54 58 0d 39 47 e9 15 ee 30 b4 b7 a8 98 2a dc>,
  macKeyVal: <Buffer 98 65 e7 c1 f2 89 d8 ba 27 07 38 6b 4d 6a 6a 9b b1 1b fb 45 4b 7e 5e 7e 2f 33 c5 ca f6 2d dd ac>,
  absValidity: 2018-03-21T21:35:26.445Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100598,
     cipherKeyVal: <Buffer 0b 54 58 0d 39 47 e9 15 ee 30 b4 b7 a8 98 2a dc>,
     macKeyVal: <Buffer 98 65 e7 c1 f2 89 d8 ba 27 07 38 6b 4d 6a 6a 9b b1 1b fb 45 4b 7e 5e 7e 2f 33 c5 ca f6 2d dd ac>,
     absValidity: 2018-03-21T21:35:26.445Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 7a 5f a4 d4 fa 8c 81 10>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 21:35:27 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521581727413
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521581786325
connected to auth! from local port 38358
received auth hello!
{ authId: 501, nonce: <Buffer 7a 46 64 49 65 c7 74 54> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5a 09 a3 ac fd 6b 8f 64>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100606,
  cipherKeyVal: <Buffer 8c ac c5 4e eb 68 d7 86 de d8 31 6c 0a a6 81 af>,
  macKeyVal: <Buffer f2 58 5c 34 97 37 d8 da 20 54 f3 15 ce 3d b9 eb 1e e3 b0 6d 58 fb f6 20 c5 07 ac bf 7f c8 b0 c1>,
  absValidity: 2018-03-21T21:36:26.475Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100606,
     cipherKeyVal: <Buffer 8c ac c5 4e eb 68 d7 86 de d8 31 6c 0a a6 81 af>,
     macKeyVal: <Buffer f2 58 5c 34 97 37 d8 da 20 54 f3 15 ce 3d b9 eb 1e e3 b0 6d 58 fb f6 20 c5 07 ac bf 7f c8 b0 c1>,
     absValidity: 2018-03-21T21:36:26.475Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 1b 48 0f 14 64 23 a1 0e>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 21:36:27 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521581787337
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521581846385
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 9 0.7777777777777778 1521581906385
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 59710
received auth hello!
{ authId: 401, nonce: <Buffer 68 d4 87 e4 21 66 f8 bf> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 10 0.7 1521581966395
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 59920
received auth hello!
{ authId: 401, nonce: <Buffer 42 75 44 55 73 45 2e 77> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 11 0.6363636363636364 1521582026406
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 12 0.5833333333333334 1521582086414
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 49872
received auth hello!
{ authId: 502, nonce: <Buffer d9 a0 32 3e e2 19 20 59> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '0162454FC332',
  notBefore: 2018-03-20T21:26:18.000Z,
  notAfter: 2018-03-21T21:27:58.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '6F:38:43:BC:D5:F1:13:C9:CD:90:C8:0E:87:9C:0A:B9:32:A6:32:49',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'E40B9EF20959AA49D02016EC2E9896074EE0818689EAD7319ECC8ED8C9557412ED46C95E67464598F6233ECEB8BF25A876F0D30B65CED2B1FED8D1F07CF9042FD7F86E3B637BE17FBFD7C9F0DB5850835170B354A52C175B769A37BA578F965436FF29BCFD54C5D4E939E02214503C8A69FFBBF0EC06657DF9498BE98DEB26B62E1453817F6DFAE9B50EE21C5A643FF0292539838A682562303CB77FC6028B22B30B78957E4F78E539103F991928681EBF3100D31960F43F8ECFC6C2F3063B353E92BFFEF77A49BBCBF417864AE8169AA061F590E5FB3393A4592EFA1100FC186B95B83724CA0B11D8BC02BC9BD4F9E08552DE2D1EB0EE0E866E41A520730E6F',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJFT8MyMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDMy\nMDIxMjYxOFoXDTE4MDMyMTIxMjc1OFowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDkC57yCVmqSdAgFuwumJYHTuCBhonq1zGezI7YyVV0Eu1GyV5n\nRkWY9iM+zri/Jah28NMLZc7Ssf7Y0fB8+QQv1/huO2N74X+/18nw21hQg1Fws1Sl\nLBdbdpo3ulePllQ2/ym8/VTF1Ok54CIUUDyKaf+78OwGZX35SYvpjesmti4UU4F/\nbfrptQ7iHFpkP/ApJTmDimglYjA8t3/GAosiswt4lX5PeOU5ED+ZGShoHr8xANMZ\nYPQ/js/GwvMGOzU+kr/+93pJu8v0F4ZK6BaaoGH1kOX7M5OkWS76EQD8GGuVuDck\nygsR2LwCvJvU+eCFUt4tHrDuDoZuQaUgcw5vAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAI4Fqq14qkynqQF4x8rvl6Aa72v4cuva\nj124l6jPCLm2Pdc3CEIgQMwLWIY5wXnZuQqRBMrHPmNmVCqEm72idk2/NXbhf54S\nefWH/9FWM8D9LJF5accBM2VvQngbc+lNl64wy9KoPiJjbxyzusmwEyTY/+pDU8r2\nUHEhcwyzMXoFDrep2JuGQ1QleBQgulS4ifavE8PuE1gXVLO1tuM4OfXqv9ceKHiv\ndiTyfiXQNS1ljy9U5IinZk4JQKUekXHA8y6GxDAuIab9Kj+cbHWARJn2yJo3kI66\nxLVVjricwUpyO2jNNHaQPGo5G+v5Ctw+nxcswZWdBcUDkMczo3peYkI=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 2
to: 3
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 13 0.5384615384615384 1521582146421
connected to auth! from local port 50094
received auth hello!
{ authId: 502, nonce: <Buffer da a0 b3 1c 17 6c 63 67> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 8f 84 80 3b 3a 81 91 0b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 50 bb f4 41 35 d3 11 8a ee 82 96 f9 de 93 4c 15>,
  macKeyVal: <Buffer bd cb 1d a9 99 2f 02 1f ba fa 0a 96 f6 db 03 5e d0 5c 97 bf e8 df 94 4c 6c 4b c8 4a 8a 8a b9 6c>,
  absValidity: 2018-03-20T22:42:26.607Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201095,
  cipherKeyVal: <Buffer 81 bf 2e 44 0a f5 8d 53 ea f6 96 f6 08 f3 5a 0c>,
  macKeyVal: <Buffer 46 09 d9 f1 fe 08 96 8a cb 26 15 9e 6f e0 11 76 7d 86 1f d6 00 42 69 a6 2d 89 83 b8 0b 39 2a 6c>,
  absValidity: 2018-03-21T21:42:26.607Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50201095,
     cipherKeyVal: <Buffer 81 bf 2e 44 0a f5 8d 53 ea f6 96 f6 08 f3 5a 0c>,
     macKeyVal: <Buffer 46 09 d9 f1 fe 08 96 8a cb 26 15 9e 6f e0 11 76 7d 86 1f d6 00 42 69 a6 2d 89 83 b8 0b 39 2a 6c>,
     absValidity: 2018-03-21T21:42:26.607Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer d7 63 02 8e cd 8d 5d 3a>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.28:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 14 0.5 1521582206431
connected to auth! from local port 50328
received auth hello!
{ authId: 502, nonce: <Buffer 31 27 04 44 d1 94 c2 94> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 09 f0 e5 dc 58 d4 79 08>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201113,
  cipherKeyVal: <Buffer 54 0c 94 3b 82 c0 78 ad f0 63 55 93 ae ed fa a0>,
  macKeyVal: <Buffer a3 8e bd a8 d8 3c dd ba 36 ec 29 8b f6 90 5e 4d 6c a9 3b 32 5a 82 d7 75 4b ee d9 e9 21 40 a8 f3>,
  absValidity: 2018-03-21T21:43:29.367Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50201113,
     cipherKeyVal: <Buffer 54 0c 94 3b 82 c0 78 ad f0 63 55 93 ae ed fa a0>,
     macKeyVal: <Buffer a3 8e bd a8 d8 3c dd ba 36 ec 29 8b f6 90 5e 4d 6c a9 3b 32 5a 82 d7 75 4b ee d9 e9 21 40 a8 f3>,
     absValidity: 2018-03-21T21:43:29.367Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 6b 72 db f3 3b 5d 00 b1>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.28:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 15 0.4666666666666667 1521582266438
connected to auth! from local port 50580
received auth hello!
{ authId: 502, nonce: <Buffer 98 2b fe 45 d4 37 e2 c7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cb ff 6c 29 74 22 be 20>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201132,
  cipherKeyVal: <Buffer 34 79 21 0a 80 92 ee c1 92 ae b1 3c 12 96 dc cd>,
  macKeyVal: <Buffer ff 6d b8 5e 22 84 26 93 23 0b 2f d3 61 5b ee 0b 95 9a e2 9c 84 f2 e7 43 ad 05 a4 22 89 77 01 4a>,
  absValidity: 2018-03-21T21:44:29.336Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50201132,
     cipherKeyVal: <Buffer 34 79 21 0a 80 92 ee c1 92 ae b1 3c 12 96 dc cd>,
     macKeyVal: <Buffer ff 6d b8 5e 22 84 26 93 23 0b 2f d3 61 5b ee 0b 95 9a e2 9c 84 f2 e7 43 ad 05 a4 22 89 77 01 4a>,
     absValidity: 2018-03-21T21:44:29.336Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer fd 7a 07 a3 f0 bf 65 65>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.28:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 16 0.4375 1521582326446
connected to auth! from local port 50796
received auth hello!
{ authId: 502, nonce: <Buffer e0 21 6b 6d e3 77 67 af> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6b f8 2c c4 15 7b e9 01>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201147,
  cipherKeyVal: <Buffer fc f5 69 f3 68 35 3b 1d b9 df 31 48 fa 17 cd 46>,
  macKeyVal: <Buffer 52 4e 3b 15 20 35 24 4b 0c b6 55 b9 6b 3a ce a1 22 b2 01 2a 39 37 a9 2c 49 15 af c6 4c ed 65 12>,
  absValidity: 2018-03-21T21:45:30.327Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50201147,
     cipherKeyVal: <Buffer fc f5 69 f3 68 35 3b 1d b9 df 31 48 fa 17 cd 46>,
     macKeyVal: <Buffer 52 4e 3b 15 20 35 24 4b 0c b6 55 b9 6b 3a ce a1 22 b2 01 2a 39 37 a9 2c 49 15 af c6 4c ed 65 12>,
     absValidity: 2018-03-21T21:45:30.327Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 03 3f 2f cf 88 11 d0 35>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.28:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 17 0.4117647058823529 1521582386453
connected to auth! from local port 51032
received auth hello!
{ authId: 502, nonce: <Buffer c9 61 c8 da 90 df 83 4f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 20 c0 2d 56 ef 4c 3d b3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201160,
  cipherKeyVal: <Buffer 32 6f cb 72 c1 42 1c 34 45 9d 80 d4 e0 d2 a8 cb>,
  macKeyVal: <Buffer 3f 47 a6 eb 3f 1f f6 f2 82 ac ea 92 8c 80 e2 e9 59 26 f8 e1 21 98 cc ff d6 02 7e 56 56 59 c5 94>,
  absValidity: 2018-03-21T21:46:30.344Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50201160,
     cipherKeyVal: <Buffer 32 6f cb 72 c1 42 1c 34 45 9d 80 d4 e0 d2 a8 cb>,
     macKeyVal: <Buffer 3f 47 a6 eb 3f 1f f6 f2 82 ac ea 92 8c 80 e2 e9 59 26 f8 e1 21 98 cc ff d6 02 7e 56 56 59 c5 94>,
     absValidity: 2018-03-21T21:46:30.344Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer ca 16 7f 2f 4d 54 21 13>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.28:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 18 0.3888888888888889 1521582446459
connected to auth! from local port 51256
received auth hello!
{ authId: 502, nonce: <Buffer 28 c3 2b b6 85 6c 49 cb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 48 fa 95 eb 77 89 4e d6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201178,
  cipherKeyVal: <Buffer a5 bc b4 2d 2e d0 f5 4a 94 ae 0d 7a c4 79 34 af>,
  macKeyVal: <Buffer 8e a7 ba 03 79 1e 3d 3f 5c e8 2d cc 78 2e cf 61 d1 22 2e 62 17 10 cb 22 fc 20 29 68 4d 01 73 2c>,
  absValidity: 2018-03-21T21:47:30.363Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50201178,
     cipherKeyVal: <Buffer a5 bc b4 2d 2e d0 f5 4a 94 ae 0d 7a c4 79 34 af>,
     macKeyVal: <Buffer 8e a7 ba 03 79 1e 3d 3f 5c e8 2d cc 78 2e cf 61 d1 22 2e 62 17 10 cb 22 fc 20 29 68 4d 01 73 2c>,
     absValidity: 2018-03-21T21:47:30.363Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 19 0.3684210526315789 1521582506508
connected to auth! from local port 51440
received auth hello!
{ authId: 502, nonce: <Buffer ba 84 6d 95 37 f5 87 60> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ce f2 f3 e1 b4 7e 85 22>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201193,
  cipherKeyVal: <Buffer ff 16 68 cb 3e 9c 48 22 ed 01 98 13 d2 89 1a 47>,
  macKeyVal: <Buffer 74 a5 15 a0 a8 32 0d c7 a2 96 59 28 09 a2 9e a1 86 67 3a 2d f3 4a c2 f0 14 fb d6 59 62 63 18 36>,
  absValidity: 2018-03-21T21:48:30.385Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50201193,
     cipherKeyVal: <Buffer ff 16 68 cb 3e 9c 48 22 ed 01 98 13 d2 89 1a 47>,
     macKeyVal: <Buffer 74 a5 15 a0 a8 32 0d c7 a2 96 59 28 09 a2 9e a1 86 67 3a 2d f3 4a c2 f0 14 fb d6 59 62 63 18 36>,
     absValidity: 2018-03-21T21:48:30.385Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 20 0.35 1521582566564
connected to auth! from local port 51624
received auth hello!
{ authId: 502, nonce: <Buffer cb 69 98 88 eb 4a c0 e4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 97 ff 4b 1c 63 2a 61 6c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201213,
  cipherKeyVal: <Buffer 9e 3d 65 9d c3 82 eb ac 31 04 28 e2 e0 8c 07 5b>,
  macKeyVal: <Buffer 7a b6 9b 8e 43 68 fe ea fa da 2d a3 5e be 65 d9 ad 0d ee 7a bd 4e 69 43 dd 0c be c9 20 60 88 9e>,
  absValidity: 2018-03-21T21:49:42.340Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50201213,
     cipherKeyVal: <Buffer 9e 3d 65 9d c3 82 eb ac 31 04 28 e2 e0 8c 07 5b>,
     macKeyVal: <Buffer 7a b6 9b 8e 43 68 fe ea fa da 2d a3 5e be 65 d9 ad 0d ee 7a bd 4e 69 43 dd 0c be c9 20 60 88 9e>,
     absValidity: 2018-03-21T21:49:42.340Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 21 0.3333333333333333 1521582626608
connected to auth! from local port 51806
received auth hello!
{ authId: 502, nonce: <Buffer 4f 1e 53 dc 3e 21 11 78> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4b db ce 4d aa 40 43 bf>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201227,
  cipherKeyVal: <Buffer 1a 18 47 0d b7 8a 2b 32 5c 05 8e d0 77 d7 9c f0>,
  macKeyVal: <Buffer 30 83 ea 30 54 d3 c5 ba 2d 26 11 cd 7b 23 49 3b 2a d2 f8 82 77 70 8a ee dc b5 70 75 75 61 27 f5>,
  absValidity: 2018-03-21T21:50:30.335Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50201227,
     cipherKeyVal: <Buffer 1a 18 47 0d b7 8a 2b 32 5c 05 8e d0 77 d7 9c f0>,
     macKeyVal: <Buffer 30 83 ea 30 54 d3 c5 ba 2d 26 11 cd 7b 23 49 3b 2a d2 f8 82 77 70 8a ee dc b5 70 75 75 61 27 f5>,
     absValidity: 2018-03-21T21:50:30.335Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 22 0.3181818181818182 1521582686650
connected to auth! from local port 51978
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 23 0.30434782608695654 1521582746662
connected to auth! from local port 52144
received auth hello!
{ authId: 502, nonce: <Buffer 0f 03 ba dc e6 f0 3f 1c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6c c0 2d f6 bf 12 18 74>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201259,
  cipherKeyVal: <Buffer e6 a8 8f 46 94 83 8f 74 7a fd ae eb 21 c3 fd 3c>,
  macKeyVal: <Buffer 43 45 ee 61 0b 03 e0 02 31 52 e3 08 4d 0a d1 f7 00 0f 5e ac bb 31 a1 ec 52 ed 03 ba c3 cb 0d 67>,
  absValidity: 2018-03-21T21:52:30.588Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50201259,
     cipherKeyVal: <Buffer e6 a8 8f 46 94 83 8f 74 7a fd ae eb 21 c3 fd 3c>,
     macKeyVal: <Buffer 43 45 ee 61 0b 03 e0 02 31 52 e3 08 4d 0a d1 f7 00 0f 5e ac bb 31 a1 ec 52 ed 03 ba c3 cb 0d 67>,
     absValidity: 2018-03-21T21:52:30.588Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 24 0.2916666666666667 1521582806679
connected to auth! from local port 52322
received auth hello!
{ authId: 502, nonce: <Buffer 4f 5a 68 9c 0b 5b 9d 68> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6d a6 08 23 43 cd 67 3e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201273,
  cipherKeyVal: <Buffer 17 e1 e7 30 0b 21 0b e8 1e f5 5e 37 6f 10 6c a3>,
  macKeyVal: <Buffer 24 f1 e4 2d 74 db 66 35 bc 1a 1b 65 43 62 81 ac c3 f0 3e f6 6f ad 2a 5c d5 49 9a ed 05 4b 67 ea>,
  absValidity: 2018-03-21T21:53:30.551Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50201273,
     cipherKeyVal: <Buffer 17 e1 e7 30 0b 21 0b e8 1e f5 5e 37 6f 10 6c a3>,
     macKeyVal: <Buffer 24 f1 e4 2d 74 db 66 35 bc 1a 1b 65 43 62 81 ac c3 f0 3e f6 6f ad 2a 5c d5 49 9a ed 05 4b 67 ea>,
     absValidity: 2018-03-21T21:53:30.551Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 25 0.28 1521582866735
connected to auth! from local port 52500
received auth hello!
{ authId: 502, nonce: <Buffer a0 8d 0a 03 d7 88 93 ac> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer aa 27 b7 a8 8b 93 94 63>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201289,
  cipherKeyVal: <Buffer 23 82 b1 db 69 03 23 04 22 81 92 28 0d 1f d9 48>,
  macKeyVal: <Buffer 7e c1 b7 32 a0 ca cb 4b 57 14 93 b3 2d 00 56 84 58 f9 2d 4e 13 67 35 06 fa 7a 9b a4 06 6c 84 2e>,
  absValidity: 2018-03-21T21:54:30.581Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50201289,
     cipherKeyVal: <Buffer 23 82 b1 db 69 03 23 04 22 81 92 28 0d 1f d9 48>,
     macKeyVal: <Buffer 7e c1 b7 32 a0 ca cb 4b 57 14 93 b3 2d 00 56 84 58 f9 2d 4e 13 67 35 06 fa 7a 9b a4 06 6c 84 2e>,
     absValidity: 2018-03-21T21:54:30.581Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 26 0.2692307692307692 1521582926792
connected to auth! from local port 52666
received auth hello!
{ authId: 502, nonce: <Buffer ba aa ee ba dd c6 f5 b3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ce 7e 31 bf d8 f5 2c 07>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201305,
  cipherKeyVal: <Buffer 8d d7 e7 f3 d8 21 f8 f2 35 84 eb 34 d6 f5 6d fd>,
  macKeyVal: <Buffer 9b 73 bd 96 8b fc 36 9a b1 68 ca 27 2c 09 4e 28 c5 7b 38 7b 80 d6 36 e2 24 66 c3 9e b9 50 f7 0c>,
  absValidity: 2018-03-21T21:55:30.726Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50201305,
     cipherKeyVal: <Buffer 8d d7 e7 f3 d8 21 f8 f2 35 84 eb 34 d6 f5 6d fd>,
     macKeyVal: <Buffer 9b 73 bd 96 8b fc 36 9a b1 68 ca 27 2c 09 4e 28 c5 7b 38 7b 80 d6 36 e2 24 66 c3 9e b9 50 f7 0c>,
     absValidity: 2018-03-21T21:55:30.726Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 27 0.25925925925925924 1521582986793
connected to auth! from local port 52840
received auth hello!
{ authId: 502, nonce: <Buffer 0c cd 5f 34 ca f7 c3 e3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7d 34 56 18 e6 e9 85 48>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201318,
  cipherKeyVal: <Buffer 4a 45 84 4d 20 fc a1 54 cb fb 97 dc 59 6b 75 97>,
  macKeyVal: <Buffer 61 62 b3 e0 d1 04 d8 32 e6 dc 56 c2 0d d9 58 c5 da fc 8c 42 f3 27 19 c0 2e 9b 5d 15 1c 1e 25 d1>,
  absValidity: 2018-03-21T21:56:30.662Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50201318,
     cipherKeyVal: <Buffer 4a 45 84 4d 20 fc a1 54 cb fb 97 dc 59 6b 75 97>,
     macKeyVal: <Buffer 61 62 b3 e0 d1 04 d8 32 e6 dc 56 c2 0d d9 58 c5 da fc 8c 42 f3 27 19 c0 2e 9b 5d 15 1c 1e 25 d1>,
     absValidity: 2018-03-21T21:56:30.662Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 28 0.25 1521583046794
connected to auth! from local port 53016
received auth hello!
{ authId: 502, nonce: <Buffer 48 7b 13 4d 10 7d e1 04> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 41 0b d7 c6 6e 00 5c 0e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201337,
  cipherKeyVal: <Buffer 96 d0 31 d0 f1 11 85 f1 4f 1e 2e 6f 17 55 a1 42>,
  macKeyVal: <Buffer 8a c9 a9 22 68 d1 b9 9a 34 79 c2 ac a9 a0 b9 c9 37 bb c8 b8 76 9b 38 07 2e 2b a9 ec cd f1 e6 c6>,
  absValidity: 2018-03-21T21:57:42.617Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50201337,
     cipherKeyVal: <Buffer 96 d0 31 d0 f1 11 85 f1 4f 1e 2e 6f 17 55 a1 42>,
     macKeyVal: <Buffer 8a c9 a9 22 68 d1 b9 9a 34 79 c2 ac a9 a0 b9 c9 37 bb c8 b8 76 9b 38 07 2e 2b a9 ec cd f1 e6 c6>,
     absValidity: 2018-03-21T21:57:42.617Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
