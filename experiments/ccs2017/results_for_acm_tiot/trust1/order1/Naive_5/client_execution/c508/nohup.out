changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c508.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c508',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 76 6a ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521581429337
connected to auth! from local port 40092
received auth hello!
{ authId: 501, nonce: <Buffer 8f 9e cd 0e e2 3d a3 88> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 6b a8 da f6 21 eb 94 0e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer c7 4e 91 0e b4 84 2c 3a 9e 63 4c c4 18 9c be c9>,
  macKeyVal: <Buffer f3 95 0b 73 8d b0 9d e9 f3 75 0f da 66 49 46 75 b9 29 26 25 36 df e8 b2 2e 1e 64 05 10 3b 9c 96>,
  absValidity: 2018-03-20T22:30:29.490Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100559,
  cipherKeyVal: <Buffer eb 97 d3 5f ac 02 a7 d3 50 df 19 92 33 eb bb 6c>,
  macKeyVal: <Buffer 79 65 f1 6b a6 1e e5 5e 9d d3 42 8a 01 4a 37 bf bf c0 21 08 0d e9 8b d8 6c f5 3e 0d d9 f4 dc 55>,
  absValidity: 2018-03-21T21:30:29.490Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100559,
     cipherKeyVal: <Buffer eb 97 d3 5f ac 02 a7 d3 50 df 19 92 33 eb bb 6c>,
     macKeyVal: <Buffer 79 65 f1 6b a6 1e e5 5e 9d d3 42 8a 01 4a 37 bf bf c0 21 08 0d e9 8b d8 6c f5 3e 0d d9 f4 dc 55>,
     absValidity: 2018-03-21T21:30:29.490Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 15 58 ba 55 3e c9 ac e1>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 21:30:30 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521581430392
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521581489394
connected to auth! from local port 40358
received auth hello!
{ authId: 501, nonce: <Buffer 74 ee c4 2a 64 da 94 70> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2f 44 36 41 aa 8d f4 56>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100567,
  cipherKeyVal: <Buffer 08 46 cd 72 73 d5 9e a9 c3 82 45 8b 3f 28 41 dc>,
  macKeyVal: <Buffer 32 26 10 36 e3 47 da 78 90 64 9d 4d 25 bd 16 ee 10 5f 38 98 cb 0f b8 98 cb 79 76 9b fb 7e d0 ec>,
  absValidity: 2018-03-21T21:31:29.566Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100567,
     cipherKeyVal: <Buffer 08 46 cd 72 73 d5 9e a9 c3 82 45 8b 3f 28 41 dc>,
     macKeyVal: <Buffer 32 26 10 36 e3 47 da 78 90 64 9d 4d 25 bd 16 ee 10 5f 38 98 cb 0f b8 98 cb 79 76 9b fb 7e d0 ec>,
     absValidity: 2018-03-21T21:31:29.566Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 9e 3c 98 ad 9f e3 70 38>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 21:31:30 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521581490919
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521581549453
connected to auth! from local port 40624
received auth hello!
{ authId: 501, nonce: <Buffer fe d5 1d f8 73 99 61 27> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cd 19 04 0d 0d c4 d2 1d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100575,
  cipherKeyVal: <Buffer 6c db ad b9 8a d4 9b 91 f6 4f 87 f7 4a 93 81 17>,
  macKeyVal: <Buffer 89 9a 91 b9 73 8f 8b 04 33 7d 53 1c 9e 71 6a 26 3e df 6d 3e 26 86 84 83 54 21 51 eb f0 f6 b1 7a>,
  absValidity: 2018-03-21T21:32:29.605Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100575,
     cipherKeyVal: <Buffer 6c db ad b9 8a d4 9b 91 f6 4f 87 f7 4a 93 81 17>,
     macKeyVal: <Buffer 89 9a 91 b9 73 8f 8b 04 33 7d 53 1c 9e 71 6a 26 3e df 6d 3e 26 86 84 83 54 21 51 eb f0 f6 b1 7a>,
     absValidity: 2018-03-21T21:32:29.605Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 79 3b ac 2e 34 5c 6f 90>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 21:32:30 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521581551363
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521581609512
connected to auth! from local port 40898
received auth hello!
{ authId: 501, nonce: <Buffer 7d b8 d1 54 c8 b2 ac ee> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d8 22 f2 13 47 81 ef 28>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100583,
  cipherKeyVal: <Buffer 4c ed 48 5c 79 99 86 1d 99 e5 e6 14 ad 19 a8 5c>,
  macKeyVal: <Buffer ea 75 97 cc 8e 50 60 74 27 a2 1d 4c e1 cd 74 12 02 3f ee 7c 29 b0 97 9a cc 9e 17 e6 2a b9 c8 0c>,
  absValidity: 2018-03-21T21:33:29.666Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100583,
     cipherKeyVal: <Buffer 4c ed 48 5c 79 99 86 1d 99 e5 e6 14 ad 19 a8 5c>,
     macKeyVal: <Buffer ea 75 97 cc 8e 50 60 74 27 a2 1d 4c e1 cd 74 12 02 3f ee 7c 29 b0 97 9a cc 9e 17 e6 2a b9 c8 0c>,
     absValidity: 2018-03-21T21:33:29.666Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 26 a0 a5 4e a8 ee c7 fe>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 21:33:30 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521581610860
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521581669564
connected to auth! from local port 41168
received auth hello!
{ authId: 501, nonce: <Buffer e5 af c1 a9 f1 97 fe 43> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 23 19 a3 e0 e6 a0 06 7e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100591,
  cipherKeyVal: <Buffer 49 54 12 35 89 91 ae f5 59 ab 5c ef 13 b9 99 9e>,
  macKeyVal: <Buffer 9c 42 89 e4 95 95 a4 06 c4 bd 7c a6 a9 9c e3 67 e8 b5 82 e9 22 a8 f0 de 59 56 11 e2 aa 4d 99 47>,
  absValidity: 2018-03-21T21:34:29.741Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100591,
     cipherKeyVal: <Buffer 49 54 12 35 89 91 ae f5 59 ab 5c ef 13 b9 99 9e>,
     macKeyVal: <Buffer 9c 42 89 e4 95 95 a4 06 c4 bd 7c a6 a9 9c e3 67 e8 b5 82 e9 22 a8 f0 de 59 56 11 e2 aa 4d 99 47>,
     absValidity: 2018-03-21T21:34:29.741Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer c7 d2 6e 32 bc ca 3d 76>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 21:34:30 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521581670658
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521581729589
connected to auth! from local port 41434
received auth hello!
{ authId: 501, nonce: <Buffer 24 52 37 46 2d 72 9b 45> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 48 44 d6 b4 ee be 67 5e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100599,
  cipherKeyVal: <Buffer c6 9e 7f ea d3 3e 29 e7 2e 5a 7a 8e 9d f5 8c 99>,
  macKeyVal: <Buffer 17 0c bf ee f1 17 49 37 f4 54 fd 11 51 04 a1 f3 43 ae f5 cd 7c 52 d7 3e f0 02 8d f5 c1 76 76 33>,
  absValidity: 2018-03-21T21:35:29.744Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100599,
     cipherKeyVal: <Buffer c6 9e 7f ea d3 3e 29 e7 2e 5a 7a 8e 9d f5 8c 99>,
     macKeyVal: <Buffer 17 0c bf ee f1 17 49 37 f4 54 fd 11 51 04 a1 f3 43 ae f5 cd 7c 52 d7 3e f0 02 8d f5 c1 76 76 33>,
     absValidity: 2018-03-21T21:35:29.744Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 2a 09 54 22 89 c3 23 46>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 21:35:30 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521581731295
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521581789642
connected to auth! from local port 41708
received auth hello!
{ authId: 501, nonce: <Buffer 40 a1 43 23 25 e1 3e 65> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1b dc 0a 11 2d 3d d3 39>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100607,
  cipherKeyVal: <Buffer 12 4f 6b c5 dc 82 63 4e 16 d7 20 11 89 17 47 dc>,
  macKeyVal: <Buffer d6 44 ba 67 23 97 20 d6 eb 41 70 60 ad 7a f9 d6 e8 17 b3 ce ab 52 d2 e5 ff 86 49 9a 5a 1b 6c 6e>,
  absValidity: 2018-03-21T21:36:29.789Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100607,
     cipherKeyVal: <Buffer 12 4f 6b c5 dc 82 63 4e 16 d7 20 11 89 17 47 dc>,
     macKeyVal: <Buffer d6 44 ba 67 23 97 20 d6 eb 41 70 60 ad 7a f9 d6 e8 17 b3 ce ab 52 d2 e5 ff 86 49 9a 5a 1b 6c 6e>,
     absValidity: 2018-03-21T21:36:29.789Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 25 8f 72 f4 1b 54 bf f2>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 21:36:30 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521581790795
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521581849702
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 9 0.7777777777777778 1521581909712
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 43902
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 10 0.7 1521581969720
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 44112
received auth hello!
{ authId: 401, nonce: <Buffer 64 2a c4 36 ed 50 62 c8> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 11 0.6363636363636364 1521582029727
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 12 0.5833333333333334 1521582089734
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 47384
received auth hello!
{ authId: 502, nonce: <Buffer 2a 8a 22 a1 c9 d3 47 e5> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '0162454FC332',
  notBefore: 2018-03-20T21:26:18.000Z,
  notAfter: 2018-03-21T21:27:58.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '6F:38:43:BC:D5:F1:13:C9:CD:90:C8:0E:87:9C:0A:B9:32:A6:32:49',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'E40B9EF20959AA49D02016EC2E9896074EE0818689EAD7319ECC8ED8C9557412ED46C95E67464598F6233ECEB8BF25A876F0D30B65CED2B1FED8D1F07CF9042FD7F86E3B637BE17FBFD7C9F0DB5850835170B354A52C175B769A37BA578F965436FF29BCFD54C5D4E939E02214503C8A69FFBBF0EC06657DF9498BE98DEB26B62E1453817F6DFAE9B50EE21C5A643FF0292539838A682562303CB77FC6028B22B30B78957E4F78E539103F991928681EBF3100D31960F43F8ECFC6C2F3063B353E92BFFEF77A49BBCBF417864AE8169AA061F590E5FB3393A4592EFA1100FC186B95B83724CA0B11D8BC02BC9BD4F9E08552DE2D1EB0EE0E866E41A520730E6F',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJFT8MyMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDMy\nMDIxMjYxOFoXDTE4MDMyMTIxMjc1OFowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDkC57yCVmqSdAgFuwumJYHTuCBhonq1zGezI7YyVV0Eu1GyV5n\nRkWY9iM+zri/Jah28NMLZc7Ssf7Y0fB8+QQv1/huO2N74X+/18nw21hQg1Fws1Sl\nLBdbdpo3ulePllQ2/ym8/VTF1Ok54CIUUDyKaf+78OwGZX35SYvpjesmti4UU4F/\nbfrptQ7iHFpkP/ApJTmDimglYjA8t3/GAosiswt4lX5PeOU5ED+ZGShoHr8xANMZ\nYPQ/js/GwvMGOzU+kr/+93pJu8v0F4ZK6BaaoGH1kOX7M5OkWS76EQD8GGuVuDck\nygsR2LwCvJvU+eCFUt4tHrDuDoZuQaUgcw5vAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAI4Fqq14qkynqQF4x8rvl6Aa72v4cuva\nj124l6jPCLm2Pdc3CEIgQMwLWIY5wXnZuQqRBMrHPmNmVCqEm72idk2/NXbhf54S\nefWH/9FWM8D9LJF5accBM2VvQngbc+lNl64wy9KoPiJjbxyzusmwEyTY/+pDU8r2\nUHEhcwyzMXoFDrep2JuGQ1QleBQgulS4ifavE8PuE1gXVLO1tuM4OfXqv9ceKHiv\ndiTyfiXQNS1ljy9U5IinZk4JQKUekXHA8y6GxDAuIab9Kj+cbHWARJn2yJo3kI66\nxLVVjricwUpyO2jNNHaQPGo5G+v5Ctw+nxcswZWdBcUDkMczo3peYkI=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 2
to: 3
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 13 0.5384615384615384 1521582149744
connected to auth! from local port 47608
received auth hello!
{ authId: 502, nonce: <Buffer 4b de 1a 2a c4 ae 5c 50> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 41 a1 f6 86 0b f2 bf 17>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 5a a5 cd 42 3e 91 c5 c8 fc 78 10 b7 ed 94 fd 76>,
  macKeyVal: <Buffer aa db d0 19 d3 e9 2c 06 70 1b 8e 03 ee ac 85 e1 09 9f 9e a3 ac c7 2e 95 02 d3 63 30 3b fc 10 a0>,
  absValidity: 2018-03-20T22:42:29.989Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201096,
  cipherKeyVal: <Buffer dc d8 25 21 df 6d cf 78 28 ae 1a 5d 45 a3 6d 40>,
  macKeyVal: <Buffer cd 80 82 fd 5f 67 2f 97 52 28 22 52 ba 2f 45 3b 7b 03 fb 4e c0 88 04 f2 6e aa 7b e2 e6 26 63 77>,
  absValidity: 2018-03-21T21:42:29.989Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50201096,
     cipherKeyVal: <Buffer dc d8 25 21 df 6d cf 78 28 ae 1a 5d 45 a3 6d 40>,
     macKeyVal: <Buffer cd 80 82 fd 5f 67 2f 97 52 28 22 52 ba 2f 45 3b 7b 03 fb 4e c0 88 04 f2 6e aa 7b e2 e6 26 63 77>,
     absValidity: 2018-03-21T21:42:29.989Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer eb 43 28 3c 6b 64 c3 ec>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.28:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 14 0.5 1521582209753
connected to auth! from local port 47852
received auth hello!
{ authId: 502, nonce: <Buffer 4d 5c 84 9b d1 ba be 33> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6e f5 da ed 6d 08 9a d0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201114,
  cipherKeyVal: <Buffer fa d7 53 7b be 48 49 ac 56 54 3f f6 28 9f 73 30>,
  macKeyVal: <Buffer c6 cb 75 b2 a4 2b 9c cb db 3f 1e e6 e3 0f 69 49 82 2a 30 39 82 95 d0 ed 36 5f 52 14 c3 5f 55 de>,
  absValidity: 2018-03-21T21:43:31.376Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50201114,
     cipherKeyVal: <Buffer fa d7 53 7b be 48 49 ac 56 54 3f f6 28 9f 73 30>,
     macKeyVal: <Buffer c6 cb 75 b2 a4 2b 9c cb db 3f 1e e6 e3 0f 69 49 82 2a 30 39 82 95 d0 ed 36 5f 52 14 c3 5f 55 de>,
     absValidity: 2018-03-21T21:43:31.376Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 08 84 76 00 56 04 2f a6>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.28:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 15 0.4666666666666667 1521582269763
connected to auth! from local port 48098
received auth hello!
{ authId: 502, nonce: <Buffer 4f c4 8e 89 35 f7 13 ed> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d3 b2 4a c4 d5 c4 4d ff>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201133,
  cipherKeyVal: <Buffer 50 cc a3 f5 9a ba 06 26 61 80 26 da dc 71 1f ae>,
  macKeyVal: <Buffer 28 d5 db 2d 69 1b 9f 15 75 69 54 8a eb 74 49 49 18 e4 25 7c 87 7c 29 80 94 b8 26 9f 5f b2 88 8d>,
  absValidity: 2018-03-21T21:44:31.310Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50201133,
     cipherKeyVal: <Buffer 50 cc a3 f5 9a ba 06 26 61 80 26 da dc 71 1f ae>,
     macKeyVal: <Buffer 28 d5 db 2d 69 1b 9f 15 75 69 54 8a eb 74 49 49 18 e4 25 7c 87 7c 29 80 94 b8 26 9f 5f b2 88 8d>,
     absValidity: 2018-03-21T21:44:31.310Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer c9 23 f3 d2 58 1b db 5f>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.28:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 16 0.4375 1521582329771
connected to auth! from local port 48314
received auth hello!
{ authId: 502, nonce: <Buffer 85 4d ac d8 d1 03 e5 bf> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a6 de e2 ff cb 81 80 19>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201149,
  cipherKeyVal: <Buffer 52 f1 93 f6 41 cd b4 7b 9e 82 62 07 49 73 2c f3>,
  macKeyVal: <Buffer 23 be 18 06 5a 28 54 97 fb dc a7 d7 bf 39 79 54 c4 86 f7 32 84 af 17 c0 d1 3d e1 b0 79 8e c5 87>,
  absValidity: 2018-03-21T21:45:33.578Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50201149,
     cipherKeyVal: <Buffer 52 f1 93 f6 41 cd b4 7b 9e 82 62 07 49 73 2c f3>,
     macKeyVal: <Buffer 23 be 18 06 5a 28 54 97 fb dc a7 d7 bf 39 79 54 c4 86 f7 32 84 af 17 c0 d1 3d e1 b0 79 8e c5 87>,
     absValidity: 2018-03-21T21:45:33.578Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 32 3b 43 2c c8 80 cf fb>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.28:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 17 0.4117647058823529 1521582389778
connected to auth! from local port 48544
received auth hello!
{ authId: 502, nonce: <Buffer 04 4f df 02 87 55 60 ef> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 54 2c 12 8e 93 d3 65 db>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201161,
  cipherKeyVal: <Buffer d8 7b 75 3f 3b 24 9e 05 96 63 74 5b a4 77 cc 75>,
  macKeyVal: <Buffer 6f 5b ec 97 78 a5 39 94 c0 1f 0b 66 58 5f 2d bf 52 d7 08 1b 44 bd 49 4c fe 79 77 29 d8 60 15 17>,
  absValidity: 2018-03-21T21:46:33.586Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50201161,
     cipherKeyVal: <Buffer d8 7b 75 3f 3b 24 9e 05 96 63 74 5b a4 77 cc 75>,
     macKeyVal: <Buffer 6f 5b ec 97 78 a5 39 94 c0 1f 0b 66 58 5f 2d bf 52 d7 08 1b 44 bd 49 4c fe 79 77 29 d8 60 15 17>,
     absValidity: 2018-03-21T21:46:33.586Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 03 e9 dc 17 d4 c6 aa 11>
switching to HANDSHAKE_1_SENT
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.28:undefined
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902
            eventHandlers.onError('Error occurred in migration request: Disconnected from auth before getting migration response: ' + error);
                                                                                                                                      ^

ReferenceError: error is not defined
    at Socket.<anonymous> (/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902:135)
    at emitNone (events.js:91:20)
    at Socket.emit (events.js:188:7)
    at endReadableNT (_stream_readable.js:975:12)
    at _combinedTickCallback (internal/process/next_tick.js:80:11)
    at process._tickCallback (internal/process/next_tick.js:104:9)
