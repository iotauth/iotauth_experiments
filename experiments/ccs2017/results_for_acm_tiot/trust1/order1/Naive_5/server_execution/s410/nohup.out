changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s410.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's410',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 67 49 42 41 41 4b 43 41 51 45 41 77 4c ... > }
Handler: listening on port 22100
s410:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200365
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56840
received auth hello!
{ authId: 402, nonce: <Buffer 25 12 36 42 49 cb ed bc> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 93 c6 03 71 7c 1e 9d e3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer c0 f6 20 be 09 73 68 d9 c4 38 94 25 26 df 6b a5>,
  macKeyVal: <Buffer 40 27 b5 c8 04 87 82 98 3d cd 24 e8 be 1d bf 8c 63 6d 9c 89 de 50 30 1f 77 80 0f ac fa 1e 8a 2a>,
  absValidity: 2018-03-20T22:29:39.256Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 53 5c 54 d6 33 56 b1 bd>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 53 5c 54 d6 33 56 b1 bd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.53:59504',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200372
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57014
received auth hello!
{ authId: 402, nonce: <Buffer f6 63 74 e2 37 17 8a 47> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fb 63 63 66 cc 3b b5 fc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 88 89 c2 2e 8f de 32 2a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 88 89 c2 2e 8f de 32 2a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.53:59678',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200379
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57284
received auth hello!
{ authId: 402, nonce: <Buffer 95 c2 e7 6e e4 1c 5f 6f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 44 d3 3e 92 11 08 4b 06>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e3 b3 99 06 a2 c9 2c af>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e3 b3 99 06 a2 c9 2c af> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.53:59948',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200386
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57554
received auth hello!
{ authId: 402, nonce: <Buffer c9 8a e9 f3 84 14 c1 82> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 31 16 02 55 0c df b3 60>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c7 af 41 e6 8f 50 48 15>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c7 af 41 e6 8f 50 48 15> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.53:60218',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200393
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57824
received auth hello!
{ authId: 402, nonce: <Buffer e6 06 37 91 1e 79 58 84> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9f c9 b9 97 c9 9a 7d 20>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 95 e5 6d fd 04 01 59 b5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 95 e5 6d fd 04 01 59 b5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.53:60488',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200400
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58094
received auth hello!
{ authId: 402, nonce: <Buffer ab f1 d2 e8 56 2c ff b1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b9 e7 0a 9e 03 8a 3b 5e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4f b0 97 0e fe ab 5e fa>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 4f b0 97 0e fe ab 5e fa> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.53:60758',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200407
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58364
received auth hello!
{ authId: 402, nonce: <Buffer ad f4 71 48 47 58 6c 96> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f1 04 01 b4 15 4b 1f 0d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 95 30 60 9e 06 5b 37 8a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 95 30 60 9e 06 5b 37 8a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.53:32796',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200414
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58634
received auth hello!
{ authId: 402, nonce: <Buffer 03 1d 80 fc b9 36 c4 3c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 07 a5 47 2e 51 fc 79 83>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c3 07 a2 db 41 df d3 a0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c3 07 a2 db 41 df d3 a0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.53:33066',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
