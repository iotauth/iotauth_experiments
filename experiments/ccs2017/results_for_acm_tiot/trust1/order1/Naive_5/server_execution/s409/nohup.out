changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s409.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's409',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 79 64 ... > }
Handler: listening on port 22100
s409:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200367
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47886
received auth hello!
{ authId: 402, nonce: <Buffer b6 be 35 d6 57 71 ad 66> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 7b 96 cd e9 37 4a 2b 88>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 16 cd c6 89 1f 1d 4c 61 c2 1e ad f3 bb 82 63 01>,
  macKeyVal: <Buffer b5 a8 02 ca b2 a9 fc a5 2b 7f 30 1a b9 4d c3 60 9f 5b 55 63 fd f3 39 4f 9b c1 73 f6 5b 02 da 6b>,
  absValidity: 2018-03-20T22:29:47.250Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3c f1 be f8 f7 3e ee 20>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 3c f1 be f8 f7 3e ee 20> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.55:37054',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200374
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48074
received auth hello!
{ authId: 402, nonce: <Buffer 9f 87 03 61 36 eb e5 ac> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 33 44 48 8b da 81 dd dc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 87 86 ad 52 32 3f 5f 51>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 87 86 ad 52 32 3f 5f 51> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.55:37240',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200381
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48342
received auth hello!
{ authId: 402, nonce: <Buffer 72 ae 06 65 82 7f ae 95> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer be 14 d6 10 4d 09 99 f8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fa a2 48 5b db dd 34 37>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fa a2 48 5b db dd 34 37> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.55:37510',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200388
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48612
received auth hello!
{ authId: 402, nonce: <Buffer db 2a a8 8f 77 3d f9 f8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ef ee 63 95 06 29 16 08>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 82 cc 5e 14 93 a6 4d 8b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 82 cc 5e 14 93 a6 4d 8b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.55:37780',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200395
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48882
received auth hello!
{ authId: 402, nonce: <Buffer b8 db af 3b f8 3d 5c 62> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 04 50 f2 8b e8 92 38 38>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a1 ed f2 a2 6f e2 06 bb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a1 ed f2 a2 6f e2 06 bb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.55:38050',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200402
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49154
received auth hello!
{ authId: 402, nonce: <Buffer 89 f2 86 d4 e7 84 3a 07> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a3 16 fe 4b f1 29 84 2e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ae 1a 6e bc 3c eb 3c fa>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ae 1a 6e bc 3c eb 3c fa> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.55:38320',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200409
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49422
received auth hello!
{ authId: 402, nonce: <Buffer f7 03 a8 e0 f8 a6 e2 24> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 46 09 2b 25 88 be 82 04>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a3 3a 46 eb 97 99 50 1e>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer a3 3a 46 eb 97 99 50 1e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.55:38590',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
