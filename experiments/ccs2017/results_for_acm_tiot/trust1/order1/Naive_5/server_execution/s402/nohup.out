changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s402.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's402',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 51 49 42 41 41 4b 43 41 51 45 41 33 6a ... > }
Handler: listening on port 22100
s402:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101032
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33280
received auth hello!
{ authId: 401, nonce: <Buffer ee 0b a0 9b 2d ed b0 16> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 0e 9a c4 7d 0d f9 4a b1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer e7 92 19 ee 1a 7e 7d e6 f8 27 cf f4 e5 8b a5 aa>,
  macKeyVal: <Buffer 66 db 51 89 bf 06 ee b1 e7 9b 4b e1 59 bc 9e aa 1b 49 b7 dd 58 30 f7 25 cb 85 3b fb 63 2c eb 43>,
  absValidity: 2018-03-20T22:29:08.628Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9f dd 48 94 66 97 e2 7d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9f dd 48 94 66 97 e2 7d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.44:34258',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101038
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33400
received auth hello!
{ authId: 401, nonce: <Buffer 3d fd 7c f2 c3 e6 42 85> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ae fa 28 a1 42 05 82 67>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f9 10 9a 05 e4 7d dc ba>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f9 10 9a 05 e4 7d dc ba> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.44:34378',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101044
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33628
received auth hello!
{ authId: 401, nonce: <Buffer 24 49 24 08 1d cb c1 39> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f7 df 0a 32 31 71 d9 fb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 31 e6 cf 3a 66 5b 89 9d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 31 e6 cf 3a 66 5b 89 9d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.44:34606',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101050
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33898
received auth hello!
{ authId: 401, nonce: <Buffer e3 3c e8 98 45 b2 c7 12> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 72 14 81 aa fd 77 a5 a9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e6 33 93 9a e1 09 89 85>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e6 33 93 9a e1 09 89 85> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.44:34876',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101056
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34168
received auth hello!
{ authId: 401, nonce: <Buffer f6 5b e8 4d 69 e5 3f de> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c4 dc e8 1e 42 9f fc de>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a9 e4 92 57 45 a4 58 71>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a9 e4 92 57 45 a4 58 71> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.44:35146',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101062
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34438
received auth hello!
{ authId: 401, nonce: <Buffer 58 ff 6d 9c 42 cd 77 2c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 29 2f ec 17 f7 38 15 7e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f9 1f e9 a0 90 20 18 9e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f9 1f e9 a0 90 20 18 9e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.44:35416',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101068
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34708
received auth hello!
{ authId: 401, nonce: <Buffer de 45 cf bd 47 b6 cb dd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 52 52 f8 ca fa 62 de 1f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f6 89 d3 08 d7 e7 a3 cb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f6 89 d3 08 d7 e7 a3 cb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.44:35686',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101074
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34978
received auth hello!
{ authId: 401, nonce: <Buffer f9 4e c5 40 53 9f 78 0c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 88 a1 19 c5 d8 91 7e 65>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 00 f7 25 25 69 c5 bd 03>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 00 f7 25 25 69 c5 bd 03> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.44:35956',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101080
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35240
received auth hello!
{ authId: 401, nonce: <Buffer 10 59 a1 a2 20 53 b7 1e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 11 9e a5 30 e4 18 b4 e6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 61 90 78 5c 12 05 93 a5>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 61 90 78 5c 12 05 93 a5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.44:36218',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101086
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35390
received auth hello!
{ authId: 401, nonce: <Buffer d9 93 c8 ff f8 99 eb f5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e3 82 8f 49 eb 7b c0 e0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4e ed ea d6 a7 c6 30 eb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4e ed ea d6 a7 c6 30 eb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.44:36368',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101092
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35594
received auth hello!
{ authId: 401, nonce: <Buffer d8 9f 59 a0 50 8b e6 bf> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ad d8 b6 94 3e 96 75 4f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0e 05 f0 26 ae 79 ab 2b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0e 05 f0 26 ae 79 ab 2b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.44:36570',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101099
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35798
received auth hello!
{ authId: 401, nonce: <Buffer f9 09 f3 af e5 75 09 4c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d9 6c 78 ac 45 30 b6 df>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 62 2c d7 e5 01 e6 03 a0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 62 2c d7 e5 01 e6 03 a0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.44:36774',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101107
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36022
received auth hello!
{ authId: 401, nonce: <Buffer ba 2b 3e f2 f7 6d 50 fc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4a d9 2c 80 af 75 75 0e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 12 08 97 d3 4a 9b f6 c2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 12 08 97 d3 4a 9b f6 c2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.44:36998',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101116
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36238
received auth hello!
{ authId: 401, nonce: <Buffer 22 a8 d5 99 c6 d6 74 e8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5d 3d f8 9c 92 5c c0 8c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5d cb 58 e6 ef 7e c5 c2>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 5d cb 58 e6 ef 7e c5 c2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.44:37216',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101127
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36478
received auth hello!
{ authId: 401, nonce: <Buffer 50 a3 26 c8 61 55 08 42> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ee 6a 67 9f e9 d3 63 a8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0a 47 78 8d d9 48 a6 7f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0a 47 78 8d d9 48 a6 7f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.44:37456',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101136
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36716
received auth hello!
{ authId: 401, nonce: <Buffer 96 33 a8 af 3f 11 31 1e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ec 14 1a 74 26 67 80 1c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6c 76 f1 43 41 20 f6 a3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6c 76 f1 43 41 20 f6 a3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.44:37694',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101145
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36960
received auth hello!
{ authId: 401, nonce: <Buffer 68 f7 6d 93 5a 82 dd dd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8f 2d 34 6d 9e 4d a7 ee>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ef 05 9e 33 73 aa ec 91>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ef 05 9e 33 73 aa ec 91> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.44:37938',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101156
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37178
received auth hello!
{ authId: 401, nonce: <Buffer 76 70 d0 be 0d f8 bf 97> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 04 c9 a4 57 7c 6e bb bb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 74 7a 89 9c 3e 7b 3e e8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 74 7a 89 9c 3e 7b 3e e8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.44:38156',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101168
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37404
received auth hello!
{ authId: 401, nonce: <Buffer 57 59 26 17 92 2f 29 03> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3d d7 b3 bd f8 23 48 8e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 12 91 a5 0e 45 61 90 a4>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 12 91 a5 0e 45 61 90 a4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.44:38382',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101180
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37602
received auth hello!
{ authId: 401, nonce: <Buffer 1b 2f a5 77 e4 8d 61 31> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fe a2 92 4c 6a 07 dc 4a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 49 be eb c8 25 e1 36 19>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 49 be eb c8 25 e1 36 19> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.44:38578',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101191
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37788
received auth hello!
{ authId: 401, nonce: <Buffer 5c 6e 7b 49 bb 9e cd 75> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer be 13 9f 7a f1 02 29 7a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 49 c0 2e 4a 45 97 33 a3>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 49 c0 2e 4a 45 97 33 a3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.44:38764',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101203
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37966
received auth hello!
{ authId: 401, nonce: <Buffer 6a 27 62 76 7d 27 68 18> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ec 6b 2f 6f 6c 74 6c ae>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fc a4 20 99 fc 4d 89 38>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fc a4 20 99 fc 4d 89 38> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.44:38942',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101215
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38152
received auth hello!
{ authId: 401, nonce: <Buffer f6 6c 3f d3 92 c6 75 94> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 02 6f 9a 9f f0 be b5 13>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ea f6 2b d7 d0 79 7b 52>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ea f6 2b d7 d0 79 7b 52> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.44:39128',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101226
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38314
received auth hello!
{ authId: 401, nonce: <Buffer 06 ca 22 40 71 33 26 89> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a2 1c 24 12 77 aa 13 6c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fe a1 e5 90 3b 79 fc 23>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fe a1 e5 90 3b 79 fc 23> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.44:39290',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101238
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38488
received auth hello!
{ authId: 401, nonce: <Buffer f0 5a e0 bc 75 92 44 fb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e0 2c 10 c3 65 ed 29 f8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d8 3c 32 7b af f4 88 99>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d8 3c 32 7b af f4 88 99> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 24,
  remoteAddress: '::ffff:10.0.1.44:39464',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 24 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 24 }
specified socketID: 24
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #24 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101251
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38660
received auth hello!
{ authId: 401, nonce: <Buffer 6d 1f d7 d1 82 62 cf d5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f9 36 04 14 10 04 3a d2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 51 ee c4 ca d4 47 a0 cd>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 51 ee c4 ca d4 47 a0 cd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 25,
  remoteAddress: '::ffff:10.0.1.44:39636',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 25 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 25 }
specified socketID: 25
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #25 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101264
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38836
received auth hello!
{ authId: 401, nonce: <Buffer 53 70 b7 16 b7 13 0d 7d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f1 8c a0 d6 f4 8f c6 c7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 23 d5 7b f3 76 a8 ee 1e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 23 d5 7b f3 76 a8 ee 1e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 26,
  remoteAddress: '::ffff:10.0.1.44:39814',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 26 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 26 }
specified socketID: 26
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #26 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101276
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39006
received auth hello!
{ authId: 401, nonce: <Buffer 12 29 54 a9 dd f8 02 80> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 80 b8 d1 5f 42 d9 bf 85>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1c e0 66 9f b4 bd c3 fb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1c e0 66 9f b4 bd c3 fb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 27,
  remoteAddress: '::ffff:10.0.1.44:39984',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 27 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 27 }
specified socketID: 27
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #27 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101289
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39190
received auth hello!
{ authId: 401, nonce: <Buffer 48 d2 91 a9 e8 75 68 2b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 28 34 f5 fd 1a 60 c9 7d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a6 e5 5f 73 8b c5 96 15>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a6 e5 5f 73 8b c5 96 15> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 28,
  remoteAddress: '::ffff:10.0.1.44:40168',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 28 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 28 }
specified socketID: 28
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #28 closed
