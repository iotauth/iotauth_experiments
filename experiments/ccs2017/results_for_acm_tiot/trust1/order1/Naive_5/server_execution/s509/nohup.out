changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s509.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's509',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 7a 79 ... > }
Handler: listening on port 22100
s509:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201000
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51330
received auth hello!
{ authId: 502, nonce: <Buffer 60 c2 7c 7a 09 df e1 ee> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer bd ae 26 06 9f 65 f4 93>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer cc a6 04 18 54 6f eb 71 e8 c4 16 50 73 dd ab ee>,
  macKeyVal: <Buffer 78 14 f7 b9 86 f3 7b f4 00 5c 89 67 ea 66 92 44 d1 0b da e0 c0 e0 f9 36 0d 57 f1 65 58 23 84 bf>,
  absValidity: 2018-03-20T22:30:43.065Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 80 10 62 f4 9c 98 0e 50>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 80 10 62 f4 9c 98 0e 50> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.73:40310',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201007
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51600
received auth hello!
{ authId: 502, nonce: <Buffer ff b3 0f a8 f6 24 55 2a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 29 40 42 d9 75 5f 07 3c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8d 28 10 55 6a 54 1d 27>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8d 28 10 55 6a 54 1d 27> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.73:40580',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201014
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51870
received auth hello!
{ authId: 502, nonce: <Buffer 5f 18 cd 25 e9 40 91 f8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ce fe ae c3 18 e6 51 c9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6a 0e 7f 47 d9 d8 7c dc>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6a 0e 7f 47 d9 d8 7c dc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.73:40850',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201021
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52140
received auth hello!
{ authId: 502, nonce: <Buffer e7 6f c6 35 e6 51 0a 61> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a6 16 86 7a c0 ee 72 22>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a9 ce b8 18 23 45 50 8b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a9 ce b8 18 23 45 50 8b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.73:41120',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201028
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52410
received auth hello!
{ authId: 502, nonce: <Buffer 2b 7f f0 5b 4e bf 8f 32> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d3 1f 19 fa 2c ef 84 0c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 06 7d 4f 9d 6c 3d f8 f8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 06 7d 4f 9d 6c 3d f8 f8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.73:41390',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201035
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52680
received auth hello!
{ authId: 502, nonce: <Buffer b2 fe ef bf 72 05 20 22> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bc a2 dc 59 97 07 1b e0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e5 9b ba cb 84 fe 5e 88>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e5 9b ba cb 84 fe 5e 88> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.73:41660',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201042
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52950
received auth hello!
{ authId: 502, nonce: <Buffer 81 b0 47 18 1c 05 d8 3f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2e 3b 6f ba f2 8e 88 b5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fd 99 35 bd e5 00 17 c7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fd 99 35 bd e5 00 17 c7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.73:41930',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201049
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53132
received auth hello!
{ authId: 502, nonce: <Buffer b3 5b 1c ad 81 12 c9 b1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1f 1f 58 9e aa f0 e1 4d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0d 2b 8d b1 2d ca dc ec>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0d 2b 8d b1 2d ca dc ec> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.73:42112',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201056
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53316
received auth hello!
{ authId: 502, nonce: <Buffer b6 e2 5b 79 c9 73 97 83> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 19 ba 14 23 23 7d 76 06>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4a d0 bf 0d 19 a8 52 5c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4a d0 bf 0d 19 a8 52 5c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.73:42296',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201063
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53534
received auth hello!
{ authId: 502, nonce: <Buffer 83 e4 2e 55 40 8f 98 e9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ab 28 8f 24 fe d6 ef d3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1b f6 7f 72 30 e6 6a d1>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 1b f6 7f 72 30 e6 6a d1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.73:42514',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201072
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53742
received auth hello!
{ authId: 502, nonce: <Buffer 1c 8d bc 74 93 85 2e 9f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c8 96 f1 0a 11 ff 14 27>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3e a4 f7 36 0b 41 64 b1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3e a4 f7 36 0b 41 64 b1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.73:42722',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201082
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53960
received auth hello!
{ authId: 502, nonce: <Buffer 62 a3 00 e6 4e 28 9b 80> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 81 69 10 e0 aa 6d b0 ca>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3e d7 59 cc 5f 06 3c 19>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3e d7 59 cc 5f 06 3c 19> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.73:42940',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201100
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54204
received auth hello!
{ authId: 502, nonce: <Buffer b6 6b 72 37 2d fb f8 ca> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c8 c7 d7 a5 8f 55 2d 0f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f6 fd ce b7 9d 7b f9 5b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f6 fd ce b7 9d 7b f9 5b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.73:43184',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201118
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54452
received auth hello!
{ authId: 502, nonce: <Buffer da 2b 95 ef 1d 07 50 8e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 25 22 68 83 73 3f 71 ce>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d4 e0 b8 21 a7 70 30 74>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer d4 e0 b8 21 a7 70 30 74> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.73:43432',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201137
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54698
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 8d b6 10 45 5d a9 96 ad> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 86 36 9a ec 68 9f 3c 18>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d2 11 e1 46 89 3c 8c 55>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer d2 11 e1 46 89 3c 8c 55> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.73:43676',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201151
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54926
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201166
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55158
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
received auth hello!
{ authId: 502, nonce: <Buffer 02 73 e8 ad bc f6 fc f6> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: write after end
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201183
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55364
Handler: Error in server - details: handshake2 timed out...
disconnected from auth
Handler: Error in server - details: Connection with Auth timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201199
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55542
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 39 8f 56 37 e3 54 aa ed> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 91 6d e5 83 28 84 0a 30>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 64 e0 2f 4f ba 61 9d f6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 64 e0 2f 4f ba 61 9d f6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.73:44522',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201265
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56252
received auth hello!
{ authId: 502, nonce: <Buffer e5 a8 a9 75 69 9e 56 74> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b4 1a 28 31 37 75 5b 13>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4d 86 9b 18 78 a5 d8 26>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 4d 86 9b 18 78 a5 d8 26> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.73:45232',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201306
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56724
received auth hello!
{ authId: 502, nonce: <Buffer 7a 9b f2 8c a4 b0 0c 64> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 69 7f 46 79 18 bb 7c 75>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 29 fa 47 e0 d0 fb 49 d6>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 29 fa 47 e0 d0 fb 49 d6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.73:45704',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201311
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56774
received auth hello!
{ authId: 502, nonce: <Buffer 4a a2 d6 7e b1 18 d7 2b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 44 3a 67 ee f2 8b d1 da>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7f c1 5d bd 94 10 12 4d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 7f c1 5d bd 94 10 12 4d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.73:45754',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201326
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56942
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201340
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57106
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 6b f8 26 f8 53 61 99 5f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer dc 2a f8 50 25 f5 ec b6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b0 02 fc 52 86 e4 33 93>
Handler: Error in server - details: Error during comm init, details: Error: This socket has been ended by the other party
switching to HANDSHAKE_2_SENT
disconnected from auth
received auth hello!
{ authId: 502, nonce: <Buffer fc cc 9d 7f f0 c3 4c a7> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: write after end
received auth hello!
{ authId: 502, nonce: <Buffer a0 e2 a2 61 1c 8a 5d 1e> }
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: write after end
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in server - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.2:21100
received auth hello!
{ authId: 502, nonce: <Buffer 62 40 24 d3 df 85 93 23> }
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: write after end
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in server - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.2:21100
disconnected from auth
disconnected from auth
