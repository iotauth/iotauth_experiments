changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s413.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's413',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 51 49 42 41 41 4b 43 41 51 45 41 76 38 ... > }
Handler: listening on port 22100
s413:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300554
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41828
received auth hello!
{ authId: 403, nonce: <Buffer e0 2b c9 1b 41 52 75 48> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 69 36 02 2f 9f 17 da ac>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 69 f9 22 e0 01 8b 64 73 e1 33 cc 55 4d 9a d3 44>,
  macKeyVal: <Buffer 39 2b cc c2 0f 18 02 dd ee 41 3b 44 32 6a 6e fb b5 c7 73 6f fe 3d 93 a7 4a 71 bc 2e b4 a7 13 e1>,
  absValidity: 2018-03-20T22:29:53.955Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b3 cb 0f 03 c5 47 99 ad>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b3 cb 0f 03 c5 47 99 ad> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.58:48688',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300560
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42032
received auth hello!
{ authId: 403, nonce: <Buffer 6f 2d 5c 22 93 4c 68 98> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 78 b5 6a d4 6c 87 65 a7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1b 03 ca d2 d6 c0 2b d1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1b 03 ca d2 d6 c0 2b d1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.58:48892',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300566
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42302
received auth hello!
{ authId: 403, nonce: <Buffer f3 dd 7b 75 4b b9 41 19> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 06 1e cb a4 18 d3 65 cb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3e 91 e9 49 2a f1 63 43>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 3e 91 e9 49 2a f1 63 43> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.58:49162',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300572
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42572
received auth hello!
{ authId: 403, nonce: <Buffer ca 94 05 a7 df 38 92 9f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b9 63 3c e2 e9 aa b9 a9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ea aa 65 1e f6 4d c8 e4>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ea aa 65 1e f6 4d c8 e4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.58:49432',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300578
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42842
received auth hello!
{ authId: 403, nonce: <Buffer 13 fd 76 9e bb f5 ce f7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cf 46 9c 04 8f 45 fa ff>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2a db 36 ba a3 d2 f4 a8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2a db 36 ba a3 d2 f4 a8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.58:49702',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300584
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43112
received auth hello!
{ authId: 403, nonce: <Buffer 90 1e 36 76 f2 05 d3 f0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f2 6b dc 27 32 f7 00 b0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 10 a3 17 6b c2 33 cf fa>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 10 a3 17 6b c2 33 cf fa> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.58:49972',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300590
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43382
received auth hello!
{ authId: 403, nonce: <Buffer d5 5f e1 13 d1 7e 60 ad> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9b a4 f1 b8 ef 08 b8 4b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0f cc 7c 89 d7 80 9a ba>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0f cc 7c 89 d7 80 9a ba> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.58:50242',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300596
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43648
received auth hello!
{ authId: 403, nonce: <Buffer 4e 83 6e 62 b8 cf 8e cb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 05 72 1e 87 cd 7d 6b 33>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ff 1e ba d7 98 be 31 ae>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ff 1e ba d7 98 be 31 ae> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.58:50508',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
