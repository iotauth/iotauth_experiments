changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c410.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c410',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 78 44 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521576939176
connected to auth! from local port 34250
received auth hello!
{ authId: 402, nonce: <Buffer d3 d9 3a 04 4d 24 c8 2d> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 6f 51 a2 a4 28 d3 38 56>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer a4 19 ef ac 52 09 da d6 63 2e 07 04 55 0b b1 83>,
  macKeyVal: <Buffer 15 a7 82 42 c9 55 5c 6f cd 55 d6 b1 0a 9c 08 db 8b 03 34 3f a6 23 9d 87 b7 4f ce b6 76 08 53 94>,
  absValidity: 2018-03-20T21:15:39.353Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200309,
  cipherKeyVal: <Buffer 49 2d be 8b 37 63 03 66 04 5d 84 24 4f 97 e4 99>,
  macKeyVal: <Buffer ae 9e 2d 0c 65 21 f8 08 03 85 62 40 dc 60 b7 93 1d de e4 52 84 4e 9e ab 8b 27 28 71 91 15 77 3d>,
  absValidity: 2018-03-21T20:15:39.352Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200309,
     cipherKeyVal: <Buffer 49 2d be 8b 37 63 03 66 04 5d 84 24 4f 97 e4 99>,
     macKeyVal: <Buffer ae 9e 2d 0c 65 21 f8 08 03 85 62 40 dc 60 b7 93 1d de e4 52 84 4e 9e ab 8b 27 28 71 91 15 77 3d>,
     absValidity: 2018-03-21T20:15:39.352Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 67 d9 17 c4 b3 e3 b6 f7>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:15:40 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521576940909
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521576999234
connected to auth! from local port 34418
received auth hello!
{ authId: 402, nonce: <Buffer c6 c5 14 df 9b 47 ea 64> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 30 38 a8 aa 7e 15 e7 b5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200316,
  cipherKeyVal: <Buffer 64 b2 4d 49 fc 2a 87 0f 5d c9 a3 f0 b6 3f f9 16>,
  macKeyVal: <Buffer 58 a5 b7 6d 73 99 b9 46 77 68 f8 bc e4 a4 04 41 b5 78 42 66 86 6f a5 0a 7f 94 90 ec 05 01 36 f3>,
  absValidity: 2018-03-21T20:16:39.410Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200316,
     cipherKeyVal: <Buffer 64 b2 4d 49 fc 2a 87 0f 5d c9 a3 f0 b6 3f f9 16>,
     macKeyVal: <Buffer 58 a5 b7 6d 73 99 b9 46 77 68 f8 bc e4 a4 04 41 b5 78 42 66 86 6f a5 0a 7f 94 90 ec 05 01 36 f3>,
     absValidity: 2018-03-21T20:16:39.410Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer a5 f1 a7 3b 6c 3d ce c9>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:16:40 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521577000952
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521577059281
connected to auth! from local port 34688
received auth hello!
{ authId: 402, nonce: <Buffer f6 2f 91 b3 ae 2f 0f 1b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 82 a2 77 62 16 3d 20 ea>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200323,
  cipherKeyVal: <Buffer 0d fc 48 1b 3b 84 aa df 94 2f 08 e8 d7 55 8e a2>,
  macKeyVal: <Buffer 7b d2 7e ee 75 e8 48 19 1c fc 1e 3f bf c2 3d a5 b5 4b 31 6e a7 6f 6e 1b b3 23 9b 77 fa b3 14 32>,
  absValidity: 2018-03-21T20:17:39.646Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200323,
     cipherKeyVal: <Buffer 0d fc 48 1b 3b 84 aa df 94 2f 08 e8 d7 55 8e a2>,
     macKeyVal: <Buffer 7b d2 7e ee 75 e8 48 19 1c fc 1e 3f bf c2 3d a5 b5 4b 31 6e a7 6f 6e 1b b3 23 9b 77 fa b3 14 32>,
     absValidity: 2018-03-21T20:17:39.646Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 20 34 90 10 9a 9a 86 71>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:17:40 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521577061339
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521577119335
connected to auth! from local port 34958
received auth hello!
{ authId: 402, nonce: <Buffer 91 ee a7 8f 98 a4 f6 4d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ca 9d a9 52 9c e5 31 b7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200330,
  cipherKeyVal: <Buffer 1f 24 bc 8e 84 ef c3 42 0c 1c ef 0b d7 37 e6 fc>,
  macKeyVal: <Buffer 8a 7c 41 51 c6 a8 34 c9 b4 fa 32 17 fb 52 3a 7e 1d a9 2b 73 20 d8 be 3d 59 1a 90 eb 42 00 81 49>,
  absValidity: 2018-03-21T20:18:39.575Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200330,
     cipherKeyVal: <Buffer 1f 24 bc 8e 84 ef c3 42 0c 1c ef 0b d7 37 e6 fc>,
     macKeyVal: <Buffer 8a 7c 41 51 c6 a8 34 c9 b4 fa 32 17 fb 52 3a 7e 1d a9 2b 73 20 d8 be 3d 59 1a 90 eb 42 00 81 49>,
     absValidity: 2018-03-21T20:18:39.575Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer ef 13 7f 9e 90 92 4b 34>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:18:40 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521577121282
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521577179393
connected to auth! from local port 35228
received auth hello!
{ authId: 402, nonce: <Buffer 1b 6c 11 df dd a9 52 e6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 13 90 a6 44 00 ab 8b 3b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200337,
  cipherKeyVal: <Buffer 98 6c 72 63 b6 e2 57 e8 f9 ee 83 86 1d 54 fc f6>,
  macKeyVal: <Buffer 79 97 66 da b7 1f dd 42 5a 73 45 9e 47 85 21 0d bf 5e aa 27 7d 8e 7f 41 db 72 8d 3b bb cf ba 52>,
  absValidity: 2018-03-21T20:19:39.627Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200337,
     cipherKeyVal: <Buffer 98 6c 72 63 b6 e2 57 e8 f9 ee 83 86 1d 54 fc f6>,
     macKeyVal: <Buffer 79 97 66 da b7 1f dd 42 5a 73 45 9e 47 85 21 0d bf 5e aa 27 7d 8e 7f 41 db 72 8d 3b bb cf ba 52>,
     absValidity: 2018-03-21T20:19:39.627Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 15 76 62 ac d7 40 46 ad>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:19:40 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521577181370
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521577239444
connected to auth! from local port 35498
received auth hello!
{ authId: 402, nonce: <Buffer 95 a9 1d 12 02 91 a3 45> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 35 74 9e a3 fd a7 ae c6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200344,
  cipherKeyVal: <Buffer e5 f8 36 ce 82 24 70 de ea 00 ed ae 63 c0 23 06>,
  macKeyVal: <Buffer 7b b5 4c 6b 69 63 a0 3f c6 b4 32 c3 77 6a 01 3b 91 72 78 f9 dd 98 bb 3c c0 e3 c2 c1 83 90 95 49>,
  absValidity: 2018-03-21T20:20:39.706Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200344,
     cipherKeyVal: <Buffer e5 f8 36 ce 82 24 70 de ea 00 ed ae 63 c0 23 06>,
     macKeyVal: <Buffer 7b b5 4c 6b 69 63 a0 3f c6 b4 32 c3 77 6a 01 3b 91 72 78 f9 dd 98 bb 3c c0 e3 c2 c1 83 90 95 49>,
     absValidity: 2018-03-21T20:20:39.706Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer a6 cc cc dd 78 42 86 0e>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:20:41 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521577241449
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521577299501
connected to auth! from local port 35768
received auth hello!
{ authId: 402, nonce: <Buffer 12 e7 35 ff c0 fc ae 52> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f8 31 aa 2d 31 f4 53 a0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200351,
  cipherKeyVal: <Buffer 16 eb 3d e3 89 cb 76 cc 1e ec 41 71 ec f9 cc 04>,
  macKeyVal: <Buffer ad 92 b5 65 29 83 52 0c 13 f9 11 05 04 fa 0f 82 aa 63 2a 13 75 52 d1 db dc b0 ec ee 24 5a 49 af>,
  absValidity: 2018-03-21T20:21:39.777Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200351,
     cipherKeyVal: <Buffer 16 eb 3d e3 89 cb 76 cc 1e ec 41 71 ec f9 cc 04>,
     macKeyVal: <Buffer ad 92 b5 65 29 83 52 0c 13 f9 11 05 04 fa 0f 82 aa 63 2a 13 75 52 d1 db dc b0 ec ee 24 5a 49 af>,
     absValidity: 2018-03-21T20:21:39.777Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 9f 40 fb 34 56 45 de 31>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:21:41 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521577301442
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521577359560
connected to auth! from local port 36034
received auth hello!
{ authId: 402, nonce: <Buffer 8f ed 5e d4 77 e3 1b 44> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 14 65 b7 17 42 99 d2 27>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200358,
  cipherKeyVal: <Buffer 76 79 9e 81 ec 68 df 42 67 9c 83 8a 89 4a 48 1e>,
  macKeyVal: <Buffer cf 81 ad 88 3f 22 a3 9e 48 e8 74 8f 76 32 58 cb 2f 84 f5 e6 c6 ac 10 35 f6 2c 6e 7e ff 9d ba 6e>,
  absValidity: 2018-03-21T20:22:39.804Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200358,
     cipherKeyVal: <Buffer 76 79 9e 81 ec 68 df 42 67 9c 83 8a 89 4a 48 1e>,
     macKeyVal: <Buffer cf 81 ad 88 3f 22 a3 9e 48 e8 74 8f 76 32 58 cb 2f 84 f5 e6 c6 ac 10 35 f6 2c 6e 7e ff 9d ba 6e>,
     absValidity: 2018-03-21T20:22:39.804Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer ff 31 58 9f b2 af d4 84>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:22:40 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 8 1 1521577361233
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 9 0.8888888888888888 1521577419567
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 10 0.8 1521577479577
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 59402
received auth hello!
{ authId: 502, nonce: <Buffer 46 7e 36 53 f0 f4 cc 14> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 11 0.7272727272727273 1521577539587
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 59626
received auth hello!
{ authId: 502, nonce: <Buffer 2d e2 8a ef 75 a5 f7 4c> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 12 0.6666666666666666 1521577599597
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 13 0.6153846153846154 1521577659605
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 34370
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 14 0.5714285714285714 1521577719611
failure in connection with Auth : authFailureCount: 6
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 34612
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 15 0.5333333333333333 1521577779612
failure in connection with Auth : authFailureCount: 7
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 2
to: 3
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.3:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 16 0.5 1521577839620
failure in connection with Auth : authFailureCount: 8
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 3
to: 4
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 46930
received auth hello!
{ authId: 503, nonce: <Buffer c0 7d 97 06 70 20 a6 a2> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth503',
     commonName: '10.0.1.6' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth402',
     commonName: '10.0.0.2' },
  serial: '0162450C1623',
  notBefore: 2018-03-20T20:12:22.000Z,
  notAfter: 2018-03-21T20:14:02.000Z,
  subjectHash: '5542437f',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'FD:DE:86:1D:CD:10:FF:4C:1A:2A:4C:36:C9:64:AE:76:27:C2:90:7F',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'DE5B30AA46CAB50E9EB99610D7CD6F5A13A506E423E0B2FA7E5B5516308134D5EBA5029E1E86687304DE74F1EDC282AFF2BDBD5A1EEA4AB5A9C11B58BE559B6581427760281F7D05FB35B0241357C06845115CC2742374425A859E0CF161E9E28FB5DADEF2AD5312533F095CB0709A99F829AD0B3B1B19C8FB4E17DFB5D85CE6E65EA745001E8C0CC8AC5A752E195090E212D1563BE34185B3211F90F9135C8AD962B139057D6E600CF5797302C942DB7EEA5A0963E1105D1B46C227E6B60D0B1D7EF08EA4E9BE1220E5269AD51AB8E328F18D2AC5A2F47D0508AD6101DC087A6295158FC3BEDA4B4CD32EC8D3E6E2F67DC2962059753EE1281A41E463966327',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.6' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 503,
  host: '10.0.1.6',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJFDBYjMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDIxETAPBgNVBAMMCDEwLjAuMC4yMB4XDTE4MDMy\nMDIwMTIyMloXDTE4MDMyMTIwMTQwMlowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMzERMA8GA1UEAwwIMTAuMC4xLjYwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDeWzCqRsq1Dp65lhDXzW9aE6UG5CPgsvp+W1UWMIE01eulAp4e\nhmhzBN508e3Cgq/yvb1aHupKtanBG1i+VZtlgUJ3YCgffQX7NbAkE1fAaEURXMJ0\nI3RCWoWeDPFh6eKPtdre8q1TElM/CVywcJqZ+CmtCzsbGcj7Thfftdhc5uZep0UA\nHowMyKxadS4ZUJDiEtFWO+NBhbMhH5D5E1yK2WKxOQV9bmAM9XlzAslC237qWglj\n4RBdG0bCJ+a2DQsdfvCOpOm+EiDlJprVGrjjKPGNKsWi9H0FCK1hAdwIemKVFY/D\nvtpLTNMuyNPm4vZ9wpYgWXU+4SgaQeRjlmMnAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQYwDQYJKoZIhvcNAQELBQADggEBACPpMhVWWktxwKlsKB5iW5lBEreAjiml\n78+24Ra3Sph3TUfZ/ZN18FBiW+UcLlAGVGwgFkZhNP/z9utFBkmrYgzbv/UEkTDS\ngIBSUaYQ9MggXjpI27Xf8Ql2kXDsFcTVOr+XK47/vhqrjXU89JRBGaIG1IeiRxf5\nQeqd8HHSsmgHe+lW8Qi4JRq5+eJ8vh3eqfzqJFgDuyDZxmYi17M9i9yskfSq75wf\ndnt3b3393kLkudPe3utS4SFBrsGraiC0Ccb/Opq5MX0v2HJ9NSAH6mnswgslL1oB\nmKG8TFkVERdW3AxO4nz+EdndY/klAB4Ai2cvvdQhZeT1Ikd3gD4sah0=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 4
to: 5
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 17 0.47058823529411764 1521577899630
connected to auth! from local port 47160
received auth hello!
{ authId: 503, nonce: <Buffer 3e ed 5f 84 57 c3 c1 15> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 38 3c 4c 30 2f 77 32 d7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 47 61 84 f5 42 39 45 49 ff 0e a3 34 fe f5 72 01>,
  macKeyVal: <Buffer d9 e1 06 92 d7 46 6c d7 85 8a b2 77 f8 62 66 73 f0 4e 16 fd b1 7e 4b 46 70 66 6b 8d 6b 30 96 15>,
  absValidity: 2018-03-20T21:31:39.794Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300492,
  cipherKeyVal: <Buffer 60 16 c4 00 0d a9 55 48 f1 8b 3b 0a 0c a8 66 92>,
  macKeyVal: <Buffer 43 71 b6 88 3a 64 b6 75 31 ce 5b 71 b3 5a f7 a5 41 3b 06 06 f0 08 5a ac c5 a2 99 55 2c 1a e6 04>,
  absValidity: 2018-03-21T20:31:39.794Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300492,
     cipherKeyVal: <Buffer 60 16 c4 00 0d a9 55 48 f1 8b 3b 0a 0c a8 66 92>,
     macKeyVal: <Buffer 43 71 b6 88 3a 64 b6 75 31 ce 5b 71 b3 5a f7 a5 41 3b 06 06 f0 08 5a ac c5 a2 99 55 2c 1a e6 04>,
     absValidity: 2018-03-21T20:31:39.794Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer ee 4c 31 3a fc 67 99 4c>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.15:undefined
/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902
            eventHandlers.onError('Error occurred in migration request: Disconnected from auth before getting migration response: ' + error);
                                                                                                                                      ^

ReferenceError: error is not defined
    at Socket.<anonymous> (/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902:135)
    at emitNone (events.js:91:20)
    at Socket.emit (events.js:188:7)
    at endReadableNT (_stream_readable.js:975:12)
    at _combinedTickCallback (internal/process/next_tick.js:80:11)
    at process._tickCallback (internal/process/next_tick.js:104:9)
