changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c412.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c412',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 67 49 42 41 41 4b 43 41 51 45 41 36 63 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521576945619
connected to auth! from local port 32820
received auth hello!
{ authId: 402, nonce: <Buffer e3 a5 6f 19 1c 83 2f 30> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 24 e3 f8 28 18 e1 0e 32>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 0e 3f 6f f9 3e d7 93 5a 49 af 1d f0 a4 b5 38 c0>,
  macKeyVal: <Buffer af 2c f9 c8 a1 c9 a9 1a fd 22 83 47 72 85 83 09 b1 e0 c8 e8 28 23 6c db aa 47 7c ce 4f 3a b3 16>,
  absValidity: 2018-03-20T21:15:46.581Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200311,
  cipherKeyVal: <Buffer a7 62 59 b3 58 ad 89 24 79 5d 7b 86 66 08 c4 d1>,
  macKeyVal: <Buffer 21 21 ec ac 7f c8 64 e5 18 95 b2 37 ee a7 7d c4 3c 0b be 6c e7 ab 65 41 1a dd f8 8a dd 23 4e 29>,
  absValidity: 2018-03-21T20:15:46.580Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200311,
     cipherKeyVal: <Buffer a7 62 59 b3 58 ad 89 24 79 5d 7b 86 66 08 c4 d1>,
     macKeyVal: <Buffer 21 21 ec ac 7f c8 64 e5 18 95 b2 37 ee a7 7d c4 3c 0b be 6c e7 ab 65 41 1a dd f8 8a dd 23 4e 29>,
     absValidity: 2018-03-21T20:15:46.580Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 2c ce 4c 6b 04 81 c0 70>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:15:48 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521576948946
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521577005673
connected to auth! from local port 33000
received auth hello!
{ authId: 402, nonce: <Buffer 28 6e 6d 0a 75 3d aa f9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 00 b2 a0 7b 20 66 b1 37>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200318,
  cipherKeyVal: <Buffer f5 bc 41 59 bd 52 35 35 c0 f3 03 ac 93 46 ee 56>,
  macKeyVal: <Buffer fe 6f f7 ea 62 25 d9 e5 0c a6 0e 20 07 75 ca 17 bb 88 d1 a8 de 6c 26 37 86 13 2c 28 24 f7 da 45>,
  absValidity: 2018-03-21T20:16:46.615Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200318,
     cipherKeyVal: <Buffer f5 bc 41 59 bd 52 35 35 c0 f3 03 ac 93 46 ee 56>,
     macKeyVal: <Buffer fe 6f f7 ea 62 25 d9 e5 0c a6 0e 20 07 75 ca 17 bb 88 d1 a8 de 6c 26 37 86 13 2c 28 24 f7 da 45>,
     absValidity: 2018-03-21T20:16:46.615Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 0c ef 37 4e ad a3 75 7b>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:16:48 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521577009194
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521577065730
connected to auth! from local port 33270
received auth hello!
{ authId: 402, nonce: <Buffer d1 a7 2b 65 e9 0b 64 03> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8a 5b 9c bb 85 72 3e 30>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200325,
  cipherKeyVal: <Buffer 45 b6 51 fb b7 b9 a9 00 27 30 8d e5 05 b1 8c 3f>,
  macKeyVal: <Buffer c9 b8 f7 42 6b c0 57 e7 29 91 81 96 1e e3 e9 ab f5 90 31 cb e8 96 66 51 08 6b e0 10 db eb 96 52>,
  absValidity: 2018-03-21T20:17:46.694Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200325,
     cipherKeyVal: <Buffer 45 b6 51 fb b7 b9 a9 00 27 30 8d e5 05 b1 8c 3f>,
     macKeyVal: <Buffer c9 b8 f7 42 6b c0 57 e7 29 91 81 96 1e e3 e9 ab f5 90 31 cb e8 96 66 51 08 6b e0 10 db eb 96 52>,
     absValidity: 2018-03-21T20:17:46.694Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 0a 19 3c 1b a7 7c dc 43>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:17:48 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521577069344
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521577125788
connected to auth! from local port 33540
received auth hello!
{ authId: 402, nonce: <Buffer da a2 41 df 8f 88 a2 27> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8a 33 62 5b cf 5a 94 ec>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200332,
  cipherKeyVal: <Buffer c2 fe 36 03 00 fd 0f 4e 89 40 aa 0d 58 ae ff aa>,
  macKeyVal: <Buffer 96 66 37 0f af a2 82 19 63 68 1f 18 f8 cd 57 19 90 2e f4 78 99 5f 97 a4 df f6 97 0a fe 00 75 52>,
  absValidity: 2018-03-21T20:18:46.765Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200332,
     cipherKeyVal: <Buffer c2 fe 36 03 00 fd 0f 4e 89 40 aa 0d 58 ae ff aa>,
     macKeyVal: <Buffer 96 66 37 0f af a2 82 19 63 68 1f 18 f8 cd 57 19 90 2e f4 78 99 5f 97 a4 df f6 97 0a fe 00 75 52>,
     absValidity: 2018-03-21T20:18:46.765Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 88 f0 be 5a 9b b7 41 99>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:18:48 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521577129394
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521577185835
connected to auth! from local port 33810
received auth hello!
{ authId: 402, nonce: <Buffer 7a b1 70 6d 94 8e db 8f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2c 2e c2 93 ea d2 88 98>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200339,
  cipherKeyVal: <Buffer ff 99 b2 64 51 3a 85 ae 2a 1a 5f c3 6d 89 80 e2>,
  macKeyVal: <Buffer c2 5f 6e 99 79 09 02 15 7d 11 7c 71 db 82 fe 92 a3 97 71 f5 e1 c5 8b f8 d4 2d f1 2c 9a 35 c3 31>,
  absValidity: 2018-03-21T20:19:46.807Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200339,
     cipherKeyVal: <Buffer ff 99 b2 64 51 3a 85 ae 2a 1a 5f c3 6d 89 80 e2>,
     macKeyVal: <Buffer c2 5f 6e 99 79 09 02 15 7d 11 7c 71 db 82 fe 92 a3 97 71 f5 e1 c5 8b f8 d4 2d f1 2c 9a 35 c3 31>,
     absValidity: 2018-03-21T20:19:46.807Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 54 4f 55 fe 54 1d 11 86>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:19:48 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521577189416
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521577245890
connected to auth! from local port 34080
received auth hello!
{ authId: 402, nonce: <Buffer 72 98 26 39 a9 72 2c 75> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8e a2 ee 33 e8 85 04 04>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200346,
  cipherKeyVal: <Buffer fa ca 08 fe 72 13 d9 9c 78 52 62 5e a8 86 66 dd>,
  macKeyVal: <Buffer be b7 6a e8 ae be 5b 99 c9 78 a3 c1 d4 d3 0d d7 20 a8 1a 63 6c 6d d6 cb 38 1a 0d 55 22 c0 16 ab>,
  absValidity: 2018-03-21T20:20:46.837Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200346,
     cipherKeyVal: <Buffer fa ca 08 fe 72 13 d9 9c 78 52 62 5e a8 86 66 dd>,
     macKeyVal: <Buffer be b7 6a e8 ae be 5b 99 c9 78 a3 c1 d4 d3 0d d7 20 a8 1a 63 6c 6d d6 cb 38 1a 0d 55 22 c0 16 ab>,
     absValidity: 2018-03-21T20:20:46.837Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 14 c4 75 69 51 34 cc 7d>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:20:48 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521577249414
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521577305934
connected to auth! from local port 34350
received auth hello!
{ authId: 402, nonce: <Buffer 47 b5 74 96 2a 92 e5 98> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 85 ad 40 03 9f 10 bd 76>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200353,
  cipherKeyVal: <Buffer 7b 89 02 d8 93 2d 86 57 86 b8 61 2f 36 c3 32 ed>,
  macKeyVal: <Buffer a7 f6 3d b0 ff ee ad 1b f0 a5 48 41 e2 0f c0 b8 6a 7d cb 93 4b 6c f8 9d f7 4b bd fe 0e 5c c6 fc>,
  absValidity: 2018-03-21T20:21:46.912Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200353,
     cipherKeyVal: <Buffer 7b 89 02 d8 93 2d 86 57 86 b8 61 2f 36 c3 32 ed>,
     macKeyVal: <Buffer a7 f6 3d b0 ff ee ad 1b f0 a5 48 41 e2 0f c0 b8 6a 7d cb 93 4b 6c f8 9d f7 4b bd fe 0e 5c c6 fc>,
     absValidity: 2018-03-21T20:21:46.912Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 05 b2 97 a4 12 45 c3 9e>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:21:49 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521577309421
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521577365981
connected to auth! from local port 34616
received auth hello!
{ authId: 402, nonce: <Buffer df 14 df 91 29 96 cf 01> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bb ce 70 28 04 92 ff a6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200360,
  cipherKeyVal: <Buffer ac fa b8 20 dd 1b 9b 0a dd 1d e1 27 07 cc 8e fe>,
  macKeyVal: <Buffer 10 7a 76 10 e9 0d b0 06 a4 ec 82 2f 1a 9a f3 f1 78 5e 7e f8 cc 25 c2 c5 6b 34 00 22 dc 51 8e e2>,
  absValidity: 2018-03-21T20:22:46.916Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200360,
     cipherKeyVal: <Buffer ac fa b8 20 dd 1b 9b 0a dd 1d e1 27 07 cc 8e fe>,
     macKeyVal: <Buffer 10 7a 76 10 e9 0d b0 06 a4 ec 82 2f 1a 9a f3 f1 78 5e 7e f8 cc 25 c2 c5 6b 34 00 22 dc 51 8e e2>,
     absValidity: 2018-03-21T20:22:46.916Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 42 9d e9 1f 82 db f5 51>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.15:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 9 0.7777777777777778 1521577425989
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 10 0.7 1521577485997
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 36326
received auth hello!
{ authId: 502, nonce: <Buffer e9 33 44 f4 6d 68 e4 db> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 11 0.6363636363636364 1521577545998
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 36546
received auth hello!
{ authId: 502, nonce: <Buffer af 4c 6c 4b 15 df b5 93> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 12 0.5833333333333334 1521577606005
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 13 0.5384615384615384 1521577666013
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 46054
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 14 0.5 1521577726017
failure in connection with Auth : authFailureCount: 6
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 46294
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 15 0.4666666666666667 1521577786025
failure in connection with Auth : authFailureCount: 7
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 2
to: 3
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.3:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 16 0.4375 1521577846032
failure in connection with Auth : authFailureCount: 8
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 3
to: 4
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 34118
received auth hello!
{ authId: 503, nonce: <Buffer 89 02 b1 f8 a8 bb 73 d4> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth503',
     commonName: '10.0.1.6' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth402',
     commonName: '10.0.0.2' },
  serial: '0162450C1623',
  notBefore: 2018-03-20T20:12:22.000Z,
  notAfter: 2018-03-21T20:14:02.000Z,
  subjectHash: '5542437f',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'FD:DE:86:1D:CD:10:FF:4C:1A:2A:4C:36:C9:64:AE:76:27:C2:90:7F',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'DE5B30AA46CAB50E9EB99610D7CD6F5A13A506E423E0B2FA7E5B5516308134D5EBA5029E1E86687304DE74F1EDC282AFF2BDBD5A1EEA4AB5A9C11B58BE559B6581427760281F7D05FB35B0241357C06845115CC2742374425A859E0CF161E9E28FB5DADEF2AD5312533F095CB0709A99F829AD0B3B1B19C8FB4E17DFB5D85CE6E65EA745001E8C0CC8AC5A752E195090E212D1563BE34185B3211F90F9135C8AD962B139057D6E600CF5797302C942DB7EEA5A0963E1105D1B46C227E6B60D0B1D7EF08EA4E9BE1220E5269AD51AB8E328F18D2AC5A2F47D0508AD6101DC087A6295158FC3BEDA4B4CD32EC8D3E6E2F67DC2962059753EE1281A41E463966327',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.6' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 503,
  host: '10.0.1.6',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJFDBYjMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDIxETAPBgNVBAMMCDEwLjAuMC4yMB4XDTE4MDMy\nMDIwMTIyMloXDTE4MDMyMTIwMTQwMlowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMzERMA8GA1UEAwwIMTAuMC4xLjYwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDeWzCqRsq1Dp65lhDXzW9aE6UG5CPgsvp+W1UWMIE01eulAp4e\nhmhzBN508e3Cgq/yvb1aHupKtanBG1i+VZtlgUJ3YCgffQX7NbAkE1fAaEURXMJ0\nI3RCWoWeDPFh6eKPtdre8q1TElM/CVywcJqZ+CmtCzsbGcj7Thfftdhc5uZep0UA\nHowMyKxadS4ZUJDiEtFWO+NBhbMhH5D5E1yK2WKxOQV9bmAM9XlzAslC237qWglj\n4RBdG0bCJ+a2DQsdfvCOpOm+EiDlJprVGrjjKPGNKsWi9H0FCK1hAdwIemKVFY/D\nvtpLTNMuyNPm4vZ9wpYgWXU+4SgaQeRjlmMnAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQYwDQYJKoZIhvcNAQELBQADggEBACPpMhVWWktxwKlsKB5iW5lBEreAjiml\n78+24Ra3Sph3TUfZ/ZN18FBiW+UcLlAGVGwgFkZhNP/z9utFBkmrYgzbv/UEkTDS\ngIBSUaYQ9MggXjpI27Xf8Ql2kXDsFcTVOr+XK47/vhqrjXU89JRBGaIG1IeiRxf5\nQeqd8HHSsmgHe+lW8Qi4JRq5+eJ8vh3eqfzqJFgDuyDZxmYi17M9i9yskfSq75wf\ndnt3b3393kLkudPe3utS4SFBrsGraiC0Ccb/Opq5MX0v2HJ9NSAH6mnswgslL1oB\nmKG8TFkVERdW3AxO4nz+EdndY/klAB4Ai2cvvdQhZeT1Ikd3gD4sah0=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 4
to: 5
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 17 0.4117647058823529 1521577906042
connected to auth! from local port 34366
received auth hello!
{ authId: 503, nonce: <Buffer c8 d0 62 22 8f 21 87 62> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 24 38 5f 15 32 35 de b7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 9a ca 73 b2 71 21 0c de 29 10 4e e8 cd 70 2c ca>,
  macKeyVal: <Buffer 8c 0c b3 0b c3 a6 da 3d a6 36 84 10 d5 17 43 5a d6 79 2e 8a 0e e1 2a 71 d2 ec 1a ee 7f fb 1e c4>,
  absValidity: 2018-03-20T21:31:46.220Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300494,
  cipherKeyVal: <Buffer 25 a3 7e 10 dc 00 d0 63 ef 76 88 9a 7c 75 56 72>,
  macKeyVal: <Buffer 68 71 64 65 04 8d 5f a4 2d 13 88 f6 f4 58 b7 4e 74 fa 7c cd e6 2d 9d 47 21 3a 54 fb db af 4d c1>,
  absValidity: 2018-03-21T20:31:46.219Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300494,
     cipherKeyVal: <Buffer 25 a3 7e 10 dc 00 d0 63 ef 76 88 9a 7c 75 56 72>,
     macKeyVal: <Buffer 68 71 64 65 04 8d 5f a4 2d 13 88 f6 f4 58 b7 4e 74 fa 7c cd e6 2d 9d 47 21 3a 54 fb db af 4d c1>,
     absValidity: 2018-03-21T20:31:46.219Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 48 8a ae 0d e9 14 e7 92>
switching to HANDSHAKE_1_SENT
/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902
            eventHandlers.onError('Error occurred in migration request: Disconnected from auth before getting migration response: ' + error);
                                                                                                                                      ^

ReferenceError: error is not defined
    at Socket.<anonymous> (/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902:135)
    at emitNone (events.js:91:20)
    at Socket.emit (events.js:188:7)
    at endReadableNT (_stream_readable.js:975:12)
    at _combinedTickCallback (internal/process/next_tick.js:80:11)
    at process._tickCallback (internal/process/next_tick.js:104:9)
