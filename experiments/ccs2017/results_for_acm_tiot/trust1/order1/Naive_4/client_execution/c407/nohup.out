changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c407.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c407',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 67 49 42 41 41 4b 43 41 51 45 41 31 44 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521576929454
connected to auth! from local port 56434
received auth hello!
{ authId: 402, nonce: <Buffer 38 bc f3 ec e4 ad 40 68> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer f5 54 ce 23 c1 72 ab 4a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer ed e6 bf 91 4d c8 71 79 53 0e 66 b0 1e 31 b6 c3>,
  macKeyVal: <Buffer 59 1c 91 f2 52 9b db 0e 17 3d e1 db a7 4b e0 da ce 22 9d fa 69 81 06 94 02 83 8f 02 ed fe 22 8a>,
  absValidity: 2018-03-20T21:15:29.625Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200306,
  cipherKeyVal: <Buffer f1 ec 50 b1 24 cb 6a fd 7a 19 e7 2b ab 15 e3 68>,
  macKeyVal: <Buffer 62 af ea 68 7e da c6 9f 91 6f 4f 05 00 f6 f8 53 e0 10 b5 3a 4f 06 2f d5 4d 47 b0 f7 b6 b8 91 d3>,
  absValidity: 2018-03-21T20:15:29.621Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200306,
     cipherKeyVal: <Buffer f1 ec 50 b1 24 cb 6a fd 7a 19 e7 2b ab 15 e3 68>,
     macKeyVal: <Buffer 62 af ea 68 7e da c6 9f 91 6f 4f 05 00 f6 f8 53 e0 10 b5 3a 4f 06 2f d5 4d 47 b0 f7 b6 b8 91 d3>,
     absValidity: 2018-03-21T20:15:29.621Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 61 d9 f7 c3 77 ce 46 c9>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:15:30 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521576930593
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521576989510
connected to auth! from local port 56584
received auth hello!
{ authId: 402, nonce: <Buffer 97 ce 51 e1 02 2b df cd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 14 17 69 36 bb c9 95 cf>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200313,
  cipherKeyVal: <Buffer 89 60 66 69 95 3a e0 6d 5a 3c ca cb 8d 9b 0a 13>,
  macKeyVal: <Buffer 57 b9 06 99 f4 9d a5 3b 14 00 62 d9 1a c1 a9 48 b1 92 1b ec bc 27 42 03 6d 97 39 18 26 1b 7c 87>,
  absValidity: 2018-03-21T20:16:29.667Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200313,
     cipherKeyVal: <Buffer 89 60 66 69 95 3a e0 6d 5a 3c ca cb 8d 9b 0a 13>,
     macKeyVal: <Buffer 57 b9 06 99 f4 9d a5 3b 14 00 62 d9 1a c1 a9 48 b1 92 1b ec bc 27 42 03 6d 97 39 18 26 1b 7c 87>,
     absValidity: 2018-03-21T20:16:29.667Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 03 19 2d 15 7a 50 e6 40>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:16:30 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521576990668
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521577049542
connected to auth! from local port 56838
received auth hello!
{ authId: 402, nonce: <Buffer ce f2 6c 4e 46 f2 e3 0b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0f bb 0f d5 77 cd e0 f1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200320,
  cipherKeyVal: <Buffer a2 4a 8d 15 f4 da 7f 5a 07 96 c5 02 92 97 b2 83>,
  macKeyVal: <Buffer a2 3c 08 00 05 33 ca 98 3c ae 29 5d 4e a0 89 e0 56 da c5 38 04 6c f9 39 e3 6e 7b 24 3a e0 37 b7>,
  absValidity: 2018-03-21T20:17:29.829Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200320,
     cipherKeyVal: <Buffer a2 4a 8d 15 f4 da 7f 5a 07 96 c5 02 92 97 b2 83>,
     macKeyVal: <Buffer a2 3c 08 00 05 33 ca 98 3c ae 29 5d 4e a0 89 e0 56 da c5 38 04 6c f9 39 e3 6e 7b 24 3a e0 37 b7>,
     absValidity: 2018-03-21T20:17:29.829Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 5b f4 43 8c ab 25 ad 1a>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:17:30 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521577050815
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521577109601
connected to auth! from local port 57108
received auth hello!
{ authId: 402, nonce: <Buffer cb ff 88 7b 15 37 ac dd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 35 3c d9 56 7c 3e 11 5d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200327,
  cipherKeyVal: <Buffer 2e 04 2b d2 31 8d b5 3d 26 23 6f 0c f7 82 ef 3e>,
  macKeyVal: <Buffer 82 04 09 56 23 a9 89 54 a6 44 18 2c 35 d9 be 6b bc 3a 61 99 c2 20 d4 cd 9a 3a 8f a2 79 0f 9a e4>,
  absValidity: 2018-03-21T20:18:29.833Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200327,
     cipherKeyVal: <Buffer 2e 04 2b d2 31 8d b5 3d 26 23 6f 0c f7 82 ef 3e>,
     macKeyVal: <Buffer 82 04 09 56 23 a9 89 54 a6 44 18 2c 35 d9 be 6b bc 3a 61 99 c2 20 d4 cd 9a 3a 8f a2 79 0f 9a e4>,
     absValidity: 2018-03-21T20:18:29.833Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 37 a8 05 b4 7e b8 f2 fb>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:18:30 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521577110757
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521577169661
connected to auth! from local port 57378
received auth hello!
{ authId: 402, nonce: <Buffer 9b f8 38 e2 59 cc 38 ba> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9a db c7 71 8c 2c bf fe>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200334,
  cipherKeyVal: <Buffer 9b 33 25 9e 39 9f 35 ab 0d eb 4f da cf e5 85 84>,
  macKeyVal: <Buffer c1 b5 60 d4 e1 e4 ce 66 76 23 05 bb e1 18 a1 d1 2b 85 ea c8 b6 59 f0 19 be 58 b1 99 af 0f 35 63>,
  absValidity: 2018-03-21T20:19:29.881Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200334,
     cipherKeyVal: <Buffer 9b 33 25 9e 39 9f 35 ab 0d eb 4f da cf e5 85 84>,
     macKeyVal: <Buffer c1 b5 60 d4 e1 e4 ce 66 76 23 05 bb e1 18 a1 d1 2b 85 ea c8 b6 59 f0 19 be 58 b1 99 af 0f 35 63>,
     absValidity: 2018-03-21T20:19:29.881Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 6e c9 bf 83 ae 5b 1c 82>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:19:30 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521577170980
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521577229717
connected to auth! from local port 57648
received auth hello!
{ authId: 402, nonce: <Buffer 7e 7f e1 51 4e 9e de 91> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a7 be e9 2a 70 1d 8c cc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200341,
  cipherKeyVal: <Buffer a6 ec b3 2f 3d e5 4b 24 a5 42 53 af 55 ab fe 10>,
  macKeyVal: <Buffer a1 a2 40 ee c5 a6 a0 c4 2e e1 d5 bd 52 d8 7f 0c 0f 5e ae 01 e4 45 d6 ac 8d a1 73 91 82 26 5e 93>,
  absValidity: 2018-03-21T20:20:29.909Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200341,
     cipherKeyVal: <Buffer a6 ec b3 2f 3d e5 4b 24 a5 42 53 af 55 ab fe 10>,
     macKeyVal: <Buffer a1 a2 40 ee c5 a6 a0 c4 2e e1 d5 bd 52 d8 7f 0c 0f 5e ae 01 e4 45 d6 ac 8d a1 73 91 82 26 5e 93>,
     absValidity: 2018-03-21T20:20:29.909Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 8c 1c e2 24 9b 0f a7 45>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:20:30 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521577231013
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521577289753
connected to auth! from local port 57918
received auth hello!
{ authId: 402, nonce: <Buffer 48 8f 5e bf a9 22 86 d1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f2 9d 16 c3 a0 45 a8 e8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200348,
  cipherKeyVal: <Buffer 49 3a 1a b9 b1 ba d4 9e 12 0f 4d 10 04 6e 87 41>,
  macKeyVal: <Buffer cc 8e 57 8e 42 81 79 c5 c1 52 b1 0d a3 b8 d3 02 d7 0e 58 57 d7 af 2b 1d 0a 78 4c 04 cc d2 bc e0>,
  absValidity: 2018-03-21T20:21:29.974Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200348,
     cipherKeyVal: <Buffer 49 3a 1a b9 b1 ba d4 9e 12 0f 4d 10 04 6e 87 41>,
     macKeyVal: <Buffer cc 8e 57 8e 42 81 79 c5 c1 52 b1 0d a3 b8 d3 02 d7 0e 58 57 d7 af 2b 1d 0a 78 4c 04 cc d2 bc e0>,
     absValidity: 2018-03-21T20:21:29.974Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer d3 4c 8d a9 15 51 58 42>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:21:30 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521577290972
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521577349813
connected to auth! from local port 58188
received auth hello!
{ authId: 402, nonce: <Buffer 3a a5 e9 41 0d a5 6c 72> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0d 31 12 ff 8b 75 3c 89>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200355,
  cipherKeyVal: <Buffer c5 22 42 69 6a 08 02 09 1f 33 98 bb 3c 58 e8 b7>,
  macKeyVal: <Buffer bf ff 4f 60 3b 99 9b 3e b7 ea 54 72 e5 7a aa c4 a5 1e 64 95 8b 2e ad eb 47 56 24 40 f3 c3 15 39>,
  absValidity: 2018-03-21T20:22:29.985Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40200355,
     cipherKeyVal: <Buffer c5 22 42 69 6a 08 02 09 1f 33 98 bb 3c 58 e8 b7>,
     macKeyVal: <Buffer bf ff 4f 60 3b 99 9b 3e b7 ea 54 72 e5 7a aa c4 a5 1e 64 95 8b 2e ad eb 47 56 24 40 f3 c3 15 39>,
     absValidity: 2018-03-21T20:22:29.985Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 3d 7c 30 73 2d 1c ea 90>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:22:30 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 8 1 1521577351146
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 9 0.8888888888888888 1521577409835
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 10 0.8 1521577469844
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 50282
received auth hello!
{ authId: 502, nonce: <Buffer ce 67 b6 70 6b e5 ac 43> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 11 0.7272727272727273 1521577529854
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 50502
received auth hello!
{ authId: 502, nonce: <Buffer ab b7 c4 6f d8 ca 07 a6> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 12 0.6666666666666666 1521577589864
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 13 0.6153846153846154 1521577649871
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 60448
received auth hello!
{ authId: 401, nonce: <Buffer 6f c0 85 b3 a9 3a b3 ee> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth401',
     commonName: '10.0.1.1' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth402',
     commonName: '10.0.0.2' },
  serial: '0162450C1567',
  notBefore: 2018-03-20T20:12:22.000Z,
  notAfter: 2018-03-21T20:14:02.000Z,
  subjectHash: 'de555cae',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '97:90:50:1C:2E:03:3D:1E:43:76:2E:A4:C3:1E:81:EC:97:2A:B6:E6',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'B95EF3029A4C4FAE066EFDE0A6119C37979EDB5A64C834CFDC68175183A2CCB6F817A6CEE1A9EF3E562CF75048E8894B6036030296F313DEBF7C1069E42825C46A5F1F6D69FFE10EE6D73B7805503AA7E6A4C2FF62C2E4D5BF7079FBED00C4B24480D5BC43B7B3B042025990D06DEE0A0388CF2AE7F4B313EF564F2EB3931C44FD1DBD6DFA6DA12843C6DBAAE1EFBC5E7EEDA9407AE6D78B6211169F194056CA6F9CD9F20F33FE469D35BCC944D43D2ECB947F73AF95BB5530BFF2A9B92CA16EB949D06EB8218BBBEC8EA009AC9F6C53C626A2796484448AEDAAB3D19834BA2A19D35D0E105AD47B9A6B3E1589517039E098E992676ED418010E608FA312B251',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.1' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 401,
  host: '10.0.1.1',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJFDBVnMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDIxETAPBgNVBAMMCDEwLjAuMC4yMB4XDTE4MDMy\nMDIwMTIyMloXDTE4MDMyMTIwMTQwMlowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDQwMTERMA8GA1UEAwwIMTAuMC4xLjEwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQC5XvMCmkxPrgZu/eCmEZw3l57bWmTINM/caBdRg6LMtvgXps7h\nqe8+Viz3UEjoiUtgNgMClvMT3r98EGnkKCXEal8fbWn/4Q7m1zt4BVA6p+akwv9i\nwuTVv3B5++0AxLJEgNW8Q7ezsEICWZDQbe4KA4jPKuf0sxPvVk8us5McRP0dvW36\nbaEoQ8bbquHvvF5+7alAeubXi2IRFp8ZQFbKb5zZ8g8z/kadNbzJRNQ9LsuUf3Ov\nlbtVML/yqbksoW65SdBuuCGLu+yOoAmsn2xTxiaieWSERIrtqrPRmDS6KhnTXQ4Q\nWtR7mms+FYlRcDngmOmSZ27UGAEOYI+jErJRAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQEwDQYJKoZIhvcNAQELBQADggEBAFPYLhndfaJ8JaENaTDiVv5w1Eila1LC\nwTNH66NsJtw6iWkVlcboAMGgOlNKJmlUhPyMNF6eIUeQr7SRM/LilDuyugSqOaQb\nyiUxzBlDmcobXLtKfhED8jEEYXIOnikDs6gwrMaZUZEwfw5jZB+4ECvezJLz/ptz\n/uHwA5keFJO9frH0UR6tGNkZK8nBfKHzP2bw/Ke1BVDB82ER8YGniXtB7b4CIE0+\nCJU7eJ1WMiuURSPiNeUijxT5lmax7Gzx19zxF3a6TL2HgI1rLsdanWP/1tTS/NXw\no2yhkP9qVhpUtgqU8c+A+RlaJ+trAKK1Pw83ibielCIPLeHRPV+/pk0=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 2
to: 3
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 14 0.5714285714285714 1521577709881
connected to auth! from local port 60674
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 15 0.5333333333333333 1521577769890
connected to auth! from local port 60920
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 16 0.5 1521577829897
connected to auth! from local port 32936
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 17 0.47058823529411764 1521577889905
connected to auth! from local port 33186
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 18 0.4444444444444444 1521577949916
connected to auth! from local port 33434
Handler: Error in secure comm - details: Disconnected from auth before getting session key response
Handler: Error in secure comm - details: Disconnected from auth before getting session key response
Handler: Error in secure comm - details: Disconnected from auth before getting session key response
Handler: Error in secure comm - details: Disconnected from auth before getting session key response
Handler: Error in secure comm - details: Disconnected from auth before getting session key response
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 19 0.42105263157894735 1521578009927
connected to auth! from local port 33606
received auth hello!
{ authId: 401, nonce: <Buffer fa 0e c0 44 18 d6 89 4b> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer f6 53 20 7d da eb 1d c0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 3b 07 76 a9 b4 35 73 54 c6 d5 5e 82 07 a9 a0 82>,
  macKeyVal: <Buffer 57 25 eb 5d 65 cb 7e c9 8d 2a 4c 54 c3 32 2d fe 45 39 7a 62 80 36 43 a9 8d 3a 76 66 e7 85 d9 9e>,
  absValidity: 2018-03-20T21:33:33.706Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100921,
  cipherKeyVal: <Buffer b8 a3 91 f4 7e ec f6 68 3f 09 a9 d6 61 c5 e8 7d>,
  macKeyVal: <Buffer 9e b7 6d 53 48 57 db 06 42 05 3e 86 1f c9 ff d2 56 ee 42 81 24 43 cf 04 82 a7 c4 04 d8 52 c6 28>,
  absValidity: 2018-03-21T20:33:33.706Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40100921,
     cipherKeyVal: <Buffer b8 a3 91 f4 7e ec f6 68 3f 09 a9 d6 61 c5 e8 7d>,
     macKeyVal: <Buffer 9e b7 6d 53 48 57 db 06 42 05 3e 86 1f c9 ff d2 56 ee 42 81 24 43 cf 04 82 a7 c4 04 d8 52 c6 28>,
     absValidity: 2018-03-21T20:33:33.706Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 1c 64 09 95 a9 09 7f 49>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 20 0.4 1521578069933
connected to auth! from local port 33770
received auth hello!
{ authId: 401, nonce: <Buffer 27 8d aa 0c 71 ff f9 b9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fc 56 31 4d bb cb b2 59>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100932,
  cipherKeyVal: <Buffer 33 cc fb cc 5f 9c 67 18 83 b6 33 f0 89 2e 92 3e>,
  macKeyVal: <Buffer 7a 75 90 68 f9 f6 6e bd a6 03 5f 6f 26 46 1a f9 b5 aa a4 a4 77 3e c7 b5 1d 7a ee 2e 46 d7 f8 0d>,
  absValidity: 2018-03-21T20:34:33.705Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40100932,
     cipherKeyVal: <Buffer 33 cc fb cc 5f 9c 67 18 83 b6 33 f0 89 2e 92 3e>,
     macKeyVal: <Buffer 7a 75 90 68 f9 f6 6e bd a6 03 5f 6f 26 46 1a f9 b5 aa a4 a4 77 3e c7 b5 1d 7a ee 2e 46 d7 f8 0d>,
     absValidity: 2018-03-21T20:34:33.705Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer dd c7 51 46 52 f6 b6 fa>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 21 0.38095238095238093 1521578129939
connected to auth! from local port 33936
received auth hello!
{ authId: 401, nonce: <Buffer 69 59 a4 60 93 32 bd 9f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 51 0d ca f6 02 f3 5a 2f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100943,
  cipherKeyVal: <Buffer 99 8e f9 7e de d0 4b 1e b9 f5 a5 74 06 68 19 4b>,
  macKeyVal: <Buffer eb b2 d3 71 72 87 99 08 c7 a6 34 c6 d7 5e 64 e6 05 8d 62 15 c9 f0 0c c8 65 98 09 b8 86 93 25 fb>,
  absValidity: 2018-03-21T20:35:33.774Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40100943,
     cipherKeyVal: <Buffer 99 8e f9 7e de d0 4b 1e b9 f5 a5 74 06 68 19 4b>,
     macKeyVal: <Buffer eb b2 d3 71 72 87 99 08 c7 a6 34 c6 d7 5e 64 e6 05 8d 62 15 c9 f0 0c c8 65 98 09 b8 86 93 25 fb>,
     absValidity: 2018-03-21T20:35:33.774Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 0d 22 89 57 93 82 a7 40>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 22 0.36363636363636365 1521578189945
connected to auth! from local port 34102
received auth hello!
{ authId: 401, nonce: <Buffer 7a be a2 64 60 9b 38 ef> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 55 0d fc bf eb 2f 54 d0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100954,
  cipherKeyVal: <Buffer 98 a3 a9 51 0b a2 7c 8a 75 66 5b c7 08 d5 6f 3f>,
  macKeyVal: <Buffer f8 98 60 26 3d 60 1a 5b d4 a3 54 6f 82 1e 03 24 5b 11 cc e1 35 6f a7 7e c4 cf ea 23 60 21 17 90>,
  absValidity: 2018-03-21T20:36:33.568Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40100954,
     cipherKeyVal: <Buffer 98 a3 a9 51 0b a2 7c 8a 75 66 5b c7 08 d5 6f 3f>,
     macKeyVal: <Buffer f8 98 60 26 3d 60 1a 5b d4 a3 54 6f 82 1e 03 24 5b 11 cc e1 35 6f a7 7e c4 cf ea 23 60 21 17 90>,
     absValidity: 2018-03-21T20:36:33.568Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 8a 09 a4 2b 08 51 ca b3>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 23 0.34782608695652173 1521578249952
connected to auth! from local port 34268
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 24 0.3333333333333333 1521578309963
connected to auth! from local port 34428
received auth hello!
{ authId: 401, nonce: <Buffer 9b 07 04 65 ea 85 f8 6f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 39 d6 c4 8a eb e7 76 0f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100975,
  cipherKeyVal: <Buffer 1c 68 d8 49 61 43 f4 da c6 60 75 06 e6 83 42 39>,
  macKeyVal: <Buffer 6c 37 c2 89 e3 5e 61 4c 06 b3 a5 1d b4 f5 ac ff c4 de 1d 97 3f 1a 9b 6f 17 97 ca 54 28 9c 1e 79>,
  absValidity: 2018-03-21T20:38:37.646Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40100975,
     cipherKeyVal: <Buffer 1c 68 d8 49 61 43 f4 da c6 60 75 06 e6 83 42 39>,
     macKeyVal: <Buffer 6c 37 c2 89 e3 5e 61 4c 06 b3 a5 1d b4 f5 ac ff c4 de 1d 97 3f 1a 9b 6f 17 97 ca 54 28 9c 1e 79>,
     absValidity: 2018-03-21T20:38:37.646Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 3b 1f ef 38 13 8d ef 7d>
switching to HANDSHAKE_1_SENT
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 25 0.32 1521578369964
connected to auth! from local port 34594
received auth hello!
{ authId: 401, nonce: <Buffer 9a 76 90 2e a8 97 d6 24> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 84 a1 19 22 b0 78 f5 bf>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100986,
  cipherKeyVal: <Buffer ef 55 9c 60 13 34 66 13 bd f4 bf ad cc 19 0c d3>,
  macKeyVal: <Buffer 4e 3d 62 ce 48 7f a3 e9 5b 25 14 94 ea 26 de 02 f6 1d 0e fe 06 be f1 59 df 54 b0 33 9d 6e 59 02>,
  absValidity: 2018-03-21T20:39:37.659Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40100986,
     cipherKeyVal: <Buffer ef 55 9c 60 13 34 66 13 bd f4 bf ad cc 19 0c d3>,
     macKeyVal: <Buffer 4e 3d 62 ce 48 7f a3 e9 5b 25 14 94 ea 26 de 02 f6 1d 0e fe 06 be f1 59 df 54 b0 33 9d 6e 59 02>,
     absValidity: 2018-03-21T20:39:37.659Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 03 7b 1b 01 b0 96 20 24>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 26 0.3076923076923077 1521578429968
connected to auth! from local port 34760
received auth hello!
{ authId: 401, nonce: <Buffer 2e 0b 45 9b 50 40 e2 1b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer dd 46 64 0b 5c 9a 27 7e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100997,
  cipherKeyVal: <Buffer eb 3b 52 cd 0e 32 b8 54 69 a8 29 22 cd 3c 1a fa>,
  macKeyVal: <Buffer e8 eb 6c a9 83 09 4f 69 5c 71 be bd bf 42 61 ce 9a e7 04 ac 8c 36 6f fa fe ce 85 65 42 61 7d af>,
  absValidity: 2018-03-21T20:40:37.688Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40100997,
     cipherKeyVal: <Buffer eb 3b 52 cd 0e 32 b8 54 69 a8 29 22 cd 3c 1a fa>,
     macKeyVal: <Buffer e8 eb 6c a9 83 09 4f 69 5c 71 be bd bf 42 61 ce 9a e7 04 ac 8c 36 6f fa fe ce 85 65 42 61 7d af>,
     absValidity: 2018-03-21T20:40:37.688Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 70 83 6f bc 85 1c 9c ba>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 27 0.2962962962962963 1521578489970
connected to auth! from local port 34926
received auth hello!
{ authId: 401, nonce: <Buffer ab b0 29 83 e4 3c 6f 19> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 10 09 e3 47 f6 df 41 b8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101007,
  cipherKeyVal: <Buffer dd 64 bf eb 27 e6 9c 2c fe 33 60 01 83 27 9a 90>,
  macKeyVal: <Buffer c2 5f 13 8b 21 6d ba ac 74 ec b9 68 b9 34 91 0d d7 db 0c a5 12 73 2e 09 ba cf b8 3b e6 c0 86 d2>,
  absValidity: 2018-03-21T20:41:33.781Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40101007,
     cipherKeyVal: <Buffer dd 64 bf eb 27 e6 9c 2c fe 33 60 01 83 27 9a 90>,
     macKeyVal: <Buffer c2 5f 13 8b 21 6d ba ac 74 ec b9 68 b9 34 91 0d d7 db 0c a5 12 73 2e 09 ba cf b8 3b e6 c0 86 d2>,
     absValidity: 2018-03-21T20:41:33.781Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer c7 78 84 5b 7e 33 d2 e9>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 28 0.2857142857142857 1521578549976
connected to auth! from local port 35092
received auth hello!
{ authId: 401, nonce: <Buffer 08 e0 98 3f e3 27 3b 12> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2b e3 6c 35 e5 b8 a5 43>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40101018,
  cipherKeyVal: <Buffer 6f 14 3e 44 2c 5c 19 74 aa d9 d1 e6 dc 13 21 02>,
  macKeyVal: <Buffer 79 6e 88 48 5c fa 3a 5d 80 0e c5 34 49 55 4c 06 81 b0 b6 4f a9 dd 0c fa fe 1d 6b 0b 0e ef 43 8f>,
  absValidity: 2018-03-21T20:42:33.785Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.12',
  serverPort: 22100,
  sessionKey: 
   { id: 40101018,
     cipherKeyVal: <Buffer 6f 14 3e 44 2c 5c 19 74 aa d9 d1 e6 dc 13 21 02>,
     macKeyVal: <Buffer 79 6e 88 48 5c fa 3a 5d 80 0e c5 34 49 55 4c 06 81 b0 b6 4f a9 dd 0c fa fe 1d 6b 0b 0e ef 43 8f>,
     absValidity: 2018-03-21T20:42:33.785Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 7f da 5c e4 2e df c7 07>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.12:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 29 0.27586206896551724 1521578609981
connected to auth! from local port 35258
