changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c408.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c408',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 51 49 42 41 41 4b 43 41 51 45 41 75 4c ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521576932688
connected to auth! from local port 39526
received auth hello!
{ authId: 402, nonce: <Buffer 63 15 2f d4 90 41 33 f7> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer f4 6f e4 4f ba 6a d0 ea>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer da fb b9 df a6 40 22 85 08 cd 85 0d 73 6a 64 f1>,
  macKeyVal: <Buffer 96 08 58 89 63 52 22 64 19 dd 03 96 a6 4b 3a 09 82 1a 49 63 a4 f2 9a 07 90 d1 7c 8a 63 dd 79 65>,
  absValidity: 2018-03-20T21:15:32.869Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200307,
  cipherKeyVal: <Buffer bb e6 87 05 a5 9c 1c 05 23 0e 38 bc 47 42 d1 7c>,
  macKeyVal: <Buffer a1 64 81 00 12 3f fc c2 d8 80 62 0d 9b 99 4b d1 d1 23 6d 14 e6 ab 7d 36 6b 10 96 4f 06 5d 4f 96>,
  absValidity: 2018-03-21T20:15:32.869Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40200307,
     cipherKeyVal: <Buffer bb e6 87 05 a5 9c 1c 05 23 0e 38 bc 47 42 d1 7c>,
     macKeyVal: <Buffer a1 64 81 00 12 3f fc c2 d8 80 62 0d 9b 99 4b d1 d1 23 6d 14 e6 ab 7d 36 6b 10 96 4f 06 5d 4f 96>,
     absValidity: 2018-03-21T20:15:32.869Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer e3 e1 12 61 c9 7d 2b 06>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:15:33 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521576933785
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521576992746
connected to auth! from local port 39682
received auth hello!
{ authId: 402, nonce: <Buffer d3 e6 e6 95 b1 2f ec 76> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0e 8b 64 84 d5 15 0b 6c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200314,
  cipherKeyVal: <Buffer bc 18 82 e0 19 bf 1d ec d9 39 4a 44 77 c6 dd aa>,
  macKeyVal: <Buffer ba ae 40 e6 01 dc 01 7c ae 68 5b d1 70 35 0f 73 09 5a 40 4b 81 d5 c5 55 20 b4 41 57 cc b4 7d 8b>,
  absValidity: 2018-03-21T20:16:32.858Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40200314,
     cipherKeyVal: <Buffer bc 18 82 e0 19 bf 1d ec d9 39 4a 44 77 c6 dd aa>,
     macKeyVal: <Buffer ba ae 40 e6 01 dc 01 7c ae 68 5b d1 70 35 0f 73 09 5a 40 4b 81 d5 c5 55 20 b4 41 57 cc b4 7d 8b>,
     absValidity: 2018-03-21T20:16:32.858Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer df ff ff ff 86 0e 10 4b>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:16:33 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521576993708
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521577052766
connected to auth! from local port 39942
received auth hello!
{ authId: 402, nonce: <Buffer 87 16 d9 80 bc f2 15 27> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e2 38 b2 28 96 be 55 42>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200321,
  cipherKeyVal: <Buffer 1a 03 7d 94 33 85 05 3a ad 69 94 61 f8 d6 6c 81>,
  macKeyVal: <Buffer ad 80 f1 9b 95 f9 6e 99 bf db d4 19 29 81 cb 11 aa 6d 52 f4 85 b7 29 33 97 f0 23 fc ef fe 9a 6a>,
  absValidity: 2018-03-21T20:17:32.918Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40200321,
     cipherKeyVal: <Buffer 1a 03 7d 94 33 85 05 3a ad 69 94 61 f8 d6 6c 81>,
     macKeyVal: <Buffer ad 80 f1 9b 95 f9 6e 99 bf db d4 19 29 81 cb 11 aa 6d 52 f4 85 b7 29 33 97 f0 23 fc ef fe 9a 6a>,
     absValidity: 2018-03-21T20:17:32.918Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 53 ba 53 4a 29 44 34 ee>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:17:33 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521577053934
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521577112814
connected to auth! from local port 40212
received auth hello!
{ authId: 402, nonce: <Buffer 52 e7 23 18 2b e1 a6 bd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 71 71 c7 25 4b 33 8e 6f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200328,
  cipherKeyVal: <Buffer 50 19 a7 ae da 5c 7c f9 96 16 7e cb f4 96 65 39>,
  macKeyVal: <Buffer a1 de 62 23 5e 58 3a e6 de b7 e6 aa 84 41 6d 72 43 26 ad 7e f5 a9 9a c5 d0 6d 3f 64 36 e0 22 e2>,
  absValidity: 2018-03-21T20:18:32.933Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40200328,
     cipherKeyVal: <Buffer 50 19 a7 ae da 5c 7c f9 96 16 7e cb f4 96 65 39>,
     macKeyVal: <Buffer a1 de 62 23 5e 58 3a e6 de b7 e6 aa 84 41 6d 72 43 26 ad 7e f5 a9 9a c5 d0 6d 3f 64 36 e0 22 e2>,
     absValidity: 2018-03-21T20:18:32.933Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 17 79 b3 b2 29 d4 15 1b>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:18:33 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521577113760
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521577172835
connected to auth! from local port 40482
received auth hello!
{ authId: 402, nonce: <Buffer af 63 0d 9a d4 ea c9 ab> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e1 3e 4e 36 87 02 e5 9f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200335,
  cipherKeyVal: <Buffer a6 4b 8b 73 fa 5a 7b dd 0e 64 24 41 22 0e 61 51>,
  macKeyVal: <Buffer 5f 92 e1 52 9f 32 0d 5d c4 7b e1 c4 70 c8 75 f9 99 8c c3 27 18 7b 60 2d e4 28 2f 91 8e 92 c2 24>,
  absValidity: 2018-03-21T20:19:33.014Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40200335,
     cipherKeyVal: <Buffer a6 4b 8b 73 fa 5a 7b dd 0e 64 24 41 22 0e 61 51>,
     macKeyVal: <Buffer 5f 92 e1 52 9f 32 0d 5d c4 7b e1 c4 70 c8 75 f9 99 8c c3 27 18 7b 60 2d e4 28 2f 91 8e 92 c2 24>,
     absValidity: 2018-03-21T20:19:33.014Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 5c db 8a 7a db bd 9a 0d>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:19:33 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521577173927
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521577232893
connected to auth! from local port 40752
received auth hello!
{ authId: 402, nonce: <Buffer 25 16 61 08 fd 85 bb 77> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 12 e4 cf 8d 03 73 27 81>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200342,
  cipherKeyVal: <Buffer f5 f6 57 00 bf 81 4b 65 bd f5 40 3c 52 f9 a3 ca>,
  macKeyVal: <Buffer b5 14 0c 40 65 b0 a4 4e cb 7c d2 eb 4f 53 92 bc c4 06 ad e5 ee 48 13 67 40 e7 a5 12 04 cc 0e 2d>,
  absValidity: 2018-03-21T20:20:33.004Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40200342,
     cipherKeyVal: <Buffer f5 f6 57 00 bf 81 4b 65 bd f5 40 3c 52 f9 a3 ca>,
     macKeyVal: <Buffer b5 14 0c 40 65 b0 a4 4e cb 7c d2 eb 4f 53 92 bc c4 06 ad e5 ee 48 13 67 40 e7 a5 12 04 cc 0e 2d>,
     absValidity: 2018-03-21T20:20:33.004Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 0e cc 57 b2 73 bb 0c 48>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:20:33 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521577233862
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521577292942
connected to auth! from local port 41022
received auth hello!
{ authId: 402, nonce: <Buffer 40 2b 4d cd a5 66 e9 78> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e8 83 a3 13 0f 59 84 6c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200349,
  cipherKeyVal: <Buffer ee 96 22 fa a7 e9 0d e2 5b 2b d4 c0 2d 6e bd 58>,
  macKeyVal: <Buffer c7 0f 76 8f e4 3a 88 1d 5e 7e d0 f7 d3 0b 5c 51 94 b3 5d b9 3e d4 91 46 d6 ef 1d fb 5b 79 c9 d9>,
  absValidity: 2018-03-21T20:21:33.095Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40200349,
     cipherKeyVal: <Buffer ee 96 22 fa a7 e9 0d e2 5b 2b d4 c0 2d 6e bd 58>,
     macKeyVal: <Buffer c7 0f 76 8f e4 3a 88 1d 5e 7e d0 f7 d3 0b 5c 51 94 b3 5d b9 3e d4 91 46 d6 ef 1d fb 5b 79 c9 d9>,
     absValidity: 2018-03-21T20:21:33.095Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer fc 82 85 8f 57 8e dc 88>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:21:33 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521577293935
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521577352999
connected to auth! from local port 41292
received auth hello!
{ authId: 402, nonce: <Buffer 84 a2 bb 4b 0f b2 25 11> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ad 70 a7 22 7f d2 fe 68>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200356,
  cipherKeyVal: <Buffer f3 52 50 d2 38 1e cd d7 00 eb aa 21 8c 2d 92 a6>,
  macKeyVal: <Buffer 03 42 23 93 5d 8e 24 97 52 68 56 23 d5 b4 08 cd bc 7a dd 26 c3 00 09 fb ad 7e f8 2a 1f fa fb 54>,
  absValidity: 2018-03-21T20:22:33.135Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40200356,
     cipherKeyVal: <Buffer f3 52 50 d2 38 1e cd d7 00 eb aa 21 8c 2d 92 a6>,
     macKeyVal: <Buffer 03 42 23 93 5d 8e 24 97 52 68 56 23 d5 b4 08 cd bc 7a dd 26 c3 00 09 fb ad 7e f8 2a 1f fa fb 54>,
     absValidity: 2018-03-21T20:22:33.135Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 98 26 b4 79 9e e5 13 c9>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Tue Mar 20 2018 20:22:33 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 8 1 1521577354080
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 9 0.8888888888888888 1521577413059
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 10 0.8 1521577473069
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 60662
received auth hello!
{ authId: 502, nonce: <Buffer 67 8f 15 0c 70 ea e1 77> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 11 0.7272727272727273 1521577533080
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 60886
received auth hello!
{ authId: 502, nonce: <Buffer b0 c3 34 9c a8 b2 83 97> }
received an Auth alert!
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: received an Auth alert! code: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 12 0.6666666666666666 1521577593090
failure in connection with Auth : authFailureCount: 4
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 13 0.6153846153846154 1521577653098
failure in connection with Auth : authFailureCount: 5
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 1
to: 2
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 55252
received auth hello!
{ authId: 401, nonce: <Buffer c7 1e 65 7b e5 19 55 fc> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth401',
     commonName: '10.0.1.1' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth402',
     commonName: '10.0.0.2' },
  serial: '0162450C1567',
  notBefore: 2018-03-20T20:12:22.000Z,
  notAfter: 2018-03-21T20:14:02.000Z,
  subjectHash: 'de555cae',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '97:90:50:1C:2E:03:3D:1E:43:76:2E:A4:C3:1E:81:EC:97:2A:B6:E6',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'B95EF3029A4C4FAE066EFDE0A6119C37979EDB5A64C834CFDC68175183A2CCB6F817A6CEE1A9EF3E562CF75048E8894B6036030296F313DEBF7C1069E42825C46A5F1F6D69FFE10EE6D73B7805503AA7E6A4C2FF62C2E4D5BF7079FBED00C4B24480D5BC43B7B3B042025990D06DEE0A0388CF2AE7F4B313EF564F2EB3931C44FD1DBD6DFA6DA12843C6DBAAE1EFBC5E7EEDA9407AE6D78B6211169F194056CA6F9CD9F20F33FE469D35BCC944D43D2ECB947F73AF95BB5530BFF2A9B92CA16EB949D06EB8218BBBEC8EA009AC9F6C53C626A2796484448AEDAAB3D19834BA2A19D35D0E105AD47B9A6B3E1589517039E098E992676ED418010E608FA312B251',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.1' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 401,
  host: '10.0.1.1',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJFDBVnMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDIxETAPBgNVBAMMCDEwLjAuMC4yMB4XDTE4MDMy\nMDIwMTIyMloXDTE4MDMyMTIwMTQwMlowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDQwMTERMA8GA1UEAwwIMTAuMC4xLjEwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQC5XvMCmkxPrgZu/eCmEZw3l57bWmTINM/caBdRg6LMtvgXps7h\nqe8+Viz3UEjoiUtgNgMClvMT3r98EGnkKCXEal8fbWn/4Q7m1zt4BVA6p+akwv9i\nwuTVv3B5++0AxLJEgNW8Q7ezsEICWZDQbe4KA4jPKuf0sxPvVk8us5McRP0dvW36\nbaEoQ8bbquHvvF5+7alAeubXi2IRFp8ZQFbKb5zZ8g8z/kadNbzJRNQ9LsuUf3Ov\nlbtVML/yqbksoW65SdBuuCGLu+yOoAmsn2xTxiaieWSERIrtqrPRmDS6KhnTXQ4Q\nWtR7mms+FYlRcDngmOmSZ27UGAEOYI+jErJRAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQEwDQYJKoZIhvcNAQELBQADggEBAFPYLhndfaJ8JaENaTDiVv5w1Eila1LC\nwTNH66NsJtw6iWkVlcboAMGgOlNKJmlUhPyMNF6eIUeQr7SRM/LilDuyugSqOaQb\nyiUxzBlDmcobXLtKfhED8jEEYXIOnikDs6gwrMaZUZEwfw5jZB+4ECvezJLz/ptz\n/uHwA5keFJO9frH0UR6tGNkZK8nBfKHzP2bw/Ke1BVDB82ER8YGniXtB7b4CIE0+\nCJU7eJ1WMiuURSPiNeUijxT5lmax7Gzx19zxF3a6TL2HgI1rLsdanWP/1tTS/NXw\no2yhkP9qVhpUtgqU8c+A+RlaJ+trAKK1Pw83ibielCIPLeHRPV+/pk0=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 2
to: 3
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 14 0.5714285714285714 1521577713105
connected to auth! from local port 55482
received auth hello!
{ authId: 401, nonce: <Buffer 5b cd f5 83 f4 0f f7 b8> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 21 04 43 c5 b2 cf db 0f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 28 20 c1 47 f1 37 ee 0f 55 b1 4a a1 b4 54 fa 52>,
  macKeyVal: <Buffer 93 3b 0e 35 34 7a a1 01 8a 5f 75 81 52 14 3b c8 02 93 c6 d6 22 ae 5e 4f e9 e0 2a de 04 1a 5a 69>,
  absValidity: 2018-03-20T21:28:37.144Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100872,
  cipherKeyVal: <Buffer d5 98 10 f2 89 76 97 b7 cb d9 ae 61 5f 2c 42 49>,
  macKeyVal: <Buffer 96 5d a1 9f 3a 6d 72 a7 8c 2f f4 82 49 dd 9f e8 95 6c 53 e2 cb c4 da 0f 70 e4 7d b3 8f 0b b9 26>,
  absValidity: 2018-03-21T20:28:37.143Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40100872,
     cipherKeyVal: <Buffer d5 98 10 f2 89 76 97 b7 cb d9 ae 61 5f 2c 42 49>,
     macKeyVal: <Buffer 96 5d a1 9f 3a 6d 72 a7 8c 2f f4 82 49 dd 9f e8 95 6c 53 e2 cb c4 da 0f 70 e4 7d b3 8f 0b b9 26>,
     absValidity: 2018-03-21T20:28:37.143Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer b6 99 7c c5 19 83 2a bf>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.13:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 15 0.5333333333333333 1521577773109
connected to auth! from local port 55732
received auth hello!
{ authId: 401, nonce: <Buffer ff 64 0e 9e 09 8f 79 08> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 74 cb 42 e2 2a 83 9d 83>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100882,
  cipherKeyVal: <Buffer d5 a1 15 63 60 d2 01 fa 71 fe 78 49 94 e4 98 bb>,
  macKeyVal: <Buffer 6e c4 b2 10 83 12 01 c4 84 67 51 44 78 74 15 38 30 5c a3 7c b4 7e e2 18 c3 b3 75 13 04 31 fc 7a>,
  absValidity: 2018-03-21T20:29:40.685Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40100882,
     cipherKeyVal: <Buffer d5 a1 15 63 60 d2 01 fa 71 fe 78 49 94 e4 98 bb>,
     macKeyVal: <Buffer 6e c4 b2 10 83 12 01 c4 84 67 51 44 78 74 15 38 30 5c a3 7c b4 7e e2 18 c3 b3 75 13 04 31 fc 7a>,
     absValidity: 2018-03-21T20:29:40.685Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer e6 ca e0 0d e7 9a 14 28>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.13:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 16 0.5 1521577833111
connected to auth! from local port 55982
received auth hello!
{ authId: 401, nonce: <Buffer 45 f8 f0 d8 48 0a 28 3b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c2 aa d9 c2 76 61 a7 38>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100892,
  cipherKeyVal: <Buffer 46 eb d5 f4 63 52 da 98 d4 a6 90 f5 69 e2 34 5b>,
  macKeyVal: <Buffer 85 30 43 40 8a 0e 7f 63 1f bd 9f 09 81 8a 61 e1 91 2b 4d c7 5b 56 3f 9d 94 aa 72 3d 7d 59 c7 47>,
  absValidity: 2018-03-21T20:30:36.966Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40100892,
     cipherKeyVal: <Buffer 46 eb d5 f4 63 52 da 98 d4 a6 90 f5 69 e2 34 5b>,
     macKeyVal: <Buffer 85 30 43 40 8a 0e 7f 63 1f bd 9f 09 81 8a 61 e1 91 2b 4d c7 5b 56 3f 9d 94 aa 72 3d 7d 59 c7 47>,
     absValidity: 2018-03-21T20:30:36.966Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 19 51 fe 62 9d 66 5c 50>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.13:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 17 0.47058823529411764 1521577893118
connected to auth! from local port 56226
received auth hello!
{ authId: 401, nonce: <Buffer a7 c6 a5 d9 e8 a9 8d b3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a9 ec 74 83 ff 57 b0 9d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40100901,
  cipherKeyVal: <Buffer ad d5 0c f2 97 16 12 c9 83 6f 57 fe be ea 60 4e>,
  macKeyVal: <Buffer 35 ab a5 ce f0 54 a8 c9 f7 95 28 5b f2 8e a4 d3 47 44 97 c3 9d dd e5 43 81 1b e1 2e e7 57 85 60>,
  absValidity: 2018-03-21T20:31:40.871Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.13',
  serverPort: 22100,
  sessionKey: 
   { id: 40100901,
     cipherKeyVal: <Buffer ad d5 0c f2 97 16 12 c9 83 6f 57 fe be ea 60 4e>,
     macKeyVal: <Buffer 35 ab a5 ce f0 54 a8 c9 f7 95 28 5b f2 8e a4 d3 47 44 97 c3 9d dd e5 43 81 1b e1 2e e7 57 85 60>,
     absValidity: 2018-03-21T20:31:40.871Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 6e 1f 6d 06 91 14 74 f0>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.13:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 18 0.4444444444444444 1521577953121
connected to auth! from local port 56470
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 19 0.42105263157894735 1521578013121
connected to auth! from local port 56638
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 20 0.4 1521578073129
connected to auth! from local port 56804
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 21 0.38095238095238093 1521578133139
connected to auth! from local port 56968
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 22 0.36363636363636365 1521578193149
connected to auth! from local port 57136
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 23 0.34782608695652173 1521578253159
connected to auth! from local port 57304
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 24 0.3333333333333333 1521578313169
connected to auth! from local port 57462
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 25 0.32 1521578373179
connected to auth! from local port 57628
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 26 0.3076923076923077 1521578433190
connected to auth! from local port 57792
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 27 0.2962962962962963 1521578493193
connected to auth! from local port 57956
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 28 0.2857142857142857 1521578553204
connected to auth! from local port 58122
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 29 0.27586206896551724 1521578613213
connected to auth! from local port 58284
