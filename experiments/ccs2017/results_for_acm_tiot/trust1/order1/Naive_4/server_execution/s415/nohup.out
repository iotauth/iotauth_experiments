changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s415.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's415',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 6f 70 ... > }
Handler: listening on port 22100
s415:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300507
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37826
received auth hello!
{ authId: 403, nonce: <Buffer 17 fa ea aa 98 fa 03 03> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer a4 52 be b2 b0 5f ee 83>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 2f 6a d9 40 ce fa ce e4 20 ad be 75 80 04 79 e3>,
  macKeyVal: <Buffer 73 7e e3 e5 db 33 16 29 9b 6f d5 37 74 db a6 18 a9 87 5c c1 b9 6a a7 df 03 64 03 13 b8 0d 5d f4>,
  absValidity: 2018-03-20T21:16:03.148Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c5 2f 4c 66 35 c7 6c 96>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c5 2f 4c 66 35 c7 6c 96> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.59:58800',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300513
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38036
received auth hello!
{ authId: 403, nonce: <Buffer 91 36 3f ab 81 23 f5 8a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4f 37 fa 55 50 ab d9 b6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7f 74 a7 56 7c e8 7b 72>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 7f 74 a7 56 7c e8 7b 72> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.59:59008',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300519
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38306
received auth hello!
{ authId: 403, nonce: <Buffer af 0f aa 77 5d 7f 43 9a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c1 03 70 24 40 bf ec 5d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a1 95 8b 40 11 19 83 a8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a1 95 8b 40 11 19 83 a8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.59:59278',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300525
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38576
received auth hello!
{ authId: 403, nonce: <Buffer 16 99 b1 30 1c e2 0d e8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 23 97 63 b6 9c 9a 8e 9b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 23 81 e7 90 68 9a b3 f1>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 23 81 e7 90 68 9a b3 f1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.59:59550',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300531
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38846
received auth hello!
{ authId: 403, nonce: <Buffer eb da 6f b3 5f 21 f2 c1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 63 4d 56 83 18 70 75 6e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 47 d0 fc 7e 28 ee eb 7f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 47 d0 fc 7e 28 ee eb 7f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.59:59818',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300537
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39116
received auth hello!
{ authId: 403, nonce: <Buffer f2 77 db 73 db 45 52 7b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer de 02 af 91 15 fb 10 2c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3c 82 ce 32 16 ea 1f 9b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 3c 82 ce 32 16 ea 1f 9b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.59:60088',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300543
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39386
received auth hello!
{ authId: 403, nonce: <Buffer 1f d2 82 01 36 e4 48 d8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9c f3 dc 6a 10 97 4f ba>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c9 e1 ac bb 22 94 0f d7>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c9 e1 ac bb 22 94 0f d7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.59:60358',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300549
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39648
received auth hello!
{ authId: 403, nonce: <Buffer b7 3b 19 a1 27 1c 5e f3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5d 5d 65 6d 5d d2 ea 5f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6f e4 27 59 61 81 28 3a>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 6f e4 27 59 61 81 28 3a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.59:60620',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
