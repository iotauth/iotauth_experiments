changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s411.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's411',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 78 38 ... > }
Handler: listening on port 22100
s411:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100782
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49808
received auth hello!
{ authId: 403, nonce: <Buffer 18 7d b6 3e 24 f3 55 2f> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 50 22 1a f1 8f 88 b3 0d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer f3 31 c1 35 28 59 de 6c 47 1a 4e 55 03 85 8a dc>,
  macKeyVal: <Buffer 7b 50 59 55 57 24 53 bd cd 8b de 81 a3 cc c2 bc 9d a2 6c 7c bf e2 82 0b 7b d7 b1 ec 4b e4 71 8f>,
  absValidity: 2018-03-20T21:15:17.229Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5c 68 b9 de a8 0a de 90>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5c 68 b9 de a8 0a de 90> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.45:51934',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100788
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49934
received auth hello!
{ authId: 403, nonce: <Buffer 98 f1 0c 3e db ee 3a 59> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f5 34 16 08 f8 0a 97 58>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f3 d0 67 f4 d2 dd a4 90>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f3 d0 67 f4 d2 dd a4 90> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.45:52060',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100794
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50168
received auth hello!
{ authId: 403, nonce: <Buffer a6 7b 04 33 a2 41 0b ec> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2f 56 ea 8d 65 90 7c 01>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0a 27 0d ef f9 eb 9d 0e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0a 27 0d ef f9 eb 9d 0e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.45:52294',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100800
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50438
received auth hello!
{ authId: 403, nonce: <Buffer 2f 02 4c 21 8a 2b 5c 3d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 65 a3 c9 44 61 75 83 1d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c3 cb 7b a0 7b d6 12 19>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c3 cb 7b a0 7b d6 12 19> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.45:52564',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100806
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50708
received auth hello!
{ authId: 403, nonce: <Buffer aa 01 56 e7 e3 38 66 49> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 85 e2 24 28 e4 3c fd be>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 88 87 7e 74 ba c9 bf de>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 88 87 7e 74 ba c9 bf de> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.45:52834',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100812
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50978
received auth hello!
{ authId: 403, nonce: <Buffer ab 60 4c 34 4a 71 0b c8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer dd 67 d1 a9 9b ad 36 84>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e9 3d c8 ca b5 84 6c 7f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e9 3d c8 ca b5 84 6c 7f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.45:53104',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100818
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51248
received auth hello!
{ authId: 403, nonce: <Buffer f7 40 09 69 4c a1 f1 38> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 88 d9 cf dd 63 0b c6 a5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 13 e5 ef 3c ff 3e a3 91>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 13 e5 ef 3c ff 3e a3 91> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.45:53374',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100824
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51518
received auth hello!
{ authId: 403, nonce: <Buffer 02 7b 4f aa 6b af 9b 60> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fd da 5d 14 fb 42 8a 9a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 19 ae 3a 37 94 a4 da d5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 19 ae 3a 37 94 a4 da d5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.45:53644',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100830
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect ECONNREFUSED 10.0.1.3:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100836
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.3:21100
Handler: Error in server - details: handshake2 timed out...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in server - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in server - details: Error occurred in migration request: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100842
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.3:21100
connected to auth! from local port 33204
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 401, nonce: <Buffer b1 7f 05 5c 3a ac 1c 90> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth401',
     commonName: '10.0.1.1' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth403',
     commonName: '10.0.0.3' },
  serial: '0162450C17A4',
  notBefore: 2018-03-20T20:12:23.000Z,
  notAfter: 2018-03-21T20:14:03.000Z,
  subjectHash: 'de555cae',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'FF:24:37:6E:33:89:4B:8C:ED:E6:E1:A4:DC:1D:97:97:72:01:96:7A',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'B95EF3029A4C4FAE066EFDE0A6119C37979EDB5A64C834CFDC68175183A2CCB6F817A6CEE1A9EF3E562CF75048E8894B6036030296F313DEBF7C1069E42825C46A5F1F6D69FFE10EE6D73B7805503AA7E6A4C2FF62C2E4D5BF7079FBED00C4B24480D5BC43B7B3B042025990D06DEE0A0388CF2AE7F4B313EF564F2EB3931C44FD1DBD6DFA6DA12843C6DBAAE1EFBC5E7EEDA9407AE6D78B6211169F194056CA6F9CD9F20F33FE469D35BCC944D43D2ECB947F73AF95BB5530BFF2A9B92CA16EB949D06EB8218BBBEC8EA009AC9F6C53C626A2796484448AEDAAB3D19834BA2A19D35D0E105AD47B9A6B3E1589517039E098E992676ED418010E608FA312B251',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.1' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 401,
  host: '10.0.1.1',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJFDBekMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDMxETAPBgNVBAMMCDEwLjAuMC4zMB4XDTE4MDMy\nMDIwMTIyM1oXDTE4MDMyMTIwMTQwM1owYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDQwMTERMA8GA1UEAwwIMTAuMC4xLjEwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQC5XvMCmkxPrgZu/eCmEZw3l57bWmTINM/caBdRg6LMtvgXps7h\nqe8+Viz3UEjoiUtgNgMClvMT3r98EGnkKCXEal8fbWn/4Q7m1zt4BVA6p+akwv9i\nwuTVv3B5++0AxLJEgNW8Q7ezsEICWZDQbe4KA4jPKuf0sxPvVk8us5McRP0dvW36\nbaEoQ8bbquHvvF5+7alAeubXi2IRFp8ZQFbKb5zZ8g8z/kadNbzJRNQ9LsuUf3Ov\nlbtVML/yqbksoW65SdBuuCGLu+yOoAmsn2xTxiaieWSERIrtqrPRmDS6KhnTXQ4Q\nWtR7mms+FYlRcDngmOmSZ27UGAEOYI+jErJRAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQEwDQYJKoZIhvcNAQELBQADggEBADd0sETcsmRWBNs9yIKAX+TioNFDcmxj\nYt8mipEs7UOrY4uUFFOtPUAXbsL4lp4awlpBsw2fry2kv7UnSrbuO778ajBqn0RG\nIEPQ6fwXhQcxwJ3VhN4+HT0Uko3mEAu8lEDStAsW6RspBmk+8T2i2kdK+ojY/mxe\njiVsevPvM1ukUD4nAGtjjl6kth3JfEsiatiVwcndJT0c6OSuPk1jD7RBmiyD/uZ5\nEUP8RrMtdeXx2rIzyZgQwoahcUZg3A9cHV5tu74zef0fH7ZSHUQUPW+IfkV+5ZAB\naIpwAq12sd0Ix5w8k7QGJs1RDe+ibCp3ys/t5Vfv8ykQ2CAggVZo5IA=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 1
to: 2
disconnected from auth
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100850
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33414
received auth hello!
{ authId: 401, nonce: <Buffer 99 18 ed b5 c0 e3 aa 99> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer d3 d5 70 3c b5 fb b4 fd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer b3 af 7c d6 1e 47 c8 e9 7d 17 78 1a 7e 44 39 b9>,
  macKeyVal: <Buffer 54 03 02 61 41 96 86 ef b6 49 d5 f5 cb 54 75 8d 3e 0b 98 c1 13 45 7b ef 7a 73 87 5f aa 97 61 99>,
  absValidity: 2018-03-20T21:26:17.890Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 83 fe b4 14 d2 f4 ed 65>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 83 fe b4 14 d2 f4 ed 65> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.45:54504',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100858
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33638
received auth hello!
{ authId: 401, nonce: <Buffer dc fa 7f 51 c0 f5 61 17> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 75 c1 22 93 23 99 e6 ef>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9e 9b 3f b3 be 5f cd b3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9e 9b 3f b3 be 5f cd b3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.45:54728',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100866
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33872
received auth hello!
{ authId: 401, nonce: <Buffer 99 54 62 e1 a2 05 b5 dd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 75 7a bd 1f f7 24 ea 43>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 47 72 65 b3 c2 1f fb 9e>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 47 72 65 b3 c2 1f fb 9e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.45:54962',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100876
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34106
received auth hello!
{ authId: 401, nonce: <Buffer 23 cc 78 4c 7d ef 0a 73> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6c fd 61 d8 28 a2 df 2f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ac 84 e2 8d 7a 8d 25 ad>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ac 84 e2 8d 7a 8d 25 ad> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.45:55196',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100885
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34354
received auth hello!
{ authId: 401, nonce: <Buffer 17 ec 1c 86 0e cf 05 8a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b0 ef 65 a0 d9 04 e5 e2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 83 7d 19 c3 32 b6 f2 ad>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 83 7d 19 c3 32 b6 f2 ad> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.45:55444',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100895
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34608
received auth hello!
{ authId: 401, nonce: <Buffer f1 69 c9 d2 e2 c6 80 3f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 56 12 96 98 eb 33 13 12>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 82 8f 64 16 3c 3d 5e 95>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 82 8f 64 16 3c 3d 5e 95> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.45:55698',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100906
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34858
received auth hello!
{ authId: 401, nonce: <Buffer 8d e5 16 99 85 ba 30 f5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 19 3b 0a 65 8b 47 ec 5c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c0 b6 f9 29 bb 99 80 aa>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c0 b6 f9 29 bb 99 80 aa> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.45:55948',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100916
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35046
received auth hello!
{ authId: 401, nonce: <Buffer 63 98 56 ae 28 4d 99 65> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5f 66 ad 19 0b 61 c7 9d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 19 9e 0f a4 66 4c 9b 86>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 19 9e 0f a4 66 4c 9b 86> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.45:56136',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100927
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35212
received auth hello!
{ authId: 401, nonce: <Buffer 0c d7 3d 35 78 3e 8f 02> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ea 65 fb c3 d9 5e ea c7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 02 77 6e c4 6b 70 52 b8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 02 77 6e c4 6b 70 52 b8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.45:56302',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100938
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35378
received auth hello!
{ authId: 401, nonce: <Buffer a3 04 01 50 a1 a6 cc 82> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 58 30 e0 f5 b0 9b 90 d5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ba 30 de 95 13 15 96 82>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ba 30 de 95 13 15 96 82> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.45:56468',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100949
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35544
received auth hello!
{ authId: 401, nonce: <Buffer 99 8e 75 d6 ce c9 8c 8f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 90 e2 c5 f7 14 27 37 dd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 98 b2 a1 7b ac 91 a8 65>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 98 b2 a1 7b ac 91 a8 65> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.45:56634',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100960
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35710
received auth hello!
{ authId: 401, nonce: <Buffer b9 d7 e5 52 1d 03 42 2f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a2 a1 3f a7 6d f5 94 70>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a2 94 87 e6 11 ec 32 48>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer a2 94 87 e6 11 ec 32 48> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.45:56800',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100970
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35870
received auth hello!
{ authId: 401, nonce: <Buffer 51 e4 8c 3a ba 94 14 74> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 84 54 65 0a 7a 59 50 2b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4b 48 b9 a6 88 f0 59 c4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4b 48 b9 a6 88 f0 59 c4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.45:56960',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100981
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36036
received auth hello!
{ authId: 401, nonce: <Buffer ba 66 d1 8b f7 6e a9 42> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f7 6b e8 b5 fe f3 33 9f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 81 03 37 4d 6a 0e 33 bd>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 81 03 37 4d 6a 0e 33 bd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.45:57126',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40100992
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36202
received auth hello!
{ authId: 401, nonce: <Buffer 6c ff a0 69 4e 99 27 98> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f1 81 ad 2a 46 e0 f2 77>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 58 e7 d4 d2 0c 15 37 a9>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 58 e7 d4 d2 0c 15 37 a9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.45:57292',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101003
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36368
received auth hello!
{ authId: 401, nonce: <Buffer bf ab 7e 0b 59 28 c2 65> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3c 5a 01 f8 fb 39 2f fa>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e3 94 1b 6f 1f 51 6c 1c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e3 94 1b 6f 1f 51 6c 1c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.45:57458',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101014
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36534
received auth hello!
{ authId: 401, nonce: <Buffer 7e ee 8f 8d c9 25 38 8f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e4 ed fb 55 ac bf 67 44>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ac 4d ba bb 14 12 78 79>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ac 4d ba bb 14 12 78 79> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 24,
  remoteAddress: '::ffff:10.0.1.45:57624',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 24 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 24 }
specified socketID: 24
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #24 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40101025
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36698
received auth hello!
{ authId: 401, nonce: <Buffer 23 96 87 de ad 58 f5 d2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 48 76 b8 8f c3 bd c1 67>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 81 05 c9 df a4 c6 33 01>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 81 05 c9 df a4 c6 33 01> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 25,
  remoteAddress: '::ffff:10.0.1.45:57788',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 25 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 25 }
specified socketID: 25
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #25 closed
