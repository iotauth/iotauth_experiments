changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s407.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's407',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 6f 66 ... > }
Handler: listening on port 22100
s407:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200889
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48932
received auth hello!
{ authId: 402, nonce: <Buffer fc b0 17 57 ab 3b b0 32> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 86 ad 17 09 53 87 f4 69>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 84 98 80 39 f2 6b fa c0 7f 00 f9 1e 26 a6 0f 18>,
  macKeyVal: <Buffer 64 50 cc 55 32 02 ab 10 a0 79 6e 4e 13 99 fc 6d 7e 38 78 17 6a f2 58 c6 b7 9d 05 7d ae 2d 3f f8>,
  absValidity: 2018-03-22T01:54:30.973Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2d 73 f0 92 8b ef ad 2e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2d 73 f0 92 8b ef ad 2e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.51:49328',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200896
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49094
received auth hello!
{ authId: 402, nonce: <Buffer 3a 04 00 73 77 c1 29 72> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 93 b6 36 96 80 d9 b2 11>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 87 25 ef 49 bf 14 9f 29>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 87 25 ef 49 bf 14 9f 29> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.51:49490',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200903
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49362
received auth hello!
{ authId: 402, nonce: <Buffer cb 5f 98 6f fb ff 5e e7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fd 69 4d 8e 9e 10 72 dd>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bc 46 73 a2 a9 9c da 45>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bc 46 73 a2 a9 9c da 45> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.51:49758',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200910
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49632
received auth hello!
{ authId: 402, nonce: <Buffer 9f f5 87 ac 7c 35 45 e3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 35 ef 7f eb 33 06 c7 c7>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a5 f1 25 46 9b 70 85 a1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a5 f1 25 46 9b 70 85 a1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.51:50028',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200917
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49902
received auth hello!
{ authId: 402, nonce: <Buffer c9 b3 ee 21 72 3e d0 42> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 71 20 e2 87 e8 b7 3a de>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 80 ff f7 6c 72 35 c1 cb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 80 ff f7 6c 72 35 c1 cb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.51:50298',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200924
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50172
received auth hello!
{ authId: 402, nonce: <Buffer de a3 4c ce 5c 9c 0a 29> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 74 7a 4e 87 86 ea 4b 5f>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 57 aa 9f 8a c4 4e 47 5f>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 57 aa 9f 8a c4 4e 47 5f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.51:50568',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200931
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50442
received auth hello!
{ authId: 402, nonce: <Buffer 42 e5 b2 2a 5a 8a 86 34> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f5 23 cb 4b f9 47 55 18>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8b c3 7d 4e e7 d7 f7 ca>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8b c3 7d 4e e7 d7 f7 ca> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.51:50838',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200938
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50712
received auth hello!
{ authId: 402, nonce: <Buffer cb 67 f9 a0 b1 60 42 4b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer aa ce cd 55 59 62 a1 35>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f0 97 cd 0d 08 ca 08 f0>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f0 97 cd 0d 08 ca 08 f0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.51:51108',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
