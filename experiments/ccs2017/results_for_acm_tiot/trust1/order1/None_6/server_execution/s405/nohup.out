changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s405.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's405',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 74 59 ... > }
Handler: listening on port 22100
s405:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200887
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56596
received auth hello!
{ authId: 402, nonce: <Buffer 25 f8 6f 2a 22 42 f9 94> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer af 40 fa bd bc a9 51 fc>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer ff a8 cb 29 6f c6 49 fe 22 ae 95 6a bd 9d dd f4>,
  macKeyVal: <Buffer d1 be bd 32 a8 81 6a 4b b3 6d 44 c8 93 49 69 ec 19 32 a5 0a 7b 16 ec 5b 9a 15 75 5c 4a 71 fe a6>,
  absValidity: 2018-03-22T01:54:24.508Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7a e9 9d 96 11 86 13 2f>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 7a e9 9d 96 11 86 13 2f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.49:39090',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200894
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56746
received auth hello!
{ authId: 402, nonce: <Buffer 35 d8 23 f1 eb dc e5 c3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0e 32 97 10 c3 a0 71 92>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8d 23 0b 52 1d 1f cb fb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8d 23 0b 52 1d 1f cb fb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.49:39240',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200901
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57002
received auth hello!
{ authId: 402, nonce: <Buffer fc c0 ff c4 60 62 5a 08> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 30 88 3e 41 90 48 0a a0>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2f 5c af 0e b2 ba 48 8f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2f 5c af 0e b2 ba 48 8f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.49:39496',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200908
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57272
received auth hello!
{ authId: 402, nonce: <Buffer af e6 cc ee 38 52 d7 b4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d1 24 dd 5e 7a 43 55 fd>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 32 89 ad 68 d1 ae ba e4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 32 89 ad 68 d1 ae ba e4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.49:39766',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200915
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57542
received auth hello!
{ authId: 402, nonce: <Buffer de 6b 30 af 24 02 a7 23> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a2 1e b2 d7 c8 e8 ec 53>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 72 c0 ba c0 1c 20 b6 f8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 72 c0 ba c0 1c 20 b6 f8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.49:40036',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200922
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57812
received auth hello!
{ authId: 402, nonce: <Buffer 3c 2a 9c cb 07 c4 3e 91> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fb 05 80 73 3e e7 e8 7b>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e2 56 81 30 fb 69 c3 cc>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e2 56 81 30 fb 69 c3 cc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.49:40306',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200929
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58082
received auth hello!
{ authId: 402, nonce: <Buffer c0 33 70 99 4f 6e 87 91> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3c 9f ce 52 1e 45 89 38>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f1 e4 00 33 7d 87 37 1e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f1 e4 00 33 7d 87 37 1e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.49:40576',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200936
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58352
received auth hello!
{ authId: 402, nonce: <Buffer e9 25 7c ed dd 8f 41 28> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cd 23 bd 8d cd 11 58 9d>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 88 1f e8 48 af ad 77 93>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 88 1f e8 48 af ad 77 93> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.49:40846',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
