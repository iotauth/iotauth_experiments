changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s514.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's514',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 51 49 42 41 41 4b 43 41 51 45 41 77 53 ... > }
Handler: listening on port 22100
s514:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301512
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55978
received auth hello!
{ authId: 503, nonce: <Buffer cc 23 af 63 eb a6 9b 98> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer d8 73 0d b4 7e e7 4e 0d>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer ce 33 d5 64 88 13 eb 8d 65 dc 93 70 b1 8f fe 53>,
  macKeyVal: <Buffer 96 68 94 61 dc 21 70 c8 4e db 89 68 63 8b 0c ff ba bf ee b1 e4 cb cb 43 7c 21 56 7e f9 b2 7e 8b>,
  absValidity: 2018-03-22T01:56:06.741Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f1 c9 ed 5e ae 3c 18 c7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f1 c9 ed 5e ae 3c 18 c7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.80:59188',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301517
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56248
received auth hello!
{ authId: 503, nonce: <Buffer 55 ce cb 08 0b 51 ae 52> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3a c5 23 58 3e 84 75 9e>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e4 f5 36 40 02 d9 24 42>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e4 f5 36 40 02 d9 24 42> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.80:59458',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301522
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56518
received auth hello!
{ authId: 503, nonce: <Buffer 32 b9 f2 c6 f5 2c f0 de> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a5 66 85 d7 f9 d2 d6 d1>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 34 38 46 e9 4a 60 d7 9b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 34 38 46 e9 4a 60 d7 9b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.80:59728',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301527
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56788
received auth hello!
{ authId: 503, nonce: <Buffer 3d cc 97 7d be 10 f1 e5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b6 ec 47 31 e6 bf 56 16>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fc 6a d3 99 34 14 2e 82>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fc 6a d3 99 34 14 2e 82> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.80:59998',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301532
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57058
received auth hello!
{ authId: 503, nonce: <Buffer 32 ea de 18 3a 44 1b 4d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f6 5a 9f 57 93 46 e8 5a>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6e 77 52 53 e8 da 61 b7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6e 77 52 53 e8 da 61 b7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.80:60268',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301537
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57328
received auth hello!
{ authId: 503, nonce: <Buffer 03 a7 71 97 de 12 26 34> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 18 49 55 48 d5 4f 1b 76>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 83 49 91 37 2a 1a f3 7f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 83 49 91 37 2a 1a f3 7f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.80:60538',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301542
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57594
received auth hello!
{ authId: 503, nonce: <Buffer ca 09 4a b6 f9 8a 02 d1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ac 92 3c 4f dd a4 75 76>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4c 6c e8 21 bf 50 59 d8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4c 6c e8 21 bf 50 59 d8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.80:60804',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
