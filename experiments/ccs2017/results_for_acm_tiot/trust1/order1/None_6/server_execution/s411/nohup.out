changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s411.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's411',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 79 45 ... > }
Handler: listening on port 22100
s411:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40102159
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35750
received auth hello!
{ authId: 403, nonce: <Buffer 23 f1 73 ba 2b e7 4f 7e> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 46 c6 37 5a 59 df d0 97>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 8b 0d fc d6 c4 7d b1 83 45 7e f3 b0 2b 00 4b 16>,
  macKeyVal: <Buffer 5b 80 39 62 c8 6e 6c df 6a ea f7 94 68 f2 19 7c e0 44 8e 9c 8b 08 7b 02 38 01 5b 2f 47 fb c7 4b>,
  absValidity: 2018-03-22T01:54:11.764Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fc 19 b9 bf 52 b6 30 02>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer fc 19 b9 bf 52 b6 30 02> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.45:37876',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40102165
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35878
received auth hello!
{ authId: 403, nonce: <Buffer b3 96 37 e3 11 e9 9c 09> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 60 50 30 e2 4e 0d 6d dc>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ae 1d d0 0e bf 82 73 26>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ae 1d d0 0e bf 82 73 26> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.45:38004',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40102171
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36114
received auth hello!
{ authId: 403, nonce: <Buffer db e9 2a d4 e8 4e ca 02> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 56 99 e8 8f 8b c3 b6 f0>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2b e0 b6 89 c5 a9 81 2c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2b e0 b6 89 c5 a9 81 2c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.45:38240',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40102177
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36384
received auth hello!
{ authId: 403, nonce: <Buffer 14 79 47 e2 2e 73 37 6b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 08 4e 3c ae 77 e7 53 c2>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 53 9f bf 0d ea 9f 7e b4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 53 9f bf 0d ea 9f 7e b4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.45:38510',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40102183
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36654
received auth hello!
{ authId: 403, nonce: <Buffer 94 d0 81 f1 45 9a f3 af> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4c 4d 90 91 49 52 19 8e>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 99 f3 11 b7 f6 ef 85 04>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 99 f3 11 b7 f6 ef 85 04> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.45:38780',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40102189
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36924
received auth hello!
{ authId: 403, nonce: <Buffer e3 09 3d ab f5 88 be 27> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e7 1e 72 6b c1 88 83 85>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 52 99 1e 13 4e 8b c7 f7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 52 99 1e 13 4e 8b c7 f7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.45:39050',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40102195
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37194
received auth hello!
{ authId: 403, nonce: <Buffer ef 3f 5a cc f1 27 94 ac> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 58 b1 87 c2 e1 3e d2 75>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 28 8c e2 52 75 dc 30 38>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 28 8c e2 52 75 dc 30 38> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.45:39320',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40102201
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37464
received auth hello!
{ authId: 403, nonce: <Buffer 8c da 45 10 76 a4 25 f8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b9 27 7e 12 09 8f f1 69>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 48 e6 65 01 6b 9b f2 40>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 48 e6 65 01 6b 9b f2 40> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.45:39590',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40102207
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
Handler: Error in server - details: Error occurred in session key request: Error: connect ECONNREFUSED 10.0.1.3:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
