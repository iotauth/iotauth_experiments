changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s416.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's416',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 51 49 42 41 41 4b 43 41 51 45 41 35 7a ... > }
Handler: listening on port 22100
s416:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301341
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59708
received auth hello!
{ authId: 403, nonce: <Buffer ff b4 59 fe 2e b6 1a 91> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer a9 4d a4 00 9f 35 58 27>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 8f c5 dd 48 be a4 ef 0a 14 b0 32 67 dc 8b 19 14>,
  macKeyVal: <Buffer 7d 74 a4 34 e8 d0 ce 26 21 22 98 91 54 06 e2 9d b5 70 a9 3d 03 36 c7 0f 2e 2b 7a a6 d0 6f 46 df>,
  absValidity: 2018-03-22T01:55:01.717Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c9 3a dd 82 bf 1b d3 09>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c9 3a dd 82 bf 1b d3 09> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.60:35208',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301342
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59714
received auth hello!
{ authId: 403, nonce: <Buffer 7b 47 25 b7 f4 b0 5d 27> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 29 fb bb 90 b1 b6 cb 22>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 50 cc 40 ca cb 86 4d 8b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 50 cc 40 ca cb 86 4d 8b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.61:57770',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301347
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59920
received auth hello!
{ authId: 403, nonce: <Buffer d8 07 32 6e bf 3a 23 7e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 38 d8 02 bc 2f 7c f7 41>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9a 5c d8 6a fe 80 4d 8e>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 9a 5c d8 6a fe 80 4d 8e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.60:35420',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301348
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59936
received auth hello!
{ authId: 403, nonce: <Buffer fc 81 e9 4c 3f 8d c6 07> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 34 21 dc 3f 65 81 74 36>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 80 4b 08 0d 40 75 2f 48>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 80 4b 08 0d 40 75 2f 48> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.61:57992',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301353
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60192
received auth hello!
{ authId: 403, nonce: <Buffer 24 50 eb 92 ec 1a 77 48> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7d 7b b4 11 74 df c8 a4>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 63 25 32 28 2e 52 23 59>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 63 25 32 28 2e 52 23 59> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.60:35692',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301354
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60208
received auth hello!
{ authId: 403, nonce: <Buffer 33 2a 1b 00 4c 61 18 5b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer dc de 0e 90 fd d5 2f 8b>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 43 24 9b b3 83 fb 5c ae>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 43 24 9b b3 83 fb 5c ae> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.61:58264',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301359
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60462
received auth hello!
{ authId: 403, nonce: <Buffer 0c 5d 58 3f cb ea 27 22> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b4 ef 04 13 d0 5c 01 32>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6e 05 23 9d 9d 65 89 3d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6e 05 23 9d 9d 65 89 3d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.60:35962',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301360
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60478
received auth hello!
{ authId: 403, nonce: <Buffer 05 16 ae 19 1b 7c 0c ba> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2f ef 63 a9 bf d8 7c 5e>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 67 18 86 90 58 ee 74 cc>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 67 18 86 90 58 ee 74 cc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.61:58534',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301365
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60732
received auth hello!
{ authId: 403, nonce: <Buffer 6b ed 4a 74 b2 1a 02 1d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ef 19 eb df 10 6d 6a e5>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b9 7b dd 3a 8b a3 84 73>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b9 7b dd 3a 8b a3 84 73> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.60:36232',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301366
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60748
received auth hello!
{ authId: 403, nonce: <Buffer 79 35 2f 22 84 6a de f0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 28 9b 23 19 8c c9 ec d9>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 06 02 00 09 a7 f1 90 6b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 06 02 00 09 a7 f1 90 6b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.61:58804',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301371
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 32770
received auth hello!
{ authId: 403, nonce: <Buffer 1b aa 9f aa 95 f8 61 9b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 07 72 5c 1c 51 b8 3d 27>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 11 d0 c0 45 81 14 11 e7>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 11 d0 c0 45 81 14 11 e7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.60:36502',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301372
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 32786
received auth hello!
{ authId: 403, nonce: <Buffer f3 f7 f0 d3 41 9b 55 16> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 21 d9 44 cd 18 d8 45 d5>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 94 f5 ce 25 0c 8d 10 bb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 94 f5 ce 25 0c 8d 10 bb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.61:59074',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301377
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33040
received auth hello!
{ authId: 403, nonce: <Buffer 76 e3 20 ad 92 0a a9 7f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d2 bd 4c fe 0d 87 23 98>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b7 a0 31 21 72 f6 79 81>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b7 a0 31 21 72 f6 79 81> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.60:36772',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301378
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33056
received auth hello!
{ authId: 403, nonce: <Buffer c7 2d 1d b1 ca 36 db 1b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b9 95 fa 44 77 8a c6 1b>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7f a0 81 55 b9 55 ac 73>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 7f a0 81 55 b9 55 ac 73> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.61:59344',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301383
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33306
received auth hello!
{ authId: 403, nonce: <Buffer c6 a2 f0 cc 5b 23 61 33> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0b 6c 11 00 9a e1 8c e6>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d0 08 7f e5 32 11 63 f0>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer d0 08 7f e5 32 11 63 f0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.60:37038',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301384
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
Handler: Error in server - details: Error occurred in session key request: Error: connect ECONNREFUSED 10.0.1.3:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
