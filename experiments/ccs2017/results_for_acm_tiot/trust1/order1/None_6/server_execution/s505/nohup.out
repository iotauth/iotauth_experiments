changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s505.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's505',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 71 79 ... > }
Handler: listening on port 22100
s505:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101318
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60854
received auth hello!
{ authId: 501, nonce: <Buffer a8 45 82 b8 79 cb fa 7d> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer f7 d8 72 3d f8 ec a3 07>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 14 7a 93 a4 ed 54 c7 ad 86 f8 3d 2a 5d 44 a5 08>,
  macKeyVal: <Buffer ff 6e 23 b1 30 76 35 1e cd e8 eb aa 67 07 ab 9d b3 48 b7 52 60 c6 4a 9e 40 b2 fb 36 13 81 7c b3>,
  absValidity: 2018-03-22T01:55:26.736Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 59 96 5b 66 09 07 47 f3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 59 96 5b 66 09 07 47 f3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.68:60140',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101319
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60866
received auth hello!
{ authId: 501, nonce: <Buffer f6 7e 74 94 2d 57 78 60> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b7 d9 b5 aa 7b 85 bc 0e>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 02 5d 0c 65 2d 5a ac 2f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 02 5d 0c 65 2d 5a ac 2f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.69:48812',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101326
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 32884
received auth hello!
{ authId: 501, nonce: <Buffer f9 6e ca 32 10 5c be 0c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 23 94 08 01 90 93 e2 db>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f2 94 1d d8 bf a5 16 25>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f2 94 1d d8 bf a5 16 25> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.68:60402',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101327
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 32902
received auth hello!
{ authId: 501, nonce: <Buffer dd 65 fd a9 ab c6 34 9f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b3 58 f5 6e 51 d6 c2 40>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9e 97 28 4c e7 9e 86 14>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9e 97 28 4c e7 9e 86 14> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.69:49080',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101334
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33154
received auth hello!
{ authId: 501, nonce: <Buffer cc c2 cb 9c 6a bc 0e de> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f7 6d da 64 30 e1 0b 40>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a2 82 cb c0 8f 7f 2d 5c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a2 82 cb c0 8f 7f 2d 5c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.68:60672',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101335
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33170
received auth hello!
{ authId: 501, nonce: <Buffer 21 b1 8d 00 66 7e 8d eb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c3 cf b9 cd f0 1d 84 02>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e6 28 19 a0 7d a8 cd 99>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e6 28 19 a0 7d a8 cd 99> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.69:49346',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101342
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33424
received auth hello!
{ authId: 501, nonce: <Buffer ac 16 b1 d1 0c a5 82 ec> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b4 32 b6 f7 f5 dd 48 92>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 19 fe db 52 c1 47 73 9d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 19 fe db 52 c1 47 73 9d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.68:60942',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101343
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33442
received auth hello!
{ authId: 501, nonce: <Buffer 6e f1 1c bf d3 1f b8 3a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7f 32 65 5b fb 80 a0 dd>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3a 67 c3 94 b6 71 01 17>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3a 67 c3 94 b6 71 01 17> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.69:49620',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101350
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33694
received auth hello!
{ authId: 501, nonce: <Buffer 53 4e fa 76 b6 fb 6a 5c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 85 16 3a 29 1b 62 c8 4b>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer dd d8 f6 05 28 b5 67 b7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer dd d8 f6 05 28 b5 67 b7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.68:32980',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101351
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33710
received auth hello!
{ authId: 501, nonce: <Buffer 68 cd 5c aa 67 45 51 11> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c6 84 a4 14 cd de ab db>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 14 b2 e4 19 03 c0 ef 68>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 14 b2 e4 19 03 c0 ef 68> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.69:49886',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101358
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33964
received auth hello!
{ authId: 501, nonce: <Buffer a3 2a 4a bc b0 e6 fd 4b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 66 6d 0f cb 80 e3 d8 5b>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6a ff 94 13 c3 ac 0a 3d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6a ff 94 13 c3 ac 0a 3d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.68:33250',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101359
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33982
received auth hello!
{ authId: 501, nonce: <Buffer e5 1e d0 52 df 13 f8 9c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c5 0c 5c 0e bc 9f 58 be>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7f 0b 6b 91 e0 58 71 09>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 7f 0b 6b 91 e0 58 71 09> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.69:50160',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101366
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34234
received auth hello!
{ authId: 501, nonce: <Buffer 69 c0 a4 9f e7 98 7f 46> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 23 64 dc a8 ef f0 1f 6a>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5f 11 4d 43 7e b7 14 b8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5f 11 4d 43 7e b7 14 b8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.68:33520',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101367
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34252
received auth hello!
{ authId: 501, nonce: <Buffer ea 87 cc 91 2e 12 17 a4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6b 4b 08 e6 9b 61 7d 42>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 40 71 96 d6 f2 13 44 2f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 40 71 96 d6 f2 13 44 2f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.69:50430',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
