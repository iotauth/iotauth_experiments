changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s515.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's515',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 76 72 ... > }
Handler: listening on port 22100
s515:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301513
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60718
received auth hello!
{ authId: 503, nonce: <Buffer 3f 3d fe c2 22 53 d6 8f> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 40 e7 02 f0 c5 94 aa 9f>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 6e ea 51 d7 d9 88 00 d2 86 c0 2c 0f 36 05 8a 43>,
  macKeyVal: <Buffer 3b 77 74 95 89 55 ff 1f 23 39 28 39 7b 33 b4 64 92 40 f7 dc 07 6d c8 ec 08 e8 4b 67 46 31 01 21>,
  absValidity: 2018-03-22T01:56:09.780Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e7 04 df ef 9a 19 91 a9>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e7 04 df ef 9a 19 91 a9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.81:41690',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301518
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60988
received auth hello!
{ authId: 503, nonce: <Buffer bc 10 f6 6d 97 1f 57 59> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 04 d0 a5 55 30 88 7a 5a>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 55 f7 e4 cb 02 f3 61 31>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 55 f7 e4 cb 02 f3 61 31> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.81:41960',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301523
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33026
received auth hello!
{ authId: 503, nonce: <Buffer 96 4b 3c 56 cd 5e 16 60> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9f 23 c5 33 05 ab cb a2>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 07 8d fa 66 ba 08 ce 4e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 07 8d fa 66 ba 08 ce 4e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.81:42230',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301528
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33296
received auth hello!
{ authId: 503, nonce: <Buffer cd 71 c4 48 93 9f d6 df> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 43 c4 7e 65 32 c8 e0 33>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 68 79 a6 da 77 c0 7b bf>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 68 79 a6 da 77 c0 7b bf> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.81:42500',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301533
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33566
received auth hello!
{ authId: 503, nonce: <Buffer 26 26 ca 69 a3 89 75 a2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 46 ee 06 a4 9f 56 43 56>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f6 15 1b e9 84 95 a0 53>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f6 15 1b e9 84 95 a0 53> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.81:42770',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301538
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33836
received auth hello!
{ authId: 503, nonce: <Buffer 8a f8 6b 85 51 13 bd 6a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a2 77 8f d3 cd aa 42 05>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8a 3f 55 0c 3b 14 be 94>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 8a 3f 55 0c 3b 14 be 94> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.81:43040',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50301543
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34098
received auth hello!
{ authId: 503, nonce: <Buffer d0 f2 3d 1d ff 04 c1 ca> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9f 94 92 e0 74 2b d6 77>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 01 53 99 96 86 06 6f c5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 01 53 99 96 86 06 6f c5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.81:43302',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
