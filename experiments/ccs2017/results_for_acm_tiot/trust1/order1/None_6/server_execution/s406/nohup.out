changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s406.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's406',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 33 6c ... > }
Handler: listening on port 22100
s406:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200888
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60776
received auth hello!
{ authId: 402, nonce: <Buffer 26 38 1e a0 92 ba f3 ed> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 6e ce 73 59 e7 d8 d2 83>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 48 e5 10 88 ad 96 06 91 ba 94 86 20 46 f6 c3 54>,
  macKeyVal: <Buffer 2c 08 ea 39 be e7 4e e6 37 3a 8d 1a 7e 2e ca c2 9e ad 01 3c ec ac 2c cc 9d e6 5a 03 b0 55 1b 48>,
  absValidity: 2018-03-22T01:54:27.736Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8f 41 d4 91 7b 19 81 73>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8f 41 d4 91 7b 19 81 73> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.50:47392',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200895
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60932
received auth hello!
{ authId: 402, nonce: <Buffer a4 07 13 ca 3c d6 7e a5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 83 55 e7 0f 86 92 cd 24>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 92 e9 b7 e8 e2 32 b1 cd>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 92 e9 b7 e8 e2 32 b1 cd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.50:47548',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200902
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 32962
received auth hello!
{ authId: 402, nonce: <Buffer c1 cb d6 e7 ff 87 01 bb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a1 57 af f0 3f fa 09 4b>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 31 85 2f ad 1a 04 39 e4>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 31 85 2f ad 1a 04 39 e4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.50:47810',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200909
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33232
received auth hello!
{ authId: 402, nonce: <Buffer 76 92 46 00 a4 bc 83 23> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bf 29 03 89 c7 18 6b 41>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8d 42 5d 09 da dd f8 97>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8d 42 5d 09 da dd f8 97> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.50:48080',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200916
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33502
received auth hello!
{ authId: 402, nonce: <Buffer 45 2d 4b 4e 62 59 dd ce> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3c f2 a4 1f 43 ab cf 5b>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 94 f4 a1 92 04 5f ee 66>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 94 f4 a1 92 04 5f ee 66> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.50:48350',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200923
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33772
received auth hello!
{ authId: 402, nonce: <Buffer 89 93 53 ca 67 db c4 3b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer eb 7a fc b3 f6 a6 78 ac>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a4 83 ba b6 b0 5b 91 2c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a4 83 ba b6 b0 5b 91 2c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.50:48620',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200930
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34042
received auth hello!
{ authId: 402, nonce: <Buffer f5 59 4d e2 50 97 cd 07> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 80 20 6d d2 4c a9 a2 46>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f2 c7 47 0b 11 e3 36 84>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f2 c7 47 0b 11 e3 36 84> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.50:48890',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200937
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34312
received auth hello!
{ authId: 402, nonce: <Buffer b6 d3 b8 c0 e8 6b d7 13> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ab cd ed 32 5a 9c 95 c9>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ad 88 9d 97 e8 4d 4a cd>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ad 88 9d 97 e8 4d 4a cd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.50:49160',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
