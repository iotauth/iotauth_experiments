changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s410.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's410',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 35 5a ... > }
Handler: listening on port 22100
s410:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200891
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36804
received auth hello!
{ authId: 402, nonce: <Buffer 22 03 4c b9 1a 8f 35 61> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 64 86 9f a2 41 fb 96 e8>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 6b 19 fa 3b bf 6f ca 04 a4 64 5f bd 7c 92 dc 96>,
  macKeyVal: <Buffer d5 ca ee 46 54 e8 5e a3 df f3 57 2a 38 d9 ec 10 74 61 8f 16 56 c6 e8 cd 38 19 5b 07 0c 36 38 ff>,
  absValidity: 2018-03-22T01:54:38.918Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f5 5f d2 56 17 3c e0 31>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f5 5f d2 56 17 3c e0 31> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.53:39468',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200898
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36978
received auth hello!
{ authId: 402, nonce: <Buffer ce a9 64 28 a6 b5 c0 f4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ce 1a 68 47 da 31 98 4e>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f9 b7 b9 ce 3b e4 5d d0>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f9 b7 b9 ce 3b e4 5d d0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.53:39642',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200905
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37250
received auth hello!
{ authId: 402, nonce: <Buffer 2e ad e8 a0 85 18 16 7e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0c 01 42 b3 45 39 eb 36>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 57 17 ff 0a bb 62 e3 67>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 57 17 ff 0a bb 62 e3 67> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.53:39914',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200912
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37520
received auth hello!
{ authId: 402, nonce: <Buffer 7f 53 ab 4d 94 a1 f7 16> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9e 72 7e 22 40 5f 72 e3>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 01 14 f0 6d 4c b1 d5 7a>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 01 14 f0 6d 4c b1 d5 7a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.53:40184',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200919
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37790
received auth hello!
{ authId: 402, nonce: <Buffer ca 9a 8e 98 81 eb 58 23> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 73 a5 12 cd 03 80 2b 93>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f6 41 58 0a b3 df c5 09>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f6 41 58 0a b3 df c5 09> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.53:40454',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200926
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38060
received auth hello!
{ authId: 402, nonce: <Buffer ca 92 f3 12 a1 56 bd 3a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer db 74 17 cd fe 91 27 31>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a6 90 e2 d3 27 ab 24 ba>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a6 90 e2 d3 27 ab 24 ba> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.53:40724',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200933
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38330
received auth hello!
{ authId: 402, nonce: <Buffer 68 4b 26 56 7a ea 01 36> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3f 07 d5 14 18 c8 7a 07>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer dd 54 ef b7 13 3c 7c 2f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer dd 54 ef b7 13 3c 7c 2f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.53:40994',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200940
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38600
received auth hello!
{ authId: 402, nonce: <Buffer fc 98 43 ec 5e 13 f1 d9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 88 71 17 88 e8 ca a9 7d>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7a 31 62 d2 4d 5a aa 42>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 7a 31 62 d2 4d 5a aa 42> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.53:41264',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
