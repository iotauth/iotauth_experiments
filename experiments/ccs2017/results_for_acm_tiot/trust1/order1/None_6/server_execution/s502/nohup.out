changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s502.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's502',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 70 71 ... > }
Handler: listening on port 22100
s502:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101315
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55240
received auth hello!
{ authId: 501, nonce: <Buffer 12 d9 16 b4 a8 1a 24 d0> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 75 dc f8 45 17 c1 83 ea>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 85 0d 88 e3 51 67 c0 32 f4 56 17 7c 30 3d 26 54>,
  macKeyVal: <Buffer 58 16 3e 1a d3 e5 58 3d bd 3b 81 46 9e 6a ec d7 ed 6b c9 b2 bc 59 65 04 cc 98 b1 fb 77 46 5e c0>,
  absValidity: 2018-03-22T01:55:10.361Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a7 0b e4 6c da 41 be f8>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer a7 0b e4 6c da 41 be f8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.63:41344',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101323
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55476
received auth hello!
{ authId: 501, nonce: <Buffer 19 cd 30 ae a8 e6 aa 85> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bb 72 f0 7d 43 90 84 4a>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 21 7b d7 32 b4 02 ee d7>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 21 7b d7 32 b4 02 ee d7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.63:41580',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101331
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55746
received auth hello!
{ authId: 501, nonce: <Buffer ed ec 65 de 5b 9b 81 a2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1b 83 1c 3c 24 ca ec 9a>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2a 48 b1 64 48 fb 05 f4>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 2a 48 b1 64 48 fb 05 f4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.63:41850',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101339
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56016
received auth hello!
{ authId: 501, nonce: <Buffer 86 9f 7b 28 d6 9f 1b 1c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 67 b3 be 4c 60 b1 d5 2b>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 25 e0 6e 23 71 f9 f8 d7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 25 e0 6e 23 71 f9 f8 d7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.63:42120',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101347
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56286
received auth hello!
{ authId: 501, nonce: <Buffer a5 13 95 da 24 05 38 c8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c2 59 02 da d8 76 f8 18>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 21 7a f5 ee c6 1b 3e 58>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 21 7a f5 ee c6 1b 3e 58> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.63:42390',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101355
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56556
received auth hello!
{ authId: 501, nonce: <Buffer 04 bc 83 16 c3 a8 ef c5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 10 26 87 02 b1 ad bc 8b>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 61 06 3d d1 09 3c e2 5a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 61 06 3d d1 09 3c e2 5a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.63:42660',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101363
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56826
received auth hello!
{ authId: 501, nonce: <Buffer 51 a2 cc 27 e7 8b 3b f1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e7 c0 be 36 fb 3b 72 f7>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f1 16 03 8d 01 f4 58 04>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f1 16 03 8d 01 f4 58 04> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.63:42930',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
