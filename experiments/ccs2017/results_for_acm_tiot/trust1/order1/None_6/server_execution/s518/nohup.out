changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s518.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's518',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 67 49 42 41 41 4b 43 41 51 45 41 33 62 ... > }
Handler: listening on port 22100
s518:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400416
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54656
received auth hello!
{ authId: 504, nonce: <Buffer b5 86 dc 24 4e 67 98 96> }
Handler: Error in server - details: handshake2 timed out...
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 9c ba 4a 82 0c 0e af 94>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer db bb 23 7d 1f 6c 25 b4 ee 1a 7c 40 bc 22 56 0a>,
  macKeyVal: <Buffer 13 14 62 fa da 71 ae df 4a 7e df ea d1 00 5d c9 7b 32 ee 96 d9 36 fd ef 28 bd 3b 2d b4 3c 1a ec>,
  absValidity: 2018-03-22T01:56:24.422Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 54 70 02 82 1d a5 0a 82>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 54 70 02 82 1d a5 0a 82> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.84:35764',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400418
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54686
received auth hello!
{ authId: 504, nonce: <Buffer d5 12 c6 8d b1 2f 74 4b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 76 0b 86 22 03 33 22 95>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 17 8f fd 45 fe 0d 83 bd>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 17 8f fd 45 fe 0d 83 bd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.85:51250',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400422
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54924
received auth hello!
{ authId: 504, nonce: <Buffer 47 fc 4d 0b 5b 45 f7 80> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 68 c4 24 40 bc e6 27 d3>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7d 41 07 7c f2 61 f4 f9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 7d 41 07 7c f2 61 f4 f9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.84:36034',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400424
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54956
received auth hello!
{ authId: 504, nonce: <Buffer 67 dc 33 1f 5f 73 2a 38> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 08 10 41 5c 3f a4 cc 21>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b6 ba df 6d 35 8e 8c a8>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b6 ba df 6d 35 8e 8c a8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.85:51520',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400428
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55194
received auth hello!
{ authId: 504, nonce: <Buffer 37 3f d4 28 5f 3f 17 c7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3f 04 d4 1a fc de 20 50>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 83 c1 58 d4 b1 ee be 44>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 83 c1 58 d4 b1 ee be 44> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.84:36304',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400430
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55226
received auth hello!
{ authId: 504, nonce: <Buffer 4e b8 96 24 2f d6 dc 79> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cf 31 39 69 e8 23 78 d8>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 99 68 a0 27 12 f3 a9 c2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 99 68 a0 27 12 f3 a9 c2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.85:51790',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400434
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55464
received auth hello!
{ authId: 504, nonce: <Buffer 38 b8 51 3b eb cb 6c 0f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 57 9f 73 1f 76 b1 28 21>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fd 78 fc 47 d9 28 22 12>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fd 78 fc 47 d9 28 22 12> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.84:36574',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400436
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55496
received auth hello!
{ authId: 504, nonce: <Buffer 32 6b d1 7b 9d ab da d5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 89 b5 a0 48 05 e2 28 f1>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 61 d2 75 e8 7d 9e e6 88>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 61 d2 75 e8 7d 9e e6 88> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.85:52060',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400440
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55734
received auth hello!
{ authId: 504, nonce: <Buffer 04 9c fe 67 d2 28 f7 e7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 67 3d ea b8 c8 b6 b9 e8>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3e 13 98 d9 58 33 1d 80>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3e 13 98 d9 58 33 1d 80> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.84:36844',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400442
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55766
received auth hello!
{ authId: 504, nonce: <Buffer ab 46 83 53 0d eb a7 52> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e6 8b d4 58 e4 dd 0f 3a>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer dd 5d 7d 1f f1 56 d0 cf>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer dd 5d 7d 1f f1 56 d0 cf> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.85:52330',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400446
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56006
received auth hello!
{ authId: 504, nonce: <Buffer bd c2 ec dd d7 5e e6 7b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b7 77 7a 35 e7 a9 61 17>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a5 a8 df 72 de be 7d 3e>
switching to HANDSHAKE_2_SENT
Handler: Error in server - details: handshake2 timed out...
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a5 a8 df 72 de be 7d 3e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.84:37114',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400448
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56036
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer 61 15 1b 72 04 b3 2e b8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ea bd 18 40 f6 51 8b 49>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bb 60 d2 08 51 eb e4 f2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bb 60 d2 08 51 eb e4 f2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.85:52600',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
