changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s501.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's501',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 78 42 ... > }
Handler: listening on port 22100
s501:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101314
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45852
received auth hello!
{ authId: 501, nonce: <Buffer 42 61 ea 65 8a bd 09 50> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 93 87 5c a2 20 1e 02 73>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer d8 7d bf 3e 14 cb 25 96 32 46 ab 42 3e 54 67 d1>,
  macKeyVal: <Buffer 2f 32 e1 6a f9 42 40 06 af c7 85 30 66 3f e5 7c 3d 0e 1d 76 b3 b6 46 f6 4d 4e be 53 fe b6 54 51>,
  absValidity: 2018-03-22T01:55:06.882Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ce e7 22 9d 85 dc 7d 37>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ce e7 22 9d 85 dc 7d 37> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.62:56158',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101322
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46082
received auth hello!
{ authId: 501, nonce: <Buffer f1 5d e0 b9 8e b2 27 65> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer dd 36 61 cf ae 3a 81 24>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ad 99 74 35 83 0f 3f 3e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ad 99 74 35 83 0f 3f 3e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.62:56388',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101330
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46352
received auth hello!
{ authId: 501, nonce: <Buffer 6c 86 70 ba e7 d1 08 21> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ba 22 45 c7 25 f6 03 01>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9c ae 56 46 6f 04 66 a4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9c ae 56 46 6f 04 66 a4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.62:56658',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101338
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46622
received auth hello!
{ authId: 501, nonce: <Buffer 41 bd 66 7c 57 0d 08 47> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0c 39 19 68 c4 97 a6 08>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3f 5c d8 68 af 76 b4 ed>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3f 5c d8 68 af 76 b4 ed> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.62:56928',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101346
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46892
received auth hello!
{ authId: 501, nonce: <Buffer 6d 23 a5 31 c9 e0 6e 2a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 94 46 b5 68 a3 7e 8e 91>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ff db 79 94 e2 1a 16 0f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ff db 79 94 e2 1a 16 0f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.62:57198',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101354
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47162
received auth hello!
{ authId: 501, nonce: <Buffer 40 ae 31 b5 65 0c 14 7a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 61 0e b3 cb 51 c1 5b 09>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0b 57 22 e5 0e df 30 01>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 0b 57 22 e5 0e df 30 01> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.62:57468',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50101362
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47432
received auth hello!
{ authId: 501, nonce: <Buffer d4 1a cf 58 78 d4 b9 ef> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f9 93 42 03 57 1a ff 9d>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1a f3 65 7b 27 fd 0f f0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1a f3 65 7b 27 fd 0f f0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.62:57738',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
