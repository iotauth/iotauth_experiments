changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s414.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's414',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 67 49 42 41 41 4b 43 41 51 45 41 6e 45 ... > }
Handler: listening on port 22100
s414:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301337
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38992
received auth hello!
{ authId: 403, nonce: <Buffer c6 1d 0c c8 26 a3 fc 3e> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer f1 16 7a 0e 1d 8a 0e c8>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 33 0c 34 3c c9 02 e0 0d d6 53 06 ac e9 a9 bc 57>,
  macKeyVal: <Buffer 61 d7 85 f9 ef 90 26 bd 3e a2 41 a1 f1 e5 2f be 18 c3 94 73 af 48 b5 7e 8d c1 f9 9f 22 53 d1 39>,
  absValidity: 2018-03-22T01:54:47.591Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 21 83 25 c3 94 f7 fb 55>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 21 83 25 c3 94 f7 fb 55> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.56:39798',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301343
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39184
received auth hello!
{ authId: 403, nonce: <Buffer 0a c0 59 b0 3b 14 f0 47> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f2 2e 44 9b af 4b 1c 5f>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fe e7 ca d7 36 37 dd 3e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fe e7 ca d7 36 37 dd 3e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.56:39990',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301349
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39456
received auth hello!
{ authId: 403, nonce: <Buffer 50 1d 4f a2 c1 fd 66 1e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3c f4 72 bc 63 91 3d ed>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 37 d4 fd 4d 69 20 53 dc>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 37 d4 fd 4d 69 20 53 dc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.56:40262',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301355
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39726
received auth hello!
{ authId: 403, nonce: <Buffer 28 67 22 6a 48 be 53 5f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f8 d8 1d f7 7c 1d fe 59>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c2 cd 65 b5 08 83 4d f8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c2 cd 65 b5 08 83 4d f8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.56:40532',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301361
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39996
received auth hello!
{ authId: 403, nonce: <Buffer e5 ff 20 de 6d da 0f 05> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 01 97 b2 75 c3 ae 14 7a>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0c db 4f 8e 12 f0 8d f2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0c db 4f 8e 12 f0 8d f2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.56:40802',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301367
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40266
received auth hello!
{ authId: 403, nonce: <Buffer 99 a9 52 12 ba 75 7c ad> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 19 7e 58 a7 72 9e 5e e5>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 99 a5 96 ee 6e 6a 4a 3d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 99 a5 96 ee 6e 6a 4a 3d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.56:41072',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301373
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40536
received auth hello!
{ authId: 403, nonce: <Buffer 6c d9 4f 68 31 e6 a2 36> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b1 85 28 4d 6c d9 39 41>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 94 14 ea 97 c9 ef c5 3e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 94 14 ea 97 c9 ef c5 3e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.56:41342',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40301379
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40802
received auth hello!
{ authId: 403, nonce: <Buffer 92 2a f2 01 9d 15 e3 8a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer db 98 71 be 65 6f 91 0d>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 10 f8 f3 8b f7 81 a7 b3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 10 f8 f3 8b f7 81 a7 b3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.56:41608',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
