changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s402.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's402',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 35 57 ... > }
Handler: listening on port 22100
s402:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40102158
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41474
received auth hello!
{ authId: 401, nonce: <Buffer e6 d8 c8 aa bf 7d 2c 1e> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 48 3b 6e 74 e3 ca 6c f3>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 9d 5f 6d a6 9a 8b a2 0a 31 d5 72 de 18 1b 7b 42>,
  macKeyVal: <Buffer d5 93 18 30 d4 93 b1 27 02 0f 11 ca f0 19 82 eb 33 59 fd 6e 3d c9 bb 38 4b 3c fe f0 6f 0c 94 74>,
  absValidity: 2018-03-22T01:54:08.452Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6d 22 6d dd de 39 6e 9a>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 6d 22 6d dd de 39 6e 9a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.44:42452',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40102164
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41596
received auth hello!
{ authId: 401, nonce: <Buffer 98 75 46 dc 32 8d f2 c8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 90 8a d5 da 2a b8 d5 f2>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d0 0d b2 4b 22 72 ab a5>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer d0 0d b2 4b 22 72 ab a5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.44:42574',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40102170
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41826
received auth hello!
{ authId: 401, nonce: <Buffer 18 d8 00 d8 8d 29 41 ff> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 83 49 cd 96 b6 cb 6f 1b>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 38 c9 6e 3b 52 fc 7f aa>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 38 c9 6e 3b 52 fc 7f aa> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.44:42804',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40102176
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42096
received auth hello!
{ authId: 401, nonce: <Buffer 5e 12 bc 8e 25 42 4d f7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0c a2 27 0c 87 c8 15 af>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 96 09 b6 c3 35 3a d8 82>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 96 09 b6 c3 35 3a d8 82> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.44:43074',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40102182
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42366
received auth hello!
{ authId: 401, nonce: <Buffer 0b 39 ec 95 f8 5a 31 25> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 40 fe a1 6f f5 b8 75 60>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 92 83 5f 25 80 81 d6 2c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 92 83 5f 25 80 81 d6 2c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.44:43344',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40102188
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42636
received auth hello!
{ authId: 401, nonce: <Buffer fd 30 4c 9f 15 f6 42 2a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 33 20 f4 ad 46 a7 49 77>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d1 7d bf 51 14 ed 16 51>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d1 7d bf 51 14 ed 16 51> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.44:43614',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40102194
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42906
received auth hello!
{ authId: 401, nonce: <Buffer 12 d0 79 af 7a fe 1b 1e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 13 fd dc 41 8f bb fc f3>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9a f6 30 07 97 f2 e0 c1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9a f6 30 07 97 f2 e0 c1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.44:43884',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40102200
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43176
received auth hello!
{ authId: 401, nonce: <Buffer 0a 49 53 68 31 a8 2b e6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer be 79 86 3d 4a fd 08 b7>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e4 a1 ca 96 e2 37 39 56>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e4 a1 ca 96 e2 37 39 56> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.44:44154',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40102206
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43438
received auth hello!
{ authId: 401, nonce: <Buffer a4 6b e7 da 1a 42 60 09> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e6 f7 ed f5 08 2c 31 84>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 46 a6 a9 bf 55 66 fd 4d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 46 a6 a9 bf 55 66 fd 4d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.44:44416',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
