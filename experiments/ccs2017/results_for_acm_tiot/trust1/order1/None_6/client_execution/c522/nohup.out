changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c522.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c522',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 67 49 42 41 41 4b 43 41 51 45 41 78 77 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521680175750
connected to auth! from local port 44984
received auth hello!
{ authId: 503, nonce: <Buffer d4 c6 de 9f 5e dd bc 31> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer a3 1d a6 ec a8 42 c5 1c>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer b0 46 79 d0 67 81 0b f9 49 80 3e ec 4c ae 64 33>,
  macKeyVal: <Buffer fd ed 3d df 9d aa ab 49 25 f7 8c 85 d4 2f e1 7b f4 61 dd d0 0e 34 1f 39 cc 4b c0 e4 ed e7 35 1c>,
  absValidity: 2018-03-22T01:56:15.926Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 50301515,
  cipherKeyVal: <Buffer c1 4b de f2 92 aa a3 44 43 ca db 30 7f 49 b7 69>,
  macKeyVal: <Buffer 1f 18 8b 6c 5d 11 7e e1 9e 53 d2 87 b3 89 8e aa 95 99 04 47 ac 76 a8 27 79 8b 94 25 25 e3 af 7c>,
  absValidity: 2018-03-23T00:56:15.925Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.40',
  serverPort: 22100,
  sessionKey: 
   { id: 50301515,
     cipherKeyVal: <Buffer c1 4b de f2 92 aa a3 44 43 ca db 30 7f 49 b7 69>,
     macKeyVal: <Buffer 1f 18 8b 6c 5d 11 7e e1 9e 53 d2 87 b3 89 8e aa 95 99 04 47 ac 76 a8 27 79 8b 94 25 25 e3 af 7c>,
     absValidity: 2018-03-23T00:56:15.925Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer b8 90 7b 94 0c 67 96 ab>
switching to HANDSHAKE_1_SENT
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Thu Mar 22 2018 00:56:16 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521680177391
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521680235806
connected to auth! from local port 45254
received auth hello!
{ authId: 503, nonce: <Buffer 66 43 a8 17 48 13 cf ba> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 10 62 37 d7 02 30 1e e9>
auth nonce verified
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50301520,
  cipherKeyVal: <Buffer 21 e9 b4 5f 0e c6 f0 8c a5 88 32 fc f8 2d 31 d0>,
  macKeyVal: <Buffer 96 9c 7a 53 c0 68 34 60 df f5 79 8b 67 43 b4 71 df 4b cc b3 71 46 1e 13 09 2f b2 3f 10 2f 47 55>,
  absValidity: 2018-03-23T00:57:15.942Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.40',
  serverPort: 22100,
  sessionKey: 
   { id: 50301520,
     cipherKeyVal: <Buffer 21 e9 b4 5f 0e c6 f0 8c a5 88 32 fc f8 2d 31 d0>,
     macKeyVal: <Buffer 96 9c 7a 53 c0 68 34 60 df f5 79 8b 67 43 b4 71 df 4b cc b3 71 46 1e 13 09 2f b2 3f 10 2f 47 55>,
     absValidity: 2018-03-23T00:57:15.942Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer b5 92 a5 6a 1b 4f 7c 07>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Thu Mar 22 2018 00:57:16 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521680237289
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521680295835
connected to auth! from local port 45524
received auth hello!
{ authId: 503, nonce: <Buffer 72 ba 53 cd e5 dc a9 51> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 22 ae 53 79 02 f0 d1 a4>
auth nonce verified
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50301525,
  cipherKeyVal: <Buffer 47 f3 15 fb 8f 03 bd ab af 7c 42 ca 36 4e 2b 2e>,
  macKeyVal: <Buffer f0 b3 b6 64 5e 74 64 06 fb 64 1f 1b df df 31 f6 e7 8b af b9 e2 a9 45 81 e3 c6 08 28 9a 73 47 48>,
  absValidity: 2018-03-23T00:58:15.957Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.40',
  serverPort: 22100,
  sessionKey: 
   { id: 50301525,
     cipherKeyVal: <Buffer 47 f3 15 fb 8f 03 bd ab af 7c 42 ca 36 4e 2b 2e>,
     macKeyVal: <Buffer f0 b3 b6 64 5e 74 64 06 fb 64 1f 1b df df 31 f6 e7 8b af b9 e2 a9 45 81 e3 c6 08 28 9a 73 47 48>,
     absValidity: 2018-03-23T00:58:15.957Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 59 2d 05 bb 1a 97 7d 86>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Thu Mar 22 2018 00:58:16 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521680297369
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521680355893
connected to auth! from local port 45794
received auth hello!
{ authId: 503, nonce: <Buffer 3e 47 bf 84 16 1e 40 9e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d2 48 91 c3 ea 65 97 34>
auth nonce verified
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50301530,
  cipherKeyVal: <Buffer 82 75 38 f1 8f ce 63 69 5d 5b 40 07 31 05 9b 40>,
  macKeyVal: <Buffer 56 c6 46 67 69 95 72 62 c1 ff 42 33 29 99 6f 00 3a dd e3 21 4b 5c b7 a5 95 c0 e4 64 ee d9 45 71>,
  absValidity: 2018-03-23T00:59:16.038Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.40',
  serverPort: 22100,
  sessionKey: 
   { id: 50301530,
     cipherKeyVal: <Buffer 82 75 38 f1 8f ce 63 69 5d 5b 40 07 31 05 9b 40>,
     macKeyVal: <Buffer 56 c6 46 67 69 95 72 62 c1 ff 42 33 29 99 6f 00 3a dd e3 21 4b 5c b7 a5 95 c0 e4 64 ee d9 45 71>,
     absValidity: 2018-03-23T00:59:16.038Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 65 e3 0b 57 08 ac 4b 63>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Thu Mar 22 2018 00:59:17 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521680357476
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521680415952
connected to auth! from local port 46064
received auth hello!
{ authId: 503, nonce: <Buffer 62 17 3a da 44 8b 3f 68> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 31 c1 cf 7c 57 78 5c 36>
auth nonce verified
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50301535,
  cipherKeyVal: <Buffer a3 49 86 fa 28 54 0e 66 95 cc 10 3f 6c 49 ac e8>,
  macKeyVal: <Buffer 37 e3 db 0e 5d 09 e4 d5 09 f2 15 b7 38 ed 96 2a a5 5b 93 6d 34 38 40 49 fe a5 35 dd 9b ed 83 e9>,
  absValidity: 2018-03-23T01:00:16.096Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.40',
  serverPort: 22100,
  sessionKey: 
   { id: 50301535,
     cipherKeyVal: <Buffer a3 49 86 fa 28 54 0e 66 95 cc 10 3f 6c 49 ac e8>,
     macKeyVal: <Buffer 37 e3 db 0e 5d 09 e4 d5 09 f2 15 b7 38 ed 96 2a a5 5b 93 6d 34 38 40 49 fe a5 35 dd 9b ed 83 e9>,
     absValidity: 2018-03-23T01:00:16.096Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 48 07 2f 86 3d 4b 58 88>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Thu Mar 22 2018 01:00:17 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521680417580
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521680476009
connected to auth! from local port 46334
received auth hello!
{ authId: 503, nonce: <Buffer d0 5e 91 27 62 b4 4f 72> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9d 99 88 31 36 cb 3b 80>
auth nonce verified
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50301540,
  cipherKeyVal: <Buffer 79 a8 b8 b3 6b f9 d7 b5 f4 f5 c1 73 d3 3a ce 8a>,
  macKeyVal: <Buffer e8 a8 11 ef c5 b5 4a 9d 96 6f ce 43 cd 30 fa 08 c3 b6 cb f0 52 47 4a ce b7 51 6c 90 5d 1a e5 0b>,
  absValidity: 2018-03-23T01:01:16.161Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.40',
  serverPort: 22100,
  sessionKey: 
   { id: 50301540,
     cipherKeyVal: <Buffer 79 a8 b8 b3 6b f9 d7 b5 f4 f5 c1 73 d3 3a ce 8a>,
     macKeyVal: <Buffer e8 a8 11 ef c5 b5 4a 9d 96 6f ce 43 cd 30 fa 08 c3 b6 cb f0 52 47 4a ce b7 51 6c 90 5d 1a e5 0b>,
     absValidity: 2018-03-23T01:01:16.161Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 67 11 6d 92 10 5d 95 5f>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Thu Mar 22 2018 01:01:17 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521680477585
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521680536069
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect ECONNREFUSED 10.0.1.6:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 8 0.75 1521680596080
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 9 0.6666666666666666 1521680656089
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 10 0.6 1521680716100
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 11 0.5454545454545454 1521680776110
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 12 0.5 1521680836121
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 13 0.46153846153846156 1521680896131
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 14 0.42857142857142855 1521680956141
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 15 0.4 1521681016151
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 16 0.375 1521681076162
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 17 0.35294117647058826 1521681136172
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 18 0.3333333333333333 1521681196181
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 19 0.3157894736842105 1521681256192
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 20 0.3 1521681316202
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 21 0.2857142857142857 1521681376212
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 22 0.2727272727272727 1521681436222
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 23 0.2608695652173913 1521681496233
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 24 0.25 1521681556243
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 25 0.24 1521681616253
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 26 0.23076923076923078 1521681676263
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 27 0.2222222222222222 1521681736273
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 28 0.21428571428571427 1521681796283
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 29 0.20689655172413793 1521681856292
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
