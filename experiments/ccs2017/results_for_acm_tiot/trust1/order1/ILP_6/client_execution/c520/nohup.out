changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c520.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c520',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 67 49 42 41 41 4b 43 41 51 45 41 78 69 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521602613426
connected to auth! from local port 53978
received auth hello!
{ authId: 503, nonce: <Buffer 4b 0a 18 b5 95 91 9d a8> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 7f 72 ca 53 eb f6 8d d6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 4f bc 7b af 8c ce a6 7c 2e f0 5f b5 a1 85 04 98>,
  macKeyVal: <Buffer 33 fa c5 5a 19 ef 07 b8 3c a0 d9 e4 f6 9e 03 0e 00 f4 ed 8b 62 8a ef 2b 29 b6 b4 eb e5 cc 2d f3>,
  absValidity: 2018-03-21T04:23:33.586Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300737,
  cipherKeyVal: <Buffer 44 3f e6 73 aa 96 86 e1 6b 98 2d 0e ce b2 05 96>,
  macKeyVal: <Buffer 2b 1d 32 44 44 fe 86 49 4e 01 a8 eb e8 56 33 8d 57 2b 3b 85 67 8c bc 6a 22 96 fc d4 9b 56 1a 2f>,
  absValidity: 2018-03-22T03:23:33.586Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.38',
  serverPort: 22100,
  sessionKey: 
   { id: 50300737,
     cipherKeyVal: <Buffer 44 3f e6 73 aa 96 86 e1 6b 98 2d 0e ce b2 05 96>,
     macKeyVal: <Buffer 2b 1d 32 44 44 fe 86 49 4e 01 a8 eb e8 56 33 8d 57 2b 3b 85 67 8c bc 6a 22 96 fc d4 9b 56 1a 2f>,
     absValidity: 2018-03-22T03:23:33.586Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 08 97 60 93 a5 38 8c 17>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:23:34 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521602614803
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521602673482
connected to auth! from local port 54248
received auth hello!
{ authId: 503, nonce: <Buffer f8 15 00 56 86 4c 10 99> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b5 b6 ba f2 62 4a 1c 89>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300742,
  cipherKeyVal: <Buffer 7a 75 1a 55 3e d1 ec c7 8c 72 cb 06 f5 5d a6 c1>,
  macKeyVal: <Buffer 38 50 19 23 8b 8d fe e1 4b 00 0d b6 90 da cc 7c d0 40 b3 53 83 4d ab fa ec 94 ef 63 78 bb fd 07>,
  absValidity: 2018-03-22T03:24:33.635Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.38',
  serverPort: 22100,
  sessionKey: 
   { id: 50300742,
     cipherKeyVal: <Buffer 7a 75 1a 55 3e d1 ec c7 8c 72 cb 06 f5 5d a6 c1>,
     macKeyVal: <Buffer 38 50 19 23 8b 8d fe e1 4b 00 0d b6 90 da cc 7c d0 40 b3 53 83 4d ab fa ec 94 ef 63 78 bb fd 07>,
     absValidity: 2018-03-22T03:24:33.635Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 95 14 db be c8 78 9f 5b>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:24:34 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521602674565
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521602733537
connected to auth! from local port 54518
received auth hello!
{ authId: 503, nonce: <Buffer 10 b4 1e 4c a6 da b2 6d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8d 3d d1 b5 e2 25 a4 d1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300747,
  cipherKeyVal: <Buffer c4 82 8a 8e c1 2a ad 13 07 c5 8b 73 b6 83 1b 08>,
  macKeyVal: <Buffer 23 ea 0f 62 fd 1d 12 99 6a 6a 48 f1 a4 8f b0 0b 69 f3 85 a8 69 58 98 1b 77 bd 3e e2 a9 1a 43 66>,
  absValidity: 2018-03-22T03:25:33.643Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.38',
  serverPort: 22100,
  sessionKey: 
   { id: 50300747,
     cipherKeyVal: <Buffer c4 82 8a 8e c1 2a ad 13 07 c5 8b 73 b6 83 1b 08>,
     macKeyVal: <Buffer 23 ea 0f 62 fd 1d 12 99 6a 6a 48 f1 a4 8f b0 0b 69 f3 85 a8 69 58 98 1b 77 bd 3e e2 a9 1a 43 66>,
     absValidity: 2018-03-22T03:25:33.643Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer da 9d 57 87 47 8d 9a 7f>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:25:34 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521602734625
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521602793596
connected to auth! from local port 54788
received auth hello!
{ authId: 503, nonce: <Buffer 40 a4 81 d7 22 53 c1 81> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9f ec 99 f9 c8 51 fa 33>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300752,
  cipherKeyVal: <Buffer ff 42 83 b0 45 2b 88 6d 12 28 65 1b af 72 49 01>,
  macKeyVal: <Buffer 8d c1 a6 14 29 19 55 ae 94 e1 01 49 26 6d 87 c0 8b dc a8 8d 33 77 32 2a 24 14 21 e2 42 61 39 58>,
  absValidity: 2018-03-22T03:26:33.734Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.38',
  serverPort: 22100,
  sessionKey: 
   { id: 50300752,
     cipherKeyVal: <Buffer ff 42 83 b0 45 2b 88 6d 12 28 65 1b af 72 49 01>,
     macKeyVal: <Buffer 8d c1 a6 14 29 19 55 ae 94 e1 01 49 26 6d 87 c0 8b dc a8 8d 33 77 32 2a 24 14 21 e2 42 61 39 58>,
     absValidity: 2018-03-22T03:26:33.734Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer c2 26 f1 3d bb d7 fb 6a>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:26:34 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521602794799
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521602853653
connected to auth! from local port 55058
received auth hello!
{ authId: 503, nonce: <Buffer 11 f6 e4 83 af 81 e7 91> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 03 7b a7 70 ca f4 63 e6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300757,
  cipherKeyVal: <Buffer ca 04 09 cb d3 5a 8f 0d cb d9 ad 74 26 ac 59 3c>,
  macKeyVal: <Buffer 2d 31 24 30 b0 03 f9 09 4d e7 9a c1 43 71 c6 db 1f 38 a2 16 57 ce 89 2f 8d 0b 20 24 6c d0 b4 7c>,
  absValidity: 2018-03-22T03:27:33.823Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.38',
  serverPort: 22100,
  sessionKey: 
   { id: 50300757,
     cipherKeyVal: <Buffer ca 04 09 cb d3 5a 8f 0d cb d9 ad 74 26 ac 59 3c>,
     macKeyVal: <Buffer 2d 31 24 30 b0 03 f9 09 4d e7 9a c1 43 71 c6 db 1f 38 a2 16 57 ce 89 2f 8d 0b 20 24 6c d0 b4 7c>,
     absValidity: 2018-03-22T03:27:33.823Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer d1 22 74 1f 1e b7 3b 77>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:27:34 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521602854862
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521602913713
connected to auth! from local port 55328
received auth hello!
{ authId: 503, nonce: <Buffer 60 7f 2b 2d e1 44 18 ee> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 00 fb 6f 7e 5f b9 2d 1a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300762,
  cipherKeyVal: <Buffer 6c 38 d9 04 00 56 cf 64 5c 39 fd 70 1c b4 d1 74>,
  macKeyVal: <Buffer 1d d9 55 9b 55 91 28 27 e7 e4 ea 53 35 8e e8 0b c8 31 75 9e ce ed c5 9a 3c 10 3f da d7 e2 9e e1>,
  absValidity: 2018-03-22T03:28:33.855Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.38',
  serverPort: 22100,
  sessionKey: 
   { id: 50300762,
     cipherKeyVal: <Buffer 6c 38 d9 04 00 56 cf 64 5c 39 fd 70 1c b4 d1 74>,
     macKeyVal: <Buffer 1d d9 55 9b 55 91 28 27 e7 e4 ea 53 35 8e e8 0b c8 31 75 9e ce ed c5 9a 3c 10 3f da d7 e2 9e e1>,
     absValidity: 2018-03-22T03:28:33.855Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 0b ac 34 f9 0d ea 3e 38>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:28:34 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521602914748
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521602973757
connected to auth! from local port 55590
received auth hello!
{ authId: 503, nonce: <Buffer 12 7f 90 97 5a 95 25 c7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 09 80 27 81 77 70 e9 91>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300767,
  cipherKeyVal: <Buffer 6e a3 64 bb df 45 0d cf 55 66 4e 9a 1b c6 d8 0b>,
  macKeyVal: <Buffer 94 10 55 a2 b0 17 d3 31 a2 22 9d a9 c0 7f 8b f7 fe 49 6f 22 9d a0 a4 b5 bc e3 63 4c a6 31 25 9b>,
  absValidity: 2018-03-22T03:29:33.893Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.38',
  serverPort: 22100,
  sessionKey: 
   { id: 50300767,
     cipherKeyVal: <Buffer 6e a3 64 bb df 45 0d cf 55 66 4e 9a 1b c6 d8 0b>,
     macKeyVal: <Buffer 94 10 55 a2 b0 17 d3 31 a2 22 9d a9 c0 7f 8b f7 fe 49 6f 22 9d a0 a4 b5 bc e3 63 4c a6 31 25 9b>,
     absValidity: 2018-03-22T03:29:33.893Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer ef 3e 4d b5 98 d8 35 69>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:29:34 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521602974817
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521603033769
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 9 0.7777777777777778 1521603093779
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
connected to auth! from local port 44740
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 10 0.7 1521603153785
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.6:21100
connected to auth! from local port 44916
received auth hello!
{ authId: 502, nonce: <Buffer 5d f5 04 b0 1e fd 80 1a> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth503',
     commonName: '10.0.0.6' },
  serial: '0162469268AF',
  notBefore: 2018-03-21T03:18:42.000Z,
  notAfter: 2018-03-22T03:20:22.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '1D:27:C3:AB:64:0A:C5:CD:65:6B:32:D2:6F:93:CB:C2:3A:F2:93:CA',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'FF6CB5202497CC77AF28EFDE774858E4FEF04355E5228E378962DF4235BE3683DAF9E38A7E22621D66B3B50166D897E97BF911F9E8FC09D686961AA39679014E5DDD27EA0F02DE853A41537DB5E37F33395E249F355C0D074419572E9856D1D598CAB2CD6951013DDCB0A163B943DFCD2694BE18B9B3892695B3052EBD9115D447293C83AF24A008794B842E4F0A6C2A8D0189612A600AA40A592603E43713C0ECCA681024E5EC429FAD09484B824919DF59C8BD488E0D372D2A3D8B99B6068E24BBBDA8F0BCDDBA806010E4A7181736DF08D4D1CFC16E26507C360EDCBFF1B5F4288CE304DE62E9696665C5108489AD7232658356998FF47C4F7E8A04225423',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJGkmivMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDMxETAPBgNVBAMMCDEwLjAuMC42MB4XDTE4MDMy\nMTAzMTg0MloXDTE4MDMyMjAzMjAyMlowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQD/bLUgJJfMd68o7953SFjk/vBDVeUijjeJYt9CNb42g9r544p+\nImIdZrO1AWbYl+l7+RH56PwJ1oaWGqOWeQFOXd0n6g8C3oU6QVN9teN/MzleJJ81\nXA0HRBlXLphW0dWYyrLNaVEBPdywoWO5Q9/NJpS+GLmziSaVswUuvZEV1EcpPIOv\nJKAIeUuELk8KbCqNAYlhKmAKpApZJgPkNxPA7MpoECTl7EKfrQlIS4JJGd9ZyL1I\njg03LSo9i5m2Bo4ku72o8LzduoBgEOSnGBc23wjU0c/BbiZQfDYO3L/xtfQojOME\n3mLpaWZlxRCEia1yMmWDVpmP9HxPfooEIlQjAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAB9w+Zza1811ywob7sNL2ckUhOnGDdVD\nta9ZoMiKoFtFgIdUUlnoZYPadNkJTl2ayABCgcmxyoxzu+RCgqRt06bnMo5nKm4a\nW6B3HLeuhn+GJGW0vm0icZlJ4U0m3c77+2CSqlax059NU51OrhHCTfj7IWzFiJQc\np0CBkqEAnggC7t0w6sDezoz4GxcuHNDT/mk8Lf8IiswoiBBu2FL2hQVGJdpTJhfX\ngFHEZt8jLuY3XjtNxcaLNAAmcM+3nGf4uFLqqMEznVltZDzER16/rksEjHmN2nCK\neucQDIdmpACkbVZVychpOS4kFx6qyMTtrGkWbiSKDpqivzR0IthSilI=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 11 0.6363636363636364 1521603213796
connected to auth! from local port 45084
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 12 0.5833333333333334 1521603273805
connected to auth! from local port 45256
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 13 0.5384615384615384 1521603333813
connected to auth! from local port 45442
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 14 0.5 1521603393823
connected to auth! from local port 45600
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 15 0.4666666666666667 1521603453834
connected to auth! from local port 45752
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 16 0.4375 1521603513844
connected to auth! from local port 45906
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 17 0.4117647058823529 1521603573855
connected to auth! from local port 46060
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 18 0.3888888888888889 1521603633865
connected to auth! from local port 46216
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 19 0.3684210526315789 1521603693875
connected to auth! from local port 46374
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 20 0.35 1521603753886
connected to auth! from local port 46520
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 21 0.3333333333333333 1521603813895
connected to auth! from local port 46668
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 22 0.3181818181818182 1521603873905
connected to auth! from local port 46822
received auth hello!
{ authId: 502, nonce: <Buffer 6f 8d 50 ee 23 e0 44 5c> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 25 e9 61 f0 8f 18 79 62>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 38 57 df 76 15 c4 f2 ed 75 3f 08 30 e8 45 b0 e0>,
  macKeyVal: <Buffer d5 80 ec 9f ea 00 4f fe 19 36 5b 20 ad ed d0 64 f6 19 32 03 c5 11 87 0c e8 85 a4 24 0b f0 68 50>,
  absValidity: 2018-03-21T04:45:13.557Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201586,
  cipherKeyVal: <Buffer 4b 99 2f 2e 2f fa ae 12 d9 26 f3 f9 dd 8d ba f1>,
  macKeyVal: <Buffer aa eb 20 ab de 64 59 d4 19 93 49 fe 8f b3 92 7c ee b6 2a 03 d7 7a c3 64 54 cf 60 c3 91 11 4b 4a>,
  absValidity: 2018-03-22T03:45:13.557Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.38',
  serverPort: 22100,
  sessionKey: 
   { id: 50201586,
     cipherKeyVal: <Buffer 4b 99 2f 2e 2f fa ae 12 d9 26 f3 f9 dd 8d ba f1>,
     macKeyVal: <Buffer aa eb 20 ab de 64 59 d4 19 93 49 fe 8f b3 92 7c ee b6 2a 03 d7 7a c3 64 54 cf 60 c3 91 11 4b 4a>,
     absValidity: 2018-03-22T03:45:13.557Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 21 58 e5 95 8c 77 01 e8>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 23 0.30434782608695654 1521603933926
connected to auth! from local port 46974
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.38:undefined
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 24 0.2916666666666667 1521603993936
connected to auth! from local port 47116
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 25 0.28 1521604053946
connected to auth! from local port 47254
received auth hello!
{ authId: 502, nonce: <Buffer a6 ca a1 56 62 98 96 23> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 18 8b 46 08 cf bf 50 50>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201617,
  cipherKeyVal: <Buffer bf 7b 62 0b 08 4e 89 0e 4c 36 30 42 27 41 2d f9>,
  macKeyVal: <Buffer c0 6f e0 61 43 65 0a c2 72 cb c6 c5 be 70 22 75 97 49 d7 f1 e1 0a a8 75 8c 3f c1 3e 5c 2e a8 4b>,
  absValidity: 2018-03-22T03:47:37.785Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.38',
  serverPort: 22100,
  sessionKey: 
   { id: 50201617,
     cipherKeyVal: <Buffer bf 7b 62 0b 08 4e 89 0e 4c 36 30 42 27 41 2d f9>,
     macKeyVal: <Buffer c0 6f e0 61 43 65 0a c2 72 cb c6 c5 be 70 22 75 97 49 d7 f1 e1 0a a8 75 8c 3f c1 3e 5c 2e a8 4b>,
     absValidity: 2018-03-22T03:47:37.785Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 03 b9 92 2c 5e dd 37 02>
switching to HANDSHAKE_1_SENT
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.38:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 26 0.2692307692307692 1521604113953
connected to auth! from local port 47408
received auth hello!
{ authId: 502, nonce: <Buffer da 93 48 19 09 5d 34 a1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d8 90 a4 7b e5 3e c8 95>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201633,
  cipherKeyVal: <Buffer 75 6f aa eb 96 17 b8 d4 89 71 31 25 5f ee 6a a6>,
  macKeyVal: <Buffer 18 ac b4 3d f0 7a de aa 09 6f 68 7b 8d c5 0f c3 43 f1 e3 c2 3e 2b c3 7a 8e fe 3e 2b 2a 8c 6a 76>,
  absValidity: 2018-03-22T03:48:41.791Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.38',
  serverPort: 22100,
  sessionKey: 
   { id: 50201633,
     cipherKeyVal: <Buffer 75 6f aa eb 96 17 b8 d4 89 71 31 25 5f ee 6a a6>,
     macKeyVal: <Buffer 18 ac b4 3d f0 7a de aa 09 6f 68 7b 8d c5 0f c3 43 f1 e3 c2 3e 2b c3 7a 8e fe 3e 2b 2a 8c 6a 76>,
     absValidity: 2018-03-22T03:48:41.791Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 29 26 9d 3f 93 f1 13 0b>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.38:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 27 0.25925925925925924 1521604173955
connected to auth! from local port 47556
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 28 0.25 1521604233965
connected to auth! from local port 47698
received auth hello!
{ authId: 502, nonce: <Buffer 55 64 4c b4 e7 aa 04 d6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 62 48 b9 09 e6 d1 5d c3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201670,
  cipherKeyVal: <Buffer 25 ae 36 3f 49 b1 c7 b0 4c e8 42 67 4c a2 c0 bf>,
  macKeyVal: <Buffer bf df d3 29 56 47 ed 5a fa 17 04 45 3e f4 ad 59 d5 8a 0a 38 0b 16 38 c4 57 7a 63 f4 96 fb 26 c9>,
  absValidity: 2018-03-22T03:51:21.795Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.38',
  serverPort: 22100,
  sessionKey: 
   { id: 50201670,
     cipherKeyVal: <Buffer 25 ae 36 3f 49 b1 c7 b0 4c e8 42 67 4c a2 c0 bf>,
     macKeyVal: <Buffer bf df d3 29 56 47 ed 5a fa 17 04 45 3e f4 ad 59 d5 8a 0a 38 0b 16 38 c4 57 7a 63 f4 96 fb 26 c9>,
     absValidity: 2018-03-22T03:51:21.795Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 25 d9 12 ee 76 13 03 91>
switching to HANDSHAKE_1_SENT
