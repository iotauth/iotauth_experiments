changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s506.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's506',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 51 49 42 41 41 4b 43 41 51 45 41 78 79 ... > }
Handler: listening on port 22100
s506:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100649
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55486
received auth hello!
{ authId: 501, nonce: <Buffer ae e5 b7 85 17 5b 1b 0e> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer ad 4c 05 ad 2e 13 6e 97>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 41 4c ca d7 f9 48 92 03 00 45 e6 83 d7 df 2a a8>,
  macKeyVal: <Buffer 96 61 24 88 3a 15 8c 4d c0 e5 b3 ce e9 85 bd 34 ab 7d c5 29 11 15 87 9c 7f da 65 74 f2 3d c6 16>,
  absValidity: 2018-03-21T04:22:58.360Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b6 e3 97 56 5b c7 27 84>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b6 e3 97 56 5b c7 27 84> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.70:37384',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100657
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55754
received auth hello!
{ authId: 501, nonce: <Buffer 65 8e 75 f8 fe 83 d8 de> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer dc b2 cf b2 b0 36 ba d2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 20 95 49 36 2e 54 c5 51>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 20 95 49 36 2e 54 c5 51> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.70:37652',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100665
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56026
received auth hello!
{ authId: 501, nonce: <Buffer 6c a1 5b b8 a3 bf b2 eb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 02 90 9d 4a f7 08 70 d9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1c 66 aa cb ee 05 20 36>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1c 66 aa cb ee 05 20 36> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.70:37922',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100673
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56298
received auth hello!
{ authId: 501, nonce: <Buffer a3 80 84 43 47 bb 24 8a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 36 54 c1 a8 51 0f 53 7e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ad e6 08 49 6f 19 30 28>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ad e6 08 49 6f 19 30 28> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.70:38196',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100681
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56568
received auth hello!
{ authId: 501, nonce: <Buffer d3 34 ea 6a c4 c9 6a 7c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b1 ac 99 c1 bf f7 ef ec>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9d 14 66 f3 43 58 ab 29>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 9d 14 66 f3 43 58 ab 29> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.70:38464',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100689
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56838
received auth hello!
{ authId: 501, nonce: <Buffer 21 6e 13 30 8b 69 ca 25> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 07 b5 f4 30 c4 23 86 bf>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 62 24 1c 58 2c e7 55 59>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 62 24 1c 58 2c e7 55 59> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.70:38736',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100697
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57108
received auth hello!
{ authId: 501, nonce: <Buffer b0 bc ed 2a 51 27 2c 9c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c0 07 e6 6e d7 46 94 c6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer db 3b d4 9e c5 db ca 8a>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer db 3b d4 9e c5 db ca 8a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.70:39004',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
