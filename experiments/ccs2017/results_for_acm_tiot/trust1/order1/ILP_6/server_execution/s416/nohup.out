changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s416.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's416',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 30 61 ... > }
Handler: listening on port 22100
s416:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300622
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40356
received auth hello!
{ authId: 403, nonce: <Buffer 4c 32 ce 6f a6 f3 61 2b> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 84 0e fa d1 1f ac 7a ed>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 60 c9 ca 94 24 b2 4c c2 dc 41 c6 9a 46 62 31 5a>,
  macKeyVal: <Buffer 62 98 3a 14 82 1e be df 2a b0 0e 20 12 dc f7 b0 22 e8 c9 3b 10 6f 96 2b eb ba a6 3a 5b 1b 98 d4>,
  absValidity: 2018-03-21T04:22:26.088Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 70 47 e2 02 25 ae 6b 37>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 70 47 e2 02 25 ae 6b 37> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.60:44088',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300623
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40362
received auth hello!
{ authId: 403, nonce: <Buffer 82 e7 7c d6 f5 aa 73 50> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e0 5a e5 9a 8f 1a 03 60>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 99 cb 25 1c 74 4d 6a 2f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 99 cb 25 1c 74 4d 6a 2f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.61:38418',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300628
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40568
received auth hello!
{ authId: 403, nonce: <Buffer eb 92 75 f2 d1 7f 99 2b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 18 d5 18 23 21 3e e0 68>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 95 bf 6e b3 c3 2e 14 c7>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 95 bf 6e b3 c3 2e 14 c7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.60:44300',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
disconnected from auth
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300629
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40584
received auth hello!
{ authId: 403, nonce: <Buffer a8 c1 ad c2 86 cb 13 91> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f7 85 1e 1a 70 51 c1 3b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d6 31 3d a3 70 18 e9 ae>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d6 31 3d a3 70 18 e9 ae> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.61:38640',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300634
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40840
received auth hello!
{ authId: 403, nonce: <Buffer 92 a3 0b c7 a3 3e 06 e1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5a 8b 2a 55 b8 af 5a 12>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 05 85 ea 4d f3 38 86 76>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 05 85 ea 4d f3 38 86 76> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.60:44572',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300635
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40856
received auth hello!
{ authId: 403, nonce: <Buffer 55 7e 84 f1 e6 96 36 c5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 40 e0 8e c0 2b 9e 07 cc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c9 f1 b2 c2 0d cb 7f 3f>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c9 f1 b2 c2 0d cb 7f 3f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.61:38912',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300640
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41110
received auth hello!
{ authId: 403, nonce: <Buffer 4e 3b 52 77 1b ea c0 4a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 44 a4 bf 34 7c 67 fc 44>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c1 42 ab 25 dc 9a 93 02>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c1 42 ab 25 dc 9a 93 02> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.60:44842',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300641
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41126
received auth hello!
{ authId: 403, nonce: <Buffer 87 b7 1f 13 57 e2 bc 6b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1b e5 2e 6c b1 0d 7b 6a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 83 18 78 94 ad b4 95 0a>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 83 18 78 94 ad b4 95 0a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.61:39182',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300646
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41380
received auth hello!
{ authId: 403, nonce: <Buffer 41 b5 f2 b1 50 ed ba 65> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer de 21 9c bb 62 df bc 21>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 34 03 4c f1 3a 1e 5b 4d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 34 03 4c f1 3a 1e 5b 4d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.60:45112',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300647
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41396
received auth hello!
{ authId: 403, nonce: <Buffer d4 21 60 de 5e 89 96 78> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cb 09 c7 0f 26 86 6a ab>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 30 9f be 3d 13 cb 3e 6a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 30 9f be 3d 13 cb 3e 6a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.61:39452',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300652
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41650
received auth hello!
{ authId: 403, nonce: <Buffer b6 c6 61 f6 74 d2 4d fb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b0 9b ee b7 3e cb e6 de>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 79 77 29 96 fd 94 f2 08>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 79 77 29 96 fd 94 f2 08> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.60:45382',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300653
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41666
received auth hello!
{ authId: 403, nonce: <Buffer 1e 54 d3 19 a3 61 56 9f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 35 71 e1 ec 1f 32 3f 07>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 70 ad e9 31 64 ef d9 8d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 70 ad e9 31 64 ef d9 8d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.61:39722',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300658
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41920
received auth hello!
{ authId: 403, nonce: <Buffer df 16 97 1a c0 41 41 34> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bb 8d 3b 02 0f 80 da e4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 95 db 6a 38 85 4b 9c 5b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 95 db 6a 38 85 4b 9c 5b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.60:45652',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300659
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41936
received auth hello!
{ authId: 403, nonce: <Buffer 50 ad ff 3e 34 b2 79 60> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 43 e7 54 db a7 f7 61 c2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 61 44 13 d2 48 6c 17 99>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 61 44 13 d2 48 6c 17 99> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.61:39992',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300664
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42186
received auth hello!
{ authId: 403, nonce: <Buffer 47 e0 ba 05 70 6d 16 ed> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 76 7d b8 9c 5f 16 40 51>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f9 c8 9b eb 74 d5 b2 d0>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f9 c8 9b eb 74 d5 b2 d0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.60:45918',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300665
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42202
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
