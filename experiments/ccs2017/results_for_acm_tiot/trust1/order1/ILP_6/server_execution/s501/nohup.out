changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s501.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's501',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 67 49 42 41 41 4b 43 41 51 45 41 79 34 ... > }
Handler: listening on port 22100
s501:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100643
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54732
received auth hello!
{ authId: 501, nonce: <Buffer 0f 4b 5b 21 29 12 b4 0b> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 94 c7 4f fa 2c 91 80 b8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 1b 23 65 7a e7 41 58 06 a7 ef 62 96 c9 44 53 8f>,
  macKeyVal: <Buffer 4f 70 75 74 76 fb 88 c8 ec 8c c9 06 39 2b 38 35 18 be 90 8e 83 26 90 45 b1 01 f4 51 ad aa 77 ff>,
  absValidity: 2018-03-21T04:22:31.430Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 27 b2 24 ce 5a e3 08 af>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 27 b2 24 ce 5a e3 08 af> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.62:36806',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100651
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54962
received auth hello!
{ authId: 501, nonce: <Buffer 7e fe f6 0c a2 18 eb 35> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b1 12 27 87 22 b7 f6 d2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f1 d8 eb 61 d8 8f d7 8f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f1 d8 eb 61 d8 8f d7 8f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.62:37036',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100659
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55232
received auth hello!
{ authId: 501, nonce: <Buffer 0d b2 c4 ed e8 85 99 73> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 15 c8 15 0f 32 08 7c 1f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer af b1 e2 52 4c a4 b3 a3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer af b1 e2 52 4c a4 b3 a3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.62:37306',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100667
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55502
received auth hello!
{ authId: 501, nonce: <Buffer a0 e8 b7 32 db 1d 72 b1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 93 44 80 8f 9e 44 b2 cc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer dd ca 8c 88 92 c1 5e 90>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer dd ca 8c 88 92 c1 5e 90> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.62:37576',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100675
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55772
received auth hello!
{ authId: 501, nonce: <Buffer 06 23 d5 e0 d8 64 f1 2e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3f e7 80 d5 a1 9e be 99>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bf 21 df 72 ee 0c 0f 75>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer bf 21 df 72 ee 0c 0f 75> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.62:37846',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100683
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56042
received auth hello!
{ authId: 501, nonce: <Buffer f0 fb 0a f1 31 70 75 29> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f0 8e 0d e9 76 65 b7 a6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 77 98 da 0e 99 f0 43 93>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 77 98 da 0e 99 f0 43 93> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.62:38116',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100691
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56312
received auth hello!
{ authId: 501, nonce: <Buffer db be 53 db ba 09 8f 05> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bb 23 de 38 ac 62 d4 4f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer db 85 7b 44 e1 61 d7 54>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer db 85 7b 44 e1 61 d7 54> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.62:38386',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
