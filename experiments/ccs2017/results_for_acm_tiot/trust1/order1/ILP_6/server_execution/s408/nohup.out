changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s408.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's408',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 6e 50 ... > }
Handler: listening on port 22100
s408:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200419
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57000
received auth hello!
{ authId: 402, nonce: <Buffer ca f1 c8 e7 db c8 be e6> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer f0 d2 98 99 f1 7c 4c ee>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer e0 d7 dd c9 56 a8 4e 67 f6 a5 bb 3b 39 9d ee 37>,
  macKeyVal: <Buffer 32 0b 69 0d 15 88 80 da ce fc d6 84 50 43 83 2f 8a 1c fc d7 98 85 20 29 ff a3 a6 77 ee 55 4e 22>,
  absValidity: 2018-03-21T04:21:59.430Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 64 fe d2 93 e9 d3 da ff>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 64 fe d2 93 e9 d3 da ff> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.52:51024',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200421
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57012
received auth hello!
{ authId: 402, nonce: <Buffer 1f 0b 8c 2e e1 6c 28 3f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e9 bb 80 dd c8 a7 a9 5b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a2 5e f6 65 b8 bc 3a ec>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a2 5e f6 65 b8 bc 3a ec> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.54:54780',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200426
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57168
received auth hello!
{ authId: 402, nonce: <Buffer 1c 9a 2c 48 47 38 20 6c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0e 73 4c 89 71 87 5b 9e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7b e3 91 63 f6 e9 23 b5>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 7b e3 91 63 f6 e9 23 b5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.52:51192',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200428
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57192
received auth hello!
{ authId: 402, nonce: <Buffer cb bc b2 39 fa 01 38 5e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3e 36 e4 38 53 5c ee b6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 33 65 1e ea 8c 39 ea 67>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 33 65 1e ea 8c 39 ea 67> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.54:54960',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200433
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57440
received auth hello!
{ authId: 402, nonce: <Buffer a8 5c 97 50 e1 66 62 b0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5a fe 9e cc 1b 88 ce 6f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0c 3e fd a6 de fc 89 15>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 0c 3e fd a6 de fc 89 15> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.52:51462',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200435
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57464
received auth hello!
{ authId: 402, nonce: <Buffer f3 c6 69 3b cb ee 62 24> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 01 ed 33 39 1b 05 34 84>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6d b7 e1 72 5d eb 3b 81>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6d b7 e1 72 5d eb 3b 81> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.54:55232',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200440
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57710
received auth hello!
{ authId: 402, nonce: <Buffer 22 54 04 38 1a 59 c2 c2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1a 05 da fb d1 ef 96 6b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 42 97 33 ab 0c 4c b7 53>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 42 97 33 ab 0c 4c b7 53> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.52:51734',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200442
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57734
received auth hello!
{ authId: 402, nonce: <Buffer e5 43 ad 00 2d 75 3a b3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 36 36 15 8e 64 e3 3d bb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 28 71 00 5e 7f c0 2e 32>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 28 71 00 5e 7f c0 2e 32> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.54:55502',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200447
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57980
received auth hello!
{ authId: 402, nonce: <Buffer 5a d8 cc 1a c1 24 75 44> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c8 e6 17 03 fe 64 77 0e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 01 21 b6 88 b5 85 3e 02>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 01 21 b6 88 b5 85 3e 02> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.52:52004',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200449
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58004
received auth hello!
{ authId: 402, nonce: <Buffer 43 38 e6 cd 78 a2 15 47> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d0 7b 21 b0 90 6f 45 cb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a3 45 0c 90 e3 db 49 2b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a3 45 0c 90 e3 db 49 2b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.54:55772',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200454
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58250
received auth hello!
{ authId: 402, nonce: <Buffer 5b 28 3f 1d 15 03 89 6a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3d ce 06 87 e7 59 6a 84>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 03 65 8d a7 b3 45 66 65>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 03 65 8d a7 b3 45 66 65> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.52:52274',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200456
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58274
received auth hello!
{ authId: 402, nonce: <Buffer 95 3c d3 b1 c4 bf c7 c4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7c 14 6d 7f 08 83 8b 47>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d8 2a 78 cd d5 6e f9 8f>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer d8 2a 78 cd d5 6e f9 8f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.54:56042',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200461
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58520
received auth hello!
{ authId: 402, nonce: <Buffer f5 3a 6b 2f b2 87 a1 75> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c9 a5 b1 c3 fb 28 f5 a9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e3 91 75 5b 1c 0a 56 aa>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e3 91 75 5b 1c 0a 56 aa> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.52:52544',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200463
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58544
received auth hello!
{ authId: 402, nonce: <Buffer c4 69 01 4e 13 40 e4 7c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a6 d3 98 67 7c 52 b5 f3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c1 44 0a d0 92 a1 82 4e>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c1 44 0a d0 92 a1 82 4e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.54:56312',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200468
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58790
received auth hello!
{ authId: 402, nonce: <Buffer ca eb 1f f3 72 d1 b8 1b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 30 2d 03 9d 6f c2 ee d1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 27 a9 f1 de d3 fb 38 69>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 27 a9 f1 de d3 fb 38 69> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.52:52814',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200470
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58814
received auth hello!
{ authId: 402, nonce: <Buffer 0d ea 11 3b af 37 dc fe> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 76 e5 c8 ed 2a 9e 0a 81>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5b 8b 7d d6 a8 2f 96 54>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5b 8b 7d d6 a8 2f 96 54> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.54:56582',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
