changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s518.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's518',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 51 49 42 41 41 4b 43 41 51 45 41 76 77 ... > }
Handler: listening on port 22100
s518:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400191
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35302
received auth hello!
{ authId: 504, nonce: <Buffer 31 27 d6 fa 31 06 5c 8d> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 4a 87 30 4b c1 92 f9 67>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer ec 2d cc 31 65 6f 2d 46 bf c6 e6 de 00 94 b5 81>,
  macKeyVal: <Buffer 40 f8 54 f8 e5 47 29 3f 5b a5 91 cb 3c 83 b9 89 c0 29 ac a1 72 54 fb 8b e1 19 c6 c0 c1 d1 de c1>,
  absValidity: 2018-03-21T04:23:48.767Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 59 67 57 d1 2c d5 93 cf>
switching to HANDSHAKE_2_SENT
Handler: Error in server - details: handshake2 timed out...
received session key handshake3!
{ replyNonce: <Buffer 59 67 57 d1 2c d5 93 cf> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.84:44644',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400193
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35334
received auth hello!
{ authId: 504, nonce: <Buffer e0 7c 10 eb 10 80 9a 16> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6b a4 00 80 a9 64 5a 25>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 94 11 8c fe 07 f7 c0 c7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 94 11 8c fe 07 f7 c0 c7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.85:60130',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400197
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35572
received auth hello!
{ authId: 504, nonce: <Buffer 41 7d e4 3f e8 43 a9 39> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 79 99 5d e0 9c 6b 37 68>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ae 81 48 c8 8b 3c 7e 94>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ae 81 48 c8 8b 3c 7e 94> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.84:44914',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400199
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35602
received auth hello!
{ authId: 504, nonce: <Buffer 21 79 d4 48 01 8a b8 04> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 62 fe 85 03 54 74 1b b9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b3 da 08 87 a9 f2 9d 82>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b3 da 08 87 a9 f2 9d 82> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.85:60400',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400203
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35842
received auth hello!
{ authId: 504, nonce: <Buffer 98 06 ed 84 ab 74 6d 51> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4e 91 71 33 69 a6 57 c2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 36 52 7d 4b 0b 05 82 c8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 36 52 7d 4b 0b 05 82 c8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.84:45184',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400205
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35872
received auth hello!
{ authId: 504, nonce: <Buffer 81 3d 52 9b 29 ae 12 96> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6c 37 f2 5f f8 5d 9d 2d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3a 65 08 0c 4f 19 f2 0c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3a 65 08 0c 4f 19 f2 0c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.85:60670',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400209
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36112
received auth hello!
{ authId: 504, nonce: <Buffer f7 94 95 42 8c ac d7 8b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e3 4c 75 90 a4 24 5a cd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4f a7 e8 03 d0 f4 ab 09>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4f a7 e8 03 d0 f4 ab 09> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.84:45454',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400211
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36142
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer 34 7f c6 3d 15 5e 73 b0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0d ef e8 26 45 6d e8 62>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6c 9a 25 0d e2 56 2d 82>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6c 9a 25 0d e2 56 2d 82> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.85:60940',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400215
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36382
received auth hello!
{ authId: 504, nonce: <Buffer 76 ca 37 fc 3e 84 49 4d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ac 54 b3 be 1d 7a 32 e1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bd 01 23 25 54 e7 93 f0>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer bd 01 23 25 54 e7 93 f0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.84:45724',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400217
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36412
received auth hello!
{ authId: 504, nonce: <Buffer 77 74 e3 4c a1 cc d1 92> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5b 7f 34 85 b6 52 75 e4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 79 d5 ff cf 4d 4e e3 3e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 79 d5 ff cf 4d 4e e3 3e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.85:32978',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400221
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36652
received auth hello!
{ authId: 504, nonce: <Buffer f2 de 4f 9d f9 24 58 ee> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 98 e1 b7 f6 1a 9c a2 94>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 73 98 82 ef 8d cd e7 aa>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 73 98 82 ef 8d cd e7 aa> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.84:45994',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400223
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36682
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer ee 84 60 a4 5e 56 f3 5d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4b 8b 4b 6f 80 05 c3 c1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 32 29 eb e1 ec 0c 38 52>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 32 29 eb e1 ec 0c 38 52> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.85:33248',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201429
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201433
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.7:21100
connected to auth! from local port 33602
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 41 e9 56 7b 1b 66 f0 93> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth504',
     commonName: '10.0.0.7' },
  serial: '016246926CD0',
  notBefore: 2018-03-21T03:18:44.000Z,
  notAfter: 2018-03-22T03:20:24.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'F8:81:DB:4C:A4:89:3E:C1:C4:B9:97:BF:F9:A8:1C:72:94:92:9C:0F',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'FF6CB5202497CC77AF28EFDE774858E4FEF04355E5228E378962DF4235BE3683DAF9E38A7E22621D66B3B50166D897E97BF911F9E8FC09D686961AA39679014E5DDD27EA0F02DE853A41537DB5E37F33395E249F355C0D074419572E9856D1D598CAB2CD6951013DDCB0A163B943DFCD2694BE18B9B3892695B3052EBD9115D447293C83AF24A008794B842E4F0A6C2A8D0189612A600AA40A592603E43713C0ECCA681024E5EC429FAD09484B824919DF59C8BD488E0D372D2A3D8B99B6068E24BBBDA8F0BCDDBA806010E4A7181736DF08D4D1CFC16E26507C360EDCBFF1B5F4288CE304DE62E9696665C5108489AD7232658356998FF47C4F7E8A04225423',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJGkmzQMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDQxETAPBgNVBAMMCDEwLjAuMC43MB4XDTE4MDMy\nMTAzMTg0NFoXDTE4MDMyMjAzMjAyNFowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQD/bLUgJJfMd68o7953SFjk/vBDVeUijjeJYt9CNb42g9r544p+\nImIdZrO1AWbYl+l7+RH56PwJ1oaWGqOWeQFOXd0n6g8C3oU6QVN9teN/MzleJJ81\nXA0HRBlXLphW0dWYyrLNaVEBPdywoWO5Q9/NJpS+GLmziSaVswUuvZEV1EcpPIOv\nJKAIeUuELk8KbCqNAYlhKmAKpApZJgPkNxPA7MpoECTl7EKfrQlIS4JJGd9ZyL1I\njg03LSo9i5m2Bo4ku72o8LzduoBgEOSnGBc23wjU0c/BbiZQfDYO3L/xtfQojOME\n3mLpaWZlxRCEia1yMmWDVpmP9HxPfooEIlQjAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAExpyvhS7LxfbbznCOjWQdVJY1AJmvtB\nMNuMmLgPAKlqU06FSUVcHVPjT/X4aN3OQxaTBUB+x4xgpr8hukB8oSXQZvJDCdeK\nU9nwvZzDcjZ5ugohbASY7BKr+Dorj9kuekP8oawxxlVQhjaNcS6GDyHTjeKzIFjF\nc67AmliBCuoLymW0RIL2WZpY4JG/DwV+mHxT0MHSjW9O5p0pWbIVpwtDYT+HqQdz\n/7cDJNlarAUj/dQLaafyQXwol0vCCdzISPi3nFhP3r9KfMHjFJY1bH5Ic5J4eBZI\nAndLHJD6Zzje/UPxwbTdeNA7Oj1X4A5QeQyt4Z47byQW+KGm0xeSn8U=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201450
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33782
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201462
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33916
received auth hello!
{ authId: 502, nonce: <Buffer 52 dc 1f b0 ab 22 9d 10> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer f1 65 e0 53 57 20 e9 8a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer bb 57 10 da c4 15 46 fe c7 de d6 32 b1 f2 32 a0>,
  macKeyVal: <Buffer 47 29 e3 68 dc 75 b2 e5 0e 82 ba 10 23 de 07 7b 17 5c 44 07 de 81 c1 e3 51 cd 1a b9 29 81 7c 6e>,
  absValidity: 2018-03-21T04:37:03.534Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 82 cc c5 c3 62 3f ad c2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 82 cc c5 c3 62 3f ad c2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.84:47462',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201479
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34084
received auth hello!
{ authId: 502, nonce: <Buffer b8 a4 75 e2 b4 93 9e ae> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7a d3 d9 47 9e 39 11 19>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 22 eb b1 b6 ba af 55 20>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 22 eb b1 b6 ba af 55 20> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.84:47630',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201480
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34098
received auth hello!
{ authId: 502, nonce: <Buffer cc 0f 51 45 11 fa 64 a1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 31 e5 e0 e3 6e da 3d 58>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 02 e3 29 3d 63 16 f5 5b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 02 e3 29 3d 63 16 f5 5b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.85:34866',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201498
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34284
received auth hello!
{ authId: 502, nonce: <Buffer a6 6b 9b 09 d8 ac 4e 0d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b1 62 5d e1 a9 ff cf 1e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 91 b3 4d 3d 64 73 b7 09>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 91 b3 4d 3d 64 73 b7 09> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.85:35052',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201509
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34394
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 9a 64 e0 e7 dd e5 d2 80> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 93 d9 4d fc a2 12 2c 5a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 09 92 52 d5 5d c3 aa 8f>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 09 92 52 d5 5d c3 aa 8f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.85:35164',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201524
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34548
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 71 9a af 13 13 bc fa f8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c3 a1 20 c0 9a be c5 72>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cf 37 c2 76 f6 5b ba 0b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer cf 37 c2 76 f6 5b ba 0b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.85:35318',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201542
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34726
Handler: Error in server - details: handshake2 timed out...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201553
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34840
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201554
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34844
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201569
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34996
received auth hello!
{ authId: 502, nonce: <Buffer e9 45 8c 86 f0 c1 ab 07> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e6 b2 8f 09 f0 bd d9 80>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b5 7e 4a 02 38 68 06 8b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b5 7e 4a 02 38 68 06 8b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.85:35766',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201570
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35004
received auth hello!
{ authId: 502, nonce: <Buffer 71 8b 27 93 9d 05 e1 54> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e7 f1 c5 36 0b 40 e4 8f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 54 0d d4 9d 55 b9 95 7e>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 54 0d d4 9d 55 b9 95 7e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.84:48550',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201580
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35114
received auth hello!
{ authId: 502, nonce: <Buffer 5f 95 d5 e7 e6 9e 17 83> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9b 77 b0 f1 38 23 cd 3f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 69 c0 88 d4 92 24 27 87>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 69 c0 88 d4 92 24 27 87> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.85:35884',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201615
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35482
received auth hello!
{ authId: 502, nonce: <Buffer 92 9d 85 05 ef 0c 15 9f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 11 6f c8 8b a4 dd 86 47>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 49 2b 06 f5 dc 9f e6 39>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 49 2b 06 f5 dc 9f e6 39> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.85:36252',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201657
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35926
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201659
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35940
Handler: Error in server - details: handshake2 timed out...
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 75 5a 59 4a 9a ad 03 cf> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e0 8a 98 d8 33 9e 7e 11>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 83 61 aa 22 88 40 b4 5c>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 83 61 aa 22 88 40 b4 5c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.84:49486',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
received auth hello!
{ authId: 502, nonce: <Buffer 3e 1c d6 98 bb eb 53 32> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ae 68 d5 98 c5 08 e5 e7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8d 6b 51 b8 73 b8 0c 0d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8d 6b 51 b8 73 b8 0c 0d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.85:36696',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201668
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36012
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201669
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36016
Handler: Error in server - details: Auth hello timedout ...
received auth hello!
{ authId: 502, nonce: <Buffer a7 f0 3d d2 a3 c7 32 21> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 96 3c 9a 6c da ab 5c a9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ca 02 a8 f2 67 2b 03 c9>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ca 02 a8 f2 67 2b 03 c9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 24,
  remoteAddress: '::ffff:10.0.1.85:36782',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 24 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 24 }
specified socketID: 24
received auth hello!
{ authId: 502, nonce: <Buffer 75 f9 39 a5 24 24 43 42> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer da cc 29 3a b6 c8 aa 52>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 87 a9 b2 d7 25 0c f6 de>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 87 a9 b2 d7 25 0c f6 de> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 25,
  remoteAddress: '::ffff:10.0.1.84:49562',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 25 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 25 }
specified socketID: 25
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #25 closed
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #24 closed
Handler: Error in server - details: Auth hello timedout ...
