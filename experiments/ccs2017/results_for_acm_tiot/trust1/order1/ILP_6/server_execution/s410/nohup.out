changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s410.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's410',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 76 6a ... > }
Handler: listening on port 22100
s410:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200420
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45684
received auth hello!
{ authId: 402, nonce: <Buffer b5 15 ec 8c b4 52 48 82> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 88 53 f9 b7 cc a6 6a 2e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer e9 db 22 91 8f 1f 76 f2 96 90 23 6f 81 df 54 98>,
  macKeyVal: <Buffer e1 56 0b 09 dc db 09 54 6e 18 48 12 1f 75 73 9e a9 c7 28 2a af d6 0c cb 36 91 f4 21 88 09 9b fd>,
  absValidity: 2018-03-21T04:22:03.439Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d4 42 05 61 1c a8 ac 5e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d4 42 05 61 1c a8 ac 5e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.53:48348',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200427
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 45858
received auth hello!
{ authId: 402, nonce: <Buffer c1 1e b5 93 34 92 79 db> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a1 1e 80 dd c1 34 fc e8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d6 84 fe 90 94 61 09 54>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d6 84 fe 90 94 61 09 54> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.53:48522',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200434
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46130
received auth hello!
{ authId: 402, nonce: <Buffer 27 0d 8f 4a 05 4d e9 d9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5c 60 a5 99 22 42 56 c8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f4 f4 d9 30 2d 55 05 59>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f4 f4 d9 30 2d 55 05 59> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.53:48794',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200441
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46400
received auth hello!
{ authId: 402, nonce: <Buffer 82 65 67 bc c5 78 18 81> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c4 8d 68 b8 d4 c8 be 2f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fe 63 b3 bb ed 49 d2 bc>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer fe 63 b3 bb ed 49 d2 bc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.53:49064',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200448
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46670
received auth hello!
{ authId: 402, nonce: <Buffer e6 cf e8 d9 f8 0f 4b 17> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1a 13 b4 f1 81 f1 d5 06>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bc 6b 7d 15 59 79 56 ad>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bc 6b 7d 15 59 79 56 ad> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.53:49334',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200455
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46940
received auth hello!
{ authId: 402, nonce: <Buffer cc 2a a0 39 5d 72 06 e3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 76 61 72 f8 b6 81 fe 1c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b6 23 8a 4b 23 e4 95 ac>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b6 23 8a 4b 23 e4 95 ac> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.53:49604',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200462
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47210
received auth hello!
{ authId: 402, nonce: <Buffer 96 5c 32 2d ac ed 44 db> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8d 94 5f 2c ff 5d 6e fd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 16 eb 88 78 12 12 61 34>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 16 eb 88 78 12 12 61 34> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.53:49874',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200469
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47480
received auth hello!
{ authId: 402, nonce: <Buffer e8 c6 b6 fa 71 1a 59 7d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2a 0d bb 86 c8 02 61 b5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 19 f8 c0 42 1c b2 36 94>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 19 f8 c0 42 1c b2 36 94> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.53:50144',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
