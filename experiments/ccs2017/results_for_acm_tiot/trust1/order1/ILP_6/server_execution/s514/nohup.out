changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s514.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's514',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 51 49 42 41 41 4b 43 41 51 45 41 73 38 ... > }
Handler: listening on port 22100
s514:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300736
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36626
received auth hello!
{ authId: 503, nonce: <Buffer 01 5e 5e 98 c8 2c c0 6d> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 69 cb 15 a1 0e e9 5d a9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 05 e4 e5 e3 e3 75 c9 40 5a 2c b0 ac bb 7f b6 02>,
  macKeyVal: <Buffer 04 10 39 00 ef fb 3d a2 cf b4 19 f3 8f be 69 cd f9 ed 18 70 94 35 69 48 ee 4c 0e 92 45 63 72 43>,
  absValidity: 2018-03-21T04:23:31.105Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e5 8c 46 dc de 1d fa 67>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e5 8c 46 dc de 1d fa 67> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.80:39836',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300741
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36896
received auth hello!
{ authId: 503, nonce: <Buffer e5 52 23 e9 03 66 18 bf> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6f 92 12 32 42 ce 79 04>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 33 46 6c 7d 04 1a e4 cf>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 33 46 6c 7d 04 1a e4 cf> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.80:40106',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300746
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37164
received auth hello!
{ authId: 503, nonce: <Buffer 82 77 2c a6 2f 0f 17 c0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 54 58 0e 95 16 df 2a 7f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 47 ec 88 6d 74 89 00 4a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 47 ec 88 6d 74 89 00 4a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.80:40376',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300751
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37434
received auth hello!
{ authId: 503, nonce: <Buffer 87 25 db ce 18 c3 c0 48> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 98 66 fa f5 c9 ba d8 29>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4a 79 d9 be a6 a3 c4 fa>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4a 79 d9 be a6 a3 c4 fa> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.80:40646',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300756
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37704
received auth hello!
{ authId: 503, nonce: <Buffer ad 99 f8 bf 4d 25 f1 cd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b5 28 b3 80 fa 7d d7 ff>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 56 2d 6e 48 e9 1d 97 63>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 56 2d 6e 48 e9 1d 97 63> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.80:40916',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300761
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37974
received auth hello!
{ authId: 503, nonce: <Buffer 1a a8 a1 e1 c4 43 26 0f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 04 70 77 74 5c 2f 1f 13>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a6 4d 6a c0 00 fe 12 1e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a6 4d 6a c0 00 fe 12 1e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.80:41186',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300766
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38240
received auth hello!
{ authId: 503, nonce: <Buffer da e4 49 dd 20 6b bb ca> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e9 f7 f1 e2 10 11 7f 7e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c3 41 a5 14 c7 3f a0 e0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c3 41 a5 14 c7 3f a0 e0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.80:41452',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
