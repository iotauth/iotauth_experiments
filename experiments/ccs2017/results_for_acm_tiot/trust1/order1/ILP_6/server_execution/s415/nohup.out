changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s415.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's415',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 67 49 42 41 41 4b 43 41 51 45 41 7a 43 ... > }
Handler: listening on port 22100
s415:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300621
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60882
received auth hello!
{ authId: 403, nonce: <Buffer 7d 41 6f 19 51 f0 ed 7c> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 94 3d 98 d1 d2 c6 68 59>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer ed f3 9c 7b 8e 41 07 e8 f4 1c a5 03 40 43 cc f6>,
  macKeyVal: <Buffer ee 3c 1f 4b 3d 3d 30 3d 17 a4 c9 46 36 cb 43 94 cd 57 a1 49 f0 3a 3a 62 aa 15 ca f3 be f3 36 83>,
  absValidity: 2018-03-21T04:22:22.108Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5a b9 df 7b 31 e3 f5 7e>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 5a b9 df 7b 31 e3 f5 7e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.59:53624',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300627
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 32860
received auth hello!
{ authId: 403, nonce: <Buffer 69 da c3 82 08 a0 78 30> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d3 b8 58 b7 09 9e 4b ed>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cf f9 5c c2 89 f3 c6 9c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer cf f9 5c c2 89 f3 c6 9c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.59:53830',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300633
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33130
received auth hello!
{ authId: 403, nonce: <Buffer 9d f9 95 7e bc 23 fe 55> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 34 96 04 76 90 d2 13 50>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 65 72 f2 8b 12 5b ba 9f>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 65 72 f2 8b 12 5b ba 9f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.59:54102',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300639
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33400
received auth hello!
{ authId: 403, nonce: <Buffer c2 45 06 8d 5f d4 65 61> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d6 25 f9 ba 19 e5 99 4b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 98 8d 97 6a 3e 32 74 9b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 98 8d 97 6a 3e 32 74 9b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.59:54372',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300645
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33670
received auth hello!
{ authId: 403, nonce: <Buffer 87 e0 a5 1b 9c 9b 31 03> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9c d4 c3 12 1c 2e 73 4d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer db 4e 00 7d 41 0f ad 6e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer db 4e 00 7d 41 0f ad 6e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.59:54644',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300651
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33940
received auth hello!
{ authId: 403, nonce: <Buffer 12 6e 0d 4e dc d8 f0 22> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 13 ef 51 cb 67 14 54 36>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b6 79 aa 7a 02 91 59 54>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b6 79 aa 7a 02 91 59 54> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.59:54912',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300657
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34210
received auth hello!
{ authId: 403, nonce: <Buffer be db 16 f4 3c 89 06 99> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 60 70 5e 85 ef aa cc 24>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7c 09 53 18 8b 54 e0 c5>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 7c 09 53 18 8b 54 e0 c5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.59:55182',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300663
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34476
received auth hello!
{ authId: 403, nonce: <Buffer c2 ad 54 5f c9 ea 0b 00> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e5 52 a1 b0 09 1d 61 32>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9d 0e 07 a3 2f f1 d2 c8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9d 0e 07 a3 2f f1 d2 c8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.59:55448',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
