changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s409.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's409',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 67 49 42 41 41 4b 43 41 51 45 41 6f 6c ... > }
Handler: listening on port 22100
s409:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200673
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33138
received auth hello!
{ authId: 402, nonce: <Buffer d7 14 3f ef 39 af da 6e> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 19 1f a4 63 be 75 b3 2b>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 40 8b 27 b2 4e 51 76 97 33 cb c9 58 e4 22 a1 08>,
  macKeyVal: <Buffer 3e ba 12 3a 74 4c cb 26 40 97 0a e3 28 fa 9a c2 d6 c4 eb ef e8 20 a5 ac 88 be f3 87 8a f0 b9 b6>,
  absValidity: 2018-03-21T17:56:49.784Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ca df ee 9d 4f 55 22 25>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ca df ee 9d 4f 55 22 25> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.55:50538',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200680
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33324
received auth hello!
{ authId: 402, nonce: <Buffer 49 86 b1 f4 5a 90 ef 7e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c7 1d ea 72 71 45 5b 72>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b9 e7 82 ab c1 7e 54 f7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b9 e7 82 ab c1 7e 54 f7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.55:50724',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200687
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33596
received auth hello!
{ authId: 402, nonce: <Buffer 39 fd 3e 9e df 29 65 75> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4c 7f cd c2 e4 3a a8 53>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fc 5c 3a 5f f7 43 3a 1c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer fc 5c 3a 5f f7 43 3a 1c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.55:50996',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200694
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33866
received auth hello!
{ authId: 402, nonce: <Buffer 7b 74 46 1b 73 22 2b 3b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ff 9e 19 27 69 cc 65 e5>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e2 ef 35 36 96 29 02 38>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e2 ef 35 36 96 29 02 38> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.55:51266',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200701
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34136
received auth hello!
{ authId: 402, nonce: <Buffer 3b e6 d4 04 2c f5 58 24> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ad a2 99 a1 3a 49 fe 75>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 80 12 38 dd f8 a9 ab 13>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 80 12 38 dd f8 a9 ab 13> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.55:51536',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200708
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34406
received auth hello!
{ authId: 402, nonce: <Buffer c3 6b b6 fb 3a c7 45 f4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9d 29 fa 3b 81 77 1b b8>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a5 5c 39 88 58 77 dc c4>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer a5 5c 39 88 58 77 dc c4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.55:51806',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200715
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34676
received auth hello!
{ authId: 402, nonce: <Buffer 95 ca 6d fc 54 af 2d 3d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 35 04 e5 bb e0 b9 35 48>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f7 55 0f cf 7d 02 0c 6b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f7 55 0f cf 7d 02 0c 6b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.55:52076',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
