changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s408.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's408',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 70 6f ... > }
Handler: listening on port 22100
s408:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200670
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53408
received auth hello!
{ authId: 402, nonce: <Buffer 40 a4 3d cb 5d 38 d1 dc> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer a6 2e 00 b4 b1 7f 5b af>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 31 77 fc 93 44 18 94 0e 1a 31 8a b1 1e f8 ae 08>,
  macKeyVal: <Buffer f9 95 30 81 10 16 ef a1 05 53 ab 6d e3 8b b3 e1 72 4b e8 a2 e1 ee 35 f1 f4 3f 6d 13 64 a7 ff 3c>,
  absValidity: 2018-03-21T17:56:37.730Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ee cb 66 a6 4a da c8 cc>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ee cb 66 a6 4a da c8 cc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.52:47432',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200672
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53420
received auth hello!
{ authId: 402, nonce: <Buffer 19 7b ca 85 85 b4 a8 c6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6a b6 c5 22 7a 84 22 98>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f5 b7 e9 5c 61 97 22 c4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f5 b7 e9 5c 61 97 22 c4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.54:51188',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200677
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53576
received auth hello!
{ authId: 402, nonce: <Buffer b2 25 48 25 44 94 75 31> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 20 8d 9d 4c da 31 09 ae>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 61 0e 4a c6 23 c1 5d 4e>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 61 0e 4a c6 23 c1 5d 4e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.52:47600',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200679
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53600
received auth hello!
{ authId: 402, nonce: <Buffer cf d7 ca c2 a1 76 8d 96> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a7 34 f6 7b a5 b9 1d b2>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6c 05 ba d1 78 17 56 2e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6c 05 ba d1 78 17 56 2e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.54:51368',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200684
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53848
received auth hello!
{ authId: 402, nonce: <Buffer bc aa 65 9a d4 8c 8d 07> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4c bc 87 5f 89 ee 10 6c>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ed 97 94 f2 b3 d2 10 25>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ed 97 94 f2 b3 d2 10 25> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.52:47872',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200686
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53872
received auth hello!
{ authId: 402, nonce: <Buffer f8 fd 93 39 cf 19 b2 aa> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 25 43 cb 7e 32 20 b3 87>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 09 ab a7 da d2 17 df da>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 09 ab a7 da d2 17 df da> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.54:51640',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200691
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54118
received auth hello!
{ authId: 402, nonce: <Buffer 47 82 4a d5 ef 1f 11 fa> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 05 ed 3d 4b 71 f3 f1 52>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer af c3 72 7e de 9b 3e 9e>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer af c3 72 7e de 9b 3e 9e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.52:48142',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200693
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54142
received auth hello!
{ authId: 402, nonce: <Buffer ee 12 12 c1 31 48 34 d0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6f 56 c3 5d 50 af d7 07>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 09 33 dc ae 1f 3b ef 36>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 09 33 dc ae 1f 3b ef 36> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.54:51910',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200698
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54388
received auth hello!
{ authId: 402, nonce: <Buffer 66 a6 13 66 17 27 88 ed> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0c 26 c4 f4 55 31 69 ac>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 30 a2 a5 fe cc c6 65 21>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 30 a2 a5 fe cc c6 65 21> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.52:48412',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200700
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54412
received auth hello!
{ authId: 402, nonce: <Buffer 5f 94 7c 06 26 83 17 f2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bd 66 9d d9 6d 69 18 02>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7d 53 ea 7c 20 53 b5 4b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 7d 53 ea 7c 20 53 b5 4b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.54:52180',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200705
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54658
received auth hello!
{ authId: 402, nonce: <Buffer 6f f1 42 40 c4 1c b7 27> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 57 96 cb da 91 a5 45 93>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a2 a6 65 2b 72 cc 9f 1f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a2 a6 65 2b 72 cc 9f 1f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.52:48682',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200707
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54682
received auth hello!
{ authId: 402, nonce: <Buffer 17 8e 75 98 ed c7 b5 fa> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9d e7 5a c2 4a 1c 0f 28>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c8 2d eb dd 19 f5 eb 8a>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c8 2d eb dd 19 f5 eb 8a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.54:52450',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200712
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54928
received auth hello!
{ authId: 402, nonce: <Buffer 33 b5 fa a8 4d 28 ab 9f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1d 9e 38 be 7b d8 3b 89>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 43 e0 74 d7 ef 2d 89 16>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 43 e0 74 d7 ef 2d 89 16> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.52:48952',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200714
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54952
received auth hello!
{ authId: 402, nonce: <Buffer d7 20 25 46 dc bb 47 ea> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 55 44 43 69 9f a2 8f ff>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b6 af 67 85 e3 c2 62 b9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b6 af 67 85 e3 c2 62 b9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.54:52720',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200719
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55194
received auth hello!
{ authId: 402, nonce: <Buffer a9 89 3d c7 c4 5f 21 58> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer aa 95 42 18 41 3f 55 cf>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer da aa 40 ba bd 6c c9 9b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer da aa 40 ba bd 6c c9 9b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.52:49218',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200721
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55218
received auth hello!
{ authId: 402, nonce: <Buffer 6a 24 96 61 0c 93 40 c0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0f dc fd 9e d7 e2 49 ec>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 36 0c 07 e9 39 b4 94 5c>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 36 0c 07 e9 39 b4 94 5c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.54:52986',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
