changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s406.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's406',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 33 6c ... > }
Handler: listening on port 22100
s406:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200668
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37832
received auth hello!
{ authId: 402, nonce: <Buffer 78 21 3c 18 5d 0d f8 70> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer e2 fb 74 86 7b d7 ad 69>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 6f 2d 74 69 ce dc 1e b1 02 9b f9 51 48 6e 2b 88>,
  macKeyVal: <Buffer ba 2a 25 58 1e 67 5a b1 c7 16 a7 0c 18 52 ce 7b d7 2c 4d 07 2b ac c6 7c 1b e9 73 47 9a ab 8d 67>,
  absValidity: 2018-03-21T17:56:30.520Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c4 76 c7 d4 5b c0 4c 2b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c4 76 c7 d4 5b c0 4c 2b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.50:52680',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200675
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37988
received auth hello!
{ authId: 402, nonce: <Buffer 45 46 fe 64 ad c4 39 89> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 03 ef 12 2b 45 72 d7 63>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b3 17 32 80 79 2f 63 e6>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b3 17 32 80 79 2f 63 e6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.50:52836',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200682
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38250
received auth hello!
{ authId: 402, nonce: <Buffer 39 cf 65 5f b2 13 55 3b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a0 59 bf 66 e4 db 44 24>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 08 19 f7 3a 18 39 82 98>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 08 19 f7 3a 18 39 82 98> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.50:53098',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200689
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38520
received auth hello!
{ authId: 402, nonce: <Buffer bb aa fc 21 45 af 3e 49> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 86 36 ce cc 10 c7 e7 0a>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2c 06 03 0a f5 67 28 78>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 2c 06 03 0a f5 67 28 78> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.50:53368',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200696
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38790
received auth hello!
{ authId: 402, nonce: <Buffer 65 c2 30 5a 16 57 f7 6f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e6 28 f7 39 c9 6d 37 b7>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e8 8c 32 15 4b 37 40 a4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e8 8c 32 15 4b 37 40 a4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.50:53638',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200703
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39060
received auth hello!
{ authId: 402, nonce: <Buffer 12 7f 5b ba 83 ce ec 89> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 18 6f be 90 44 74 19 59>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2f 94 84 9d a3 7c 95 35>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2f 94 84 9d a3 7c 95 35> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.50:53908',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200710
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39330
received auth hello!
{ authId: 402, nonce: <Buffer 95 18 8a 52 f3 d8 77 23> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 06 ec aa b2 11 32 6b e2>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cd 98 6e 30 1e ad 99 6f>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer cd 98 6e 30 1e ad 99 6f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.50:54178',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200717
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39600
received auth hello!
{ authId: 402, nonce: <Buffer 1b df 9f b5 fd 09 e7 1f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 41 4f 3f 8b 43 d8 9f 54>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 16 3a 13 01 66 0b 7e 64>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 16 3a 13 01 66 0b 7e 64> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.50:54448',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
