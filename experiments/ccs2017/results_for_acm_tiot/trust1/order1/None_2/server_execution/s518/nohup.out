changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s518.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's518',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 67 49 42 41 41 4b 43 41 51 45 41 33 62 ... > }
Handler: listening on port 22100
s518:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400267
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59942
received auth hello!
{ authId: 504, nonce: <Buffer 24 68 f2 47 a5 40 5c 3d> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 22 15 5b e5 9d 9a 5a 8a>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 18 98 5c 5f 30 69 73 89 4b 3d 0f bd bf 9e 9f b3>,
  macKeyVal: <Buffer a7 dd 3e d0 ac 15 ce bb d9 2f 71 1e ec 45 14 63 c3 51 c9 c4 f7 c2 d8 28 5a c1 c6 58 e0 13 0a 14>,
  absValidity: 2018-03-21T17:58:22.231Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 32 b8 d3 ef 60 9c 5a a8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 32 b8 d3 ef 60 9c 5a a8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.84:41052',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400269
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59974
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer 05 72 00 25 45 9b fd 1d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b0 bd 29 b9 9a 1a 26 80>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2c 30 0c b6 dd fb 35 8c>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 2c 30 0c b6 dd fb 35 8c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.85:56538',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
disconnected from auth
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400273
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60212
received auth hello!
{ authId: 504, nonce: <Buffer 60 e7 78 fd c2 8a 29 b4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e6 6f d2 05 a4 d6 4c f3>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 74 b3 50 6e 29 c7 7a 69>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 74 b3 50 6e 29 c7 7a 69> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.84:41322',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400275
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60244
received auth hello!
{ authId: 504, nonce: <Buffer ef a8 05 c9 e4 60 10 bd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 85 6d 97 86 a5 83 95 9d>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 39 24 b2 b3 d0 ae 7a 21>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 39 24 b2 b3 d0 ae 7a 21> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.85:56808',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400279
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60482
received auth hello!
{ authId: 504, nonce: <Buffer ca b2 09 74 96 23 77 da> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2f 1f d7 53 d8 29 0a e2>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c8 ec 73 a8 16 39 c4 87>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c8 ec 73 a8 16 39 c4 87> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.84:41592',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400281
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60514
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 504, nonce: <Buffer 07 7b 4d 1f 0d 7e ef a2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 28 95 8c 8a ca 84 23 ff>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fa 4f a4 da 0a 58 9a 04>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer fa 4f a4 da 0a 58 9a 04> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.85:57078',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400285
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60752
received auth hello!
{ authId: 504, nonce: <Buffer 83 e0 96 2d 1d 5f c3 fa> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 93 fd 62 84 3b 44 3d 91>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer eb 5e ae 74 b3 58 c4 6b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer eb 5e ae 74 b3 58 c4 6b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.84:41862',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400287
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60784
received auth hello!
{ authId: 504, nonce: <Buffer 29 fd 6c fc bd f9 bd f9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b3 58 2f dc 71 a6 e2 d6>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 44 54 65 ca ba 0a f9 17>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 44 54 65 ca ba 0a f9 17> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.85:57348',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400291
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 32790
received auth hello!
{ authId: 504, nonce: <Buffer 19 a2 0b 80 70 15 4b 77> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a8 25 23 8e b8 64 1c aa>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8f eb 67 a1 ed a9 6f a1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8f eb 67 a1 ed a9 6f a1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.84:42132',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400293
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 32822
received auth hello!
{ authId: 504, nonce: <Buffer 29 a0 92 6e 50 27 80 07> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 14 78 53 ca 8a 51 46 3c>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 14 d8 93 6f 6e da 61 50>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 14 d8 93 6f 6e da 61 50> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.85:57618',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400297
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33060
received auth hello!
{ authId: 504, nonce: <Buffer 65 4b 89 d7 15 cf b9 ab> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ad 84 fe fd ed 66 ab de>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3b f4 8f 48 83 14 d8 5f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3b f4 8f 48 83 14 d8 5f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.84:42402',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50400299
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33092
received auth hello!
{ authId: 504, nonce: <Buffer 97 86 d4 8a c0 7d 7c d5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2d 2e d8 bc be 59 de d7>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fa 16 08 f0 53 7d b9 29>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer fa 16 08 f0 53 7d b9 29> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.85:57888',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
