changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s407.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: false,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's407',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 6f 66 ... > }
Handler: listening on port 22100
s407:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200669
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54220
received auth hello!
{ authId: 402, nonce: <Buffer 18 ae 33 ae 59 69 7f b7> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer a6 2f 8f f1 50 f7 b1 1a>
auth nonce verified
updating distribution key: { cipherKeyVal: <Buffer 6b 30 e7 e4 bc e3 3b 34 44 20 ef 4f 13 a4 08 bd>,
  macKeyVal: <Buffer c5 f3 03 ca 79 ec 39 44 20 7c d7 79 4d 45 cd 43 a3 9e 33 49 39 f9 7b 44 6d 5b fb 41 67 f4 4e 5f>,
  absValidity: 2018-03-21T17:56:33.812Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f4 ad ca 03 c3 04 64 71>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f4 ad ca 03 c3 04 64 71> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.51:54616',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200676
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54382
received auth hello!
{ authId: 402, nonce: <Buffer d2 b0 54 68 97 c0 4a 0e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9d 94 74 eb f2 a3 74 6e>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 79 77 6d 42 ea fb 49 17>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 79 77 6d 42 ea fb 49 17> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.51:54778',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200683
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54650
received auth hello!
{ authId: 402, nonce: <Buffer 2f 04 80 04 f2 c9 84 6e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 85 2c 39 9d 1a 10 98 13>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 96 db 36 5f b1 90 0e d0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 96 db 36 5f b1 90 0e d0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.51:55046',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200690
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54920
received auth hello!
{ authId: 402, nonce: <Buffer 03 87 27 99 9e 8a 04 96> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 09 05 9e 73 b9 89 c5 b2>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 74 31 e3 b2 06 65 04 0c>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 74 31 e3 b2 06 65 04 0c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.51:55316',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200697
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55190
received auth hello!
{ authId: 402, nonce: <Buffer 02 94 45 0a 54 a5 c2 ee> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ac 6d 43 46 15 e6 8f b4>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bd 07 91 1a ac 41 f9 61>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bd 07 91 1a ac 41 f9 61> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.51:55586',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200704
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55460
received auth hello!
{ authId: 402, nonce: <Buffer c8 b6 f8 8d 06 6c 0a a4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 03 06 cc fd 88 d0 9b 81>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5a 68 47 9d c5 1f 10 e0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5a 68 47 9d c5 1f 10 e0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.51:55856',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200711
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55730
received auth hello!
{ authId: 402, nonce: <Buffer 73 52 16 b5 02 90 d9 a0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fe be 5d eb aa 8c ff 2f>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ca 56 48 3e da 74 8e 85>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ca 56 48 3e da 74 8e 85> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.51:56126',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200718
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56000
received auth hello!
{ authId: 402, nonce: <Buffer 23 96 24 a9 63 3c ae 74> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3e 88 0a a2 c9 aa a3 dd>
auth nonce verified
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 75 dc fb e0 b2 57 52 5c>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 75 dc fb e0 b2 57 52 5c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.51:56396',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
