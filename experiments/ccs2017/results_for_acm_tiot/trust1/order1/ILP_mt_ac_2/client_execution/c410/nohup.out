changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c410.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c410',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 67 49 42 41 41 4b 43 41 51 45 41 36 70 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521608562277
connected to auth! from local port 42004
received auth hello!
{ authId: 402, nonce: <Buffer 3b fa 23 f7 2f f0 dd 5b> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer af 48 d8 10 30 fa ce d6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer ac bf d8 eb 39 ea 71 ac ee 33 51 d5 49 5a 8c 6c>,
  macKeyVal: <Buffer ac f3 61 a0 00 05 6c 1d ca 6b 05 2b d9 eb d8 6d ef 4e 3d d9 df 08 95 ab 0e bc 99 71 bf 78 f1 09>,
  absValidity: 2018-03-21T06:02:42.444Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200199,
  cipherKeyVal: <Buffer 97 aa d0 12 8f 28 8b 0a ca 4b 4d 0a 70 82 86 5e>,
  macKeyVal: <Buffer 90 a1 ad da 76 36 be e1 20 a3 cb a2 21 80 a1 0e 62 06 84 84 8b 7b 91 c3 f2 99 33 4f 53 13 9a 4a>,
  absValidity: 2018-03-22T05:02:42.443Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200199,
     cipherKeyVal: <Buffer 97 aa d0 12 8f 28 8b 0a ca 4b 4d 0a 70 82 86 5e>,
     macKeyVal: <Buffer 90 a1 ad da 76 36 be e1 20 a3 cb a2 21 80 a1 0e 62 06 84 84 8b 7b 91 c3 f2 99 33 4f 53 13 9a 4a>,
     absValidity: 2018-03-22T05:02:42.443Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer c5 02 69 48 d9 6e 40 eb>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 05:02:43 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521608564077
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521608622336
connected to auth! from local port 42172
received auth hello!
{ authId: 402, nonce: <Buffer 35 af 74 63 98 5c 12 c9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 26 7f 2c 6a 3a 24 37 c5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200206,
  cipherKeyVal: <Buffer 37 37 17 4c 30 a9 89 e9 ba 42 9b 84 be b6 18 e3>,
  macKeyVal: <Buffer aa ab 71 85 91 e0 3c 9f 9f 96 3f 63 ae 8b 28 27 b0 1d 4c 60 8c cf ae a3 65 ee 0a 81 b2 73 2c 30>,
  absValidity: 2018-03-22T05:03:42.434Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200206,
     cipherKeyVal: <Buffer 37 37 17 4c 30 a9 89 e9 ba 42 9b 84 be b6 18 e3>,
     macKeyVal: <Buffer aa ab 71 85 91 e0 3c 9f 9f 96 3f 63 ae 8b 28 27 b0 1d 4c 60 8c cf ae a3 65 ee 0a 81 b2 73 2c 30>,
     absValidity: 2018-03-22T05:03:42.434Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer a4 a4 5a c3 df 04 70 b4>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 05:03:43 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521608624125
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521608682393
connected to auth! from local port 42444
received auth hello!
{ authId: 402, nonce: <Buffer f5 32 97 53 95 08 0a 49> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e8 62 33 7f b4 0b 11 e7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200213,
  cipherKeyVal: <Buffer 8b 2c cc ee 0a cf 0a a0 47 43 0b 3f 52 8e 5a 9e>,
  macKeyVal: <Buffer c6 8a eb ff 73 5a ce 02 53 de 9e 7c b3 e9 04 42 f2 57 b5 83 a9 6c cf db 54 e6 2e 2a b4 06 88 66>,
  absValidity: 2018-03-22T05:04:42.668Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200213,
     cipherKeyVal: <Buffer 8b 2c cc ee 0a cf 0a a0 47 43 0b 3f 52 8e 5a 9e>,
     macKeyVal: <Buffer c6 8a eb ff 73 5a ce 02 53 de 9e 7c b3 e9 04 42 f2 57 b5 83 a9 6c cf db 54 e6 2e 2a b4 06 88 66>,
     absValidity: 2018-03-22T05:04:42.668Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 65 0e 7c 10 5a 2f 78 68>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 05:04:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521608684531
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521608742452
connected to auth! from local port 42714
received auth hello!
{ authId: 402, nonce: <Buffer a5 ed 53 17 50 a0 16 6f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 55 f3 ac 12 cf 77 4f 43>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200220,
  cipherKeyVal: <Buffer 67 dc 22 a2 9a 5f 1f a6 38 2e d8 b0 2e 0c 7f ff>,
  macKeyVal: <Buffer b0 0c a7 72 c1 1e 7b 36 bf 2c 39 e3 36 d5 bf ae 33 87 0b b8 5e d2 e2 69 ed e6 8c 5b 9c f1 03 1e>,
  absValidity: 2018-03-22T05:05:42.588Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200220,
     cipherKeyVal: <Buffer 67 dc 22 a2 9a 5f 1f a6 38 2e d8 b0 2e 0c 7f ff>,
     macKeyVal: <Buffer b0 0c a7 72 c1 1e 7b 36 bf 2c 39 e3 36 d5 bf ae 33 87 0b b8 5e d2 e2 69 ed e6 8c 5b 9c f1 03 1e>,
     absValidity: 2018-03-22T05:05:42.588Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 94 32 d7 85 dd 88 ed ea>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 05:05:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521608744493
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521608802479
connected to auth! from local port 42984
received auth hello!
{ authId: 402, nonce: <Buffer 73 ea 06 f4 39 83 14 88> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b9 3d 7a 68 78 54 54 d2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200227,
  cipherKeyVal: <Buffer a9 a6 ab 1b c5 fa 70 2f c4 6f ed 52 f1 48 33 6b>,
  macKeyVal: <Buffer 01 1c a3 20 00 3f 68 0a eb d2 0a 7b 01 10 d6 96 39 da 25 ed d6 c2 e4 d4 bf e2 fd f7 61 93 ac f0>,
  absValidity: 2018-03-22T05:06:42.748Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200227,
     cipherKeyVal: <Buffer a9 a6 ab 1b c5 fa 70 2f c4 6f ed 52 f1 48 33 6b>,
     macKeyVal: <Buffer 01 1c a3 20 00 3f 68 0a eb d2 0a 7b 01 10 d6 96 39 da 25 ed d6 c2 e4 d4 bf e2 fd f7 61 93 ac f0>,
     absValidity: 2018-03-22T05:06:42.748Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 1b 00 f0 80 ed 77 e6 c5>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 05:06:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521608804500
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521608862533
connected to auth! from local port 43254
received auth hello!
{ authId: 402, nonce: <Buffer 53 7e 98 6b f3 35 de 0e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3c b8 e7 36 41 98 47 68>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200234,
  cipherKeyVal: <Buffer 88 e8 cd 8b dc 30 33 35 46 00 79 8e 45 d3 b5 b2>,
  macKeyVal: <Buffer db 6b 15 14 a3 d6 09 ea 22 62 af f4 33 5a 88 7d 04 19 54 03 2a 36 0d 14 a2 e1 d0 cf 3a e7 31 3a>,
  absValidity: 2018-03-22T05:07:42.853Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200234,
     cipherKeyVal: <Buffer 88 e8 cd 8b dc 30 33 35 46 00 79 8e 45 d3 b5 b2>,
     macKeyVal: <Buffer db 6b 15 14 a3 d6 09 ea 22 62 af f4 33 5a 88 7d 04 19 54 03 2a 36 0d 14 a2 e1 d0 cf 3a e7 31 3a>,
     absValidity: 2018-03-22T05:07:42.853Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer dc 03 85 bd 00 87 fd 9e>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 05:07:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521608864529
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521608922589
connected to auth! from local port 43524
received auth hello!
{ authId: 402, nonce: <Buffer 53 9a b9 38 93 3f e3 27> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2e bf 96 d2 fa 25 33 cb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200241,
  cipherKeyVal: <Buffer 99 c1 e4 a6 0a 04 10 a2 8e d7 4e 08 d1 e7 d1 6e>,
  macKeyVal: <Buffer de 1d 6d 49 c0 9c 8f fb eb ed f1 97 9f e5 11 dd 0a 34 4c a2 07 39 f1 5e c6 7b a0 20 44 1b 79 ee>,
  absValidity: 2018-03-22T05:08:42.866Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200241,
     cipherKeyVal: <Buffer 99 c1 e4 a6 0a 04 10 a2 8e d7 4e 08 d1 e7 d1 6e>,
     macKeyVal: <Buffer de 1d 6d 49 c0 9c 8f fb eb ed f1 97 9f e5 11 dd 0a 34 4c a2 07 39 f1 5e c6 7b a0 20 44 1b 79 ee>,
     absValidity: 2018-03-22T05:08:42.866Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 7a 55 ce b2 27 fa 42 aa>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 05:08:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521608924511
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521608982645
connected to auth! from local port 43794
received auth hello!
{ authId: 402, nonce: <Buffer 43 50 d3 8f 44 74 a8 b8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ec 0b eb db 5a a3 d6 f9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200248,
  cipherKeyVal: <Buffer 27 39 1c 31 cb d0 29 76 a2 40 65 f7 88 cb 63 80>,
  macKeyVal: <Buffer 10 95 aa 6e d6 28 d0 38 b8 f5 88 cd 34 fb b0 17 ad 99 0c 12 d4 d8 87 87 31 b5 0b d2 c2 bd a6 a4>,
  absValidity: 2018-03-22T05:09:42.907Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200248,
     cipherKeyVal: <Buffer 27 39 1c 31 cb d0 29 76 a2 40 65 f7 88 cb 63 80>,
     macKeyVal: <Buffer 10 95 aa 6e d6 28 d0 38 b8 f5 88 cd 34 fb b0 17 ad 99 0c 12 d4 d8 87 87 31 b5 0b d2 c2 bd a6 a4>,
     absValidity: 2018-03-22T05:09:42.907Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 64 a6 16 31 05 bd 34 15>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 05:09:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 8 1 1521608984520
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 9 0.8888888888888888 1521609042681
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 10 0.8 1521609102691
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 53342
received auth hello!
{ authId: 503, nonce: <Buffer 3e 61 d4 9c 76 5f 75 22> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth503',
     commonName: '10.0.1.6' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth402',
     commonName: '10.0.0.2' },
  serial: '016246EE9CC9',
  notBefore: 2018-03-21T04:59:25.000Z,
  notAfter: 2018-03-22T05:01:05.000Z,
  subjectHash: '5542437f',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'ED:59:C1:CD:8F:D8:22:41:D5:07:A3:DF:8D:4C:AF:0B:8D:7B:16:80',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'E2C77ADB548D185210E7FA2988369325521D9CF6957B61D640674333307D4FC133154B2C56A9BBCE5655BEDE59A620D2F68A660E6DEB43308DBAFD7A396559B1C6BD0ED769D2F4066CEB2BFDB38188C4D295C06D196ECCC621767B060A3D3BCF3CF4458D7031B2D0AB66B8846DD9C1D4374DEB5D3E30D68FF926574682526527828E3BB232E36626859A826F5DA69748C9567F01930811E1C310842AAE799D7FAD1E9BE8B5D23DC0BC0D4537FC44D1FE7D84E57938DEE6D651DAEC8C897885315FE2797FFB87939E2A342186F4C566B1623BD369CC0226678E3A96E9092471F81CCC14C868DBEA8B6F0B2E5D566294136E91C2B3B101366D8A5B6642614F0CF5',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.6' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 503,
  host: '10.0.1.6',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJG7pzJMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDIxETAPBgNVBAMMCDEwLjAuMC4yMB4XDTE4MDMy\nMTA0NTkyNVoXDTE4MDMyMjA1MDEwNVowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMzERMA8GA1UEAwwIMTAuMC4xLjYwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDix3rbVI0YUhDn+imINpMlUh2c9pV7YdZAZ0MzMH1PwTMVSyxW\nqbvOVlW+3lmmINL2imYObetDMI26/Xo5ZVmxxr0O12nS9AZs6yv9s4GIxNKVwG0Z\nbszGIXZ7Bgo9O8889EWNcDGy0KtmuIRt2cHUN03rXT4w1o/5JldGglJlJ4KOO7Iy\n42YmhZqCb12ml0jJVn8BkwgR4cMQhCqueZ1/rR6b6LXSPcC8DUU3/ETR/n2E5Xk4\n3ubWUdrsjIl4hTFf4nl/+4eTnio0IYb0xWaxYjvTacwCJmeOOpbpCSRx+BzMFMho\n2+qLbwsuXVZilBNukcKzsQE2bYpbZkJhTwz1AgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQYwDQYJKoZIhvcNAQELBQADggEBALMEUwPDm8I0xyKuhsItBhz9NBiTqlwm\nlxHlhbWBbdfIPGPY40mlsas1Lm1HVQVaQPEYU/d60AqUB9SC/fCrY3YOQLK5mM1O\n8fbSJjrQlmM3go6tKH4oWMQq8BIgB10+1c0p+XDR8EUPvp6ZEXWD17SBUb/mvwzg\nROmKid2Y0A1dMUukNN68TO2HScqHF6EzVsD5DiJGUPYtc+uj0+WDA9RfA54ECZH3\nzDNIgYGseyikjtxOdgl6oe8SnFQie9fM2xrpnjJRii6sUL0vwK7BkV/Nf01/qwAE\nNhmkwmuYwSJlmrdVgizIRQz0WOgUx/oC/0gbKc01BbvcU10qjfzog2w=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 11 0.7272727272727273 1521609162701
connected to auth! from local port 53598
received auth hello!
{ authId: 503, nonce: <Buffer a0 4a 1b e8 6e 6f 6e 63> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 7b 18 9f 0d ad 67 6c d1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 47 f4 af ee fe 22 fc 51 7c f4 45 93 21 37 aa 91>,
  macKeyVal: <Buffer 44 b4 f8 44 82 a2 8b 85 10 75 86 6b d6 ca 5e 2e 64 6a c5 3f f8 22 fa b5 bf 40 17 48 97 93 54 7b>,
  absValidity: 2018-03-21T06:12:42.855Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300188,
  cipherKeyVal: <Buffer fa e9 06 c0 da be b1 f9 f0 e4 e9 92 d5 a7 2b 7d>,
  macKeyVal: <Buffer 71 1b 4e fe 5e 12 ab 04 9f 7d b6 a7 52 59 01 72 ef 4a f0 36 9e 96 9c ea bf d2 8d dd aa 4a ec 57>,
  absValidity: 2018-03-22T05:12:42.855Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300188,
     cipherKeyVal: <Buffer fa e9 06 c0 da be b1 f9 f0 e4 e9 92 d5 a7 2b 7d>,
     macKeyVal: <Buffer 71 1b 4e fe 5e 12 ab 04 9f 7d b6 a7 52 59 01 72 ef 4a f0 36 9e 96 9c ea bf d2 8d dd aa 4a ec 57>,
     absValidity: 2018-03-22T05:12:42.855Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer ff 07 b4 91 11 5d 7d 32>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.15:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 12 0.6666666666666666 1521609222709
connected to auth! from local port 53870
received auth hello!
{ authId: 503, nonce: <Buffer 98 aa 88 70 f2 36 09 97> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d9 9f 4b d1 8d 37 35 a7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300198,
  cipherKeyVal: <Buffer 08 75 39 aa d5 88 13 0a 76 5f 7e 7c 3c d8 e5 21>,
  macKeyVal: <Buffer 44 1c 4b 71 87 44 4e 41 aa 57 ad ae f3 6b 51 24 c3 a7 65 53 b2 60 81 e8 2c cc 2f ba ff 69 f7 b7>,
  absValidity: 2018-03-22T05:13:42.969Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300198,
     cipherKeyVal: <Buffer 08 75 39 aa d5 88 13 0a 76 5f 7e 7c 3c d8 e5 21>,
     macKeyVal: <Buffer 44 1c 4b 71 87 44 4e 41 aa 57 ad ae f3 6b 51 24 c3 a7 65 53 b2 60 81 e8 2c cc 2f ba ff 69 f7 b7>,
     absValidity: 2018-03-22T05:13:42.969Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 4f 58 50 97 e8 4f 8a b0>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.15:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 13 0.6153846153846154 1521609282720
connected to auth! from local port 54150
received auth hello!
{ authId: 503, nonce: <Buffer 6f 43 87 7a d8 9b 5a 00> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3b a1 86 c8 e2 54 0d f2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300208,
  cipherKeyVal: <Buffer 27 48 5c e2 b6 d3 48 f5 c3 b3 5a 6e 61 4c 0a a3>,
  macKeyVal: <Buffer bb 31 f8 34 8c ff a0 12 8c d9 e2 48 bc a6 93 a9 c9 31 ab 65 0f d7 99 16 2e 48 72 05 9a 10 09 e6>,
  absValidity: 2018-03-22T05:14:43.365Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300208,
     cipherKeyVal: <Buffer 27 48 5c e2 b6 d3 48 f5 c3 b3 5a 6e 61 4c 0a a3>,
     macKeyVal: <Buffer bb 31 f8 34 8c ff a0 12 8c d9 e2 48 bc a6 93 a9 c9 31 ab 65 0f d7 99 16 2e 48 72 05 9a 10 09 e6>,
     absValidity: 2018-03-22T05:14:43.365Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 14 0.5714285714285714 1521609342777
connected to auth! from local port 54416
received auth hello!
{ authId: 503, nonce: <Buffer 74 70 05 c8 cf 4d 36 66> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6e 88 5f 4c fa fb dd 55>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300218,
  cipherKeyVal: <Buffer b3 1b db 8a 02 fc 0d 54 e2 34 3c 53 28 c1 da 9e>,
  macKeyVal: <Buffer db 98 ff fe 33 81 7a bd 0a af ac b4 3e 1c d1 ef 9c fe 2e b6 b6 e1 ec be 8b eb 16 20 b1 36 40 c0>,
  absValidity: 2018-03-22T05:15:43.448Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300218,
     cipherKeyVal: <Buffer b3 1b db 8a 02 fc 0d 54 e2 34 3c 53 28 c1 da 9e>,
     macKeyVal: <Buffer db 98 ff fe 33 81 7a bd 0a af ac b4 3e 1c d1 ef 9c fe 2e b6 b6 e1 ec be 8b eb 16 20 b1 36 40 c0>,
     absValidity: 2018-03-22T05:15:43.448Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 15 0.5333333333333333 1521609402833
connected to auth! from local port 54684
received auth hello!
{ authId: 503, nonce: <Buffer 90 93 15 32 26 6e 03 7f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bf 93 6c 8e 94 5a 59 bc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300228,
  cipherKeyVal: <Buffer 76 95 fc d1 19 74 5c d8 be 6a e9 a9 29 f9 80 f2>,
  macKeyVal: <Buffer 5c 4a 06 df 6b 8d be f2 17 e9 4c 90 2a d7 95 0c 45 83 26 e6 60 21 00 71 59 dc a4 30 eb d9 20 83>,
  absValidity: 2018-03-22T05:16:42.969Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300228,
     cipherKeyVal: <Buffer 76 95 fc d1 19 74 5c d8 be 6a e9 a9 29 f9 80 f2>,
     macKeyVal: <Buffer 5c 4a 06 df 6b 8d be f2 17 e9 4c 90 2a d7 95 0c 45 83 26 e6 60 21 00 71 59 dc a4 30 eb d9 20 83>,
     absValidity: 2018-03-22T05:16:42.969Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 16 0.5 1521609462893
connected to auth! from local port 54950
received auth hello!
{ authId: 503, nonce: <Buffer 7a 28 01 88 37 2a 31 53> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f7 d4 b7 d6 df dd 61 b8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300238,
  cipherKeyVal: <Buffer 79 94 2e 37 ad be 1a 03 53 e9 d2 0f 05 9f 51 ea>,
  macKeyVal: <Buffer 65 9a a8 3a d5 6a c5 e0 b0 d6 f0 69 f7 a7 3c 58 fb 6d 1e a6 90 c6 d3 c4 09 79 0a 57 70 99 f7 f1>,
  absValidity: 2018-03-22T05:17:43.046Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300238,
     cipherKeyVal: <Buffer 79 94 2e 37 ad be 1a 03 53 e9 d2 0f 05 9f 51 ea>,
     macKeyVal: <Buffer 65 9a a8 3a d5 6a c5 e0 b0 d6 f0 69 f7 a7 3c 58 fb 6d 1e a6 90 c6 d3 c4 09 79 0a 57 70 99 f7 f1>,
     absValidity: 2018-03-22T05:17:43.046Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 17 0.47058823529411764 1521609522954
connected to auth! from local port 55220
received auth hello!
{ authId: 503, nonce: <Buffer af 22 cd 59 48 97 ba 63> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 41 4a 0a 94 6c f1 c8 52>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300248,
  cipherKeyVal: <Buffer fc 1b 42 a5 5a de 11 6d 57 4d 99 28 a0 06 d3 9b>,
  macKeyVal: <Buffer ea 91 98 64 14 ef ef 18 dc 75 dd 09 2e 2f a9 75 1f f8 64 d5 51 41 6a 8e 4b 28 5c d0 78 d1 1c f4>,
  absValidity: 2018-03-22T05:18:43.533Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300248,
     cipherKeyVal: <Buffer fc 1b 42 a5 5a de 11 6d 57 4d 99 28 a0 06 d3 9b>,
     macKeyVal: <Buffer ea 91 98 64 14 ef ef 18 dc 75 dd 09 2e 2f a9 75 1f f8 64 d5 51 41 6a 8e 4b 28 5c d0 78 d1 1c f4>,
     absValidity: 2018-03-22T05:18:43.533Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 18 0.4444444444444444 1521609583014
connected to auth! from local port 55486
received auth hello!
{ authId: 503, nonce: <Buffer ed 58 f6 f8 1a 48 64 26> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 76 8d a7 fe d0 9b b1 9a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300258,
  cipherKeyVal: <Buffer e4 90 12 ae 05 bf ab bd 94 ef 16 d2 8f 33 e9 b9>,
  macKeyVal: <Buffer cc a0 75 14 49 03 23 de e1 3f 9a 33 78 dc 30 a4 46 43 57 c7 11 24 48 c0 d8 d7 6a bb 58 9d 16 10>,
  absValidity: 2018-03-22T05:19:43.584Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300258,
     cipherKeyVal: <Buffer e4 90 12 ae 05 bf ab bd 94 ef 16 d2 8f 33 e9 b9>,
     macKeyVal: <Buffer cc a0 75 14 49 03 23 de e1 3f 9a 33 78 dc 30 a4 46 43 57 c7 11 24 48 c0 d8 d7 6a bb 58 9d 16 10>,
     absValidity: 2018-03-22T05:19:43.584Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 19 0.42105263157894735 1521609643026
connected to auth! from local port 55752
received auth hello!
{ authId: 503, nonce: <Buffer bf 6c 7b 52 12 35 a9 6f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9e a4 75 df c0 63 73 99>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300268,
  cipherKeyVal: <Buffer 3f 6e 8c 8f a2 b9 d7 92 00 8d d9 60 a0 61 f0 e0>,
  macKeyVal: <Buffer f9 58 d7 bb ad 41 11 af 92 75 2d 84 37 4b 2a 31 9c 83 0b b7 a1 a2 8e f4 1d 53 08 3e c7 c1 31 eb>,
  absValidity: 2018-03-22T05:20:43.630Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300268,
     cipherKeyVal: <Buffer 3f 6e 8c 8f a2 b9 d7 92 00 8d d9 60 a0 61 f0 e0>,
     macKeyVal: <Buffer f9 58 d7 bb ad 41 11 af 92 75 2d 84 37 4b 2a 31 9c 83 0b b7 a1 a2 8e f4 1d 53 08 3e c7 c1 31 eb>,
     absValidity: 2018-03-22T05:20:43.630Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 20 0.4 1521609703048
connected to auth! from local port 56014
received auth hello!
{ authId: 503, nonce: <Buffer 37 fd 0c 47 7e bb 19 1e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 59 c7 f2 0c d8 ee 65 ba>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300278,
  cipherKeyVal: <Buffer c8 83 ec 50 cc 68 df df ff 01 bf 03 8d 12 a7 1c>,
  macKeyVal: <Buffer 17 27 7c 84 f8 9b 70 85 98 5e b6 d2 3b f5 b6 d6 d4 65 37 70 03 63 23 c4 57 6e 03 1c 46 81 95 87>,
  absValidity: 2018-03-22T05:21:43.674Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300278,
     cipherKeyVal: <Buffer c8 83 ec 50 cc 68 df df ff 01 bf 03 8d 12 a7 1c>,
     macKeyVal: <Buffer 17 27 7c 84 f8 9b 70 85 98 5e b6 d2 3b f5 b6 d6 d4 65 37 70 03 63 23 c4 57 6e 03 1c 46 81 95 87>,
     absValidity: 2018-03-22T05:21:43.674Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 21 0.38095238095238093 1521609763104
connected to auth! from local port 56284
received auth hello!
{ authId: 503, nonce: <Buffer 2c fc f5 f2 34 a0 85 54> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 08 ff 99 f9 72 55 42 47>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300288,
  cipherKeyVal: <Buffer ad 98 51 f6 66 77 2b 90 1b 50 bd 9e de 02 bb 4a>,
  macKeyVal: <Buffer dc 95 51 f8 53 cd 7b 92 c8 d5 ea 41 1c 97 99 ea 2d 75 e2 a8 8c 95 ad 25 c3 0d 83 a6 2d 28 2d 73>,
  absValidity: 2018-03-22T05:22:43.739Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300288,
     cipherKeyVal: <Buffer ad 98 51 f6 66 77 2b 90 1b 50 bd 9e de 02 bb 4a>,
     macKeyVal: <Buffer dc 95 51 f8 53 cd 7b 92 c8 d5 ea 41 1c 97 99 ea 2d 75 e2 a8 8c 95 ad 25 c3 0d 83 a6 2d 28 2d 73>,
     absValidity: 2018-03-22T05:22:43.739Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 22 0.36363636363636365 1521609823163
connected to auth! from local port 56546
received auth hello!
{ authId: 503, nonce: <Buffer 3a 2a d4 14 d4 9e d0 7d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer da 75 a8 d9 3f fa 28 8f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300298,
  cipherKeyVal: <Buffer 7e 2f d0 30 fd c3 bd bc 60 3e 80 cd ea ea e6 61>,
  macKeyVal: <Buffer d0 a5 00 ca 17 14 37 e0 c0 b9 f0 b6 d2 9b 4c 7e 64 42 53 1f 0a 1b db 60 7a 7a f8 70 a9 3e ab 95>,
  absValidity: 2018-03-22T05:23:43.809Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300298,
     cipherKeyVal: <Buffer 7e 2f d0 30 fd c3 bd bc 60 3e 80 cd ea ea e6 61>,
     macKeyVal: <Buffer d0 a5 00 ca 17 14 37 e0 c0 b9 f0 b6 d2 9b 4c 7e 64 42 53 1f 0a 1b db 60 7a 7a f8 70 a9 3e ab 95>,
     absValidity: 2018-03-22T05:23:43.809Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 23 0.34782608695652173 1521609883221
connected to auth! from local port 56808
received auth hello!
{ authId: 503, nonce: <Buffer 4b 22 89 16 19 6f bf 31> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ce 30 79 7f f9 16 55 58>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300308,
  cipherKeyVal: <Buffer af 9c 0a 6d 84 84 d1 1c dc bf e6 43 00 ec ef c0>,
  macKeyVal: <Buffer 2f 05 cd 02 0c 89 93 44 9e 6e a2 f7 88 12 d7 39 47 18 1f a7 22 a2 07 92 eb 8f d5 4f 5f 01 2a b4>,
  absValidity: 2018-03-22T05:24:43.441Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300308,
     cipherKeyVal: <Buffer af 9c 0a 6d 84 84 d1 1c dc bf e6 43 00 ec ef c0>,
     macKeyVal: <Buffer 2f 05 cd 02 0c 89 93 44 9e 6e a2 f7 88 12 d7 39 47 18 1f a7 22 a2 07 92 eb 8f d5 4f 5f 01 2a b4>,
     absValidity: 2018-03-22T05:24:43.441Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 24 0.3333333333333333 1521609943281
connected to auth! from local port 57082
received auth hello!
{ authId: 503, nonce: <Buffer 39 e7 59 42 cd a1 fb 70> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer df d4 19 0a a6 b5 db 3c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300318,
  cipherKeyVal: <Buffer c2 9c 6b 3c d1 d1 4c a2 c5 2c b3 8d 4f 9b 15 c2>,
  macKeyVal: <Buffer 36 87 49 ec ce 0c 66 b3 0b 50 8a f9 88 95 14 1d c1 01 11 58 12 ce 09 3f 75 33 9a a1 0a be 90 df>,
  absValidity: 2018-03-22T05:25:43.876Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300318,
     cipherKeyVal: <Buffer c2 9c 6b 3c d1 d1 4c a2 c5 2c b3 8d 4f 9b 15 c2>,
     macKeyVal: <Buffer 36 87 49 ec ce 0c 66 b3 0b 50 8a f9 88 95 14 1d c1 01 11 58 12 ce 09 3f 75 33 9a a1 0a be 90 df>,
     absValidity: 2018-03-22T05:25:43.876Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 25 0.32 1521610003341
connected to auth! from local port 57348
received auth hello!
{ authId: 503, nonce: <Buffer d0 08 41 e1 aa 48 b4 a9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 54 3c 81 33 27 cc 0d ae>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300328,
  cipherKeyVal: <Buffer e9 d3 bb 51 a2 67 29 26 e9 ca eb 4e 7f 3f 1d b8>,
  macKeyVal: <Buffer 9a 4d 29 94 e6 c4 3c cf 28 60 b6 7d 90 ba 08 bd 2e 73 df 81 73 b4 3f 02 4d c6 38 4a 6c 09 03 2d>,
  absValidity: 2018-03-22T05:26:43.943Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300328,
     cipherKeyVal: <Buffer e9 d3 bb 51 a2 67 29 26 e9 ca eb 4e 7f 3f 1d b8>,
     macKeyVal: <Buffer 9a 4d 29 94 e6 c4 3c cf 28 60 b6 7d 90 ba 08 bd 2e 73 df 81 73 b4 3f 02 4d c6 38 4a 6c 09 03 2d>,
     absValidity: 2018-03-22T05:26:43.943Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 26 0.3076923076923077 1521610063397
connected to auth! from local port 57610
received auth hello!
{ authId: 503, nonce: <Buffer 48 95 0c 2e f5 46 00 fb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7e a0 2c 3c 16 16 9e 7a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300338,
  cipherKeyVal: <Buffer 24 e7 08 92 7a 89 c8 f6 49 3c 82 8d b1 06 70 39>,
  macKeyVal: <Buffer 49 40 bc 8e 34 ae 98 b5 fc 62 8e 2f fc 1a 13 ad 3b 8f 90 8e 99 f5 19 d2 96 d9 ea 0c 40 d8 3d bc>,
  absValidity: 2018-03-22T05:27:43.922Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300338,
     cipherKeyVal: <Buffer 24 e7 08 92 7a 89 c8 f6 49 3c 82 8d b1 06 70 39>,
     macKeyVal: <Buffer 49 40 bc 8e 34 ae 98 b5 fc 62 8e 2f fc 1a 13 ad 3b 8f 90 8e 99 f5 19 d2 96 d9 ea 0c 40 d8 3d bc>,
     absValidity: 2018-03-22T05:27:43.922Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 27 0.2962962962962963 1521610123453
connected to auth! from local port 57876
received auth hello!
{ authId: 503, nonce: <Buffer a4 04 37 44 df f1 65 3f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a9 c3 ec 64 a6 ed a0 96>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300348,
  cipherKeyVal: <Buffer 4a 7e 6b 48 9c 97 82 05 ec cf 17 82 fd 3e 60 c0>,
  macKeyVal: <Buffer 1b df 56 c4 cb e2 4d 5f 3b bf ce 8a e0 9a 0c ea 34 80 5a 0a e8 23 ae bf 9a 13 e8 80 cd 31 9b 90>,
  absValidity: 2018-03-22T05:28:43.968Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300348,
     cipherKeyVal: <Buffer 4a 7e 6b 48 9c 97 82 05 ec cf 17 82 fd 3e 60 c0>,
     macKeyVal: <Buffer 1b df 56 c4 cb e2 4d 5f 3b bf ce 8a e0 9a 0c ea 34 80 5a 0a e8 23 ae bf 9a 13 e8 80 cd 31 9b 90>,
     absValidity: 2018-03-22T05:28:43.968Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 28 0.2857142857142857 1521610183513
connected to auth! from local port 58142
received auth hello!
{ authId: 503, nonce: <Buffer 1f 7a 48 77 b0 e8 5d a0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2f f0 7f 6e 39 c6 19 dd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300358,
  cipherKeyVal: <Buffer f5 dd 6c 3c 30 75 ba 08 1a f3 4c ca 0a 43 cb 8e>,
  macKeyVal: <Buffer 5b 53 b9 e1 74 ca 6a 51 8d c6 7e cd 2f d8 88 8f fc 8f ce 01 16 1b f3 e1 18 61 72 7f 7b 6d f9 5c>,
  absValidity: 2018-03-22T05:29:44.019Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300358,
     cipherKeyVal: <Buffer f5 dd 6c 3c 30 75 ba 08 1a f3 4c ca 0a 43 cb 8e>,
     macKeyVal: <Buffer 5b 53 b9 e1 74 ca 6a 51 8d c6 7e cd 2f d8 88 8f fc 8f ce 01 16 1b f3 e1 18 61 72 7f 7b 6d f9 5c>,
     absValidity: 2018-03-22T05:29:44.019Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
