changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c412.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c412',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 78 2b ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521608568670
connected to auth! from local port 40574
received auth hello!
{ authId: 402, nonce: <Buffer ce 8c f9 11 78 f7 f0 dc> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 77 79 6e 51 e0 68 ee d5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 95 58 58 38 e0 a5 04 f5 eb 84 68 9e 16 ca 23 18>,
  macKeyVal: <Buffer df b9 af ab ee 92 0e 48 b7 3c 8e a1 8a 65 d7 e6 53 ca 92 d8 28 f1 bc cf 51 c1 1f 9f 6f 5e ca ac>,
  absValidity: 2018-03-21T06:02:49.765Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200201,
  cipherKeyVal: <Buffer bb 09 1d 7b 5d bd e4 c2 4b 33 e7 e8 1f 19 32 5a>,
  macKeyVal: <Buffer 71 78 3f 5a d3 48 12 8e 24 d8 3f 5c 0f 74 59 fd b1 0e f6 ba 3a d1 09 96 a9 33 62 e6 87 f4 67 79>,
  absValidity: 2018-03-22T05:02:49.764Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200201,
     cipherKeyVal: <Buffer bb 09 1d 7b 5d bd e4 c2 4b 33 e7 e8 1f 19 32 5a>,
     macKeyVal: <Buffer 71 78 3f 5a d3 48 12 8e 24 d8 3f 5c 0f 74 59 fd b1 0e f6 ba 3a d1 09 96 a9 33 62 e6 87 f4 67 79>,
     absValidity: 2018-03-22T05:02:49.764Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 35 49 76 b5 4a 2c 6b d8>
switching to HANDSHAKE_1_SENT
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 05:02:51 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521608572071
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521608628726
connected to auth! from local port 40754
received auth hello!
{ authId: 402, nonce: <Buffer 96 e3 db 70 77 56 58 88> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5a 42 e9 a2 42 31 bd e8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200208,
  cipherKeyVal: <Buffer 2e 9c 89 40 6d 3e c5 7e cb 12 75 7d b9 b8 f7 0f>,
  macKeyVal: <Buffer 78 97 33 4d dd 32 54 61 5d 63 9c cd dd 18 fb 48 41 3f 4c da ae ad 71 41 e8 68 c6 51 b3 96 37 b2>,
  absValidity: 2018-03-22T05:03:49.795Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200208,
     cipherKeyVal: <Buffer 2e 9c 89 40 6d 3e c5 7e cb 12 75 7d b9 b8 f7 0f>,
     macKeyVal: <Buffer 78 97 33 4d dd 32 54 61 5d 63 9c cd dd 18 fb 48 41 3f 4c da ae ad 71 41 e8 68 c6 51 b3 96 37 b2>,
     absValidity: 2018-03-22T05:03:49.795Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 98 93 3c 01 17 36 ee a5>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 05:03:51 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521608632270
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521608688784
connected to auth! from local port 41026
received auth hello!
{ authId: 402, nonce: <Buffer 2e 64 c7 9f 69 86 df f6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 85 e9 82 b9 b6 b5 9a fc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200215,
  cipherKeyVal: <Buffer 1e c0 57 7b da aa be ce 9a 85 18 81 d2 7a b8 19>,
  macKeyVal: <Buffer 11 ac ea 48 67 2a 11 ff 89 f9 f2 47 03 de c5 d6 65 99 54 d8 23 9c df 73 b3 9b fd 5f 47 a2 54 b1>,
  absValidity: 2018-03-22T05:04:49.881Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200215,
     cipherKeyVal: <Buffer 1e c0 57 7b da aa be ce 9a 85 18 81 d2 7a b8 19>,
     macKeyVal: <Buffer 11 ac ea 48 67 2a 11 ff 89 f9 f2 47 03 de c5 d6 65 99 54 d8 23 9c df 73 b3 9b fd 5f 47 a2 54 b1>,
     absValidity: 2018-03-22T05:04:49.881Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer f1 0f 63 b7 cc e9 de 5c>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 05:04:52 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521608692519
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521608748835
connected to auth! from local port 41296
received auth hello!
{ authId: 402, nonce: <Buffer 3c 81 4c 5c 7c 17 63 19> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a5 a4 6f 20 00 86 7c ea>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200222,
  cipherKeyVal: <Buffer 90 d5 fd 68 fa b6 a3 e3 b7 ee 0e d4 01 b8 92 67>,
  macKeyVal: <Buffer 80 dd 8f 4b 48 03 23 01 fc 2f 67 01 9d 13 77 17 5e ae 8f ca 9a 7f 2a 05 e7 72 60 e2 0d dd 13 ef>,
  absValidity: 2018-03-22T05:05:49.925Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200222,
     cipherKeyVal: <Buffer 90 d5 fd 68 fa b6 a3 e3 b7 ee 0e d4 01 b8 92 67>,
     macKeyVal: <Buffer 80 dd 8f 4b 48 03 23 01 fc 2f 67 01 9d 13 77 17 5e ae 8f ca 9a 7f 2a 05 e7 72 60 e2 0d dd 13 ef>,
     absValidity: 2018-03-22T05:05:49.925Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer df 68 95 b9 be 2b 11 59>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 05:05:52 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521608752473
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521608808889
connected to auth! from local port 41566
received auth hello!
{ authId: 402, nonce: <Buffer 76 df 91 5e 94 74 e0 1f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 25 4d 05 d1 56 81 ae 56>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200229,
  cipherKeyVal: <Buffer 3f 22 0f 3e d5 7f b1 7d d7 11 25 ec f6 89 dd 33>,
  macKeyVal: <Buffer 51 87 a2 3b db d4 30 b1 f7 7e 23 f4 26 ed d7 4e 21 5a e3 17 a2 aa 53 37 18 24 7b 94 6b 85 1c 87>,
  absValidity: 2018-03-22T05:06:49.984Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200229,
     cipherKeyVal: <Buffer 3f 22 0f 3e d5 7f b1 7d d7 11 25 ec f6 89 dd 33>,
     macKeyVal: <Buffer 51 87 a2 3b db d4 30 b1 f7 7e 23 f4 26 ed d7 4e 21 5a e3 17 a2 aa 53 37 18 24 7b 94 6b 85 1c 87>,
     absValidity: 2018-03-22T05:06:49.984Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer e7 a1 d7 fc 0b 88 7c ea>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 05:06:52 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521608812498
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521608868946
connected to auth! from local port 41836
received auth hello!
{ authId: 402, nonce: <Buffer 3e bc d1 b4 01 d3 41 43> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer dc d6 cb 8a 27 2c ee 22>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200236,
  cipherKeyVal: <Buffer 90 41 bc 0e 04 d5 06 ec 1b 14 2e d3 10 34 b5 0c>,
  macKeyVal: <Buffer d6 34 9f b1 a0 ad b8 08 d9 84 53 c2 96 7b d7 2e 1e 06 1e 95 58 99 8b 08 73 fa a9 42 df 92 5e 6f>,
  absValidity: 2018-03-22T05:07:50.008Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200236,
     cipherKeyVal: <Buffer 90 41 bc 0e 04 d5 06 ec 1b 14 2e d3 10 34 b5 0c>,
     macKeyVal: <Buffer d6 34 9f b1 a0 ad b8 08 d9 84 53 c2 96 7b d7 2e 1e 06 1e 95 58 99 8b 08 73 fa a9 42 df 92 5e 6f>,
     absValidity: 2018-03-22T05:07:50.008Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer cb ed 7a ce 20 66 e4 32>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 05:07:52 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521608872598
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521608929001
connected to auth! from local port 42106
received auth hello!
{ authId: 402, nonce: <Buffer 70 a2 6f 59 6f e3 ea 83> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5e cb e7 3b 07 be 47 1a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200243,
  cipherKeyVal: <Buffer 88 e0 03 44 1a ea 64 2a e4 b4 42 a2 e8 fd 7c 07>,
  macKeyVal: <Buffer 93 81 79 0c 9a 7e 45 3c 1c 38 bf 18 1d 28 52 0b 08 62 04 0b 8b 04 ef 06 ac 0e 9c 2d 6d 23 43 42>,
  absValidity: 2018-03-22T05:08:50.077Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200243,
     cipherKeyVal: <Buffer 88 e0 03 44 1a ea 64 2a e4 b4 42 a2 e8 fd 7c 07>,
     macKeyVal: <Buffer 93 81 79 0c 9a 7e 45 3c 1c 38 bf 18 1d 28 52 0b 08 62 04 0b 8b 04 ef 06 ac 0e 9c 2d 6d 23 43 42>,
     absValidity: 2018-03-22T05:08:50.077Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 34 76 e3 c9 f7 6a b9 dc>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 05:08:52 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521608932742
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521608989057
connected to auth! from local port 42376
received auth hello!
{ authId: 402, nonce: <Buffer f0 07 73 50 0c 1c de 88> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a0 7b 8e 0d d3 3e 40 ca>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200250,
  cipherKeyVal: <Buffer 15 ba b7 c3 65 ec 3a fb eb 1a 01 23 92 48 6a 93>,
  macKeyVal: <Buffer 8a 9b a4 d8 2d 56 7f f7 bc c0 ff cd 93 62 78 25 15 5a 61 6d 69 05 2b 39 cf 7b 91 8c d7 1c 23 b0>,
  absValidity: 2018-03-22T05:09:50.127Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 40200250,
     cipherKeyVal: <Buffer 15 ba b7 c3 65 ec 3a fb eb 1a 01 23 92 48 6a 93>,
     macKeyVal: <Buffer 8a 9b a4 d8 2d 56 7f f7 bc c0 ff cd 93 62 78 25 15 5a 61 6d 69 05 2b 39 cf 7b 91 8c d7 1c 23 b0>,
     absValidity: 2018-03-22T05:09:50.127Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer b7 a0 68 3d f9 6d f2 f8>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 05:09:52 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 8 1 1521608993240
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 9 0.8888888888888888 1521609049088
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 10 0.8 1521609109098
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 40538
received auth hello!
{ authId: 503, nonce: <Buffer 60 e0 40 21 e0 b5 24 bf> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth503',
     commonName: '10.0.1.6' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth402',
     commonName: '10.0.0.2' },
  serial: '016246EE9CC9',
  notBefore: 2018-03-21T04:59:25.000Z,
  notAfter: 2018-03-22T05:01:05.000Z,
  subjectHash: '5542437f',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: 'ED:59:C1:CD:8F:D8:22:41:D5:07:A3:DF:8D:4C:AF:0B:8D:7B:16:80',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'E2C77ADB548D185210E7FA2988369325521D9CF6957B61D640674333307D4FC133154B2C56A9BBCE5655BEDE59A620D2F68A660E6DEB43308DBAFD7A396559B1C6BD0ED769D2F4066CEB2BFDB38188C4D295C06D196ECCC621767B060A3D3BCF3CF4458D7031B2D0AB66B8846DD9C1D4374DEB5D3E30D68FF926574682526527828E3BB232E36626859A826F5DA69748C9567F01930811E1C310842AAE799D7FAD1E9BE8B5D23DC0BC0D4537FC44D1FE7D84E57938DEE6D651DAEC8C897885315FE2797FFB87939E2A342186F4C566B1623BD369CC0226678E3A96E9092471F81CCC14C868DBEA8B6F0B2E5D566294136E91C2B3B101366D8A5B6642614F0CF5',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.6' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 503,
  host: '10.0.1.6',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJG7pzJMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg0MDIxETAPBgNVBAMMCDEwLjAuMC4yMB4XDTE4MDMy\nMTA0NTkyNVoXDTE4MDMyMjA1MDEwNVowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMzERMA8GA1UEAwwIMTAuMC4xLjYwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDix3rbVI0YUhDn+imINpMlUh2c9pV7YdZAZ0MzMH1PwTMVSyxW\nqbvOVlW+3lmmINL2imYObetDMI26/Xo5ZVmxxr0O12nS9AZs6yv9s4GIxNKVwG0Z\nbszGIXZ7Bgo9O8889EWNcDGy0KtmuIRt2cHUN03rXT4w1o/5JldGglJlJ4KOO7Iy\n42YmhZqCb12ml0jJVn8BkwgR4cMQhCqueZ1/rR6b6LXSPcC8DUU3/ETR/n2E5Xk4\n3ubWUdrsjIl4hTFf4nl/+4eTnio0IYb0xWaxYjvTacwCJmeOOpbpCSRx+BzMFMho\n2+qLbwsuXVZilBNukcKzsQE2bYpbZkJhTwz1AgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQYwDQYJKoZIhvcNAQELBQADggEBALMEUwPDm8I0xyKuhsItBhz9NBiTqlwm\nlxHlhbWBbdfIPGPY40mlsas1Lm1HVQVaQPEYU/d60AqUB9SC/fCrY3YOQLK5mM1O\n8fbSJjrQlmM3go6tKH4oWMQq8BIgB10+1c0p+XDR8EUPvp6ZEXWD17SBUb/mvwzg\nROmKid2Y0A1dMUukNN68TO2HScqHF6EzVsD5DiJGUPYtc+uj0+WDA9RfA54ECZH3\nzDNIgYGseyikjtxOdgl6oe8SnFQie9fM2xrpnjJRii6sUL0vwK7BkV/Nf01/qwAE\nNhmkwmuYwSJlmrdVgizIRQz0WOgUx/oC/0gbKc01BbvcU10qjfzog2w=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 11 0.7272727272727273 1521609169109
connected to auth! from local port 40794
received auth hello!
{ authId: 503, nonce: <Buffer 3f ce b3 81 09 9a c6 0f> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 9c 16 a9 90 5c eb bc b6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 2b ad 7e f8 21 23 97 24 b0 9b 52 e2 90 9c 42 5f>,
  macKeyVal: <Buffer e1 de 3f 34 58 7f d3 3a c3 44 45 12 ad 5a 85 68 03 9c 0a ad f4 27 83 39 38 76 69 f2 f3 13 44 b7>,
  absValidity: 2018-03-21T06:12:49.464Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300190,
  cipherKeyVal: <Buffer 8a 92 3e 6c 47 f9 b9 71 76 21 8c 0b 77 7c 62 2b>,
  macKeyVal: <Buffer 70 52 58 15 ab f9 3b 69 25 26 fc 54 4d de e5 64 52 cb 22 bf ab eb 38 ac b9 cc a2 1c 12 df 90 a1>,
  absValidity: 2018-03-22T05:12:49.464Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300190,
     cipherKeyVal: <Buffer 8a 92 3e 6c 47 f9 b9 71 76 21 8c 0b 77 7c 62 2b>,
     macKeyVal: <Buffer 70 52 58 15 ab f9 3b 69 25 26 fc 54 4d de e5 64 52 cb 22 bf ab eb 38 ac b9 cc a2 1c 12 df 90 a1>,
     absValidity: 2018-03-22T05:12:49.464Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 71 4f 1c b0 bf de 34 fc>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.15:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 12 0.6666666666666666 1521609229119
connected to auth! from local port 41074
received auth hello!
{ authId: 503, nonce: <Buffer 30 e8 b2 ad 7b 49 7c 39> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0c 9f cb 23 0b 37 c3 eb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300200,
  cipherKeyVal: <Buffer d8 76 4d de b5 73 d7 24 c6 1e 89 e4 f8 9a e4 05>,
  macKeyVal: <Buffer 48 97 48 c6 94 cc d4 59 a7 07 a7 e6 7f 86 02 79 ec 09 f0 07 16 42 f8 b5 6f 79 a1 60 ea 03 ee 5f>,
  absValidity: 2018-03-22T05:13:49.383Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300200,
     cipherKeyVal: <Buffer d8 76 4d de b5 73 d7 24 c6 1e 89 e4 f8 9a e4 05>,
     macKeyVal: <Buffer 48 97 48 c6 94 cc d4 59 a7 07 a7 e6 7f 86 02 79 ec 09 f0 07 16 42 f8 b5 6f 79 a1 60 ea 03 ee 5f>,
     absValidity: 2018-03-22T05:13:49.383Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 87 de e4 0f 64 9e 6e 34>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.15:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 13 0.6153846153846154 1521609289129
connected to auth! from local port 41350
received auth hello!
{ authId: 503, nonce: <Buffer 64 4c b5 c8 da fd 45 3c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 03 82 07 05 29 36 50 f7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300210,
  cipherKeyVal: <Buffer e7 29 19 5d de e7 58 21 68 87 4f 75 98 12 ff c8>,
  macKeyVal: <Buffer 31 45 77 b2 fe 6f 32 04 d9 5c 65 b5 3e 11 0d a3 ee 59 cd 3f b9 77 dc cf 9f f8 51 83 69 61 b3 20>,
  absValidity: 2018-03-22T05:14:49.370Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300210,
     cipherKeyVal: <Buffer e7 29 19 5d de e7 58 21 68 87 4f 75 98 12 ff c8>,
     macKeyVal: <Buffer 31 45 77 b2 fe 6f 32 04 d9 5c 65 b5 3e 11 0d a3 ee 59 cd 3f b9 77 dc cf 9f f8 51 83 69 61 b3 20>,
     absValidity: 2018-03-22T05:14:49.370Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 14 0.5714285714285714 1521609349185
connected to auth! from local port 41616
received auth hello!
{ authId: 503, nonce: <Buffer 38 b9 eb dd d6 a5 f2 20> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0f ec ca 85 f4 13 ce cb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300220,
  cipherKeyVal: <Buffer 11 56 47 4a 92 a9 d3 76 75 d5 65 c5 2f e5 d3 e0>,
  macKeyVal: <Buffer 55 43 05 48 a4 d6 be c3 75 46 00 64 36 80 a9 78 22 49 c6 35 90 6b 01 4a 08 c9 19 a1 7e 43 86 ac>,
  absValidity: 2018-03-22T05:15:49.435Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300220,
     cipherKeyVal: <Buffer 11 56 47 4a 92 a9 d3 76 75 d5 65 c5 2f e5 d3 e0>,
     macKeyVal: <Buffer 55 43 05 48 a4 d6 be c3 75 46 00 64 36 80 a9 78 22 49 c6 35 90 6b 01 4a 08 c9 19 a1 7e 43 86 ac>,
     absValidity: 2018-03-22T05:15:49.435Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 15 0.5333333333333333 1521609409229
connected to auth! from local port 41880
received auth hello!
{ authId: 503, nonce: <Buffer ad 0b bb 89 06 e0 87 e3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 61 bb 6e bb 5f 37 39 33>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300230,
  cipherKeyVal: <Buffer ae 8e 27 c1 da e7 51 80 61 2f 0e a7 92 5e 1d 18>,
  macKeyVal: <Buffer f3 8e 90 c2 86 d6 8c 39 ac 99 3f a7 4e 29 60 cc 74 4f 39 44 77 e1 8e 97 c4 0d 5f 04 e0 37 5f f5>,
  absValidity: 2018-03-22T05:16:49.508Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300230,
     cipherKeyVal: <Buffer ae 8e 27 c1 da e7 51 80 61 2f 0e a7 92 5e 1d 18>,
     macKeyVal: <Buffer f3 8e 90 c2 86 d6 8c 39 ac 99 3f a7 4e 29 60 cc 74 4f 39 44 77 e1 8e 97 c4 0d 5f 04 e0 37 5f f5>,
     absValidity: 2018-03-22T05:16:49.508Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 16 0.5 1521609469258
connected to auth! from local port 42150
received auth hello!
{ authId: 503, nonce: <Buffer 49 86 93 d7 e1 34 dd 80> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 48 17 d2 48 ab 11 e3 f1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300240,
  cipherKeyVal: <Buffer 7d fa 15 68 d1 51 84 b6 6c bd ca 80 ca bb 00 22>,
  macKeyVal: <Buffer 74 5d 74 19 7e c1 6f 86 4d 1a 05 a2 ee 55 71 43 7c 93 fa fd 5c 36 50 f3 5f fb 12 13 4b de 9a 50>,
  absValidity: 2018-03-22T05:17:49.532Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300240,
     cipherKeyVal: <Buffer 7d fa 15 68 d1 51 84 b6 6c bd ca 80 ca bb 00 22>,
     macKeyVal: <Buffer 74 5d 74 19 7e c1 6f 86 4d 1a 05 a2 ee 55 71 43 7c 93 fa fd 5c 36 50 f3 5f fb 12 13 4b de 9a 50>,
     absValidity: 2018-03-22T05:17:49.532Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 17 0.47058823529411764 1521609529315
connected to auth! from local port 42412
received auth hello!
{ authId: 503, nonce: <Buffer c2 11 2f 43 d0 8e d6 fc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a4 28 5b 72 6d 09 68 f2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300250,
  cipherKeyVal: <Buffer cd 13 5f 20 c8 ee 99 0a dc 6f 66 6c 79 29 96 3b>,
  macKeyVal: <Buffer d6 54 19 e8 60 fc 8c 52 22 67 9d e3 a3 d1 af 2f 02 96 1b 03 f7 53 48 b9 9d eb db 45 75 35 74 b1>,
  absValidity: 2018-03-22T05:18:49.634Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300250,
     cipherKeyVal: <Buffer cd 13 5f 20 c8 ee 99 0a dc 6f 66 6c 79 29 96 3b>,
     macKeyVal: <Buffer d6 54 19 e8 60 fc 8c 52 22 67 9d e3 a3 d1 af 2f 02 96 1b 03 f7 53 48 b9 9d eb db 45 75 35 74 b1>,
     absValidity: 2018-03-22T05:18:49.634Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 18 0.4444444444444444 1521609589373
connected to auth! from local port 42682
received auth hello!
{ authId: 503, nonce: <Buffer 3e 61 f6 35 38 9b 31 98> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 44 64 09 c5 90 75 a4 0d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300260,
  cipherKeyVal: <Buffer 52 f1 bc 12 4c b0 4e c6 fb ad b4 b1 ef c3 60 36>,
  macKeyVal: <Buffer f7 3c 47 00 bc 69 3f 11 ab c9 aa c3 a5 cf 31 8e e7 17 af 32 a0 2c ee 92 46 96 49 cb ad a9 cc b0>,
  absValidity: 2018-03-22T05:19:49.653Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300260,
     cipherKeyVal: <Buffer 52 f1 bc 12 4c b0 4e c6 fb ad b4 b1 ef c3 60 36>,
     macKeyVal: <Buffer f7 3c 47 00 bc 69 3f 11 ab c9 aa c3 a5 cf 31 8e e7 17 af 32 a0 2c ee 92 46 96 49 cb ad a9 cc b0>,
     absValidity: 2018-03-22T05:19:49.653Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 19 0.42105263157894735 1521609649434
connected to auth! from local port 42948
received auth hello!
{ authId: 503, nonce: <Buffer aa 91 ad 80 f8 4e ac cb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 25 7f c1 14 07 0a 36 4c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300270,
  cipherKeyVal: <Buffer ef ee b5 cc 8a e9 62 b7 57 8c 44 aa 0a a0 b5 f0>,
  macKeyVal: <Buffer de 55 43 26 8b 52 80 a8 f2 27 b6 7a d1 f9 81 18 01 41 fc bc c3 8d 99 f7 db ab ef 1b da 9a 65 74>,
  absValidity: 2018-03-22T05:20:49.727Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300270,
     cipherKeyVal: <Buffer ef ee b5 cc 8a e9 62 b7 57 8c 44 aa 0a a0 b5 f0>,
     macKeyVal: <Buffer de 55 43 26 8b 52 80 a8 f2 27 b6 7a d1 f9 81 18 01 41 fc bc c3 8d 99 f7 db ab ef 1b da 9a 65 74>,
     absValidity: 2018-03-22T05:20:49.727Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 20 0.4 1521609709470
connected to auth! from local port 43210
received auth hello!
{ authId: 503, nonce: <Buffer c1 d0 6c c3 62 53 bb 4e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d2 8e 6a 33 eb f7 2c a5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300280,
  cipherKeyVal: <Buffer b2 39 17 21 c7 15 58 3d 31 f1 51 72 3f c7 22 a5>,
  macKeyVal: <Buffer 25 a2 63 c8 2c 54 37 85 69 10 f0 d4 12 e4 04 4f 1b 0a 33 5d 46 69 75 ac 07 11 0c fb 96 d6 20 22>,
  absValidity: 2018-03-22T05:21:49.688Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300280,
     cipherKeyVal: <Buffer b2 39 17 21 c7 15 58 3d 31 f1 51 72 3f c7 22 a5>,
     macKeyVal: <Buffer 25 a2 63 c8 2c 54 37 85 69 10 f0 d4 12 e4 04 4f 1b 0a 33 5d 46 69 75 ac 07 11 0c fb 96 d6 20 22>,
     absValidity: 2018-03-22T05:21:49.688Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 21 0.38095238095238093 1521609769529
connected to auth! from local port 43474
received auth hello!
{ authId: 503, nonce: <Buffer 92 64 6a 4a ea 3c f6 b1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ce 06 4a 82 1a b5 0c 66>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300290,
  cipherKeyVal: <Buffer e8 70 8b 5d a8 e4 8e 22 71 65 e0 3d 74 0e 7a 79>,
  macKeyVal: <Buffer dd b2 0e e9 82 c3 79 64 b8 08 2f fa df 37 c9 93 34 30 d6 53 ce eb 72 74 0e 29 0f d4 ba b2 f5 08>,
  absValidity: 2018-03-22T05:22:49.834Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300290,
     cipherKeyVal: <Buffer e8 70 8b 5d a8 e4 8e 22 71 65 e0 3d 74 0e 7a 79>,
     macKeyVal: <Buffer dd b2 0e e9 82 c3 79 64 b8 08 2f fa df 37 c9 93 34 30 d6 53 ce eb 72 74 0e 29 0f d4 ba b2 f5 08>,
     absValidity: 2018-03-22T05:22:49.834Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 22 0.36363636363636365 1521609829589
connected to auth! from local port 43740
received auth hello!
{ authId: 503, nonce: <Buffer 04 79 7e 6d 6a e6 da 0e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 15 c7 24 af 6b df 7f ab>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300300,
  cipherKeyVal: <Buffer 5c f3 ae f0 b9 5f fa 09 45 ac e0 c3 00 2b f7 82>,
  macKeyVal: <Buffer a1 bb f5 97 8c d5 c5 2c 82 5c 53 06 38 ae c5 d5 89 14 cd 7f 8a 0e ae 65 54 a9 46 2c d8 00 d7 90>,
  absValidity: 2018-03-22T05:23:49.938Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300300,
     cipherKeyVal: <Buffer 5c f3 ae f0 b9 5f fa 09 45 ac e0 c3 00 2b f7 82>,
     macKeyVal: <Buffer a1 bb f5 97 8c d5 c5 2c 82 5c 53 06 38 ae c5 d5 89 14 cd 7f 8a 0e ae 65 54 a9 46 2c d8 00 d7 90>,
     absValidity: 2018-03-22T05:23:49.938Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 23 0.34782608695652173 1521609889589
connected to auth! from local port 44006
received auth hello!
{ authId: 503, nonce: <Buffer 3c 1b c9 d5 1f bc c1 ac> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e6 7c 4b 8c 18 c8 de 92>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300310,
  cipherKeyVal: <Buffer 9a 81 94 f9 63 d5 fc 05 0b 20 8b e0 51 23 1d 97>,
  macKeyVal: <Buffer 54 78 07 fa 36 85 6e 8d b8 98 12 14 3b 9b 0c 30 58 cf 24 ae 8f 86 4c 81 6e 14 3f 61 98 d3 6a e8>,
  absValidity: 2018-03-22T05:24:49.965Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300310,
     cipherKeyVal: <Buffer 9a 81 94 f9 63 d5 fc 05 0b 20 8b e0 51 23 1d 97>,
     macKeyVal: <Buffer 54 78 07 fa 36 85 6e 8d b8 98 12 14 3b 9b 0c 30 58 cf 24 ae 8f 86 4c 81 6e 14 3f 61 98 d3 6a e8>,
     absValidity: 2018-03-22T05:24:49.965Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 24 0.3333333333333333 1521609949648
connected to auth! from local port 44272
received auth hello!
{ authId: 503, nonce: <Buffer ce 71 ac 6d 3c 5c e9 39> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8a cd 8d 61 22 b1 26 fd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300320,
  cipherKeyVal: <Buffer db 02 43 42 4e 86 c2 e8 94 24 d2 20 ea 75 2a ec>,
  macKeyVal: <Buffer 09 ed 31 e7 2f 07 50 7b e9 23 a6 24 72 d3 18 f9 a7 6a 29 e7 88 66 53 7f 9f e1 f6 60 b6 13 cc fb>,
  absValidity: 2018-03-22T05:25:50.007Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300320,
     cipherKeyVal: <Buffer db 02 43 42 4e 86 c2 e8 94 24 d2 20 ea 75 2a ec>,
     macKeyVal: <Buffer 09 ed 31 e7 2f 07 50 7b e9 23 a6 24 72 d3 18 f9 a7 6a 29 e7 88 66 53 7f 9f e1 f6 60 b6 13 cc fb>,
     absValidity: 2018-03-22T05:25:50.007Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 25 0.32 1521610009708
connected to auth! from local port 44540
received auth hello!
{ authId: 503, nonce: <Buffer 56 a9 0d a8 62 cb 4f 89> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f9 07 60 72 2c 6a 63 3e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300330,
  cipherKeyVal: <Buffer bd 88 d5 e2 a0 ac 53 73 8d 2e ec c4 bf 57 52 88>,
  macKeyVal: <Buffer 72 db 3a 6e 30 18 5f f1 95 a8 ee a9 8c 32 38 c3 42 78 e0 b6 a4 c0 9d f5 4e df 6b d2 28 51 44 77>,
  absValidity: 2018-03-22T05:26:50.093Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300330,
     cipherKeyVal: <Buffer bd 88 d5 e2 a0 ac 53 73 8d 2e ec c4 bf 57 52 88>,
     macKeyVal: <Buffer 72 db 3a 6e 30 18 5f f1 95 a8 ee a9 8c 32 38 c3 42 78 e0 b6 a4 c0 9d f5 4e df 6b d2 28 51 44 77>,
     absValidity: 2018-03-22T05:26:50.093Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 26 0.3076923076923077 1521610069765
connected to auth! from local port 44804
received auth hello!
{ authId: 503, nonce: <Buffer 8c 13 ba 05 bd bb 25 16> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 70 5d 6f e6 55 0f 82 29>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300340,
  cipherKeyVal: <Buffer 19 6e 4e db 32 ac a8 9f af 0b 7c 77 65 3e 91 17>,
  macKeyVal: <Buffer 15 76 04 1c 6a b7 f5 47 fd 1e a1 64 d0 0e 3b e6 bc b9 c8 aa 41 3a b5 88 03 f7 a8 26 9f 30 63 eb>,
  absValidity: 2018-03-22T05:27:50.208Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300340,
     cipherKeyVal: <Buffer 19 6e 4e db 32 ac a8 9f af 0b 7c 77 65 3e 91 17>,
     macKeyVal: <Buffer 15 76 04 1c 6a b7 f5 47 fd 1e a1 64 d0 0e 3b e6 bc b9 c8 aa 41 3a b5 88 03 f7 a8 26 9f 30 63 eb>,
     absValidity: 2018-03-22T05:27:50.208Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 27 0.2962962962962963 1521610129821
connected to auth! from local port 45072
received auth hello!
{ authId: 503, nonce: <Buffer 28 53 45 2c 8b fb 0e d7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d3 ca 17 71 af 7f 95 a4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300350,
  cipherKeyVal: <Buffer 30 95 e3 80 50 5c ad fb d9 dc 78 df b8 2d 69 64>,
  macKeyVal: <Buffer 61 04 aa fb 61 cb 8e d4 32 3f 6c 0c 6b 7e e0 19 10 c5 03 5e 9a 82 84 2e c2 90 af 9a 9c bb b0 e1>,
  absValidity: 2018-03-22T05:28:50.196Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300350,
     cipherKeyVal: <Buffer 30 95 e3 80 50 5c ad fb d9 dc 78 df b8 2d 69 64>,
     macKeyVal: <Buffer 61 04 aa fb 61 cb 8e d4 32 3f 6c 0c 6b 7e e0 19 10 c5 03 5e 9a 82 84 2e c2 90 af 9a 9c bb b0 e1>,
     absValidity: 2018-03-22T05:28:50.196Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 28 0.2857142857142857 1521610189882
connected to auth! from local port 45340
received auth hello!
{ authId: 503, nonce: <Buffer 89 33 bb 7e f2 8f cb b3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 37 da 44 f1 75 8c 43 4f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50300360,
  cipherKeyVal: <Buffer 16 4e 85 78 ed 8f c6 80 e7 5d 79 af d7 b8 92 0e>,
  macKeyVal: <Buffer e3 7b c5 68 bf e7 07 0c ba 17 d2 29 66 95 e8 11 5b e2 1a 1e 85 99 6d c7 6e c8 d8 f1 39 66 db 3f>,
  absValidity: 2018-03-22T05:29:50.254Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.15',
  serverPort: 22100,
  sessionKey: 
   { id: 50300360,
     cipherKeyVal: <Buffer 16 4e 85 78 ed 8f c6 80 e7 5d 79 af d7 b8 92 0e>,
     macKeyVal: <Buffer e3 7b c5 68 bf e7 07 0c ba 17 d2 29 66 95 e8 11 5b e2 1a 1e 85 99 6d c7 6e c8 d8 f1 39 66 db 3f>,
     absValidity: 2018-03-22T05:29:50.254Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.15:22100
disconnected from auth
