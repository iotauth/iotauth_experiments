changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s504.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's504',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 32 2b ... > }
Handler: listening on port 22100
s504:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100653
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42074
received auth hello!
{ authId: 501, nonce: <Buffer 5a 95 b3 f9 d6 21 ca 94> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer d8 b9 d4 ae 50 53 46 b5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer f2 6c 48 21 ea 34 b2 fc 4c 2e 2f 4d b3 a0 0d 24>,
  macKeyVal: <Buffer da 1d ed 19 30 84 a2 7d b5 a3 8d ed f0 54 29 5b 84 3d b3 a5 9d 78 06 4d b6 8b b7 a0 3e cc 9a f2>,
  absValidity: 2018-03-21T09:02:50.957Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 44 c9 3f 6b 5d 19 db 8d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 44 c9 3f 6b 5d 19 db 8d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.67:34724',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100661
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42330
received auth hello!
{ authId: 501, nonce: <Buffer 5e ad a2 4f 3c 94 85 71> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 65 d1 ca c6 ac 79 d8 40>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 99 70 40 0d eb 6e 5c f5>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 99 70 40 0d eb 6e 5c f5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.67:34980',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100669
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42600
received auth hello!
{ authId: 501, nonce: <Buffer 9a a1 d5 55 86 5e 95 f7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3c cc f4 b1 34 b0 f8 16>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3b be 6c dc b1 0f dc 8a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3b be 6c dc b1 0f dc 8a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.67:35250',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100677
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42870
received auth hello!
{ authId: 501, nonce: <Buffer 20 31 a7 aa 39 0c f3 19> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ca 61 eb c8 50 15 de fb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer be 37 a1 86 62 ed 8a a8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer be 37 a1 86 62 ed 8a a8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.67:35520',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100685
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43140
received auth hello!
{ authId: 501, nonce: <Buffer f3 8e c9 23 01 d6 c6 19> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e9 2e d4 75 30 36 0e cb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b4 40 1b df d3 6d bf 42>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b4 40 1b df d3 6d bf 42> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.67:35790',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100693
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43410
received auth hello!
{ authId: 501, nonce: <Buffer e1 4a 4f 19 29 32 ba b4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a4 2b 22 14 f1 a0 67 24>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 31 2a db 8f 9b 9d 9e 45>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 31 2a db 8f 9b 9d 9e 45> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.67:36060',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100701
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43680
received auth hello!
{ authId: 501, nonce: <Buffer 5f e8 57 1c 7f ab 74 db> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7d 3c 27 f0 c4 1c cb 83>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4e 22 1e 17 f6 32 bf 97>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4e 22 1e 17 f6 32 bf 97> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.67:36330',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201524
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201538
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 34600
received auth hello!
{ authId: 502, nonce: <Buffer c1 03 87 80 f4 1c 9e 5e> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '01624792CAF6',
  notBefore: 2018-03-21T07:58:45.000Z,
  notAfter: 2018-03-22T08:00:25.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '41:BB:36:FE:72:D1:5C:DE:30:B8:F6:2D:4E:91:84:93:7C:6D:D8:E8',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'AEEAB02ACD0C32937DD84F3EB43F6189EAF089B04CE490F227FEC1E1A42FF33AACC957083F15D2CFEBF0E484D5D2BD03DD21587B3DF0ADCF1F273CEB6D3ADD0C5BD72406DA2D4A379546AD8D1C72FF3DB6ECF5D19A3A100B89C7B659A65778923B085EE02B29C23C0BF27314DEEC84CC61B318C930EC82C3B5DB050AD2527763CDCB5CEE65C7B2D7C1052512A2B08B2601CA1A4E32273B811E50FD7E40A702A19D8D7DB1E27E4C4E0A2F783C9AE1F654053799A646075FDCF3A86C68C654BCCA093F1A4B4044DAAFAB0E1FA7692D70BA1D4DBF798207A97EFFA87E7F6BE94B5E3D49438D87392AA382C0493F6F6E59A3B858B64877C59B95478C667FEE6CD71D',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJHksr2MA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDMy\nMTA3NTg0NVoXDTE4MDMyMjA4MDAyNVowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQCu6rAqzQwyk33YTz60P2GJ6vCJsEzkkPIn/sHhpC/zOqzJVwg/\nFdLP6/DkhNXSvQPdIVh7PfCtzx8nPOttOt0MW9ckBtotSjeVRq2NHHL/Pbbs9dGa\nOhALice2WaZXeJI7CF7gKynCPAvycxTe7ITMYbMYyTDsgsO12wUK0lJ3Y83LXO5l\nx7LXwQUlEqKwiyYByhpOMic7gR5Q/X5ApwKhnY19seJ+TE4KL3g8muH2VAU3maZG\nB1/c86hsaMZUvMoJPxpLQETar6sOH6dpLXC6HU2/eYIHqX7/qH5/a+lLXj1JQ42H\nOSqjgsBJP29uWaO4WLZId8WblUeMZn/ubNcdAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAJWqlXe8jbaoVP94MLkqCSUoYG3xIVVV\nKkDTdLOeaX0tY7Q7LKyyAZnb7UZhZIFtbOIusiq2L1yOVZEoyyFN78mnaaGWmjSX\n1/tdDjwD8jGATptp8zuRQv756splQgRfUhQiDaYAME32nij9TpbTe9o8I4zNFH2J\nd6y4P15nkWk+10WQ8BwXTnwPI8+FGB0gDwgxH5Mg9gKdiS93pD5coPwGfB7LZnMA\neMB5waI1PGQdYDnhNkQ7c03u5BFb1kexnfD8h+/kl5JcyWgHlq+Z7RqvkcW6G60K\nQd2JE3/vBojjHiq4Ig0+eqSp7ccuf6aD1ffaCcvTRYnUpAqCh6dwhso=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201552
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34752
received auth hello!
{ authId: 502, nonce: <Buffer 99 83 3e 7f 12 1b 9b cf> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer f3 76 87 1f cd 81 c9 0f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 36 95 ac 29 da e3 16 12 67 33 a8 4c 55 b3 83 a0>,
  macKeyVal: <Buffer de b0 26 f1 9e 18 78 74 fe ab cd 04 bd 68 05 cb 4e 37 be 14 1a 44 35 f2 53 08 f6 1c f3 ab 2f 5e>,
  absValidity: 2018-03-21T09:13:58.930Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d3 bf 24 b9 4f ac f6 a9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d3 bf 24 b9 4f ac f6 a9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.67:37188',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201568
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34908
received auth hello!
{ authId: 502, nonce: <Buffer 15 2f dd f7 d3 ad fe c7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9d a8 1e 30 47 b7 b5 49>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b4 f1 6f 6a 27 c5 1c 5b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b4 f1 6f 6a 27 c5 1c 5b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.67:37344',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201584
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35066
received auth hello!
{ authId: 502, nonce: <Buffer cd 27 39 cc f0 33 f6 9c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f0 82 5e d8 8e 83 43 37>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c5 30 64 a5 4f 98 7e a9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c5 30 64 a5 4f 98 7e a9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.67:37502',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201600
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35222
received auth hello!
{ authId: 502, nonce: <Buffer cd c5 b9 d2 b2 17 4f 37> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer af c4 35 0b a5 4c 3c b4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer be 35 03 3d 05 62 db 52>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer be 35 03 3d 05 62 db 52> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.67:37658',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201616
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35380
received auth hello!
{ authId: 502, nonce: <Buffer 56 88 cf 30 dc 40 42 61> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 76 7b f0 e8 e2 30 fc 36>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 68 8b 85 d2 ea 01 00 6c>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 68 8b 85 d2 ea 01 00 6c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.67:37816',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201632
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35536
received auth hello!
{ authId: 502, nonce: <Buffer a3 5b 91 d0 70 10 c3 3e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6e 2f 0b 34 f5 63 86 6f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 75 9c 54 8a 77 cf 7e 14>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 75 9c 54 8a 77 cf 7e 14> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.67:37972',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201648
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35694
received auth hello!
{ authId: 502, nonce: <Buffer de 39 15 cf d0 82 b9 59> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8a e0 41 24 d7 0f 2c 65>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3e cd f3 b5 23 d4 f0 40>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 3e cd f3 b5 23 d4 f0 40> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.67:38130',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201664
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35850
received auth hello!
{ authId: 502, nonce: <Buffer c6 2e 48 cc 48 68 a7 e9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 04 ba 44 67 cf 33 ff b1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ea bf d5 38 d0 40 af 34>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ea bf d5 38 d0 40 af 34> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.67:38286',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201680
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36008
received auth hello!
{ authId: 502, nonce: <Buffer a1 da 6b e0 6f a1 f8 6b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b8 73 27 ee c5 40 4c df>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 28 f6 d4 f4 de 4d 7d fc>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 28 f6 d4 f4 de 4d 7d fc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.67:38444',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201696
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36164
received auth hello!
{ authId: 502, nonce: <Buffer e2 e4 da 6d ac 1a 0e a8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 10 cf 51 37 82 b1 bf 86>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ae e9 33 ab 2f 1a cf 91>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ae e9 33 ab 2f 1a cf 91> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.67:38600',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201712
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36322
received auth hello!
{ authId: 502, nonce: <Buffer 90 7c 76 59 55 54 4d 64> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 99 6d 1b 56 82 fc 91 9d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1c 66 ba 51 01 d0 4c 99>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 1c 66 ba 51 01 d0 4c 99> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.67:38758',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201728
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36478
received auth hello!
{ authId: 502, nonce: <Buffer 1d 7e d1 42 27 73 57 16> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a6 5a f4 a3 e3 25 90 a0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f5 8a 16 e6 79 e2 18 63>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f5 8a 16 e6 79 e2 18 63> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.67:38914',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201744
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36636
received auth hello!
{ authId: 502, nonce: <Buffer 80 72 1e 7f 1d 40 a9 4b> }
Handler: Error in server - details: handshake2 timed out...
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6a 40 c3 9e f8 46 74 d3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 36 8b 9e 08 af 9c f6 49>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 36 8b 9e 08 af 9c f6 49> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.67:39072',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201760
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36792
received auth hello!
{ authId: 502, nonce: <Buffer 50 b7 84 80 08 cb 02 27> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 06 45 ba a0 91 f5 8f d9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f1 db cf 48 d8 4b 82 37>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f1 db cf 48 d8 4b 82 37> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.67:39228',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201776
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36952
received auth hello!
{ authId: 502, nonce: <Buffer 05 00 9b c5 f0 78 63 7d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer eb 47 d2 38 2c a9 c3 ef>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7c ed fb e9 30 2f 14 bc>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 7c ed fb e9 30 2f 14 bc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.67:39386',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201792
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37106
received auth hello!
{ authId: 502, nonce: <Buffer 70 2c d9 e7 6c eb 8b c6> }
Handler: Error in server - details: handshake2 timed out...
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8d 18 69 87 52 0d f7 5a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1b 79 53 86 1f 60 96 9a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1b 79 53 86 1f 60 96 9a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.67:39542',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201808
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37262
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 54 13 d9 0c 42 4b 24 b7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b3 fb a6 ad ad bb f4 bd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d6 d2 1d 8c 50 cc b0 bd>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d6 d2 1d 8c 50 cc b0 bd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.67:39698',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201824
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37402
Handler: Error in server - details: handshake2 timed out...
received auth hello!
{ authId: 502, nonce: <Buffer ad 27 18 3e 20 05 94 dd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d2 ea c7 ea be b5 83 4e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 69 f2 7b 68 96 cd 8a 3b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 69 f2 7b 68 96 cd 8a 3b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 24,
  remoteAddress: '::ffff:10.0.1.67:39838',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 24 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 24 }
specified socketID: 24
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #24 closed
