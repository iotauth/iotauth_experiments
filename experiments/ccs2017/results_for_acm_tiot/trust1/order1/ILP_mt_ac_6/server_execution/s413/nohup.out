changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s413.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's413',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 76 77 ... > }
Handler: listening on port 22100
s413:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300696
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42896
received auth hello!
{ authId: 403, nonce: <Buffer 3f 0e 0d 5d f2 86 3b 0b> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 01 48 6a 79 6c 07 1a c5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 62 a0 f2 8d 82 0e b4 1b f1 79 9e a2 44 54 96 cd>,
  macKeyVal: <Buffer e2 1b c9 6f dd de aa 10 cb 9b a2 1c 71 af f6 c8 78 0c 17 b4 16 53 f7 f2 6d 33 de ae 00 7a c8 75>,
  absValidity: 2018-03-21T09:02:21.308Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 0a 64 7e eb b8 a8 0c eb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 0a 64 7e eb b8 a8 0c eb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.58:49756',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300702
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43100
received auth hello!
{ authId: 403, nonce: <Buffer ad 09 70 12 40 f9 f3 f8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 14 b7 76 d6 01 f9 1b 6f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6d 50 47 25 38 7d 50 a8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6d 50 47 25 38 7d 50 a8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.58:49960',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300708
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43372
received auth hello!
{ authId: 403, nonce: <Buffer 8d dc 31 7f dc 7f f6 2e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 43 67 22 b5 ba 8b 5f d8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a6 6f a0 7d e1 5d 37 3d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a6 6f a0 7d e1 5d 37 3d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.58:50232',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300714
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43642
received auth hello!
{ authId: 403, nonce: <Buffer 83 1c ff f9 2e 02 61 b4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 22 a4 d3 29 b6 48 fb 43>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 75 37 a9 38 ca 79 30 3e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 75 37 a9 38 ca 79 30 3e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.58:50502',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300720
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43912
received auth hello!
{ authId: 403, nonce: <Buffer 33 e3 77 16 a6 44 e9 a7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 15 d0 5c 75 54 15 aa 4c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 99 72 65 74 c9 3a b7 5c>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 99 72 65 74 c9 3a b7 5c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.58:50772',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300726
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44182
received auth hello!
{ authId: 403, nonce: <Buffer e9 a1 c4 f8 07 f4 ea da> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 12 bb f9 d7 bf 8c 3b 3f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer de f5 87 22 3c 2d 7b da>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer de f5 87 22 3c 2d 7b da> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.58:51042',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300732
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44452
received auth hello!
{ authId: 403, nonce: <Buffer af ec 59 a9 24 08 55 40> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8a 7b d3 7a 73 11 db 72>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1e b2 91 74 4a 9e 2a 4a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1e b2 91 74 4a 9e 2a 4a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.58:51312',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300738
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44718
received auth hello!
{ authId: 403, nonce: <Buffer 53 d1 be f4 45 91 66 d7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7e 40 c7 6e e6 41 b6 90>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ad ea ac 64 67 18 6a 4b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ad ea ac 64 67 18 6a 4b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.58:51578',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
