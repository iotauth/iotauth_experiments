changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s505.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's505',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 71 79 ... > }
Handler: listening on port 22100
s505:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100654
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53726
received auth hello!
{ authId: 501, nonce: <Buffer 55 9e 3f 9e 1d 75 8e 08> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 9b 76 64 3e 83 94 90 34>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 9d 49 a2 53 78 e0 79 23 1d 85 ee 65 16 17 59 16>,
  macKeyVal: <Buffer 8c 25 0e d6 6b d9 d3 37 8f a5 e1 30 ba d3 c2 d6 fb 2c 15 c8 58 a0 73 b1 1c 02 2a 1d d8 a3 6d ba>,
  absValidity: 2018-03-21T09:02:54.226Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e5 fe 9a dd a8 b9 49 33>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e5 fe 9a dd a8 b9 49 33> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.68:53012',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100655
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53738
received auth hello!
{ authId: 501, nonce: <Buffer 00 bc 3d 0e 6c e2 78 ec> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c2 f9 85 4f f7 7c fe d2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6b 21 2a 55 e1 61 b7 d3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6b 21 2a 55 e1 61 b7 d3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.69:41684',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100662
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53988
received auth hello!
{ authId: 501, nonce: <Buffer 23 bb 59 58 84 a3 d7 89> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c0 38 e3 4b a6 a6 18 53>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bb 6e c3 94 66 1e 76 4b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bb 6e c3 94 66 1e 76 4b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.68:53274',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100663
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54006
received auth hello!
{ authId: 501, nonce: <Buffer 92 3f 13 57 c2 cb 9e 4d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d8 d4 f4 5e 1c 10 64 5e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c1 43 75 1c e7 de 3b 13>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c1 43 75 1c e7 de 3b 13> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.69:41952',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100670
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54258
received auth hello!
{ authId: 501, nonce: <Buffer 62 d4 25 0d ac 0b 38 f4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 88 a3 1e d7 af 0f e9 01>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6d 4e c2 d3 f3 2f 63 c8>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 6d 4e c2 d3 f3 2f 63 c8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.68:53544',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100671
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54276
received auth hello!
{ authId: 501, nonce: <Buffer 3b aa ce 0f fe 90 61 44> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ed ec a7 1f 89 37 4d 05>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7c a1 89 b3 76 bc d9 d3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 7c a1 89 b3 76 bc d9 d3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.69:42222',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100678
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54528
received auth hello!
{ authId: 501, nonce: <Buffer 0c be 43 5a ac aa 61 f7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ef 92 61 bd 29 f6 b6 23>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c9 e9 d0 bd 70 25 3b 64>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c9 e9 d0 bd 70 25 3b 64> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.68:53814',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100679
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54546
received auth hello!
{ authId: 501, nonce: <Buffer f1 2d cb fd 52 58 ee db> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2e 83 52 5e b3 bd 2d 05>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 02 03 9c 29 a5 5e 12 68>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 02 03 9c 29 a5 5e 12 68> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.69:42492',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100686
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54798
received auth hello!
{ authId: 501, nonce: <Buffer 8e 12 2a c9 98 0b 6b 0f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 37 b5 95 78 52 52 e9 e1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 55 bf 45 91 38 2f 8d eb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 55 bf 45 91 38 2f 8d eb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.68:54084',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100687
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54816
received auth hello!
{ authId: 501, nonce: <Buffer c4 9e 48 22 0b 72 00 fd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer da f9 a8 9f a7 5b 1e 6f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 94 21 9a 34 6b 6f 90 5b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 94 21 9a 34 6b 6f 90 5b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.69:42762',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100694
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55068
received auth hello!
{ authId: 501, nonce: <Buffer 56 14 56 90 ce 2f c8 54> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f7 a1 61 60 f4 6c fe dc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 06 8a c4 be d1 24 9c ca>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 06 8a c4 be d1 24 9c ca> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.68:54354',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100695
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55086
received auth hello!
{ authId: 501, nonce: <Buffer bc cd 31 86 46 8c c2 0c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6f 15 8b 86 44 5a ba fd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bd 12 52 e7 ee 65 93 b0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bd 12 52 e7 ee 65 93 b0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.69:43032',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100702
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55338
received auth hello!
{ authId: 501, nonce: <Buffer a4 ba ff 34 e3 ff 16 78> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 71 77 6e 08 c6 ad 81 50>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6a 87 a6 45 96 a4 d0 e7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6a 87 a6 45 96 a4 d0 e7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.68:54624',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100703
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55356
received auth hello!
{ authId: 501, nonce: <Buffer 7b aa da d7 ae e8 9c 29> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 11 2d 90 81 49 9c 44 6e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer db 58 19 04 5e f1 d0 38>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer db 58 19 04 5e f1 d0 38> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.69:43302',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
