changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s507.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's507',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 6d 66 ... > }
Handler: listening on port 22100
s507:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100657
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42870
received auth hello!
{ authId: 501, nonce: <Buffer 12 f7 15 cd ef 82 c7 53> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 7c 10 4b 08 10 4b 68 b5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer e9 94 19 f4 c1 07 01 a3 fe d5 ca 06 e2 e6 74 92>,
  macKeyVal: <Buffer 63 20 7b 31 d8 26 45 1d da 36 39 10 88 53 e8 5f fa ce 59 65 85 76 8d b6 90 85 f0 5f 15 ca 62 0d>,
  absValidity: 2018-03-21T09:03:05.366Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5d b8 4e 89 91 5a 28 8a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5d b8 4e 89 91 5a 28 8a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.71:56540',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100665
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43142
received auth hello!
{ authId: 501, nonce: <Buffer f3 ea 8d ef 0a c8 b8 00> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 39 15 43 df 63 4f 96 9d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b0 f2 23 dc a4 a2 e1 fb>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b0 f2 23 dc a4 a2 e1 fb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.71:56812',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100673
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43412
received auth hello!
{ authId: 501, nonce: <Buffer 8a 2d db c5 99 80 9e c7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 65 7a ac 4c d7 0c ab 13>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1e d7 47 2e 75 f7 cb a2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1e d7 47 2e 75 f7 cb a2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.71:57082',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100681
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43682
received auth hello!
{ authId: 501, nonce: <Buffer 77 6a ec 51 16 ba b7 87> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d4 2b f5 80 c4 36 d7 7e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6b c4 e5 ac 3d e0 6a 6f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6b c4 e5 ac 3d e0 6a 6f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.71:57352',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100689
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43952
received auth hello!
{ authId: 501, nonce: <Buffer 73 0f 69 34 52 d1 c4 2b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer df 14 e2 95 b3 e0 a2 bd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d8 dc e4 d4 5f 2c ca e2>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer d8 dc e4 d4 5f 2c ca e2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.71:57622',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100697
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44222
received auth hello!
{ authId: 501, nonce: <Buffer 31 ba fa 0f d6 05 bf 64> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 50 91 f9 d5 7c 6d 3b 74>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6f e0 6a a5 8e 37 98 00>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6f e0 6a a5 8e 37 98 00> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.71:57892',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100705
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 44492
received auth hello!
{ authId: 501, nonce: <Buffer 18 bb 73 c6 d8 c9 9f 32> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 25 36 f3 77 1b ca 71 82>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 62 b9 72 8a c7 67 6a 4a>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 62 b9 72 8a c7 67 6a 4a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.71:58162',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201525
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201539
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 39648
received auth hello!
{ authId: 502, nonce: <Buffer 8b e0 ec 7f ea e2 aa 22> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '01624792CAF6',
  notBefore: 2018-03-21T07:58:45.000Z,
  notAfter: 2018-03-22T08:00:25.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '41:BB:36:FE:72:D1:5C:DE:30:B8:F6:2D:4E:91:84:93:7C:6D:D8:E8',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'AEEAB02ACD0C32937DD84F3EB43F6189EAF089B04CE490F227FEC1E1A42FF33AACC957083F15D2CFEBF0E484D5D2BD03DD21587B3DF0ADCF1F273CEB6D3ADD0C5BD72406DA2D4A379546AD8D1C72FF3DB6ECF5D19A3A100B89C7B659A65778923B085EE02B29C23C0BF27314DEEC84CC61B318C930EC82C3B5DB050AD2527763CDCB5CEE65C7B2D7C1052512A2B08B2601CA1A4E32273B811E50FD7E40A702A19D8D7DB1E27E4C4E0A2F783C9AE1F654053799A646075FDCF3A86C68C654BCCA093F1A4B4044DAAFAB0E1FA7692D70BA1D4DBF798207A97EFFA87E7F6BE94B5E3D49438D87392AA382C0493F6F6E59A3B858B64877C59B95478C667FEE6CD71D',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJHksr2MA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDMy\nMTA3NTg0NVoXDTE4MDMyMjA4MDAyNVowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQCu6rAqzQwyk33YTz60P2GJ6vCJsEzkkPIn/sHhpC/zOqzJVwg/\nFdLP6/DkhNXSvQPdIVh7PfCtzx8nPOttOt0MW9ckBtotSjeVRq2NHHL/Pbbs9dGa\nOhALice2WaZXeJI7CF7gKynCPAvycxTe7ITMYbMYyTDsgsO12wUK0lJ3Y83LXO5l\nx7LXwQUlEqKwiyYByhpOMic7gR5Q/X5ApwKhnY19seJ+TE4KL3g8muH2VAU3maZG\nB1/c86hsaMZUvMoJPxpLQETar6sOH6dpLXC6HU2/eYIHqX7/qH5/a+lLXj1JQ42H\nOSqjgsBJP29uWaO4WLZId8WblUeMZn/ubNcdAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAJWqlXe8jbaoVP94MLkqCSUoYG3xIVVV\nKkDTdLOeaX0tY7Q7LKyyAZnb7UZhZIFtbOIusiq2L1yOVZEoyyFN78mnaaGWmjSX\n1/tdDjwD8jGATptp8zuRQv756splQgRfUhQiDaYAME32nij9TpbTe9o8I4zNFH2J\nd6y4P15nkWk+10WQ8BwXTnwPI8+FGB0gDwgxH5Mg9gKdiS93pD5coPwGfB7LZnMA\neMB5waI1PGQdYDnhNkQ7c03u5BFb1kexnfD8h+/kl5JcyWgHlq+Z7RqvkcW6G60K\nQd2JE3/vBojjHiq4Ig0+eqSp7ccuf6aD1ffaCcvTRYnUpAqCh6dwhso=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201555
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39802
received auth hello!
{ authId: 502, nonce: <Buffer 2d 5b d2 03 47 42 9a f6> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 84 9c 6e 28 73 2b a3 32>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 25 e2 cd b8 a7 36 0b 22 0b e2 51 29 73 75 94 d2>,
  macKeyVal: <Buffer 51 64 c8 a8 b7 30 77 64 8c f3 25 6c b7 c6 a0 40 a9 4a be dd d4 9d a1 74 79 5f f3 23 68 33 db 3e>,
  absValidity: 2018-03-21T09:14:04.363Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e0 8a 8d 84 37 de 72 ce>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e0 8a 8d 84 37 de 72 ce> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.71:58984',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201571
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39962
received auth hello!
{ authId: 502, nonce: <Buffer 93 fd 8f fb 61 24 36 83> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 52 43 dd 88 51 6f 50 ef>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer da f2 0e 91 bb ee 20 75>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer da f2 0e 91 bb ee 20 75> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.71:59144',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201587
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40116
received auth hello!
{ authId: 502, nonce: <Buffer da 35 b1 96 b8 b4 67 e7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b3 e4 f3 c5 10 6c d2 b6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 20 c8 b4 b0 9a 55 aa 29>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 20 c8 b4 b0 9a 55 aa 29> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.71:59298',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201603
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40276
received auth hello!
{ authId: 502, nonce: <Buffer 8e 9d 1c ef 61 50 fe 2e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4d e4 ab 4d 16 42 ca 66>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 60 2f da 66 0c ce 43 30>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 60 2f da 66 0c ce 43 30> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.71:59458',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201619
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40430
received auth hello!
{ authId: 502, nonce: <Buffer c4 4a 30 d0 ab 26 f0 7b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9a 9f ce 5e f9 9c 0d ff>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5a 3f 9b 14 c8 01 53 b5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5a 3f 9b 14 c8 01 53 b5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.71:59612',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201635
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40590
received auth hello!
{ authId: 502, nonce: <Buffer 92 75 95 f6 54 9a e7 ee> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 84 01 c6 80 4e aa 40 21>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9b 15 ed 4c 25 c5 7b 84>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 9b 15 ed 4c 25 c5 7b 84> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.71:59772',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201651
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40744
received auth hello!
{ authId: 502, nonce: <Buffer 24 ad 8f 2e 0a 80 bf ed> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c2 51 91 69 08 7d 3e 1b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 77 b9 c1 cd 69 8c 6b fb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 77 b9 c1 cd 69 8c 6b fb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.71:59926',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201667
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40904
received auth hello!
{ authId: 502, nonce: <Buffer 34 c5 ef b1 82 85 c0 dc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ad 19 7b 9f 2c d4 0f 14>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f7 1c 82 d4 ff 10 56 2e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f7 1c 82 d4 ff 10 56 2e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.71:60086',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201683
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41058
received auth hello!
{ authId: 502, nonce: <Buffer 75 fd 68 73 ca e2 7b 8d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f5 c2 bc e9 56 36 95 3a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 65 0d 66 2b f3 f6 f0 b8>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 65 0d 66 2b f3 f6 f0 b8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.71:60240',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201699
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41218
received auth hello!
{ authId: 502, nonce: <Buffer 5b 14 da d4 3e 1e 01 a7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1f 40 9c 4f 38 46 08 9c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 66 93 f9 84 9e d2 50 ab>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 66 93 f9 84 9e d2 50 ab> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.71:60400',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201715
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41372
received auth hello!
{ authId: 502, nonce: <Buffer 17 a6 03 af 2e fd 4c ac> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 94 6f b6 bd 82 4b 52 b7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e4 24 b4 8f 04 ca 23 a0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e4 24 b4 8f 04 ca 23 a0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.71:60554',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201731
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41532
received auth hello!
{ authId: 502, nonce: <Buffer 21 52 0e 9d d7 b8 e5 86> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ea fc fd ff 2c 3a 49 81>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 07 fb 2e 31 b5 1b 3f e5>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 07 fb 2e 31 b5 1b 3f e5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.71:60714',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201747
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41686
received auth hello!
{ authId: 502, nonce: <Buffer 1b 3b 6a 18 35 e8 2c c6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 00 ca fa e8 79 3e 20 51>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 98 de f2 fa 1d b3 48 97>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 98 de f2 fa 1d b3 48 97> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.71:60868',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201763
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 41846
received auth hello!
{ authId: 502, nonce: <Buffer 62 bb e5 9e c6 13 76 ed> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 95 c6 72 eb d1 88 5f ff>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ff 83 73 eb 9d c9 24 f4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ff 83 73 eb 9d c9 24 f4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.71:32796',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201779
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42000
received auth hello!
{ authId: 502, nonce: <Buffer 3a 17 f6 9f bb a6 02 6a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7a 4f ad 4c 31 c6 ec 6e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b7 17 8f 6a 50 cd f4 e0>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b7 17 8f 6a 50 cd f4 e0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.71:32950',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201795
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42156
received auth hello!
{ authId: 502, nonce: <Buffer a0 44 12 ee fd 65 48 99> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer da 2a 59 75 d7 5e ee d5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 81 df 35 c1 16 e0 55 63>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 81 df 35 c1 16 e0 55 63> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.71:33106',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201811
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42312
received auth hello!
{ authId: 502, nonce: <Buffer 24 45 58 77 cd 25 e9 b4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cb 01 97 ce 85 60 fe de>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a5 bd 9d 6f 29 da a7 94>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a5 bd 9d 6f 29 da a7 94> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.71:33262',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201827
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42444
received auth hello!
{ authId: 502, nonce: <Buffer 5a 13 13 d2 22 23 ad 8c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ba 39 d3 6b 64 9d a8 55>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bc 18 23 b4 09 07 30 11>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bc 18 23 b4 09 07 30 11> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 24,
  remoteAddress: '::ffff:10.0.1.71:33394',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 24 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 24 }
specified socketID: 24
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #24 closed
