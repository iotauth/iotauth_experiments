changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s405.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's405',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 74 59 ... > }
Handler: listening on port 22100
s405:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200416
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49468
received auth hello!
{ authId: 402, nonce: <Buffer 0a 90 a0 ce c4 4e 06 60> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer cc b0 aa 4f 71 12 f3 8a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer ee 18 dc ab 44 e6 f1 77 c3 69 9e 82 5c 7e 11 97>,
  macKeyVal: <Buffer fd 89 08 d7 6c 97 23 a9 36 61 4e 88 15 b2 a8 4b 7f 00 5a 9d 19 d9 ed 35 fd 30 d0 f0 66 f1 77 a6>,
  absValidity: 2018-03-21T09:01:52.328Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 45 ae b5 45 0f 44 d5 42>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 45 ae b5 45 0f 44 d5 42> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.49:60194',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200423
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49618
received auth hello!
{ authId: 402, nonce: <Buffer 13 2a 7e 43 1c 8f 31 02> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 64 41 92 b8 2e 07 bd fc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b2 75 a2 82 c8 94 c4 ee>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer b2 75 a2 82 c8 94 c4 ee> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.49:60344',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200430
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49874
received auth hello!
{ authId: 402, nonce: <Buffer e4 97 77 7c 7f 53 e0 0a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 79 42 7e 99 b6 34 98 d0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2f 1f ad 16 6b f3 b1 43>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2f 1f ad 16 6b f3 b1 43> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.49:60600',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200437
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50144
received auth hello!
{ authId: 402, nonce: <Buffer 05 9a be 95 57 08 74 a6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7b cc eb 2a 91 21 32 63>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 73 8e da 53 f3 c9 26 0c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 73 8e da 53 f3 c9 26 0c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.49:60870',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200444
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50414
received auth hello!
{ authId: 402, nonce: <Buffer 8c 9d 05 12 dd 1a 2b a0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cb 67 d7 c7 8c 28 49 41>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 96 40 03 43 37 82 ae 83>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 96 40 03 43 37 82 ae 83> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.49:32908',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200451
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50684
received auth hello!
{ authId: 402, nonce: <Buffer f3 97 fe 87 e5 df 56 9b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d2 ae 2c 4c 20 d8 58 80>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 91 e3 35 4a b5 88 de 94>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 91 e3 35 4a b5 88 de 94> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.49:33178',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200458
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50954
received auth hello!
{ authId: 402, nonce: <Buffer ad b4 cf ca 4c ad cf 94> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4c a5 5d ef c0 34 95 c3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c2 f5 8f 90 29 37 94 f1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c2 f5 8f 90 29 37 94 f1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.49:33448',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200465
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51224
received auth hello!
{ authId: 402, nonce: <Buffer fb 81 59 bc 73 be 17 d1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 39 0a c5 17 f4 26 1c ec>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 80 fb dc ce 54 4b d3 d3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 80 fb dc ce 54 4b d3 d3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.49:33718',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
