changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s501.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's501',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 78 42 ... > }
Handler: listening on port 22100
s501:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100650
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38724
received auth hello!
{ authId: 501, nonce: <Buffer 46 8d 68 1a b3 98 a1 7c> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer aa 58 44 28 fc bb df 72>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 27 24 c2 b5 bc cd c0 c7 32 2e 1a 88 9f 23 f9 25>,
  macKeyVal: <Buffer 00 38 7f be 36 82 42 c5 f9 ba 1d 02 2e 6c 4e bc ee a9 89 39 44 69 0b 6f 8e bc 7c 9e f0 5d 78 fd>,
  absValidity: 2018-03-21T09:02:34.422Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9b eb bd b3 91 2a cf 1b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9b eb bd b3 91 2a cf 1b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.62:49030',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100658
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38954
received auth hello!
{ authId: 501, nonce: <Buffer f3 76 9c 1f 66 c8 dc 26> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 75 3b c7 b9 b6 b5 25 01>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 38 f6 97 b5 5e 87 52 a2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 38 f6 97 b5 5e 87 52 a2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.62:49260',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100666
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39224
received auth hello!
{ authId: 501, nonce: <Buffer cb 3c 67 94 04 23 3e b6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b0 e4 45 be ae 64 21 79>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f7 07 0e 7c 9c 30 68 65>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f7 07 0e 7c 9c 30 68 65> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.62:49530',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100674
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39494
received auth hello!
{ authId: 501, nonce: <Buffer d5 63 fe ec 65 fb 48 db> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c4 b9 3d 15 75 d8 d4 49>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c2 5f 4a e7 6e 4e 17 51>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c2 5f 4a e7 6e 4e 17 51> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.62:49800',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100682
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39764
received auth hello!
{ authId: 501, nonce: <Buffer c2 f1 19 77 e4 42 b2 64> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 07 f0 ac 87 04 4c e6 63>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c8 d9 74 80 27 45 5e 36>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c8 d9 74 80 27 45 5e 36> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.62:50070',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100690
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40034
received auth hello!
{ authId: 501, nonce: <Buffer fb e7 61 a4 76 76 97 89> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5f 09 37 37 ee 14 b7 d7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 68 47 49 92 ce 4f 07 e0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 68 47 49 92 ce 4f 07 e0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.62:50340',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100698
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40304
received auth hello!
{ authId: 501, nonce: <Buffer 74 04 64 13 89 4f a2 b9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 52 53 2b 2c 92 99 1d ec>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 56 21 2c a8 56 9a a2 b9>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 56 21 2c a8 56 9a a2 b9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.62:50610',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201520
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201533
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 59058
received auth hello!
{ authId: 502, nonce: <Buffer fc 0d 44 1e 4b e3 55 5b> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '01624792CAF6',
  notBefore: 2018-03-21T07:58:45.000Z,
  notAfter: 2018-03-22T08:00:25.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '41:BB:36:FE:72:D1:5C:DE:30:B8:F6:2D:4E:91:84:93:7C:6D:D8:E8',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'AEEAB02ACD0C32937DD84F3EB43F6189EAF089B04CE490F227FEC1E1A42FF33AACC957083F15D2CFEBF0E484D5D2BD03DD21587B3DF0ADCF1F273CEB6D3ADD0C5BD72406DA2D4A379546AD8D1C72FF3DB6ECF5D19A3A100B89C7B659A65778923B085EE02B29C23C0BF27314DEEC84CC61B318C930EC82C3B5DB050AD2527763CDCB5CEE65C7B2D7C1052512A2B08B2601CA1A4E32273B811E50FD7E40A702A19D8D7DB1E27E4C4E0A2F783C9AE1F654053799A646075FDCF3A86C68C654BCCA093F1A4B4044DAAFAB0E1FA7692D70BA1D4DBF798207A97EFFA87E7F6BE94B5E3D49438D87392AA382C0493F6F6E59A3B858B64877C59B95478C667FEE6CD71D',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJHksr2MA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDMy\nMTA3NTg0NVoXDTE4MDMyMjA4MDAyNVowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQCu6rAqzQwyk33YTz60P2GJ6vCJsEzkkPIn/sHhpC/zOqzJVwg/\nFdLP6/DkhNXSvQPdIVh7PfCtzx8nPOttOt0MW9ckBtotSjeVRq2NHHL/Pbbs9dGa\nOhALice2WaZXeJI7CF7gKynCPAvycxTe7ITMYbMYyTDsgsO12wUK0lJ3Y83LXO5l\nx7LXwQUlEqKwiyYByhpOMic7gR5Q/X5ApwKhnY19seJ+TE4KL3g8muH2VAU3maZG\nB1/c86hsaMZUvMoJPxpLQETar6sOH6dpLXC6HU2/eYIHqX7/qH5/a+lLXj1JQ42H\nOSqjgsBJP29uWaO4WLZId8WblUeMZn/ubNcdAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAJWqlXe8jbaoVP94MLkqCSUoYG3xIVVV\nKkDTdLOeaX0tY7Q7LKyyAZnb7UZhZIFtbOIusiq2L1yOVZEoyyFN78mnaaGWmjSX\n1/tdDjwD8jGATptp8zuRQv756splQgRfUhQiDaYAME32nij9TpbTe9o8I4zNFH2J\nd6y4P15nkWk+10WQ8BwXTnwPI8+FGB0gDwgxH5Mg9gKdiS93pD5coPwGfB7LZnMA\neMB5waI1PGQdYDnhNkQ7c03u5BFb1kexnfD8h+/kl5JcyWgHlq+Z7RqvkcW6G60K\nQd2JE3/vBojjHiq4Ig0+eqSp7ccuf6aD1ffaCcvTRYnUpAqCh6dwhso=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201547
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59212
received auth hello!
{ authId: 502, nonce: <Buffer f5 50 c7 08 db 54 50 be> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 9e 42 21 72 06 7d a5 01>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 9f 9d 37 ac c3 84 94 48 2e d6 18 8b 46 de 76 55>,
  macKeyVal: <Buffer 45 a3 47 94 fe f9 4e 6d f3 eb fb d4 3f cf 4c 52 dc 82 5d 66 26 61 dc 11 29 6c bf a8 e9 d0 a5 6a>,
  absValidity: 2018-03-21T09:13:36.314Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer eb 4f 58 7f 0f ac f5 f8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer eb 4f 58 7f 0f ac f5 f8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.62:51498',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201563
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59368
received auth hello!
{ authId: 502, nonce: <Buffer 11 4f de d7 3e 8b cb 3f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b4 59 dd 2c e4 54 87 78>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c3 1e 79 6f 4d df 90 47>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c3 1e 79 6f 4d df 90 47> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.62:51654',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201579
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59532
received auth hello!
{ authId: 502, nonce: <Buffer f3 48 bb aa 5d 49 26 7a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9e 40 3b 34 8f 92 1c dc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5d fa c8 74 43 c0 ea 5d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 5d fa c8 74 43 c0 ea 5d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.62:51818',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201595
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59682
received auth hello!
{ authId: 502, nonce: <Buffer 81 72 b0 d7 e4 11 65 48> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ee 06 1b 1b 48 bb 57 05>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 91 92 d9 c2 95 91 2f 4c>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 91 92 d9 c2 95 91 2f 4c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.62:51968',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201611
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59846
received auth hello!
{ authId: 502, nonce: <Buffer 51 4b 07 4c 3e fb 0d 8e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d9 c4 46 0e 4d 7f 73 16>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bb 92 b1 66 f3 35 ed a0>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer bb 92 b1 66 f3 35 ed a0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.62:52132',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201627
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59996
received auth hello!
{ authId: 502, nonce: <Buffer bb 14 b0 89 b0 73 d5 6c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer da 56 11 72 1c 23 db 80>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 41 20 a0 61 0f 7d 95 4a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 41 20 a0 61 0f 7d 95 4a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.62:52282',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201643
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60160
received auth hello!
{ authId: 502, nonce: <Buffer c9 0b 2e bf e2 1f 1b f8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7e 61 68 3f fa e5 25 56>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 08 bb d1 7d 46 2d c6 30>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 08 bb d1 7d 46 2d c6 30> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.62:52446',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201659
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60310
received auth hello!
{ authId: 502, nonce: <Buffer 7c 1a ee bb 19 89 21 aa> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c7 9c 09 de 26 79 5f 32>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 08 3c d0 ac 17 22 77 b7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 08 3c d0 ac 17 22 77 b7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.62:52596',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201675
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60474
received auth hello!
{ authId: 502, nonce: <Buffer ed fb cc e7 d2 d4 a8 8c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 17 4b 18 b0 92 0f 68 7f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1b 9e 81 ad b2 bf 9e a7>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 1b 9e 81 ad b2 bf 9e a7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.62:52760',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201691
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60624
received auth hello!
{ authId: 502, nonce: <Buffer 2b ce 8b 2a 5d d2 c1 af> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9d 9c c4 d1 b1 18 71 35>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 57 a9 fe 24 de a1 db da>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 57 a9 fe 24 de a1 db da> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.62:52910',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201707
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60788
received auth hello!
{ authId: 502, nonce: <Buffer 10 93 06 14 ab 0c 08 8b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3f 7d 8e 47 04 4a 61 85>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bb 15 00 3f 0c c9 e8 11>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bb 15 00 3f 0c c9 e8 11> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.62:53074',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201723
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60938
received auth hello!
{ authId: 502, nonce: <Buffer 51 6b 7f 68 77 ec ae f6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 12 2f ac a8 c8 85 25 bd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b3 66 9a bb 95 76 92 76>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b3 66 9a bb 95 76 92 76> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.62:53224',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201739
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 32870
received auth hello!
{ authId: 502, nonce: <Buffer a2 10 00 b9 b0 a6 db 01> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 10 32 d4 e1 f4 55 2b 34>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f7 06 6e 39 ed 8a 14 56>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f7 06 6e 39 ed 8a 14 56> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.62:53388',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201755
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33020
received auth hello!
{ authId: 502, nonce: <Buffer e2 1e 82 08 51 b6 06 1e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 35 4f d0 94 f5 5d 8e 8b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ed 75 e6 c8 c6 a7 37 0c>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ed 75 e6 c8 c6 a7 37 0c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.62:53538',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201771
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33184
received auth hello!
{ authId: 502, nonce: <Buffer f7 a4 df 33 c4 41 db e2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a9 18 47 cf a8 09 26 65>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 78 ee 5f 53 21 e6 19 2d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 78 ee 5f 53 21 e6 19 2d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.62:53702',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201787
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33334
received auth hello!
{ authId: 502, nonce: <Buffer b8 fc f5 dd 1d c5 8c f8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6c 0b 0e 39 41 ac 2b 1b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3b d9 c6 7f 06 15 fb 01>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3b d9 c6 7f 06 15 fb 01> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.62:53852',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201803
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33492
received auth hello!
{ authId: 502, nonce: <Buffer 78 6c fd f2 fb 67 a2 75> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8c ad 90 07 f6 35 ba 16>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 53 58 b3 c0 85 c1 a9 d6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 53 58 b3 c0 85 c1 a9 d6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.62:54010',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201819
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33646
received auth hello!
{ authId: 502, nonce: <Buffer 7a ab 20 37 47 cb 4e 86> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5d f4 18 72 27 46 30 1a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 21 18 bc 5e 44 67 f6 8e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 21 18 bc 5e 44 67 f6 8e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 24,
  remoteAddress: '::ffff:10.0.1.62:54164',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 24 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 24 }
specified socketID: 24
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #24 closed
