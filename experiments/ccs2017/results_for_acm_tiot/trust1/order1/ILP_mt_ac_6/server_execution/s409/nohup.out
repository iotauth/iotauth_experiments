changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s409.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's409',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 67 49 42 41 41 4b 43 41 51 45 41 6f 6c ... > }
Handler: listening on port 22100
s409:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200422
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48954
received auth hello!
{ authId: 402, nonce: <Buffer cc 67 97 2f 37 76 64 f9> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 1b 67 03 31 41 83 b6 07>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 92 04 8d e3 76 01 bf 9a 44 e0 18 39 a2 1f b9 b3>,
  macKeyVal: <Buffer 3d b5 b7 dd e4 da fa 3a 11 d5 2d 63 a4 1c 5b fe ac 9a 9a bd e7 c5 f7 4c c9 b3 42 24 55 b4 ec 4e>,
  absValidity: 2018-03-21T09:02:14.752Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 38 79 2b 3b a6 50 c8 9e>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 38 79 2b 3b a6 50 c8 9e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.55:38122',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200429
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49140
received auth hello!
{ authId: 402, nonce: <Buffer 16 bb 1a a1 02 49 f8 2f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 09 33 c4 9f 2f 81 b9 42>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 25 fb b2 67 15 85 08 79>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 25 fb b2 67 15 85 08 79> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.55:38308',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200436
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49412
received auth hello!
{ authId: 402, nonce: <Buffer 98 62 8c c7 d1 8b 5c 8e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 46 3d 56 f5 a5 4a ab b9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fb fb da e7 ce ef 41 e5>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer fb fb da e7 ce ef 41 e5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.55:38580',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200443
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49682
received auth hello!
{ authId: 402, nonce: <Buffer c9 c0 6d ad 16 d1 10 05> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c5 1a ee 5c ed 84 e0 08>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4d 28 fb d1 2f 47 69 53>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 4d 28 fb d1 2f 47 69 53> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.55:38850',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200450
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49952
received auth hello!
{ authId: 402, nonce: <Buffer cc 2f 75 c8 b0 1a 5c 91> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 02 de ff f2 7c e4 fe b4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 66 cc ad e3 96 29 fb f3>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 66 cc ad e3 96 29 fb f3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.55:39120',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200457
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50222
received auth hello!
{ authId: 402, nonce: <Buffer 31 1a 7b 82 f4 1e b8 0c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 44 33 34 c9 b9 69 dc 6f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 91 f6 e5 13 a0 bd 57 4f>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 91 f6 e5 13 a0 bd 57 4f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.55:39390',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200464
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 50492
received auth hello!
{ authId: 402, nonce: <Buffer 2c 6a d4 0a 36 df a4 fb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 88 47 f7 4b 87 92 a8 2e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 45 d3 ce 82 73 71 66 8c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 45 d3 ce 82 73 71 66 8c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.55:39660',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
