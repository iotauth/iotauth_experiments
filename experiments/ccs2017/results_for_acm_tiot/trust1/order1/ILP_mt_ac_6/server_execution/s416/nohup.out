changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s416.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's416',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 51 49 42 41 41 4b 43 41 51 45 41 35 7a ... > }
Handler: listening on port 22100
s416:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300698
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52580
received auth hello!
{ authId: 403, nonce: <Buffer a1 63 66 b3 a5 d2 b5 b9> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer fa 07 d6 59 35 c9 b0 9b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 6e 59 8d 3d f8 73 8c bb a8 d7 23 2c 98 94 d6 f0>,
  macKeyVal: <Buffer 0a 98 de e8 1a 2b 37 24 2c e4 60 cb 55 0f 26 94 18 85 69 f6 56 91 25 de 7c b5 6e a3 b8 d7 68 63>,
  absValidity: 2018-03-21T09:02:29.262Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9c 78 d6 ac 49 3e 6a f5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9c 78 d6 ac 49 3e 6a f5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.60:56312',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300699
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52586
received auth hello!
{ authId: 403, nonce: <Buffer 82 12 71 69 8e 49 6a 03> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5a 2a b5 8e 20 56 65 b6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ec 71 ec 68 60 7d b8 8c>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ec 71 ec 68 60 7d b8 8c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.61:50642',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300704
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52792
received auth hello!
{ authId: 403, nonce: <Buffer af 24 e7 d9 21 42 33 b0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 85 ab 86 59 83 6c eb ca>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 63 39 fe 67 88 78 5e b1>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 63 39 fe 67 88 78 5e b1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.60:56524',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300705
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52808
received auth hello!
{ authId: 403, nonce: <Buffer d2 bf ed 3f fa 1d 2b 87> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b4 96 bd eb 91 57 0f 55>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4f 96 1b 46 d7 c0 15 36>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 4f 96 1b 46 d7 c0 15 36> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.61:50864',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300710
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53064
received auth hello!
{ authId: 403, nonce: <Buffer 81 88 4a f1 12 97 a9 13> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 94 15 6c a8 0a 6f 2d 50>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 05 d3 2e 9b dc e1 c8 5c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 05 d3 2e 9b dc e1 c8 5c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.60:56796',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300711
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53080
received auth hello!
{ authId: 403, nonce: <Buffer c3 bc 15 93 6a 6f ce 44> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f3 df fe 4a 0a 9a 97 39>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer dc 5d 0f b6 c0 c1 0f 37>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer dc 5d 0f b6 c0 c1 0f 37> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.61:51136',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300716
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53334
received auth hello!
{ authId: 403, nonce: <Buffer 41 23 01 f8 af 71 6f e7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer be 7f 04 0d 1e dd df 72>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 99 c1 87 17 5d 0a 2f 8c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 99 c1 87 17 5d 0a 2f 8c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.60:57066',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300717
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53350
received auth hello!
{ authId: 403, nonce: <Buffer 33 2a a0 7d b1 1b 62 d7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 14 c6 de 4a 59 07 90 bb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a7 0e c7 71 8c 0e ab 9d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a7 0e c7 71 8c 0e ab 9d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.61:51406',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300722
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53604
received auth hello!
{ authId: 403, nonce: <Buffer a8 d5 d6 25 8e a2 1f d8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b2 55 05 a3 51 d0 c9 1d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 54 be ac 87 e2 4b ea 8b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 54 be ac 87 e2 4b ea 8b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.60:57336',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300723
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53620
received auth hello!
{ authId: 403, nonce: <Buffer b8 f0 27 b2 5c ae b8 99> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6b 95 ea b5 5a 76 89 e0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e0 3b 29 0e 85 cd e5 3b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e0 3b 29 0e 85 cd e5 3b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.61:51676',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300728
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53874
received auth hello!
{ authId: 403, nonce: <Buffer 39 5c 1e 61 b1 4f bb c0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b0 6f 39 4c 24 8c 09 a3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cc a5 80 71 84 32 a8 84>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer cc a5 80 71 84 32 a8 84> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.60:57606',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300729
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53890
received auth hello!
{ authId: 403, nonce: <Buffer cd 9d b7 a4 09 d7 29 71> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 97 75 ce 4a 9c a1 6e 05>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 63 f1 92 65 a3 41 e7 e2>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 63 f1 92 65 a3 41 e7 e2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.61:51946',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300734
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54144
received auth hello!
{ authId: 403, nonce: <Buffer af 06 09 11 56 5a d1 d0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b2 45 fa 91 6e 16 5a 5e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 86 01 1f 70 57 51 f8 cf>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 86 01 1f 70 57 51 f8 cf> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.60:57876',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300735
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54160
received auth hello!
{ authId: 403, nonce: <Buffer d4 8e 4d 51 f6 16 48 a3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8e 69 6e a2 0d 2f 63 ae>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ab 61 8a b5 ea bc 04 e9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ab 61 8a b5 ea bc 04 e9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.61:52216',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300740
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54410
received auth hello!
{ authId: 403, nonce: <Buffer 22 fc 0e 63 fd 0a 80 6a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ec 6c 59 9f 76 71 91 49>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2e cb a6 da 58 e3 85 a2>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 2e cb a6 da 58 e3 85 a2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.60:58142',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300741
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54426
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
