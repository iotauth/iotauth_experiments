changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s412.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's412',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 34 74 ... > }
Handler: listening on port 22100
s412:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300695
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56978
received auth hello!
{ authId: 403, nonce: <Buffer 37 11 d8 ae 41 03 e2 96> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 23 cc 38 a5 a9 5f 99 95>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 5c ba 06 d9 fc 2e 0e 6b ac 45 f3 09 95 68 a5 33>,
  macKeyVal: <Buffer db df 34 99 eb 42 b9 ac f8 24 58 b6 dd da 3d 25 ab 9b fa 81 11 58 98 48 14 57 bc d1 b3 92 07 72>,
  absValidity: 2018-03-21T09:02:18.127Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a3 ba a1 b3 33 a1 e7 55>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer a3 ba a1 b3 33 a1 e7 55> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.57:37816',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300701
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57176
received auth hello!
{ authId: 403, nonce: <Buffer b8 c2 3f 7e 52 e0 43 d5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer aa 80 f8 f7 fd b0 e9 23>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ed 74 87 06 be 81 42 f8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ed 74 87 06 be 81 42 f8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.57:38014',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300707
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57448
received auth hello!
{ authId: 403, nonce: <Buffer d7 21 11 fc 31 88 36 7e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8e 7b 91 80 66 91 85 60>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a7 66 39 38 df 28 a4 2e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a7 66 39 38 df 28 a4 2e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.57:38286',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300713
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57718
received auth hello!
{ authId: 403, nonce: <Buffer e6 3d 70 f1 1f 36 12 9f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d5 d7 b7 94 ff 18 f9 c0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 52 46 fc 80 ee 03 2c 7f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 52 46 fc 80 ee 03 2c 7f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.57:38556',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300719
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 57988
received auth hello!
{ authId: 403, nonce: <Buffer 35 1b 91 bc 55 6b 04 c8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a6 d4 2f e0 42 2f ac 94>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 23 f6 7e ef b3 dd 8f 1c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 23 f6 7e ef b3 dd 8f 1c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.57:38826',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300725
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58258
received auth hello!
{ authId: 403, nonce: <Buffer 80 e3 e5 c4 5e e5 6d ff> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1f 2e b6 c7 2b 24 27 94>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1e f8 07 f0 64 3b 48 e1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1e f8 07 f0 64 3b 48 e1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.57:39096',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300731
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58528
received auth hello!
{ authId: 403, nonce: <Buffer d9 09 16 59 ce 02 ea 11> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c7 d4 20 9a ac 9f e0 01>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bb d9 a0 c2 da e8 08 e1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bb d9 a0 c2 da e8 08 e1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.57:39366',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300737
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 58794
received auth hello!
{ authId: 403, nonce: <Buffer bb f2 e1 2c ba a2 7c f9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 95 29 82 45 14 29 9e 3f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b4 77 4e 4a 5d 17 ff ae>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b4 77 4e 4a 5d 17 ff ae> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.57:39632',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
