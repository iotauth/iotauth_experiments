changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s516.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's516',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 33 73 ... > }
Handler: listening on port 22100
s516:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300880
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35568
received auth hello!
{ authId: 503, nonce: <Buffer 60 2f ef cc e3 82 ab 42> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer e9 11 b0 50 cc 01 ca f0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 95 d5 8d e8 52 16 2b 6e f7 fd d1 e5 18 c3 f5 40>,
  macKeyVal: <Buffer 5e 6e d6 73 54 52 38 04 26 cf 45 61 82 58 b1 eb a4 56 d4 96 38 85 82 59 21 54 87 84 84 6c 33 31>,
  absValidity: 2018-03-21T09:03:40.581Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2a df 5d ea f5 ae d1 7b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2a df 5d ea f5 ae d1 7b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.82:44410',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300885
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35838
received auth hello!
{ authId: 503, nonce: <Buffer 9c 14 cd 9f 68 22 d9 40> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 09 d8 48 da d2 6b fc e1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d4 34 6f 46 4f 67 f2 5e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d4 34 6f 46 4f 67 f2 5e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.82:44680',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300890
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36108
received auth hello!
{ authId: 503, nonce: <Buffer 86 73 89 ff c1 a8 d6 e7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d6 86 59 ac 79 a8 2a aa>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ec fb f9 ef 78 8b a3 7f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ec fb f9 ef 78 8b a3 7f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.82:44950',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300895
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36378
received auth hello!
{ authId: 503, nonce: <Buffer ac 61 14 cf e0 cb 4e 7c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9e 48 cc ab e4 78 ba 6e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 33 e4 47 fc f9 25 b2 92>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 33 e4 47 fc f9 25 b2 92> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.82:45220',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300900
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36648
received auth hello!
{ authId: 503, nonce: <Buffer f4 12 38 00 67 13 a8 ca> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer dd 1c ed 2c f0 3c 09 1e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ec 2a 5c 19 1b f4 07 41>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ec 2a 5c 19 1b f4 07 41> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.82:45490',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300905
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36918
received auth hello!
{ authId: 503, nonce: <Buffer 9c 36 86 46 dd d4 30 b5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 91 d8 69 6f a2 3c db 89>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 43 2f 14 5b c6 a6 78 4e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 43 2f 14 5b c6 a6 78 4e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.82:45760',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300910
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37176
received auth hello!
{ authId: 503, nonce: <Buffer 32 75 f1 f7 7d 9d b0 71> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5d e4 d7 04 d2 9d 21 b4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bd 73 d5 72 d2 45 9b 74>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bd 73 d5 72 d2 45 9b 74> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.82:46018',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
