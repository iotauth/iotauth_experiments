changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s415.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's415',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 74 46 ... > }
Handler: listening on port 22100
s415:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300649
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38908
received auth hello!
{ authId: 403, nonce: <Buffer 38 eb 89 47 22 8a 95 c5> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer ba 01 1d 10 c3 88 26 81>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 09 ba 49 7f 26 d6 84 32 c2 2d 14 ac ec 3d e4 04>,
  macKeyVal: <Buffer 0f c2 bf cc 82 43 8b 5d d5 24 74 f5 fb c2 7e 7a ea b8 e4 2d 8d 43 29 2f 96 90 97 bf d4 c8 8e 71>,
  absValidity: 2018-03-21T08:18:56.084Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f5 b3 c8 24 06 36 97 c1>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f5 b3 c8 24 06 36 97 c1> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.59:59882',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300655
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39118
received auth hello!
{ authId: 403, nonce: <Buffer c6 81 86 00 27 05 25 75> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 74 01 81 b7 6f 0e 63 f2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6e c8 84 9a 8d 78 8d 3f>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 6e c8 84 9a 8d 78 8d 3f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.59:60092',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300661
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39390
received auth hello!
{ authId: 403, nonce: <Buffer 3a a2 d2 23 0d eb 13 de> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 50 8d f5 d6 7f 35 09 80>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bf c1 b4 84 da 47 25 d2>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer bf c1 b4 84 da 47 25 d2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.59:60364',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300667
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39660
received auth hello!
{ authId: 403, nonce: <Buffer ff 09 15 57 77 ab 47 62> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b4 99 6f bf ca 18 a3 2f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8d c0 15 d7 b3 a2 76 27>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8d c0 15 d7 b3 a2 76 27> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.59:60634',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300673
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 39930
received auth hello!
{ authId: 403, nonce: <Buffer 22 6d 96 2c 3d cb c5 5b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c3 77 0b 77 ca a4 4b f0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 59 85 8d e7 d7 ed 06 8b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 59 85 8d e7 d7 ed 06 8b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.59:60904',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300679
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40200
received auth hello!
{ authId: 403, nonce: <Buffer e3 8c 4c 5c de 09 67 34> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cf f3 02 b3 96 c3 4c ee>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 91 36 36 84 e7 35 57 fd>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 91 36 36 84 e7 35 57 fd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.59:32942',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300685
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40470
received auth hello!
{ authId: 403, nonce: <Buffer 36 e6 4e e2 fd be 1e 15> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f9 cd c5 95 e8 90 e9 aa>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 60 9c 87 d9 7c b6 57 6b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 60 9c 87 d9 7c b6 57 6b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.59:33212',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300691
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 40732
received auth hello!
{ authId: 403, nonce: <Buffer d4 a0 b1 37 5d c0 07 4e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 95 18 f4 8b 27 94 78 bc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 45 f8 68 db 87 eb f5 83>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 45 f8 68 db 87 eb f5 83> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.59:33474',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
