changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s515.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's515',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 76 72 ... > }
Handler: listening on port 22100
s515:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300845
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47626
received auth hello!
{ authId: 503, nonce: <Buffer 2c 58 83 7a 00 92 3e 38> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer dd 32 77 46 d5 29 28 45>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 0d 8d d8 1e 31 44 6c c7 2a 9d 17 9e bb c9 db 33>,
  macKeyVal: <Buffer 55 9e ba b7 4a ba 1a 55 f0 c4 9d 4e 8b b7 25 1c d1 5f 98 f3 1e 28 f7 40 1b cb 64 dd 9f 61 b6 5c>,
  absValidity: 2018-03-21T08:20:08.337Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b1 20 f8 cc 3d 11 2c 44>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b1 20 f8 cc 3d 11 2c 44> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.81:56828',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300850
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47896
received auth hello!
{ authId: 503, nonce: <Buffer 04 87 ce 9e 49 72 1b 5a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 58 be 56 27 f8 0f 98 51>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 87 47 67 a4 b8 cd 72 67>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 87 47 67 a4 b8 cd 72 67> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.81:57098',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300855
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48166
received auth hello!
{ authId: 503, nonce: <Buffer 74 95 6a 16 80 6d 41 b5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 28 b5 32 9e 63 c0 8d fa>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cc 70 72 b0 8f 29 78 b5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer cc 70 72 b0 8f 29 78 b5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.81:57368',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300860
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48436
received auth hello!
{ authId: 503, nonce: <Buffer fb 36 e0 07 9f 71 75 2b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e4 14 87 23 c3 b8 fe 5b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ee 63 12 0f fe fd 15 c7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ee 63 12 0f fe fd 15 c7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.81:57638',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300865
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48706
received auth hello!
{ authId: 503, nonce: <Buffer 9a 5a 98 70 da f4 95 3f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c0 d7 eb 2b cf 6d 93 90>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 74 12 45 e7 52 8d 30 00>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 74 12 45 e7 52 8d 30 00> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.81:57908',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300870
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48976
received auth hello!
{ authId: 503, nonce: <Buffer f9 26 25 fb 23 cf ba f3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 79 57 41 7c 4b 25 5e 92>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer da 99 b6 02 d9 93 54 b5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer da 99 b6 02 d9 93 54 b5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.81:58178',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50300875
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 49234
received auth hello!
{ authId: 503, nonce: <Buffer 8b 14 a0 10 f7 e3 40 f1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c1 a1 dc 11 a9 88 05 6c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a8 14 0c 24 d4 44 18 b3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a8 14 0c 24 d4 44 18 b3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.81:58436',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
