changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s506.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's506',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 37 56 ... > }
Handler: listening on port 22100
s506:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100600
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33512
received auth hello!
{ authId: 501, nonce: <Buffer ef 90 bd a7 6d e0 f5 2f> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 86 36 e3 75 61 01 7f 73>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 9d 34 27 0f 64 00 53 db ae 38 dc c3 20 51 95 d8>,
  macKeyVal: <Buffer 6f 09 1d 53 89 a9 c1 ee 80 dc e0 a0 46 d8 79 fb b1 f6 b7 08 79 e0 9e 78 ac b8 b0 b3 df c1 ae e3>,
  absValidity: 2018-03-21T08:19:32.016Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5a 93 8f 92 65 66 17 dc>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 5a 93 8f 92 65 66 17 dc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.70:43642',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100608
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33784
received auth hello!
{ authId: 501, nonce: <Buffer 75 ed d8 8f 3b 3b 83 1d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c5 88 97 8a dc d1 e4 cc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ee df 5a 86 12 50 61 a0>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ee df 5a 86 12 50 61 a0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.70:43914',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100616
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34054
received auth hello!
{ authId: 501, nonce: <Buffer 88 9d 7e 9d c4 da 87 fa> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 91 3c db 41 77 50 f5 bd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d5 93 d5 83 f2 66 02 9b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d5 93 d5 83 f2 66 02 9b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.70:44184',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100624
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34324
received auth hello!
{ authId: 501, nonce: <Buffer 81 27 fc ad 35 1f 12 84> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 07 e6 59 75 cb fd 77 c7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2d 3b 58 1f d3 0a f6 87>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2d 3b 58 1f d3 0a f6 87> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.70:44452',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100632
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34594
received auth hello!
{ authId: 501, nonce: <Buffer 8c 74 5c 60 2f 74 d7 19> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8a c0 6b 96 0b 5c 29 33>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e9 10 1a 13 95 4c fa 9f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e9 10 1a 13 95 4c fa 9f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.70:44722',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100640
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34864
received auth hello!
{ authId: 501, nonce: <Buffer 1d eb 47 3e 61 b0 06 6c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0d 09 02 2b df 08 2c 17>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e6 3d af 76 b3 8d 6f 95>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e6 3d af 76 b3 8d 6f 95> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.70:44992',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100648
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35130
received auth hello!
{ authId: 501, nonce: <Buffer 06 25 af 86 83 63 6c 9f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 08 43 5f 77 fc e3 e6 d4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d3 45 12 a3 d8 50 ed e0>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d3 45 12 a3 d8 50 ed e0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.70:45260',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
