changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s507.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's507',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 6d 66 ... > }
Handler: listening on port 22100
s507:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100601
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36904
received auth hello!
{ authId: 501, nonce: <Buffer 65 e0 14 e3 05 f8 e5 e5> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer d1 71 4e c8 f0 34 63 75>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer df 17 a2 d1 42 f1 3d eb 60 6d f7 c9 cc 8d 94 1c>,
  macKeyVal: <Buffer 10 7a 11 8b 5c c1 b9 1c 74 27 27 42 96 59 59 65 19 28 a1 3d 3d 28 29 b2 2b 7f aa cc 45 05 07 19>,
  absValidity: 2018-03-21T08:19:36.061Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f9 0f 78 fa ee 29 5c 1b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f9 0f 78 fa ee 29 5c 1b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.71:50574',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100609
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37176
received auth hello!
{ authId: 501, nonce: <Buffer 36 d0 7a 55 30 41 6c e3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b0 ef c9 de ec 82 23 72>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 61 1e 64 d0 50 22 3f 2b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 61 1e 64 d0 50 22 3f 2b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.71:50846',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100617
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37446
received auth hello!
{ authId: 501, nonce: <Buffer 14 dc f6 dd 50 30 cc cb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e2 a1 8a b6 af 5f 89 77>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer af 22 0a 9a f6 67 ed b5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer af 22 0a 9a f6 67 ed b5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.71:51116',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100625
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37716
received auth hello!
{ authId: 501, nonce: <Buffer cb 31 bd 28 78 04 87 8f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d8 6f f7 18 ec 28 6e 39>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3e f6 b8 08 07 16 dc 04>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3e f6 b8 08 07 16 dc 04> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.71:51386',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100633
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37986
received auth hello!
{ authId: 501, nonce: <Buffer 7e 48 78 f3 07 33 a3 dc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 74 f3 7f 60 29 8f 6c 2d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7b c0 54 73 e8 39 1f 1b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 7b c0 54 73 e8 39 1f 1b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.71:51656',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100641
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38256
received auth hello!
{ authId: 501, nonce: <Buffer df 74 0c 6b 18 b5 fb f4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c9 8f 16 94 f3 36 4f 98>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 32 59 3d 35 5d 45 10 ea>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 32 59 3d 35 5d 45 10 ea> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.71:51926',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100649
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38522
received auth hello!
{ authId: 501, nonce: <Buffer a1 eb 49 03 46 9c ed 2b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 41 63 d5 a7 2a 79 70 6a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 46 e4 6b 81 a0 35 58 1d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 46 e4 6b 81 a0 35 58 1d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.71:52192',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201204
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201217
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 33772
received auth hello!
{ authId: 502, nonce: <Buffer 4a b3 7e bc b2 80 f7 6c> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '0162476AF952',
  notBefore: 2018-03-21T07:15:15.000Z,
  notAfter: 2018-03-22T07:16:55.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '87:FF:1A:6E:97:8B:72:D5:27:DF:17:7E:26:D0:3D:BA:D4:BB:E3:6A',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'AEEAB02ACD0C32937DD84F3EB43F6189EAF089B04CE490F227FEC1E1A42FF33AACC957083F15D2CFEBF0E484D5D2BD03DD21587B3DF0ADCF1F273CEB6D3ADD0C5BD72406DA2D4A379546AD8D1C72FF3DB6ECF5D19A3A100B89C7B659A65778923B085EE02B29C23C0BF27314DEEC84CC61B318C930EC82C3B5DB050AD2527763CDCB5CEE65C7B2D7C1052512A2B08B2601CA1A4E32273B811E50FD7E40A702A19D8D7DB1E27E4C4E0A2F783C9AE1F654053799A646075FDCF3A86C68C654BCCA093F1A4B4044DAAFAB0E1FA7692D70BA1D4DBF798207A97EFFA87E7F6BE94B5E3D49438D87392AA382C0493F6F6E59A3B858B64877C59B95478C667FEE6CD71D',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJHavlSMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDMy\nMTA3MTUxNVoXDTE4MDMyMjA3MTY1NVowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQCu6rAqzQwyk33YTz60P2GJ6vCJsEzkkPIn/sHhpC/zOqzJVwg/\nFdLP6/DkhNXSvQPdIVh7PfCtzx8nPOttOt0MW9ckBtotSjeVRq2NHHL/Pbbs9dGa\nOhALice2WaZXeJI7CF7gKynCPAvycxTe7ITMYbMYyTDsgsO12wUK0lJ3Y83LXO5l\nx7LXwQUlEqKwiyYByhpOMic7gR5Q/X5ApwKhnY19seJ+TE4KL3g8muH2VAU3maZG\nB1/c86hsaMZUvMoJPxpLQETar6sOH6dpLXC6HU2/eYIHqX7/qH5/a+lLXj1JQ42H\nOSqjgsBJP29uWaO4WLZId8WblUeMZn/ubNcdAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBALf3yNv5DGfc5lz3EddzAfi0lKhdDFso\nIh0Na45fEKWRukPRRcYbb61mQHIVIJVsQ1tYjOZW8dHzaA/ZF1d5eAr08YNp6Tix\nACTosCgZUR4swjS+Iae3rn49+kgBJLFRlVJgfjWSD1kV3F+lbiSYam548JGXHnvy\nkK72yzfKUUvV4vnjNyWZW8zK740Qtcdv4unk0e+0/B2pG7bja3IDITeL0tXyJCW/\nmkFMaHlfCkHiUQo1xlIaYR7neGFsnzCW3ZIJovcCztKAYyNl3zYjhPsaqv9IChKk\nTDuV2Ehjz1a5Pr6IhruYql6JY2ZYkBdHwQKOGdOnSyPcHjx6J5+6H5w=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201230
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33958
received auth hello!
{ authId: 502, nonce: <Buffer 2f cd d8 14 f4 a8 4d 46> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 21 a3 2e 7a e8 ac a6 91>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 53 45 01 b5 27 ea c0 11 c3 d5 55 ca cf 4a 33 89>,
  macKeyVal: <Buffer 1d 2b d3 58 90 9d 31 36 ea 80 cc 77 0d 3d 69 32 49 9a c2 e1 c4 57 8c 6a 29 cd 5c 21 65 9f 1e e6>,
  absValidity: 2018-03-21T08:30:36.009Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9c f6 60 2d 24 34 3a 48>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9c f6 60 2d 24 34 3a 48> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.71:53140',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201243
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34150
received auth hello!
{ authId: 502, nonce: <Buffer 0c 63 52 a7 9f d4 80 ca> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 00 af da 26 43 41 76 d1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9b 60 be 68 0a a5 33 80>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9b 60 be 68 0a a5 33 80> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.71:53332',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201256
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34336
received auth hello!
{ authId: 502, nonce: <Buffer c2 61 4a e2 48 4f 95 07> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8f 0c ef 0e 72 24 e9 f6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e5 aa 53 19 1a ee fe a8>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e5 aa 53 19 1a ee fe a8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.71:53518',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201269
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34524
received auth hello!
{ authId: 502, nonce: <Buffer b7 b4 ad ae 3b 33 2c 25> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c9 ab 9a db 54 a8 e5 a1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 4a 76 88 d5 37 3d 99 e9>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 4a 76 88 d5 37 3d 99 e9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.71:53706',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201282
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34706
received auth hello!
{ authId: 502, nonce: <Buffer 8e f3 bc 07 17 8a 5a ef> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 80 45 94 19 20 2a fa aa>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e9 81 6b 40 e0 6e 2a 3e>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e9 81 6b 40 e0 6e 2a 3e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.71:53888',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201295
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34892
received auth hello!
{ authId: 502, nonce: <Buffer e1 69 75 d0 d3 e7 a4 7e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 42 b2 92 f5 a4 a8 cc 4a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer eb 54 d1 8e 33 81 ac 5d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer eb 54 d1 8e 33 81 ac 5d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.71:54074',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201308
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35078
received auth hello!
{ authId: 502, nonce: <Buffer 63 9e 85 31 a6 1c 3c 9e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c1 0e 39 00 55 d4 8d cd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 55 6f ca 5c 6a f3 8b 9d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 55 6f ca 5c 6a f3 8b 9d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.71:54260',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201321
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35264
received auth hello!
{ authId: 502, nonce: <Buffer c9 c7 84 69 1b 38 00 82> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bb 78 16 8f fb da 5b 91>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f2 83 cb e5 6f b6 de 91>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f2 83 cb e5 6f b6 de 91> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.71:54446',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201334
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35450
received auth hello!
{ authId: 502, nonce: <Buffer 9b b5 4d 05 3b 5d fe bc> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bf fb dc d1 11 da d6 ad>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7f e9 8d c8 3d 72 dd 33>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 7f e9 8d c8 3d 72 dd 33> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.71:54632',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201347
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35636
received auth hello!
{ authId: 502, nonce: <Buffer 4c 77 d9 6b 6e 60 6d b4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4d 1b 57 91 e5 72 74 14>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer be ca 13 80 6d 28 be 63>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer be ca 13 80 6d 28 be 63> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.71:54818',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201360
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 35822
received auth hello!
{ authId: 502, nonce: <Buffer a5 d1 bf 79 23 45 7e ac> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 76 18 19 07 af 51 69 6e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d0 9c f8 cd 09 a5 8a 82>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d0 9c f8 cd 09 a5 8a 82> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.71:55004',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201373
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36008
received auth hello!
{ authId: 502, nonce: <Buffer 1d 3a 8f 4a 7f 0d 6f aa> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3f 35 8b 29 39 66 db d7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer aa e6 d7 03 ba d4 8c 49>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer aa e6 d7 03 ba d4 8c 49> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.71:55190',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201386
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36194
received auth hello!
{ authId: 502, nonce: <Buffer b1 2d ac 00 25 7e e3 16> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 51 53 13 3b 1f 00 f3 c4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3b b3 37 e5 e9 0c c8 2d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3b b3 37 e5 e9 0c c8 2d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.71:55376',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201399
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36380
received auth hello!
{ authId: 502, nonce: <Buffer 01 2e 01 58 4f 80 3e 22> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f5 c6 e5 1b d5 5d cd 00>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d3 19 c0 a0 57 d5 47 2c>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer d3 19 c0 a0 57 d5 47 2c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.71:55562',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201412
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36566
received auth hello!
{ authId: 502, nonce: <Buffer 2c 01 9b b8 4d 20 64 de> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 70 f8 19 f0 c1 e4 57 c8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 17 c6 04 8b 05 23 c5 bf>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 17 c6 04 8b 05 23 c5 bf> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.71:55748',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201425
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36752
received auth hello!
{ authId: 502, nonce: <Buffer 41 fc 8f 46 dd 3a 8c 5a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c4 68 67 0d 55 8f a2 7f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 23 fc 01 c1 c3 ed b9 18>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 23 fc 01 c1 c3 ed b9 18> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.71:55934',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201438
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36938
received auth hello!
{ authId: 502, nonce: <Buffer be d7 19 40 f6 27 b4 e7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d8 ef e7 40 6a 24 e2 22>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 41 3f 3b d2 2f 2c 17 8d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 41 3f 3b d2 2f 2c 17 8d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.71:56120',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201451
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37076
received auth hello!
{ authId: 502, nonce: <Buffer a8 4c 02 77 ab 1b 5e 48> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 81 da 1c ff 03 ab c1 7f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 95 f8 34 6c 13 36 9a 19>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 95 f8 34 6c 13 36 9a 19> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 24,
  remoteAddress: '::ffff:10.0.1.71:56258',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 24 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 24 }
specified socketID: 24
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #24 closed
