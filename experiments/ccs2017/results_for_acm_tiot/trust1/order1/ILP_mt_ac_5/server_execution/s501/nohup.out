changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s501.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's501',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 78 42 ... > }
Handler: listening on port 22100
s501:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100594
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60990
received auth hello!
{ authId: 501, nonce: <Buffer c9 18 e4 79 d2 8c 1d b1> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 2e 82 bd 00 57 5b e1 40>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 1d 66 8c 17 08 f5 98 14 e0 12 92 b8 89 fc 49 11>,
  macKeyVal: <Buffer 72 91 90 45 20 77 f8 02 8c 0d 30 78 1c b4 c4 10 75 48 5e c7 06 ef 8f 47 af 2a f8 39 c5 b0 54 1d>,
  absValidity: 2018-03-21T08:19:05.134Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e7 ba aa 59 b3 84 1b 1d>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e7 ba aa 59 b3 84 1b 1d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.62:43064',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100602
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 32988
received auth hello!
{ authId: 501, nonce: <Buffer 7f 01 6e 19 52 7e 5b b4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d3 3c c3 12 c3 8a cf 8b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 19 71 17 89 97 5d 5b f7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 19 71 17 89 97 5d 5b f7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.62:43294',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100610
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33258
received auth hello!
{ authId: 501, nonce: <Buffer ad 51 4f 7a a2 87 45 29> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 54 3d 7c 4a 8a 56 51 a0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e1 5b 4e 7e c2 0b 11 61>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e1 5b 4e 7e c2 0b 11 61> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.62:43564',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100618
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33528
received auth hello!
{ authId: 501, nonce: <Buffer 05 ae 18 93 12 1e 74 7e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 94 09 8d e0 1c 24 c3 7c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a3 f9 28 48 33 02 46 70>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer a3 f9 28 48 33 02 46 70> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.62:43834',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100626
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 33798
received auth hello!
{ authId: 501, nonce: <Buffer 82 e3 45 42 43 e8 f0 09> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 42 d1 a0 48 c3 e4 d1 03>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f4 0e 1b 6c 1e db 49 b5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f4 0e 1b 6c 1e db 49 b5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.62:44104',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100634
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34068
received auth hello!
{ authId: 501, nonce: <Buffer 4f 18 f0 a3 3e 2b 76 38> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 88 e4 1a 86 9f 24 00 d2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 3c 2e 8d 25 2f 7e 1f 8c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 3c 2e 8d 25 2f 7e 1f 8c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.62:44372',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100642
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 34338
received auth hello!
{ authId: 501, nonce: <Buffer 8f aa ca 31 f1 f8 7f dd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer df 65 25 08 f7 49 27 18>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 1c c5 49 04 f9 d5 c0 d5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 1c c5 49 04 f9 d5 c0 d5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.62:44644',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201199
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 1
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201212
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in server - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 53154
received auth hello!
{ authId: 502, nonce: <Buffer b5 75 90 72 a4 62 be f4> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '0162476AF952',
  notBefore: 2018-03-21T07:15:15.000Z,
  notAfter: 2018-03-22T07:16:55.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '87:FF:1A:6E:97:8B:72:D5:27:DF:17:7E:26:D0:3D:BA:D4:BB:E3:6A',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'AEEAB02ACD0C32937DD84F3EB43F6189EAF089B04CE490F227FEC1E1A42FF33AACC957083F15D2CFEBF0E484D5D2BD03DD21587B3DF0ADCF1F273CEB6D3ADD0C5BD72406DA2D4A379546AD8D1C72FF3DB6ECF5D19A3A100B89C7B659A65778923B085EE02B29C23C0BF27314DEEC84CC61B318C930EC82C3B5DB050AD2527763CDCB5CEE65C7B2D7C1052512A2B08B2601CA1A4E32273B811E50FD7E40A702A19D8D7DB1E27E4C4E0A2F783C9AE1F654053799A646075FDCF3A86C68C654BCCA093F1A4B4044DAAFAB0E1FA7692D70BA1D4DBF798207A97EFFA87E7F6BE94B5E3D49438D87392AA382C0493F6F6E59A3B858B64877C59B95478C667FEE6CD71D',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJHavlSMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDMy\nMTA3MTUxNVoXDTE4MDMyMjA3MTY1NVowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQCu6rAqzQwyk33YTz60P2GJ6vCJsEzkkPIn/sHhpC/zOqzJVwg/\nFdLP6/DkhNXSvQPdIVh7PfCtzx8nPOttOt0MW9ckBtotSjeVRq2NHHL/Pbbs9dGa\nOhALice2WaZXeJI7CF7gKynCPAvycxTe7ITMYbMYyTDsgsO12wUK0lJ3Y83LXO5l\nx7LXwQUlEqKwiyYByhpOMic7gR5Q/X5ApwKhnY19seJ+TE4KL3g8muH2VAU3maZG\nB1/c86hsaMZUvMoJPxpLQETar6sOH6dpLXC6HU2/eYIHqX7/qH5/a+lLXj1JQ42H\nOSqjgsBJP29uWaO4WLZId8WblUeMZn/ubNcdAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBALf3yNv5DGfc5lz3EddzAfi0lKhdDFso\nIh0Na45fEKWRukPRRcYbb61mQHIVIJVsQ1tYjOZW8dHzaA/ZF1d5eAr08YNp6Tix\nACTosCgZUR4swjS+Iae3rn49+kgBJLFRlVJgfjWSD1kV3F+lbiSYam548JGXHnvy\nkK72yzfKUUvV4vnjNyWZW8zK740Qtcdv4unk0e+0/B2pG7bja3IDITeL0tXyJCW/\nmkFMaHlfCkHiUQo1xlIaYR7neGFsnzCW3ZIJovcCztKAYyNl3zYjhPsaqv9IChKk\nTDuV2Ehjz1a5Pr6IhruYql6JY2ZYkBdHwQKOGdOnSyPcHjx6J5+6H5w=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201225
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53346
received auth hello!
{ authId: 502, nonce: <Buffer 08 2d b4 08 67 5f ec 36> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 77 b5 bf 83 49 df 38 5d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 6d f0 48 d0 3f 8d 3d 2e d6 14 a6 70 b9 ad d1 12>,
  macKeyVal: <Buffer 44 79 9b 59 f8 d6 1f ec be 48 78 47 fb 6c 7a 70 4a d3 51 0c 9d 75 a4 94 3b d7 85 b8 22 c2 37 63>,
  absValidity: 2018-03-21T08:30:06.951Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 69 58 55 38 a2 1f 43 2e>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 69 58 55 38 a2 1f 43 2e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.62:45632',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201238
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53544
received auth hello!
{ authId: 502, nonce: <Buffer c1 10 82 b8 99 a2 87 65> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9f 8b 44 eb 75 8a f8 52>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d2 73 73 16 fa 9f 35 74>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d2 73 73 16 fa 9f 35 74> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.62:45828',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201251
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53724
received auth hello!
{ authId: 502, nonce: <Buffer 4c 8d d7 6a b8 99 78 fa> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9b b7 bb cc ee b1 40 50>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f6 d4 30 5c 70 97 67 86>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f6 d4 30 5c 70 97 67 86> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.62:46010',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201264
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53910
received auth hello!
{ authId: 502, nonce: <Buffer d8 3a c1 f3 b2 82 c4 8a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c7 92 b2 4c 0b 4e 27 56>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8a 67 a7 0d 69 5c 3c 4b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8a 67 a7 0d 69 5c 3c 4b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.62:46196',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201277
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54098
received auth hello!
{ authId: 502, nonce: <Buffer 65 71 7c 22 ea 2c 91 2d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3e 86 ba 78 04 e9 61 b2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer eb 5f 21 f1 e8 a8 cd da>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer eb 5f 21 f1 e8 a8 cd da> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.62:46384',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201290
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54280
received auth hello!
{ authId: 502, nonce: <Buffer 4f 5e c4 ed 34 d0 be 95> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ba 9d ee 83 5e 55 37 49>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer df eb ce 5d 12 ea 15 26>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer df eb ce 5d 12 ea 15 26> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.62:46566',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201303
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54466
received auth hello!
{ authId: 502, nonce: <Buffer 5a e2 10 94 56 f0 42 43> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ad 8f 8f 9c 79 4c 6d e4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 47 1d a0 8d 0e a6 f3 b0>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 47 1d a0 8d 0e a6 f3 b0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.62:46752',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201316
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54652
received auth hello!
{ authId: 502, nonce: <Buffer c8 55 91 76 31 02 25 22> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b8 07 05 b8 07 19 a1 8a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 00 ba 6c f9 2e fe 41 0a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 00 ba 6c f9 2e fe 41 0a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.62:46938',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201329
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54838
received auth hello!
{ authId: 502, nonce: <Buffer 65 f9 d6 3f 04 c9 1b de> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b2 bc 96 91 39 0c 9b a9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9c e0 d4 6e ec b5 5d 66>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9c e0 d4 6e ec b5 5d 66> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 15,
  remoteAddress: '::ffff:10.0.1.62:47124',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 15 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 15 }
specified socketID: 15
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #15 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201342
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55024
received auth hello!
{ authId: 502, nonce: <Buffer ea 27 45 21 e2 a0 47 fd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9d 38 59 e5 d3 9f ea f6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f7 40 fb a3 c5 16 c2 6f>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f7 40 fb a3 c5 16 c2 6f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 16,
  remoteAddress: '::ffff:10.0.1.62:47310',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 16 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 16 }
specified socketID: 16
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #16 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201355
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55210
received auth hello!
{ authId: 502, nonce: <Buffer 7b 65 f8 e3 10 3f ec c1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a1 49 cb 1b 6d 86 81 86>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a5 ec 8e 77 d7 6f c3 08>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer a5 ec 8e 77 d7 6f c3 08> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 17,
  remoteAddress: '::ffff:10.0.1.62:47496',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 17 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 17 }
specified socketID: 17
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #17 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201368
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55396
received auth hello!
{ authId: 502, nonce: <Buffer f6 ff 59 8d 68 03 20 77> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 57 e0 85 03 fd 34 d1 e9>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b7 49 d3 a7 8e 8d cb cb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b7 49 d3 a7 8e 8d cb cb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 18,
  remoteAddress: '::ffff:10.0.1.62:47682',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 18 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 18 }
specified socketID: 18
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #18 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201381
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55582
received auth hello!
{ authId: 502, nonce: <Buffer 0d 83 f0 99 17 9a 35 f3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fc 62 80 e7 d0 0a 3f 8c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 90 b9 96 3c 27 30 33 7f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 90 b9 96 3c 27 30 33 7f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 19,
  remoteAddress: '::ffff:10.0.1.62:47868',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 19 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 19 }
specified socketID: 19
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #19 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201394
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55768
received auth hello!
{ authId: 502, nonce: <Buffer 7b a6 d0 da e5 ff 76 71> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 58 95 0e fd a9 9e b5 07>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 71 b2 e9 19 39 5d 13 d5>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 71 b2 e9 19 39 5d 13 d5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 20,
  remoteAddress: '::ffff:10.0.1.62:48054',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 20 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 20 }
specified socketID: 20
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #20 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201407
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55954
received auth hello!
{ authId: 502, nonce: <Buffer 80 d0 2a ed 09 f7 99 d1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9f ea 28 5e 68 87 b2 c5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 5c 58 57 49 5e 82 30 0b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 5c 58 57 49 5e 82 30 0b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 21,
  remoteAddress: '::ffff:10.0.1.62:48240',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 21 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 21 }
specified socketID: 21
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #21 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201420
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56144
received auth hello!
{ authId: 502, nonce: <Buffer 86 7a 0f 63 12 c2 54 4b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 94 df e5 e3 a0 d2 7e cb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b7 46 93 2a 96 f1 41 7a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b7 46 93 2a 96 f1 41 7a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 22,
  remoteAddress: '::ffff:10.0.1.62:48426',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 22 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 22 }
specified socketID: 22
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #22 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201433
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56330
received auth hello!
{ authId: 502, nonce: <Buffer c4 35 53 a7 99 c4 cb 3b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9c 37 8e 9e ec 90 e0 18>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 91 77 1e 09 84 c7 e6 50>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 91 77 1e 09 84 c7 e6 50> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 23,
  remoteAddress: '::ffff:10.0.1.62:48612',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 23 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 23 }
specified socketID: 23
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #23 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50201446
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 56508
received auth hello!
{ authId: 502, nonce: <Buffer 8b ec ef a3 3e c0 1b d0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8f 57 10 7b aa 2b e9 f2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 62 eb 4c fa cb 6a 4a a0>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 62 eb 4c fa cb 6a 4a a0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 24,
  remoteAddress: '::ffff:10.0.1.62:48792',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 24 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 24 }
specified socketID: 24
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #24 closed
