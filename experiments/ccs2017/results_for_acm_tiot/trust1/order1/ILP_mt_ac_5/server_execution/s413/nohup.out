changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s413.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's413',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 76 77 ... > }
Handler: listening on port 22100
s413:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300648
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 36930
received auth hello!
{ authId: 403, nonce: <Buffer 99 97 64 02 6c e7 1e 21> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer b6 74 e0 06 9b 16 fa cc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 5c 97 48 64 42 e0 d3 e2 e0 04 de 91 d6 b4 c0 9a>,
  macKeyVal: <Buffer 4d 3e 74 1b 6c e5 ae 24 5e 5c ac ce aa a5 58 ac 73 de 20 62 4d 15 01 b0 7b d5 a4 f0 fc 50 5e b1>,
  absValidity: 2018-03-21T08:18:52.125Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e2 79 3d e8 00 4b d9 2d>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e2 79 3d e8 00 4b d9 2d> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.58:43790',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300654
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37134
received auth hello!
{ authId: 403, nonce: <Buffer 6a b3 72 9d e2 b7 ac e7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 96 d1 33 bc 4d 73 cd 1e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 22 db ee 33 be f6 c9 60>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 22 db ee 33 be f6 c9 60> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.58:43994',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300660
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37406
received auth hello!
{ authId: 403, nonce: <Buffer 74 a1 54 c7 cd 23 82 7c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 63 44 fb 19 cb 15 c6 6d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bd e8 c3 8c d0 30 79 5a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bd e8 c3 8c d0 30 79 5a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.58:44266',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300666
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37676
received auth hello!
{ authId: 403, nonce: <Buffer f4 c6 bf 27 e5 8c fa 42> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2d aa 66 37 b4 3c 8d 30>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 89 d5 c6 82 ad 90 26 55>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 89 d5 c6 82 ad 90 26 55> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.58:44536',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300672
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 37946
received auth hello!
{ authId: 403, nonce: <Buffer 34 47 db f4 e1 cf 9e 1e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ff 5e b3 12 6a 37 bb 3e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bc ca ad 20 33 cd 44 a7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bc ca ad 20 33 cd 44 a7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.58:44806',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300678
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38216
received auth hello!
{ authId: 403, nonce: <Buffer f8 0c 50 e0 3b a4 ab 88> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b6 d3 f3 fb c4 08 84 0b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bc 88 1f d9 86 f9 5a a6>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bc 88 1f d9 86 f9 5a a6> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.58:45076',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300684
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38486
received auth hello!
{ authId: 403, nonce: <Buffer a2 dc 25 5b b9 03 af d3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 14 78 0d ff a9 f2 e4 27>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 02 1c aa 9c 3e 30 a5 81>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 02 1c aa 9c 3e 30 a5 81> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.58:45346',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300690
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 38748
received auth hello!
{ authId: 403, nonce: <Buffer 95 c3 f2 4d 5d 77 0f 0a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f6 38 f2 7e 6f ca 39 61>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 58 b5 cf b7 be bd af 2e>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 58 b5 cf b7 be bd af 2e> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.58:45608',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
