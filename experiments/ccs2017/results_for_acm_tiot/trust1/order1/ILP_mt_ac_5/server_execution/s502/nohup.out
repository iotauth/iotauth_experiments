changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s502.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's502',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 70 71 ... > }
Handler: listening on port 22100
s502:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100595
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42146
received auth hello!
{ authId: 501, nonce: <Buffer a2 5b b5 86 87 02 a0 21> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer a2 1b bf 35 3b 9e 88 ba>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 3e f6 7f 7b 5d 03 61 83 86 6c 2e 27 34 20 d3 59>,
  macKeyVal: <Buffer a9 35 cc b3 ee 0c cb 53 26 e5 6c 26 e6 88 78 1d 50 c2 bb 1c 3d 6f 83 c2 c1 ef 1c ae 31 ca 11 a8>,
  absValidity: 2018-03-21T08:19:08.427Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer aa 90 25 30 31 5b cd ca>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer aa 90 25 30 31 5b cd ca> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.63:56482',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100603
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42382
received auth hello!
{ authId: 501, nonce: <Buffer e3 c0 00 36 14 e2 02 52> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer df 0c d7 fb 77 81 51 bb>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a1 92 8b c2 73 1d e4 3a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a1 92 8b c2 73 1d e4 3a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.63:56718',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100611
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42652
received auth hello!
{ authId: 501, nonce: <Buffer 56 aa 5e 71 85 af 25 b7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ed ef 79 3d da 4b 56 fc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e8 ae 99 84 c9 41 2c 25>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e8 ae 99 84 c9 41 2c 25> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.63:56988',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100619
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 42922
received auth hello!
{ authId: 501, nonce: <Buffer a2 de 40 69 e7 7f 41 ac> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3e 49 3b 19 fb 04 b0 72>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c3 05 28 ed 10 13 73 ae>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c3 05 28 ed 10 13 73 ae> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.63:57258',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100627
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43192
received auth hello!
{ authId: 501, nonce: <Buffer 26 5a 53 86 8d ed 90 bf> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9a 4b a7 08 b9 db 25 ef>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c2 1f c5 c8 16 35 f0 82>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer c2 1f c5 c8 16 35 f0 82> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.63:57528',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100635
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43462
received auth hello!
{ authId: 501, nonce: <Buffer 2a 60 2d 55 56 06 17 0d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fd 55 e0 2b ba ed f2 7c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b0 23 69 0f bf 93 12 dc>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b0 23 69 0f bf 93 12 dc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.63:57798',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 50100643
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 43732
received auth hello!
{ authId: 501, nonce: <Buffer e1 fb b2 85 7d 9b a4 34> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d1 88 90 83 21 20 f3 c0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 70 96 f3 9c b1 2b de 4c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 70 96 f3 9c b1 2b de 4c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.63:58068',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
