changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s416.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's416',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 51 49 42 41 41 4b 43 41 51 45 41 35 7a ... > }
Handler: listening on port 22100
s416:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300650
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46614
received auth hello!
{ authId: 403, nonce: <Buffer 8b 74 9f ad a2 f3 ff 55> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer b1 71 53 06 2c bb 12 1d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 70 65 89 f0 e8 78 fa 3d ea bb 06 54 79 4d 82 60>,
  macKeyVal: <Buffer 8e 17 2b 00 b8 66 85 a2 af e3 2b 8f 2a 35 38 fa 19 43 48 2e 75 a4 0e 86 06 4e 4e b3 62 31 89 33>,
  absValidity: 2018-03-21T08:19:00.072Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8f 72 ab ed fc a3 65 bf>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8f 72 ab ed fc a3 65 bf> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.60:50346',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300651
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46620
received auth hello!
{ authId: 403, nonce: <Buffer 3a c1 ee 2b 2b f2 8f 6c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 16 39 39 57 a1 68 b4 79>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9c 28 d6 a8 97 be 22 72>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9c 28 d6 a8 97 be 22 72> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.61:44676',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300656
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46826
received auth hello!
{ authId: 403, nonce: <Buffer 23 1a 36 20 b1 ff bc b1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2f 01 63 73 c4 30 43 fd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e4 bf 94 bb a5 61 91 bb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e4 bf 94 bb a5 61 91 bb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.60:50558',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300657
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 46842
received auth hello!
{ authId: 403, nonce: <Buffer fb e1 81 b9 d3 6a 9e 6c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7b e4 52 14 f8 88 d2 d8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bf b6 02 3b 5a 4e 29 77>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bf b6 02 3b 5a 4e 29 77> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.61:44898',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300662
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47098
received auth hello!
{ authId: 403, nonce: <Buffer 3f 1f d9 bb 0e fa 1c 5d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer da ed 60 51 16 e0 a2 65>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f1 10 b6 60 8c 57 23 52>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer f1 10 b6 60 8c 57 23 52> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.60:50830',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300663
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47114
received auth hello!
{ authId: 403, nonce: <Buffer 2c 1c f8 9b 1a 28 36 4c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 50 86 f2 88 d9 60 0b cc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 99 77 a5 b2 02 1c 7f 7f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 99 77 a5 b2 02 1c 7f 7f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.61:45170',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300668
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47368
received auth hello!
{ authId: 403, nonce: <Buffer 99 82 56 4a 70 8f 1a 92> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 12 3d db f5 f1 e4 20 bc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 92 5a 1b a2 37 ae 7f 5c>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 92 5a 1b a2 37 ae 7f 5c> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.60:51100',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300669
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47384
received auth hello!
{ authId: 403, nonce: <Buffer 40 c9 5e d3 9a e5 23 9a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 80 58 7a 5f 41 f3 88 97>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 56 3d f3 9d 4a fe 4c 8b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 56 3d f3 9d 4a fe 4c 8b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.61:45440',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300674
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47638
received auth hello!
{ authId: 403, nonce: <Buffer da 7c 64 90 61 42 0a 11> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 27 69 9f c5 94 81 20 77>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer f4 53 20 87 ed ed 76 0a>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer f4 53 20 87 ed ed 76 0a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.60:51370',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300675
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47654
received auth hello!
{ authId: 403, nonce: <Buffer 85 9b a8 2a c8 bc 56 7d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bd 0f 3b 12 2a 30 c7 7e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9f d9 50 6b 38 89 42 4b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 9f d9 50 6b 38 89 42 4b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.61:45710',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300680
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47908
received auth hello!
{ authId: 403, nonce: <Buffer 9d 4f 51 16 c7 22 e3 28> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer aa 49 9f 0e e8 c2 f4 69>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d0 b0 61 ee 04 5a 29 20>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer d0 b0 61 ee 04 5a 29 20> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.60:51640',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300681
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 47924
received auth hello!
{ authId: 403, nonce: <Buffer e3 06 37 fb 55 10 f3 37> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 12 73 fb cf af 21 96 67>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 83 dc fd 4c f5 b6 22 4a>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 83 dc fd 4c f5 b6 22 4a> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.61:45980',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300686
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48178
received auth hello!
{ authId: 403, nonce: <Buffer 63 4c a7 7b 99 76 27 be> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fc 9d 1f 0f e9 b4 06 f3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6b 75 f9 b1 52 08 73 bc>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 6b 75 f9 b1 52 08 73 bc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.60:51910',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300687
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48194
received auth hello!
{ authId: 403, nonce: <Buffer 27 3a 01 56 de 26 dc 68> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer da 7a 13 ce c6 f2 ef 2f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 53 1f aa 18 77 f0 a1 b8>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 53 1f aa 18 77 f0 a1 b8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.61:46250',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300692
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48440
received auth hello!
{ authId: 403, nonce: <Buffer 37 f7 c0 48 fb 3e 7a 7f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 49 88 5b f1 43 e2 a3 29>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer b0 27 29 e8 07 44 4a 8b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer b0 27 29 e8 07 44 4a 8b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.60:52172',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300693
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 48456
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
