changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c507.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c507',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 72 52 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521600283967
connected to auth! from local port 48130
received auth hello!
{ authId: 501, nonce: <Buffer 2f df 03 7d 8e d4 b0 3b> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer e8 4a c4 d0 95 ff 01 15>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 8f 82 8f 1a 09 60 d2 f3 a8 5c 9e 7a 66 4a 01 af>,
  macKeyVal: <Buffer 8a 1b f1 7c 86 94 ed b0 09 15 ea 7e 5d 83 3e a2 e3 05 78 5f f4 76 6d b0 22 14 19 e2 dd 25 dd f5>,
  absValidity: 2018-03-21T03:44:44.145Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100591,
  cipherKeyVal: <Buffer 1f 37 bb 67 2a 55 d4 7f 9a 32 60 6a 55 83 a3 a7>,
  macKeyVal: <Buffer 5a 34 57 41 4c d7 fe 8d 07 f9 b5 55 b2 49 fe 40 2c 6d 60 55 3f e2 b8 c2 b1 e7 8c d1 c6 47 d5 32>,
  absValidity: 2018-03-22T02:44:44.145Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100591,
     cipherKeyVal: <Buffer 1f 37 bb 67 2a 55 d4 7f 9a 32 60 6a 55 83 a3 a7>,
     macKeyVal: <Buffer 5a 34 57 41 4c d7 fe 8d 07 f9 b5 55 b2 49 fe 40 2c 6d 60 55 3f e2 b8 c2 b1 e7 8c d1 c6 47 d5 32>,
     absValidity: 2018-03-22T02:44:44.145Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 45 df cf 97 39 38 20 c1>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:44:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521600285024
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521600344026
connected to auth! from local port 48390
received auth hello!
{ authId: 501, nonce: <Buffer 15 9e fd e0 75 40 b3 e1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d4 a4 7f fa cb d1 23 07>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100599,
  cipherKeyVal: <Buffer d2 7b 96 f3 bd 90 d1 fb f6 2a 7b 19 5d fe ad c6>,
  macKeyVal: <Buffer df 70 34 42 88 de d3 cf b2 12 ef 08 98 d7 37 7b d0 fe 5b 70 d9 75 dd bd 8b 64 d8 af 37 e0 1e ec>,
  absValidity: 2018-03-22T02:45:44.227Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100599,
     cipherKeyVal: <Buffer d2 7b 96 f3 bd 90 d1 fb f6 2a 7b 19 5d fe ad c6>,
     macKeyVal: <Buffer df 70 34 42 88 de d3 cf b2 12 ef 08 98 d7 37 7b d0 fe 5b 70 d9 75 dd bd 8b 64 d8 af 37 e0 1e ec>,
     absValidity: 2018-03-22T02:45:44.227Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer a7 2b 9e bd 4e a9 7e 7d>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:45:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521600345041
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521600404085
connected to auth! from local port 48660
received auth hello!
{ authId: 501, nonce: <Buffer b5 dd f8 07 d2 b5 1c 11> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a4 c8 ba 89 d0 99 4f 88>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100607,
  cipherKeyVal: <Buffer d3 40 7e c6 0b c3 78 2d b1 07 11 69 ef 1a ce d3>,
  macKeyVal: <Buffer 71 56 b7 e0 5e 90 56 3c 99 b9 f7 fb ab 28 f0 7b 2f 9c 3f a0 c0 3f c0 a9 df 17 6e 9a 00 32 0b eb>,
  absValidity: 2018-03-22T02:46:44.290Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100607,
     cipherKeyVal: <Buffer d3 40 7e c6 0b c3 78 2d b1 07 11 69 ef 1a ce d3>,
     macKeyVal: <Buffer 71 56 b7 e0 5e 90 56 3c 99 b9 f7 fb ab 28 f0 7b 2f 9c 3f a0 c0 3f c0 a9 df 17 6e 9a 00 32 0b eb>,
     absValidity: 2018-03-22T02:46:44.290Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer e2 fe 5e 0e 72 95 8d e8>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:46:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521600405135
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521600464141
connected to auth! from local port 48930
received auth hello!
{ authId: 501, nonce: <Buffer 85 38 2d 7b 3a 46 29 88> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 49 77 4f cc 50 66 82 2a>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100615,
  cipherKeyVal: <Buffer 2a 99 f6 fa 21 af fd 63 9d 3d 75 f5 ea b5 72 e5>,
  macKeyVal: <Buffer 0d f7 6f e7 ad 3a 67 64 fb 13 ab 38 56 57 19 f1 79 b4 b9 f6 73 78 45 6b cc c2 04 c6 bc 3a ca 91>,
  absValidity: 2018-03-22T02:47:44.301Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100615,
     cipherKeyVal: <Buffer 2a 99 f6 fa 21 af fd 63 9d 3d 75 f5 ea b5 72 e5>,
     macKeyVal: <Buffer 0d f7 6f e7 ad 3a 67 64 fb 13 ab 38 56 57 19 f1 79 b4 b9 f6 73 78 45 6b cc c2 04 c6 bc 3a ca 91>,
     absValidity: 2018-03-22T02:47:44.301Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer df f7 4e 64 24 ff c5 1e>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:47:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521600465138
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521600524171
connected to auth! from local port 49200
received auth hello!
{ authId: 501, nonce: <Buffer 45 23 38 e3 5b d3 fb fe> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5a 5c 9b 9c 0c 32 56 a5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100623,
  cipherKeyVal: <Buffer f8 54 30 9a b8 02 86 8b 2f b5 5a df cd 24 eb e2>,
  macKeyVal: <Buffer d8 39 35 83 cc 49 e8 c0 b9 b3 b0 6d 33 72 5e 51 d0 c0 38 7b a3 20 be 4e 6b 9a b2 3a 85 cd 91 ca>,
  absValidity: 2018-03-22T02:48:44.339Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100623,
     cipherKeyVal: <Buffer f8 54 30 9a b8 02 86 8b 2f b5 5a df cd 24 eb e2>,
     macKeyVal: <Buffer d8 39 35 83 cc 49 e8 c0 b9 b3 b0 6d 33 72 5e 51 d0 c0 38 7b a3 20 be 4e 6b 9a b2 3a 85 cd 91 ca>,
     absValidity: 2018-03-22T02:48:44.339Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer b7 2f c5 2a bc 02 6d 05>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:48:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521600525172
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521600584229
connected to auth! from local port 49470
received auth hello!
{ authId: 501, nonce: <Buffer 4d 18 59 e2 a3 6d b9 25> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4b 2b c0 7b d2 89 29 61>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100631,
  cipherKeyVal: <Buffer af 9b da be 42 23 c9 60 15 63 65 b9 01 7f 0a 6c>,
  macKeyVal: <Buffer 7b 6f 87 05 de 72 93 5d 7f 37 b8 9a 99 f5 f6 a8 82 08 c3 85 95 50 73 75 6e dc c6 fe fe 43 07 54>,
  absValidity: 2018-03-22T02:49:44.418Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100631,
     cipherKeyVal: <Buffer af 9b da be 42 23 c9 60 15 63 65 b9 01 7f 0a 6c>,
     macKeyVal: <Buffer 7b 6f 87 05 de 72 93 5d 7f 37 b8 9a 99 f5 f6 a8 82 08 c3 85 95 50 73 75 6e dc c6 fe fe 43 07 54>,
     absValidity: 2018-03-22T02:49:44.418Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer fe ab ad 36 4b 5a 62 3b>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:49:44 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521600585291
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521600644285
connected to auth! from local port 49740
received auth hello!
{ authId: 501, nonce: <Buffer 44 b1 bd 6f ba 1c 4a 68> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6f 04 06 1d c3 1e ef 9b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100639,
  cipherKeyVal: <Buffer 95 e6 c3 06 74 22 30 c2 40 04 a2 b3 94 79 70 25>,
  macKeyVal: <Buffer e3 23 19 0e a7 e5 7f 8e ac 9e d6 53 2a 68 e0 05 97 0e 44 44 42 96 af 56 fa c1 94 d4 85 57 33 dd>,
  absValidity: 2018-03-22T02:50:44.460Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50100639,
     cipherKeyVal: <Buffer 95 e6 c3 06 74 22 30 c2 40 04 a2 b3 94 79 70 25>,
     macKeyVal: <Buffer e3 23 19 0e a7 e5 7f 8e ac 9e d6 53 2a 68 e0 05 97 0e 44 44 42 96 af 56 fa c1 94 d4 85 57 33 dd>,
     absValidity: 2018-03-22T02:50:44.460Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 26 23 24 06 c1 10 0d 94>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:50:45 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521600645375
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521600704345
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 9 0.7777777777777778 1521600764354
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 60610
received auth hello!
{ authId: 502, nonce: <Buffer 50 3b af 1b c3 6f b3 a7> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '0162466F8372',
  notBefore: 2018-03-21T02:40:36.000Z,
  notAfter: 2018-03-22T02:42:16.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '29:ED:05:45:15:50:28:59:A5:C0:F9:42:2E:AD:E7:28:C7:6B:25:EB',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'FF6CB5202497CC77AF28EFDE774858E4FEF04355E5228E378962DF4235BE3683DAF9E38A7E22621D66B3B50166D897E97BF911F9E8FC09D686961AA39679014E5DDD27EA0F02DE853A41537DB5E37F33395E249F355C0D074419572E9856D1D598CAB2CD6951013DDCB0A163B943DFCD2694BE18B9B3892695B3052EBD9115D447293C83AF24A008794B842E4F0A6C2A8D0189612A600AA40A592603E43713C0ECCA681024E5EC429FAD09484B824919DF59C8BD488E0D372D2A3D8B99B6068E24BBBDA8F0BCDDBA806010E4A7181736DF08D4D1CFC16E26507C360EDCBFF1B5F4288CE304DE62E9696665C5108489AD7232658356998FF47C4F7E8A04225423',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJGb4NyMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDMy\nMTAyNDAzNloXDTE4MDMyMjAyNDIxNlowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQD/bLUgJJfMd68o7953SFjk/vBDVeUijjeJYt9CNb42g9r544p+\nImIdZrO1AWbYl+l7+RH56PwJ1oaWGqOWeQFOXd0n6g8C3oU6QVN9teN/MzleJJ81\nXA0HRBlXLphW0dWYyrLNaVEBPdywoWO5Q9/NJpS+GLmziSaVswUuvZEV1EcpPIOv\nJKAIeUuELk8KbCqNAYlhKmAKpApZJgPkNxPA7MpoECTl7EKfrQlIS4JJGd9ZyL1I\njg03LSo9i5m2Bo4ku72o8LzduoBgEOSnGBc23wjU0c/BbiZQfDYO3L/xtfQojOME\n3mLpaWZlxRCEia1yMmWDVpmP9HxPfooEIlQjAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAErSFb7CNHdUHd6eo+jnskonG8InEjSC\nWqzUL01wak2HI0/5sPRn68+M10ln3DHUil/zzv9fQf715sJBUpExKd/gauDTZhOT\nL7fBiBOc2ultexplJcP3H33+3DT47tzNfZc+khFnnuFsVkuwLC3FryTqnCHo0Px6\nvRRCROat+aIYlHmYEskLZQ/PULT8NBxlbcv05fZIZ88vWxvlb/0io6CsqvfZHE6S\nAI7hIupgLEIzkHCTETAO3oD3KpFkAKUEcbr/FN3MRFmJZQhlgQ9pOprlVQxldyPp\nRgMqzGh7j7eMtT0ry6LZQ38SlOygA6Ggy9atcAcU51YbXtHqLAdX9aA=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 0
to: 1
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 10 0.7 1521600824365
connected to auth! from local port 60806
received auth hello!
{ authId: 502, nonce: <Buffer 05 14 3a d7 8b ac 39 7e> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 7a 56 f7 09 fa 8f 01 5b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 4f 27 df c9 5d 4e 84 22 9a 0a d9 81 1f dc 1b 86>,
  macKeyVal: <Buffer f6 49 00 c0 cd b9 94 a6 87 37 8a 94 9c fb e5 4a 6b 7e 06 99 92 46 e4 3c 89 cb 1d 32 8e d1 9f a4>,
  absValidity: 2018-03-21T03:53:44.769Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201089,
  cipherKeyVal: <Buffer 1d ea c2 52 fa 2c 11 c3 a6 47 36 59 5f c6 22 f3>,
  macKeyVal: <Buffer 60 12 7f 31 69 a9 a4 d8 0b 6b 47 0e 18 99 e4 af 5b 4c f4 e1 34 f9 70 9e 99 36 47 28 0e 83 12 1b>,
  absValidity: 2018-03-22T02:53:44.769Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50201089,
     cipherKeyVal: <Buffer 1d ea c2 52 fa 2c 11 c3 a6 47 36 59 5f c6 22 f3>,
     macKeyVal: <Buffer 60 12 7f 31 69 a9 a4 d8 0b 6b 47 0e 18 99 e4 af 5b 4c f4 e1 34 f9 70 9e 99 36 47 28 0e 83 12 1b>,
     absValidity: 2018-03-22T02:53:44.769Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer a2 e3 f7 56 5b fb 94 61>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.28:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 11 0.6363636363636364 1521600884374
connected to auth! from local port 32800
received auth hello!
{ authId: 502, nonce: <Buffer 68 26 c4 b5 29 26 58 27> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 62 1e fb bd 94 32 63 84>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201104,
  cipherKeyVal: <Buffer bb 86 85 e3 4c 2f 27 6c 85 09 29 3d 1b 59 ff a5>,
  macKeyVal: <Buffer 9d 13 b8 88 00 d2 3b 13 d3 aa 10 d5 8d 30 82 48 43 74 af c7 9a ea e6 c4 93 92 da 1a 1a b1 58 9a>,
  absValidity: 2018-03-22T02:54:48.053Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50201104,
     cipherKeyVal: <Buffer bb 86 85 e3 4c 2f 27 6c 85 09 29 3d 1b 59 ff a5>,
     macKeyVal: <Buffer 9d 13 b8 88 00 d2 3b 13 d3 aa 10 d5 8d 30 82 48 43 74 af c7 9a ea e6 c4 93 92 da 1a 1a b1 58 9a>,
     absValidity: 2018-03-22T02:54:48.053Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 8a 88 24 19 4f 69 de d5>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.28:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 12 0.5833333333333334 1521600944381
connected to auth! from local port 33004
received auth hello!
{ authId: 502, nonce: <Buffer b5 b9 8d d7 8f e5 81 aa> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f2 09 c1 c4 41 97 92 a7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201117,
  cipherKeyVal: <Buffer 13 75 4f 9a 9c 81 ab c3 31 3f 33 81 f6 67 26 ff>,
  macKeyVal: <Buffer 69 25 81 d0 72 23 0b 0c 3a c6 ce 18 02 5d 04 8c fa eb 54 15 60 b6 ea 8c 0b 64 72 9e f3 5b 26 2f>,
  absValidity: 2018-03-22T02:55:48.094Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50201117,
     cipherKeyVal: <Buffer 13 75 4f 9a 9c 81 ab c3 31 3f 33 81 f6 67 26 ff>,
     macKeyVal: <Buffer 69 25 81 d0 72 23 0b 0c 3a c6 ce 18 02 5d 04 8c fa eb 54 15 60 b6 ea 8c 0b 64 72 9e f3 5b 26 2f>,
     absValidity: 2018-03-22T02:55:48.094Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 30 f4 83 0e 93 68 28 b5>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.28:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 13 0.5384615384615384 1521601004387
connected to auth! from local port 33218
received auth hello!
{ authId: 502, nonce: <Buffer 13 7f 11 a4 23 c0 98 70> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8a 33 44 4c 2b 68 91 d2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201135,
  cipherKeyVal: <Buffer 5e 23 df 9a 3f d3 53 10 cd ce eb 90 c3 89 f6 81>,
  macKeyVal: <Buffer c8 74 12 24 90 16 65 fa a7 90 c6 e6 6b 5d 7c bd 80 91 fd a0 af 38 9f 07 e4 22 0e 14 14 37 79 a7>,
  absValidity: 2018-03-22T02:56:52.085Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50201135,
     cipherKeyVal: <Buffer 5e 23 df 9a 3f d3 53 10 cd ce eb 90 c3 89 f6 81>,
     macKeyVal: <Buffer c8 74 12 24 90 16 65 fa a7 90 c6 e6 6b 5d 7c bd 80 91 fd a0 af 38 9f 07 e4 22 0e 14 14 37 79 a7>,
     absValidity: 2018-03-22T02:56:52.085Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 31 78 81 a2 37 c5 11 8d>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.28:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 14 0.5 1521601064389
connected to auth! from local port 33418
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 15 0.4666666666666667 1521601124396
connected to auth! from local port 33602
received auth hello!
{ authId: 502, nonce: <Buffer 6b cb ee fa 17 47 cc be> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 99 ff 8c cb e6 9e 19 8f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201166,
  cipherKeyVal: <Buffer 11 0d d0 92 fc c7 0e 07 88 6c d9 9c b5 dd 9d 06>,
  macKeyVal: <Buffer b3 09 6b 10 e9 29 ba 9d 39 a9 78 42 5a ae a3 ec fe d7 12 48 70 9c fd 01 3d 19 3a 07 48 c6 16 a9>,
  absValidity: 2018-03-22T02:59:04.078Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50201166,
     cipherKeyVal: <Buffer 11 0d d0 92 fc c7 0e 07 88 6c d9 9c b5 dd 9d 06>,
     macKeyVal: <Buffer b3 09 6b 10 e9 29 ba 9d 39 a9 78 42 5a ae a3 ec fe d7 12 48 70 9c fd 01 3d 19 3a 07 48 c6 16 a9>,
     absValidity: 2018-03-22T02:59:04.078Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 32 3c 32 b6 15 e7 32 a0>
switching to HANDSHAKE_1_SENT
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 16 0.4375 1521601184425
connected to auth! from local port 33796
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.28:undefined
Handler: Error in secure comm - details: Auth hello timedout ...
received auth hello!
{ authId: 502, nonce: <Buffer 6c 14 19 25 ab 83 8c 31> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: write after end
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 17 0.4117647058823529 1521601244429
connected to auth! from local port 33970
disconnected from auth
received auth hello!
{ authId: 502, nonce: <Buffer 60 26 75 2d d7 d6 32 96> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 41 90 eb 7e 02 8a 8d 96>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201191,
  cipherKeyVal: <Buffer 52 be 5d ac 2a 5d 19 ce 16 67 da 09 d3 8f de 9c>,
  macKeyVal: <Buffer 1d 09 16 fd 3a ee 71 16 5d 5c f2 40 23 d9 99 12 d1 e8 5a 58 2a c1 d4 08 91 2c 19 8e ad a9 c2 54>,
  absValidity: 2018-03-22T03:01:04.082Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50201191,
     cipherKeyVal: <Buffer 52 be 5d ac 2a 5d 19 ce 16 67 da 09 d3 8f de 9c>,
     macKeyVal: <Buffer 1d 09 16 fd 3a ee 71 16 5d 5c f2 40 23 d9 99 12 d1 e8 5a 58 2a c1 d4 08 91 2c 19 8e ad a9 c2 54>,
     absValidity: 2018-03-22T03:01:04.082Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 31 c8 39 83 b5 8a 0e 59>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Connection with Auth timed out...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 18 0.3888888888888889 1521601304444
connected to auth! from local port 34146
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.28:undefined
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 19 0.3684210526315789 1521601364455
connected to auth! from local port 34326
received auth hello!
{ authId: 502, nonce: <Buffer 79 48 37 80 1d e3 c1 3b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 7c df 91 be 2f 51 07 3d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201219,
  cipherKeyVal: <Buffer db f8 3b b2 39 82 72 45 12 14 45 1f 45 54 95 e2>,
  macKeyVal: <Buffer 60 46 bd 7c 74 c3 3b 96 43 55 f1 42 f5 7f 5c 83 db b0 d5 ab 87 21 95 3a ed 8c 9e 1d f7 83 ac ce>,
  absValidity: 2018-03-22T03:03:16.314Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50201219,
     cipherKeyVal: <Buffer db f8 3b b2 39 82 72 45 12 14 45 1f 45 54 95 e2>,
     macKeyVal: <Buffer 60 46 bd 7c 74 c3 3b 96 43 55 f1 42 f5 7f 5c 83 db b0 d5 ab 87 21 95 3a ed 8c 9e 1d f7 83 ac ce>,
     absValidity: 2018-03-22T03:03:16.314Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer e7 a3 66 d7 d9 1c ee d3>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:03:20 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 19 0.42105263157894735 1521601400768
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 20 0.4 1521601424472
connected to auth! from local port 34496
received auth hello!
{ authId: 502, nonce: <Buffer 17 1b 52 fa ec e5 c7 dd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c0 b7 54 71 eb 6f dc 44>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201231,
  cipherKeyVal: <Buffer ee 53 a0 c3 f4 94 73 3f 37 ae 92 14 85 d0 ab f5>,
  macKeyVal: <Buffer 6d 19 76 f5 1b 83 5a 95 1f 17 54 8b 73 31 9a 37 e1 23 fa 8b 9a d3 df e9 79 27 1b 7e 85 d3 59 61>,
  absValidity: 2018-03-22T03:04:12.322Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50201231,
     cipherKeyVal: <Buffer ee 53 a0 c3 f4 94 73 3f 37 ae 92 14 85 d0 ab f5>,
     macKeyVal: <Buffer 6d 19 76 f5 1b 83 5a 95 1f 17 54 8b 73 31 9a 37 e1 23 fa 8b 9a d3 df e9 79 27 1b 7e 85 d3 59 61>,
     absValidity: 2018-03-22T03:04:12.322Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 31 37 86 af 22 f7 6d 98>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 03:04:16 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 9 20 0.45 1521601456693
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 21 0.42857142857142855 1521601484497
connected to auth! from local port 34670
received auth hello!
{ authId: 502, nonce: <Buffer 93 21 39 3e 03 36 e9 9b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ca 4d b0 2a ff 24 81 e7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201241,
  cipherKeyVal: <Buffer 0d 89 16 8e e6 0f dd 2f 3f 62 f5 f5 e3 a4 ab 88>,
  macKeyVal: <Buffer 61 e2 95 a5 ec 15 98 43 4f 62 54 5f 81 36 8b 81 c0 ef 04 7a 46 8c b5 5c 5e fc 61 04 77 e8 37 02>,
  absValidity: 2018-03-22T03:05:04.299Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50201241,
     cipherKeyVal: <Buffer 0d 89 16 8e e6 0f dd 2f 3f 62 f5 f5 e3 a4 ab 88>,
     macKeyVal: <Buffer 61 e2 95 a5 ec 15 98 43 4f 62 54 5f 81 36 8b 81 c0 ef 04 7a 46 8c b5 5c 5e fc 61 04 77 e8 37 02>,
     absValidity: 2018-03-22T03:05:04.299Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer dd fc 9e ea 24 a8 2b 75>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received auth hello!
{ authId: 502, nonce: <Buffer 6f 1c 2a ba a0 dc c9 86> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: write after end
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.28:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 22 0.4090909090909091 1521601544510
connected to auth! from local port 34840
disconnected from auth
received auth hello!
{ authId: 502, nonce: <Buffer a0 9a 47 99 11 38 cf 10> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 60 e7 b6 17 19 79 19 93>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201251,
  cipherKeyVal: <Buffer d5 b9 b5 86 41 57 ee ba 54 c0 30 38 4b 00 22 ca>,
  macKeyVal: <Buffer b5 f6 d8 c1 89 8d 85 d6 91 1c b9 c3 04 25 44 a2 64 a9 68 0a 8f 7f f0 4c da a1 aa c6 9e 6e e0 28>,
  absValidity: 2018-03-22T03:05:48.319Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50201251,
     cipherKeyVal: <Buffer d5 b9 b5 86 41 57 ee ba 54 c0 30 38 4b 00 22 ca>,
     macKeyVal: <Buffer b5 f6 d8 c1 89 8d 85 d6 91 1c b9 c3 04 25 44 a2 64 a9 68 0a 8f 7f f0 4c da a1 aa c6 9e 6e e0 28>,
     absValidity: 2018-03-22T03:05:48.319Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Connection with Auth timed out...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 23 0.391304347826087 1521601604538
connected to auth! from local port 35000
received auth hello!
{ authId: 502, nonce: <Buffer fb 2d 09 13 23 2d 35 ce> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 84 14 ca 21 ba fa 95 e5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201265,
  cipherKeyVal: <Buffer cb a4 6a 40 9c 91 4f 47 23 0e 08 75 da 7f bc 53>,
  macKeyVal: <Buffer b5 28 59 c9 5c e2 6a 95 b4 2a c3 4b 80 e6 93 a0 e0 62 8b 14 bd 1c 15 2a d6 f0 3a 8e 46 7d dd f4>,
  absValidity: 2018-03-22T03:06:48.318Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50201265,
     cipherKeyVal: <Buffer cb a4 6a 40 9c 91 4f 47 23 0e 08 75 da 7f bc 53>,
     macKeyVal: <Buffer b5 28 59 c9 5c e2 6a 95 b4 2a c3 4b 80 e6 93 a0 e0 62 8b 14 bd 1c 15 2a d6 f0 3a 8e 46 7d dd f4>,
     absValidity: 2018-03-22T03:06:48.318Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 24 0.375 1521601664594
connected to auth! from local port 35164
received auth hello!
{ authId: 502, nonce: <Buffer 29 6e d5 a3 7a 1c bc e3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer cf c2 74 b4 fe ed 9c 00>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201280,
  cipherKeyVal: <Buffer 16 78 7a a3 ee b7 57 30 7d 7f 13 bb 7c 5a c1 c1>,
  macKeyVal: <Buffer 66 38 ed 7e 8d 32 d9 a3 74 56 aa 72 d6 96 77 1a d1 ff c2 ae c9 b1 fc 2b 77 f0 a2 af 76 67 c4 3d>,
  absValidity: 2018-03-22T03:07:48.323Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50201280,
     cipherKeyVal: <Buffer 16 78 7a a3 ee b7 57 30 7d 7f 13 bb 7c 5a c1 c1>,
     macKeyVal: <Buffer 66 38 ed 7e 8d 32 d9 a3 74 56 aa 72 d6 96 77 1a d1 ff c2 ae c9 b1 fc 2b 77 f0 a2 af 76 67 c4 3d>,
     absValidity: 2018-03-22T03:07:48.323Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
disconnected from auth
received auth hello!
{ authId: 502, nonce: <Buffer e9 b3 c7 f3 9a c1 cf ae> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: write after end
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 25 0.36 1521601724607
connected to auth! from local port 35320
received auth hello!
{ authId: 502, nonce: <Buffer f3 0f 57 71 8c b8 0b 64> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1c 86 09 9b 2a 02 f6 8b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201293,
  cipherKeyVal: <Buffer d1 07 fb 8f 2a 34 7b 90 64 35 19 54 d3 1c f3 22>,
  macKeyVal: <Buffer 62 3a c4 a3 43 e8 99 4a d7 79 9b da f5 00 f7 75 0b 06 32 b5 93 8c e7 04 6d f8 88 d1 25 9b aa 6b>,
  absValidity: 2018-03-22T03:08:48.325Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50201293,
     cipherKeyVal: <Buffer d1 07 fb 8f 2a 34 7b 90 64 35 19 54 d3 1c f3 22>,
     macKeyVal: <Buffer 62 3a c4 a3 43 e8 99 4a d7 79 9b da f5 00 f7 75 0b 06 32 b5 93 8c e7 04 6d f8 88 d1 25 9b aa 6b>,
     absValidity: 2018-03-22T03:08:48.325Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
Handler: Error in secure comm - details: Connection with Auth timed out...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 26 0.34615384615384615 1521601784620
connected to auth! from local port 35490
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 27 0.3333333333333333 1521601844631
connected to auth! from local port 35638
received auth hello!
{ authId: 502, nonce: <Buffer aa 31 9a a0 27 09 75 c3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 08 03 66 fc f2 3a 14 ce>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201318,
  cipherKeyVal: <Buffer cb 50 ab c0 08 98 cb b2 bd 15 8a 3a 19 56 18 07>,
  macKeyVal: <Buffer f0 a4 ef db be d0 2f ab 3b 76 7d e6 dd 01 dc 94 c2 3e b8 9f a4 e3 e2 37 f2 71 88 6f 55 96 1f 5b>,
  absValidity: 2018-03-22T03:11:00.332Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.28',
  serverPort: 22100,
  sessionKey: 
   { id: 50201318,
     cipherKeyVal: <Buffer cb 50 ab c0 08 98 cb b2 bd 15 8a 3a 19 56 18 07>,
     macKeyVal: <Buffer f0 a4 ef db be d0 2f ab 3b 76 7d e6 dd 01 dc 94 c2 3e b8 9f a4 e3 e2 37 f2 71 88 6f 55 96 1f 5b>,
     absValidity: 2018-03-22T03:11:00.332Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.28:22100
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 9 28 0.32142857142857145 1521601904673
connected to auth! from local port 35816
