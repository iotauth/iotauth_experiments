changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c501.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c501',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 70 76 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521600264282
connected to auth! from local port 51918
received auth hello!
{ authId: 501, nonce: <Buffer 10 35 cb 95 f1 14 00 4b> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer b4 47 69 f5 d6 3f 3a f2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 92 57 fb 48 52 e2 68 dd f2 0d a3 94 21 34 04 55>,
  macKeyVal: <Buffer 4a 62 49 fd 5c 92 34 97 5f 78 56 ce d4 59 5a 2d 04 5e f1 bb 82 e3 58 46 02 2d 10 de 59 64 f9 54>,
  absValidity: 2018-03-21T03:44:24.526Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100587,
  cipherKeyVal: <Buffer 7a 72 4c 9a f8 5c a4 5f b4 07 16 4b 6b 18 82 11>,
  macKeyVal: <Buffer 32 79 37 8d 58 cc b9 f4 73 c6 e3 58 1e 38 4c 70 17 c2 0e 21 93 e2 76 d1 05 f6 26 2c ef 72 33 2c>,
  absValidity: 2018-03-22T02:44:24.523Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50100587,
     cipherKeyVal: <Buffer 7a 72 4c 9a f8 5c a4 5f b4 07 16 4b 6b 18 82 11>,
     macKeyVal: <Buffer 32 79 37 8d 58 cc b9 f4 73 c6 e3 58 1e 38 4c 70 17 c2 0e 21 93 e2 76 d1 05 f6 26 2c ef 72 33 2c>,
     absValidity: 2018-03-22T02:44:24.523Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 3c ea 1f a9 fb bd de 11>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:44:25 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521600265432
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521600324338
connected to auth! from local port 52148
received auth hello!
{ authId: 501, nonce: <Buffer ef 80 a6 49 e5 8b 27 15> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6e 57 ea 4b 95 28 d0 73>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100595,
  cipherKeyVal: <Buffer 2e 0e c6 36 ee 5b 72 ca 11 71 44 a8 a9 45 0a 55>,
  macKeyVal: <Buffer e4 dc 4f bc 97 9c 16 26 7c 55 ad 68 8f fd e4 3c 67 06 74 09 05 1b 99 8b 90 c9 02 67 33 92 0d 72>,
  absValidity: 2018-03-22T02:45:24.664Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50100595,
     cipherKeyVal: <Buffer 2e 0e c6 36 ee 5b 72 ca 11 71 44 a8 a9 45 0a 55>,
     macKeyVal: <Buffer e4 dc 4f bc 97 9c 16 26 7c 55 ad 68 8f fd e4 3c 67 06 74 09 05 1b 99 8b 90 c9 02 67 33 92 0d 72>,
     absValidity: 2018-03-22T02:45:24.664Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 87 88 a0 7b f5 a9 1f 0d>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:45:25 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521600325886
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521600384397
connected to auth! from local port 52418
received auth hello!
{ authId: 501, nonce: <Buffer 95 e4 32 d5 23 a4 f9 08> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ce 4c 88 6f b6 0f cb ac>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100603,
  cipherKeyVal: <Buffer c6 4a db e5 c6 10 c9 2b 6f fb ba d9 d4 81 7c d0>,
  macKeyVal: <Buffer 9d 9d 05 bd 44 c5 71 a3 15 2c fd 35 07 7a 93 88 24 3b d3 7e f3 eb 89 3b a3 03 d3 37 01 f7 46 9d>,
  absValidity: 2018-03-22T02:46:24.710Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50100603,
     cipherKeyVal: <Buffer c6 4a db e5 c6 10 c9 2b 6f fb ba d9 d4 81 7c d0>,
     macKeyVal: <Buffer 9d 9d 05 bd 44 c5 71 a3 15 2c fd 35 07 7a 93 88 24 3b d3 7e f3 eb 89 3b a3 03 d3 37 01 f7 46 9d>,
     absValidity: 2018-03-22T02:46:24.710Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer a7 15 27 57 0d 27 6c 89>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:46:25 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521600385903
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521600444453
connected to auth! from local port 52688
received auth hello!
{ authId: 501, nonce: <Buffer 96 9c e9 1c 4c bc bf 3b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ea ae bf c7 04 03 b3 15>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100611,
  cipherKeyVal: <Buffer 03 7f fa fa 1d ed a8 52 f5 23 a6 fa 6b 08 20 81>,
  macKeyVal: <Buffer fb bf af 6e da 54 7f 3e 16 92 7c 47 0d 8d fe 33 9e 1b e4 ff 93 54 72 50 ea 4c 2e 78 c0 61 0b a8>,
  absValidity: 2018-03-22T02:47:24.799Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50100611,
     cipherKeyVal: <Buffer 03 7f fa fa 1d ed a8 52 f5 23 a6 fa 6b 08 20 81>,
     macKeyVal: <Buffer fb bf af 6e da 54 7f 3e 16 92 7c 47 0d 8d fe 33 9e 1b e4 ff 93 54 72 50 ea 4c 2e 78 c0 61 0b a8>,
     absValidity: 2018-03-22T02:47:24.799Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer c6 09 02 33 79 9b fc 7c>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:47:25 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521600445953
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521600504509
connected to auth! from local port 52958
received auth hello!
{ authId: 501, nonce: <Buffer db bc 34 b7 00 c1 b1 d9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9c 33 03 01 f7 4e f9 e4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100619,
  cipherKeyVal: <Buffer a3 79 85 27 88 7b 56 53 2a c9 13 c6 5d 78 c1 74>,
  macKeyVal: <Buffer d4 5a a6 8b 86 98 d4 67 75 68 9f 90 2b d4 51 55 b6 f7 6a 22 44 bc f5 c9 48 b3 b2 87 53 18 e9 db>,
  absValidity: 2018-03-22T02:48:24.835Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50100619,
     cipherKeyVal: <Buffer a3 79 85 27 88 7b 56 53 2a c9 13 c6 5d 78 c1 74>,
     macKeyVal: <Buffer d4 5a a6 8b 86 98 d4 67 75 68 9f 90 2b d4 51 55 b6 f7 6a 22 44 bc f5 c9 48 b3 b2 87 53 18 e9 db>,
     absValidity: 2018-03-22T02:48:24.835Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 71 16 0b 6a 18 43 f8 32>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:48:25 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521600505927
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521600564565
connected to auth! from local port 53228
received auth hello!
{ authId: 501, nonce: <Buffer 2e 5c 8e bc 16 15 62 08> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bb dc c2 1c 4b f4 7b ba>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100627,
  cipherKeyVal: <Buffer 9d 58 a1 11 3e 84 b7 53 a8 84 28 87 2a 57 67 fe>,
  macKeyVal: <Buffer f6 d9 f0 8c 82 c2 55 fb bb 7e bf 15 bb e5 6a 04 8e 15 19 98 1f b5 19 bb 43 c0 33 0f ef 57 8a 16>,
  absValidity: 2018-03-22T02:49:24.827Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50100627,
     cipherKeyVal: <Buffer 9d 58 a1 11 3e 84 b7 53 a8 84 28 87 2a 57 67 fe>,
     macKeyVal: <Buffer f6 d9 f0 8c 82 c2 55 fb bb 7e bf 15 bb e5 6a 04 8e 15 19 98 1f b5 19 bb 43 c0 33 0f ef 57 8a 16>,
     absValidity: 2018-03-22T02:49:24.827Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 57 67 5a af ed d7 22 9f>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:49:25 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521600566122
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521600624621
connected to auth! from local port 53496
received auth hello!
{ authId: 501, nonce: <Buffer d6 87 e4 68 3e d7 5a 7c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4b e9 a7 49 a9 2d 87 f0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50100635,
  cipherKeyVal: <Buffer 48 f6 b4 bc d4 3e 52 62 cf 76 f6 af a5 8b ba 92>,
  macKeyVal: <Buffer 4e f9 6e b4 e9 ea 42 ac d5 00 6d f3 ab 53 93 32 42 5c 40 04 33 ff d6 84 a1 ae ec af 3e 6d 70 b7>,
  absValidity: 2018-03-22T02:50:24.871Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50100635,
     cipherKeyVal: <Buffer 48 f6 b4 bc d4 3e 52 62 cf 76 f6 af a5 8b ba 92>,
     macKeyVal: <Buffer 4e f9 6e b4 e9 ea 42 ac d5 00 6d f3 ab 53 93 32 42 5c 40 04 33 ff d6 84 a1 ae ec af 3e 6d 70 b7>,
     absValidity: 2018-03-22T02:50:24.871Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer df fc 86 1d c4 4a 19 ac>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:50:25 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521600626117
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521600684677
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 9 0.7777777777777778 1521600744685
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.6:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 10 0.7 1521600804693
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.4:21100
connected to auth! from local port 33772
received auth hello!
{ authId: 502, nonce: <Buffer 7a 9c 33 ff 32 56 a0 93> }
more data will come. current: 1445 expected: 1485
received migration response with signature!
{ version: 2,
  subject: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth502',
     commonName: '10.0.1.5' },
  issuer: 
   { countryName: 'US',
     stateOrProvinceName: 'CA',
     localityName: 'Berkeley',
     organizationName: 'EECS',
     organizationalUnitName: 'Auth501',
     commonName: '10.0.0.4' },
  serial: '0162466F8372',
  notBefore: 2018-03-21T02:40:36.000Z,
  notAfter: 2018-03-22T02:42:16.000Z,
  subjectHash: '9638ffe3',
  signatureAlgorithm: 'sha256WithRSAEncryption',
  fingerPrint: '29:ED:05:45:15:50:28:59:A5:C0:F9:42:2E:AD:E7:28:C7:6B:25:EB',
  publicKey: 
   { algorithm: 'rsaEncryption',
     e: '65537',
     n: 'FF6CB5202497CC77AF28EFDE774858E4FEF04355E5228E378962DF4235BE3683DAF9E38A7E22621D66B3B50166D897E97BF911F9E8FC09D686961AA39679014E5DDD27EA0F02DE853A41537DB5E37F33395E249F355C0D074419572E9856D1D598CAB2CD6951013DDCB0A163B943DFCD2694BE18B9B3892695B3052EBD9115D447293C83AF24A008794B842E4F0A6C2A8D0189612A600AA40A592603E43713C0ECCA681024E5EC429FAD09484B824919DF59C8BD488E0D372D2A3D8B99B6068E24BBBDA8F0BCDDBA806010E4A7181736DF08D4D1CFC16E26507C360EDCBFF1B5F4288CE304DE62E9696665C5108489AD7232658356998FF47C4F7E8A04225423',
     bitSize: 2048 },
  altNames: [],
  extensions: { subjectAlternativeName: 'IP Address:10.0.1.5' } }
null
true
Certificate of new Auth is verified!
Subject information matches Auth ID!
Signature of new Auth is verified.
Auth nonce is verified
migration completed!
new Auth info: !
{ id: 502,
  host: '10.0.1.5',
  port: 21100,
  publicKey: '-----BEGIN CERTIFICATE-----\nMIIDVTCCAj2gAwIBAgIGAWJGb4NyMA0GCSqGSIb3DQEBCwUAMGExCzAJBgNVBAYT\nAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIQmVya2VsZXkxDTALBgNVBAoMBEVF\nQ1MxEDAOBgNVBAsMB0F1dGg1MDExETAPBgNVBAMMCDEwLjAuMC40MB4XDTE4MDMy\nMTAyNDAzNloXDTE4MDMyMjAyNDIxNlowYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\nAkNBMREwDwYDVQQHDAhCZXJrZWxleTENMAsGA1UECgwERUVDUzEQMA4GA1UECwwH\nQXV0aDUwMjERMA8GA1UEAwwIMTAuMC4xLjUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQD/bLUgJJfMd68o7953SFjk/vBDVeUijjeJYt9CNb42g9r544p+\nImIdZrO1AWbYl+l7+RH56PwJ1oaWGqOWeQFOXd0n6g8C3oU6QVN9teN/MzleJJ81\nXA0HRBlXLphW0dWYyrLNaVEBPdywoWO5Q9/NJpS+GLmziSaVswUuvZEV1EcpPIOv\nJKAIeUuELk8KbCqNAYlhKmAKpApZJgPkNxPA7MpoECTl7EKfrQlIS4JJGd9ZyL1I\njg03LSo9i5m2Bo4ku72o8LzduoBgEOSnGBc23wjU0c/BbiZQfDYO3L/xtfQojOME\n3mLpaWZlxRCEia1yMmWDVpmP9HxPfooEIlQjAgMBAAGjEzARMA8GA1UdEQQIMAaH\nBAoAAQUwDQYJKoZIhvcNAQELBQADggEBAErSFb7CNHdUHd6eo+jnskonG8InEjSC\nWqzUL01wak2HI0/5sPRn68+M10ln3DHUil/zzv9fQf715sJBUpExKd/gauDTZhOT\nL7fBiBOc2ultexplJcP3H33+3DT47tzNfZc+khFnnuFsVkuwLC3FryTqnCHo0Px6\nvRRCROat+aIYlHmYEskLZQ/PULT8NBxlbcv05fZIZ88vWxvlb/0io6CsqvfZHE6S\nAI7hIupgLEIzkHCTETAO3oD3KpFkAKUEcbr/FN3MRFmJZQhlgQ9pOprlVQxldyPp\nRgMqzGh7j7eMtT0ry6LZQ38SlOygA6Ggy9atcAcU51YbXtHqLAdX9aA=\n-----END CERTIFICATE-----' }
received migration response, for next round of migration, rotate migration info index from: 1
to: 2
disconnected from auth
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 11 0.6363636363636364 1521600864703
connected to auth! from local port 33968
received auth hello!
{ authId: 502, nonce: <Buffer 1b ee 8d 13 ed 31 a1 ff> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 32 e1 ab 90 cd 66 ca 8c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 33 a2 46 34 00 2d 89 83 02 4e 5b a2 c0 8a ea 43>,
  macKeyVal: <Buffer 02 2b 3b 9a c6 3e 14 ea 1a ff 71 2c 0e 2b 89 e2 26 a5 ff b2 71 d6 5b 7e 6b d3 6b 27 b5 80 60 c2>,
  absValidity: 2018-03-21T03:54:36.336Z }
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201101,
  cipherKeyVal: <Buffer 69 5b 3b dd 2d 14 ed a4 6a cd c1 cf 2a 70 f8 ec>,
  macKeyVal: <Buffer 79 0d 1f 9a 5d c7 41 95 15 3d be 6b 73 8d 4f 52 67 a4 9c 16 01 f6 3d 8b 79 79 94 aa 2f c3 ac ec>,
  absValidity: 2018-03-22T02:54:36.336Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50201101,
     cipherKeyVal: <Buffer 69 5b 3b dd 2d 14 ed a4 6a cd c1 cf 2a 70 f8 ec>,
     macKeyVal: <Buffer 79 0d 1f 9a 5d c7 41 95 15 3d be 6b 73 8d 4f 52 67 a4 9c 16 01 f6 3d 8b 79 79 94 aa 2f c3 ac ec>,
     absValidity: 2018-03-22T02:54:36.336Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 76 a9 1b d6 30 b3 e0 fa>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 12 0.5833333333333334 1521600924751
connected to auth! from local port 34172
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.24:undefined
received auth hello!
{ authId: 502, nonce: <Buffer 89 13 ab ea 43 06 fb ce> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9c a3 9c ea b7 02 39 bc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201123,
  cipherKeyVal: <Buffer 6b 85 42 a0 61 95 85 96 47 20 a9 e0 f6 17 61 db>,
  macKeyVal: <Buffer c0 cd 62 53 34 d8 4d 36 17 44 ab 5b 1d f5 d9 97 c4 06 95 bc 73 7d cd d5 f2 04 f4 1d 45 32 8f 12>,
  absValidity: 2018-03-22T02:56:06.795Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50201123,
     cipherKeyVal: <Buffer 6b 85 42 a0 61 95 85 96 47 20 a9 e0 f6 17 61 db>,
     macKeyVal: <Buffer c0 cd 62 53 34 d8 4d 36 17 44 ab 5b 1d f5 d9 97 c4 06 95 bc 73 7d cd d5 f2 04 f4 1d 45 32 8f 12>,
     absValidity: 2018-03-22T02:56:06.795Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 8d d6 66 86 25 df b0 fd>
switching to HANDSHAKE_1_SENT
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 13 0.5384615384615384 1521600984766
connected to auth! from local port 34376
received auth hello!
{ authId: 502, nonce: <Buffer 2e 1f a7 84 23 f6 1f b0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 26 23 89 e5 11 47 81 0f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201127,
  cipherKeyVal: <Buffer 54 16 90 f6 3c 2e 12 a9 38 06 e4 3a d9 0b 24 2c>,
  macKeyVal: <Buffer d3 d3 ed df 5a 2a 74 a4 e5 85 f4 a7 dc cb bd 20 f2 7c d6 a0 ae f8 cd 91 ba 8c 27 c8 db 8d ff f2>,
  absValidity: 2018-03-22T02:56:28.572Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50201127,
     cipherKeyVal: <Buffer 54 16 90 f6 3c 2e 12 a9 38 06 e4 3a d9 0b 24 2c>,
     macKeyVal: <Buffer d3 d3 ed df 5a 2a 74 a4 e5 85 f4 a7 dc cb bd 20 f2 7c d6 a0 ae f8 cd 91 ba 8c 27 c8 db 8d ff f2>,
     absValidity: 2018-03-22T02:56:28.572Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 48 ef 89 ce 08 93 03 30>
switching to HANDSHAKE_1_SENT
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.24:undefined
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.24:undefined
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 14 0.5 1521601044772
connected to auth! from local port 34588
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 15 0.4666666666666667 1521601104781
connected to auth! from local port 34784
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 16 0.4375 1521601164792
connected to auth! from local port 34972
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 17 0.4117647058823529 1521601224801
connected to auth! from local port 35156
received auth hello!
{ authId: 502, nonce: <Buffer 63 f8 28 0c 01 b1 05 d3> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: write after end
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 18 0.3888888888888889 1521601284821
connected to auth! from local port 35336
Handler: Error in secure comm - details: Connection with Auth timed out...
received auth hello!
{ authId: 502, nonce: <Buffer 53 94 c5 d7 68 89 f7 56> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 50 ab 5b 06 2a ac 47 c5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201201,
  cipherKeyVal: <Buffer ef 49 4f eb ab d2 6a 64 c1 d8 56 83 47 7c 22 8d>,
  macKeyVal: <Buffer 3c 88 ee e3 33 f4 ec 3c 22 a4 2b 7e f0 9e 8c d1 bc 67 72 9c c8 ba 9b be 8d 52 2e 5d 07 e4 db 01>,
  absValidity: 2018-03-22T03:01:40.823Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50201201,
     cipherKeyVal: <Buffer ef 49 4f eb ab d2 6a 64 c1 d8 56 83 47 7c 22 8d>,
     macKeyVal: <Buffer 3c 88 ee e3 33 f4 ec 3c 22 a4 2b 7e f0 9e 8c d1 bc 67 72 9c c8 ba 9b be 8d 52 2e 5d 07 e4 db 01>,
     absValidity: 2018-03-22T03:01:40.823Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer c7 05 58 78 c1 87 8e c3>
switching to HANDSHAKE_1_SENT
disconnected from auth
received auth hello!
{ authId: 502, nonce: <Buffer a1 3e 92 8f b4 d7 c1 64> }
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: write after end
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 19 0.3684210526315789 1521601344825
connected to auth! from local port 35504
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.24:undefined
disconnected from auth
Handler: Error in secure comm - details: Connection with Auth timed out...
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 20 0.35 1521601404836
connected to auth! from local port 35680
received auth hello!
{ authId: 502, nonce: <Buffer 39 0e 75 9b 52 cc d1 24> }
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: write after end
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.4:21100
disconnected from auth
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Handler: Error in secure comm - details: Connection with Auth timed out...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 21 0.3333333333333333 1521601464842
connected to auth! from local port 35856
received auth hello!
{ authId: 502, nonce: <Buffer 54 01 d8 5b e4 02 4e d8> }
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 2
to: 0
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: write after end
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.6:21100
received auth hello!
{ authId: 502, nonce: <Buffer 85 d8 c7 7f 97 73 dd 26> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0e 67 60 6a fc 75 82 54>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201236,
  cipherKeyVal: <Buffer ec 18 ae bf 99 47 21 70 a7 db cd 9f 00 ad df bf>,
  macKeyVal: <Buffer 66 a1 ef be f8 2b a8 7b 02 70 66 d9 ad 37 a2 24 0e af b7 6d d4 7a 95 f5 ab a2 ea 79 f1 7a ac 4d>,
  absValidity: 2018-03-22T03:04:36.570Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50201236,
     cipherKeyVal: <Buffer ec 18 ae bf 99 47 21 70 a7 db cd 9f 00 ad df bf>,
     macKeyVal: <Buffer 66 a1 ef be f8 2b a8 7b 02 70 66 d9 ad 37 a2 24 0e af b7 6d d4 7a 95 f5 ab a2 ea 79 f1 7a ac 4d>,
     absValidity: 2018-03-22T03:04:36.570Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer f4 53 13 e0 b9 67 94 6a>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: Error in secure comm - details: Connection with Auth timed out...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 22 0.3181818181818182 1521601524849
connected to auth! from local port 36036
Handler: Error in secure comm - details: Comm init failed: handshake1 timed out ...
Handler: Error in secure comm - details: Comm init failed: disconnected from server during communication initialization.10.0.1.24:undefined
received auth hello!
{ authId: 502, nonce: <Buffer bd 92 8b 7e 26 e6 b5 e6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ca 11 af 84 a4 9e bd fd>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201248,
  cipherKeyVal: <Buffer 02 5f 2d db 24 2a 9d 6d c8 54 5a 44 3d aa a0 6a>,
  macKeyVal: <Buffer 82 f5 1c 0a cd 80 6c 22 57 7e b6 69 86 4d aa 44 60 5d 11 14 d5 44 8e 34 c1 b1 d5 b5 c6 72 8a bb>,
  absValidity: 2018-03-22T03:05:32.613Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50201248,
     cipherKeyVal: <Buffer 02 5f 2d db 24 2a 9d 6d c8 54 5a 44 3d aa a0 6a>,
     macKeyVal: <Buffer 82 f5 1c 0a cd 80 6c 22 57 7e b6 69 86 4d aa 44 60 5d 11 14 d5 44 8e 34 c1 b1 d5 b5 c6 72 8a bb>,
     absValidity: 2018-03-22T03:05:32.613Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.24:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 23 0.30434782608695654 1521601584898
connected to auth! from local port 36194
received auth hello!
{ authId: 502, nonce: <Buffer 51 06 f4 a9 1c fe 1e 0e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1b 34 01 91 73 de 0e ba>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201262,
  cipherKeyVal: <Buffer 59 aa 82 0f 51 47 66 10 7a aa 91 b7 3e 27 3e 98>,
  macKeyVal: <Buffer 9f fc b2 76 f5 48 67 99 c6 81 7c 6c 73 15 6e eb fb fd 67 57 d6 3a 6f 3f 90 29 15 9e 16 35 fc 2d>,
  absValidity: 2018-03-22T03:06:32.581Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50201262,
     cipherKeyVal: <Buffer 59 aa 82 0f 51 47 66 10 7a aa 91 b7 3e 27 3e 98>,
     macKeyVal: <Buffer 9f fc b2 76 f5 48 67 99 c6 81 7c 6c 73 15 6e eb fb fd 67 57 d6 3a 6f 3f 90 29 15 9e 16 35 fc 2d>,
     absValidity: 2018-03-22T03:06:32.581Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.24:22100
disconnected from auth
received auth hello!
{ authId: 502, nonce: <Buffer b4 12 47 5e 2b 49 59 72> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 78 3d d4 9e 4c 4f a6 9f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201272,
  cipherKeyVal: <Buffer 4b 22 a8 af 55 cf e2 9d 38 4c 36 97 f8 69 13 7a>,
  macKeyVal: <Buffer 49 87 1a 55 b0 ce fd 4f e3 d5 13 2d 1b c6 49 c8 46 83 aa e3 c4 e1 34 20 08 0d 99 a0 89 3c 4c e5>,
  absValidity: 2018-03-22T03:07:01.346Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50201272,
     cipherKeyVal: <Buffer 4b 22 a8 af 55 cf e2 9d 38 4c 36 97 f8 69 13 7a>,
     macKeyVal: <Buffer 49 87 1a 55 b0 ce fd 4f e3 d5 13 2d 1b c6 49 c8 46 83 aa e3 c4 e1 34 20 08 0d 99 a0 89 3c 4c e5>,
     absValidity: 2018-03-22T03:07:01.346Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.24:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 24 0.2916666666666667 1521601644921
connected to auth! from local port 36354
received auth hello!
{ authId: 502, nonce: <Buffer 2b 7c ea 51 11 cd 0e 6c> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 09 9d 68 ca 1e 45 7b 53>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201284,
  cipherKeyVal: <Buffer 93 63 c9 e5 ee 27 d3 1c 23 90 77 09 e8 ab 97 4a>,
  macKeyVal: <Buffer a2 91 b2 96 be 1d 08 ee 2a 77 fe a6 91 97 01 c9 75 1d dc 3e b3 39 e0 b6 c7 6c 8a ce cc b2 fe c0>,
  absValidity: 2018-03-22T03:07:56.810Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50201284,
     cipherKeyVal: <Buffer 93 63 c9 e5 ee 27 d3 1c 23 90 77 09 e8 ab 97 4a>,
     macKeyVal: <Buffer a2 91 b2 96 be 1d 08 ee 2a 77 fe a6 91 97 01 c9 75 1d dc 3e b3 39 e0 b6 c7 6c 8a ce cc b2 fe c0>,
     absValidity: 2018-03-22T03:07:56.810Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.24:22100
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 25 0.28 1521601704949
connected to auth! from local port 36510
received auth hello!
{ authId: 502, nonce: <Buffer 70 cd 6b 10 17 f9 b4 3e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8f b6 4c 0c 11 e0 95 c5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201287,
  cipherKeyVal: <Buffer 1e 62 bd cb fc 63 43 92 80 3b d3 8a 55 3c 1a b9>,
  macKeyVal: <Buffer 3b 1e 0b 6e 6b 58 1b 01 4d bb 2c 48 92 0d 53 b6 1f a6 d8 e4 76 8d a5 15 ee 82 56 49 67 ba 96 58>,
  absValidity: 2018-03-22T03:08:28.810Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50201287,
     cipherKeyVal: <Buffer 1e 62 bd cb fc 63 43 92 80 3b d3 8a 55 3c 1a b9>,
     macKeyVal: <Buffer 3b 1e 0b 6e 6b 58 1b 01 4d bb 2c 48 92 0d 53 b6 1f a6 d8 e4 76 8d a5 15 ee 82 56 49 67 ba 96 58>,
     absValidity: 2018-03-22T03:08:28.810Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.24:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 26 0.2692307692307692 1521601764990
connected to auth! from local port 36668
received auth hello!
{ authId: 502, nonce: <Buffer 89 9b d3 26 63 02 92 32> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0a 21 18 56 b4 d1 ae 15>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201301,
  cipherKeyVal: <Buffer 46 d7 3b 8e 2e ca d7 85 b2 ae b7 32 a7 65 d3 a7>,
  macKeyVal: <Buffer da e0 db ec 3c f8 1c 16 08 ff 58 47 63 4b 8f f4 41 d7 bb bc 17 f1 92 28 57 42 0e 22 88 83 41 37>,
  absValidity: 2018-03-22T03:09:28.864Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50201301,
     cipherKeyVal: <Buffer 46 d7 3b 8e 2e ca d7 85 b2 ae b7 32 a7 65 d3 a7>,
     macKeyVal: <Buffer da e0 db ec 3c f8 1c 16 08 ff 58 47 63 4b 8f f4 41 d7 bb bc 17 f1 92 28 57 42 0e 22 88 83 41 37>,
     absValidity: 2018-03-22T03:09:28.864Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.24:22100
disconnected from auth
received auth hello!
{ authId: 502, nonce: <Buffer 2e 95 c0 a8 c2 30 fc a9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ef 4a b8 ef 04 3f 79 c7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201308,
  cipherKeyVal: <Buffer 3b 08 2c 38 91 98 b8 f9 34 10 e4 c1 59 5b d0 d1>,
  macKeyVal: <Buffer 48 ec bb a5 84 de 43 4e 51 d5 a4 df cd f3 16 1e 13 c3 8d f9 80 ae 8e 74 c6 02 53 86 d3 45 ce 92>,
  absValidity: 2018-03-22T03:09:56.351Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50201308,
     cipherKeyVal: <Buffer 3b 08 2c 38 91 98 b8 f9 34 10 e4 c1 59 5b d0 d1>,
     macKeyVal: <Buffer 48 ec bb a5 84 de 43 4e 51 d5 a4 df cd f3 16 1e 13 c3 8d f9 80 ae 8e 74 c6 02 53 86 d3 45 ce 92>,
     absValidity: 2018-03-22T03:09:56.351Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.24:22100
disconnected from auth
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 27 0.25925925925925924 1521601825017
connected to auth! from local port 36826
received auth hello!
{ authId: 502, nonce: <Buffer 5d 5c 31 6b 4c c3 f2 c7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b6 e5 29 33 fb ff 57 33>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201312,
  cipherKeyVal: <Buffer 44 2f c4 89 8a 3c fa 97 68 8a 94 f2 03 a1 74 29>,
  macKeyVal: <Buffer 2d 5e c8 b9 c5 18 9d 8e 63 e4 16 8e 59 c0 a8 bc bd bb ad 20 33 f7 aa b6 d9 4d a9 12 c0 83 6f cf>,
  absValidity: 2018-03-22T03:10:33.100Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50201312,
     cipherKeyVal: <Buffer 44 2f c4 89 8a 3c fa 97 68 8a 94 f2 03 a1 74 29>,
     macKeyVal: <Buffer 2d 5e c8 b9 c5 18 9d 8e 63 e4 16 8e 59 c0 a8 bc bd bb ad 20 33 f7 aa b6 d9 4d a9 12 c0 83 6f cf>,
     absValidity: 2018-03-22T03:10:33.100Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.24:22100
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 28 0.25 1521601885069
connected to auth! from local port 36994
received auth hello!
{ authId: 502, nonce: <Buffer 8c 81 41 f8 c6 f6 ee 57> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer da 79 f7 28 dc 03 83 01>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 50201326,
  cipherKeyVal: <Buffer de f5 a3 3a 0e 29 11 1d 44 00 36 cd 77 fc 46 78>,
  macKeyVal: <Buffer f9 7e 69 46 77 a4 ad a4 a9 fe 40 f4 9a 91 8d 7e 03 f9 db dd 7e 41 8e 9d 3f 54 b2 ad e8 cb cf 5c>,
  absValidity: 2018-03-22T03:11:28.832Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.24',
  serverPort: 22100,
  sessionKey: 
   { id: 50201326,
     cipherKeyVal: <Buffer de f5 a3 3a 0e 29 11 1d 44 00 36 cd 77 fc 46 78>,
     macKeyVal: <Buffer f9 7e 69 46 77 a4 ad a4 a9 fe 40 f4 9a 91 8d 7e 03 f9 db dd 7e 41 8e 9d 3f 54 b2 ad e8 cb cf 5c>,
     absValidity: 2018-03-22T03:11:28.832Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
Handler: Error in secure comm - details: Comm init failed: Error in comm init - details: Error: connect ECONNREFUSED 10.0.1.24:22100
disconnected from auth
