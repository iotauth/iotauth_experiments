changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c416.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c416',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 77 4d ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521600251342
connected to auth! from local port 39242
received auth hello!
{ authId: 403, nonce: <Buffer 80 be 1f 4e c4 9b 24 a8> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer be 25 39 f2 dd e2 1f d7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 1a 73 14 2f cd d6 11 96 30 36 b9 86 a2 1e d8 22>,
  macKeyVal: <Buffer 6b 81 61 7f a7 e1 71 07 87 5b b5 f3 3b b8 8c 26 1e e5 ad 28 49 aa 20 5e ae 0e 93 01 8e 37 a1 ed>,
  absValidity: 2018-03-21T03:44:11.521Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300572,
  cipherKeyVal: <Buffer 0d 9d 70 a5 3e 43 fd 50 c3 2f f9 01 de 6a a1 b2>,
  macKeyVal: <Buffer 60 2a 6b e7 98 50 15 d6 d8 69 f8 73 10 63 c1 5f 85 0c af 8c fa 0b 36 46 59 0a 3f 7f de de f7 a0>,
  absValidity: 2018-03-22T02:44:11.520Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.20',
  serverPort: 22100,
  sessionKey: 
   { id: 40300572,
     cipherKeyVal: <Buffer 0d 9d 70 a5 3e 43 fd 50 c3 2f f9 01 de 6a a1 b2>,
     macKeyVal: <Buffer 60 2a 6b e7 98 50 15 d6 d8 69 f8 73 10 63 c1 5f 85 0c af 8c fa 0b 36 46 59 0a 3f 7f de de f7 a0>,
     absValidity: 2018-03-22T02:44:11.520Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer ad ff c0 26 71 a3 b9 ea>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:44:12 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521600252508
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521600311398
connected to auth! from local port 39446
received auth hello!
{ authId: 403, nonce: <Buffer 09 e7 87 ec b9 f7 2d 93> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer eb 8b c8 fd 0c 90 a6 d8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300578,
  cipherKeyVal: <Buffer 0c d6 28 60 a3 46 f8 be 00 3a f4 b0 9d 12 a2 f1>,
  macKeyVal: <Buffer 13 f8 b1 88 a7 91 b0 89 ea 2d e2 73 5f a9 76 07 94 51 26 45 80 34 1f 14 7a 95 81 a9 fc cc 83 58>,
  absValidity: 2018-03-22T02:45:11.589Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.20',
  serverPort: 22100,
  sessionKey: 
   { id: 40300578,
     cipherKeyVal: <Buffer 0c d6 28 60 a3 46 f8 be 00 3a f4 b0 9d 12 a2 f1>,
     macKeyVal: <Buffer 13 f8 b1 88 a7 91 b0 89 ea 2d e2 73 5f a9 76 07 94 51 26 45 80 34 1f 14 7a 95 81 a9 fc cc 83 58>,
     absValidity: 2018-03-22T02:45:11.589Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer cb 0f d1 da 63 5c 35 56>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:45:12 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521600312805
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521600371456
connected to auth! from local port 39718
received auth hello!
{ authId: 403, nonce: <Buffer 67 bf 91 5a 47 40 65 a8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 58 cc 06 cc ae 3d 5e c4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300584,
  cipherKeyVal: <Buffer da 92 4c 0b 52 ef 8a 09 84 94 5d 8f ae b5 87 3b>,
  macKeyVal: <Buffer 13 fb 8e 4e 01 40 f5 17 18 86 da fd 4b fe 7f c5 10 d8 6d 9e f3 fb 18 7b 71 84 ca 86 72 1a 74 22>,
  absValidity: 2018-03-22T02:46:11.602Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.20',
  serverPort: 22100,
  sessionKey: 
   { id: 40300584,
     cipherKeyVal: <Buffer da 92 4c 0b 52 ef 8a 09 84 94 5d 8f ae b5 87 3b>,
     macKeyVal: <Buffer 13 fb 8e 4e 01 40 f5 17 18 86 da fd 4b fe 7f c5 10 d8 6d 9e f3 fb 18 7b 71 84 ca 86 72 1a 74 22>,
     absValidity: 2018-03-22T02:46:11.602Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 5e 36 bc ab 9c a6 56 04>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:46:12 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521600372695
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521600431492
connected to auth! from local port 39988
received auth hello!
{ authId: 403, nonce: <Buffer 7c 30 c7 9b f1 68 37 54> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 56 81 4e b7 05 70 0b c2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300590,
  cipherKeyVal: <Buffer 4e fa eb 60 1e 21 75 5d 92 e7 31 b4 c9 e3 30 02>,
  macKeyVal: <Buffer 99 ab 84 25 29 3b bc 56 71 56 21 df d2 1f 96 bb 77 84 fe 1d 5d e4 b9 9c d5 e6 52 3a fd e0 ec 92>,
  absValidity: 2018-03-22T02:47:11.619Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.20',
  serverPort: 22100,
  sessionKey: 
   { id: 40300590,
     cipherKeyVal: <Buffer 4e fa eb 60 1e 21 75 5d 92 e7 31 b4 c9 e3 30 02>,
     macKeyVal: <Buffer 99 ab 84 25 29 3b bc 56 71 56 21 df d2 1f 96 bb 77 84 fe 1d 5d e4 b9 9c d5 e6 52 3a fd e0 ec 92>,
     absValidity: 2018-03-22T02:47:11.619Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer c1 7c 07 0c 85 6b c6 01>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:47:12 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521600432773
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521600491549
connected to auth! from local port 40258
received auth hello!
{ authId: 403, nonce: <Buffer e1 9d 9f 91 0f f5 9b 9f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 07 ea 15 13 5f 31 45 01>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300596,
  cipherKeyVal: <Buffer d0 94 15 46 89 43 db a4 44 d2 a0 e2 7a 29 49 9d>,
  macKeyVal: <Buffer fc d4 6a 5b 24 bd 61 93 cb c3 d6 5b e4 60 8b 52 08 18 92 b1 06 20 43 1a ff 7c 06 57 0e b5 b7 43>,
  absValidity: 2018-03-22T02:48:11.713Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.20',
  serverPort: 22100,
  sessionKey: 
   { id: 40300596,
     cipherKeyVal: <Buffer d0 94 15 46 89 43 db a4 44 d2 a0 e2 7a 29 49 9d>,
     macKeyVal: <Buffer fc d4 6a 5b 24 bd 61 93 cb c3 d6 5b e4 60 8b 52 08 18 92 b1 06 20 43 1a ff 7c 06 57 0e b5 b7 43>,
     absValidity: 2018-03-22T02:48:11.713Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer c3 37 56 9b 49 aa a6 3c>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:48:12 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521600492891
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521600551605
connected to auth! from local port 40528
received auth hello!
{ authId: 403, nonce: <Buffer 00 93 e0 b5 bb 4a d0 66> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer dd 9c d9 30 7f 69 b1 28>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300602,
  cipherKeyVal: <Buffer 42 ce 1d 77 27 fe eb 5e 8b 69 92 e2 0e 76 9c 89>,
  macKeyVal: <Buffer ff 85 d9 04 e9 16 1b cc 69 db b6 da fe 4d c1 b1 7c d2 f6 b6 b5 13 17 6e 32 40 4e 4b 79 b2 91 8a>,
  absValidity: 2018-03-22T02:49:11.729Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.20',
  serverPort: 22100,
  sessionKey: 
   { id: 40300602,
     cipherKeyVal: <Buffer 42 ce 1d 77 27 fe eb 5e 8b 69 92 e2 0e 76 9c 89>,
     macKeyVal: <Buffer ff 85 d9 04 e9 16 1b cc 69 db b6 da fe 4d c1 b1 7c d2 f6 b6 b5 13 17 6e 32 40 4e 4b 79 b2 91 8a>,
     absValidity: 2018-03-22T02:49:11.729Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 63 e1 81 78 d3 05 47 9d>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:49:12 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521600552718
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521600611665
connected to auth! from local port 40798
received auth hello!
{ authId: 403, nonce: <Buffer b8 02 f4 cb 19 7e 93 ad> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5c de 60 7f 88 e9 4c 98>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300608,
  cipherKeyVal: <Buffer 53 10 a9 9a 7c 2f 66 b0 f1 08 81 55 c8 34 a4 10>,
  macKeyVal: <Buffer ef fc d4 ef 6e d0 0c 5b 0c b4 e3 81 f8 49 7c 08 d6 bb 71 d7 07 54 b8 15 b8 14 06 e0 01 ea 70 cb>,
  absValidity: 2018-03-22T02:50:11.797Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.20',
  serverPort: 22100,
  sessionKey: 
   { id: 40300608,
     cipherKeyVal: <Buffer 53 10 a9 9a 7c 2f 66 b0 f1 08 81 55 c8 34 a4 10>,
     macKeyVal: <Buffer ef fc d4 ef 6e d0 0c 5b 0c b4 e3 81 f8 49 7c 08 d6 bb 71 d7 07 54 b8 15 b8 14 06 e0 01 ea 70 cb>,
     absValidity: 2018-03-22T02:50:11.797Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 3d 4d c9 a7 09 c6 6b 1e>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:50:12 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521600612791
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521600671715
connected to auth! from local port 41060
received auth hello!
{ authId: 403, nonce: <Buffer fa 4e 82 da 15 65 00 86> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 70 7e 58 ca d6 a0 f6 8b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300614,
  cipherKeyVal: <Buffer d9 8a 86 52 c1 42 a9 a9 79 12 22 b5 27 7c de b0>,
  macKeyVal: <Buffer 8e 07 ea 91 03 d3 a5 23 c9 b9 65 5c e5 fb 63 14 9b c8 62 ea ff 88 f6 47 25 f7 63 0c 04 3c 89 8d>,
  absValidity: 2018-03-22T02:51:11.828Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.20',
  serverPort: 22100,
  sessionKey: 
   { id: 40300614,
     cipherKeyVal: <Buffer d9 8a 86 52 c1 42 a9 a9 79 12 22 b5 27 7c de b0>,
     macKeyVal: <Buffer 8e 07 ea 91 03 d3 a5 23 c9 b9 65 5c e5 fb 63 14 9b c8 62 ea ff 88 f6 47 25 f7 63 0c 04 3c 89 8d>,
     absValidity: 2018-03-22T02:51:11.828Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 0d d3 24 ff b2 4a 27 4b>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:51:12 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 8 1 1521600672844
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 9 0.8888888888888888 1521600731775
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.3:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 10 0.8 1521600791785
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.3:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.6:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 11 0.7272727272727273 1521600851792
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.3:21100
connected to auth! from local port 59422
/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902
            eventHandlers.onError('Error occurred in migration request: Disconnected from auth before getting migration response: ' + error);
                                                                                                                                      ^

ReferenceError: error is not defined
    at Socket.<anonymous> (/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902:135)
    at emitNone (events.js:91:20)
    at Socket.emit (events.js:188:7)
    at endReadableNT (_stream_readable.js:975:12)
    at _combinedTickCallback (internal/process/next_tick.js:80:11)
    at process._tickCallback (internal/process/next_tick.js:104:9)
