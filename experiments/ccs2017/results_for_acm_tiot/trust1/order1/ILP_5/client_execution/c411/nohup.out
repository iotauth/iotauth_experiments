changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c411.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c411',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 72 4a ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521600234996
connected to auth! from local port 58486
received auth hello!
{ authId: 402, nonce: <Buffer 68 92 64 36 d0 3a be f7> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 04 0e c5 0c b1 70 22 94>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer c7 9f fb dd 08 d4 db d3 d9 88 50 37 38 c5 c2 a5>,
  macKeyVal: <Buffer fa 2c f0 73 84 48 aa 22 1a 45 ec 2d c9 cc a8 e2 5d 3a 21 8e 2d 02 71 3e 6b 51 88 61 f0 ac 32 6e>,
  absValidity: 2018-03-21T03:43:55.208Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200365,
  cipherKeyVal: <Buffer 4d 49 df ab 2b 99 00 ab 54 34 d5 34 f5 1e d4 85>,
  macKeyVal: <Buffer c8 be 70 b0 ae c9 c0 53 c0 3b 3c 42 5f 93 07 92 2e d3 1a 17 fc fe 9f aa c0 62 39 6e 3e b2 92 96>,
  absValidity: 2018-03-22T02:43:55.207Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.17',
  serverPort: 22100,
  sessionKey: 
   { id: 40200365,
     cipherKeyVal: <Buffer 4d 49 df ab 2b 99 00 ab 54 34 d5 34 f5 1e d4 85>,
     macKeyVal: <Buffer c8 be 70 b0 ae c9 c0 53 c0 3b 3c 42 5f 93 07 92 2e d3 1a 17 fc fe 9f aa c0 62 39 6e 3e b2 92 96>,
     absValidity: 2018-03-22T02:43:55.207Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 12 e2 a7 e4 4e 23 38 36>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:43:57 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521600237661
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521600295050
connected to auth! from local port 58660
received auth hello!
{ authId: 402, nonce: <Buffer 47 7d 64 98 fb 50 f7 d5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d0 28 41 4b 74 9c 17 60>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200372,
  cipherKeyVal: <Buffer 71 d1 88 a4 68 81 bf 9d 01 fb 90 f4 6f f0 8f 7e>,
  macKeyVal: <Buffer 72 99 12 7b 27 83 c1 4b 71 0e ee b3 1e 2c 92 12 e1 b5 26 00 97 66 9b 52 54 59 f6 6e a7 1d 2c 40>,
  absValidity: 2018-03-22T02:44:55.287Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.17',
  serverPort: 22100,
  sessionKey: 
   { id: 40200372,
     cipherKeyVal: <Buffer 71 d1 88 a4 68 81 bf 9d 01 fb 90 f4 6f f0 8f 7e>,
     macKeyVal: <Buffer 72 99 12 7b 27 83 c1 4b 71 0e ee b3 1e 2c 92 12 e1 b5 26 00 97 66 9b 52 54 59 f6 6e a7 1d 2c 40>,
     absValidity: 2018-03-22T02:44:55.287Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer c4 d1 f6 75 67 70 14 aa>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:44:57 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521600298051
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521600355105
connected to auth! from local port 58932
received auth hello!
{ authId: 402, nonce: <Buffer 1c 53 72 24 a0 a4 64 2e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8a 4f dc 52 de c3 fd 04>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200379,
  cipherKeyVal: <Buffer 35 91 c1 19 84 8a 28 f6 52 d5 8b 57 92 ad 9a 65>,
  macKeyVal: <Buffer 6c 54 df 16 7b e5 ef 51 a5 5d 64 56 54 86 44 81 0d 60 c2 28 53 52 cc 43 23 9b 31 06 3f ff ac a7>,
  absValidity: 2018-03-22T02:45:55.272Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.17',
  serverPort: 22100,
  sessionKey: 
   { id: 40200379,
     cipherKeyVal: <Buffer 35 91 c1 19 84 8a 28 f6 52 d5 8b 57 92 ad 9a 65>,
     macKeyVal: <Buffer 6c 54 df 16 7b e5 ef 51 a5 5d 64 56 54 86 44 81 0d 60 c2 28 53 52 cc 43 23 9b 31 06 3f ff ac a7>,
     absValidity: 2018-03-22T02:45:55.272Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 89 22 de a1 be 6b 53 fc>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:45:57 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521600357778
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521600415152
connected to auth! from local port 59202
received auth hello!
{ authId: 402, nonce: <Buffer 45 43 be a9 bd ae dd a8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ba c2 f8 ca 23 e1 18 8e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200386,
  cipherKeyVal: <Buffer 8f d0 14 02 49 4d a9 ce a3 5d 43 44 ab b5 a0 df>,
  macKeyVal: <Buffer 5f 63 28 52 09 b5 72 b2 7a 18 80 c8 ec 31 f1 16 ae 62 d8 e8 e6 ff 6c c6 6e 48 3d d2 d5 cc 62 40>,
  absValidity: 2018-03-22T02:46:55.352Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.17',
  serverPort: 22100,
  sessionKey: 
   { id: 40200386,
     cipherKeyVal: <Buffer 8f d0 14 02 49 4d a9 ce a3 5d 43 44 ab b5 a0 df>,
     macKeyVal: <Buffer 5f 63 28 52 09 b5 72 b2 7a 18 80 c8 ec 31 f1 16 ae 62 d8 e8 e6 ff 6c c6 6e 48 3d d2 d5 cc 62 40>,
     absValidity: 2018-03-22T02:46:55.352Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer f8 7e 05 35 f7 36 6e 12>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:46:57 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521600417968
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521600475200
connected to auth! from local port 59472
received auth hello!
{ authId: 402, nonce: <Buffer dd c2 0a 6d 48 30 cd e4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer db 79 a6 af 67 d7 a1 af>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200393,
  cipherKeyVal: <Buffer 74 b1 84 3f 72 38 25 3a 14 67 52 f1 de d9 da 35>,
  macKeyVal: <Buffer fa 97 7b 63 89 7e 2a e9 05 4a 28 20 5c bb 8d 29 06 a1 2e a1 1c a1 71 27 d9 b2 77 11 a5 ff 7c a5>,
  absValidity: 2018-03-22T02:47:55.386Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.17',
  serverPort: 22100,
  sessionKey: 
   { id: 40200393,
     cipherKeyVal: <Buffer 74 b1 84 3f 72 38 25 3a 14 67 52 f1 de d9 da 35>,
     macKeyVal: <Buffer fa 97 7b 63 89 7e 2a e9 05 4a 28 20 5c bb 8d 29 06 a1 2e a1 1c a1 71 27 d9 b2 77 11 a5 ff 7c a5>,
     absValidity: 2018-03-22T02:47:55.386Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 2a 02 f1 40 49 e9 9b 84>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:47:57 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521600478045
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521600535257
connected to auth! from local port 59742
received auth hello!
{ authId: 402, nonce: <Buffer e2 ce 8d 2b b9 b6 37 a5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 96 30 16 00 3a 4f e0 0f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200400,
  cipherKeyVal: <Buffer db 3d 39 cd c6 f9 83 99 fb 22 f7 fd ef 20 ff 65>,
  macKeyVal: <Buffer 7d 09 0d 10 c0 ab d2 ba 14 e4 a0 61 a3 cf 00 89 a7 dd c2 35 e6 ab 36 59 9b 88 80 ee 34 4e d1 35>,
  absValidity: 2018-03-22T02:48:55.464Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.17',
  serverPort: 22100,
  sessionKey: 
   { id: 40200400,
     cipherKeyVal: <Buffer db 3d 39 cd c6 f9 83 99 fb 22 f7 fd ef 20 ff 65>,
     macKeyVal: <Buffer 7d 09 0d 10 c0 ab d2 ba 14 e4 a0 61 a3 cf 00 89 a7 dd c2 35 e6 ab 36 59 9b 88 80 ee 34 4e d1 35>,
     absValidity: 2018-03-22T02:48:55.464Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 28 60 b1 87 91 47 0b a5>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:48:57 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521600538008
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521600595266
connected to auth! from local port 60012
received auth hello!
{ authId: 402, nonce: <Buffer f9 e0 87 2f 26 60 ed 54> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4b 76 df 29 5b 98 00 f0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200407,
  cipherKeyVal: <Buffer ee c9 ec 8b 31 5b 78 5c e3 2a 4b bd 76 83 fa 08>,
  macKeyVal: <Buffer cd a3 4d dc aa 15 c0 65 15 41 b4 e2 35 c7 14 a3 68 fd fc 3d 90 63 ca 10 4f e4 f5 78 61 d3 e9 5d>,
  absValidity: 2018-03-22T02:49:55.504Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.17',
  serverPort: 22100,
  sessionKey: 
   { id: 40200407,
     cipherKeyVal: <Buffer ee c9 ec 8b 31 5b 78 5c e3 2a 4b bd 76 83 fa 08>,
     macKeyVal: <Buffer cd a3 4d dc aa 15 c0 65 15 41 b4 e2 35 c7 14 a3 68 fd fc 3d 90 63 ca 10 4f e4 f5 78 61 d3 e9 5d>,
     absValidity: 2018-03-22T02:49:55.504Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 7d 00 87 c8 a0 a8 85 3c>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:49:57 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521600598073
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521600655324
connected to auth! from local port 60278
received auth hello!
{ authId: 402, nonce: <Buffer 88 70 8f 38 3a 8c 40 d9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c5 a9 84 28 d3 3c 34 6b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40200414,
  cipherKeyVal: <Buffer 2f 09 93 30 6f f7 a5 3c 73 bc 23 de ea 24 b5 a4>,
  macKeyVal: <Buffer 05 36 53 aa 9f ed 52 16 27 d7 c5 0a 37 4b d4 ec 47 6f 15 14 31 b8 ff b8 33 54 e8 ea 7a e3 76 a4>,
  absValidity: 2018-03-22T02:50:55.539Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.17',
  serverPort: 22100,
  sessionKey: 
   { id: 40200414,
     cipherKeyVal: <Buffer 2f 09 93 30 6f f7 a5 3c 73 bc 23 de ea 24 b5 a4>,
     macKeyVal: <Buffer 05 36 53 aa 9f ed 52 16 27 d7 c5 0a 37 4b d4 ec 47 6f 15 14 31 b8 ff b8 33 54 e8 ea 7a e3 76 a4>,
     absValidity: 2018-03-22T02:50:55.539Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer dd f8 96 85 1f 81 d9 a1>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:50:57 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 8 1 1521600658177
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 9 0.8888888888888888 1521600715382
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 10 0.8 1521600775389
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Error: connect EHOSTUNREACH 10.0.1.3:21100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 2
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 11 0.7272727272727273 1521600835397
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
reached migration failure threshold, rotate migration info index from: 0
to: 1
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.2:21100
connected to auth! from local port 33600
Handler: Error in secure comm - details: Auth hello timedout ...
/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902
            eventHandlers.onError('Error occurred in migration request: Disconnected from auth before getting migration response: ' + error);
                                                                                                                                      ^

ReferenceError: error is not defined
    at Socket.<anonymous> (/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902:135)
    at emitNone (events.js:91:20)
    at Socket.emit (events.js:188:7)
    at endReadableNT (_stream_readable.js:975:12)
    at _combinedTickCallback (internal/process/next_tick.js:80:11)
    at process._tickCallback (internal/process/next_tick.js:104:9)
