changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c414.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c414',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 73 53 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521600244773
connected to auth! from local port 36722
received auth hello!
{ authId: 403, nonce: <Buffer d6 f8 3a 77 1f cf 32 88> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer f9 35 14 5e 95 21 29 b7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer a0 ca 7d 6e 93 95 80 54 01 e5 69 d6 c0 dc 62 0d>,
  macKeyVal: <Buffer 5f f9 e9 51 38 56 f4 e6 16 f6 04 84 26 5d cc 49 6f 97 7c ab e5 60 24 68 20 f5 4f f7 b0 02 52 5f>,
  absValidity: 2018-03-21T03:44:04.951Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300570,
  cipherKeyVal: <Buffer b1 8c a2 50 fe a9 3e 71 77 65 41 09 6f 07 5d 56>,
  macKeyVal: <Buffer e0 30 5c 81 33 5f 02 86 6d 92 1f 2e 77 de 33 ae 8d ad 2e cf 85 40 6e fa 82 2e 2e a0 38 a9 3d 7f>,
  absValidity: 2018-03-22T02:44:04.950Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.21',
  serverPort: 22100,
  sessionKey: 
   { id: 40300570,
     cipherKeyVal: <Buffer b1 8c a2 50 fe a9 3e 71 77 65 41 09 6f 07 5d 56>,
     macKeyVal: <Buffer e0 30 5c 81 33 5f 02 86 6d 92 1f 2e 77 de 33 ae 8d ad 2e cf 85 40 6e fa 82 2e 2e a0 38 a9 3d 7f>,
     absValidity: 2018-03-22T02:44:04.950Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 32 b1 8a f2 f5 19 98 7a>
switching to HANDSHAKE_1_SENT
disconnected from auth
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:44:05 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521600246145
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521600304832
connected to auth! from local port 36914
received auth hello!
{ authId: 403, nonce: <Buffer b6 77 18 e3 88 38 a1 0a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bd d5 aa f9 b6 db 0b 18>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300576,
  cipherKeyVal: <Buffer 76 8a 87 72 3f c2 2d c8 81 14 d9 8b 1c b5 1e 91>,
  macKeyVal: <Buffer c5 af d8 0d db 15 a0 41 2f ca 57 53 bf 1f 71 c6 90 4c e4 48 aa 34 90 f9 03 86 bf af fe 3a 37 a4>,
  absValidity: 2018-03-22T02:45:04.998Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.21',
  serverPort: 22100,
  sessionKey: 
   { id: 40300576,
     cipherKeyVal: <Buffer 76 8a 87 72 3f c2 2d c8 81 14 d9 8b 1c b5 1e 91>,
     macKeyVal: <Buffer c5 af d8 0d db 15 a0 41 2f ca 57 53 bf 1f 71 c6 90 4c e4 48 aa 34 90 f9 03 86 bf af fe 3a 37 a4>,
     absValidity: 2018-03-22T02:45:04.998Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer b8 1f ca 85 90 c7 81 6f>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:45:05 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521600306140
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521600364854
connected to auth! from local port 37186
received auth hello!
{ authId: 403, nonce: <Buffer 1b 60 1c dd d1 59 12 e0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 26 d6 64 fa f2 54 0d 60>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300582,
  cipherKeyVal: <Buffer 8a fd 04 d4 7b c0 97 26 e3 d0 9c 68 87 87 b9 ec>,
  macKeyVal: <Buffer cf f2 e2 b4 14 8d 07 66 6d f4 fa 92 bf 12 72 67 71 a9 15 98 17 cd 6b 06 d1 5d 50 78 83 1d 82 af>,
  absValidity: 2018-03-22T02:46:05.032Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.21',
  serverPort: 22100,
  sessionKey: 
   { id: 40300582,
     cipherKeyVal: <Buffer 8a fd 04 d4 7b c0 97 26 e3 d0 9c 68 87 87 b9 ec>,
     macKeyVal: <Buffer cf f2 e2 b4 14 8d 07 66 6d f4 fa 92 bf 12 72 67 71 a9 15 98 17 cd 6b 06 d1 5d 50 78 83 1d 82 af>,
     absValidity: 2018-03-22T02:46:05.032Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 02 81 27 95 c3 63 1c f9>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:46:05 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521600366181
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521600424909
connected to auth! from local port 37456
received auth hello!
{ authId: 403, nonce: <Buffer 0e aa 5f 34 c3 af 24 9a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 6e 44 52 dd 8d b0 5e a5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300588,
  cipherKeyVal: <Buffer 99 e6 66 d6 f4 4a b6 d0 3a 81 4d 6b c5 fd 09 9f>,
  macKeyVal: <Buffer 05 15 c7 f0 c7 d3 90 6d ac 5e d6 3a c5 37 ba ea 98 4a 06 11 e0 9e a9 58 0d a7 40 8c fb bd 3f ab>,
  absValidity: 2018-03-22T02:47:05.073Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.21',
  serverPort: 22100,
  sessionKey: 
   { id: 40300588,
     cipherKeyVal: <Buffer 99 e6 66 d6 f4 4a b6 d0 3a 81 4d 6b c5 fd 09 9f>,
     macKeyVal: <Buffer 05 15 c7 f0 c7 d3 90 6d ac 5e d6 3a c5 37 ba ea 98 4a 06 11 e0 9e a9 58 0d a7 40 8c fb bd 3f ab>,
     absValidity: 2018-03-22T02:47:05.073Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer d6 e5 76 34 78 ea 1c 32>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:47:06 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521600426351
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521600484968
connected to auth! from local port 37726
received auth hello!
{ authId: 403, nonce: <Buffer 3b 14 17 d4 bc 71 22 60> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bd 6b 2d 41 c6 96 d4 5d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300594,
  cipherKeyVal: <Buffer d5 ae 16 4a ac 7b 6d 17 e0 44 3c 05 74 14 d3 64>,
  macKeyVal: <Buffer 7e 84 7c 12 8e 05 a8 cc be ef 52 37 d6 b0 49 9b ca 98 57 55 5e e9 63 48 e9 48 22 8b d6 9b c3 01>,
  absValidity: 2018-03-22T02:48:05.141Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.21',
  serverPort: 22100,
  sessionKey: 
   { id: 40300594,
     cipherKeyVal: <Buffer d5 ae 16 4a ac 7b 6d 17 e0 44 3c 05 74 14 d3 64>,
     macKeyVal: <Buffer 7e 84 7c 12 8e 05 a8 cc be ef 52 37 d6 b0 49 9b ca 98 57 55 5e e9 63 48 e9 48 22 8b d6 9b c3 01>,
     absValidity: 2018-03-22T02:48:05.141Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer bf 9f 00 4a 4e a1 0a 2d>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:48:06 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521600486337
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521600545022
connected to auth! from local port 37996
received auth hello!
{ authId: 403, nonce: <Buffer 4b 59 2e ac d7 5a 58 cf> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer d3 4d d4 dd 95 36 11 f1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300600,
  cipherKeyVal: <Buffer 12 24 c9 28 13 50 0b 86 bf 6b 96 c2 35 3f 35 9c>,
  macKeyVal: <Buffer b8 19 3e 03 3f d3 c5 37 ee 23 26 00 3f f0 66 25 a9 ff 96 bc 70 ae 80 ec 78 37 7c a7 3d 63 b5 1b>,
  absValidity: 2018-03-22T02:49:05.186Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.21',
  serverPort: 22100,
  sessionKey: 
   { id: 40300600,
     cipherKeyVal: <Buffer 12 24 c9 28 13 50 0b 86 bf 6b 96 c2 35 3f 35 9c>,
     macKeyVal: <Buffer b8 19 3e 03 3f d3 c5 37 ee 23 26 00 3f f0 66 25 a9 ff 96 bc 70 ae 80 ec 78 37 7c a7 3d 63 b5 1b>,
     absValidity: 2018-03-22T02:49:05.186Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 51 ee 17 6c 65 a0 7f e1>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:49:06 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521600546407
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521600605050
connected to auth! from local port 38266
received auth hello!
{ authId: 403, nonce: <Buffer 73 8a 37 ca 31 ab 52 d9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e9 74 90 2f 94 90 1e b7>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300606,
  cipherKeyVal: <Buffer d3 f9 5e 7e 1c 7b ab 4f 43 7d 98 2e 06 f8 5c 1c>,
  macKeyVal: <Buffer 35 c2 6d 6d 55 ae 83 bc 13 6e f0 a9 ce 0a 31 00 b3 32 c7 19 94 4d 53 d5 4f b1 70 b3 31 bf b7 ac>,
  absValidity: 2018-03-22T02:50:05.212Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.21',
  serverPort: 22100,
  sessionKey: 
   { id: 40300606,
     cipherKeyVal: <Buffer d3 f9 5e 7e 1c 7b ab 4f 43 7d 98 2e 06 f8 5c 1c>,
     macKeyVal: <Buffer 35 c2 6d 6d 55 ae 83 bc 13 6e f0 a9 ce 0a 31 00 b3 32 c7 19 94 4d 53 d5 4f b1 70 b3 31 bf b7 ac>,
     absValidity: 2018-03-22T02:50:05.212Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer bf e4 4b 12 2e 90 12 aa>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:50:06 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521600606332
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521600665081
connected to auth! from local port 38528
received auth hello!
{ authId: 403, nonce: <Buffer 4c d7 39 26 c5 eb 6b 4d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a3 8e 91 6d f3 3c 40 4b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300612,
  cipherKeyVal: <Buffer af 0c b9 a2 fa e1 59 9d 89 cb 56 9c 9a 5c a4 f6>,
  macKeyVal: <Buffer 67 e6 d0 36 cb 83 be 69 f8 3f 71 0b b3 5d c8 f0 16 42 fc dd c7 3f 1a 65 0a 3b 16 97 f6 8e df 0c>,
  absValidity: 2018-03-22T02:51:05.211Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.21',
  serverPort: 22100,
  sessionKey: 
   { id: 40300612,
     cipherKeyVal: <Buffer af 0c b9 a2 fa e1 59 9d 89 cb 56 9c 9a 5c a4 f6>,
     macKeyVal: <Buffer 67 e6 d0 36 cb 83 be 69 f8 3f 71 0b b3 5d c8 f0 16 42 fc dd c7 3f 1a 65 0a 3b 16 97 f6 8e df 0c>,
     absValidity: 2018-03-22T02:51:05.211Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 51 5c 64 1c 63 86 13 45>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:51:05 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 8 1 1521600666139
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 9 0.8888888888888888 1521600725121
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.3:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 10 0.8 1521600785131
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.3:21100
connected to auth! from local port 53100
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 11 0.7272727272727273 1521600845139
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.3:21100
connected to auth! from local port 53306
/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902
            eventHandlers.onError('Error occurred in migration request: Disconnected from auth before getting migration response: ' + error);
                                                                                                                                      ^

ReferenceError: error is not defined
    at Socket.<anonymous> (/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902:135)
    at emitNone (events.js:91:20)
    at Socket.emit (events.js:188:7)
    at endReadableNT (_stream_readable.js:975:12)
    at _combinedTickCallback (internal/process/next_tick.js:80:11)
    at process._tickCallback (internal/process/next_tick.js:104:9)
