changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c417.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c417',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 67 49 42 41 41 4b 43 41 51 45 41 38 58 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521600254671
connected to auth! from local port 40758
received auth hello!
{ authId: 403, nonce: <Buffer 18 10 dc 57 e9 d8 07 3e> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 88 fc 9e 60 d3 81 cb 1c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer f6 ee cd c1 72 46 d5 c7 6e 6c 90 10 23 fa c4 65>,
  macKeyVal: <Buffer af 88 e2 28 82 e6 43 a2 de cf 83 00 4b 5c 01 09 6e e9 fe 06 84 75 3c a1 dc eb 6b 0a 91 b7 43 99>,
  absValidity: 2018-03-21T03:44:14.838Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300573,
  cipherKeyVal: <Buffer e2 f9 f7 24 e4 93 8c 5a 8c 07 95 34 3a cb e3 0a>,
  macKeyVal: <Buffer c7 f6 f1 53 5c 7a 05 1e 57 f4 82 9c aa 68 16 17 72 23 05 0e c4 16 88 d0 e4 f5 55 ae 28 e9 5b b9>,
  absValidity: 2018-03-22T02:44:14.838Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.22',
  serverPort: 22100,
  sessionKey: 
   { id: 40300573,
     cipherKeyVal: <Buffer e2 f9 f7 24 e4 93 8c 5a 8c 07 95 34 3a cb e3 0a>,
     macKeyVal: <Buffer c7 f6 f1 53 5c 7a 05 1e 57 f4 82 9c aa 68 16 17 72 23 05 0e c4 16 88 d0 e4 f5 55 ae 28 e9 5b b9>,
     absValidity: 2018-03-22T02:44:14.838Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 9f bf 65 f5 6a 96 96 0b>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:44:15 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521600256297
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521600314730
connected to auth! from local port 40968
received auth hello!
{ authId: 403, nonce: <Buffer c2 66 ac dc de f7 d0 0d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c5 cb 03 f7 28 6e c3 5c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300579,
  cipherKeyVal: <Buffer 7d 76 02 39 4b ed cd 35 b9 d9 5c 5b 5b f9 7b 39>,
  macKeyVal: <Buffer 7f 9c 1e af 93 cf 3f 1f 56 ca 96 01 c6 9a 76 26 43 ab a8 c4 b6 f2 57 ea b9 89 19 4e 7b da 32 fa>,
  absValidity: 2018-03-22T02:45:14.888Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.22',
  serverPort: 22100,
  sessionKey: 
   { id: 40300579,
     cipherKeyVal: <Buffer 7d 76 02 39 4b ed cd 35 b9 d9 5c 5b 5b f9 7b 39>,
     macKeyVal: <Buffer 7f 9c 1e af 93 cf 3f 1f 56 ca 96 01 c6 9a 76 26 43 ab a8 c4 b6 f2 57 ea b9 89 19 4e 7b da 32 fa>,
     absValidity: 2018-03-22T02:45:14.888Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer cf 6d 31 82 b8 2e 61 db>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:45:16 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521600316510
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521600374764
connected to auth! from local port 41240
received auth hello!
{ authId: 403, nonce: <Buffer 6e 58 5b 8c b3 ff 5b f9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8e ed c4 60 6e 6b ea ab>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300585,
  cipherKeyVal: <Buffer 8b 8a 3c 29 6b ac 5a 44 36 9e bc b2 07 a2 a2 d7>,
  macKeyVal: <Buffer 26 d2 09 02 03 a0 e5 c0 80 4f 7a f5 3a 02 59 7f 7c 6b 78 1c a9 73 77 3b 37 24 7b 28 a4 39 85 15>,
  absValidity: 2018-03-22T02:46:14.914Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.22',
  serverPort: 22100,
  sessionKey: 
   { id: 40300585,
     cipherKeyVal: <Buffer 8b 8a 3c 29 6b ac 5a 44 36 9e bc b2 07 a2 a2 d7>,
     macKeyVal: <Buffer 26 d2 09 02 03 a0 e5 c0 80 4f 7a f5 3a 02 59 7f 7c 6b 78 1c a9 73 77 3b 37 24 7b 28 a4 39 85 15>,
     absValidity: 2018-03-22T02:46:14.914Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 76 26 37 df 0c 48 c2 7a>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:46:16 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521600376471
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521600434801
connected to auth! from local port 41510
received auth hello!
{ authId: 403, nonce: <Buffer 27 f8 53 f0 db 08 bb 36> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 56 2b 4a df 7b 5b 19 42>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300591,
  cipherKeyVal: <Buffer 2d db b0 60 66 2b da fb 89 df 2c 62 24 b5 22 47>,
  macKeyVal: <Buffer 03 c1 c5 62 d9 c7 1a 88 d2 85 82 61 36 bb 76 08 30 25 27 d1 a6 0c 41 b3 60 61 36 c4 ec 06 63 94>,
  absValidity: 2018-03-22T02:47:14.958Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.22',
  serverPort: 22100,
  sessionKey: 
   { id: 40300591,
     cipherKeyVal: <Buffer 2d db b0 60 66 2b da fb 89 df 2c 62 24 b5 22 47>,
     macKeyVal: <Buffer 03 c1 c5 62 d9 c7 1a 88 d2 85 82 61 36 bb 76 08 30 25 27 d1 a6 0c 41 b3 60 61 36 c4 ec 06 63 94>,
     absValidity: 2018-03-22T02:47:14.958Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 24 1b fe 88 c9 29 cb c4>
switching to HANDSHAKE_1_SENT
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:47:16 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521600436427
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521600494835
connected to auth! from local port 41780
received auth hello!
{ authId: 403, nonce: <Buffer 58 81 ba ad c5 ff d4 b8> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 3d 18 32 88 dd bc 8d e8>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300597,
  cipherKeyVal: <Buffer e5 6c f9 cb ff a5 1b 05 bb fa ac c6 18 e1 7e 58>,
  macKeyVal: <Buffer b6 75 f6 d6 f4 57 c8 68 0f ef 53 a5 c5 32 ed cb f7 c1 7f 0c d1 67 84 e1 43 d8 d9 88 d2 30 8b 0a>,
  absValidity: 2018-03-22T02:48:14.985Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.22',
  serverPort: 22100,
  sessionKey: 
   { id: 40300597,
     cipherKeyVal: <Buffer e5 6c f9 cb ff a5 1b 05 bb fa ac c6 18 e1 7e 58>,
     macKeyVal: <Buffer b6 75 f6 d6 f4 57 c8 68 0f ef 53 a5 c5 32 ed cb f7 c1 7f 0c d1 67 84 e1 43 d8 d9 88 d2 30 8b 0a>,
     absValidity: 2018-03-22T02:48:14.985Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 6c ac a7 d9 1b cf ef 4b>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:48:16 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521600496607
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521600554889
connected to auth! from local port 42050
received auth hello!
{ authId: 403, nonce: <Buffer e0 74 b7 9b 8e 6d d3 9d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer a8 69 0a c7 c0 ac 5a 71>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300603,
  cipherKeyVal: <Buffer 7d d0 bd 32 b5 99 bc 58 12 b6 6b d4 56 99 3d 98>,
  macKeyVal: <Buffer 6c 17 6e 66 50 fe 35 a0 0c bd 32 e6 17 3d ba 85 2c cc f6 ea f0 81 71 b2 16 87 38 73 33 93 89 37>,
  absValidity: 2018-03-22T02:49:15.029Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.22',
  serverPort: 22100,
  sessionKey: 
   { id: 40300603,
     cipherKeyVal: <Buffer 7d d0 bd 32 b5 99 bc 58 12 b6 6b d4 56 99 3d 98>,
     macKeyVal: <Buffer 6c 17 6e 66 50 fe 35 a0 0c bd 32 e6 17 3d ba 85 2c cc f6 ea f0 81 71 b2 16 87 38 73 33 93 89 37>,
     absValidity: 2018-03-22T02:49:15.029Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer fd 48 34 5c 26 80 51 fc>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:49:16 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521600556627
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521600614948
connected to auth! from local port 42320
received auth hello!
{ authId: 403, nonce: <Buffer 83 f3 a9 53 a7 a8 5d ec> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5a a5 77 13 cf 47 5c 9e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300609,
  cipherKeyVal: <Buffer 74 b6 8d 01 3f 3d e5 62 ed 07 a7 f6 41 4f a4 3c>,
  macKeyVal: <Buffer 0c 2b d0 62 28 fb cf 51 95 79 0e 40 4a a6 d4 69 7f d4 0e 2d 2c f2 48 95 76 96 d2 4c f9 72 df ff>,
  absValidity: 2018-03-22T02:50:15.094Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.22',
  serverPort: 22100,
  sessionKey: 
   { id: 40300609,
     cipherKeyVal: <Buffer 74 b6 8d 01 3f 3d e5 62 ed 07 a7 f6 41 4f a4 3c>,
     macKeyVal: <Buffer 0c 2b d0 62 28 fb cf 51 95 79 0e 40 4a a6 d4 69 7f d4 0e 2d 2c f2 48 95 76 96 d2 4c f9 72 df ff>,
     absValidity: 2018-03-22T02:50:15.094Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer c3 92 a6 59 7c 46 95 39>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:50:16 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521600616687
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521600675007
connected to auth! from local port 42582
received auth hello!
{ authId: 403, nonce: <Buffer 90 20 64 f1 52 a6 75 d7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9e 43 a8 cd 2b 35 cf 01>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300615,
  cipherKeyVal: <Buffer 4e 28 93 72 ff d1 af 65 2e c3 f3 a3 5f c4 5a 5f>,
  macKeyVal: <Buffer 9d 89 e0 67 98 36 c9 39 cd 79 b9 07 32 a3 23 01 78 44 b6 bf 15 a8 39 4f 99 98 d1 8a 27 24 b3 28>,
  absValidity: 2018-03-22T02:51:15.133Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.22',
  serverPort: 22100,
  sessionKey: 
   { id: 40300615,
     cipherKeyVal: <Buffer 4e 28 93 72 ff d1 af 65 2e c3 f3 a3 5f c4 5a 5f>,
     macKeyVal: <Buffer 9d 89 e0 67 98 36 c9 39 cd 79 b9 07 32 a3 23 01 78 44 b6 bf 15 a8 39 4f 99 98 d1 8a 27 24 b3 28>,
     absValidity: 2018-03-22T02:51:15.133Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 1b 6a 01 fc 7d 3f ef be>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:51:16 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 8 1 1521600676655
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 9 0.8888888888888888 1521600735013
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.3:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 10 0.8 1521600795024
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.3:21100
connected to auth! from local port 39656
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 11 0.7272727272727273 1521600855032
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.3:21100
connected to auth! from local port 39866
/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902
            eventHandlers.onError('Error occurred in migration request: Disconnected from auth before getting migration response: ' + error);
                                                                                                                                      ^

ReferenceError: error is not defined
    at Socket.<anonymous> (/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902:135)
    at emitNone (events.js:91:20)
    at Socket.emit (events.js:188:7)
    at endReadableNT (_stream_readable.js:975:12)
    at _combinedTickCallback (internal/process/next_tick.js:80:11)
    at process._tickCallback (internal/process/next_tick.js:104:9)
