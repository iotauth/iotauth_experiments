changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for autoClient: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Clients/c418.config
initializing...
current parameters: { numKeysPerRequest: 3,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: false,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { numKeysPerRequest: 1,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 'c418',
  group: 'Clients',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 31 51 ... > }
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 0 1 0 1521600257868
connected to auth! from local port 59524
received auth hello!
{ authId: 403, nonce: <Buffer 31 2a 0c d1 c7 34 4d 55> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 63 e2 91 0e c9 f3 f8 95>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer 08 b3 f3 15 70 b5 c2 eb b2 23 69 fc 42 b5 2e e2>,
  macKeyVal: <Buffer ed 88 a2 95 93 06 b5 18 ce 09 82 2c ef 14 ae a9 c0 fc 3f ea e1 61 52 64 5c 3e 35 de 6a 27 94 d8>,
  absValidity: 2018-03-21T03:44:18.038Z }
received 1 keys
currentSessionKey: [object Object]
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300574,
  cipherKeyVal: <Buffer 9c c6 d4 39 c6 d4 77 27 90 27 03 60 d6 d3 8d e1>,
  macKeyVal: <Buffer 6e 3d 88 a0 3e 6d 4b a2 5e 2b d2 18 53 8e 31 d3 87 69 16 a2 3c 56 dd 5f a1 78 66 de af 35 74 b1>,
  absValidity: 2018-03-22T02:44:18.037Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.23',
  serverPort: 22100,
  sessionKey: 
   { id: 40300574,
     cipherKeyVal: <Buffer 9c c6 d4 39 c6 d4 77 27 90 27 03 60 d6 d3 8d e1>,
     macKeyVal: <Buffer 6e 3d 88 a0 3e 6d 4b a2 5e 2b d2 18 53 8e 31 d3 87 69 16 a2 3c 56 dd 5f a1 78 66 de af 35 74 b1>,
     absValidity: 2018-03-22T02:44:18.037Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
disconnected from auth
chosen nonce: <Buffer 3d 37 67 3c 86 1f ab 3f>
switching to HANDSHAKE_1_SENT
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:44:19 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 1 1 1 1521600260314
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 1 2 0.5 1521600317927
connected to auth! from local port 59736
received auth hello!
{ authId: 403, nonce: <Buffer 1a 3b 6e b2 f0 57 c9 7e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 81 5f ca 13 c3 03 53 9f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300580,
  cipherKeyVal: <Buffer 4a 18 a1 7d e7 89 8e ae 88 78 2f 15 d1 6b 23 20>,
  macKeyVal: <Buffer 4e 31 80 a6 31 0b c7 3f 3f 52 4a 0d 01 c9 ae 9e e4 dd af ef 7f 4c a9 f7 4b 73 11 fc cf 10 d4 7f>,
  absValidity: 2018-03-22T02:45:18.058Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.23',
  serverPort: 22100,
  sessionKey: 
   { id: 40300580,
     cipherKeyVal: <Buffer 4a 18 a1 7d e7 89 8e ae 88 78 2f 15 d1 6b 23 20>,
     macKeyVal: <Buffer 4e 31 80 a6 31 0b c7 3f 3f 52 4a 0d 01 c9 ae 9e e4 dd af ef 7f 4c a9 f7 4b 73 11 fc cf 10 d4 7f>,
     absValidity: 2018-03-22T02:45:18.058Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 57 5b 8f d4 08 2e 55 7d>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:45:20 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 2 2 1 1521600320573
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 2 3 0.6666666666666666 1521600377981
connected to auth! from local port 60008
received auth hello!
{ authId: 403, nonce: <Buffer b0 c3 b0 d8 f7 72 e7 ba> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 10 d5 7d ad cb 4a 60 71>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300586,
  cipherKeyVal: <Buffer 1c 1c bd a9 a1 d1 a4 d9 7e bc db 1c 3f ad f9 3d>,
  macKeyVal: <Buffer 5d e0 a0 b5 de 13 79 37 24 96 e4 35 a8 a8 25 13 64 0d ed b8 31 3c f5 cb 6e 58 23 16 94 99 15 00>,
  absValidity: 2018-03-22T02:46:18.137Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.23',
  serverPort: 22100,
  sessionKey: 
   { id: 40300586,
     cipherKeyVal: <Buffer 1c 1c bd a9 a1 d1 a4 d9 7e bc db 1c 3f ad f9 3d>,
     macKeyVal: <Buffer 5d e0 a0 b5 de 13 79 37 24 96 e4 35 a8 a8 25 13 64 0d ed b8 31 3c f5 cb 6e 58 23 16 94 99 15 00>,
     absValidity: 2018-03-22T02:46:18.137Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 7a 01 a7 82 1c a5 2a ca>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:46:20 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 3 3 1 1521600380588
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 3 4 0.75 1521600438037
connected to auth! from local port 60278
received auth hello!
{ authId: 403, nonce: <Buffer 5e b5 00 ee 5b 04 99 f9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 21 8b 22 16 85 90 44 fa>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300592,
  cipherKeyVal: <Buffer 29 24 8c 1c 84 fe f6 54 fd da f3 d4 60 fc ef 2c>,
  macKeyVal: <Buffer 31 5b 57 f2 0d a1 3e 10 9f db d2 cb 0d 4c 83 81 7a 1f 32 20 00 37 22 7e da e7 bf 93 e6 d5 b5 b6>,
  absValidity: 2018-03-22T02:47:18.170Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.23',
  serverPort: 22100,
  sessionKey: 
   { id: 40300592,
     cipherKeyVal: <Buffer 29 24 8c 1c 84 fe f6 54 fd da f3 d4 60 fc ef 2c>,
     macKeyVal: <Buffer 31 5b 57 f2 0d a1 3e 10 9f db d2 cb 0d 4c 83 81 7a 1f 32 20 00 37 22 7e da e7 bf 93 e6 d5 b5 b6>,
     absValidity: 2018-03-22T02:47:18.170Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer ca 86 34 4b e8 15 d3 36>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:47:20 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 4 4 1 1521600440495
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 4 5 0.8 1521600498085
connected to auth! from local port 60548
received auth hello!
{ authId: 403, nonce: <Buffer c2 70 e8 7d 1a 75 36 4a> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f0 8c 24 9d d4 59 dc 52>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300598,
  cipherKeyVal: <Buffer c5 f3 a4 54 5b 66 f2 4c 8e e8 4a 11 83 8d d5 e7>,
  macKeyVal: <Buffer a9 d0 b0 44 e0 c5 82 24 ae 13 fc 6e 06 bd a8 d8 f1 55 e3 b5 3a 98 a1 7f 8b 46 ee 31 8f 07 f5 46>,
  absValidity: 2018-03-22T02:48:18.247Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.23',
  serverPort: 22100,
  sessionKey: 
   { id: 40300598,
     cipherKeyVal: <Buffer c5 f3 a4 54 5b 66 f2 4c 8e e8 4a 11 83 8d d5 e7>,
     macKeyVal: <Buffer a9 d0 b0 44 e0 c5 82 24 ae 13 fc 6e 06 bd a8 d8 f1 55 e3 b5 3a 98 a1 7f 8b 46 ee 31 8f 07 f5 46>,
     absValidity: 2018-03-22T02:48:18.247Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 41 3a ed eb 0c b0 bf fa>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:48:20 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 5 5 1 1521600500731
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 5 6 0.8333333333333334 1521600558141
connected to auth! from local port 60818
received auth hello!
{ authId: 403, nonce: <Buffer 44 da fe dc 14 e3 2a 50> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 93 26 22 7f 15 5f 01 df>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300604,
  cipherKeyVal: <Buffer cd 57 2f a8 c2 1f a5 88 27 11 e1 5e fa 57 a2 9c>,
  macKeyVal: <Buffer c9 c0 2b 9b e5 96 5e 6c 12 84 80 74 ff f2 92 40 35 f1 c1 38 9f 9e 04 a4 dc a0 1b 46 3d 1a 6f 54>,
  absValidity: 2018-03-22T02:49:18.308Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.23',
  serverPort: 22100,
  sessionKey: 
   { id: 40300604,
     cipherKeyVal: <Buffer cd 57 2f a8 c2 1f a5 88 27 11 e1 5e fa 57 a2 9c>,
     macKeyVal: <Buffer c9 c0 2b 9b e5 96 5e 6c 12 84 80 74 ff f2 92 40 35 f1 c1 38 9f 9e 04 a4 dc a0 1b 46 3d 1a 6f 54>,
     absValidity: 2018-03-22T02:49:18.308Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 5a f9 96 47 70 cb 94 19>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:49:20 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 6 6 1 1521600560864
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 6 7 0.8571428571428571 1521600618193
connected to auth! from local port 32856
received auth hello!
{ authId: 403, nonce: <Buffer 0e 31 cb 41 1d 20 88 1d> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ef 19 b6 ec 45 e6 6f ca>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300610,
  cipherKeyVal: <Buffer f4 0b 70 d1 8f dd 23 af c8 21 e0 c8 b2 bd 20 d7>,
  macKeyVal: <Buffer 63 f6 f0 6a 4b 78 be 53 6b 5f 75 f5 af 6d bb 03 9c ae 22 df 38 fd 2f 46 ce bb 79 73 95 7e 2a 77>,
  absValidity: 2018-03-22T02:50:18.406Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.23',
  serverPort: 22100,
  sessionKey: 
   { id: 40300610,
     cipherKeyVal: <Buffer f4 0b 70 d1 8f dd 23 af c8 21 e0 c8 b2 bd 20 d7>,
     macKeyVal: <Buffer 63 f6 f0 6a 4b 78 be 53 6b 5f 75 f5 af 6d bb 03 9c ae 22 df 38 fd 2f 46 ce bb 79 73 95 7e 2a 77>,
     absValidity: 2018-03-22T02:50:18.406Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer 1a ed cd 73 97 48 95 70>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:50:20 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 7 7 1 1521600620772
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 7 8 0.875 1521600678249
connected to auth! from local port 33118
received auth hello!
{ authId: 403, nonce: <Buffer 02 9f f2 a8 1f a6 4e a0> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1f d7 69 37 5a 3c 8c 3d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
currentSessionKey: [object Object]
Status: Secure connection closed before starting a new connection.
Session protocol: TCP
chosen commSessionKey: 
{ id: 40300616,
  cipherKeyVal: <Buffer 80 73 51 5c 19 ff 70 cd 15 0a 9d 87 13 83 69 a0>,
  macKeyVal: <Buffer f6 bf 3e 0a 65 46 55 df 1a a5 4d d6 98 05 29 b1 36 7e 56 e1 3c 15 6c fc d0 21 56 d8 2b c4 72 f0>,
  absValidity: 2018-03-22T02:51:18.423Z,
  relValidity: 7200000 }
options
{ serverHost: '10.0.1.23',
  serverPort: 22100,
  sessionKey: 
   { id: 40300616,
     cipherKeyVal: <Buffer 80 73 51 5c 19 ff 70 cd 15 0a 9d 87 13 83 69 a0>,
     macKeyVal: <Buffer f6 bf 3e 0a 65 46 55 df 1a a5 4d d6 98 05 29 b1 36 7e 56 e1 3c 15 6c fc d0 21 56 d8 2b c4 72 f0>,
     absValidity: 2018-03-22T02:51:18.423Z,
     relValidity: 7200000 },
  sessionCryptoSpec: { cipher: 'AES-128-CBC', mac: 'SHA256' },
  sessionProtocol: 'TCP',
  handshakeTimeout: 50000 }
chosen nonce: <Buffer ba 8f ba a5 96 98 10 c3>
switching to HANDSHAKE_1_SENT
disconnected from auth
Handler: secure connection with the server closed.
received session key handshake2!
client ret: [object Object]
server authenticated/authorized by solving nonce!
Handler: communication initialization succeeded
file data length: 1024
sending at Wed Mar 21 2018 02:51:20 GMT+0000 (UTC)
switching to IN_COMM
received secure communication message!
Received seqNum: 0
Handler: data received from server via secure communication
data1
Resp-actual/expected/ratio/ts: 8 8 1 1521600680763
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 9 0.8888888888888888 1521600738308
failure in connection with Auth : authFailureCount: 1
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.3:21100
Handler: Error in secure comm - details: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 10 0.8 1521600798317
failure in connection with Auth : authFailureCount: 2
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.3:21100
connected to auth! from local port 60064
Handler: Error in secure comm - details: Auth hello timedout ...
failure in migration to another Auth : migrationFailureCount: 1
Handler: Error in secure comm - details: Error occurred in migration request: Auth hello timedout ...
Distribution protocol: TCP
Resp-actual/expected/ratio/ts: 8 11 0.7272727272727273 1521600858318
failure in connection with Auth : authFailureCount: 3
failure count reached threshold (2), try migration...
In iotAuth.js migrateToTrustedAuth: 
In iotAuthService.js sendMigrationReqViaTCP: 
Handler: Error in secure comm - details: Error occurred in session key request: Error: connect EHOSTUNREACH 10.0.1.3:21100
connected to auth! from local port 60274
/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902
            eventHandlers.onError('Error occurred in migration request: Disconnected from auth before getting migration response: ' + error);
                                                                                                                                      ^

ReferenceError: error is not defined
    at Socket.<anonymous> (/home/hokeunkim/Development/iotauth/entity/node/accessors/node_modules/iotAuthService.js:902:135)
    at emitNone (events.js:91:20)
    at Socket.emit (events.js:188:7)
    at endReadableNT (_stream_readable.js:975:12)
    at _combinedTickCallback (internal/process/next_tick.js:80:11)
    at process._tickCallback (internal/process/next_tick.js:104:9)
