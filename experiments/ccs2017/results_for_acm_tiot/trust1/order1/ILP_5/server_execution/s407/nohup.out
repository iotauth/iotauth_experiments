changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s407.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's407',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 72 72 ... > }
Handler: listening on port 22100
s407:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200363
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52118
received auth hello!
{ authId: 402, nonce: <Buffer 23 50 fa e4 19 c7 69 f3> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer ca d6 a9 fe 15 50 9e 4e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer b6 3d 2f 31 c4 dd 29 a6 11 89 50 35 22 f2 26 50>,
  macKeyVal: <Buffer 1e 85 1d 72 46 e7 cd ba 8c 9c a0 6b b8 ee 02 3f b5 f0 12 67 20 ff b9 3c cb 38 73 eb 63 32 68 c2>,
  absValidity: 2018-03-21T03:43:49.276Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ca 9a e6 ee 6c 50 1c 00>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ca 9a e6 ee 6c 50 1c 00> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.51:52514',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200370
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52280
received auth hello!
{ authId: 402, nonce: <Buffer ff 3f c7 a1 95 54 a5 f2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ed 8a 94 6d c3 3a 0b f4>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e1 3e e2 1a ca c6 cd 78>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer e1 3e e2 1a ca c6 cd 78> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.51:52676',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200377
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52548
received auth hello!
{ authId: 402, nonce: <Buffer 89 03 89 48 de 5b 74 65> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 26 32 4f 13 df 07 59 37>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bd 64 33 6d 7e 63 e3 61>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer bd 64 33 6d 7e 63 e3 61> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.51:52944',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200384
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52818
received auth hello!
{ authId: 402, nonce: <Buffer 8b 6a 3a 2b 8a 0d d3 d5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4f 2b ae 2b c7 dc 32 2e>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 34 9f a9 20 ef e9 e3 b9>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 34 9f a9 20 ef e9 e3 b9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.51:53214',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200391
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53088
received auth hello!
{ authId: 402, nonce: <Buffer 57 b8 ef d1 d5 1d 5c 85> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 30 3d c0 9c 04 27 78 bf>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 84 31 f6 29 88 46 7f 80>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 84 31 f6 29 88 46 7f 80> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.51:53484',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200398
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53358
received auth hello!
{ authId: 402, nonce: <Buffer 8f f3 72 31 12 d3 7a f2> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8c 9b a7 23 c6 d1 df 6b>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 8d bb 7a e5 36 20 ec ae>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 8d bb 7a e5 36 20 ec ae> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.51:53754',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200405
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53628
received auth hello!
{ authId: 402, nonce: <Buffer 76 b6 d4 40 3c 76 82 d6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 5e 4b 1e a8 ce a0 40 27>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 9c ac 5c ec 2f 04 ba c3>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 9c ac 5c ec 2f 04 ba c3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.51:54024',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200412
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53898
received auth hello!
{ authId: 402, nonce: <Buffer 74 ec 77 3e 53 07 07 ae> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f1 a3 b9 b2 45 6a 6d 39>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a7 29 b4 a5 56 36 20 57>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer a7 29 b4 a5 56 36 20 57> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.51:54294',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
