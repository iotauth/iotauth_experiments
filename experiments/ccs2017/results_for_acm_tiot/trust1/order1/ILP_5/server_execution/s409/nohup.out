changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s409.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's409',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 78 53 ... > }
Handler: listening on port 22100
s409:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200367
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59268
received auth hello!
{ authId: 402, nonce: <Buffer 69 88 83 c4 05 cd 4f 0c> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer cb 9c 3d 47 5e 37 d0 cc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer e3 62 ac 03 be 5b 82 71 93 c1 7a 92 71 f1 ce 2d>,
  macKeyVal: <Buffer 54 84 f7 b4 9d 9a 73 42 b4 e4 c7 c5 eb 0b ab 8f 09 40 8a 39 a1 5e 60 c3 4c d5 6c 32 da dd de 1a>,
  absValidity: 2018-03-21T03:44:05.235Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 7d d4 29 22 cd 83 35 0b>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 7d d4 29 22 cd 83 35 0b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.55:48436',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200374
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59454
received auth hello!
{ authId: 402, nonce: <Buffer 4b 6e de bd 72 7b 08 48> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 4f c2 1e d2 7e 67 65 1f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 81 2e 76 5e f9 c6 30 c5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 81 2e 76 5e f9 c6 30 c5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.55:48622',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200381
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59726
received auth hello!
{ authId: 402, nonce: <Buffer 31 9c 03 e7 4e 84 44 38> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9a 03 32 6c 59 64 c9 4d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 53 0e 9e 4a 46 3c 66 ae>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 53 0e 9e 4a 46 3c 66 ae> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.55:48894',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200388
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 59996
received auth hello!
{ authId: 402, nonce: <Buffer 14 22 b3 ce 3f 7b 60 34> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 9b 1b 0b 8a 01 aa 94 82>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 39 66 30 d5 7d 14 81 4f>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 39 66 30 d5 7d 14 81 4f> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.55:49164',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200395
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60266
received auth hello!
{ authId: 402, nonce: <Buffer db 7c c6 1f 1e a9 06 f9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer ba 79 fe 95 e3 87 36 77>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cc 81 17 8c ff 61 af d2>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer cc 81 17 8c ff 61 af d2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.55:49434',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200402
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60536
received auth hello!
{ authId: 402, nonce: <Buffer ec 8b d3 19 72 a9 d9 e4> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 99 b5 0d a0 d1 50 5f 96>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer e1 08 c1 fa d0 a2 20 f4>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer e1 08 c1 fa d0 a2 20 f4> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.55:49704',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200409
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 60806
received auth hello!
{ authId: 402, nonce: <Buffer 52 12 4c 26 0b 2f 96 3f> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1e 1e 64 f4 2e b4 bc f2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 79 56 ac 4e 98 53 5a 6b>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 79 56 ac 4e 98 53 5a 6b> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.55:49974',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
