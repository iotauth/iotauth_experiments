changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s413.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's413',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 6f 77 49 42 41 41 4b 43 41 51 45 41 30 6d ... > }
Handler: listening on port 22100
s413:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300572
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53210
received auth hello!
{ authId: 403, nonce: <Buffer f3 03 5f 6d be 1e 67 40> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer 60 f6 d8 32 66 3e 34 cc>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer ab 18 fa 13 50 02 9e d4 3c df f5 58 87 7f 93 7c>,
  macKeyVal: <Buffer 34 f5 94 03 60 4c f3 ba ef 5a cb 37 c7 26 54 f8 8e 68 6c 43 bc 5f 8b e8 4a d4 aa f7 d1 1b 08 4d>,
  absValidity: 2018-03-21T03:44:12.048Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 71 59 35 d3 8f aa f4 47>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 71 59 35 d3 8f aa f4 47> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.58:60070',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300578
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53414
received auth hello!
{ authId: 403, nonce: <Buffer 04 db 38 d4 41 99 e3 02> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 45 05 7d 8f 25 b5 ae f1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 32 4f d2 d6 1b 0b 9c 55>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 32 4f d2 d6 1b 0b 9c 55> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.58:60274',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300584
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53686
received auth hello!
{ authId: 403, nonce: <Buffer 52 50 55 5b 8b a1 2d 81> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 1c e5 74 8b c5 88 67 9d>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2a 03 9f 31 50 7e 0e f2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 2a 03 9f 31 50 7e 0e f2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.58:60546',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300590
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53956
received auth hello!
{ authId: 403, nonce: <Buffer 7c 06 2e 9c a3 8e d7 e5> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e6 6d 49 ed 54 31 27 e1>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 2a 93 8f 42 4f 81 35 d8>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 2a 93 8f 42 4f 81 35 d8> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.58:60816',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300596
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54226
received auth hello!
{ authId: 403, nonce: <Buffer b2 62 2e 6f d9 85 11 66> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e0 6a 73 64 8c 79 7f d2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer a0 3e ac 51 d3 4b 87 cd>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer a0 3e ac 51 d3 4b 87 cd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.58:32854',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300602
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54496
received auth hello!
{ authId: 403, nonce: <Buffer 60 b3 de 6f 74 20 77 a7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer fe 77 74 1c c5 49 27 f5>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6c c2 4d 22 91 1d ef 91>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 6c c2 4d 22 91 1d ef 91> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.58:33124',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300608
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 54766
received auth hello!
{ authId: 403, nonce: <Buffer 66 5c 64 a5 98 46 c2 3b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 2c 0d 82 7a b6 af b5 4f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 02 9b 7a 09 8f 4d 97 c3>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 02 9b 7a 09 8f 4d 97 c3> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.58:33394',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40300614
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 55028
received auth hello!
{ authId: 403, nonce: <Buffer ca 37 bb d6 c9 85 d3 cd> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 99 24 bf 42 3f a9 61 00>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 63 60 d2 77 e7 e0 b8 51>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 63 60 d2 77 e7 e0 b8 51> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.58:33656',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
