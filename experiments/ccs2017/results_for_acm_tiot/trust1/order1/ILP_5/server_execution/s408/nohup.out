changing working directory to: /home/hokeunkim/Development/iotauth/entity/node/example_entities
loading from config file: /home/hokeunkim/Development/iotauth_experiments/experiments/ccs2017/expOptions/expEntity.option
Experimental options for echoServer: { autoSendPeriod: 60000,
  useSameSessionKeyCount: 1,
  connectionTimeout: 50000,
  migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
loading from config file: /home/hokeunkim/Development/iotauth/entity/node/example_entities/configs/Servers/s408.config
initializing secure comm server...
Session protocol: TCP
current parameters: { migrationEnabled: true,
  authFailureThreshold: 3,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 3 }
current parameters: { migrationEnabled: true,
  authFailureThreshold: 2,
  migrationFailureThreshold: 2 }
current entityInfo: { name: 's408',
  group: 'Servers',
  distProtocol: 'TCP',
  usePermanentDistKey: false,
  connectionTimeout: 50000,
  privateKey: <Buffer 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0a 4d 49 49 45 70 41 49 42 41 41 4b 43 41 51 45 41 6e 50 ... > }
Handler: listening on port 22100
s408:Servers prompt>
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200364
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51306
received auth hello!
{ authId: 402, nonce: <Buffer 62 5d 53 55 22 02 31 5f> }
received session key response with distribution key attached!
auth signature verified
replyNonce in sessionKeyResp: <Buffer c3 85 31 51 e0 fc a3 be>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
updating distribution key: { cipherKeyVal: <Buffer e6 bf e3 48 2b cf 4e 86 f4 7c cd 14 8c fe 5e ff>,
  macKeyVal: <Buffer c3 9f 60 7a 55 52 17 72 f9 d3 3f ca 75 12 92 f2 7f f8 23 4c 0c fb b3 4d cc 9d 8c 17 32 1d 2c 3b>,
  absValidity: 2018-03-21T03:43:53.206Z }
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer d1 c4 0b e0 c4 16 96 b9>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer d1 c4 0b e0 c4 16 96 b9> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 0,
  remoteAddress: '::ffff:10.0.1.52:45330',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 0 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 0 }
specified socketID: 0
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200366
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51318
received auth hello!
{ authId: 402, nonce: <Buffer 5b 87 22 bb d8 1f 25 46> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer f4 7c 7b be e4 cf d3 3f>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 03 3d 53 35 a9 0e 4f 92>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 03 3d 53 35 a9 0e 4f 92> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 1,
  remoteAddress: '::ffff:10.0.1.54:49086',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 1 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 1 }
specified socketID: 1
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #0 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200371
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51474
received auth hello!
{ authId: 402, nonce: <Buffer 89 b9 74 37 92 77 68 8b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer af 32 45 8c 5d ee 23 d2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 6a fb 71 40 1c 43 c2 98>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer 6a fb 71 40 1c 43 c2 98> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 2,
  remoteAddress: '::ffff:10.0.1.52:45498',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 2 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 2 }
specified socketID: 2
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #1 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200373
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51498
received auth hello!
{ authId: 402, nonce: <Buffer f0 eb f7 bd d4 7b 16 5e> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 58 8b 54 6b 84 63 4b a3>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bf 7a ed 7b b8 ad cd e0>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer bf 7a ed 7b b8 ad cd e0> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 3,
  remoteAddress: '::ffff:10.0.1.54:49266',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 3 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 3 }
specified socketID: 3
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #2 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200378
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51746
received auth hello!
{ authId: 402, nonce: <Buffer 3f 41 ee 85 cc 79 c5 27> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b9 18 84 3f d8 d5 c3 a2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 89 32 15 5f dd 4c 04 fb>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 89 32 15 5f dd 4c 04 fb> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 4,
  remoteAddress: '::ffff:10.0.1.52:45770',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 4 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 4 }
specified socketID: 4
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #3 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200380
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 51770
received auth hello!
{ authId: 402, nonce: <Buffer 53 9c 51 5c d3 df e6 d9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 0b 94 e8 b2 6b c0 1b 59>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 49 78 bc 07 59 9f f5 dd>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 49 78 bc 07 59 9f f5 dd> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 5,
  remoteAddress: '::ffff:10.0.1.54:49538',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 5 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 5 }
specified socketID: 5
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #4 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200385
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52016
received auth hello!
{ authId: 402, nonce: <Buffer e1 30 f5 b3 61 e5 3e 6b> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer b6 77 ed 16 b4 34 e9 03>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer cd 47 d6 60 7d 46 52 a7>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer cd 47 d6 60 7d 46 52 a7> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 6,
  remoteAddress: '::ffff:10.0.1.52:46040',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 6 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 6 }
specified socketID: 6
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #5 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200387
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52040
received auth hello!
{ authId: 402, nonce: <Buffer 65 de ad 71 bd 48 1b d6> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer e3 bc 29 ac 1b 7b ff b2>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer bb 9b 58 6f f3 99 2e 91>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer bb 9b 58 6f f3 99 2e 91> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 7,
  remoteAddress: '::ffff:10.0.1.54:49808',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 7 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 7 }
specified socketID: 7
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #6 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200392
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52286
received auth hello!
{ authId: 402, nonce: <Buffer 30 0b e2 96 9a 05 5e cb> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8b 15 6d 0c 6f a4 fa 23>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ff d2 1e 9e 3f f1 1f 93>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer ff d2 1e 9e 3f f1 1f 93> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 8,
  remoteAddress: '::ffff:10.0.1.52:46310',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 8 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 8 }
specified socketID: 8
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #7 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200394
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52310
received auth hello!
{ authId: 402, nonce: <Buffer d0 c5 b8 11 31 6b 98 b3> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer c3 d5 a9 2f 56 68 1d cf>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer fc 41 c4 24 35 6f 1c fc>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer fc 41 c4 24 35 6f 1c fc> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 9,
  remoteAddress: '::ffff:10.0.1.54:50078',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 9 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 9 }
specified socketID: 9
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #8 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200399
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52556
received auth hello!
{ authId: 402, nonce: <Buffer 73 97 7d 06 60 f9 19 e9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 68 9a 14 f8 15 d6 90 9c>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer ff 25 f4 c7 a2 46 87 ed>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer ff 25 f4 c7 a2 46 87 ed> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 10,
  remoteAddress: '::ffff:10.0.1.52:46580',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 10 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 10 }
specified socketID: 10
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #9 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200401
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52580
received auth hello!
{ authId: 402, nonce: <Buffer 83 37 52 c5 a3 41 34 92> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer bb 2b 09 d9 5d 1f e3 81>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 62 ff 70 d9 42 a5 50 a5>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 62 ff 70 d9 42 a5 50 a5> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 11,
  remoteAddress: '::ffff:10.0.1.54:50348',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 11 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 11 }
specified socketID: 11
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #10 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200406
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52826
received auth hello!
{ authId: 402, nonce: <Buffer 2e 5a 96 76 a1 16 f8 a7> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 94 88 f2 be 80 64 34 c6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 07 96 d9 80 54 14 ba c2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 07 96 d9 80 54 14 ba c2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 12,
  remoteAddress: '::ffff:10.0.1.52:46850',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 12 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 12 }
specified socketID: 12
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #11 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200408
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 52850
received auth hello!
{ authId: 402, nonce: <Buffer 29 ed 38 4a d1 16 f7 f1> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 92 bf 36 e2 29 d0 79 c0>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer 22 0d 51 60 80 ba bf e2>
switching to HANDSHAKE_2_SENT
disconnected from auth
received session key handshake3!
{ replyNonce: <Buffer 22 0d 51 60 80 ba bf e2> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 13,
  remoteAddress: '::ffff:10.0.1.54:50618',
  status: 'open' }
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 13 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 13 }
specified socketID: 13
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #12 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200413
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53092
received auth hello!
{ authId: 402, nonce: <Buffer 4d 18 2c 25 2d 26 33 d9> }
received session key response encrypted with distribution key
replyNonce in sessionKeyResp: <Buffer 8c b8 46 bb 19 82 db c6>
auth nonce verified
handleSessionKeyResp: session key request succeeded! authFailureCount: 0
received 1 keys
Session key id is as expected
server ret: [object Object]
chosen nonce: <Buffer c2 4d 5a a5 44 b1 25 ce>
switching to HANDSHAKE_2_SENT
received session key handshake3!
{ replyNonce: <Buffer c2 4d 5a a5 44 b1 25 ce> }
client authenticated/authorized by solving nonce!
switching to IN_COMM
Handler: secure connection with the client established.
{ id: 14,
  remoteAddress: '::ffff:10.0.1.52:47116',
  status: 'open' }
disconnected from auth
received secure communication!
Received seqNum: 0
data received from server via secure communication
Handler: socketID: 14 data: data1
toSend: { data: <Buffer 64 61 74 61 31>, id: 14 }
specified socketID: 14
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #13 closed
Unidentified client connected
received session key handshake1
switching to HANDSHAKE_1_RECEIVED state.
session key id: 40200415
session key NOT found! sending session key id to AuthService
Distribution protocol: TCP
connected to auth! from local port 53116
Handler: Error in server - details: Disconnected from auth before getting session key response
Handler: Error in server - details: handshake2 timed out...
Unidentified client disconnected
Handler: Error in server - details: Closed during comm init from undefined:undefined
Handler: Error in server - details: Auth hello timedout ...
Unidentified client disconnected
Handler: secure connection with the client closed.
socket #14 closed
