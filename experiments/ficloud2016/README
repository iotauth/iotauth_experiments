# Use this capture filter for WireShark

tcp portrange 21100-21163 or tcp port 21900

*** Statistics -> Packet lengths

*** Use following display filters

******* For TLS ********
// sent packet (to server)
tcp.dstport >= 21100 && tcp.dstport < 21163
// received packet (from server)
tcp.srcport >= 21100 && tcp.srcport < 21163

******* For Proposed ********
// sent packet (to server) or (to auth)
(tcp.dstport >= 21100 && tcp.dstport < 21163) || (tcp.srcport == AUTH_CLIENT_PORT)
// received packet (from server) or (from auth)
tcp.srcport >= 21100 && tcp.srcport < 21163 || (tcp.dstport == AUTH_CLIENT_PORT)

******** For TLS pub/sub *********
// sent packet (to subscribers)
tcp.srcport == 21100
// received packet (from subscribers)
tcp.dstport == 21100

******* For Proposed pub/sub with MQTT broker *****
// sent packet (to broker) or (to auth)
tcp.srcport == MQTT_LOCAL_PORT || tcp.srcport == AUTH_CLIENT_PORT
// received packet (from server) or (from auth)
tcp.dstport == MQTT_LOCAL_PORT || tcp.dstport == AUTH_CLIENT_PORT

// Running experiments
// scenario 1 with tls

// Scenario 2 without broker
server -> skReqPub
client -> exp2
server -> sendFile

// Scenario 2 with broker
client -> mqtt -> skReqPub 1
server -> exp2
client -> spubFile
